<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>devkitARM release 30 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Announcements And Comments > devkitARM release 30</h2>
<div id="posts">
<div class="post">
    <h4>#173186 - wintermute - Thu Mar 25, 2010 9:56 pm</h4>
    <div class="postbody"><span class="postbody">There were a couple of odd bugs that crept in to release 29 so say hello to release 30.
<br/>
<br/>
<a href="http://www.devkitpro.org/devkitarm/devkitarm-release-30/" target="_blank">http://www.devkitpro.org/devkitarm/devkitarm-release-30/</a>
<br/>
<br/>
And no, hopefully this 3 day release cycle won't get to be a habit :p<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173229 - wintermute - Sun Mar 28, 2010 10:59 am</h4>
    <div class="postbody"><span class="postbody">bumping this back to the top after replying to posts in earlier releases.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173264 - sverx - Mon Mar 29, 2010 9:58 am</h4>
    <div class="postbody"><span class="postbody">oops... so I should bump again this one, now! :) (wasn't it easier to make this sticky? ;) )</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173277 - Dwedit - Mon Mar 29, 2010 6:09 pm</h4>
    <div class="postbody"><span class="postbody">If this newlib doesn't contain an optimized memset and memcpy, I'm going to cry.  No more excuses, just replace their C memcpy and memset functions with optimized ASM versions already.
<br/>
<br/>
edit: What the hell is this?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
lib_a-mempcpy.o:     file format elf32-littlearm
<br/>
<br/>
<br/>
Disassembly of section .text:
<br/>
<br/>
00000000 &lt;mempcpy&gt;:
<br/>
   0:   e352000f    cmp   r2, #15
<br/>
   4:   e92d0030    push   {r4, r5}
<br/>
   8:   e1a03000    mov   r3, r0
<br/>
   c:   e1a04001    mov   r4, r1
<br/>
  10:   e1a0c002    mov   ip, r2
<br/>
  14:   9a000002    bls   24 &lt;mempcpy+0x24&gt;
<br/>
  18:   e1815003    orr   r5, r1, r3
<br/>
  1c:   e3150003    tst   r5, #3
<br/>
  20:   0a00000a    beq   50 &lt;mempcpy+0x50&gt;
<br/>
  24:   e35c0000    cmp   ip, #0
<br/>
  28:   0a000006    beq   48 &lt;mempcpy+0x48&gt;
<br/>
  2c:   e3a02000    mov   r2, #0
<br/>
  30:   e7d41002    ldrb   r1, [r4, r2]
<br/>
  34:   e7c01002    strb   r1, [r0, r2]
<br/>
  38:   e2822001    add   r2, r2, #1
<br/>
  3c:   e152000c    cmp   r2, ip
<br/>
  40:   1afffffa    bne   30 &lt;mempcpy+0x30&gt;
<br/>
  44:   e0800002    add   r0, r0, r2
<br/>
  48:   e8bd0030    pop   {r4, r5}
<br/>
  4c:   e12fff1e    bx   lr
<br/>
  50:   e1a04002    mov   r4, r2
<br/>
  54:   e1a0c001    mov   ip, r1
<br/>
  58:   e59c5000    ldr   r5, [ip]
<br/>
  5c:   e5805000    str   r5, [r0]
<br/>
  60:   e59c5004    ldr   r5, [ip, #4]
<br/>
  64:   e5805004    str   r5, [r0, #4]
<br/>
  68:   e59c5008    ldr   r5, [ip, #8]
<br/>
  6c:   e5805008    str   r5, [r0, #8]
<br/>
  70:   e2444010    sub   r4, r4, #16
<br/>
  74:   e59c500c    ldr   r5, [ip, #12]
<br/>
  78:   e354000f    cmp   r4, #15
<br/>
  7c:   e580500c    str   r5, [r0, #12]
<br/>
  80:   e28cc010    add   ip, ip, #16
<br/>
  84:   e2800010    add   r0, r0, #16
<br/>
  88:   8afffff2    bhi   58 &lt;mempcpy+0x58&gt;
<br/>
  8c:   e2422010    sub   r2, r2, #16
<br/>
  90:   e1a00222    lsr   r0, r2, #4
<br/>
  94:   e0425200    sub   r5, r2, r0, lsl #4
<br/>
  98:   e2800001    add   r0, r0, #1
<br/>
  9c:   e1a00200    lsl   r0, r0, #4
<br/>
  a0:   e3550003    cmp   r5, #3
<br/>
  a4:   e0814000    add   r4, r1, r0
<br/>
  a8:   e1a0c005    mov   ip, r5
<br/>
  ac:   e0830000    add   r0, r3, r0
<br/>
  b0:   9affffdb    bls   24 &lt;mempcpy+0x24&gt;
<br/>
  b4:   e3a01000    mov   r1, #0
<br/>
  b8:   e7942001    ldr   r2, [r4, r1]
<br/>
  bc:   e7802001    str   r2, [r0, r1]
<br/>
  c0:   e2811004    add   r1, r1, #4
<br/>
  c4:   e0612005    rsb   r2, r1, r5
<br/>
  c8:   e3520003    cmp   r2, #3
<br/>
  cc:   8afffff9    bhi   b8 &lt;mempcpy+0xb8&gt;
<br/>
  d0:   e245c004    sub   ip, r5, #4
<br/>
  d4:   e1a0212c    lsr   r2, ip, #2
<br/>
  d8:   e2823001    add   r3, r2, #1
<br/>
  dc:   e1a03103    lsl   r3, r3, #2
<br/>
  e0:   e0844003    add   r4, r4, r3
<br/>
  e4:   e04cc102    sub   ip, ip, r2, lsl #2
<br/>
  e8:   e0800003    add   r0, r0, r3
<br/>
  ec:   eaffffcc    b   24 &lt;mempcpy+0x24&gt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't see any ldmia / stmia in 32 byte chunks anywhere here.  I just see it going to word-aligned mode, and nothing further than that.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173281 - wintermute - Mon Mar 29, 2010 7:30 pm</h4>
    <div class="postbody"><span class="postbody">If you don't have something constructive to say then please don't bother. I'm getting really seriously bored with you.
<br/>
<br/>
Something you need to consider, devkitARM is not now, nor has it ever been, only a DS compiler. It is also capable of producing code for any arm4vt+ processor in arm or thumb mode with both little and big endian support, as well as several of the Cortex chips. If you want an "optimised" memcpy and memset feel free to write them yourself. If you want to see them in devkitARM then please ensure that your code will run on any arm chip supported by devkitARM.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173288 - keldon - Mon Mar 29, 2010 11:47 pm</h4>
    <div class="postbody"><span class="postbody">Is there any easy way to select libraries at compile/make time such that optimized code can be linked instead? I've seen it done on one commercial tool chain for an embedded system and it was seamless. That way everyone can be happy!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173684 - FluBBa - Fri Apr 23, 2010 10:03 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#---------------------------------------------------------------------------------
<br/>
# options for code generation
<br/>
#---------------------------------------------------------------------------------
<br/>
ARCH   :=   -mthumb -mthumb-interwork
<br/>
<br/>
CFLAGS   :=   -g -Wall -O2\
<br/>
          -march=armv5te -mtune=arm946e-s -fomit-frame-pointer\
<br/>
         -ffast-math \
<br/>
         $(ARCH)
<br/>
<br/>
CFLAGS   +=   $(INCLUDE) -DARM9
<br/>
CXXFLAGS   := $(CFLAGS) -fno-rtti -fno-exceptions -fno-exceptions -fno-rtti
<br/>
<br/>
ASFLAGS   :=   -g $(ARCH) $(INCLUDE)
<br/>
LDFLAGS   =   -specs=ds_arm9.specs -g $(ARCH) -mno-fpu -Wl,-Map,$(notdir $*.map)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Shouldn't the "-march=armv5te " be placed under ARCH so we can use ARM9 opcodes from assembler? (found in all example makefiles...)
<br/>
Or can I screw something up by doing that?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
