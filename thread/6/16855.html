<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>XMid for GBA/DS official release - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Announcements And Comments > XMid for GBA/DS official release</h2>
<div id="posts">
<div class="post">
    <h4>#170256 - Ruben - Sun Sep 13, 2009 2:28 pm</h4>
    <div class="postbody"><span class="postbody">Hi guys!
<br/>
<br/>
So just then, I finished zipping up all the files for XMid.
<br/>
From the e-mail sent to news...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">So, at long last, XMid is completed, for both GBA and DS.
<br/>
Here are a few specs:
<br/>
-16 note polyphony (on both GBA and DS)
<br/>
-Assembler optimized sound mixing (GBA only)
<br/>
-Assembler written sound code (GBA/DS)
<br/>
-GBA: ~5KB EWRAM, ~2KB IWRAM
<br/>
-DS: ~0.7KB ARM7 RAM, ~3KB main RAM
<br/>
-Four music players, to allow special effect 'songs'
<br/>
-No timers used on DS (timer 0 used on GBA)
<br/>
Included are the sources for the conversion tools, and demos, along with all executables and sound data (including Midi files and raw sound data + config file).</td> </tr></table><span class="postbody">
<br/>
You can also get a copy <a class="postlink" href="http://rapidshare.com/files/280291268/XMid_Nitro_Release.zip.html" target="_blank">here</a>.
<br/>
<br/>
Note, however, that I forgot about the GBA version while working on the DS one and.. well... the sound converter won't work half the time for the GBA &gt;&lt;'
<br/>
<br/>
The GBA mixer takes *unsigned* 8-bit sound data, whilst the converter outputs the original data, therefore to get it to work, you'll need to make all your data unsigned *before* converting.
<br/>
<br/>
That aside, the RAW-&gt;XMid conversion program works with a 'config' file, which is somewhat set out like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Filename : DataFormat LoopFlag C4Freq Root LoopStart LoopEnd--or--Size
<br/>
<br/>
Example:
<br/>
<br/>
Smp_Brass_C4.sw : PCM16 Y 22150 60 13180 26492
<br/>
<br/>
Input file is Smp_Brass_C4.sw. It has 16-bit data, and is looped. Its middle-C frequency is 22150Hz, its root key is 60 (note: it doesn't matter what value you set this to.. I'm not sure why I added this &gt;&gt;'), loop start is at 13180 samples and loop end is at 26492 samples.
<br/>
<br/>
Another example:
<br/>
<br/>
Smp_HHClosed.sw : PCM8 N 22050 60 0 1342
<br/>
<br/>
Input file is Smp_HHClosed.sw, it is 8-bit data, non-looped @ 22050Hz, with a length of 1342 samples; however, it will be truncated to 1340 samples, as hardware mixing required word-aligned points.</td> </tr></table><span class="postbody">
<br/>
<br/>
Hopefully that wasn't too confusing. If you need any further help, drop me a line at my e-mail or PM me.
<br/>
<br/>
-- Aik
<br/>
<br/>
EDIT:
<br/>
On further inspection, the sound converter won't work at ALL for GBA, as PCM8 data's loop points and lengths will be divided by 4. Sorry &gt;&lt;'
<br/>
<br/>
EDIT 2:
<br/>
Link 'fixed:' Got it up on RapidShare.<br/>_________________<br/>I'm 18 and have Asperger's, so if I don't get something at first, just bear with me. *nod*</span><span class="gensmall"><br/><br/>Last edited by Ruben on Tue Sep 15, 2009 8:42 am; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#170261 - Ruben - Sun Sep 13, 2009 6:56 pm</h4>
    <div class="postbody"><span class="postbody">Err... I'm gonna feel so stupid for this but anyway...
<br/>
<br/>
There's a MAJOR code screwup on XMid_Demo9.c, where it shows that I don't know basic fixed-point math &gt;&gt;'
<br/>
<br/>
(I actually do, I was just lacking sleep at the time ^_^')
<br/>
<br/>
So uh... if you still need the 'proper' code, here it is:
<br/>
<br/>
(From line 113 to 129)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">UsageHi9 = (Clks*100&lt;&lt;8)/280095;
<br/>
      UsageLo9 = (UsageHi9&amp;255)*100&gt;&gt;8;
<br/>
      UsageHi9 = (UsageHi9   )&gt;&gt;8;
<br/>
      
<br/>
      if((UsageHi9&lt;&lt;8)+UsageLo9 &gt; (PeakHi9&lt;&lt;8)+PeakLo9) {
<br/>
         PeakHi9 = UsageHi9;
<br/>
         PeakLo9 = UsageLo9;
<br/>
      }
<br/>
      
<br/>
      UsageHi7 = (rClk*100&lt;&lt;8)/280095;
<br/>
      UsageLo7 = (UsageHi7&amp;255)*100&gt;&gt;8;
<br/>
      UsageHi7 = (UsageHi7   )&gt;&gt;8;
<br/>
      
<br/>
      if((UsageHi7&lt;&lt;8)+UsageLo7 &gt; (PeakHi7&lt;&lt;8)+PeakLo7) {
<br/>
         PeakHi7 = UsageHi7;
<br/>
         PeakLo7 = UsageLo7;
<br/>
      }</td> </tr></table><span class="postbody">
<br/>
EDIT:
<br/>
Phooey, even then it's screwed up &gt;&lt;'
<br/>
Oh well, at least you know it uses very little CPU regardless of the fractional portion being incorrect. I would bother to fix it but I'm tired and about to pass out &gt;&gt;'<br/>_________________<br/>I'm 18 and have Asperger's, so if I don't get something at first, just bear with me. *nod*</span><span class="gensmall"><br/><br/>Last edited by Ruben on Mon Sep 14, 2009 1:13 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#170262 - keldon - Sun Sep 13, 2009 9:12 pm</h4>
    <div class="postbody"><span class="postbody">Woot woot, hot stuff!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
