<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>16x16 color quantizer - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Announcements And Comments > 16x16 color quantizer</h2>
<div id="posts">
<div class="post">
    <h4>#15244 - DekuTree64 - Mon Jan 19, 2004 7:59 pm</h4>
    <div class="postbody"><span class="postbody">Hey everyone, just thought I'd share what I've been working on the past few days. It's a tool to quantize/dither a 24-bit bitmap to use several smaller palettes for 16-color tile mode. You can set the size/number of palettes for it to use. 
<br/>
It's based on the algorithms discussed in the color quantization thread in the graphics section a while back, so I didn't do that much thinking on the matter, just putting it together. 
<br/>
You can see some comparisons at <a class="postlink" href="http://www.angelfire.com/wizard/deku/program/quither/example.html" target="_blank">http://www.angelfire.com/wizard/deku/program/quither/example.html</a>, although the palettes are screwed up by the program I used to save them as GIFs, so if you want to try them out on a real GBA, I made a zip of the bitmaps at <a class="postlink" href="http://www.angelfire.com/wizard/deku/program/quither/example.zip" target="_blank">http://www.angelfire.com/wizard/deku/program/quither/example.zip</a>. The first image is the Smash Bros box art that was tested in the other thread (mine doesn't look quite as good though...), and the other 2 are pictures I've drawn, one of them sized down to GBA screen size and the other still nice and big. 
<br/>
If you don't want to wait for all those images to load, just download the program at <a class="postlink" href="http://www.angelfire.com/wizard/deku/program/quither/quither.zip" target="_blank">http://www.angelfire.com/wizard/deku/program/quither/quither.zip</a>, and convert some yourself, because it's much smaller (20KB, as opposed to 540 for the zip).
<br/>
<br/>
It's still a little slow though, but the source is included so feel free to optimize it if you see any pointless wastes of time, or try better quantization methods. Currently it uses an octree, which is why it's so slow.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15254 - Miked0801 - Tue Jan 20, 2004 2:30 am</h4>
    <div class="postbody"><span class="postbody">Pretty Cool!  How quick do you think you could add 8-bit .bmp support to it as I believe a lot of people will create 8-bit images and want to convert them to 16-16?
<br/>
<br/>
Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15257 - tepples - Tue Jan 20, 2004 3:39 am</h4>
    <div class="postbody"><span class="postbody">Converting a photorealistic image to 256-color indexed is a form of lossy compression. Converting to 16x15 is lossy as well. In general, <a class="postlink" href="http://www.modatic.net/audio/transcoding.php" target="_blank">two lossy steps in a row are a Bad Thing</a>. If you're not trying to convert line art, best is to scan the image in 24-bit, manipulate it in 24-bit, then convert it from 24-bit to 16x15.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15258 - Miked0801 - Tue Jan 20, 2004 3:56 am</h4>
    <div class="postbody"><span class="postbody">Except when converting pre-exisiting 8-bit images to save space - or when the art is originally drawn 8-bit.  Truth is, I can modify the code to support 8-bit if I needed to anyways.  I just though other people might find 8-bit support handy.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15302 - DekuTree64 - Tue Jan 20, 2004 5:39 pm</h4>
    <div class="postbody"><span class="postbody">8-bit support added. I also did away with that irritating "dimensions must be multiples of 8" message, now it just chops off any extra from the edges.
<br/>
Thanks for the point, Mike.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15308 - Miked0801 - Tue Jan 20, 2004 7:31 pm</h4>
    <div class="postbody"><span class="postbody">Actually, that warnings is nice - if the art isn't aligned, I'd like to know about it and edit it - not have a tool silently take care of the issue.  :)
<br/>
<br/>
Great tool.  I'm getting the latest now and giving it a run :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15324 - DekuTree64 - Tue Jan 20, 2004 8:58 pm</h4>
    <div class="postbody"><span class="postbody">Hmm, true. I'll put the warning back in so you know if it's happening.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15334 - Miked0801 - Tue Jan 20, 2004 11:17 pm</h4>
    <div class="postbody"><span class="postbody">Oops.  You broke 24-bit support :)  Stuff that worked ysterday crashes it now :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15336 - DekuTree64 - Wed Jan 21, 2004 12:13 am</h4>
    <div class="postbody"><span class="postbody">Crap.
<br/>
Well, it's fixed now. Forgot that changing from bm.bmWidth to bm.bmWidthBytes meant I didn't have to multiply by 3 anymore.
<br/>
Thanks a bunch for your bug reports, hope it's fully functional now^_^<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15341 - Miked0801 - Wed Jan 21, 2004 1:44 am</h4>
    <div class="postbody"><span class="postbody">Excellent. 24-bit works again :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17527 - DekuTree64 - Tue Mar 09, 2004 10:31 pm</h4>
    <div class="postbody"><span class="postbody">Update: Raw GBA data output added, main function split into a bunch of logical sections, so source is hopefully a little bit more readable now, Windows LoadImage function replaced with my own bitmap loader, so source is now portable.
<br/>
<br/>
Get it at <a class="postlink" href="http://www.angelfire.com/wizard/deku/program/quither/quither.zip" target="_blank">http://www.angelfire.com/wizard/deku/program/quither/quither.zip</a><br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17529 - Lupin - Tue Mar 09, 2004 10:45 pm</h4>
    <div class="postbody"><span class="postbody">nice hand drawing :)
<br/>
I wonder why you chose splash screen type images for the test because no one is going to convert splash screens to 16 colors i would guess (the 16 color mode is good for sprite gfx, right?)
<br/>
<br/>
I never used the 16 color mode, converting 16 bit images or 24 bit images to 8 bit ones is way more interesting to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17534 - Miked0801 - Tue Mar 09, 2004 11:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
no one is going to convert splash screens to 16 colors 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I will :)
<br/>
<br/>
Dropping from 8-bit to 16/16 with this utility doesn't hurt image quality (much) and halves ROM space usage.  A good trade.
<br/>
<br/>
BTW, there may be a bug with it as it stands - occasionally the first color ramp (darkest) is getting full red and green color entries in towards the middle of the ramp (after a bunch of black or near blacks.)  If I can get an example of this around NDA, I'll post an image for you to see what I'm talking about.  Probably nothing, but who knows.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17537 - Lupin - Tue Mar 09, 2004 11:31 pm</h4>
    <div class="postbody"><span class="postbody">you cut off my "i would guess" :)
<br/>
<br/>
Well, i am interested in high quality image output, because that's what most commercial roms prefer rather than rom size (just take a look at splinter cell, i don't think the images there are 16 colors... i really like that game and all its fancy colors :P)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17548 - tepples - Wed Mar 10, 2004 3:09 am</h4>
    <div class="postbody"><span class="postbody">Not everybody has the luxury of 8 MB of space. Some people have to fit their programs into RAM so that they can multiboot.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
