<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>MCTool 0.15 released - scandisk/fatsort for NDS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Announcements And Comments > MCTool 0.15 released - scandisk/fatsort for NDS</h2>
<div id="posts">
<div class="post">
    <h4>#114559 - SukkoPera - Mon Jan 08, 2007 11:56 pm</h4>
    <div class="postbody"><span class="postbody">My first NDS homebrew application has just been released. It's a collection of utilities useful for the maintenance of the media card you are using with your flashcart.
<br/>
<br/>
At the moment of this first release, two utilities are included:
<br/>
- The first one checks, and optionally fixes, any errors found in the filesystem of your media card. This is basically the same thing that you do under Windows when you run "Scandisk", but it saves you the hassle of having to turn on your computer, remove your card, connect it to the PC, etc...
<br/>
- The second utility will be mainly useful for users of Supercard family flashcarts. Such carts show ROMs and programs sorted by date. Many users (including me) prefer to have them sorted alphabetically, which is exactly what this utility does.
<br/>
<br/>
Please report any comments/bugs/appreciations :).
<br/>
<br/>
Disclaimer:
<br/>
PLEASE NOTE THAT THIS PROGRAM MESSES WITH THE FILESYSTEM OF YOUR MEDIA CARD, WHICH MIGHT RESULT IN A DATA LOSS. THEREFORE, BEFORE USING IT, ALWAYS MAKE A BACKUP OF ANY IMPORTANT DATA.
<br/>
<br/>
Downloads:
<br/>
- <a class="postlink" href="http://www.sukkology.net/software/nds/mctool-0.15.zip" target="_blank">Binaries</a>
<br/>
- <a class="postlink" href="http://www.sukkology.net/software/nds/mctool-0.15-src.zip" target="_blank">Source</a>
<br/>
<br/>
The program uses a hacked version of Chishm's  libfat to allow for raw I/O:
<br/>
- <a class="postlink" href="http://www.sukkology.net/software/nds/libblockdev-src-20070108.tar.bz2" target="_blank">Source</a>
<br/>
- <a class="postlink" href="http://www.sukkology.net/software/nds/libblockdev-nds-20070108.tar.bz2" target="_blank">NDS binaries</a>
<br/>
- <a class="postlink" href="http://www.sukkology.net/software/nds/libblockdev-gba-20070108.tar.bz2" target="_blank">GBA binaries (untested)</a><br/>_________________<br/>Nintendo DS Lite (White) + Supercard Lite + R4 + Sandisk 1 GB MicroSD
<br/>
Sony PSP + Firmware 3.03 OE-A2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114628 - dantheman - Tue Jan 09, 2007 5:00 pm</h4>
    <div class="postbody"><span class="postbody">The scanning and fixing works fine for me, but sorting always hangs once it reaches my DSOrganize folders.  
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Sorting directory //DSOrganize/RESOURCES/
<br/>
getFATEntry:  Seek error!
<br/>
sortClusterChain:  Failed to get FAT entry!
<br/>
sort_FAT16_rootdir:  Failed to sort cluster chain!
<br/>
sort_fs:  Failed to sort FAT16 root directory!
<br/>
fatsort:
<br/>
Failed to sort file system!</td> </tr></table><span class="postbody">
<br/>
<br/>
The files up to that point get sorted fine.  I have not tried removing the directory and trying again, as I'm not on my home computer right now.
<br/>
<br/>
Just out of curiosity, what does the hacked version of libfat do?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114635 - SukkoPera - Tue Jan 09, 2007 5:55 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the testing.
<br/>
<br/>
That error shouldn't happen on a clean filesystem (and if you used the fix function, it should be clean now. It surely is if it reports no errors). What cart and card do you have, how big is the latter, and how full is it? Please do not delete that folder, it might help me fixing this bug.
<br/>
<br/>
The hacked version of libfat allows raw reading/writing of all the media cards supported by libfat. libfat itself, normally only allows reading/writing of files, but to do the sorting and fixing, I need to mess with the FAT structures myself. Look here for more details: <a href="http://forum.gbadev.org/viewtopic.php?t=12001&amp;start=135" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12001&amp;start=135</a><br/>_________________<br/>Nintendo DS Lite (White) + Supercard Lite + R4 + Sandisk 1 GB MicroSD
<br/>
Sony PSP + Firmware 3.03 OE-A2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114669 - dantheman - Tue Jan 09, 2007 11:33 pm</h4>
    <div class="postbody"><span class="postbody">I formatted my card and then copied all my files back to it before running the program again, and it did the same thing.  Your FAT tester claimed there were no errors in the filesystem at the time.  However, upon scanning now I get some long file name errors related to "gggg.todo" which I recognize as a random file I created in DSOrganize.  The error appears in both the checking and verification pass.  Here's what is displayed:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Orphaned long file name part "gggg.todo"
<br/>
Auto-deleting.
<br/>
A new long file name starts with in an old one.  
<br/>
Not auto-correcting this.</td> </tr></table><span class="postbody">
<br/>
<br/>
I just hit A to fix the errors and tried scanning again.  Now I only get "A new long file name starts with in an old one.  Not auto-correcting this" but now it claims that no errors were found.  Sorting crashes at the same spot as before.
<br/>
<br/>
In any case, I have a 2 Gbyte PQI brand miniSD card (pretty much a no-name brand, but it was only $20 so I picked it up).  I am using a Supercard MiniSD with firmware version 1.63b.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114671 - SukkoPera - Tue Jan 09, 2007 11:44 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the info, I'll look into that. However I don't have a 2 GB card so I can't do much. I have some ideas anyway...<br/>_________________<br/>Nintendo DS Lite (White) + Supercard Lite + R4 + Sandisk 1 GB MicroSD
<br/>
Sony PSP + Firmware 3.03 OE-A2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114677 - dantheman - Wed Jan 10, 2007 12:10 am</h4>
    <div class="postbody"><span class="postbody">How strange.  I removed the entire DSOrganize directory, and now it gets hung up on the directory right after that, "games"
<br/>
<br/>
Scanning gives a clean "no errors found" now.
<br/>
<br/>
EDIT:  doing a full checkdisk under Windows shows no errors, and the problem still exists.  Sorting inversely freezes after about the same amount of time, although at a different directory.
<br/>
<br/>
EDIT 2:  okay, I think my card is just faulty.  Fatsort used to work, but now it just closes out after about 2 minutes of inactivity (used to successfully sort within 30 seconds).  Guess I'd better search for some good SD formatting tools.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114682 - SukkoPera - Wed Jan 10, 2007 1:00 am</h4>
    <div class="postbody"><span class="postbody">Mmmmh, when you got that "Not auto-correcting this.", had you run the scan with X or Y?
<br/>
<br/>
EDIT: Argh sorry, there's a stupid bug which won't allow you to correct certain errors. I'll fix that and release a new version soon. Try to fix your card meanwhile :). If you use any UNIX O/S, just use dd to zero the whole card and then format it again.<br/>_________________<br/>Nintendo DS Lite (White) + Supercard Lite + R4 + Sandisk 1 GB MicroSD
<br/>
Sony PSP + Firmware 3.03 OE-A2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114692 - dantheman - Wed Jan 10, 2007 4:20 am</h4>
    <div class="postbody"><span class="postbody">Well this is just great.  I spent half an hour using a full SD formatter and added back only a few files, including DSLinux and the folder for it.  Sometimes sorting will fail in the DSLinux folder, and sometimes it will sort correctly.  How strange.  Of course, now that I keep trying to sort it to see which folder it was, every attempt is successful.  Odd.
<br/>
<br/>
It'll probably fail more often though as I load up my miniSD card with more stuff.
<br/>
<br/>
EDIT:  just as a status update, it now works fine.  Once again, it froze up in the DSLinux folder, but I tried a few more times until it gave successfull sorts every time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115715 - sinclair44 - Thu Jan 18, 2007 5:04 pm</h4>
    <div class="postbody"><span class="postbody">Hmm... seems neat. However, I cannot find the server <a href="http://www.sukkology.com" target="_blank">www.sukkology.com</a> in order to try out the program. :(
<br/>
<br/>
(Not having Windows, the alphabetizer on the DS itself would be awesome!)
<br/>
<br/>
EDIT: The download works now. Strange.<br/>_________________<br/>Inter arma enim silent leges</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#116401 - HyperHacker - Thu Jan 25, 2007 8:30 am</h4>
    <div class="postbody"><span class="postbody">I was hoping someone would make a program like this. Having your card corrupted when you're on vacation with no access to a computer to fix it is not fun!<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
