<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>JPEG Decompression Library - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Announcements And Comments > JPEG Decompression Library</h2>
<div id="posts">
<div class="post">
    <h4>#12284 - Burton Radons - Thu Nov 06, 2003 3:04 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://members.shaw.ca/burton-radons/gba-jpeg.zip" target="_blank">http://members.shaw.ca/burton-radons/gba-jpeg.zip</a>
<br/>
<br/>
I've updated my JPEG decompression library.  It now has no external dependencies (no memmove, malloc, or free), and no longer uses any permanent IWRAM.  Instead, it loads the necessary functions into IWRAM just before using them, so that you can waste permanent IWRAM storage on tasks which are called constantly.
<br/>
<br/>
In case you follow this forum but not graphics: this is a small JPEG decompression library written from scratch for portable devices.  It takes 7120 bytes of ROM space, no permanent IWRAM space, and has no external dependencies.  It takes less memory, is faster than, and is much smaller than jpeglib.
<br/>
<br/>
The only thing in the archive is a C and H file.  Just compile it normally; it does use GCC extensions, but otherwise it should take any level of warnings.  Here's a usage sample:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_DISPCNT = 3 | (1 &lt;&lt; (8 + 2)); /* Enable mode 3 and turn on background 2. */
<br/>
REG_BG2CNT = 0; /* Clear all BG2 parameters. */
<br/>
/* data should point to a regular JPEG file. */
<br/>
JPEG_DecompressImage (data, VideoBuffer, 240, 160);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
gba-image_jpeg.h is fairly configurable and has details on resource usage and limitations.  The code is in the public domain.
<br/>
<br/>
(Edit: Updated to fix where it loads into IWRAM and to exploit an allowance in JPEG baseline decoding to save 2576 bytes of stack space).
<br/>
<br/>
(Edit: Updated to compile with the strictest warnings possible, -ansi -pedantic.  It should now work on any C compiler.  Also, stack space usage is now locked, exploiting a restriction in the JPEG specification.  I also tweaked a limitation that had resulted in this code not being baseline-compliant.)
<br/>
<br/>
(Edit: Added assertion tests, which are stubs in embedded environs and fprintf to stderr if JPEG_DEBUG is set.  Also, I made some changes to allow it to compile as C++.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
