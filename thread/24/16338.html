<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Fixed Point Number Primer - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Patater's Introduction to Nintendo DS Programming > Fixed Point Number Primer</h2>
<div id="posts">
<div class="post">
    <h4>#165825 - the-anonymous-coward - Thu Jan 08, 2009 1:54 am</h4>
    <div class="postbody"><span class="postbody">I am a bit confused. I am still learning C++, so this may seem a dumb question. I am looking at a line of code like "REG_BG3PA = 1 &lt;&lt; 8;" and thinking that this is a bitwise operation, as in REG_BG3PA's binary value would now be ...1-0000-0000. Is that incorrect? Probably is. 
<br/>
<br/>
But in the tutorial patater states that "&lt;&lt; 8" is a fixed point number, but I don't understand how it is represented. Is there an article or something that someone knows of that can clarify this for me? 
<br/>
<br/>
I hope I explained my problem well enough. If someone doesn't understand just let me know and I will try to explain again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165828 - Dwedit - Thu Jan 08, 2009 3:02 am</h4>
    <div class="postbody"><span class="postbody">"Fixed point" is nothing more that using multiples of some big integer.
<br/>
It's like saying, "Let's always store a number as 256 times some number".
<br/>
So say that 5.0 = 256*5 = 1280
<br/>
Then say 3.0 = 256*3 = 768
<br/>
5.0+3.0= 256*8 = 2048
<br/>
Then when you want to get the integer part back, you divide by 256, and get 8.
<br/>
<br/>
The advantage of fixed point is that fractional numbers can be stored.  2.5 would be 256*2.5 = 640.  Using 8 bits for the fractional part means you can have fractions from 1/256 to 255/256.  But 0.1 would be 25.6/256, and the .6 gets clipped off, so you would either need to take 25/256 or 26/256 for that number.
<br/>
<br/>
"&lt;&lt;" is the left shift operator.  "&lt;&lt; 8" is identical to "* 256".
<br/>
<br/>
The binary value you mentioned is indeed 1-0000-0000, and that is correct.
<br/>
<br/>
Addition and subtraction of fixed point numbers works just like regular addition and subtraction.  Multiplying two fixed point numbers together requires you to shift the final result right by 8 afterwards to have a fixed point number that follows the same format as the arguments.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165829 - the-anonymous-coward - Thu Jan 08, 2009 7:52 am</h4>
    <div class="postbody"><span class="postbody">Oh, thanks a lot. That was a very helpful explanation. Perhaps patater could link this topic for further reading? It isn't that the tutorial was poorly written, it's just that I personally needed a bit more, and this did it. Plus, there may be others who need something like this to understand. Thanks again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165832 - sgeos - Thu Jan 08, 2009 8:56 am</h4>
    <div class="postbody"><span class="postbody">Working through macros can make things more obvious for readers of your code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/*** Fixed Point Macros
<br/>
 */
<br/>
// value = value before conversion
<br/>
// bits = bits in fractional component
<br/>
#define FLOAT2FIXED(value,bits) ((int)((value)*(1&lt;&lt;(bits))))
<br/>
#define FIXED2FLOAT(value,bits) ((float)(value)/(1&lt;&lt;(bits)))
<br/>
#define FIXED2INT(value,bits) ((value)&gt;&gt;(bits))</td> </tr></table><span class="postbody">
<br/>
They are used like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/*** Examples Using PI
<br/>
 */
<br/>
fixed_t my_fixed = FLOAT2FIXED(    3.14159, 21);  // ==    6588391   == 0x006487E7
<br/>
int     my_int   = FIXED2INT(   0x006487E7, 21);  // ==          3   == 0x00000003
<br/>
float   my_float = FIXED2FLOAT( 0x006487E7, 21);  // == 3.14158964   (yes, fixed point numbers have major rounding errors)</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
