<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>dsdoom compiling problems - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Misc > dsdoom compiling problems</h2>
<div id="posts">
<div class="post">
    <h4>#117887 - Diddl - Thu Feb 08, 2007 8:46 am</h4>
    <div class="postbody"><span class="postbody">it seems with devkitARM r20 comes big changes. I've trouble to compile dsdoom now.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117934 - wintermute - Thu Feb 08, 2007 9:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Diddl wrote:</b></span></td> </tr> <tr> <td class="quote">it seems with devkitARM r20 comes big changes. I've trouble to compile dsdoom now.</td> </tr></table><span class="postbody">
<br/>
<br/>
Builds fine for me, did you try svn?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117946 - Diddl - Thu Feb 08, 2007 10:09 pm</h4>
    <div class="postbody"><span class="postbody">no, i use this version 1.1 from Jefklak (<a class="postlink" href="http://www.jefklak.com/Guides/Doom-DS" target="_blank">klick</a>) and I have some more modifications in it (Wad menu, /doom game directory, separate SAV directories for each WAD, support for R4/DSlink/Ninja ...).
<br/>
<br/>
<br/>
with old toolkit it compiles fine. now I changed to v20 and newest libnds and newest libfat. now comes many errors ...
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-eabi-gcc -MMD -MP -MF /D/Proj/NDS/dsdoom_v110_src/arm9/build/i_main.d -g -Wa
<br/>
ll -O2 -march=armv5te -mtune=arm946e-s -fomit-frame-pointer -fno-strict-aliasing
<br/>
 -ffast-math -marm -mthumb-interwork -I/D/Proj/NDS/dsdoom_v110_src/arm9/include
<br/>
-I/d/Programme/devkitPro/libnds/include -I/D/Proj/NDS/dsdoom_v110_src/arm9/build
<br/>
 -DARM9 -D__NDS__ -c /D/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c -o i_main.
<br/>
o
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c: In function 'switchConsole':
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:529: warning: implicit declarat
<br/>
ion of function 'M_SizeDisplay'
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c: In function 'main':
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:574: warning: assignment from i
<br/>
ncompatible pointer type
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:592: error: 'VRAM_A_MAIN_BG_0x6
<br/>
000000' undeclared (first use in this function)
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:592: error: (Each undeclared id
<br/>
entifier is reported only once
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:592: error: for each function i
<br/>
t appears in.)
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:593: error: 'VRAM_B_MAIN_BG_0x6
<br/>
020000' undeclared (first use in this function)
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:638: warning: suggest explicit
<br/>
braces to avoid ambiguous 'else'
<br/>
d:/Proj/NDS/dsdoom_v110_src/arm9/source/i_main.c:639: warning: suggest explicit
<br/>
braces to avoid ambiguous 'else'
<br/>
make[2]: *** [i_main.o] Error 1
<br/>
make[1]: *** [build] Error 2
<br/>
make[1]: Leaving directory `/D/Proj/NDS/dsdoom_v110_src/arm9'
<br/>
make: *** [arm9/dsdoom.elf] Error 2
<br/>
$</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117952 - wintermute - Thu Feb 08, 2007 10:34 pm</h4>
    <div class="postbody"><span class="postbody">Get 1.1.1 from SVN.
<br/>
<br/>
That includes Jefklak's updates and has been moved to libfat proper, it also builds just fine with r20.
<br/>
<br/>
What does support for R4/DSlink/Ninja involve?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117954 - Diddl - Thu Feb 08, 2007 10:35 pm</h4>
    <div class="postbody"><span class="postbody">ok, looking exactly it is clear ...
<br/>
<br/>
<br/>
VRAM_B_MAIN_BG_0x6000000 ==&gt;
<br/>
VRAM_B_MAIN_BG_0x06000000</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117957 - wintermute - Thu Feb 08, 2007 10:42 pm</h4>
    <div class="postbody"><span class="postbody">Still, it might be interesting to see your changes and incorporate them in svn,  they sound quite interesting.
<br/>
<br/>
What does support for R4/DSlink/Ninja involve?
<br/>
<br/>
Is that just moving to libfat?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118059 - Diddl - Fri Feb 09, 2007 4:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Still, it might be interesting to see your changes and incorporate them in svn,  they sound quite interesting.</td> </tr></table><span class="postbody">
<br/>
<br/>
is no problem. after todays work I will upload binary and source.
<br/>
<br/>
it's only a small beginners work for me (to learn NDS developing).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">What does support for R4/DSlink/Ninja involve?</td> </tr></table><span class="postbody">
<br/>
<br/>
i have changes in this io-drivers, because most of them doesn't have a timeout, so some of them 'hang' if this card isn't inserted.
<br/>
<br/>
currently I own a DS-Link, a M3 DS simply, a supercard lite and a M3 lite. same version of dsdoom wil work fine with all of this 4 cards.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Is that just moving to libfat?</td> </tr></table><span class="postbody">
<br/>
<br/>
the day bevore yesterday I didn't know that there is a differnce between gba_nds_fat and libfat. 
<br/>
<br/>
I have a download of Devkitpro 20, latest libnds and latest libfat and I wanted to compile dsdoom again. now I have only devkit 20 with latest libnds and old fat sources - and it works/compiles fine now!
<br/>
<br/>
I have implemented all my modified io-drivers in current libfat. It works fine.
<br/>
<br/>
###
<br/>
<br/>
rewrite of dsdoom to fit with libfat is a big thing. all FAT_ call to new function names ...
<br/>
<br/>
I think I will make a wrapper to go with new libfat.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118066 - wintermute - Fri Feb 09, 2007 6:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Diddl wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">What does support for R4/DSlink/Ninja involve?</td> </tr></table><span class="postbody">
<br/>
<br/>
i have changes in this io-drivers, because most of them doesn't have a timeout, so some of them 'hang' if this card isn't inserted.
<br/>
<br/>
currently I own a DS-Link, a M3 DS simply, a supercard lite and a M3 lite. same version of dsdoom wil work fine with all of this 4 cards.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Does the new libfat also require these changes?
<br/>
<br/>
One big change for the latest libfat is the addition of the DLDI system which allows the binary to be patched for cards either not supported by default or not yet invented.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
rewrite of dsdoom to fit with libfat is a big thing. all FAT_ call to new function names ...
<br/>
<br/>
I think I will make a wrapper to go with new libfat.</td> </tr></table><span class="postbody">
<br/>
<br/>
Well, as I said the dsdoom current SVN already has the necessary changes for libfat.
<br/>
<br/>
<a href="http://code.google.com/p/dsdoom/" target="_blank">http://code.google.com/p/dsdoom/</a>
<br/>
<br/>
I'm not sure why you would write a wrapper for the new libfat, the new function calls are all stdio - this was kind of the point.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118077 - Diddl - Fri Feb 09, 2007 10:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Does the new libfat also require these changes?
<br/>
<br/>
One big change for the latest libfat is the addition of the DLDI system which allows the binary to be patched for cards either not supported by default or not yet invented.</td> </tr></table><span class="postbody">
<br/>
<br/>
I offered Chishm this changes but he said io-driver are frozen since 12/2007 cause of DLDI.
<br/>
<br/>
DLDI is a very good idea, - for new (unknown) devices! but I prefer a simple mehtode. simple for end user ...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Well, as I said the dsdoom current SVN already has the necessary changes for libfat.
<br/>
<br/>
<a href="http://code.google.com/p/dsdoom/" target="_blank">http://code.google.com/p/dsdoom/</a></td> </tr></table><span class="postbody">
<br/>
<br/>
oh! super! I will download it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not sure why you would write a wrapper for the new libfat, the new function calls are all stdio - this was kind of the point.</td> </tr></table><span class="postbody">
<br/>
<br/>
ah! I understand now, - this is the reason cause there is only one small fat.h without file and directory functions. 
<br/>
<br/>
I was wondering about and thought anyone has forgotten to include fatfile.h and fatdir.h!
<br/>
<br/>
###
<br/>
<br/>
DsDoom binary old devkit (.nds): <a class="postlink" href="http://web3.vs2066076.netfabrik.de/nds/dsdoom.zip" target="_blank">klick</a>
<br/>
DsDoom Src old devkit (.nds): <a class="postlink" href="http://web3.vs2066076.netfabrik.de/nds/arm9-03.zip" target="_blank">klick</a>
<br/>
DsDoom Src new devkit (.nds): <a class="postlink" href="http://web3.vs2066076.netfabrik.de/nds/arm9-devk20.zip" target="_blank">klick</a>
<br/>
<br/>
my new devkit version is buggy yet. but now I take a look at your new dsdoom version!
<br/>
<br/>
### 
<br/>
<br/>
I dream of a ROTT version for NDS, or a Jonof Duke3d version for NDS, or a shadow warrior ...
<br/>
<br/>
but it seems I'm too weak. I tried to compile a ROTT source without success. do you think it is possible?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118261 - Diddl - Sun Feb 11, 2007 5:49 pm</h4>
    <div class="postbody"><span class="postbody">sorry, dsdoom from (http://code.google.com/p/dsdoom/) doesn't run on my NDS lite. neither binary nor compiled source, both give same results.
<br/>
<br/>
source compiles fine with new devkitpro 20. 
<br/>
<br/>
after starting dsdoom (tested on 4 cards patched with dldi) I choose "standard game". many console messages up to R_INIT DATA and this loading points. after that black screen (both screen) and nothing more ...
<br/>
<br/>
###
<br/>
<br/>
Jefklak (http://www.jefklak.com/Files/Doom?action=set) also has a new version with dldi running fine.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119623 - moose - Sat Feb 24, 2007 9:15 pm</h4>
    <div class="postbody"><span class="postbody">I just wanted to second the above listed version 1.1.0 working on the R4, saves also work.  V111 hangs at black screens after the initial loading and ... progression at the very end before the DOOM title screen should appear.<br/>_________________<br/>Of all the things I have lost, I miss my mind the most.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
