<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DS Option packs - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS Misc > DS Option packs</h2>
<div id="posts">
<div class="post">
    <h4>#159017 - Mohammad - Tue Jun 24, 2008 11:00 am</h4>
    <div class="postbody"><span class="postbody">Are "DS Option Packs" coded in the same way as one another? Well, I just got "Guitar Hero: On Tour" And was wandering if I could use the option pack on it. Imagine using google maps with that: the top two are zoom+ and zoom- while the next one is an options menu(which u could either touch or use the pack) and the last one will take you to your home location (or if you hit it while at your home location [ex: accidental hit so you hit it again] you could go back to where you were at)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159031 - cheesethulhu - Tue Jun 24, 2008 2:48 pm</h4>
    <div class="postbody"><span class="postbody">I'm not sure about any other DS Option Packs (I've looked at the libnds code for the rumble pack and I suspect it counts as one), but, as for the Guitar Grip (TM), I picked one up on Sunday and played around with it a bit.
<br/>
<br/>
First, you need to make sure you can use the GBA bus from the processor you're on.  Call sysSet<span style="font-weight: bold">Cart</span>Owner() with either BUS_OWNER_ARM9 or BUS_OWNER_ARM7.
<br/>
<br/>
To detect the grip, you might want to look at the rumble code in libnds.  Check GBA_HEADER.is96h to make sure there isn't a game in SLOT-2 (0x96 means there is a game).  Then check if GBA_BUS[0] has bits 9 and 10 cleared.  The guitar grip has pull down resistors on GBA pins 15 and 16, so it should always force bits 9 and 10 to zero.  There may be more to detection than that, since other option packs might look similar.
<br/>
<br/>
To get the fret button statuses, just read any address from GBA SRAM, like SRAM[0], and bits 3-6 are blue through green.  The buttons pull the lines down, so zero means pressed.
<br/>
<br/>
Sorry if this is incoherent or telling you things you already know.  I only found this stuff out on Sunday and I'm a bit low on sleep.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159041 - Mohammad - Tue Jun 24, 2008 8:10 pm</h4>
    <div class="postbody"><span class="postbody">no I really have no clue when it comes down to raw inputs. You wouldn't happen to have a simple code with the stuff you were saying would you? (I learn better by looking a code) I might try to make a simple libary for it until a good one is out.[/img]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159044 - cheesethulhu - Tue Jun 24, 2008 9:10 pm</h4>
    <div class="postbody"><span class="postbody">This is based on the arm9 template from the libnds example code.  I don't know how to mark the changes I made (is it possible with BBCode?), so if you can't pick them out by comparing it to the original template, please let me know.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
/*---------------------------------------------------------------------------------
<br/>
<br/>
   $Id: main.c,v 1.5 2007/10/23 00:46:29 wntrmute Exp $
<br/>
<br/>
   Simple console print demo
<br/>
   -- dovoto
<br/>
<br/>
---------------------------------------------------------------------------------*/
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
#include &lt;stdlib.h&gt;
<br/>
#include &lt;unistd.h&gt;
<br/>
<br/>
bool isGuitarGripInserted(void) {
<br/>
<br/>
   // Take ownership of the GBA bus (Cart, not Card)
<br/>
   sysSetCartOwner(BUS_OWNER_ARM9);
<br/>
<br/>
   // Test for a GBA game being inserted
<br/>
   if(GBA_HEADER.is96h == 0x96) {
<br/>
      // Detected a GBA game, so no guitar grip
<br/>
      return false;
<br/>
   }
<br/>
<br/>
   // Check to see if data lines 15 and 16 are pulled down
<br/>
   if(((~GBA_BUS[0]) &amp; 0x0600) == 0x0600) {
<br/>
      // Likely the guitar grip
<br/>
      return true;
<br/>
   }
<br/>
<br/>
   return false;
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
int main(void) {
<br/>
//---------------------------------------------------------------------------------
<br/>
   touchPosition touchXY;
<br/>
   bool grip_detected;
<br/>
   u8 grip_state;
<br/>
<br/>
   irqInit();
<br/>
   irqEnable(IRQ_VBLANK);
<br/>
<br/>
   videoSetMode(0);   //not using the main screen
<br/>
   videoSetModeSub(MODE_0_2D | DISPLAY_BG0_ACTIVE);   //sub bg 0 will be used to print text
<br/>
   vramSetBankC(VRAM_C_SUB_BG);
<br/>
<br/>
   SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
<br/>
   BG_PALETTE_SUB[255] = RGB15(31,31,31);   //by default font will be rendered with color 255
<br/>
<br/>
   //consoleInit() is a lot more flexible but this gets you up and running quick
<br/>
   consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(31), (u16*)CHAR_BASE_BLOCK_SUB(0), 16);
<br/>
<br/>
<br/>
   grip_detected = isGuitarGripInserted();
<br/>
<br/>
   iprintf("\n\n\tHello DS dev'rs\n");
<br/>
   iprintf("\twww.drunkencoders.com");
<br/>
<br/>
   if(!grip_detected) {
<br/>
      iprintf("\nGuitar Grip not detected.\n");
<br/>
   }
<br/>
<br/>
   while(1) {
<br/>
<br/>
      touchXY=touchReadXY();
<br/>
      iprintf("\x1b[10;0HTouch x = %04X, %04X\n", touchXY.x, touchXY.px);
<br/>
      iprintf("Touch y = %04X, %04X\n", touchXY.y, touchXY.py);
<br/>
<br/>
      if(grip_detected) {
<br/>
         grip_state = SRAM[0];
<br/>
<br/>
         iprintf("  Blue is %s\n", (grip_state &amp; BIT(3)) ? "  up" : "down");
<br/>
         iprintf("Yellow is %s\n", (grip_state &amp; BIT(4)) ? "  up" : "down");
<br/>
         iprintf("   Red is %s\n", (grip_state &amp; BIT(5)) ? "  up" : "down");
<br/>
         iprintf(" Green is %s\n", (grip_state &amp; BIT(6)) ? "  up" : "down");
<br/>
      }
<br/>
<br/>
      swiWaitForVBlank();
<br/>
   }
<br/>
<br/>
   return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159074 - HyperHacker - Wed Jun 25, 2008 3:29 am</h4>
    <div class="postbody"><span class="postbody">Hm, this device could be useful for media player controls.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159079 - tepples - Wed Jun 25, 2008 3:51 am</h4>
    <div class="postbody"><span class="postbody">But one would probably have to be a big fan of Guitar Hero in order to justify buying the Guitar Grip for $50, even if it does come with a game at no additional charge.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159095 - Mohammad - Wed Jun 25, 2008 11:38 am</h4>
    <div class="postbody"><span class="postbody">Already working on one lol, but it helps if I knew what I was doing :/ my plans
<br/>
<br/>
---- Griping_Music.txt ----
<br/>
Top button    -&gt; Play/Pause
<br/>
Mid-top         -&gt; Volume +/- (hit this then top for + and mid-top for -)
<br/>
Mid-bottom   -&gt; Skip next
<br/>
Bottom         -&gt; Skip prev
<br/>
Top&amp;Bottom  -&gt; Stop
<br/>
------------------------------
<br/>
<br/>
But yeah I'm aways away, but hey you got to have a project you like other wise you will get no where :) 
<br/>
<br/>
@tepples but soon people are bound to brake it meaning that will have to sell replacements for about $15 but that will make the game less in value, so they are probably going to wait awhile.
<br/>
<br/>
I'll post my code later there is something that's bothering the heck out of me (doesn't do what I say, but works)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159389 - 11X_daemon_X11 - Mon Jun 30, 2008 2:24 am</h4>
    <div class="postbody"><span class="postbody">I ahve a question... not to sound crazy or anything, but is there really a true point to this? The only thing I could see possibly coming from this is a single Guitar hero-esque homebrew with custom song input =\ lol<br/>_________________<br/>IRC (please join :D):
<br/>
<br/>
<a href="http://evilnetirc.ath.cx/" target="_blank">http://evilnetirc.ath.cx/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
