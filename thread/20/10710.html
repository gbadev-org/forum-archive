<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Controlling private keys? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Misc > Controlling private keys?</h2>
<div id="posts">
<div class="post">
    <h4>#97074 - tepples - Mon Aug 07, 2006 8:59 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=10709" target="_blank">This topic</a> claimed that a poster's acquaintance had access to Nintendo's private signing key for DS Download Play, and it asked whether it would be a good idea for this acquaintance to leak the trade secret. The topic was locked for good reason.
<br/>
<br/>
But it's not even known whether it would have had any effect. Here are some ways I can think of that Nintendo can give out official development kits while preventing trade secret leaks from causing any damage: <ol type="1"><li>Developer DS does not verify DS Download Play signature, much like the FlashMe firmware hack. This way, the retail DS key pair remains in the vault at Nintendo.  </li><li>Different key pairs for developer and retail DS systems. I seem to remember that Xbox does this. </li><li>Option 2, with a <span style="font-style: italic">unique</span> key pair for each licensee. </li></ol> Any other ideas on this topic?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97088 - Nushio - Mon Aug 07, 2006 9:37 pm</h4>
    <div class="postbody"><span class="postbody">I guess #1.
<br/>
<br/>
IMO, only publishers, not developers, have access to the private key. 
<br/>
<br/>
Its the people who print the cartridges in mass the ones that really need it anyways. 
<br/>
<br/>
As for the developers? They have huge Nitro boxes and other stuff anyways. 
<br/>
<br/>
IIRC, Mario &amp; Luigi PiT was developed using 2 GBAs, a SNES pad and a link cable. 
<br/>
<br/>
If they really needed a private key to send over the air, they would most probably purchase developer ds that are flashed so that they dont do the RSA check.
<br/>
<br/>
Edit: All I said was based on presumption, guesses, and are in no way valid, official or even right.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97106 - Turambar - Tue Aug 08, 2006 12:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Nushio wrote:</b></span></td> </tr> <tr> <td class="quote">IMO, only publishers, not developers, have access to the private key.
<br/>
Its the people who print the cartridges in mass the ones that really need it anyways.</td> </tr></table><span class="postbody">
<br/>
Do they really need it? I don't actually know how it works, but wouldn't it be posible that the publisher sends the game to nintendo, who encripts it and sends it back to the publisher? You don't need the key to mass produce cartridges, you only need an encripted copy. Of course, this method would mean that every game has to have Nintendo's approval, but doesn't this already happen?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97108 - Nushio - Tue Aug 08, 2006 12:44 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Turambar wrote:</b></span></td> </tr> <tr> <td class="quote">Do they really need it? I don't actually know how it works, but wouldn't it be posible that the publisher sends the game to nintendo, who encripts it and sends it back to the publisher?
<br/>
<span style="font-weight: bold">You don't need the key to mass produce cartridges</span>, you only need an encripted copy. Of course, this method would mean that every game has to have Nintendo's approval, but doesn't this already happen?</td> </tr></table><span class="postbody">
<br/>
<br/>
Thats entirely true, you dont need the key to mass produce cartridges. I dont  know if Nintendo has to personally sign/encrypt all published games. Its possible, yes. 
<br/>
<br/>
This leaves us with several questions though...
<br/>
<br/>
Do developers have a key? Even if unique and unuseful on mass-produced NDS (Rather than Dev DSs). 
<br/>
Can we talk about it? Isnt this piracy-related, since we should<span style="font-weight: bold">n't</span> use any "official documentation"?
<br/>
Will Clark Kent save Batman in time and still have the date with <span style="font-weight: bold">Lois </span> Lane?
<br/>
Tune in to find out on the next episode of...
<br/>
DsDev!
<br/>
<br/>
Edit: Pwnd .</span><span class="gensmall"><br/><br/>Last edited by Nushio on Tue Aug 08, 2006 2:03 pm; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#97129 - Magitek - Tue Aug 08, 2006 3:30 am</h4>
    <div class="postbody"><span class="postbody">Just my 2 cents, but I dont think that every licensee has their own unique key, because then otherwise newer DSes would have to have some way of updating its firmware to accept keys of newer developers. It would be a futureproof nightmare.
<br/>
<br/>
I think it's ok to talk about it, as long as nobody in here pulls out a copy of official dev guides or something. My question is that if somebody ever accidentally stumbles onto the key, can it be released, or will that person have to keep their mouth shut?
<br/>
<br/>
<br/>
P.S. And I hope that Superman doesnt have a date with Louis Lane, unless Superman changed orientation since the comic books and movies, heh.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97138 - tepples - Tue Aug 08, 2006 4:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Turambar wrote:</b></span></td> </tr> <tr> <td class="quote">I don't actually know how it works, but wouldn't it be posible that the publisher sends the game to nintendo, who encripts it and sends it back to the publisher?</td> </tr></table><span class="postbody">
<br/>
That would get slow if you are developing a program on DS Download Play and have to send <span style="font-style: italic">every single build</span> to Nintendo to get it signed.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Nushio wrote:</b></span></td> </tr> <tr> <td class="quote">Can we talk about it? Isnt this piracy-related, since we should use any "official documentation"?</td> </tr></table><span class="postbody">
<br/>
We're talking about what's plausible, not what's the case.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Magitek wrote:</b></span></td> </tr> <tr> <td class="quote">Just my 2 cents, but I dont think that every licensee has their own unique key, because then otherwise newer DSes would have to have some way of updating its firmware to accept keys of newer developers. It would be a futureproof nightmare.</td> </tr></table><span class="postbody">
<br/>
As I see it, you'd have the retail Nintendo DS (retail), the "Nintendo" custom DS (for internal use by Nintendo), the "Konami" custom DS (for internal use by Konami), the "Capcom" custom DS (for internal use by Capcom), etc. Each would contain DS Download Play firmware that responds only to its unique private signing key. The final build accepted by Nintendo would get re-signed with the retail key.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Magitek wrote:</b></span></td> </tr> <tr> <td class="quote">P.S. And I hope that Superman doesnt have a date with Louis Lane, unless Superman changed orientation since the comic books and movies, heh.</td> </tr></table><span class="postbody">
<br/>
<a class="postlink" href="http://www.superdickery.com/" target="_blank">Superman is already a dick</a>; why can't he be <a class="postlink" href="http://www.google.com/search?q=gay+superman" target="_blank">gay too</a>?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97152 - Lynx - Tue Aug 08, 2006 6:20 am</h4>
    <div class="postbody"><span class="postbody">Do we know for sure that every developer (or development house) has the private key?  And if they do, I would expect that not the whole development team would have access to it..  I'm sure if the key did make it out to the internet, someone (if not many) would be in deep crap over it.  I'm sure something as critical as that would have many tracking methods.<br/>_________________<br/><a class="postlink" href="http://www.ndshb.com" target="_blank">NDS Homebrew Roms &amp; Reviews</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97158 - wintermute - Tue Aug 08, 2006 6:39 am</h4>
    <div class="postbody"><span class="postbody">It's extremely unlikely that anyone outside Nintendo has the private key. There's an application circulating which loads and executes the first download play broadcast it finds - I'd imagine that's what developers use for testing purposes. You still need another boot method to use it so it's not really that useful for homebrewers.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97173 - Lick - Tue Aug 08, 2006 10:47 am</h4>
    <div class="postbody"><span class="postbody">@ tepples -
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Nushio wrote:</b></span></td> </tr> <tr> <td class="quote">If they really needed a private key to send over the air, they would most probably purchase developer ds that are flashed so that they dont do the RSA check.</td> </tr></table><span class="postbody">
<br/>
<br/>
I think developers just use developing firmware, ala flashme.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97220 - Turambar - Tue Aug 08, 2006 6:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Turambar wrote:</b></span></td> </tr> <tr> <td class="quote">I don't actually know how it works, but wouldn't it be posible that the publisher sends the game to nintendo, who encripts it and sends it back to the publisher?</td> </tr></table><span class="postbody">
<br/>
That would get slow if you are developing a program on DS Download Play and have to send <span style="font-style: italic">every single build</span> to Nintendo to get it signed.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Of course, that is not what I meant. During development, they could use your Option 1 or 2, and only when they are done they'll send it to Nintendo to get it signed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97254 - HyperHacker - Tue Aug 08, 2006 9:44 pm</h4>
    <div class="postbody"><span class="postbody">I've seen the official devkit. It has a tool to sign the files, but you need a signature file or some such from Nintendo. So I doubt the dev units verify signatures.
<br/>
(Interesting side note: there's a Download Play app that doesn't verify signatures as well, but it's not signed. :-p)<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97258 - Magitek - Tue Aug 08, 2006 9:53 pm</h4>
    <div class="postbody"><span class="postbody">So then that means that Nintendo probably has 1 private key that it obfuscates and shares with developers. So devs dont know the private key per se, but they have a file given by Nintendo that contains it and when in use with another program it allows them to sign it.
<br/>
<br/>
I was reading an article posted in one of the GBA forums of this site and it talked about how games are sent to Nintendo for a final "lot check" where they make sure that the program behaves in a Nintendo approved quality. Perhaps with DS games they are sent there and are keyed with the correct private key ready for the publisher to use to start production.
<br/>
<br/>
So in other words, the devs most likely dont know nor care about what Nintendo's private key is. So now the question is, if someone were ever able to theoretically calculate or guess (yes, I know the odds of it are next to none), could we then take it and sign our own homebrew?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97260 - Dan2552 - Tue Aug 08, 2006 10:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Magitek wrote:</b></span></td> </tr> <tr> <td class="quote">if someone were ever able to theoretically calculate or guess (yes, I know the odds of it are next to none), could we then take it and sign our own homebrew?</td> </tr></table><span class="postbody">
<br/>
<br/>
Probably, why not?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97476 - caitsith2 - Thu Aug 10, 2006 2:15 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Magitek wrote:</b></span></td> </tr> <tr> <td class="quote">So then that means that Nintendo probably has 1 private key that it obfuscates and shares with developers. So devs dont know the private key per se, but they have a file given by Nintendo that contains it and when in use with another program it allows them to sign it.
<br/>
<br/>
I was reading an article posted in one of the GBA forums of this site and it talked about how games are sent to Nintendo for a final "lot check" where they make sure that the program behaves in a Nintendo approved quality. Perhaps with DS games they are sent there and are keyed with the correct private key ready for the publisher to use to start production.
<br/>
<br/>
So in other words, the devs most likely dont know nor care about what Nintendo's private key is. So now the question is, if someone were ever able to theoretically calculate or guess (yes, I know the odds of it are next to none), could we then take it and sign our own homebrew?</td> </tr></table><span class="postbody">
<br/>
<br/>
Unfortunately no.  I too have seen the official dev kit.  The developers upload their complete binary to a nintendo (likely password protected) server.  THe server generates the signature file with the retail private key.  The signature file is then available for download by the developers.  A seperate program is then used to attach the signature to the binary they uploaded a copy of.
<br/>
<br/>
If you remember looking at the files of DS download Station vol 1,  there was such a signature file present, along with the already signed client.  The data contained in the signature file, is exactly the same as the signature data in the ds download play client.
<br/>
<br/>
In other words, no developer has any direct access whatsoever to nintendo's private key, other than possibly nintendo themselves.
<br/>
<br/>
As stated though, nintendo has provided a client for allowing the developers to test their DS download play code on retail systems.  (they have to flash this client to an official DS flash card to use it.)  Alternatively, any developers following the homebrew scene could flash a number of retail systems with flashme, and use the DS download play function as normal then.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97487 - Magitek - Thu Aug 10, 2006 3:32 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>caitsith2 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
As stated though, nintendo has provided a client for allowing the developers to test their DS download play code on retail systems.  </td> </tr></table><span class="postbody">
<br/>
<br/>
So are you saying that even if we ever somehow got the private key, we still could not sign our own homebrew?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97494 - wintermute - Thu Aug 10, 2006 4:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Magitek wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>caitsith2 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
As stated though, nintendo has provided a client for allowing the developers to test their DS download play code on retail systems.  </td> </tr></table><span class="postbody">
<br/>
<br/>
So are you saying that even if we ever somehow got the private key, we still could not sign our own homebrew?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
No, he's saying that no-one outside Nintendo has access to the private key. The chances of obtaining said key through industrial espionage are low to the point of it's never gonna happen.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97505 - ssj4android - Thu Aug 10, 2006 5:09 am</h4>
    <div class="postbody"><span class="postbody">And what if someone tried to upload FlashMe to Nintendo's server? ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97506 - tepples - Thu Aug 10, 2006 5:11 am</h4>
    <div class="postbody"><span class="postbody">It is believed that Nintendo develops all ARM7 binaries. It is likely that Nintendo's server refuses to sign unknown ARM7 binaries.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97507 - ssj4android - Thu Aug 10, 2006 5:15 am</h4>
    <div class="postbody"><span class="postbody">And FlashMe needs to use a custom ARM7 binary?
<br/>
Of course, it would never happen if the developer was sane. I'm sure the signed files contain some way to trace it back to the developer, who would certainly be sued.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97515 - caitsith2 - Thu Aug 10, 2006 6:18 am</h4>
    <div class="postbody"><span class="postbody">Thats probably what the extra bytes are for.
<br/>
<br/>
Here is the format of the .sgn file.  (reversed completely from the only such file I have.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Offset        Num Bytes        Description
<br/>
0x0000      4                      Signature start (0x61, 0x63, 0x01, 0x00)
<br/>
0x0004      128                   Signature data
<br/>
0x0084      4                      Extra data
<br/>
0x0088      12                    NDS header Title
<br/>
0x0094      4                      NDS header Game Code
<br/>
0x0098      2                      NDS header binary revision
<br/>
0x0099      1                      End of signature data file. (0x00)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Those 4 extra bytes is likely how nintendo will be able to trace which developer uploaded the flashme binary, if any does, and releases that signed flashme binary.
<br/>
<br/>
<br/>
All attachsign.exe does, is simply compare the header data of the signature file with the header data of the binary, and if it matches, then attaches the signature to the end of the binary.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97522 - Magitek - Thu Aug 10, 2006 8:39 am</h4>
    <div class="postbody"><span class="postbody">Well, I guess its a good thing that the download play has not been cracked because although it would make homebrew dev a lot more interesting not to mention easier, it does provide a dark avenue for more malicious users to provide malware under the disguise as a download station or multiplayer game. 
<br/>
<br/>
Should the Download play be broken by some other means and this malware problem ever occur, do you think this would be something that would warrant a recall by Nintendo? Especially with the Wii coming up as something planned to increase connectivity between consoles and users?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97566 - knight0fdragon - Thu Aug 10, 2006 2:37 pm</h4>
    <div class="postbody"><span class="postbody">recall... I doubt it, more likely another security upgrade with the newer models, return for free for those still under warrenty, and like an $80 repair for those not under warrenty lol<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97574 - darkfader - Thu Aug 10, 2006 3:48 pm</h4>
    <div class="postbody"><span class="postbody">Publishers are not going to risk being detected by asking to sign some random program. The only way is that a developer makes a backdoor in some WMB game.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97909 - Lynx - Sat Aug 12, 2006 8:57 am</h4>
    <div class="postbody"><span class="postbody">Replace 'makes a backdoor' with 'writes poor code that can be exploited'.. more likely..<br/>_________________<br/><a class="postlink" href="http://www.ndshb.com" target="_blank">NDS Homebrew Roms &amp; Reviews</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98357 - HyperHacker - Mon Aug 14, 2006 9:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">It is believed that Nintendo develops all ARM7 binaries. It is likely that Nintendo's server refuses to sign unknown ARM7 binaries.</td> </tr></table><span class="postbody">
<br/>
I'm sure a simple NDS launcher or similar could be made using the ARM7 binary taken from a commercial game... but you'd still have to get the password to upload your binary to the server, and it'd probably be quite illegal. :-p
<br/>
<br/>
Has Sega made any WMB games? They seem to know nothing about security.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98497 - Nushio - Tue Aug 15, 2006 5:16 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">It is believed that Nintendo develops all ARM7 binaries. It is likely that Nintendo's server refuses to sign unknown ARM7 binaries.</td> </tr></table><span class="postbody">
<br/>
I'm sure a simple NDS launcher or similar could be made using the ARM7 binary taken from a commercial game... but you'd still have to get the password to upload your binary to the server, and it'd probably be quite illegal. :-p
<br/>
<br/>
Has Sega made any WMB games? They seem to know nothing about security.</span></td> </tr></table><span class="postbody">
<br/>
Would Sonic Rush count? It comes with a demo that has a 2 stage loader, which could be exploited. 
<br/>
<br/>
I think Mighty Max has already started investigation on how to exploit this.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
