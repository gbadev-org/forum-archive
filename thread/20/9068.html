<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>[Joke] Firmware flaw allows unsigned code execution! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS Misc > [Joke] Firmware flaw allows unsigned code execution!</h2>
<div id="posts">
<div class="post">
    <h4>#77497 - HyperHacker - Sat Apr 01, 2006 10:14 am</h4>
    <div class="postbody"><span class="postbody">I was poking through the firmware, hoping to find a way to trick games into running in debug mode, and I found something even better. I'd noticed that the firmware turns the microphone on while looking for programs in DS Download Play... I couldn't imagine why, figured it must be a glitch. But then I noticed it's actually reading in data from the microphone. But why?
<br/>
<br/>
After another few minutes of poking, I figured out why, and almost fell out of my chair. The firmware is looking for a specific byte sequence to come in through the microphone. When it finds this sequence, it goes into a sort of debug mode itself. It doesn't run games in debug mode, unfortunately, but it does do a few cool things. Pressing L+R+X+Y will wipe the user settings. There's also a way to edit the MAC address, but I haven't figured out how to activate it yet. But most importantly... it doesn't do any RSA check on Download Play! O_O So once you activate it, you can just send your favourite homebrew through WMB and have fun!
<br/>
<br/>
Of course, getting that specific byte sequence in through a little microphone isn't easy. You'd need some sort of precision control. Well, I found a way! A little-known feature of many modern-day PC motherboards is that you can change CPU, memory and fan speeds through an I/O port on the real-time clock chip. Specifically, you can control the fan in the power supply. And so by manipulating the fan and holding the DS up to it, you can 'blow' that exact byte sequence (or for that matter, any other) into the mic!
<br/>
<br/>
I call this exploit BlowMe. The program is <a class="postlink" href="http://hypernova.amarok-shadow.com/MyStuff/blowme.zip" target="_blank">here</a>, source code will come soon but I need sleep now. Just run it; it'll give you all the instructions you need. Then use WMB to send your program just as you would with FlashMe. (Hell, you can even send FlashMe.) I haven't tested with DS Lite, and it doesn't appear to affect cartridge encryption.
<br/>
<br/>
Enjoy! :-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77498 - Mighty Max - Sat Apr 01, 2006 10:17 am</h4>
    <div class="postbody"><span class="postbody">What a nice day :D
<br/>
<br/>
Well done<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77499 - DesktopMan - Sat Apr 01, 2006 10:22 am</h4>
    <div class="postbody"><span class="postbody">Dude it works!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77500 - linus - Sat Apr 01, 2006 10:22 am</h4>
    <div class="postbody"><span class="postbody">props on the name</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77501 - JaJa - Sat Apr 01, 2006 10:22 am</h4>
    <div class="postbody"><span class="postbody">Posted: Sat Apr 01, 2006 9:14 am    Post subject: Firmware flaw allows unsigned code execution!
<br/>
<br/>
Need I say more?
<br/>
Surely someone who's been looking at the firmware for months (like loopy or sgstair) would have found this before?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77503 - LiraNuna - Sat Apr 01, 2006 10:32 am</h4>
    <div class="postbody"><span class="postbody">?_? 
<br/>
nice joke man.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77506 - caitsith2 - Sat Apr 01, 2006 10:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
int main(int argc, char *argv[])
<br/>
{
<br/>
    printf("BlowMe V1.0 - Nintendo DS Homebrew Loader by HyperHacker\n"
<br/>
             "http://hypernova.amarok-shadow.com\n\n"
<br/>
             "Instructions:\n"
<br/>
             "1) Turn on your DS and enter DS Download Play.\n"
<br/>
             "2) Hold the microphone up to the fan in your computer's power supply.\n"
<br/>
             "3) Press any key to begin.\n\n");
<br/>
<br/>
    while(!getch()) sleep(100);
<br/>
<br/>
    printf("Sending...\n");
<br/>
<br/>
    sleep(6000);  //April Fools joke happens here.  If end user is running flashme, he already can run unsigned code.
<br/>
<br/>
    printf("RSA check disabled. You should now be able to run unsigned code via Wireless\n"
<br/>
             "Multiboot. Note that you will need to do this each time you want to run\n"
<br/>
             "unsigned code.\n"
<br/>
             "Press any key to exit.\n");
<br/>
<br/>
    while(!getch()) sleep(100);
<br/>
<br/>
    return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Awesome april fools joke.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77524 - chishm - Sat Apr 01, 2006 2:44 pm</h4>
    <div class="postbody"><span class="postbody">I'm not going to run this, it might brick my PC! What happens if the fan speed modulation fails, and my CPU overheats?!?!<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77526 - lambi1982 - Sat Apr 01, 2006 3:20 pm</h4>
    <div class="postbody"><span class="postbody">This has to be by far the funniest "HACK" ever.... and I mean ever.
<br/>
<br/>
BlowME........ HAhaHAhaHAhaHA<br/>_________________<br/>Who, Me?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77544 - Diffuse - Sat Apr 01, 2006 4:47 pm</h4>
    <div class="postbody"><span class="postbody">Man... while reading that I had forgotten it was April Fools! Well, the fan thing to send the byte sequence seemed quite odd...<br/>_________________<br/><a href="http://www.ndscene.net" target="_blank">http://www.ndscene.net</a>
<br/>
Diffuse is Tepples #1 fan! w00t!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77592 - pas - Sat Apr 01, 2006 10:05 pm</h4>
    <div class="postbody"><span class="postbody">Is this a joke now, or is this real ?
<br/>
<br/>
If this is a joke is there any other way to overgo the RSA Signature of the DS Downloadplay ( Exept Flashme of Course)  ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77593 - pas - Sat Apr 01, 2006 10:09 pm</h4>
    <div class="postbody"><span class="postbody">@chishm:
<br/>
<br/>
Are you joking or what ? :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77599 - HyperHacker - Sat Apr 01, 2006 10:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chishm wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not going to run this, it might brick my PC! What happens if the fan speed modulation fails, and my CPU overheats?!?!</td> </tr></table><span class="postbody">
<br/>
Your CPU fan should be able to handle it for the whole 6 seconds it takes to do this.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77620 - chishm - Sun Apr 02, 2006 12:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chishm wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not going to run this, it might brick my PC! What happens if the fan speed modulation fails, and my CPU overheats?!?!</td> </tr></table><span class="postbody">
<br/>
Your CPU fan should be able to handle it for the whole 6 seconds it takes to do this.</span></td> </tr></table><span class="postbody">
<br/>
I know :D
<br/>
I was joking (after all, it was a joke thread).
<br/>
But my CPU idles at 65?, so it would quickly die without a fan.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77623 - Maverick - Sun Apr 02, 2006 1:10 am</h4>
    <div class="postbody"><span class="postbody">65? when idle?
<br/>
<br/>
Youve got a problem there
<br/>
<br/>
<a class="postlink" href="http://video.google.com/videoplay?docid=5393904704265757054&amp;q=overclock+cpu&amp;pl=true" target="_blank">http://video.google.com/videoplay?docid=5393904704265757054&amp;q=overclock+cpu&amp;pl=true</a><br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77663 - HyperHacker - Sun Apr 02, 2006 7:03 am</h4>
    <div class="postbody"><span class="postbody">Hahaha! That's crazy... just explodes right away.
<br/>
<br/>
So yeah, if you couldn't tell, this was a joke. The name "BlowMe" popped into my head when someone was listing all the other methods and I noticed they all ended in "Me". Caitsith2 freaked me out with how close the code he posted was to the real thing; I had to double check that I didn't accidentally include it in the file.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "main.h"
<br/>
<br/>
<br/>
/*
<br/>
Entry point
<br/>
*/
<br/>
int APIENTRY WinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance,LPSTR lpCmdLine,int nCmdShow)
<br/>
{
<br/>
   printf(
<br/>
      "BlowMe V1.0 - Nintendo DS Homebrew Loader by HyperHacker\nhttp://hypernova.amarok-shadow.com\n\n"
<br/>
      "Instructions:\n"
<br/>
      "1) Turn on your DS and enter DS Download Play.\n"
<br/>
      "2) Hold the microphone up to the fan in your computer's power supply.\n"
<br/>
      "3) Press any key to begin.\n\n");
<br/>
<br/>
   while(!getch()) Sleep(100);
<br/>
   printf("Sending...\n");
<br/>
   Sleep(6000);
<br/>
   printf(
<br/>
      "RSA check disabled. You should now be able to run unsigned code via Wireless\n"
<br/>
      "Multiboot. Note that you will need to do this each time you want to run\n"
<br/>
      "unsigned code.\n"
<br/>
      "Press any key to exit.\n");
<br/>
   while(!getch()) Sleep(100);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
Even got the sleep amounts right. o_o A cookie for you!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77666 - caitsith2 - Sun Apr 02, 2006 7:23 am</h4>
    <div class="postbody"><span class="postbody">Thats one of the very things IDA is useful for.  Took me less than 5 minutes to figure out what was going on in the code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77669 - pas - Sun Apr 02, 2006 9:27 am</h4>
    <div class="postbody"><span class="postbody">@HyperHacker:
<br/>
<br/>
Could you give as a video or something like a slideshow that prove this, or do you admit that you were lying ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77670 - MaHe - Sun Apr 02, 2006 9:29 am</h4>
    <div class="postbody"><span class="postbody">Come on, it was Aprils Fools he was JOKING, jeez &gt;_&gt;<br/>_________________<br/><span style="font-size: 9px; line-height: normal">[ Crimson and Black Nintendo DS Lite | CycloDS Evolution | EZ-Flash 3-in-1 | 1 GB Transcend microSD ]</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77671 - JaJa - Sun Apr 02, 2006 9:33 am</h4>
    <div class="postbody"><span class="postbody"><span style="font-size: 24px; line-height: normal"><span style="font-weight: bold">APRIL FOOLS!!!11</span></span>
<br/>
This thread was an April Fools.
<br/>
It doesn't work.
<br/>
Got the message now?
<br/>
<span style="font-size: 24px; line-height: normal"><span style="font-weight: bold">APRIL FOOLS!!!11</span></span>\</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77762 - HyperHacker - Sun Apr 02, 2006 10:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pas wrote:</b></span></td> </tr> <tr> <td class="quote">@HyperHacker:
<br/>
<br/>
Could you give as a video or something like a slideshow that prove this, or do you admit that you were lying ?</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">So yeah, if you couldn't tell, this was a joke.</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77901 - crudhacker - Mon Apr 03, 2006 11:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">I was poking through the firmware, hoping to find a way to trick games into running in debug mode, and I found something even better. I'd noticed that the firmware turns the microphone on while looking for programs in DS Download Play... I couldn't imagine why, figured it must be a glitch. But then I noticed it's actually reading in data from the microphone. But why?
<br/>
<br/>
After another few minutes of poking, I figured out why, and almost fell out of my chair. The firmware is looking for a specific byte sequence to come in through the microphone. When it finds this sequence, it goes into a sort of debug mode itself. It doesn't run games in debug mode, unfortunately, but it does do a few cool things. Pressing L+R+X+Y will wipe the user settings. There's also a way to edit the MAC address, but I haven't figured out how to activate it yet. But most importantly... it doesn't do any RSA check on Download Play! O_O So once you activate it, you can just send your favourite homebrew through WMB and have fun!
<br/>
<br/>
Of course, getting that specific byte sequence in through a little microphone isn't easy. You'd need some sort of precision control. Well, I found a way! A little-known feature of many modern-day PC motherboards is that you can change CPU, memory and fan speeds through an I/O port on the real-time clock chip. Specifically, you can control the fan in the power supply. And so by manipulating the fan and holding the DS up to it, you can 'blow' that exact byte sequence (or for that matter, any other) into the mic!
<br/>
<br/>
I call this exploit BlowMe. The program is <a class="postlink" href="http://hypernova.amarok-shadow.com/MyStuff/blowme.zip" target="_blank">here</a>, source code will come soon but I need sleep now. Just run it; it'll give you all the instructions you need. Then use WMB to send your program just as you would with FlashMe. (Hell, you can even send FlashMe.) I haven't tested with DS Lite, and it doesn't appear to affect cartridge encryption.
<br/>
<br/>
Enjoy! :-)</td> </tr></table><span class="postbody">
<br/>
<br/>
WWWWWWWWWWWOOOOOOOOOOOOOOOOWWWWWWWWWWWW!!!!!!!! finally a way to JUST pass code through the DS without the RSA check. Dude luck or not THANK YOU!
<br/>
<br/>
<br/>
.......... great. didn't know this was a joke. u piss me off. i thought this was real. u really piss me off<br/>_________________<br/>MKDS friend code-
<br/>
051599-251600
<br/>
PM me so i can add u
<br/>
<br/>
crack this encrypted message-
<br/>
BNSRIAYTNEDCLTFJQEZGNWDXHO
<br/>
key- skip first letter then skip 2,3 till 4 then go back down</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77991 - m2pt5 - Tue Apr 04, 2006 12:34 pm</h4>
    <div class="postbody"><span class="postbody">This thread should probably be clearly labeled "joke" and closed, so as not to confuse any further newbs.<br/>_________________<br/>Don't sign your posts, it's dumb.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78045 - derula - Tue Apr 04, 2006 8:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Maverick wrote:</b></span></td> </tr> <tr> <td class="quote">65? when idle?
<br/>
<br/>
Youve got a problem there
<br/>
<br/>
<a class="postlink" href="http://video.google.com/videoplay?docid=5393904704265757054&amp;q=overclock+cpu&amp;pl=true" target="_blank">http://video.google.com/videoplay?docid=5393904704265757054&amp;q=overclock+cpu&amp;pl=true</a></td> </tr></table><span class="postbody">
<br/>
<br/>
duuuude...
<br/>
<br/>
"too extrame" ^^<br/>_________________<br/><a class="postlink" href="http://www.uglyhorst.de/blog/nerdpunk/" target="_blank">visit my blog. please.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78123 - Sebbo - Wed Apr 05, 2006 8:15 am</h4>
    <div class="postbody"><span class="postbody">65? when idle and your in canberra? damn...i don't want to see it when its churning out BF2
<br/>
mine barely gets to 50? on a hot summer's day and i'm in brisbane
<br/>
<br/>
btw, great joke HyperHacker, its a serious bummer it wasn't true though<br/>_________________<br/>Here's some ideas I have for when I know enough to act on them, or for others to have a look at when they're bored: <a class="postlink" href="http://www.wayne.sebbens.com/ds_ideas.htm" target="_blank">www.wayne.sebbens.com/ds_ideas.htm</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78143 - chishm - Wed Apr 05, 2006 12:18 pm</h4>
    <div class="postbody"><span class="postbody">Well, it's an Athlon XP running on a Gigabyte K7N400 Pro 2 mother board, which seems to have a design flaw -- it's minimum CPU voltage is 1.72V. However, my PC has been running fine for 2 years and the only problem has been dead RAM.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78228 - HyperHacker - Thu Apr 06, 2006 2:25 am</h4>
    <div class="postbody"><span class="postbody">Running that hot's gotta be wearing it down, though. Mine (Sempron @ 1.7 ghz) practically never exceeds 40?C. Stick some fans in there or something.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78270 - JaJa - Thu Apr 06, 2006 9:29 am</h4>
    <div class="postbody"><span class="postbody">Silcon chips have the same failure rate ay any reasonable temperature.
<br/>
As long as you don't exceed like 70C it should be fine.
<br/>
I had a PIII that you could use as a kettle (and i did for a while) and it didn't feel any ill effects (until it got a static shock).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78274 - chishm - Thu Apr 06, 2006 11:12 am</h4>
    <div class="postbody"><span class="postbody">I have enough fans. It is fine. When it dies, it will be a good excuse to upgrade.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
