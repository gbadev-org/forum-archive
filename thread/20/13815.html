<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Corruption of a full memory card - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Misc > Corruption of a full memory card</h2>
<div id="posts">
<div class="post">
    <h4>#136057 - calcprogrammer1 - Sat Jul 28, 2007 8:05 pm</h4>
    <div class="postbody"><span class="postbody">I use DSFTP a lot, but unfortunately I don't think it knows when the card is full.  I think I wrote too much stuff to my card and it corrupted some folders...it still boots but some folder names show up weird in DSOrganize.<br/>_________________<br/>DS Firmware 1, Datel Games n' Music card / Chism's FW hacked GBA MP v2 CF
<br/>
<br/>
There's no place like 127.0.0.1.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136127 - pas - Sun Jul 29, 2007 3:16 pm</h4>
    <div class="postbody"><span class="postbody">That's what's my problem sometimes too... I wished there would be some way to get shown the space left like windows does (although DM said it would be impossible to do so).
<br/>
<br/>
Moonshell can show the size of folders, so what about an easy calc ? Don't punish me for giving Ideas that will never work, I just think out loud ^^.<br/>_________________<br/><a class="postlink" href="http://www.petitiononline.com/blizzds/petition.html" target="_blank">Starcraft DS ?</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136139 - dantheman - Sun Jul 29, 2007 5:02 pm</h4>
    <div class="postbody"><span class="postbody">The only way I know of to determine the amount of remaining space on a card from the DS itself is to open DSLinux and type "df"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136143 - tepples - Sun Jul 29, 2007 5:46 pm</h4>
    <div class="postbody"><span class="postbody">That or do the following: <ol type="1"><li>sync the file system, </li><li>read the <a class="postlink" href="http://en.wikipedia.org/wiki/File_Allocation_Table#Boot_Sector" target="_blank">boot sector</a> with disc_io to get the volume size, cluster size, and starting sector of the FAT, </li><li>read the FAT with disc_io, counting the clusters that are set to the "free" value, and </li><li>stop when you're sure that enough clusters are free. </li></ol> Should I try to implement this in C for the benefit of readers?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136144 - calcprogrammer1 - Sun Jul 29, 2007 5:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Should I try to implement this in C for the benefit of readers?</td> </tr></table><span class="postbody">
<br/>
<br/>
Only if it would be implemented in the applications used most often.  If it were implemented in DSOrganize, DSFTP, MoonShell, etc, then it would be useful.  You should check with the developers of these applications or post this error in their topics on DS Homebrew Announcements.<br/>_________________<br/>DS Firmware 1, Datel Games n' Music card / Chism's FW hacked GBA MP v2 CF
<br/>
<br/>
There's no place like 127.0.0.1.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136165 - Galactic Lord Xenu - Sun Jul 29, 2007 9:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dantheman wrote:</b></span></td> </tr> <tr> <td class="quote">As laptops are unlikely to have the wireless cards needed for WMB, your main options are DSFTP and Lilou <a href="http://FTP." target="_blank">FTP.</a>  There's also a few wifiloaders that load games into RAM before execution without writing to the card.  You could also use HTTPexec in a pinch if you rename files often.</td> </tr></table><span class="postbody">
<br/>
<br/>
I've experienced file corruption with Lilou <a href="http://FTP." target="_blank">FTP.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136166 - wandafritsch - Sun Jul 29, 2007 9:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>calcprogrammer1 wrote:</b></span></td> </tr> <tr> <td class="quote">Only if it would be implemented in the applications used most often.  If it were implemented in DSOrganize, DSFTP, MoonShell, ...</td> </tr></table><span class="postbody">
<br/>
 .... and not to forget DSFileBrowser.
<br/>
<br/>
;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136167 - wandafritsch - Sun Jul 29, 2007 9:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Should I try to implement this in C for the benefit of readers?</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">Yes, please!</span>
<br/>
<br/>
I just decided to start DS programming. (That means start learning...) 
<br/>
Could you please do a little example how to use this as a tiny standalone app?
<br/>
<br/>
:-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136181 - pas - Sun Jul 29, 2007 10:21 pm</h4>
    <div class="postbody"><span class="postbody">@dantheman: if I open dslinux and type df then it says df not found. What build are you using ?<br/>_________________<br/><a class="postlink" href="http://www.petitiononline.com/blizzds/petition.html" target="_blank">Starcraft DS ?</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136190 - Galactic Lord Xenu - Sun Jul 29, 2007 11:58 pm</h4>
    <div class="postbody"><span class="postbody">Question:  You use DSFTP a lot... and it doesn't freeze?  I can't get the thing stable.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136934 - dantheman - Mon Aug 06, 2007 5:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pas wrote:</b></span></td> </tr> <tr> <td class="quote">@dantheman: if I open dslinux and type df then it says df not found. What build are you using ?</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm using the DLDI build downloaded a couple of weeks ago.  It might have been disabled since then, though I don't know why it would have been.  You're not getting any "syntax errors" upon bootup, are you?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#137238 - wandafritsch - Thu Aug 09, 2007 9:00 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>calcprogrammer1 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Should I try to implement this in C for the benefit of readers?</td> </tr></table><span class="postbody">
<br/>
Only if it would be implemented in the applications used most often.  If it were implemented in DSOrganize, DSFTP, ....</span></td> </tr></table><span class="postbody">
<br/>
<br/>
The right place to implement is the <span style="font-weight: bold">libfat</span>, isn't it. 
<br/>
<br/>
Every potentially harmful file handling - like copy/paste, make/store,... - 
<br/>
should check for enough place left beforehand, I think.
<br/>
<br/>
!-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#137243 - tepples - Thu Aug 09, 2007 12:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wandafritsch wrote:</b></span></td> </tr> <tr> <td class="quote">The right place to implement is the <span style="font-weight: bold">libfat</span>, isn't it.</td> </tr></table><span class="postbody">
<br/>
Yes, and wintermute agrees. However, I've been having some trouble getting a hold of chishm due to the 14 hour time zone difference between Fort Wayne and Canberra.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#137247 - wandafritsch - Thu Aug 09, 2007 2:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Should I try to implement this in C for the benefit of readers?</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">A little standalone tool is still interesting</span>, 
<br/>
because it will take a long time until all 
<br/>
apps will use a lib-function!
<br/>
<br/>
:-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#137273 - tepples - Thu Aug 09, 2007 7:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wandafritsch wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Should I try to implement this in C for the benefit of readers?</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">A little standalone tool is still interesting</span></span></td> </tr></table><span class="postbody">
<br/>
I wish I could. I started to write one, but I stopped once I read the source code of libfat and realized that it does not expose any APIs for low-level access to the boot sector and FAT. I've managed to talk wintermute and chishm into implementing at least a useful subset of the POSIX function <a class="postlink" href="http://www.opengroup.org/onlinepubs/000095399/functions/statvfs.html" target="_blank">statvfs</a>, which takes a path, looks at what file system it sits on (e.g. SLOT-1 or SLOT-2), and returns information about the cluster size, number of clusters, and number of remaining clusters on this file system. Once that happens, I'll be able to write an app that can show this information to the user.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#137297 - dantheman - Fri Aug 10, 2007 12:12 am</h4>
    <div class="postbody"><span class="postbody">Would the hacked libfat used for MCtool be of any use to you?
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=12315" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12315</a>
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=12114" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12114</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
