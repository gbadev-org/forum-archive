<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>SDL for the Nintendo DS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Misc > SDL for the Nintendo DS</h2>
<div id="posts">
<div class="post">
    <h4>#59726 - GPFerror - Thu Nov 03, 2005 7:53 pm</h4>
    <div class="postbody"><span class="postbody">Iv released all the libs and sources and some examples on my site.
<br/>
<br/>
The SDL port is based off of SDL 1.2.3 so some work is need to upgrade it to the latest version, still needs sound support and filesystem support.
<br/>
<br/>
included is SDL_image , libpng-1.2.8 , jpeg-6b , zlib-1.2.2 , SDL_mixer , SDL_ttf , libfreetype , SDL_flic , SDL_gfx , SFont
<br/>
<br/>
<a class="postlink" href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a>
<br/>
<br/>
Enjoy, fix the source and share :)
<br/>
Troy Davis(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59739 - birslip - Thu Nov 03, 2005 9:40 pm</h4>
    <div class="postbody"><span class="postbody">Thanks! 
<br/>
Support of the ttf is amazing! It works well!
<br/>
You use hardware's sprites/bg? or bitmap mode?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59740 - GPFerror - Thu Nov 03, 2005 9:46 pm</h4>
    <div class="postbody"><span class="postbody">its all done on a mode6 1024X512 background bitmap</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59777 - deltro - Fri Nov 04, 2005 1:39 am</h4>
    <div class="postbody"><span class="postbody">Holy crap! Awesome GPF- this is just what the scene needed
<br/>
<br/>
&lt;3</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59808 - Humanoid - Fri Nov 04, 2005 5:12 am</h4>
    <div class="postbody"><span class="postbody">Yes! Thanks alot, I've been waiting for a port of this so I can start porting my   stuff!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59916 - Extreme Coder - Sat Nov 05, 2005 2:14 pm</h4>
    <div class="postbody"><span class="postbody">Nice work GPFerror. Until I figure out why the heck libnds doesn't support textures other than 128x128, I'll be using this:)
<br/>
But the question is: How fast are the gfx routines?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59953 - GPFerror - Sat Nov 05, 2005 10:20 pm</h4>
    <div class="postbody"><span class="postbody">check out the examples and my SuperMarioWarsDS port to see the lib in action.
<br/>
<a href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a>
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59955 - Extreme Coder - Sat Nov 05, 2005 10:42 pm</h4>
    <div class="postbody"><span class="postbody">You wouldn't mind posting some docs about the functions,right?:)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59963 - GPFerror - Sun Nov 06, 2005 12:04 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.libsdl.org" target="_blank">http://www.libsdl.org</a>
<br/>
<br/>
has all the docs for SDL and links to most of the other libs I believe.
<br/>
<br/>
Use the makefile to bin2o your graphics etc, and then use SDL_RWops and SDL_RWFromMem to load them.
<br/>
<br/>
or ask me and Ill do my best to help :)
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60035 - Extreme Coder - Sun Nov 06, 2005 3:26 pm</h4>
    <div class="postbody"><span class="postbody">Won't putting them as png's or jpeg's work? I see you've putted libpng and libjpeg there.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60038 - GPFerror - Sun Nov 06, 2005 4:36 pm</h4>
    <div class="postbody"><span class="postbody">yes, if you use one of examples as a template, put the graphics in the data folder and then either change or add a new section to the makefile that bin2o the file.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">%.gif.o   :   %.gif
<br/>
#---------------------------------------------------------------------------------
<br/>
   @echo $(notdir $&lt;)
<br/>
   @$(bin2o)</td> </tr></table><span class="postbody">
<br/>
then in your code you add an include to bring the file in
<br/>
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;nds.h&gt;
<br/>
<br/>
<br/>
#include &lt;SDL.h&gt;
<br/>
#include &lt;SDL_image.h&gt;
<br/>
#include &lt;stdio.h&gt;    
<br/>
 
<br/>
#include "troydesktop_gif.h"  
<br/>
   
<br/>
int main(void) {    
<br/>
<br/>
  SDL_Surface *screen;      
<br/>
  SDL_Surface *one;  
<br/>
  SDL_Rect rect;  
<br/>
 
<br/>
  /* This is the RWops structure we'll be using */
<br/>
  SDL_RWops *rw;    
<br/>
<br/>
  SDL_Init(SDL_INIT_VIDEO);  
<br/>
       
<br/>
  screen = SDL_SetVideoMode(1024,512,8 , SDL_SWSURFACE);
<br/>
   
<br/>
  /* This is where we actually create our RWops structure.  Here we're
<br/>
     instructing SDL to get it from the file pointer we just opened */
<br/>
 
<br/>
   rw = SDL_RWFromMem((void*)troydesktop_gif, troydesktop_gif_size); 
<br/>
  /* IMG_LoadPGIF_RW is the RWops version of ,
<br/>
     IMG_LoadGIF.  This will get the image from the RWops you passed
<br/>
     in; */
<br/>
<br/>
  one = IMG_LoadGIF_RW(rw);
<br/>
  
<br/>
  /* Clean up after ourselves */ 
<br/>
  SDL_FreeRW(rw); 
<br/>
<br/>
  /* Haphazard way of getting stuff to the screen */
<br/>
  rect.x = rect.y = 0;  
<br/>
  rect.w = 1024;  //width of graphic
<br/>
  rect.h = 512;   //height of graphic
<br/>
<br/>
<br/>
while(1){
<br/>
     SDL_BlitSurface(one, NULL, screen, &amp;rect);
<br/>
 
<br/>
   SDL_Flip(screen);
<br/>
  SDL_Delay(5);
<br/>
}
<br/>
<br/>
  return 0; 
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60051 - Lazy1 - Sun Nov 06, 2005 6:54 pm</h4>
    <div class="postbody"><span class="postbody">I keep getting an undefined reference to SDL_main when trying to compile SDL sopwith.
<br/>
None of the solutions I found on google seem to work.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
arm-elf-gcc -g -mno-fpu -mthumb-interwork -specs=ds_arm9.specs -L/c/devkitpro/li
<br/>
bnds/lib -L/c/devkitpro/libsdl/lib -lnds9 -lSDL arm9.o -o arm9.elf
<br/>
c:/devkitpro/libsdl/lib\libSDL.a(SDLMain.o): In function `main':
<br/>
c:/devkitPro/msys/home/Troy.Davis/prj/SDL/source/main/SDLMain.c:15: undefined re
<br/>
ference to `SDL_main'
<br/>
make: *** [arm9.elf] Error 1
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60228 - GPFerror - Tue Nov 08, 2005 6:59 am</h4>
    <div class="postbody"><span class="postbody">can you post some of your code or send me a link to the code and ill take a look at it?
<br/>
<br/>
Or go over all my examples source and check the Makefiles etc 
<br/>
<br/>
Troy</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60233 - Lazy1 - Tue Nov 08, 2005 7:55 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://sdl-sopwith.sourceforge.net/" target="_blank">http://sdl-sopwith.sourceforge.net/</a>
<br/>
<br/>
I did look at your example makefiles, mine is very different in some ways but linking the objects to libraries is exactly the same.
<br/>
It's not a compilation issue since both the SDL specific files and the game specific files compile just fine.
<br/>
<br/>
I'll take another look again tomorrow, it might be something incredibly small that I overlooked.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60289 - GPFerror - Tue Nov 08, 2005 6:12 pm</h4>
    <div class="postbody"><span class="postbody">ok let me know , I did a quick 10 minute port of it to see if I could figure out what was wrong, got the 1st screen displaying , just needs to implement controls and be tested on real hardware :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60290 - Lazy1 - Tue Nov 08, 2005 6:18 pm</h4>
    <div class="postbody"><span class="postbody">Cool, I'm going to re-write my makefile after lunch and see if I can get it to link with sdl properly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#60292 - josath - Tue Nov 08, 2005 6:34 pm</h4>
    <div class="postbody"><span class="postbody">I also got it to compile, but it crashes after the diffuculty select screen. I didn't spend much time trying to debug it, but the crash is very strange: it actually restarts back to the beginning of the program.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62778 - GPFerror - Mon Dec 05, 2005 6:28 pm</h4>
    <div class="postbody"><span class="postbody">finally made a page with all the files for download, since the link were only on the my news page that has since scrolled away.
<br/>
<br/>
<a href="http://gpf.dcemu.co.uk/ndsSDL.shtml" target="_blank">http://gpf.dcemu.co.uk/ndsSDL.shtml</a>
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63035 - Durandle - Thu Dec 08, 2005 12:28 am</h4>
    <div class="postbody"><span class="postbody">Does it only support 8bit mode? I tried one of the examples you gave in 16 bit and it works right up to the screen init.
<br/>
<br/>
Oh and I tried it with PNG files (made the needed changes) and it throws a ton of errors in IMG_png.c
<br/>
<br/>
"c:/devkitPro/msys/home/&lt;your-name&gt;/prj/SDL_image/source/IMG_png.c:123: undefined reference to `png_create_read_struct'"  ... etc ...  
<br/>
<br/>
seems to have your DIR structure built into it  :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74050 - GPFerror - Thu Mar 02, 2006 12:05 am</h4>
    <div class="postbody"><span class="postbody">with the help of parrot on #dsdev, He's has merged the existing code into the SDL 1.2.9 branch and I wrote a new Makefile and fixed a couple things. 
<br/>
<br/>
I will release soon, its has the same functionallity still, but lib seems smaller.
<br/>
<br/>
Was looking through some other OS ports of SDL's existing code and there may be a way of using interupts to play audio instead of needing a threading library on the ds , just is going to take some time to figure that out. 
<br/>
<br/>
Also have updated SDL_image-1.2.4 and SDL_mixer-1.2.6 and I will update the whole package when I release the code.
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74095 - Durandle - Thu Mar 02, 2006 10:25 am</h4>
    <div class="postbody"><span class="postbody">I know you can't test it your self, but could you replace the fopen, file, fread, etc.... to the DS FAT lib ones? It does work... I know, I could do it some weekend but then we'd end up with two versions of SDLDS floating around.
<br/>
<br/>
As for sound... I thought there was a threading lib being added to the DS lib at the moment? Or would using interrupt be less CPU intensive?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74114 - GPFerror - Thu Mar 02, 2006 4:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Durandle wrote:</b></span></td> </tr> <tr> <td class="quote">I know you can't test it your self, but could you replace the fopen, file, fread, etc.... to the DS FAT lib ones? It does work... I know, I could do it some weekend but then we'd end up with two versions of SDLDS floating around.
<br/>
<br/>
As for sound... I thought there was a threading lib being added to the DS lib at the moment? Or would using interrupt be less CPU intensive?</td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah I look into adding that, I just realized I have the code you sent me with FAT implemented for that :)
<br/>
<br/>
16bit mode is working now , just need to add a few more modes and need to implement doublebuffering (hardware and software).
<br/>
<br/>
The working threading lib that I ported(RTAdvanced) doesnt do preemptive threading so it doesnt meet the requirements of the existing SDL code. I still havent been able to get Mighty Max's multithreading code working so I have starting looking into some other possible methods of getting the audio thread working. Looking through the Mint code(atari port?) doesn't use threading but uses interrupts, so it might be possible to mimic the same type of code for the DS.
<br/>
<br/>
Still need some way of knowing when the previous audio buffer is done playing and how to tell what its current buffer position is or threading/irq's won't make any difference.
<br/>
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74649 - GPFerror - Mon Mar 06, 2006 8:20 pm</h4>
    <div class="postbody"><span class="postbody">OK finally uploaded the newer version of SDL 1.2.9, SDL_image1.2.6 and SDL_mixer-1.2.6 , the precompiled libs and examples have not been updated with the new version yet though.
<br/>
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk/ndsSDL.shtml" target="_blank">http://gpf.dcemu.co.uk/ndsSDL.shtml</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74654 - Raziel Fireeye - Mon Mar 06, 2006 8:30 pm</h4>
    <div class="postbody"><span class="postbody">Cool ;)
<br/>
<br/>
A question. Its posible to see a DS port of FENIX language (Game developing language also ported to gp32,gp2x,dreamcast) whit this DS SDL ?? (http://fenix.divsite.net/)
<br/>
Im not asking for someone to port it, only asking if it will be posible.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74690 - GPFerror - Tue Mar 07, 2006 12:08 am</h4>
    <div class="postbody"><span class="postbody">does the original version use SDL? I know that the gp32 and dreamcast version do, but I cant find Chuis sourcecode anywhere. So im not sure of its portability.
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75037 - Raziel Fireeye - Thu Mar 09, 2006 7:02 pm</h4>
    <div class="postbody"><span class="postbody">I found the GP2X fenix source ;)
<br/>
<br/>
<a href="http://gp32wip.com/projects/fenixb3_src.zip" target="_blank">http://gp32wip.com/projects/fenixb3_src.zip</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131719 - jandujar - Tue Jun 19, 2007 12:23 pm</h4>
    <div class="postbody"><span class="postbody">hello GPF,
<br/>
<br/>
I'm trying to include the SDL in the NDS-DEV-OS.
<br/>
<br/>
I successfully build libSDL  (applying some changes in Makefile)
<br/>
<br/>
But I have problems building libpng. Maybe you have solved them and you can help me.
<br/>
<br/>
libpng build successfully, but the test pngtest.c does not.
<br/>
<br/>
This is the error.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
arm-eabi-gcc -o pngtest pngtest.o -mthumb -mthumb-interwork -L. -L/home/nds/NDS/LIBS/zlib-1.22/lib -lpng -lz -lm -s
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-abort.o): In function `abort':
<br/>
(.text+0xc): undefined reference to `_exit'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-exit.o): In function `exit':
<br/>
(.text+0x1a): undefined reference to `_exit'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-fstatr.o): In function `_fstat_r':
<br/>
(.text+0x10): undefined reference to `_fstat'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-makebuf.o): In function `__smakebuf':
<br/>
(.text+0x6e): undefined reference to `isatty'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-openr.o): In function `_open_r':
<br/>
(.text+0x12): undefined reference to `_open'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-sbrkr.o): In function `_sbrk_r':
<br/>
(.text+0xe): undefined reference to `_sbrk'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-signalr.o): In function `_getpid_r':
<br/>
(.text+0x4): undefined reference to `_getpid'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-signalr.o): In function `_kill_r':
<br/>
(.text+0x20): undefined reference to `_kill'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-writer.o): In function `_write_r':
<br/>
(.text+0x12): undefined reference to `_write'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-closer.o): In function `_close_r':
<br/>
(.text+0xe): undefined reference to `_close'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-lseekr.o): In function `_lseek_r':
<br/>
(.text+0x12): undefined reference to `_lseek'
<br/>
/home/nds/devkitpro/devkitARM_r20/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/thumb/libc.a(lib_a-readr.o): In function `_read_r':
<br/>
(.text+0x12): undefined reference to `_read'
<br/>
collect2: ld returned 1 exit status
<br/>
make[1]: *** [pngtest] Error 1
<br/>
make[1]: Leaving directory `/home/nds/tmp/libpng/libpng-1.2.8/source'
<br/>
make: *** [all] Error 2
<br/>
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://jandujar.homelinux.com" target="_blank">http://jandujar.homelinux.com</a>
<br/>
<a class="postlink" href="http://www.dsrobot.com" target="_blank">http://www.dsrobot.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
