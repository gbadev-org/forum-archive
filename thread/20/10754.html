<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>A DS serial port - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS Misc > A DS serial port</h2>
<div id="posts">
<div class="post">
    <h4>#97561 - masscat - Thu Aug 10, 2006 1:46 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">EDIT:</span> The SPI/UART bridge now has a <a class="postlink" href="http://masscat.afraid.org/ninds/spiuart.php" target="_blank">webpage</a>. Corrected the link to the MCU programming tool.
<br/>
<br/>
I have put together a SPI UART bridge so that you can connect a DS to anything with an RS232 port. The port settings are currently fixed at 9600 baud, 8 data bits, no parity and 1 stop bit.
<br/>
<br/>
The hardware side is based around a Zilog Z8F0412 microcontroller. It takes the SPI bus from the DS Card port and puts the data received out of its UART port. Any data received over the UART is sent to the DS during the SPI transfer.
<br/>
<br/>
The hardware is not portable - I have put in a seperate power supply as I am not sure how much current the DS card port can supply and the microcontroller is a big chip. But the main reason for me developing it is to debug over, it is cheap to build and somebody with little hardware knowledge (me) can put it together.
<br/>
<br/>
Check the <a class="postlink" href="http://masscat.afraid.org/ninds/spiuart.php" target="_blank">webpage</a> for the latest release.
<br/>
<br/>
If you want to change and build the zilog code you can get the development environment from the <a class="postlink" href="http://www.zilog.com/" target="_blank">Zilog website</a>. The serialnds.hex file from the zilog tarball above is the file you program the MCU with. You can program/debug the MCU by connecting the debug port (see schematic) to your PC and using the tools from <a class="postlink" href="http://sourceforge.net/projects/z8encore" target="_blank">here</a>.
<br/>
<br/>
To make the DS Card slot connector either hack an DS cart that you do not want anymore, etch one or, like me, carve one out of a plain copper PCB board using a stanley knife (not a fun job but I could not bring myself to destroy a DS cart and I do not have the equipment to etch PCBs).</span><span class="gensmall"><br/><br/>Last edited by masscat on Sat Aug 12, 2006 6:12 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#97750 - jester - Fri Aug 11, 2006 11:59 am</h4>
    <div class="postbody"><span class="postbody">have you got an image of this working?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97782 - masscat - Fri Aug 11, 2006 2:56 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://masscat.afraid.org/ninds/serial_files/serial_circuit.jpg" target="_blank">Here</a> is a shot of the circuit.
<br/>
The board with the big old blue capacitors on is the RS232 line driver. The other piece of veriboard is the voltage regulator (most of the other components on that board are from a different project). The Zilog MCU is on the prototype board.
<br/>
<br/>
<a class="postlink" href="http://masscat.afraid.org/ninds/serial_files/connector_handmade.jpg" target="_blank">Here</a> is a shot of the hand carved ds connector.
<br/>
<br/>
<a class="postlink" href="http://masscat.afraid.org/ninds/serial_files/debug_screen.jpg" target="_blank">Here</a> is a capture of GDB talking to the DS over the serial port. Note the "target remote /dev/ttyS0" command - for non-linux people /dev/ttyS0 is a serial port.
<br/>
<br/>
<a class="postlink" href="http://masscat.afraid.org/ninds/serial_files/ds_screen.jpg" target="_blank">Here</a> is a shot of the DS screen whilst talking to GDB.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97789 - Linkiboy - Fri Aug 11, 2006 3:25 pm</h4>
    <div class="postbody"><span class="postbody">I see what you mean by not portable...
<br/>
<br/>
Anyways, that is quite impressive. if you optimize the design more you could make it... portable, somehow.
<br/>
<br/>
Although what is the difference(in functionallity) between this and natrium42's serial interface?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97797 - masscat - Fri Aug 11, 2006 4:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Linkiboy wrote:</b></span></td> </tr> <tr> <td class="quote">I see what you mean by not portable...
<br/>
<br/>
Anyways, that is quite impressive. if you optimize the design more you could make it... portable, somehow.
<br/>
<br/>
Although what is the difference(in functionallity) between this and natrium42's serial interface?</td> </tr></table><span class="postbody">
<br/>
The design is going to stay as optimised as it is as I do not have the skills to implement the bridge in a small FPGA or similar device. Also I do not want to have to get any PCBs made up so lovely big DIP packages is what I like.
<br/>
<br/>
This and natrium42's passme serial interface both provide a UART you can use to talk to other devices.
<br/>
As for differences:
<br/>
From what I know of the passme serial interface the DS does the bit bashing for the UART which means that it takes a number of SPI transfers to get the desired baud at the other end. Where as only one transfer per byte is needed in my case (8 data byte values are escaped and sent in two transfers to allow commands to be sent between the bridge and the DS). So the DS spends less time interacting with the SPI bus.
<br/>
My bridge can buffer a small amount of received data. I do not know if there is any buffering on the passme one.
<br/>
There is a nice software driver for my bridge.
<br/>
The baud rate is currently fixed in my bridge where as you could vary it with the passme by lengthening/shortening the bit bashing bit size.
<br/>
I do not have a passme device (functionally important to me).
<br/>
<br/>
That is about it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#97911 - Lynx - Sat Aug 12, 2006 9:07 am</h4>
    <div class="postbody"><span class="postbody">I love seeing pics of hardware hacking!  Keep up the good work!  PM me if you think I might be able to help you out with anything.<br/>_________________<br/><a class="postlink" href="http://www.ndshb.com" target="_blank">NDS Homebrew Roms &amp; Reviews</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
