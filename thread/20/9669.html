<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Invalid conversion from void* to foo*; disable this warning? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Misc > Invalid conversion from void* to foo*; disable this warning?</h2>
<div id="posts">
<div class="post">
    <h4>#84548 - HyperHacker - Tue May 23, 2006 7:40 am</h4>
    <div class="postbody"><span class="postbody">I noticed that when I use malloc() and similar functions in DS apps, I always have to cast their return types (unless I'm actually using void*) or else it warns me about the conversion. (I use arm-elf-g++ to compile.) Can this warning be disabled? I know it's bad form, but I found that <a class="postlink" href="http://www.mp3dev.org" target="_blank">LAME</a> generates several dozen of these warnings. (A lot of compilers don't seem to care about not casting void*.) I've tried fooling with the warning options but I only managed to make it create more warnings for trivial things like assigning an unsigned variable to a signed one.
<br/>
<br/>
[edit] Bah, the preview shows my full thread title but it gets cut off when I submit. &gt;_&gt;<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84579 - melw - Tue May 23, 2006 2:34 pm</h4>
    <div class="postbody"><span class="postbody">I'm using the following:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-elf-g++ --no-warnings</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84585 - zzo38computer - Tue May 23, 2006 3:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>melw wrote:</b></span></td> </tr> <tr> <td class="quote">I'm using the following:
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-elf-g++ --no-warnings</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
If your car stops working and you tape the gas meter to full, will that help? No.
<br/>
<br/>
I also get a lot of warnings but I can't figure out how to fix it, I don't care about --no-warnings option, I just see what written there anyways<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"><br/><br/>Last edited by zzo38computer on Tue May 23, 2006 3:10 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#84587 - Mrshlee - Tue May 23, 2006 3:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>melw wrote:</b></span></td> </tr> <tr> <td class="quote">I'm using the following:
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-elf-g++ --no-warnings</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
Your.. a genius! give that man a nobel prize!<br/>_________________<br/><a class="postlink" href="http://MrShlee.com/" target="_blank">MrShlee.com</a>
<br/>
Projects
<br/>
<a class="postlink" href="http://dev-scene.com/" target="_blank">Dev-Scene</a>
<br/>
<a class="postlink" href="http://MyTechpedia.com/" target="_blank">MyTechpedia</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84614 - melw - Tue May 23, 2006 6:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zzo38computer wrote:</b></span></td> </tr> <tr> <td class="quote">If your car stops working and you tape the gas meter to full, will that help? No.</td> </tr></table><span class="postbody">
<br/>
The man asked how to disable warnings. A simple answer to a simple question, that's all. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84623 - HyperHacker - Tue May 23, 2006 7:36 pm</h4>
    <div class="postbody"><span class="postbody">I want to disable one specific warning, not all of them. Most of the time they're quite useful (many failures are easily resolved by warning messages telling me I forgot some character here or there), but in this case they're just an artifact of someone else's not-quite-correct-but-still-working code. Hell if I'm going to go through and fix them all, there's like 200 of them and I already another fixed 50 or so. &gt;_&gt;<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84629 - DekuTree64 - Tue May 23, 2006 8:07 pm</h4>
    <div class="postbody"><span class="postbody">I'd also much appreciate a proper warning reference. The gcc docs never seem to tell how to disable the pointless ones. Like, when building Chishm's FAT lib on devkitARM r18, I get lots of "attribute packed has no effect" or something like that, because some u8 variables are set to be packed. Yes, I'm aware that it has no effect, but isn't it safer to specify it than to do it selectively according to the variable type?<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84647 - wintermute - Tue May 23, 2006 10:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">I'd also much appreciate a proper warning reference. The gcc docs never seem to tell how to disable the pointless ones. Like, when building Chishm's FAT lib on devkitARM r18, I get lots of "attribute packed has no effect" or something like that, because some u8 variables are set to be packed. Yes, I'm aware that it has no effect, but isn't it safer to specify it than to do it selectively according to the variable type?</td> </tr></table><span class="postbody">
<br/>
<br/>
The struct should be packed, not individual elements i.e.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// Boot Sector - must be packed
<br/>
typedef struct
<br/>
{
<br/>
   u8   jmpBoot[3];
<br/>
   u8   OEMName[8];
<br/>
   // BIOS Parameter Block
<br/>
   u16   bytesPerSector;
<br/>
   u8   sectorsPerCluster;
<br/>
   u16   reservedSectors;
<br/>
   u8   numFATs;
<br/>
   u16   rootEntries;
<br/>
   u16   numSectorsSmall;
<br/>
   u8   mediaDesc;
<br/>
   u16   sectorsPerFAT;
<br/>
   u16   sectorsPerTrk;
<br/>
   u16   numHeads;
<br/>
   u32   numHiddenSectors;
<br/>
   u32   numSectors;
<br/>
   union   // Different types of extended BIOS Parameter Block for FAT16 and FAT32
<br/>
   {
<br/>
      struct  
<br/>
      {
<br/>
         // Ext BIOS Parameter Block for FAT16
<br/>
         u8   driveNumber;
<br/>
         u8   reserved1;
<br/>
         u8   extBootSig;
<br/>
         u32   volumeID;
<br/>
         u8   volumeLabel[11];
<br/>
         u8   fileSysType[8];
<br/>
         // Bootcode
<br/>
         u8   bootCode[448];
<br/>
      }   __PACKED fat16;
<br/>
      struct  
<br/>
      {
<br/>
         // FAT32 extended block
<br/>
         u32   sectorsPerFAT32;
<br/>
         u16   extFlags;
<br/>
         u16   fsVer;
<br/>
         u32   rootClus;
<br/>
         u16   fsInfo;
<br/>
         u16   bkBootSec;
<br/>
         u8   reserved[12];
<br/>
         // Ext BIOS Parameter Block for FAT16
<br/>
         u8   driveNumber;
<br/>
         u8   reserved1;
<br/>
         u8   extBootSig;
<br/>
         u32   volumeID;
<br/>
         u8   volumeLabel[11];
<br/>
         u8   fileSysType[8];
<br/>
         // Bootcode
<br/>
         u8   bootCode[420];
<br/>
      }   __PACKED fat32;
<br/>
   }   __PACKED extBlock;
<br/>
<br/>
   u16   bootSig;
<br/>
<br/>
}   __PACKED BOOT_SEC;
<br/>
<br/>
// Directory entry - must be packed
<br/>
typedef struct
<br/>
{
<br/>
   u8   name[8];
<br/>
   u8   ext[3];
<br/>
   u8   attrib;
<br/>
   u8   reserved;
<br/>
   u8   cTime_ms;
<br/>
   u16   cTime;
<br/>
   u16   cDate;
<br/>
   u16   aDate;
<br/>
   u16   startClusterHigh;
<br/>
   u16   mTime;
<br/>
   u16   mDate;
<br/>
   u16   startCluster;
<br/>
   u32   fileSize;
<br/>
}   __PACKED DIR_ENT;
<br/>
<br/>
// Long file name directory entry - must be packed
<br/>
typedef struct
<br/>
{
<br/>
   u8 ordinal;   // Position within LFN
<br/>
   u16 char0;   
<br/>
   u16 char1;
<br/>
   u16 char2;
<br/>
   u16 char3;
<br/>
   u16 char4;
<br/>
   u8 flag;   // Should be equal to ATTRIB_LFN
<br/>
   u8 reserved1;   // Always 0x00
<br/>
   u8 checkSum;   // Checksum of short file name (alias)
<br/>
   u16 char5;
<br/>
   u16 char6;
<br/>
   u16 char7;
<br/>
   u16 char8;
<br/>
   u16 char9;
<br/>
   u16 char10;
<br/>
   u16 reserved2;   // Always 0x0000
<br/>
   u16 char11;
<br/>
   u16 char12;
<br/>
}   __PACKED DIR_ENT_LFN;
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84716 - chishm - Wed May 24, 2006 11:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
The struct should be packed, not individual elements i.e.
<br/>
</td> </tr></table><span class="postbody">
<br/>
You'd think so, and so did I. However, I found it didn't work that way. I decided to stop with the compiler dependent packing, and extract the values using an enum of offsets.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
