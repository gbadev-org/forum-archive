<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DS Lite brightness levels - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS Misc > DS Lite brightness levels</h2>
<div id="posts">
<div class="post">
    <h4>#85676 - HyperHacker - Thu Jun 01, 2006 7:02 pm</h4>
    <div class="postbody"><span class="postbody">Since I don't have a DS Lite I know very little about its backlight, and haven't seen much documentation. I've heard the only levels it has are low, medium low, medium high and high; you can't turn the light completely off? Also how do you adjust the brightness, is it the same way as with the old DS? (The power management bits?)<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85740 - thundrestrike - Fri Jun 02, 2006 2:50 am</h4>
    <div class="postbody"><span class="postbody">my friend got a DS Lite USA at one of those stores that broke release date... so he brought it over here and I can now answer your question!
<br/>
<br/>
You can not turn it completely off! strange huh? thats what I thought when I was playing with the brightness! :P
<br/>
<br/>
On the NDS firmware, the little light bulb in the bottom left of the screen, that is where you change brightness levels! Just keep pressing it! :D<br/>_________________<br/>popcorn</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85742 - HyperHacker - Fri Jun 02, 2006 3:12 am</h4>
    <div class="postbody"><span class="postbody">Hm, that is odd. It's hard to see with the light off though. Which level is the same as the original's?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>thundrestrike wrote:</b></span></td> </tr> <tr> <td class="quote">On the NDS firmware, the little light bulb in the bottom left of the screen, that is where you change brightness levels! Just keep pressing it! :D</td> </tr></table><span class="postbody">
<br/>
Yeah, I meant how would you do it in code? I know to turn it on and off on the original, you do some fiddling with the power management/SPI on the ARM7, but I haven't seen any mention of how it's done on Lite.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85748 - swimgod - Fri Jun 02, 2006 3:58 am</h4>
    <div class="postbody"><span class="postbody">i would say check moonshells code...
<br/>
i believe it has a way to remember the last bright setting :P
<br/>
<br/>
they problem is that from what i have heard no code is avalible to change it while in homebrew &gt;.&lt;;
<br/>
<br/>
weird eh?<br/>_________________<br/><span style="font-size: 9px; line-height: normal">
<br/>
1x <span style="font-weight: bold">WII</span> 2x remotes
<br/>
2x NDS/L(FMv7-ORG:v4,FMv7-org:DSL)
<br/>
1x GBAMP
<br/>
2x 1gb (MicroDrive{typeII}&amp;SanDisk{typeI})
<br/>
1x SuperPass2
<br/>
1x Supercard-CF</span>
<br/>
<a class="postlink" href="http://swimgod.com/ms_skins" target="_blank">MoonShell skins</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85750 - HyperHacker - Fri Jun 02, 2006 4:14 am</h4>
    <div class="postbody"><span class="postbody">Well here's what I gathered from Moonshell:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define PM_NDSLITE_ADR (4)
<br/>
#define PM_NDSLITE_ISLITE BIT(6)
<br/>
#define PM_NDSLITE_BRIGHTNESS(x) ((x &amp; 0x03)&lt;&lt;0)
<br/>
#define PM_NDSLITE_BRIGHTNESS_MASK (PM_NDSLITE_BRIGHTNESS(3))
<br/>
<br/>
//Determine if we're on DS Lite
<br/>
if(PM_GetRegister(PM_NDSLITE_ADR) &amp; PM_NDSLITE_ISLITE) DSLite = true;
<br/>
<br/>
//Adjust the brightness - Brightness is a value from 0 to 3
<br/>
data = PM_GetRegister(PM_NDSLITE_ADR);
<br/>
data &amp;= ~PM_NDSLITE_BRIGHTNESS_MASK;
<br/>
data |= PM_NDSLITE_BRIGHTNESS(Brightness);
<br/>
PM_SetRegister(PM_NDSLITE_ADR,data);</td> </tr></table><span class="postbody">
<br/>
<br/>
All I can really do is make sure that that detection method doesn't say I have a Lite. :-/<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85758 - HyperHacker - Fri Jun 02, 2006 5:29 am</h4>
    <div class="postbody"><span class="postbody">Well, <a class="postlink" href="http://hypernova.amarok-shadow.com/MyStuff/litetest.zip" target="_blank">here's</a> a test app and source. It succeeds in saying I don't have a Lite, that's about all I can do. It's based on the half-finished code from GBA Booter, so mind the mess. You need to make a small modification to ipc.h to compile it:
<br/>
<br/>
Before this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//---------------------------------------------------------------------------------
<br/>
typedef struct sTransferRegion {</td> </tr></table><span class="postbody">
<br/>
add:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#ifndef HH_NEW_IPC_STRUCT</td> </tr></table><span class="postbody">
<br/>
<br/>
and after this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">} TransferRegion, * pTransferRegion;</td> </tr></table><span class="postbody">
<br/>
add:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#endif</td> </tr></table><span class="postbody">
<br/>
<br/>
This shouldn't affect any other programs, unless you've defined HH_NEW_IPC_STRUCT for some reason. I use it to override the definition with my own, which is in main.h.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85777 - daninski - Fri Jun 02, 2006 9:55 am</h4>
    <div class="postbody"><span class="postbody">moonshell turns the light off on my dslite. its a dark blue japanese one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98492 - Lick - Tue Aug 15, 2006 4:41 pm</h4>
    <div class="postbody"><span class="postbody">I'm intentionally giving this topic a rebirth, because it's really of important that this 'simple' problem is resolved. 
<br/>
<br/>
Anyone had success controlling the brightness settings?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98496 - Nushio - Tue Aug 15, 2006 5:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">I'm intentionally giving this topic a rebirth, because it's really of important that this 'simple' problem is resolved. 
<br/>
<br/>
Anyone had success controlling the brightness settings?</td> </tr></table><span class="postbody">
<br/>
<br/>
I havent given it a thought, but I did notice that if I leave my DSPHat with the screens open on the alarm, the light will shut off. On the DSLite though, it just switches to the lowest screen setting. They wont turn off unless you actually close the lid. 
<br/>
<br/>
I'd say check on Moonshell, but thats already been said. Sorry for not being more helpful.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98499 - Lick - Tue Aug 15, 2006 5:26 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Okay i found it!</span> It works on the DS Lite.
<br/>
I haven't tested this on a Phat DS, if anyone can try?
<br/>
<br/>
<span style="font-weight: bold">Arm7</span> (has access to the PowerManagement settings, Arm9 does not)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> 
<br/>
// These are just values I use to send from Arm9 to Arm7
<br/>
// as message-identifiers..
<br/>
<br/>
#define GET_BRIGHTNESS      (0x1211B210)
<br/>
#define SET_BRIGHTNESS_0    (0x1211B211)
<br/>
#define SET_BRIGHTNESS_1    (0x1211B212)
<br/>
#define SET_BRIGHTNESS_2    (0x1211B213)
<br/>
#define SET_BRIGHTNESS_3    (0x1211B214)
<br/>
<br/>
<br/>
// Set up a Arm7 FIFO handler to
<br/>
// handle the above messages.
<br/>
<br/>
   u32 msg = REG_IPC_FIFO_RX;
<br/>
   if(msg == GET_BRIGHTNESS)
<br/>
    {
<br/>
// send back the value (0 - 3)
<br/>
        REG_IPC_FIFO_TX = readPowerManagement((4)) - 64;
<br/>
        return;
<br/>
    }
<br/>
    else if(msg == SET_BRIGHTNESS_0)
<br/>
    {
<br/>
// write value (0)
<br/>
        writePowerManagement((4), 0);
<br/>
        return;
<br/>
    }
<br/>
    else if(msg == SET_BRIGHTNESS_1)
<br/>
    {
<br/>
// write value (1)
<br/>
        writePowerManagement((4), 1);
<br/>
        return;
<br/>
    }
<br/>
    else if(msg == SET_BRIGHTNESS_2)
<br/>
    {
<br/>
// write value (2)
<br/>
        writePowerManagement((4), 2);
<br/>
        return;
<br/>
    }
<br/>
    else if(msg == SET_BRIGHTNESS_3)
<br/>
    {
<br/>
// write value (3)
<br/>
        writePowerManagement((4), 3);
<br/>
        return;
<br/>
    }</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">Arm9</span> (use Fifo to send commands to Arm7)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u32  NDSX_GetBrightnessLevel()
<br/>
{
<br/>
   REG_IPC_FIFO_TX = GET_BRIGHTNESS;
<br/>
   while(REG_IPC_FIFO_CR &amp; IPC_FIFO_RECV_EMPTY); 
<br/>
   return REG_IPC_FIFO_RX;
<br/>
}
<br/>
<br/>
<br/>
void NDSX_SetBrightnessLevel_0()
<br/>
{
<br/>
   REG_IPC_FIFO_TX = SET_BRIGHTNESS_0;
<br/>
}
<br/>
<br/>
<br/>
void NDSX_SetBrightnessLevel_1()
<br/>
{
<br/>
   REG_IPC_FIFO_TX = SET_BRIGHTNESS_1;
<br/>
}
<br/>
<br/>
<br/>
void NDSX_SetBrightnessLevel_2()
<br/>
{
<br/>
   REG_IPC_FIFO_TX = SET_BRIGHTNESS_2;
<br/>
}
<br/>
<br/>
<br/>
void NDSX_SetBrightnessLevel_3()
<br/>
{
<br/>
   REG_IPC_FIFO_TX = SET_BRIGHTNESS_3;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks HyperHacker (and originally Moonshell src)!<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98515 - HyperHacker - Tue Aug 15, 2006 7:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Nushio wrote:</b></span></td> </tr> <tr> <td class="quote">I did notice that if I leave my DSPHat with the screens open on the alarm, the light will shut off. On the DSLite though, it just switches to the lowest screen setting. They wont turn off unless you actually close the lid.</td> </tr></table><span class="postbody">
<br/>
So nobody's found a way to turn them off through software? It sounds like that might be done in hardware when you close the lid, and software can only choose the 4 levels. What happens in an older game like Mario 64?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98523 - MaHe - Tue Aug 15, 2006 8:04 pm</h4>
    <div class="postbody"><span class="postbody">It's possible to turn it off, but since the screens are different than in DS Phat, they won't be visible even under the extreme light in case the backlight is off ...<br/>_________________<br/><span style="font-size: 9px; line-height: normal">[ Crimson and Black Nintendo DS Lite | CycloDS Evolution | EZ-Flash 3-in-1 | 1 GB Transcend microSD ]</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98524 - Mallin - Tue Aug 15, 2006 8:04 pm</h4>
    <div class="postbody"><span class="postbody">I missed it if anyone said but the lowest seeting of the DSlite equals the same brightness as the DSphat, I can see why they didn't have off as an option, off is a useless option, especially when it runs for, what? 18 hours or so when on the lowest setting.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98586 - Lick - Wed Aug 16, 2006 5:47 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.bottledlight.com/ds/index.php/System/PowerManagement" target="_blank">http://www.bottledlight.com/ds/index.php/System/PowerManagement</a>
<br/>
<br/>
My guess at this is that the 4 brightness levels are just 'extra'. The screens can be turned on (4 levels) and off. Will have to test it to confirm though.
<br/>
<br/>
The AlarmClock probably stays on so you can look at the time, while you're trying to sleep/wake up.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98591 - HyperHacker - Wed Aug 16, 2006 5:54 am</h4>
    <div class="postbody"><span class="postbody">OK, so you toggle the lights on and off as usual, and there's an addition register used to set the brightness? So it's really max/high/medium/low/off? Again I don't have a Lite to test this on. :-/ When you call <span style="font-style: italic">writePowerManagement((4), 0)</span>, what does that end up doing? Eg shift the value x bits left and OR with the 16 bits at this address, etc etc...<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98597 - Lick - Wed Aug 16, 2006 9:00 am</h4>
    <div class="postbody"><span class="postbody">If you look on NDSTech's PowerManagement page,  you'll see that the four bits (7..4) are logged as -. This is probably data from the Phat DS. I believe that the DS Lite uses these bits to set its brightness (bit 4-5) and the fact tat it's a Lite (bit 6). I don't know what bit 7 is for, but perhaps reserved for later versions. =/
<br/>
Those are all different bits, -not- used by the Phat DS.
<br/>
<br/>
writePowerManagement() does the same as Moonshell, I assume. (Referring to the code you 'gathered' above)<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98602 - ghaxaq - Wed Aug 16, 2006 9:58 am</h4>
    <div class="postbody"><span class="postbody">Anyone tested it on the DS Phat or else can provide a file to test it myself.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98619 - Lick - Wed Aug 16, 2006 2:42 pm</h4>
    <div class="postbody"><span class="postbody">Tested by BigRedPimp and Kenny, it makes the Phat ASs power off. 
<br/>
<br/>
Probable solution: check if bit 6 is set, before doing bit 4-5 operations. (A) I'll post it when I wrote it, and if by that time someone else has not posted it already.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
