<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>romdiskfs filesystem for the DS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS Misc > romdiskfs filesystem for the DS</h2>
<div id="posts">
<div class="post">
    <h4>#62780 - GPFerror - Mon Dec 05, 2005 6:43 pm</h4>
    <div class="postbody"><span class="postbody">--------------------------------------------------------------------------------
<br/>
This DS library implementation the Linux ROMFS file system for reading a pre-made boot romdisk.
<br/>
<br/>
To create a romdisk image, you will need the program "genromfs". This program was designed for Linux but can compile under Cygwin.", included is a prebuilt mingw windows binary.
<br/>
<br/>
This was derived/ported from KOS 1.3.x from the Dreamcast KallistiOS .
<br/>
<br/>
included is a simple FS test which demonstrates reading a couple of files from the romdisk, and then it displays the directory structure.
<br/>
<br/>
for more information about using the filesystem checkout the fs.h file for the proper api calls, which are all very similiar to standard stdio calls.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">file_t   fs_open(const char *fn, int mode);
<br/>
void   fs_close(file_t hnd);
<br/>
ssize_t   fs_read(file_t hnd, void *buffer, size_t cnt);
<br/>
ssize_t   fs_write(file_t hnd, const void *buffer, size_t cnt);
<br/>
off_t   fs_seek(file_t hnd, off_t offset, int whence);
<br/>
off_t   fs_tell(file_t hnd);
<br/>
size_t   fs_total(file_t hnd);
<br/>
dirent_t* fs_readdir(file_t hnd);
<br/>
int   fs_ioctl(file_t hnd, void *data, size_t size);
<br/>
int   fs_rename(const char *fn1, const char *fn2);
<br/>
int   fs_unlink(const char *fn);
<br/>
int   fs_chdir(const char *fn);
<br/>
void*   fs_mmap(file_t hnd);
<br/>
int   fs_complete(file_t fd, ssize_t * rv);
<br/>
int   fs_stat(const char * fn, stat_t * rv);
<br/>
int   fs_mkdir(const char * fn);
<br/>
int   fs_rmdir(const char * fn);
<br/>
file_t   fs_dup(file_t oldfd);
<br/>
file_t   fs_dup2(file_t oldfd, file_t newfd); </td> </tr></table><span class="postbody">
<br/>
<br/>
Also include is some stdio newlib files(stdio.c and stdio.h) that call the kosFS for better stdio support but so far I havent figure out how to make them work successfully yet.
<br/>
<br/>
Enjoy :)
<br/>
Troy Davis(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk/ndsromdisk.shtml" target="_blank">http://gpf.dcemu.co.uk/ndsromdisk.shtml</a></span><span class="gensmall"><br/><br/>Last edited by GPFerror on Wed Dec 07, 2005 3:45 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#62792 - MaHe - Mon Dec 05, 2005 7:34 pm</h4>
    <div class="postbody"><span class="postbody">Hmmm, so this means you make this RomDisk 512Mbits big and put it on, let's say, X-ROM and then install FAT on it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62795 - GPFerror - Mon Dec 05, 2005 8:01 pm</h4>
    <div class="postbody"><span class="postbody">iv only tested it within the 4 megs of memory for the ds, its basically a gbfs like library that has some stdio like accessor functions. Shouldnt be to hard to port to work with other FS probably as well. Iv released the source code if anyones interested.
<br/>
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
