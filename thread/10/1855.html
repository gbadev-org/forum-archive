<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>NMOD Help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Audio > NMOD Help</h2>
<div id="posts">
<div class="post">
    <h4>#9503 - Vortex - Wed Aug 06, 2003 4:27 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
After long and exausting unsuccessful attempts to link the MNOD player to my program I finally decided to ask for help. For some reason the examples supplied with the player cannot be compiled or linked. It shows tons of error messages about unresolved external references. My kit includes gcc, devkitadv and crt0.s. I checked some previous discussion regarding the problem but still was not able to find any nice and clear example how to compile/link the player.
<br/>
<br/>
Any help will be appreciated.
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9507 - tepples - Wed Aug 06, 2003 7:23 pm</h4>
    <div class="postbody"><span class="postbody">If you get unresolved external references, we can't do much to help you unless you paste the exact error output of the linker.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9508 - Vortex - Wed Aug 06, 2003 7:38 pm</h4>
    <div class="postbody"><span class="postbody">Thank you for the replay. I managed to resolve most of the problems, except one:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int main(int argc, char argv[])
<br/>
{
<br/>
int i;
<br/>
//Set timer1 interrupt handler to NMOD_Timer1iRQ 
<br/>
iTimer1Intr=NMOD_Timer1iRQ;
<br/>
//Set mastervolumes to maximum
<br/>
NMOD_SetMasterVol(64,0);
<br/>
NMOD_SetMasterVol(64,1);
<br/>
NMOD_SetMasterVol(64,2);
<br/>
NMOD_SetMasterVol(64,3);
<br/>
//Start playing
<br/>
NMOD_Play( (u32)(&amp;BIN(module)) );
<br/>
for(;;)
<br/>
   {
<br/>
   pad=Joypad();
<br/>
   if (!(pad&amp;Pad1Start))
<br/>
      {
<br/>
      break;
<br/>
      }
<br/>
   VSync();
<br/>
   }
<br/>
//Stop playing
<br/>
NMOD_Stop();
<br/>
for(;;);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This is part of the source taken from one of the NMOD examples. The problem is with the following line:
<br/>
<br/>
iTimer1Intr=NMOD_Timer1iRQ;
<br/>
<br/>
NMOD_Timer1iRQ is a function declared in one of the header files. iTimer1Intr however is not declared anywhere. My best guess this is an interrupt handler, but my crt0.s doesn't support such a name. Also in the (very brief) documentation is not mentioned what kind of interrupt handling should be set in the crt0.s file (there are three modes).
<br/>
<br/>
Again, your help will be appreciated.
<br/>
<br/>
Thanks in advance</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9509 - DekuTree64 - Wed Aug 06, 2003 8:12 pm</h4>
    <div class="postbody"><span class="postbody">I think you can replace that with anything that makes it get called on a timer1 interrupt. 
<br/>
If you're using Jeff's Crt0, and have interrupts enabled in it, you should have an array of function pointers called IntrTable, so set the timer1 slot of that to NMOD_Timer1iRQ. Not sure which it is, but they go in the order of the bits in REG_IE, so just count until you get to timer1. 
<br/>
If you're using your own or someone else's handler, then I'm not sure. If it's your own, you could just call NMOD_Timer1iRQ directly from the handler if you don't have a function pointer table.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9527 - Vortex - Thu Aug 07, 2003 6:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">I think you can replace that with anything that makes it get called on a timer1 interrupt. 
<br/>
If you're using Jeff's Crt0, and have interrupts enabled in it, you should have an array of function pointers called IntrTable, so set the timer1 slot of that to NMOD_Timer1iRQ. Not sure which it is, but they go in the order of the bits in REG_IE, so just count until you get to timer1. 
<br/>
If you're using your own or someone else's handler, then I'm not sure. If it's your own, you could just call NMOD_Timer1iRQ directly from the handler if you don't have a function pointer table.</td> </tr></table><span class="postbody">
<br/>
<br/>
That worked fine. Thanks for the help, much appreciated.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
