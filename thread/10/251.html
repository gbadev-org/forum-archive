<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Figuring out how many samples play between vblanks - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Audio > Figuring out how many samples play between vblanks</h2>
<div id="posts">
<div class="post">
    <h4>#1533 - xonox - Sun Jan 19, 2003 9:53 pm</h4>
    <div class="postbody"><span class="postbody">I'm coding a simple sound routine, i update the buffers after every vblank.  I'd like to know how can i figure out how many samples get played every video frame.  All i got up to now is that the refresh is *around* 59.737 hz
<br/>
<br/>
Anyone's got some good links to pages with sound mixing theory/algorithms as well as about changing the pitch ?  I am able to mix sounds and change the pitch (in a non precise way) but i want to learn more about these subjects...   I searched google already but i was probably not putting in the proper keywords as i didn't get too much good info.
<br/>
<br/>
Thanks a lot!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1541 - tepples - Sun Jan 19, 2003 11:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>xonox wrote:</b></span></td> </tr> <tr> <td class="quote">I'd like to know how can i figure out how many samples get played every video frame.</td> </tr></table><span class="postbody">
<br/>
To set up audio playback, you take 65536 minus the number of cycles per sample and stuff it into a timer's start register.  Therefore, you know how many cycles per sample you're using.
<br/>
<br/>
According to the <a class="postlink" href="http://www.cs.rit.edu/~tjh8300/CowBite/CowBiteSpec.htm" target="_blank">CowBite spec</a>, there are 1232 cycles per scanline and 228 scanlines per frame for a total of 280896 cycles per frame.  Divide your number of cycles per sample into 280896 and you get the number of cycles per frame.  If the result is not an integer, you will get an occasional click when synchronizing DMA playback to vblank.
<br/>
<br/>
For a typical mixer frequency of 18157 Hz, use 924 cycles per sample and 304 samples per frame.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1638 - Vortex - Mon Jan 20, 2003 10:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>xonox wrote:</b></span></td> </tr> <tr> <td class="quote">Anyone's got some good links to pages with sound mixing theory/algorithms as well as about changing the pitch ?  I am able to mix sounds and change the pitch (in a non precise way) but i want to learn more about these subjects...   I searched google already but i was probably not putting in the proper keywords as i didn't get too much good info.</td> </tr></table><span class="postbody">
<br/>
<br/>
A good starting point is <a href="http://www.harmony-central.com" target="_blank">http://www.harmony-central.com</a> - check the links under "Computer". Another good link is <a href="http://www.dspguide.com/." target="_blank">http://www.dspguide.com/.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1686 - NEiM0D - Tue Jan 21, 2003 4:26 pm</h4>
    <div class="postbody"><span class="postbody">I suggest double buffering with a 60Hz timer.
<br/>
You can call your 'refill buffers' routine every Vblank.
<br/>
Ofcourse you'll need to add a routine to check if the buffer was switched, if so, and refill the respective buffer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
