<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Trouble using sounds in Apex - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Audio > Trouble using sounds in Apex</h2>
<div id="posts">
<div class="post">
    <h4>#24988 - dagamer34 - Sat Aug 14, 2004 5:11 pm</h4>
    <div class="postbody"><span class="postbody">I am having trouble converting a .wav file to be used with Apex. Here's what it errors it spits out:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
C:/Consoles/Development/GBA/DevKits/HAM/tools/win32/Conv2AAS.exe sfx
<br/>
<br/>
/---------------------------------------------\
<br/>
| Conv2AAS v1.07        WAV, RAW &amp; MOD -&gt; AAS |
<br/>
| Copyright (c) 2003, Apex Designs            |
<br/>
\---------------------------------------------/
<br/>
<br/>
Adding WAV Ambulance.wav...
<br/>
WAV_LoadSound( sfx/Ambulance.wav ): Failed: Zero length data subchunk...
<br/>
Writing AAS_SampleData (Unique:0 Actual:0 Length:0)...Done!
<br/>
Writing AAS_PatternData (Unique:0 Actual:0 Length:0)...Done!
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I can't get it to work! If anybody wants to see if they can make the .wav file work, here's a *pitiful* link to the file, zipped(450KB). 
<br/>
<a class="postlink" href="http://www.geocities.com/dagamer34/mario.zip" target="_blank">www.geocities.com/dagamer34/mario.zip</a>
<br/>
<br/>
Yes, the webhosting is crappy. I realize that. :)<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25010 - tepples - Sun Aug 15, 2004 1:11 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">I can't get it to work! If anybody wants to see if they can make the .wav file work, here's a *pitiful* link to the file, zipped(450KB). 
<br/>
<a class="postlink" href="http://www.geocities.com/dagamer34/mario.zip" target="_blank">www.geocities.com/dagamer34/mario.zip</a>
<br/>
<br/>
Yes, the webhosting is crappy.</td> </tr></table><span class="postbody">
<br/>
I opened it in Cool Edit, and the sound quality is even crappier. Which emulator did you use to capture this?
<br/>
<br/>
I hex edited the file, and it seems to have extra chunks other than just fmt and data. Does Conv2AAS have trouble with extra chunks?
<br/>
<br/>
Have you tried making sure that the wav is a multiple of four samples in length?
<br/>
<br/>
Using AAS? You might have a better time with a MOD format conversion of the song rather than trying to load a 2 MByte wav file. Perhaps AAS has a limit on how big a wav file can be.
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span> Here ya go: <a href="http://pinocchio.jk0.org/gbaforum/mariobgm1.zip" target="_blank">http://pinocchio.jk0.org/gbaforum/mariobgm1.zip</a>
<br/>
<br/>
See if any of these sound better.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25013 - jd - Sun Aug 15, 2004 2:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
WAV_LoadSound( sfx/Ambulance.wav ): Failed: Zero length data subchunk...
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
AAS's WAV importer is very simplistic so the files have to be very specifically formatted for it to be able to process them. If you run the file through SoX with the following options then the file should work correctly (other programs should work as well, but SoX is what I've used in the past to do the job and it's free):
<br/>
<br/>
sox [source_filename] -s -b -c 1 [destination_filename]
<br/>
<br/>
You'll get a warning about .wav files not supporting 8-bit signed format - don't worry about that. (The command above also works if you want to convert to .raw format.)
<br/>
<br/>
You can get SoX here:
<br/>
<br/>
<a class="postlink" href="http://sox.sourceforge.net/" target="_blank">http://sox.sourceforge.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25015 - tepples - Sun Aug 15, 2004 6:21 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jd wrote:</b></span></td> </tr> <tr> <td class="quote">AAS's WAV importer is very simplistic so the files have to be very specifically formatted for it to be able to process them.</td> </tr></table><span class="postbody">
<br/>
Do you want help with improving its wav reader?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25023 - jd - Sun Aug 15, 2004 5:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jd wrote:</b></span></td> </tr> <tr> <td class="quote">AAS's WAV importer is very simplistic so the files have to be very specifically formatted for it to be able to process them.</td> </tr></table><span class="postbody">
<br/>
Do you want help with improving its wav reader?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Sure, if you're offering - although, as far as I can tell, adding support for all types of WAV is a pretty major job.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25027 - tepples - Sun Aug 15, 2004 7:15 pm</h4>
    <div class="postbody"><span class="postbody">The RIFF WAVE parser in <a class="postlink" href="http://pinocchio.jk0.org/gbaforum/myima.zip" target="_blank">the encoder from 8ad</a> has properly read all mono and stereo linear-PCM .wav files that Cool Edit has thrown at it. It parses the RIFF chunk structure rather than just assuming a 44-byte "canonical" header. The WAVE code (readwav.c and readwav.h) is under a permissive license; it comes with a GPL'd demo (myima.c) showing how to open a wave file for reading samples.
<br/>
<br/>
If you need more help getting the library to work, just ask me.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25033 - dagamer34 - Sun Aug 15, 2004 8:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">I can't get it to work! If anybody wants to see if they can make the .wav file work, here's a *pitiful* link to the file, zipped(450KB). 
<br/>
<a class="postlink" href="http://www.geocities.com/dagamer34/mario.zip" target="_blank">www.geocities.com/dagamer34/mario.zip</a>
<br/>
<br/>
Yes, the webhosting is crappy.</td> </tr></table><span class="postbody">
<br/>
I opened it in Cool Edit, and the sound quality is even crappier. Which emulator did you use to capture this?
<br/>
<br/>
I hex edited the file, and it seems to have extra chunks other than just fmt and data. Does Conv2AAS have trouble with extra chunks?
<br/>
<br/>
Have you tried making sure that the wav is a multiple of four samples in length?
<br/>
<br/>
Using AAS? You might have a better time with a MOD format conversion of the song rather than trying to load a 2 MByte wav file. Perhaps AAS has a limit on how big a wav file can be.
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span> Here ya go: <a href="http://pinocchio.jk0.org/gbaforum/mariobgm1.zip" target="_blank">http://pinocchio.jk0.org/gbaforum/mariobgm1.zip</a>
<br/>
<br/>
See if any of these sound better.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I used 2 emulators actually. I used VisualBoy Advance and PocketNES to get the music. I have a midi of the music but don't know how to write a midi player on the GBA.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25034 - dagamer34 - Sun Aug 15, 2004 9:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jd wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
WAV_LoadSound( sfx/Ambulance.wav ): Failed: Zero length data subchunk...
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
AAS's WAV importer is very simplistic so the files have to be very specifically formatted for it to be able to process them. If you run the file through SoX with the following options then the file should work correctly (other programs should work as well, but SoX is what I've used in the past to do the job and it's free):
<br/>
<br/>
sox [source_filename] -s -b -c 1 [destination_filename]
<br/>
<br/>
You'll get a warning about .wav files not supporting 8-bit signed format - don't worry about that. (The command above also works if you want to convert to .raw format.)
<br/>
<br/>
You can get SoX here:
<br/>
<br/>
<a class="postlink" href="http://sox.sourceforge.net/" target="_blank">http://sox.sourceforge.net/</a></span></td> </tr></table><span class="postbody">
<br/>
<br/>
I already tried running it through SOX and that's the error message that occured.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25040 - jd - Sun Aug 15, 2004 9:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I already tried running it through SOX and that's the error message that occured.</td> </tr></table><span class="postbody">
<br/>
<br/>
I just tried it and it works fine once it's been processed by SoX. Are you sure you weren't accidentally using the old file or something like that?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25044 - tepples - Sun Aug 15, 2004 10:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">I opened it in Cool Edit, and the sound quality is even crappier. Which emulator did you use to capture this?</td> </tr></table><span class="postbody">
<br/>
<br/>
I used 2 emulators actually. I used VisualBoy Advance and PocketNES to get the music.</span></td> </tr></table><span class="postbody">
<br/>
PocketNES's sound sucks. Unlike the NES, the Game Boy doesn't support software envelopes on its tone generators without restarting the note, and restarting the note every frame produces the buzzy, underwater sound you hear.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I have a midi of the music but don't know how to write a midi player on the GBA.</td> </tr></table><span class="postbody">
<br/>
It involves interpreting the Standard MIDI File format (<a class="postlink" href="http://www.google.com/search?q=standard%20midi%20file%20format" target="_blank">ask Google</a>) and sending sample playback commands to AAS or to whatever other sound player you choose.
<br/>
<br/>
And you may have to tell SoX to discard "extra information" when converting a file.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
