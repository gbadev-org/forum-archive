<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>AAS and high notes crapping out, in sound and CPU usage - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Audio > AAS and high notes crapping out, in sound and CPU usage</h2>
<div id="posts">
<div class="post">
    <h4>#46061 - DiscoStew - Sun Jun 19, 2005 5:49 am</h4>
    <div class="postbody"><span class="postbody">For the past few days, I've taken a break from programming to work on converting SPCs into MODs to use with AAS, and I'm glad to say that the conversion sounds really good (even if they are beign played as MONO most of the time). However, I've run into some audio problems when running them using AAS on the GBA.
<br/>
<br/>
1) With AAS, is there a certain limit beyond the normal limit that notes can be played at? I'm wondering because after having converted SPCs to MOD, I've had to take into consideration of the samples being at a constant ~8kHz, and change the transpose of all the notes to make them match the original sounds of the song. The problem with that is the notes can tend to be REALLY high, and with AAS, the audio begins crapping out right at those points, and even sounds like the notes can't be played as high as they are set to be. I can fix this problem internally by resampling the problematic instruments, and changing the transpose again for each note using that instrument, but that will require both time and effort as I am using the same samples over a bunch of songs.
<br/>
<br/>
2) With AAS, does it require more CPU time when playing high notes? This is from a result I've seen after having dealt with the 1st problem above, with visual effects and updating of data to use on it.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46063 - tepples - Sun Jun 19, 2005 6:05 am</h4>
    <div class="postbody"><span class="postbody">The MOD has a maximum pitch for each sample, which some players enforce more strictly than others. Downsample the problematic instruments by a factor of 2 (e.g. from 16744 Hz to 8372 Hz) and things should be fine.
<br/>
<br/>
AAS is known to runs faster with low pitches. It appears to use a technique described in <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=4264&amp;highlight=aas" target="_blank">this thread about mixer optimization</a>, using the ARM conditional execution bits to take the time to load and amplify a new sample only if the source address has increased. Obviously, the source address will increase more often for a sample being played back at a faster rate.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46159 - jd - Tue Jun 21, 2005 12:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DiscoStew wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
1) With AAS, is there a certain limit beyond the normal limit that notes can be played at?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes - four times the mixing frequency. (So a quick way to test if this is the problem would be to increase the mixing frequency.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DiscoStew wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
2) With AAS, does it require more CPU time when playing high notes?</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, although generally the difference should only be relatively small. (Also, remember if you play samples above the mixing frequency then the extra sample data is unused.)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
