<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems compiling Krawall under Linux - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Audio > Problems compiling Krawall under Linux</h2>
<div id="posts">
<div class="post">
    <h4>#24224 - FireOut - Fri Jul 30, 2004 1:42 am</h4>
    <div class="postbody"><span class="postbody">Greetings,
<br/>
<br/>
I am currently developing a game under Linux along with 2 friends. Since a real musician will be composing the music, we decided to use Krawall for music since it has great sound quality as well as support for sfx and different file formats (CPU usage is not much of a problem for our game).
<br/>
<br/>
Well, here is the problem: I always compiled Krawall just fine under Windows, the example included in its free distribution works great. (with Devkitadv R4 or R5)
<br/>
<br/>
Under Linux, we couldn't compile anything audible, as much as we tried to tweak everything up.
<br/>
<br/>
We compiled our devkit following the steps provided in <a href="http://linux.gbadev.org/gcc-gba/" target="_blank">http://linux.gbadev.org/gcc-gba/</a> . It does work great for our soundless code ;), the compiled roms run on real hardware just fine.
<br/>
<br/>
Well, we tried swapping lnkscript's and crt0's but that didn't seem to do the trick. We could generate a .bin file in the end, but it just shows a flat white screen.
<br/>
<br/>
I compared both the Windows working compiled code and the Linux crappy compiled code, the files generated in the modules/ directory are the same. The .elf and .bin are obviously different.
<br/>
<br/>
Here are the warnings we get from the "free Krawall" example/Makefile under Linux:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
arm-thumb-elf-as -mthumb-interwork -marm7tdmi crt0.s -o crt0.o
<br/>
arm-thumb-elf-gcc -c -O2 -mthumb-interwork -Wall -ffreestanding -I../include/  main.c -o main.o
<br/>
arm-thumb-elf-gcc -mthumb -mthumb-interwork -Tlnkscript -nostartfiles  -o example.bin.elf crt0.o main.o ../gcclib/krawall.lib modules/modules.lib
<br/>
ld: Warning: _divsi3.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: _dvmd_tls.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: _call_via_rX.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: __main.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: _ctors.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: unwind-dw2-fde.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: atexit.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: bzero.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: impure.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: libcfunc.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: malloc.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: mallocr.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: memcpy.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: mlock.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: sbrkr.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: strlen.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: syscalls.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: errno.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: findfp.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: freer.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: fwalk.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: memset.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: reent.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: stdio.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: writer.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: closer.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: fflush.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: lseekr.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: Warning: readr.o does not support interworking, whereas example.bin.elf does not
<br/>
ld: __main.o(__gccmain): warning: interworking not enabled.
<br/>
ld:   first occurrence: main.o: arm call to thumb
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I could compile AAS without much trouble, but I really wanted to use Krawall for the reasons mentioned above.
<br/>
<br/>
Is there anything we are doing wrong?
<br/>
Anyone ever managed to get Krawall running under Linux?
<br/>
<br/>
Thank you for reading  (or trying to ;) ).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24236 - wintermute - Fri Jul 30, 2004 7:39 am</h4>
    <div class="postbody"><span class="postbody">That tutorial is missing a rather vital part of the build process for GBA - you need to enable the interworking parts of the multilibs. I'd also recommend not using the source packages specified in that document, they're quite old versions now.
<br/>
<br/>
Easiest option is to grab the linux build of devkitARM from <a href="http://www.devkit.tk" target="_blank">http://www.devkit.tk</a> or, if you really want to build it from source, grab the build scripts from the DIY section. The scripts *should* work on most linux variants but you may have a little trouble on BSD systems.  I have someone helping to sort that one out so hopefully there'll be a script update soon.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24245 - FireOut - Fri Jul 30, 2004 3:04 pm</h4>
    <div class="postbody"><span class="postbody">Thanks a lot, wintermute.
<br/>
<br/>
We are using Gentoo here, but we don't have root access in our university network (lucky them ;) ).
<br/>
<br/>
We actually had tried the devkitARM binaries before but there were some wierd errors, so I had completely ignored it. I just compiled it using the (pretty impressive) script in DIY you suggested, and it worked great.
<br/>
<br/>
Three guys are really grateful here, thank you again.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
