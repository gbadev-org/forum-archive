<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Krawall Wav to S3M conversion - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Audio > Krawall Wav to S3M conversion</h2>
<div id="posts">
<div class="post">
    <h4>#62749 - hobby16 - Mon Dec 05, 2005 12:31 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
I try to use Krawall to play music and vocal messages (sound playing with HAM is buggy!). 
<br/>
<br/>
I don't know how to do, unless I can <span style="font-weight: bold">convert wav to S3M</span> format.
<br/>
Can anyone help me.
<br/>
Many thanks in advance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62782 - DekuTree64 - Mon Dec 05, 2005 6:51 pm</h4>
    <div class="postbody"><span class="postbody">That would be a task worthy of writing a PhD thesis on. Even then I doubt anyone could reliably separate more than a few simple instruments from eachother.
<br/>
<br/>
You pretty much have to rewrite a song from scratch if you want to convert from wav/mp3 type formats to note-based formats like mod and midi. <a class="postlink" href="http://www.modplug.com/" target="_blank">MODPlug Tracker</a> is good for writing tracked music. Finding/making good instrument samples can be difficult though. Maybe try doing some chiptunes for starters :)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62784 - kusma - Mon Dec 05, 2005 7:00 pm</h4>
    <div class="postbody"><span class="postbody">i have a feeling he's after something that krawalls converter eats, so he can get sound-effect samples into krawall. the way you'd do that, is by using something like modplug tracker to assemble an s3m with only samples (no pattern-data) and just feed that to the converter.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62808 - gauauu - Tue Dec 06, 2005 2:33 am</h4>
    <div class="postbody"><span class="postbody">If you just want to play a short clip from a wav file, use modplug tracker to create a new s3m file.  In the samples tab,  click the "import sample" button, and import the wav file into the s3m.
<br/>
<br/>
Then, you can either save the s3m and use the sample as a krawall SFX, or you can create a pattern in the s3m using that sample once, and play it as music in krawall.
<br/>
<br/>
When you do, make sure you give the sample a nice simple name, so you can refer to it from your C code without having problems.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62852 - hobby16 - Tue Dec 06, 2005 1:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauauu wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Then, you can either save the s3m and use the sample as a krawall SFX, or you can <span style="font-weight: bold">create a pattern in the s3m using that sample once</span>, and play it as music in krawall.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Hi gauauu,
<br/>
thanks for your reply. Maybe I 'm near the solution :
<br/>
Create my new S3M file : ok
<br/>
Imported my wav : ok
<br/>
Save my S3M: ok
<br/>
Make my gba with the exported S3M by typing "make" =&gt; got this message "empty file!!! (sfx?)"
<br/>
<br/>
<br/>
I must misunderstand your statement in bold!
<br/>
Can you plz give more details (I newbie to Modplug Tracker)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62862 - gauauu - Tue Dec 06, 2005 3:52 pm</h4>
    <div class="postbody"><span class="postbody">typing "make" depends on there being a makefile to use.  I don't know much about ham's make system, but generally, make is a tool that that follow commands you give it to compile things.  But you still have to specify how things are compiled.
<br/>
<br/>
For S3Ms and krawall, the free krawall distribution comes with a program called "converter.exe"....you run that from a command prompt with the name of the directory that has your s3m.  If all goes well, it will spit out some .h and .s files.  The .h files can be included into your C project to access the data in the .s files.  The .s files need to be assembled using an assembler (if you are using the gcc toolchain from devkit-whichever, you can use AS from the command prompt...you'll maybe want to pass in the -mthumb-interwork parameter also).  
<br/>
<br/>
Once you've gotten .o files from assembling the .s files, you can link with your .o files and use the krawall functions with your sound effects.  
<br/>
<br/>
For a simple wav sound, I wouldn't bother with the "create a pattern in the s3m" step.  It's really not necessary.  But basically what it means....an s3m is a format that takes a bunch of "samples" (wav files, sound effects, etc), and sequences them, at differnet pitches, over and over, to build a song.  For example, you might have a sample of a piano key, and a snare drum.  With that piano key, you would sequence it to play at different times and frequencies, and with the snare drum behind it, to build your song.   But if you just want to play a wav file, you don't need to sequence the whole song out of it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62863 - hobby16 - Tue Dec 06, 2005 4:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauauu wrote:</b></span></td> </tr> <tr> <td class="quote">typing "make" depends on there being a makefile to use.  I don't know much about ham's make system, but generally, make is a tool that that follow commands you give it to compile things.  But you still have to specify how things are compiled.
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
Yeah, the "make" I told about uses converter.exe. It works on the sample S3M BUT not on the S3M exported by Modplug.
<br/>
<br/>
The problem is not from my compilation chain but from the Modplug usage :
<br/>
HOW to convert a wav to S3M with Modplug. I cannot produce a usable S3M file ;-(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62868 - hobby16 - Tue Dec 06, 2005 4:53 pm</h4>
    <div class="postbody"><span class="postbody">Some news :
<br/>
I use modplug player to load a WAV file and save as S3M file. This S3M is playable with a windows player.
<br/>
And now, my S3M is correctly converted and included by my tool chain to produce a GBA exec.
<br/>
<br/>
But when playing it, NO SOUND. What a hell !
<br/>
I wonder if it is outright possible to play a wav file with Krawall (in my case, making my GBA speaking some voices).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62874 - thegamefreak0134 - Tue Dec 06, 2005 5:38 pm</h4>
    <div class="postbody"><span class="postbody">When it says "empty file (sfx?)" that's telling you that your file has no patterns in it. If you're importing a file for SFX, this is actually the exact message you want. Then, you look at the resulting samples.h and use that name in a SFX call to play the sound. All patternless files return this message from the converter.
<br/>
<br/>
If you have patterns in the file, then you're having errors.<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62882 - hobby16 - Tue Dec 06, 2005 6:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>thegamefreak0134 wrote:</b></span></td> </tr> <tr> <td class="quote">...</td> </tr></table><span class="postbody">
<br/>
Sorry, I don't understand.
<br/>
<br/>
Please, see my  3:53 pm message.
<br/>
My problem is from my WAV to S3M conversion. Not from my compilation suite (or so I think).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62947 - gauauu - Wed Dec 07, 2005 3:04 am</h4>
    <div class="postbody"><span class="postbody">Ok, see above, where I explain about building a song using the "samples"...that is generally how S3M's are constructed.  So if you have samples loaded into your S3M, but have not defined a pattern, then it will be an "empty" S3M, and players like winamp, etc, won't play anything.
<br/>
<br/>
BUT Krawall has 2 different ways of handling S3M data...you can play the S3M (using krapPlay()), which will play the same thing that winamp or media player will play when playing the S3M.  Or, Krawall is smart enough to extract just the samples from the S3M, and can play them by themselves, using kramPlay().  
<br/>
<br/>
So probably, you are using krapPlay to play the S3M, but since you didn't define a pattern for playing your samples, it is correctly playing nothing.  
<br/>
<br/>
If you just want it to play the sample directly, use kramPlay(), and pass it the address of the sample, not the address of the song.  Also, like I mentioned before, make sure to give your samples a simple name in the S3M file.  If the name is blank or has weird characters, Krawall won't always give you a nice pointer for it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62948 - gauauu - Wed Dec 07, 2005 3:07 am</h4>
    <div class="postbody"><span class="postbody">One more thing.  Make sure your WAV file is an 8-bit PCM.  S3M's can use all sorts of types of wavs, but Krawall can't.  
<br/>
<br/>
To convert your PCM, you can use something like <a class="postlink" href="http://nch.com.au/switch/index.html" target="_blank">Switch</a>[/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#62971 - hobby16 - Wed Dec 07, 2005 10:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauauu wrote:</b></span></td> </tr> <tr> <td class="quote">One more thing.  Make sure your WAV file is an 8-bit PCM.  S3M's can use all sorts of types of wavs, but Krawall can't.  
<br/>
<br/>
To convert your PCM, you can use something like <a class="postlink" href="http://nch.com.au/switch/index.html" target="_blank">Switch</a>[/url]</td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah, that's it, my wav is in 16-bit format. When converted to 8 bit, all is correct NOW. Thank you very much !!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63015 - hobby16 - Wed Dec 07, 2005 9:18 pm</h4>
    <div class="postbody"><span class="postbody">I still have a problem : I can't play a stereo wav file.
<br/>
When importing the wav as "samples" in my S3M file, I see the 2 channels of the sample. 
<br/>
But when playing the S3M with Modplug Player, only the LEFT vue-meters is active.
<br/>
<br/>
And when playing with Krawall, the sound is mono.
<br/>
<br/>
I am near the end! Can anyone help me ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63016 - kusma - Wed Dec 07, 2005 9:28 pm</h4>
    <div class="postbody"><span class="postbody">I'm guessing that krawall only support mono-samples (let's face it, noone does), and that you'd have to split it into two samples and play both at a different pan. either that, or just mix both channels togeither.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63019 - hobby16 - Wed Dec 07, 2005 10:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">I'm guessing that krawall only support mono-samples (let's face it, noone does), and that you'd have to split it into two samples and play both at a different pan. either that, or just mix both channels togeither.</td> </tr></table><span class="postbody">
<br/>
<br/>
What do you mean by different "pan" ? And how do you split a stereo file as 2 mono files ?
<br/>
<br/>
BTW, to mix both channels, I just need to export my sound as a mono WAV (but I want my stereo sound !).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63021 - keldon - Wed Dec 07, 2005 10:41 pm</h4>
    <div class="postbody"><span class="postbody">Pan decides 'where' the sound is positioned to the ear. Something panned fully left only appears in the left ear. A sound can be panned to the middle where it is heard equally in both ears.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63101 - thegamefreak0134 - Thu Dec 08, 2005 6:16 pm</h4>
    <div class="postbody"><span class="postbody">There are tools that can separate the audio into separrate channels for you. (I think audacity can do it, but I'm not sure.) As for playing them in Krawall, look in the docs. There are two commands for playing sounds: One for easy use and one that supports different parameters. <span style="font-style: italic">One of them is panning!</span> Simply play the left channel panned to the left all the way and the right channel panned all the way to the right. Make sure to play them both at the same time r it will sound bad.
<br/>
<br/>
Also, Krawall doesn't like panning out less than all the way. It will do it, but the time required to calculate such a pan is much greater, so just avoid it if possible, unless of course you have the CPU time to spare. The easiest way to figure out the whole CPU time thing is if your sounds are "skipping".<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
