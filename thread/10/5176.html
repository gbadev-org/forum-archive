<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Envelopes?! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Audio > Envelopes?!</h2>
<div id="posts">
<div class="post">
    <h4>#37584 - ProblemBaby - Sun Mar 13, 2005 3:36 pm</h4>
    <div class="postbody"><span class="postbody">I know how they work, but it is some things I dont understand..
<br/>
<br/>
First:
<br/>
Say Ive the first point at (0, 0)  and the second at (2, 2) and third at (4,4)
<br/>
Is this correct:
<br/>
Tick 0: Vol = 0
<br/>
Tick 1: Vol = 1
<br/>
Tick 2: Vol = 2
<br/>
Tick 3: Vol = 2
<br/>
Tick 4: Vol = 3
<br/>
Tick 5: Vol = 4
<br/>
etc...
<br/>
or should it continue right after?
<br/>
then a interesting question appears what about the delta value 0 or 1 between two points..
<br/>
should that be recoqnized?
<br/>
some info whould be great!
<br/>
<br/>
edit: I refer to the XM format</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37594 - DekuTree64 - Sun Mar 13, 2005 11:01 pm</h4>
    <div class="postbody"><span class="postbody">Yep, that's exactly right. Just interpolate between the current node and the next node, using the current tick. It does involve a divide, but you could make a reciprocal table to speed that up.
<br/>
<br/>
The actual updating process goes something like this
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">tick++;
<br/>
while (tick &gt;= nodeX[nextNode])
<br/>
{
<br/>
   curNode = nextNode;
<br/>
   if (curNode &gt;= end)
<br/>
      // deal with looping/ending
<br/>
   else
<br/>
      nextNode = curNode+1;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
That while loop will deal with the 0-delta nodes, just jumping past them.
<br/>
The 'end' there is either the last node of the loop, or nodeCount-1, because you want to go into your special end processing immediately when you get to the last node.
<br/>
<br/>
Then calculating the final volume based on the tick:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (nodeX[nextNode] == nodeX[curNode])
<br/>
   envVol = nodeY[curNode];
<br/>
else
<br/>
   envVol = nodeY[curNode] + 
<br/>
      ((nodeY[nextNode] - nodeY[curNode]) * 
<br/>
       (tick - nodeX[curNode]) / 
<br/>
       (nodeX[nextNode] - nodeX[curNode]));</td> </tr></table><span class="postbody">
<br/>
Check for the divide by 0 there for the times when curNode and nextNode both point to the same node, like a 0-length loop, or when you hit the end and don't loop.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37595 - ProblemBaby - Mon Mar 14, 2005 12:02 am</h4>
    <div class="postbody"><span class="postbody">Thanks for the information.[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37600 - ProblemBaby - Mon Mar 14, 2005 1:26 am</h4>
    <div class="postbody"><span class="postbody">In ModPlugTracker it seems like it updates the first tick as well
<br/>
so The very first volume will actually be 1 in my case.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
