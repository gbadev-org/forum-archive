<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Choppy 8ad playback - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Audio > Choppy 8ad playback</h2>
<div id="posts">
<div class="post">
    <h4>#43360 - enliteneer - Sun May 22, 2005 7:42 pm</h4>
    <div class="postbody"><span class="postbody">I compiled the 8ad sample program (chordbasic.wav) but the playback on both VBA and on the real hardware is extremely choppy (half-second pauses with no sound throughout).  It even has a high pitch squeal thats not on the original wav file.
<br/>
<br/>
I tried using it with my own wave files (16bit, mono, 18157 hz) but they all sound corrupted at playback.  
<br/>
<br/>
What am I doing wrong????</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43399 - tepples - Mon May 23, 2005 2:06 am</h4>
    <div class="postbody"><span class="postbody">Which compiler toolchain are you using? The distribution is intended for DevKit Advance R5 beta 3 (outdated but it was newest when I made 8ad). If you're using devkitARM, replace the block in mk.bat marked <span style="font-weight: bold">=== code ===</span> with this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">echo === code ===
<br/>
arm-elf-gcc -Wall -O -marm -mthumb-interwork -c isr.c
<br/>
if errorlevel 1 goto end
<br/>
arm-elf-gcc -Wall -O3 -marm -mthumb-interwork -c playad.iwram.c -o playad.iwram.o
<br/>
if errorlevel 1 goto end
<br/>
arm-elf-gcc -Wall -O -mthumb -mthumb-interwork -o 1.elf -DDEMO isr.o playad.iwram.o playad.c libgbfs.c --specs=gba.specs
<br/>
if errorlevel 1 goto end
<br/>
arm-elf-objcopy -O binary 1.elf 1.bin
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And what does the "CPU time" line say? I get "12 scanlines" (hw) and "20 scanlines" (vba) with devkitARM R11.
<br/>
<br/>
Perhaps what's supposed to go in IWRAM isn't going in IWRAM. Try this at the command line:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">nm -n 1.elf &gt; address.txt</td> </tr></table><span class="postbody">
<br/>
and paste the lines that start with "0300".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43420 - enliteneer - Mon May 23, 2005 8:00 am</h4>
    <div class="postbody"><span class="postbody">When I tried to change the batchfile to use 'arm-elf-gcc' it couldnt find the exe.  Im not sure why my install only had 'arm-agb-elf'?  I can try doing a fresh install, although Im a little weary since everything else works fine.
<br/>
<br/>
Doing a version (-v) check on the arm-agb-elf I get:
<br/>
<br/>
Reading specs from /cygdrive/i/xport/DEVKIT~1/bin/../lib/gcc-lib/arm-agb-elf/3.2
<br/>
.2/specs
<br/>
Configured with: ../gcc-3.2.2/configure --prefix=/tmp/devkitadv-r5-beta-3 --targ
<br/>
et=arm-agb-elf --without-local-prefix --disable-shared --enable-multilib --disab
<br/>
le-threads --with-cpu=arm7tdmi --with-newlib --enable-interwork --disable-win32-
<br/>
registry --enable-targets=arm-elf,arm-coff,arm-aout,arm-pe --enable-languages=c,
<br/>
c++ -v
<br/>
Thread model: single
<br/>
gcc version 3.2.2 (DevKit Advance R5 Beta 3)
<br/>
<br/>
<br/>
And Im using VBA 1.7.2.
<br/>
<br/>
<br/>
The CPU time line says "13 scanlines" (hw) and "15 scanlines" (vba)
<br/>
<br/>
03000000 A __data_start
<br/>
03000000 D __dso_handle
<br/>
03000000 A __memmap_iwram_start
<br/>
03000004 d p.0
<br/>
03000008 D retraces
<br/>
0300000c D keypresses
<br/>
03000010 D want_reset
<br/>
03000014 d cur_mixbuf
<br/>
03000018 d impure_data
<br/>
030001a0 D _impure_ptr
<br/>
030001a4 A __data_end
<br/>
030001a4 A __iwram_start
<br/>
030001a4 T decode_ad
<br/>
0300028c t ima9_step_indices
<br/>
0300029c T ima_step_table
<br/>
03000350 A __iwram_end
<br/>
03000350 A __iwram_overlay_end
<br/>
03000350 A __iwram_overlay_start
<br/>
03000360 A __bss_start
<br/>
03000360 b completed.1
<br/>
03000364 b object.2
<br/>
0300037c b mixbuf
<br/>
030005e0 B ad
<br/>
03000600 B saved_isr
<br/>
03000620 B samples
<br/>
03000624 A __bss_end
<br/>
03000624 A __iwram_break
<br/>
03007ffa a __soft_reset_direct
<br/>
03007ffc a __interrupt_vector
<br/>
03008000 A __memmap_iwram_end
<br/>
<br/>
<br/>
In case it helps, this is my compiled playad.gba with no changes to the batch or source code:
<br/>
<a href="http://s4.yousendit.com/d.aspx?id=1VXWU4PF09FD425M3OPRM9H7NS" target="_blank">http://s4.yousendit.com/d.aspx?id=1VXWU4PF09FD425M3OPRM9H7NS</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43433 - tepples - Mon May 23, 2005 2:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>enliteneer wrote:</b></span></td> </tr> <tr> <td class="quote">When I tried to change the batchfile to use 'arm-elf-gcc' it couldnt find the exe.</td> </tr></table><span class="postbody">
<br/>
That's because you're using DevKit Advance R5 beta 3, which uses the "arm-agb-elf-" prefix. A lot of people have come here asking for help getting my older DevKit Advance-based apps to work in the newer devkitARM.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Im not sure why my install only had 'arm-agb-elf'?  I can try doing a fresh install, although Im a little weary since everything else works fine.</td> </tr></table><span class="postbody">
<br/>
You might try installing devkitARM to a new folder. It's possible that it might generate faster code. Use devkitARM R11 if you can find it, or make sure you apply the <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=5790" target="_blank">crt0 fix posted here</a> after you install it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">gcc version 3.2.2 (DevKit Advance R5 Beta 3)</td> </tr></table><span class="postbody">
<br/>
which is all I needed to know.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The CPU time line says "13 scanlines" (hw) and "15 scanlines" (vba)</td> </tr></table><span class="postbody">
<br/>
Expected. That's about how long it took on my setup.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">030001a4 T decode_ad
<br/>
0300028c t ima9_step_indices
<br/>
0300029c T ima_step_table</td> </tr></table><span class="postbody">
<br/>
Also expected. What needs to be in IWRAM is in IWRAM.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">In case it helps, this is my compiled playad.gba with no changes to the batch or source code:
<br/>
<a href="http://s4.yousendit.com/d.aspx?id=1VXWU4PF09FD425M3OPRM9H7NS" target="_blank">http://s4.yousendit.com/d.aspx?id=1VXWU4PF09FD425M3OPRM9H7NS</a></td> </tr></table><span class="postbody">
<br/>
I don't have time to look at it right now, but I'll try to get to it.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43530 - enliteneer - Tue May 24, 2005 5:48 am</h4>
    <div class="postbody"><span class="postbody">I took the exact .GBA file to another computer and it sounds fine!!!
<br/>
<br/>
So, I re-downloaded VBA, No$GBA, and BoycottAdvance on my computer  but all audio playback on all of them is horrible.  The sound has a high pitch squeal in the middle and is choppy throughout.
<br/>
<br/>
My computer (XP SP2, AMD 1800 1.5Ghz, 512 MB Ram)  plays back MP3 and DivX movies with *NO* problems.    What the heck could be going on here??????
<br/>
<br/>
ARGH!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43532 - tepples - Tue May 24, 2005 5:57 am</h4>
    <div class="postbody"><span class="postbody">Have you tried cranking the frameskip up to 5 or so?
<br/>
<br/>
Do other GBA games with sound play OK on your troublesome box?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46629 - MiGs - Tue Jun 28, 2005 10:28 am</h4>
    <div class="postbody"><span class="postbody">I used to get that high pitched squeel when the sample rate or frequency was off or something, or saved as a different kind of PCM, not sure, but it sounded all fast and high pitched, so double check what you saved it as.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
