<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem to have multiple sprites on screen - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > Problem to have multiple sprites on screen</h2>
<div id="posts">
<div class="post">
    <h4>#23503 - matrix960 - Wed Jul 14, 2004 10:57 am</h4>
    <div class="postbody"><span class="postbody">Hi everybody!
<br/>
<br/>
I start to code this week on ASM for GBA using that tutorial : <a href="http://k2pts.home.comcast.net/gbaguy/gbaasm.htm" target="_blank">http://k2pts.home.comcast.net/gbaguy/gbaasm.htm</a>
<br/>
<br/>
My main problem is that I can't have multiple sprites on screen. I can have 1 sprite (without those strange effect), but since I try to have 2, then 1 sprite is on screen, and disappears and the other is on screen....
<br/>
Help me!!!!
<br/>
<br/>
Here's my code :
<br/>
<br/>
@include screen.h
<br/>
@include sprites.h
<br/>
@include dma.h
<br/>
b start:                       
<br/>
@include sprit.asm   
<br/>
@include sprit1.asm
<br/>
start:                      
<br/>
<br/>
<br/>
Init_Sprites    
<br/>
<br/>
ldr r1,=REG_DISPCNT  
<br/>
ldr r2,=(MODE_0|BG2_ENABLE|OBJ_ENABLE|OBJ_MAP_1D)
<br/>
str r2,[r1]  
<br/>
<br/>
<br/>
<br/>
<br/>
loop1
<br/>
ldr r0,=OAM             
<br/>
<br/>
ldr r1,=(SQUARE|COLOR_16|10)|((SIZE_8|10)&lt;&lt;16)             
<br/>
<br/>
str r1,[r0]+4!  
<br/>
ldr r1,=0      
<br/>
str r1,[r0]
<br/>
<br/>
<br/>
ldr r1,=pallete       ; \
<br/>
ldr r2,=REG_DMA3SAD   ;  -give source address in DMA Source Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
ldr r1,=OBJPAL        ; \
<br/>
ldr r2,=REG_DMA3DAD   ;  -give destination address in DMA Destination Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
<br/>
ldr r1,=(128|DMA_32NOW) ; \
<br/>
ldr r2,=REG_DMA3CNT     ;  - tell control register amount of data to transfer and
<br/>
str r1,[r2]             ; to transfer in 32bit or 16bit chunks (we use 32bit chunks here)
<br/>
<br/>
ldr r8,=200000
<br/>
ldr r9,=0
<br/>
loop2
<br/>
subs r8,r8,1
<br/>
Bne loop2
<br/>
<br/>
ldr r1,=obj       ; \
<br/>
ldr r2,=REG_DMA3SAD   ;  -give source address in DMA Source Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
<br/>
ldr r1,=CHARMEM        ; \
<br/>
ldr r2,=REG_DMA3DAD   ;  -give destination address in DMA Destination Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
<br/>
ldr r1,=(128|DMA_32NOW) ; \
<br/>
ldr r2,=REG_DMA3CNT     ;  - tell control register amount of data to transfer and
<br/>
str r1,[r2]             ; to transfer in 32bit or 16bit chunks (we use 32bit chunks here)
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
ldr r0,=OAM  
<br/>
ldr r1,=(SQUARE|COLOR_16|100)|((SIZE_8|100)&lt;&lt;16)             
<br/>
<br/>
str r1,[r0]+4!  
<br/>
ldr r1,=0      
<br/>
str r1,[r0]
<br/>
<br/>
<br/>
ldr r1,=pallete1       ; \
<br/>
ldr r2,=REG_DMA3SAD   ;  -give source address in DMA Source Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
ldr r1,=OBJPAL        ; \
<br/>
ldr r2,=REG_DMA3DAD   ;  -give destination address in DMA Destination Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
<br/>
ldr r1,=(128|DMA_32NOW) ; \
<br/>
ldr r2,=REG_DMA3CNT     ;  - tell control register amount of data to transfer and
<br/>
str r1,[r2]             ; to transfer in 32bit or 16bit chunks (we use 32bit chunks here)
<br/>
<br/>
<br/>
ldr r8,=200000
<br/>
ldr r9,=0
<br/>
loop
<br/>
subs r8,r8,1
<br/>
Bne loop
<br/>
<br/>
ldr r1,=obj1       ; \
<br/>
ldr r2,=REG_DMA3SAD   ;  -give source address in DMA Source Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
<br/>
ldr r1,=CHARMEM        ; \
<br/>
ldr r2,=REG_DMA3DAD   ;  -give destination address in DMA Destination Address register
<br/>
str r1,[r2]           ; /
<br/>
<br/>
<br/>
ldr r1,=(128|DMA_32NOW) ; \
<br/>
ldr r2,=REG_DMA3CNT     ;  - tell control register amount of data to transfer and
<br/>
str r1,[r2]             ; to transfer in 32bit or 16bit chunks (we use 32bit chunks here)
<br/>
<br/>
<br/>
<br/>
b loop1
<br/>
<br/>
@pool
<br/>
<br/>
@endarea</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23511 - FluBBa - Wed Jul 14, 2004 2:47 pm</h4>
    <div class="postbody"><span class="postbody">You only set attributes for sprite 0 and write the 2 graphic sets to the same address in (I suppose) VRAM.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23519 - matrix960 - Wed Jul 14, 2004 4:57 pm</h4>
    <div class="postbody"><span class="postbody">At the begining, I had Sprite 0 and Sprite 1. but the result were worse.... And how do I change the address with that on mind?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23563 - FluBBa - Thu Jul 15, 2004 9:41 am</h4>
    <div class="postbody"><span class="postbody">Check out the VBA tile viewer and make sure what you see there is what you'd expect.
<br/>
Start with one sprite and make sure you can change what tile it uses and move it around before starting with another one...
<br/>
A 8x8 16color tile is 32 bytes big or 8 "longwords" (which you should use when starting the DMA and not 128 "longwords").<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
