<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems with GBAguy tutorials - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>ASM > Problems with GBAguy tutorials</h2>
<div id="posts">
<div class="post">
    <h4>#12036 - dagamer34 - Mon Oct 27, 2003 9:36 pm</h4>
    <div class="postbody"><span class="postbody">I am having some problems with the GBAguy's tutorials. I have gotten them to assemble successfully but they don't do what they are supposed to. Maybe i mistyped something (several times) or he has it just plain wrong. Using version 1.7 of the Goldroad Assembler if that matters. 
<br/>
<br/>
Here's the code:
<br/>
<br/>
@include screen.h
<br/>
@textarea
<br/>
<br/>
ldr r1, =REG_DISPCNT
<br/>
ldr r2, =(MODE_3|BG2_ENABLE)
<br/>
str r2,[r1]
<br/>
ldr r1,=0x0FF
<br/>
ldr r2,=VRAM+2410
<br/>
str r1,[r2]
<br/>
<br/>
label1
<br/>
B label1
<br/>
<br/>
@pool
<br/>
@endarea
<br/>
<br/>
Simplest program possible (i guess it could be simpler, but it needs to do something). Please find my error (if any).<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12038 - poslundc - Mon Oct 27, 2003 10:05 pm</h4>
    <div class="postbody"><span class="postbody">What happens when you try to run it, versus what the tutorial says should happen?
<br/>
<br/>
(At first glance, it looks like it should paint a single orange pixel somewhere on the screen.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12039 - dagamer34 - Mon Oct 27, 2003 10:12 pm</h4>
    <div class="postbody"><span class="postbody">Hmm... that's funny. It worked. It looks like the problem is with my emulator, VisualBoyAdvance. It seems that my "demo" only works when VBA is run from command-line. Any of you had that problem also? 
<br/>
<br/>
This really isn't a problem if it will run in hardware, though, i guess.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12042 - dagamer34 - Mon Oct 27, 2003 11:29 pm</h4>
    <div class="postbody"><span class="postbody">Cannot seem to get day 5 to work properly. I get some junk data instead of my 16 color bitmap. My code (again):
<br/>
<br/>
@include screen.h
<br/>
@include sprites.h
<br/>
b start
<br/>
@include sprit.asm
<br/>
start:
<br/>
<br/>
Init_Sprites
<br/>
<br/>
ldr r1,=REG_DISPCNT
<br/>
ldr r2,=(MODE_0|BG2_ENABLE|OBJ_ENABLE|OBJ_MAP_1D)
<br/>
str r2,[r1]
<br/>
<br/>
ldr r0,=OAM
<br/>
ldr r1,=(SQUARE|COLOR_16|10)|((SIZE_16|10)&lt;&lt;16)
<br/>
str r1,[r0]+4!
<br/>
ldr r1,=0
<br/>
str r1,[r0]
<br/>
<br/>
ldr r1,=OBJPAL
<br/>
ldr r2,=128
<br/>
ldr r3,=pallete
<br/>
<br/>
palloop:
<br/>
ldr r7,[r3]+4!
<br/>
str r7,[r1]+4!
<br/>
subs r2,r2,1
<br/>
bne palloop
<br/>
<br/>
ldr r1,=CHARMEM
<br/>
ldr r2,=128
<br/>
ldr r3,=obj
<br/>
<br/>
sprloop:
<br/>
ldr r7,[r3]+4!
<br/>
str r7,[r1]+4!
<br/>
subs r2,r2,1
<br/>
bne sprloop
<br/>
<br/>
infiniteloop
<br/>
b infiniteloop
<br/>
<br/>
Anydoy got a clue on what is wrong?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12044 - sajiimori - Mon Oct 27, 2003 11:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
ldr r0,=OAM 
<br/>
ldr r1,=(SQUARE|COLOR_16|10)|((SIZE_16|10)&lt;&lt;16) 
<br/>
str r1,[r0]+4! 
<br/>
ldr r1,=0 
<br/>
str r1,[r0]
<br/>
</td> </tr></table><span class="postbody">
<br/>
If I'm not mistaken, that will write to the second half of the first sprite and the first half of the second sprite, instead of writing both parts of the first sprite (edit: I was mistaken.  It writes to the second half of the first sprite twice.).  I think the correct code is:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
ldr r0,=OAM 
<br/>
ldr r1,=(SQUARE|COLOR_16|10)|((SIZE_16|10)&lt;&lt;16) 
<br/>
str r1,[r0] 
<br/>
ldr r1,=0 
<br/>
str r1,[r0]+4
<br/>
</td> </tr></table><span class="postbody">
<br/>
There's a similar problem with palloop and sprloop.  Because they add 4 to the source and destination right away, they skip the first 4 bytes.  Try initializing the source and destination pointers to 4 bytes before the data you want.
<br/>
<br/>
Don't shoot me if I'm wrong though...I haven't written much ARM asm.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
