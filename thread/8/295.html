<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How much faster is ASM vs. C - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > How much faster is ASM vs. C</h2>
<div id="posts">
<div class="post">
    <h4>#1840 - regularkid - Fri Jan 24, 2003 6:01 am</h4>
    <div class="postbody"><span class="postbody">I'm just starting to get into assembly for the GBA and have a quick question: How much faster is assembly vs. c code? Isn't c code just translated into ASM eventually? Why is assembly so fast? As an example, if I were putting a pixel on the screen in mode 4, how much faster would it be if I used asm over c code? Thanks!<br/>_________________<br/>- RegularKid</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1842 - XeroxBoy - Fri Jan 24, 2003 8:01 am</h4>
    <div class="postbody"><span class="postbody">I can't say <span style="font-style: italic">exactly</span> how much faster ASM is, but the reason that it's faster is because the programmer has complete and total control over what's happening. The compiler does <span style="font-style: italic">know</span> exactly what you're trying to do, and may generate extrainious code that merely slows down your code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1847 - Daniel Andersen - Fri Jan 24, 2003 11:08 am</h4>
    <div class="postbody"><span class="postbody">According to <span style="font-style: italic">Structured Computer Organization</span> by <span style="font-style: italic">Andrew S. Tanenbaum</span> coding in assembly can be as much as 3 times faster. Though, this is only when using <span style="font-style: italic">clever</span>  programming and also it takes much longer time to write assembly language (about 5x).
<br/>
<br/>
Due to the fact that 1% of your code often tend to be responsible for 50% of the execution time and 10% for 90%, the ideal thing to do is to code the 1% or 10% in assembly language and the rest in a high-level language like C.
<br/>
<br/>
Personally, I like write my code in assembly language but when writing larger projects, a game for instance, it is very inflexible as it is harder to structure; so I recommend you writing mostly in C and then for the critical innerloops (mabey) do some assembly.
<br/>
<br/>
Daniel Andersen</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1850 - velvetfr - Fri Jan 24, 2003 2:04 pm</h4>
    <div class="postbody"><span class="postbody">All,
<br/>
<br/>
I am using C and ASM ... I usually rewrite all the core functions (most called ones, and the smallest ones) in pure assembly language, and the rest in C. Just for an example, I have in my library a function to set
<br/>
a pixel in mode 3, with the prototype below:
<br/>
<br/>
  uint16* video_setpixel_mode3(uint16* frame, uint16 x, uint16 y, uint16 rgb);
<br/>
<br/>
This function has been wrote in C and assembly language. It took me 4 instructions in assembly (ARM code used), and for the C compiler
<br/>
(with -O3) it took 10 instructions in assembly (and without optimization flags, I do not even want to think about, but it took about 30 instructions).
<br/>
<br/>
So just to give you an impression, assembly+brain more performant than
<br/>
a C compiler. Also, all that his less portable of course, but at which price (having something smaller in size and faster at runtime).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1855 - Splam - Fri Jan 24, 2003 4:04 pm</h4>
    <div class="postbody"><span class="postbody">I've personally seen increases of up to 5x or 6x going from C compiled to thumb running in rom, to hand coded arm running in iwram, and that was after optimising the hell out of the C routine.  As long as you know your asm inside out and can optimise for register usage etc then it's always worth it :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1856 - joet - Fri Jan 24, 2003 4:29 pm</h4>
    <div class="postbody"><span class="postbody">And always bear in mind that it's well worth getting logic and everything working first before attempting any optimisation - otherwise you spend ages optimising in ASM only to end up using a completely different algorithm because your needs have changed ...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1857 - Splam - Fri Jan 24, 2003 4:44 pm</h4>
    <div class="postbody"><span class="postbody">I tend to write a routine in C first as it's so fast to code in, then when the logic is worked out I can see exactly how many registers are needed and the flow of the code (NOT by looking at the asm the compiler produces as it's usually dross),  then rewriting in asm is a lot faster because you don't get half way through and run out of registers ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1861 - regularkid - Fri Jan 24, 2003 6:36 pm</h4>
    <div class="postbody"><span class="postbody">Cool! Thanks, that helps. I just wanted to make sure that converting my rendering code from C to ASM would be worth it. It sounds like it would be. Thanks!<br/>_________________<br/>- RegularKid</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1994 - chrisbtoo - Mon Jan 27, 2003 1:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>regularkid wrote:</b></span></td> </tr> <tr> <td class="quote">I just wanted to make sure that converting my rendering code from C to ASM would be worth it. </td> </tr></table><span class="postbody">
<br/>
<br/>
A good place to start might be to get the compiler to dump out the assembler "source" for your rendering code. If you're using gcc, pass the -S to the compiler (remembering to add in optimisation flags too (-O2, for example).
<br/>
<br/>
That way you can get a reasonable handle on the job that the compiler is making of your code, and you can use it to pinpoint the areas where you need to focus your attention.
<br/>
<br/>
Remember: simply recoding in assembler isn't a guarantee that your code will go faster. You actually have to make a better job of it than the compiler :-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1996 - Sweex - Mon Jan 27, 2003 1:57 pm</h4>
    <div class="postbody"><span class="postbody">IMHO you can "help" the compiler compiling your functions into fast assembly code. The use of bitshifting for instance, could save you a multiplication in some cases. If you're programming cleverly in C/C++ you can help the compiler a hand. Still, it won't beat the "assembly+brain" performance as velvetfr so nicely put it!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4513 - delbogun - Wed Apr 02, 2003 10:37 am</h4>
    <div class="postbody"><span class="postbody">is there a general rule on what parts is better to use assembly than c?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4517 - Lord Graga - Wed Apr 02, 2003 11:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>delbogun wrote:</b></span></td> </tr> <tr> <td class="quote">is there a general rule on what parts is better to use assembly than c?</td> </tr></table><span class="postbody">
<br/>
<br/>
Usualy, it doesn't matter in 2D games like RPG's, platformers, etc, etc.
<br/>
Where it REALLY matters is when playing music, rendering 3d and making tiny stuff to fit in little space (1K compo's, lame intro's, etc.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4783 - MrMr[iCE] - Wed Apr 09, 2003 4:23 pm</h4>
    <div class="postbody"><span class="postbody">Sometimes you dont even need to convert to asm. If you're not good with asm, letting the C compiler generate ARM code and stuffing that code into IWRAM is a huge improvement. If thats not enough, then going to asm, coupled with iwram, will be a very fast solution.  Also keep in mind lookup tables that are accessed a lot will speed up code a bit if they are stored in IWRAM.<br/>_________________<br/>Does the corpse have a familiar face?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
