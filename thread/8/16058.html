<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ldr/str ineffective on certain alignments? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > ldr/str ineffective on certain alignments?</h2>
<div id="posts">
<div class="post">
    <h4>#162987 - strat - Wed Sep 17, 2008 9:47 pm</h4>
    <div class="postbody"><span class="postbody">I thought this
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   ldrb   r2, [r5]
<br/>
   strb   r2, [r3]
<br/>
   ldrb   r2, [r5,#1]
<br/>
   strb   r2, [r3,#1]
<br/>
   ldrb   r2, [r5,#2]
<br/>
   strb   r2, [r3,#2]
<br/>
   ldrb   r2, [r5,#3]
<br/>
   strb   r2, [r3,#3]</td> </tr></table><span class="postbody">
<br/>
<br/>
was equivalent to 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   ldr      r2, [r5]
<br/>
   str      r2, [r3]
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
But while the first behaves as expected, the latter only seems to work when the data pointer (r5) is pointing to every fourth byte in the array.  Can the word copy work at any alignment, or do I have to check the alignment then jump to either word, half-word, or byte copies?
<br/>
<br/>
p.s. this is copying from ROM data to a local array.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162989 - Cearn - Wed Sep 17, 2008 10:06 pm</h4>
    <div class="postbody"><span class="postbody">Halfword and word loads and stores need to be aligned to their respective boundaries to work properly. If they aren't, things can get a little funky.
<br/>
<br/>
Details can be found at <a class="postlink" href="http://www.arm.com/support/faqip/3661.html" target="_blank">http://www.arm.com/support/faqip/3661.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163004 - tepples - Thu Sep 18, 2008 1:11 pm</h4>
    <div class="postbody"><span class="postbody">In fact, I can't think of any modern architectures other than x86 that support unaligned accesses.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163025 - elwing - Fri Sep 19, 2008 7:28 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">In fact, I can't think of any modern architectures other than x86 that support unaligned accesses.</td> </tr></table><span class="postbody">
<br/>
<br/>
damn, that's only used 80% of the actual software :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163031 - Miked0801 - Fri Sep 19, 2008 3:58 pm</h4>
    <div class="postbody"><span class="postbody">Bah, not where I code!  Oh wait...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163066 - tepples - Sun Sep 21, 2008 12:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elwing wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">In fact, I can't think of any modern architectures other than x86 that support unaligned accesses.</td> </tr></table><span class="postbody">
<br/>
damn, that's only used 80% of the actual software :)</span></td> </tr></table><span class="postbody">
<br/>
You appear to be ignoring a lot of computers that you don't immediately think of as computers. As I understand it, the vast majority of 32-bit microcontrollers, set-top boxes, PDAs, phones, and the like use PowerPC (like <span style="font-style: italic">all three</span> consoles this gen), MIPS, ARM, or some TI DSP. I've read of only one game console (original Xbox) and one handheld (Wonderswan) that use an x86 CPU.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163077 - silent_code - Sun Sep 21, 2008 10:06 pm</h4>
    <div class="postbody"><span class="postbody">OFFTOPIC:
<br/>
<br/>
Isn't the biggest CPU market segment ("we're de reel mony'z at") actually in 8bit microcontrollers? (Maybe not, but then, 8bit ?Cs are still quite common, even though the trend goes in favour of 16bit, from what I understand [which, I know, is just a lousy "bit" {get the "joke"?} compared to people, who actually work with that stuff].) Didn't the industry make the "big leap" from 4bit to 8bit on a large scale "just recently"?
<br/>
I'm not sure, but that's what someone told me ... "recently". (Yeah, you got me. I don't remeber when it was. Kind of between one or ... maybe up to three / four years ago? ... Oh, now I'm sorry...)
<br/>
Wikipedia seems to agree witht that to a certain extend. (... I hope...)
<br/>
You know, these things are, like, for fridges, toasters and toys and ... other stuff that desperately needs to be "intelligent" to do your work for you, and I don't mean that in a negative way... at least not all of it.
<br/>
<br/>
("Don't ferget 'em 'Nentendoos' or whut ever they call 'em!")
<br/>
<br/>
OK guys, I couldn't withstand! This is awesome: <a class="postlink" href="http://www.cpu-museum.com/14500B_e.htm" target="_blank">http://www.cpu-museum.com/14500B_e.htm</a>
<br/>
It's like "the Bit Unleashed" ...
<br/>
<br/>
(I hope you don't hate me now for making that reference, please?)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"><br/><br/>Last edited by silent_code on Mon Sep 22, 2008 8:57 pm; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#163083 - keldon - Mon Sep 22, 2008 12:20 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">OFFTOPIC:
<br/>
<br/>
Isn't the biggest CPU marked segment ("we're de reel mony'z at") actually in 8bit microcontrollers? (Maybe not, but then, 8bit ?Cs are still quite common, even though the trend goes in favour of 16bit, from what I understand [which, I know, is just a lousy "bit" {get the "joke"?} compared to people, who actually work with that stuff].) Didn't the industry make the "big leap" from 4bit to 8bit on a large scale "just recently"?
<br/>
I'm not sure, but that's what someone told me ... "recently". (Yeah, you got me. I don't remeber when it was. Kind of between one or ... maybe up to three / four years ago? ... Oh, now I'm sorry...)
<br/>
Wikipedia seems to agree witht that to a certain extend. (... I hope...)
<br/>
You know, these things are like for fridges, toasters and toys and ... other stuff that desperately needs to be "intelligent" to do you work for you, and I don't mean that in a negative way... at least not all of it.
<br/>
<br/>
("Don't ferget 'em 'Nentendoos' or whut ever they call 'em!")
<br/>
<br/>
OK guys, I couldn't withstand! This is awesome: <a class="postlink" href="http://www.cpu-museum.com/14500B_e.htm" target="_blank">http://www.cpu-museum.com/14500B_e.htm</a>
<br/>
It's like "the Bit Unleashed" ...
<br/>
<br/>
(I hope you don't hate me now for making that reference, please?)</td> </tr></table><span class="postbody">
<br/>
<br/>
I've tried putting this post through google translator, but to no avail &lt;_&lt;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163084 - silent_code - Mon Sep 22, 2008 1:05 am</h4>
    <div class="postbody"><span class="postbody">OFF-OFFTOPIC:
<br/>
<br/>
Elaboratory, please? Me not understand?
<br/>
No, really, what was the question, keldon? (Imagine this said rather jokingly, not in a strict tone, as I really want to know that and I care about your comment, because I'd like to improve my posting - see? I did it again! Loooong annotation. Damn! - Or maybe it's just my broken sense of humor, but who knows? [Really, I'd appreciate some sort of elaboration... as you clearly see, that I'm in need of help. {Joking... again! :^p }])
<br/>
<br/>
I've fixed a few typos and I've also "enhanced" the "flow" of a few parts, if that's what you meant. That won't "enhance" the "sense" of the post, though. But right now, I'm pretty much confident that there is <span style="font-style: italic">some</span> sense in that piece of text. Right? (Still in a pretty relaxed mood... after all, I'm going to bed now. I'm writing this to make sure people don't get this wrong.)
<br/>
<br/>
Please, don't tell me, that you were just jonking. I take this <span style="font-style: italic">serial</span>! ;^p No, really, I do (take this serious).
<br/>
<br/>
I mean, why would you put that through a translator? I didn't think my English was <span style="font-style: italic">that</span> bad... :^(
<br/>
And what kind of translation would you use for that? Non-sense (it makes pretty much sense to me, but I do know, that to others it does rather rarely) to English, English to Non-sense? ;^D<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"><br/><br/>Last edited by silent_code on Mon Sep 22, 2008 8:58 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#163086 - DensitY - Mon Sep 22, 2008 5:34 am</h4>
    <div class="postbody"><span class="postbody">you been in the diesel again slient_code? ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163090 - silent_code - Mon Sep 22, 2008 11:01 am</h4>
    <div class="postbody"><span class="postbody">OFF-OFF-OFFTOPIC:
<br/>
<br/>
Whoot? 8^o
<br/>
(If "being in the diesel" means drunk, I have to disappoint you, I do not drink [alcohol or "do stuff"].) ;^D<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163093 - pepsiman - Mon Sep 22, 2008 11:20 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">(If "being in the diesel" means drunk, I have to disappoint you, I do not drink [alcohol or "do stuff"].) ;^D</td> </tr></table><span class="postbody">
<br/>
You're writing this gibberish sober?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163099 - keldon - Mon Sep 22, 2008 3:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pepsiman wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">(If "being in the diesel" means drunk, I have to disappoint you, I do not drink [alcohol or "do stuff"].) ;^D</td> </tr></table><span class="postbody">
<br/>
You're writing this gibberish sober?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, I've ruled out alcohol, benzo's, cannabis and other depressant drugs based on the [relatively] consistent flow and spelling. Giving up on a translation I sent a transcript to my mate who works with the national health service, in the mental health department ... he says,  "it's nothing out of the ordinary" ^_^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163113 - silent_code - Mon Sep 22, 2008 8:49 pm</h4>
    <div class="postbody"><span class="postbody">@strat: I am sorry this went a little out-of-hand and my post caused your thread to be polluted with offtopic matters so much.
<br/>
<br/>
<br/>
Well, I am autistic, if that helps. And I am not a native speaker, as you could probably tell from the location I set in my profile (which should be visible to everyone - right there, on the left hand side of this and any of my posts).
<br/>
I also do try to not write like a robot (which I have a tendency to do - that also applies to spoken language), but rather like "people talk". I may overdo it sometimes and I'm not very good at "writing like people". Well, at least I want to improve that "skill". :^)
<br/>
<br/>
Then there's also that "strange kind of humor" of mine... yeah. I'm just fooling around sometimes, so: whatever. Most of the time it's not even intended to be funny for anyone but me (and those who get it and find it funny, too).
<br/>
<br/>
The question remains: What's wrong with the way I write? PMs with serious suggestions for improvement are very welcome.
<br/>
<br/>
@pepsiman: "Gibberish?" I do feel a little bit offended. By most forum standards that is not gibberish at all. Please try to be a little bit more constructive. And btw: I am always sober. Always. (Always, always! Although sometimes, I am a little bit sleepy and then the typo count and silliness increases. ;^p )
<br/>
<br/>
@keldon: I still don't get the translation part and why would you send that to anyone off the UK's National Health Service, even if it's just a friend? I think that's a bit over the top, given that I still don't know what's supposed to be "wrong".
<br/>
Or is this a joke of some sort, that I don't get?<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163118 - keldon - Tue Sep 23, 2008 1:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">@keldon: I still don't get the translation part and why would you send that to anyone off the UK's National Health Service, even if it's just a friend? I think that's a bit over the top, given that I still don't know what's supposed to be "wrong".
<br/>
Or is this a joke of some sort, that I don't get?</td> </tr></table><span class="postbody">
<br/>
Nothing wrong with how you write; in fact I never even noticed the whole Germany/Berlin thing until you mentioned. I found your post slightly amusing and I guess everyone got the same feeling there was jest involved; so I was just joking myself ^_^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163124 - elwing - Tue Sep 23, 2008 7:55 am</h4>
    <div class="postbody"><span class="postbody">that's why I edited my comments... I was first speaking of processor, but that would have been damn wrong, but try comparing the number of program you will find for x86 vs other architecture... that is frightening... on most other architecture processor you just have 1firmware and that's all... most actual codding is either portable to many architecture or x86 only, if you except previously mentioned device firmware...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163127 - pepsiman - Tue Sep 23, 2008 12:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">@pepsiman: "Gibberish?" I do feel a little bit offended.</td> </tr></table><span class="postbody">
<br/>
Sorry.
<br/>
<br/>
I find it hard to follow what you're saying when you're nesting your asides 3 levels deep.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
