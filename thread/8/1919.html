<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>variables in GAS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > variables in GAS</h2>
<div id="posts">
<div class="post">
    <h4>#9821 - Omega81 - Tue Aug 19, 2003 2:01 am</h4>
    <div class="postbody"><span class="postbody">Hello I was wondering if anyone knew how to create variables in GAS. From the -S output I can see that GCC create two label; one for storing the varible names and another for storing there size. Then in the code, the varibles are writen and read from as array element. Here is a code strip
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
ldr   r2, .L2
<br/>
   .....
<br/>
   ldr   r2, .L2+4
<br/>
   mov   r3, #55
<br/>
   str   r3, [r2, #0]
<br/>
   ldr   r2, .L2+8
<br/>
   mov   r3, #33792
<br/>
   add   r3, r3, #147
<br/>
   str   r3, [r2, #0]
<br/>
   ldr   r4, .L2+8
<br/>
   ldr   r0, .L2+8
<br/>
   ldr   r3, .L2
<br/>
   ldr   r2, .L2+4
<br/>
        ......
<br/>
   ldr   r3, .L2
<br/>
   ldr   r3, [r3, #0]
<br/>
   mov   r0, r3
<br/>
        ....
<br/>
.L3:
<br/>
   .align   2
<br/>
.L2:
<br/>
   .word   frn
<br/>
   .word   sun
<br/>
   .word   too
<br/>
.Lfe1:
<br/>
   .size   main,.Lfe1-main
<br/>
   .comm   frn, 4, 32
<br/>
   .comm   sun, 4, 32
<br/>
   .comm   too, 4, 32
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
is this how I will have to create variables cause I was hoping I could ust use the variable name directly just have them defined in a .data section or something.
<br/>
<br/>
Any throughs?<br/>_________________<br/>Keep it real, keep it Free, Keep it GNU</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9830 - NEiM0D - Tue Aug 19, 2003 1:42 pm</h4>
    <div class="postbody"><span class="postbody">This is how to preserve a space in a section (naturally ram) for variables:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">variable1:              .space 4
<br/>
variable2:              .space 2
<br/>
variable3:              .space 1
<br/>
variable4:              .space 700</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
To initialise some variables, you will have to define the section (rom or ram) and then:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">variable5:          .long 0x12345678
<br/>
variable6:          .byte 4,242,43
<br/>
variable7:          .hword 65530</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
ps: dont forget to align where needed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9831 - Omega81 - Tue Aug 19, 2003 2:30 pm</h4>
    <div class="postbody"><span class="postbody">Sorry if this is a stupid question but how do I define the location(Ram or Rom) were I want to put the variable?  the code below......
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> 
<br/>
variable1:              .space 4 
<br/>
 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
isn't it the same as
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
variable1:           .comm 7, 32
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
where 32 is the alignment (32it).<br/>_________________<br/>Keep it real, keep it Free, Keep it GNU</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9856 - sajiimori - Wed Aug 20, 2003 7:00 am</h4>
    <div class="postbody"><span class="postbody">You can specify where to put things by putting a .section directive above them.  The actual locations of the sections depend on your link script, but .text is usually rom, and .data and .bss are usually in iwram.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
.section .text
<br/>
<br/>
variable_in_rom: .word 0x1234
<br/>
<br/>
.section .data
<br/>
<br/>
variable_in_ram: .word 0xABCD
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I think you might actually be able to just type .text instead of .section .text, but I don't remember.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
