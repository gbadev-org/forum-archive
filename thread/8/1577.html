<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Can't get output to VBA console - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>ASM > Can't get output to VBA console</h2>
<div id="posts">
<div class="post">
    <h4>#8056 - TurboHz - Tue Jul 01, 2003 12:01 pm</h4>
    <div class="postbody"><span class="postbody">I cant get the output to console feature in VBA to work in ASM.
<br/>
<br/>
How do you guys do that?
<br/>
<br/>
In VBA homepage there's this code:
<br/>
<br/>
@ log a message to VBA's output console or GDB console
<br/>
@ r0=message to log                
<br/>
vbalog:
<br/>
        swi 0xff
<br/>
        bx lr
<br/>
<br/>
I load r0 with the adress of the text to be displayed and make the swi but nothing happens... I guess a text should appear in red such as that when you reset. Isn't it?
<br/>
<br/>
How should the string be terminated? with 0x13?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8065 - torne - Tue Jul 01, 2003 3:29 pm</h4>
    <div class="postbody"><span class="postbody">You have to be using the VBA debugger from the SDL version to see console output. 
<br/>
<br/>
Torne</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8248 - tom - Sat Jul 05, 2003 10:56 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I load r0 with the adress of the text to be displayed and make the swi but nothing happens... I guess a text should appear in red such as that when you reset. Isn't it? 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
no, the logmessages don't appear on the display window, they appear in the log window. if you're using the win32 version of vba, go to the "tools" menu and select "logging...".
<br/>
<br/>
then click onto the main window, so that the emulator runs again. now you should see your logmessages. btw, there's also another way to output log messages, which has the advantage that it doesn't crash the real gba:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
@ r2 = pointer to asciiz string
<br/>
ldr r0,=0xc0ded00d
<br/>
mov r1,#0
<br/>
and r0,r0
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
(thumb code)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
How should the string be terminated? with 0x13?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
no, with 0</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
