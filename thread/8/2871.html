<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ASM Return values.... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > ASM Return values....</h2>
<div id="posts">
<div class="post">
    <h4>#16436 - corranga - Mon Feb 16, 2004 2:05 pm</h4>
    <div class="postbody"><span class="postbody">Ok, i've written some asm to do fixed point division, but whgen I got to the last line, I thought hang on, how does the asm retuurn a value?
<br/>
<br/>
The code is as follows:
<br/>
<br/>
fixedDivASM:
<br/>
	mov r3, r1
<br/>
	swi		0x60000
<br/>
	@answer is in r0
<br/>
	mov r12, r0, lsl #12
<br/>
	@remainder is in r1
<br/>
	mov r0, r1
<br/>
	mov r1, r3, lsl #12
<br/>
	swi		0x60000
<br/>
	orr r0, r1, r12
<br/>
<br/>
Providing the code works properly (I thnik it should) I end up with the answer in r0.  How do I either:
<br/>
Return r0
<br/>
OR
<br/>
Return the answer in another way?
<br/>
<br/>
Chris<br/>_________________<br/>If virtual reality is ever on a par with reality, I want to be Bomberman! :D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16437 - corranga - Mon Feb 16, 2004 3:03 pm</h4>
    <div class="postbody"><span class="postbody">umm, yeah I think i've solved it myself using
<br/>
<br/>
bx    lr
<br/>
<br/>
now all I need is some form of font engine that can print out variables so I can check my answers :D
<br/>
<br/>
Chris<br/>_________________<br/>If virtual reality is ever on a par with reality, I want to be Bomberman! :D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16438 - DekuTree64 - Mon Feb 16, 2004 4:03 pm</h4>
    <div class="postbody"><span class="postbody">An easier way to check things than setting up a font engine is to set a specific place in memory to your answer and then check it in VBA's memory viewer. Can't use it on hardware, but it works great for debugging in VBA. I ususally just use somewhere out in the middle of EWRAM, like 0x2020000 that probably won't be getting used anyway.
<br/>
<br/>
And yes, just put your return value in r0 and bx lr to return in ASM.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16818 - Lupin - Wed Feb 25, 2004 3:32 pm</h4>
    <div class="postbody"><span class="postbody">you can also use the VBA console... but writing a font engine isn't that hard :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
