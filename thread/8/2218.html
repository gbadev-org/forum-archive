<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dealing with structures - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>ASM > Dealing with structures</h2>
<div id="posts">
<div class="post">
    <h4>#11573 - poslundc - Sat Oct 11, 2003 4:25 pm</h4>
    <div class="postbody"><span class="postbody">I'm writing some code that gets passed a pointer to a struct from a C function.
<br/>
<br/>
I can easily index the necessary amount into memory to get the field I'm looking for, but I'm apprehensive about doing so in case the struct gets modified in the future.
<br/>
<br/>
Is there a simple strategy for dealing with C structs in ASM?
<br/>
<br/>
Thanks,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11574 - tepples - Sat Oct 11, 2003 4:45 pm</h4>
    <div class="postbody"><span class="postbody">The simple strategy I'd use is write your code in C, reserve some space in your structs for future expansion, and don't refactor the assembly language until your algorithms and data structures are well settled. This approach has seemed to work for developers of operating systems, who have had to maintain application binary interface (ABI) compatibility for years at a time.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11575 - poslundc - Sat Oct 11, 2003 4:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">The simple strategy I'd use is write your code in C, reserve some space in your structs for future expansion, and don't refactor the assembly language until your algorithms and data structures are well settled. This approach has seemed to work for developers of operating systems, who have had to maintain application binary interface (ABI) compatibility for years at a time.</td> </tr></table><span class="postbody">
<br/>
<br/>
OK, but how do you deal with poor planning on the kind of level I force onto myself, where I often end up reshuffling and deleting my structure members? ;)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11576 - sajiimori - Sat Oct 11, 2003 5:36 pm</h4>
    <div class="postbody"><span class="postbody">I can't think of any way around the synchronization chores you'll have to do between the C and asm code, but one way to make it easier on yourself would be to define a constant for each element of the struct, the value of which is the offset into the struct.
<br/>
<br/>
Then you'd only have to change the constants when you reorganize your struct, as long as your asm code doesn't make any implicit assumptions about the relative locations of the entries.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11583 - poslundc - Sat Oct 11, 2003 7:24 pm</h4>
    <div class="postbody"><span class="postbody">During my crazy searches I managed to find a great FAQ on this exact subject, which suggests some methods for automating most (albeit not quite all) of struct management in ASM, which I hope others will find useful as well:
<br/>
<br/>
<a class="postlink" href="http://www.ifi.uio.no/~inf3150/tfaq2.html" target="_blank">http://www.ifi.uio.no/~inf3150/tfaq2.html</a>
<br/>
<br/>
(It's the last question on the page.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
