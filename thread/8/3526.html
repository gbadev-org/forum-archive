<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>loop problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>ASM > loop problem</h2>
<div id="posts">
<div class="post">
    <h4>#21809 - realV - Sun Jun 06, 2004 6:57 pm</h4>
    <div class="postbody"><span class="postbody">Please help me , i programmed my GBA in goldroad but now i will programm it in GAS but i got a problem.
<br/>
<br/>
ldr r3,=100
<br/>
<br/>
.loop:
<br/>
         @some code
<br/>
         subs r3,r3,#1
<br/>
bne .loop
<br/>
<br/>
i compile this code
<br/>
<br/>
./arm-as code.s -o code.gba
<br/>
<br/>
The loop dosn't work. But why ? Please help me someone.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21818 - Lord Graga - Sun Jun 06, 2004 9:16 pm</h4>
    <div class="postbody"><span class="postbody">one problem could be that the code is misalligned with itself! it might be compiled with another base than the one that it's actually meant for by you. This might be a question about fixing the header.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21823 - DekuTree64 - Sun Jun 06, 2004 10:47 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, that code itself is perfectly fine, so the problem must be elsewhere. If compiling your source file directly into a .bin like that works when you use a .c file, it should work with a .s too. I've always compiled things into .o files and linked them seperately, so I'm not sure if that woud work. 
<br/>
Can I see your whole AgbMain function? It could be an alignment problem, which would be fixable by putting an .align before your function label, but whatever it is, more code would help.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21831 - Lupin - Mon Jun 07, 2004 8:14 am</h4>
    <div class="postbody"><span class="postbody">how do you know that the loop doesn't work, it doesn't do anything =)<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21836 - realV - Mon Jun 07, 2004 1:16 pm</h4>
    <div class="postbody"><span class="postbody">I found the problem.
<br/>
<br/>
arm-as main.s -o main.elf 
<br/>
<br/>
and
<br/>
<br/>
arm-ld main.elf -o main.gba
<br/>
<br/>
and ok the code works.
<br/>
<br/>
Thx for help :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21850 - sajiimori - Mon Jun 07, 2004 7:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
arm-as main.s -o main.elf
<br/>
</td> </tr></table><span class="postbody">
<br/>
Here you are creating an .o file with a funny name, not an ELF file.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
arm-ld main.elf -o main.gba 
<br/>
</td> </tr></table><span class="postbody">
<br/>
Here you are creating an ELF file with a funny name, not a raw binary.  It will only work on an emulator.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21851 - realV - Mon Jun 07, 2004 9:57 pm</h4>
    <div class="postbody"><span class="postbody">Thats right i start this progrs only on a emu.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21852 - sajiimori - Mon Jun 07, 2004 11:10 pm</h4>
    <div class="postbody"><span class="postbody">You may have missed my point.  The reason you had a problem originally is because you didn't know what kinds of files you were creating.
<br/>
<br/>
The assembler creates object files (normally given the extension .o), and the linker (by default) produces ELF files (normally given the extension .elf).  You gave your object file the extension .elf and your ELF file the extension .gba.
<br/>
<br/>
It still works, but it also makes the source of the problem apparent.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
