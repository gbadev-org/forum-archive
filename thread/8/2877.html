<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>MAP directive equivalent in GCC? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > MAP directive equivalent in GCC?</h2>
<div id="posts">
<div class="post">
    <h4>#16468 - Chong Li - Tue Feb 17, 2004 2:41 pm</h4>
    <div class="postbody"><span class="postbody">Hello.
<br/>
<br/>
I am attempting to port loopy and FluBBa's wonderful PocketNES over to GCC/AS.  With the help of regular expression find/replace, I've been able to convert a large number of SDT directives to ones understandable by AS.  The one that contiunes to elude me is the MAP directive.
<br/>
<br/>
A snippet of code from PocketNES99Src/equates.h:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> MAP 0,nes_zpage
<br/>
nes_ram # 0x800
<br/>
nes_sram # 0x2000
<br/>
chr_decode # 0x400
<br/>
oam_buffer1 # 0x200
<br/>
oam_buffer2 # 0x200
<br/>
oam_buffer3 # 0x200
<br/>
yscale_extra # 0x50   @(240-160) extra 80 is for scrolling unscaled sprites
<br/>
yscale_lookup # 0x100   @sprite Y LUT
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
*Note:  nes_zpage is an alias for r11, specified earlier in the file.
<br/>
<br/>
How do I create these symbols to point to offsets of the register nes_zpage? Or does AS have a directive equivalent to MAP that I am not aware of?
<br/>
<br/>
Thanks,
<br/>
Chong Li</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16471 - torne - Tue Feb 17, 2004 4:53 pm</h4>
    <div class="postbody"><span class="postbody">I don't know exactly what MAP does, but from the example code posted it looks awfully like .struct. Read the docs for that? If not, then sorry.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16474 - poslundc - Tue Feb 17, 2004 5:25 pm</h4>
    <div class="postbody"><span class="postbody">I am unaware of a GAS equivalent to that particular directive (.struct is the closest I know of), but there is a GAS ARM reference available from <a class="postlink" href="http://re-eject.gbadev.org/" target="_blank">http://re-eject.gbadev.org/</a> that might help you find something, or at least help eliminate the possiblity that something exists if you can't find what you're looking for.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16477 - torne - Tue Feb 17, 2004 5:52 pm</h4>
    <div class="postbody"><span class="postbody">'info as' is better information. =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16485 - poslundc - Tue Feb 17, 2004 8:40 pm</h4>
    <div class="postbody"><span class="postbody">Really? For me it just brings up a 141-line man page that lists a bunch of command-line switches. :)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16496 - torne - Tue Feb 17, 2004 11:28 pm</h4>
    <div class="postbody"><span class="postbody">poslundc: then you don't have the info docs for binutils installed. Binutils has seriously detailed and extensive info (like most GNU apps)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16499 - Paul Shirley - Wed Feb 18, 2004 12:48 am</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:12 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#16572 - Chong Li - Thu Feb 19, 2004 9:54 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the input guys.  It seems the MAP directive just creates a bunch of symbols pointing to memory starting at the address you give it and incrementing after each symbol you pass it. So I just added up all the increments to get some absolute offsets (isn't that an oxymoron).<br/>_________________<br/>Chong Li</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
