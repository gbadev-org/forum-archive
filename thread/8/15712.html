<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Read user SP from inside an IRQ? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>ASM > Read user SP from inside an IRQ?</h2>
<div id="posts">
<div class="post">
    <h4>#158969 - Dwedit - Mon Jun 23, 2008 3:35 pm</h4>
    <div class="postbody"><span class="postbody">How do I read the user mode stack pointer from within an interrupt handler?
<br/>
<br/>
Edit: I see that libgba's IRQ handler switches to System mode before jumping to an IRQ handler, do I just switch to system mode to read SP?
<br/>
<br/>
Edit: looks like the question was moot because I was in system mode anyway... oh well.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159007 - eKid - Tue Jun 24, 2008 6:52 am</h4>
    <div class="postbody"><span class="postbody">Yeah you just have to change the mode with the CPSR (low 5 bits)
<br/>
<a href="http://nocash.emubase.de/gbatek.htm#cpuflags" target="_blank">http://nocash.emubase.de/gbatek.htm#cpuflags</a>
<br/>
Then the SP (and some other regs too) magically change to the registers of the new mode.
<br/>
<a href="http://nocash.emubase.de/gbatek.htm#cpuregisterset" target="_blank">http://nocash.emubase.de/gbatek.htm#cpuregisterset</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
