<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Best sprite utility? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > Best sprite utility?</h2>
<div id="posts">
<div class="post">
    <h4>#49627 - aRsus - Mon Aug 01, 2005 12:41 am</h4>
    <div class="postbody"><span class="postbody">I'd like to know what tool is best for converting images to sprites for devkitarm as i know devkitarm is a little stingy with some formats.
<br/>
             -Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49628 - wintermute - Mon Aug 01, 2005 1:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>aRsus wrote:</b></span></td> </tr> <tr> <td class="quote">I'd like to know what tool is best for converting images to sprites for devkitarm as i know devkitarm is a little stingy with some formats.
<br/>
             -Thanks.</td> </tr></table><span class="postbody">
<br/>
<br/>
stingy in what way?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49682 - aRsus - Mon Aug 01, 2005 6:21 pm</h4>
    <div class="postbody"><span class="postbody">That is to say, it doesn't accept some formats.  It can't interpret C arrays and doesn't recognize RAW files outputted by some sprite utilities and the like.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49700 - wintermute - Mon Aug 01, 2005 8:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>aRsus wrote:</b></span></td> </tr> <tr> <td class="quote">That is to say, it doesn't accept some formats.  It can't interpret C arrays and doesn't recognize RAW files outputted by some sprite utilities and the like.</td> </tr></table><span class="postbody">
<br/>
<br/>
You've been badly misinformed somewhere.
<br/>
<br/>
1. Compilers don't interpret things, that's why they're called compilers, not interpreters.
<br/>
<br/>
2. Any C compiler, including the one included in devkitARM, can handle C arrays just fine.
<br/>
<br/>
3. RAW files are a simple binary format  and as such are not recognised by any toolchain.
<br/>
<br/>
4. Several of the examples in the devkitPro cvs exhibit various ways of including binary data within projects.
<br/>
<br/>
<a href="http://devkitpro.sourceforge.net/setup.shtml" target="_blank">http://devkitpro.sourceforge.net/setup.shtml</a>
<br/>
<br/>
<a href="http://www.double.co.nz/nintendo_ds/index.html" target="_blank">http://www.double.co.nz/nintendo_ds/index.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49727 - aRsus - Tue Aug 02, 2005 1:51 am</h4>
    <div class="postbody"><span class="postbody">OK... then how come devkitarm always responds with "junk at end of line, first unrecognized character valued..." when assembling with certain formats?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49728 - wintermute - Tue Aug 02, 2005 2:06 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>aRsus wrote:</b></span></td> </tr> <tr> <td class="quote">OK... then how come devkitarm always responds with "junk at end of line, first unrecognized character valued..." when assembling with certain formats?</td> </tr></table><span class="postbody">
<br/>
<br/>
what formats?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49810 - aRsus - Tue Aug 02, 2005 7:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">what formats?</td> </tr></table><span class="postbody">
<br/>
<br/>
Haven't I made it clear?  RAW files for one and C arrays.  Of course arrays aren't a format but a bunch don't work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49811 - wintermute - Tue Aug 02, 2005 7:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>aRsus wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">what formats?</td> </tr></table><span class="postbody">
<br/>
<br/>
Haven't I made it clear?  RAW files for one and C arrays.  Of course arrays aren't a format but a bunch don't work.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
You haven't made it even slightly clear.
<br/>
<br/>
Obviously you're doing something very, very wrong.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49817 - aRsus - Tue Aug 02, 2005 8:07 pm</h4>
    <div class="postbody"><span class="postbody">Don't you get it?  Devkitarm won't compile w/o errors if there's a file that has data that reads 0x... and so forth that many utiilities output because they output it in a C array but Devkitarm can't read those.  Clear yet?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49823 - poslundc - Tue Aug 02, 2005 8:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>aRsus wrote:</b></span></td> </tr> <tr> <td class="quote">Don't you get it?  Devkitarm won't compile w/o errors if there's a file that has data that reads 0x... and so forth that many utiilities output because they output it in a C array but Devkitarm can't read those.  Clear yet?</td> </tr></table><span class="postbody">
<br/>
<br/>
...
<br/>
<br/>
*attempting to be helpful* What command-line utility are you using, and on what type of data file, and what error message are you getting?
<br/>
<br/>
Dan.
<br/>
<br/>
(P.S. FYI, DevkitARM "reads" C arrays just fine, but you need to process the C arrays with the C compiler, and link them in using the linker.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49829 - aRsus - Tue Aug 02, 2005 9:07 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">poslundc wrote:</span></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">P.S. FYI, DevkitARM "reads" C arrays just fine, but you need to process the C arrays with the C compiler, and link them in using the linker</td> </tr></table><span class="postbody">
<br/>
<br/>
Darn it!  Sorry for being so stupid.  Could you tell me how to link using the C compiler?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49832 - tepples - Tue Aug 02, 2005 9:13 pm</h4>
    <div class="postbody"><span class="postbody">compile:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gcc -mthumb -mthumb-interwork -c   data.c</td> </tr></table><span class="postbody">
<br/>
The -c switch means to compile a C file into an object code file without doing any linking.
<br/>
<br/>
link:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gcc -mthumb -mthumb-interwork -specs=gba.specs   game.o data.o   -o data.elf</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49837 - poslundc - Tue Aug 02, 2005 10:08 pm</h4>
    <div class="postbody"><span class="postbody">And if that doesn't get it working for you... <span style="font-style: italic">post what you entered as well as any error messages you got</span>.
<br/>
<br/>
Saying the devkit can't handle it is unlikely to be helpful in locating an error that is almost certainly at your end, and not the fault of the devkit.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49863 - aRsus - Wed Aug 03, 2005 1:37 am</h4>
    <div class="postbody"><span class="postbody">Alright, after compiling with the compiler and then linking, I get the following errors while assembling.  Spr.o is the converted C file.
<br/>
<br/>
Here's what I typed.  
<br/>
<br/>
arm-elf-gcc -mthumb -mthumb-interwork -c   spr.c
<br/>
<br/>
arm-elf-gcc -mthumb -mthumb-interwork -specs=gba.specs   demo.txt spr.o   -o data.elf
<br/>
<br/>
And here's what i got:
<br/>
<br/>
spr.o: Assembler messages:
<br/>
spr.o:0: Warning: end of file not at end of a line; newline inserted
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character valued 0x7f
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character valued 0x1
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character is `('
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character valued 0x1
<br/>
spr.o:1: Error: bad instruction `? '
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character valued 0x4
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character is `4'
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character is `('
<br/>
spr.o:1: Error: junk at end of line, first unrecognized character valued 0x6
<br/>
spr.o:1: Error: bad instruction `???τ?╧?│???????τ?╧?│????⌂~⌂f⌂N⌂2⌂'
<br/>
<br/>
Can you please tell me why this is?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49867 - tepples - Wed Aug 03, 2005 2:13 am</h4>
    <div class="postbody"><span class="postbody">How did you generate demo.txt ?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49926 - aRsus - Wed Aug 03, 2005 6:49 pm</h4>
    <div class="postbody"><span class="postbody">How do you mean?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49941 - tepples - Wed Aug 03, 2005 8:28 pm</h4>
    <div class="postbody"><span class="postbody">What is the content of demo.txt? If it is long, what are the first dozen lines or so?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49959 - aRsus - Wed Aug 03, 2005 11:57 pm</h4>
    <div class="postbody"><span class="postbody">It's really short.  Just displaying a sprite.
<br/>
<br/>
.arm
<br/>
.text
<br/>
.global main
<br/>
main:
<br/>
	bl vblank
<br/>
	ldr r0, =0x4000000
<br/>
	ldr r1, =0x1000
<br/>
	str r1, [r0]
<br/>
	ldr r0, =0x7000000
<br/>
	ldr r1, =0x2005c00f @ sprite x=5 y=15  size 64 * 64, 256 col pal
<br/>
	str r1, [r0], #4
<br/>
	ldrh r1, =0x0000
<br/>
	strh r1, [r0]
<br/>
<br/>
	ldr r0, =pal
<br/>
	ldr r2, =0x80
<br/>
	ldr r1, =0x5000200
<br/>
pal_loop:
<br/>
	ldr r3, [r0], #4
<br/>
	str r3, [r1], #4
<br/>
	subs r2, r2, #1
<br/>
	bne pal_loop:
<br/>
<br/>
	ldr r2, =0x200
<br/>
	ldr r1, =0x60010000
<br/>
	ldr r0, =spr
<br/>
spr_loop:
<br/>
	ldr r2, [r0], #4
<br/>
	str r2, [r1], #4
<br/>
	subs r2, r2, #1
<br/>
	bne spr_loop
<br/>
loop:
<br/>
	b loop
<br/>
vblank:
<br/>
	mov r6, #0x4000000
<br/>
	add r6, r6, #0x6
<br/>
	ldrh r7, [r6]
<br/>
	cmp r7, #161
<br/>
	bhs vblank
<br/>
	mov r15, r14
<br/>
spr:
<br/>
	.include "spr.o"
<br/>
pal:
<br/>
	.include "spr.pal"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49968 - tepples - Thu Aug 04, 2005 1:43 am</h4>
    <div class="postbody"><span class="postbody">If it is assembly language code, then it should be named with file name suffix .s not .txt.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49969 - aRsus - Thu Aug 04, 2005 2:04 am</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">tepples wrote:</span></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">If it is assembly language code, then it should be named with file name suffix .s not .txt.</td> </tr></table><span class="postbody">
<br/>
<br/>
Now I get these errors.
<br/>
<br/>
 -o data.elf
<br/>
:\devkitarm\bin\..\lib\gcc\arm-elf\3.4.
<br/>
t: file format not recognized; treating
<br/>
:\devkitarm\bin\..\lib\gcc\arm-elf\3.4.
<br/>
t:2: parse error
<br/>
ollect2: ld returned 1 exit status</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#50042 - poslundc - Thu Aug 04, 2005 7:25 pm</h4>
    <div class="postbody"><span class="postbody">Okay, you've got a number of problems here.
<br/>
<br/>
1. You ought to break up your build steps into compiling and linking. This means having an additional line as follows:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-elf-gcc -mthumb -mthumb-interwork -c spr.c
<br/>
arm-elf-gcc -mthumb -mthumb-interwork -c demo.s
<br/>
<br/>
arm-elf-gcc -mthumb -mthumb-interwork -specs=gba.specs demo.o spr.o -o data.elf</td> </tr></table><span class="postbody">
<br/>
<br/>
Technically you could combine the first two lines but you usually don't want to mix C code and assembly code.
<br/>
<br/>
<br/>
2. Your line .include "spr.o" is causing lots and lots of trouble. The .include statement is just like C's #include pre-processor directive. It means you are taking the contents of spr.o - which is already-assembled binary data - and attempting to paste it into the middle of your unassembled source file. The assembler doesn't know what to make of it; it's just garbage data... like mashing the keyboard with your fist in the middle of writing a C program. Bad idea.
<br/>
<br/>
That part should be removed. The whole reason you've compiled spr.c as a separate unit is so that you don't have to literally paste its contents into any other file that references it.
<br/>
<br/>
<br/>
3. I don't know what format the file "spr.pal" is in, but unless it's written as assembly code you're going to have the exact same problem.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#50077 - aRsus - Fri Aug 05, 2005 2:46 am</h4>
    <div class="postbody"><span class="postbody">So do I refer to the contents of spr.o by the name of the array inside of it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#50078 - poslundc - Fri Aug 05, 2005 2:53 am</h4>
    <div class="postbody"><span class="postbody">Yes.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54015 - kusma - Wed Sep 14, 2005 5:08 pm</h4>
    <div class="postbody"><span class="postbody">(i know this is late, but what the heck) you could also allway use the .incbin "filename"
<br/>
<br/>
this is how i usually include data in my sources
<br/>
<br/>
.global some_data
<br/>
.align
<br/>
some_data:
<br/>
.incbin "some_data.raw"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54017 - poslundc - Wed Sep 14, 2005 5:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">(i know this is late, but what the heck) you could also allway use the .incbin "filename"
<br/>
<br/>
this is how i usually include data in my sources
<br/>
<br/>
.global some_data
<br/>
.align
<br/>
some_data:
<br/>
.incbin "some_data.raw"</td> </tr></table><span class="postbody">
<br/>
<br/>
If you are doing this, I hope it's in its own file as a separate compilation unit, and not something that you repeat throughout multiple source files.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
