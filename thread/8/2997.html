<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ARM conditional field - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>ASM > ARM conditional field</h2>
<div id="posts">
<div class="post">
    <h4>#17343 - DarkPhantom - Sat Mar 06, 2004 5:46 pm</h4>
    <div class="postbody"><span class="postbody">Quick question since I can't find the answer in any of my ARM documentation. How costly are conditional instructions that don't execute? I mean do instructions that fail their conditional field still use the cycles that they would have had they executed? I'm just woundering where it becomes more desireable to use a branch as opposed to a block of conditional instructions.
<br/>
<br/>
For example, I wrote this "if else" block not that long ago:
<br/>
<br/>
orrs r8, r8, r8
<br/>
<br/>
mulne r12, r11, r1
<br/>
addne r12, r12, r0, LSL #1
<br/>
<br/>
muleq r12, r11, r0
<br/>
addeq r12, r12, r1, LSL #1
<br/>
<br/>
would that be more desireable than
<br/>
<br/>
orrs r8, r8, r8
<br/>
beq else
<br/>
<br/>
mul r12, r11, r1
<br/>
add r12, r12, r0, LSL #1
<br/>
b endif
<br/>
<br/>
else:
<br/>
mul r12, r11, r0
<br/>
add r12, r12, r1, LSL #1
<br/>
<br/>
endif:
<br/>
<br/>
I think the first way is much easier to follow (when its commented). Of course, I'm one of those problem programmer's who wants to "conserve" labels. :P<br/>_________________<br/>"head straight for your goal by any means
<br/>
there is a door that you've never opened
<br/>
there is a window with a view you've never seen
<br/>
get there no matter how long it takes"
<br/>
<br/>
-Theme of Shadow, Sonic Adventure 2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17346 - Miked0801 - Sat Mar 06, 2004 6:44 pm</h4>
    <div class="postbody"><span class="postbody">1 cycle per instruction not executed on a conditional.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17356 - torne - Sat Mar 06, 2004 8:48 pm</h4>
    <div class="postbody"><span class="postbody">You don't have to conserve labels; use local ones. =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17358 - jma - Sat Mar 06, 2004 9:20 pm</h4>
    <div class="postbody"><span class="postbody">Unless you have a lot of instructions between your IF/ELSE/ENDIF, it is always better to use the condition codes. This is because branching *may* cause the pipeline to be flushed. 
<br/>
<br/>
The cycles spent not executing opcodes is minimal to the time it takes to refill the pipeline and continue executing again. This is especially true in this situation, where a branch will execute no matter what.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17359 - Miked0801 - Sat Mar 06, 2004 9:34 pm</h4>
    <div class="postbody"><span class="postbody">Um, what pipeline?
<br/>
<br/>
3 cycles (in IWRAM) to branch means that you break even on cycles if you need to skip 3 opcodes, but lose 4 bytes due ot the extra opcode on ROM.  If you need to skip 4, use a branch.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17361 - torne - Sat Mar 06, 2004 10:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jma wrote:</b></span></td> </tr> <tr> <td class="quote">Unless you have a lot of instructions between your IF/ELSE/ENDIF, it is always better to use the condition codes. This is because branching *may* cause the pipeline to be flushed.</td> </tr></table><span class="postbody">
<br/>
Technically yes, except the ARM7 pipeline is only three stages long (fetch/decode, execute, memory access), and thus a branch causes only one cycle of penalty in addition to the time required to do a non-consecutive fetch on the next instruction (which is the same as consecutive if not executing from ROM).</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
