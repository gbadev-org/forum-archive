<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Some problems with storing data - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>ASM > Some problems with storing data</h2>
<div id="posts">
<div class="post">
    <h4>#25926 - ProblemBaby - Tue Aug 31, 2004 8:32 pm</h4>
    <div class="postbody"><span class="postbody">Iam trying to store some values in a C-struct.
<br/>
<br/>
This works fine
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
LDR r3, =myStruct
<br/>
STRH r0, [r3]
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
But this doesnt I got junk
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
LDR r3, =myStruct
<br/>
STR r0, [r3]
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The Variable in the struct is s32 I cant understand!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25929 - sajiimori - Tue Aug 31, 2004 10:37 pm</h4>
    <div class="postbody"><span class="postbody">Is r3 4-byte aligned?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25933 - phonymike - Wed Sep 01, 2004 6:34 am</h4>
    <div class="postbody"><span class="postbody">if the varialbe loaded isn't signed, it's because you need to use LDRSH (load a signed 16bit value)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25934 - ProblemBaby - Wed Sep 01, 2004 9:25 am</h4>
    <div class="postbody"><span class="postbody">r0 is a signed value
<br/>
and r3 should be 4-byte aligned.
<br/>
<br/>
The thing was that it works fine if I use STRH but
<br/>
I want to be able to set it to bigger and negative values too.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
STRH r0, [r3]
<br/>
STRH r0, [r3,#2]
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this also works</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25936 - ProblemBaby - Wed Sep 01, 2004 11:30 am</h4>
    <div class="postbody"><span class="postbody">when I do like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
LDR r3, =myStruct
<br/>
loop:
<br/>
B loop:
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and look at the value in VBA disassembler
<br/>
r3 = 7
<br/>
how is that possible???
<br/>
it works when I do in thumb code.
<br/>
then r3 isnt 4-byte aligned how do I fix it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25939 - sajiimori - Wed Sep 01, 2004 5:24 pm</h4>
    <div class="postbody"><span class="postbody">In GNU C:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define ALIGN __attribute__((aligned (4)))
<br/>
int x ALIGN;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Or in GNU ARM:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
.align
<br/>
x: .word 0
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25957 - ProblemBaby - Wed Sep 01, 2004 9:24 pm</h4>
    <div class="postbody"><span class="postbody">Thanks</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
