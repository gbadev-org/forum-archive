<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>putting code at specific places in memory (with gnu as) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>ASM > putting code at specific places in memory (with gnu as)</h2>
<div id="posts">
<div class="post">
    <h4>#21033 - BeeWarloc - Sat May 22, 2004 12:05 am</h4>
    <div class="postbody"><span class="postbody">The subject says it all.. How do you do this?
<br/>
I know how to put code in different sections, but not at absolute positions, like, say, I wanted to put a specific piece of code at 0x03001000...
<br/>
<br/>
Thanks for all replies..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21067 - phonymike - Sat May 22, 2004 9:14 pm</h4>
    <div class="postbody"><span class="postbody">I don't know myself, but I'd like to point out that you'd need to have the code assembled for that location, but also place the code at that point in RAM. So if you did get the code to start at 0x3001000, you'd also need some asm in crt0.s to copy however much code to IWRAM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21096 - Lupin - Sun May 23, 2004 8:54 pm</h4>
    <div class="postbody"><span class="postbody">Like phonymike said you have to copy the code by yourself (most likely at startup of your binary). The only problem is that you have to know where the code starts and ends... There must be a way to define sections in gas and to use the section labels to find out the start/end of the sections in the binary, but i really have no idea how to do that because i find GAS very complicated for real ASM programming.<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21111 - BeeWarloc - Mon May 24, 2004 1:00 am</h4>
    <div class="postbody"><span class="postbody">I actually figured it out myself... Just had to use the .org directive, and it worked with the standard crt0.s coming with HAM (which I think is almost the same as Jeff's).
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
<br/>
.SECTION .iwram
<br/>
.CODE 32
<br/>
<br/>
@ putting some code in default location (0x3000500 in HAM)
<br/>
@ (I think this is 0x3000000 in DevKitAdv)
<br/>
<br/>
.. some code here ..
<br/>
<br/>
@putting some code at 0x3001000 (0x3000500 + 0xb00)
<br/>
.org 0xb00
<br/>
<br/>
.. some more code here..
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Be aware that this will only work if using only one object file for this section, or else it will probably be relocated when linking.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
