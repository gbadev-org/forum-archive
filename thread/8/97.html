<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Doubled width on screensize? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>ASM > Doubled width on screensize?</h2>
<div id="posts">
<div class="post">
    <h4>#553 - YogiJogg - Wed Jan 08, 2003 7:54 pm</h4>
    <div class="postbody"><span class="postbody">When I run this code (copied from GBAguy?s tutor) the pixel is put on line 0, column 479 and not on line 1, column 239 where I thought it should be put. I use the emulator "VirtalBoy Advance". It appears that the screen mode is 480*(unknown height), instead of 240*160.
<br/>
<br/>
Does anyone know why I have this problem?
<br/>
<br/>
@include screen.h
<br/>
@textarea
<br/>
<br/>
ldr r1,=REG_DISPCNT
<br/>
<br/>
ldr r2,=(BG2_ENABLE|MODE_3)
<br/>
<br/>
str r2,[r1]
<br/>
<br/>
ldr r1,=0x0FF
<br/>
<br/>
ldr r2,=vram+479
<br/>
<br/>
str r1,[r2]
<br/>
<br/>
label1
<br/>
<br/>
B label1
<br/>
<br/>
@pool
<br/>
@endarea</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#555 - YogiJogg - Wed Jan 08, 2003 8:07 pm</h4>
    <div class="postbody"><span class="postbody">I mean the emulator is visualboy and the compiler is goldroad.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#559 - Burre - Wed Jan 08, 2003 8:25 pm</h4>
    <div class="postbody"><span class="postbody">I also tried that tutorial some months ago and I believe that the formula "y * 240 + x" wich he uses is faulty. I used some trial end error method and came up with a formula that worked: (y * 240 + x) * 2. Why this workes (wich I learned later) is that the pixel format is 32bit and when writing you have skip 16bit write 16 bit and so fourth. I'm not sure about the explanation since it's only what I've heard, but I know that the formula workes. Does anyone know why it is this way?<br/>_________________<br/>"The best optimizer is between your ears..."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#562 - YogiJogg - Wed Jan 08, 2003 8:50 pm</h4>
    <div class="postbody"><span class="postbody">That doesn?t work perfeclty either because the pixel is put on the same spot (0,0) for this combinations:
<br/>
<br/>
ldr r2,=vram+0 
<br/>
ldr r2,=vram+1
<br/>
ldr r2,=vram+2
<br/>
ldr r2,=vram+3
<br/>
<br/>
So the formula might be (y * 240 + x) * 4. But then I cant address all pixels because 
<br/>
<br/>
ldr r2,=vram+4
<br/>
<br/>
puts the pixel two steps to the left and leaves a black pixel between.
<br/>
<br/>
Guess I have to read more tutorials and maybe change to another mode.
<br/>
<br/>
Thanks anyway!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#564 - Touchstone - Wed Jan 08, 2003 8:56 pm</h4>
    <div class="postbody"><span class="postbody">The forumla <span style="font-weight: bold">(y * 240 + x) * 2</span> is valid when the width of the screen is 240 pixels, every pixel is two bytes and the VRAM is a linear buffer. The forumla <span style="font-weight: bold">y * 240 + x</span> is valid then the size of each pixel is one byte.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
