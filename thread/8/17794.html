<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ARM instructions using inline assembly - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>ASM > ARM instructions using inline assembly</h2>
<div id="posts">
<div class="post">
    <h4>#177107 - blessingta@hotmail.co.uk - Sun Dec 11, 2011 9:56 pm</h4>
    <div class="postbody"><span class="postbody">hi
<br/>
<br/>
How do I activate arm instruction using in-line assembly ? So  I'm getting this error:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">instruction not supported in Thumb16 mode -- `subs r2,#1'</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177108 - Dwedit - Sun Dec 11, 2011 11:48 pm</h4>
    <div class="postbody"><span class="postbody">Don't use inline asm unless you really need it to be in-line, use separate source files instead, saves a lot of grief.
<br/>
<br/>
That said, make a separate file, declare your code as ARM, and code away.
<br/>
<br/>
If you really need inline ARM assembly in what would otherwise be a thumb source file, you need to change the mode the assembler emits, and also change the mode the processor is executing, then change the modes back afterwards.
<br/>
<br/>
.thumb
<br/>
adr r0,someLabel
<br/>
bx r0
<br/>
.arm
<br/>
someLabel:
<br/>
<br/>
... code here
<br/>
<br/>
adr r0,someLabel2
<br/>
bx r0
<br/>
.thumb
<br/>
someLabel2:
<br/>
nop<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177111 - Miked0801 - Mon Dec 12, 2011 7:23 pm</h4>
    <div class="postbody"><span class="postbody">.code16 or .thumb for Thumb
<br/>
.code32 or .arm for ARM</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
