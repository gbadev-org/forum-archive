<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Generate an interrupt on stack overflow? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>ASM > Generate an interrupt on stack overflow?</h2>
<div id="posts">
<div class="post">
    <h4>#26216 - pan69 - Thu Sep 09, 2004 6:26 pm</h4>
    <div class="postbody"><span class="postbody">If I understood correctly, the stack grows down from the top in IWRAM. I was wondering if it was possible to generate an interrupt of some sort when a stack overflow happens at a set stack limit, say 1K.
<br/>
<br/>
Thanks!
<br/>
<br/>
- Pan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26227 - torne - Thu Sep 09, 2004 9:06 pm</h4>
    <div class="postbody"><span class="postbody">Nope. What you can do is have a canary value (a few bytes with a known value) and check that it's still intact in each iteration of your main loop. If you put the canary far enough away from the end of the stack you'll get a warning when you have used more than that much stack space, but before the stack actually runs out (hopefully).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26236 - tepples - Fri Sep 10, 2004 12:50 am</h4>
    <div class="postbody"><span class="postbody">If you are running your GBA program in a debugging emulator, you can set a watch on writes to the address 1024 bytes below the base of the stack. This would be 0x03fffc00 or 0x03007fc0 depending on how your crt0 sets up the stack.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28375 - sasq - Sat Oct 30, 2004 12:17 pm</h4>
    <div class="postbody"><span class="postbody">OR you could put the stack at the beginning IWRAM so that when the stackptr wraps from 03000000 to 02FFFFFF it will give an exception.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33366 - pan69 - Sun Jan 02, 2005 2:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">OR you could put the stack at the beginning IWRAM so that when the stackptr wraps from 03000000 to 02FFFFFF it will give an exception.</td> </tr></table><span class="postbody">
<br/>
<br/>
But that would use up all of IWRAM for stack usage. Me not want. :)
<br/>
<br/>
- Pan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33374 - Lupin - Sun Jan 02, 2005 6:21 pm</h4>
    <div class="postbody"><span class="postbody">Another idea would be to put the stack into EWRAM, that would of course slow down execution but if your code heavily depends on a large stack that might be the only solution.<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33460 - Miked0801 - Mon Jan 03, 2005 8:45 pm</h4>
    <div class="postbody"><span class="postbody">Are you overflowing your stack in code?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33494 - sasq - Tue Jan 04, 2005 2:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pan69 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">OR you could put the stack at the beginning IWRAM so that when the stackptr wraps from 03000000 to 02FFFFFF it will give an exception.</td> </tr></table><span class="postbody">
<br/>
<br/>
But that would use up all of IWRAM for stack usage. Me not want. :)
<br/>
<br/>
- Pan</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Why? Just use the space above the stack. like the stack goes from 03001000 -&gt; 03000000 and down and you can use iwram 03001000 -&gt; 03007FFF for normal stuff.
<br/>
<br/>
If you use a linkscript you need to change iwram start though.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
