<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GB emulator Memory Mmanagement - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>OffTopic > GB emulator Memory Mmanagement</h2>
<div id="posts">
<div class="post">
    <h4>#91507 - thegamefreak0134 - Fri Jul 07, 2006 5:24 pm</h4>
    <div class="postbody"><span class="postbody">Hello all. (been a while, no internet.) I have been working on the basics for a regular old GB emulator, just to brush up on the skills so I can work on something much more challenging, like the DS. Anywho, a whole three supported opcodes in, I am starting to have concerns.
<br/>
<br/>
The GB has the wierdest memory management I've ever seen. (remember, it's the only one I've seen as well.) All memory is accessed through one 16-bit number from 0000 to FFFF, but certain areas of it represent cart memory, certain areas of it represent external RAM/accessories. Also, there are lots of areas that represent registers, and many of those can only be accessed at certain times or cannot even be accessed at all.
<br/>
<br/>
The cart memory I think I can handle alright by putting a catch in there that checks any memory requests and simply loads the appropriate cart location (or writes it) instead. My real concern is how to go about enabling/disabling different parts of the memory. I realise that most games will check the appropriate registers and avoid this anyway, but it still needs to be done.
<br/>
<br/>
I am in Visual Basic .NET, which I have concluded will be more than fast enough for the job. I also have a lot of the main things like video routine and such covered, and a nice fast system for finding and eecuting the proper commands. What I need to know is, from experience, what is the best way to either block memory from changing, (in an array, mind you) or quickly copy it out and replace it. I do not yet kno how to overwrite only a part of an array without a loop of some sort. Any help here would be greatly appreciated.
<br/>
<br/>
-gamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#91512 - tepples - Fri Jul 07, 2006 5:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>thegamefreak0134 wrote:</b></span></td> </tr> <tr> <td class="quote">The [Game Boy] has the wierdest memory management I've ever seen. (remember, it's the only one I've seen as well.) All memory is accessed through one 16-bit number from 0000 to FFFF, but certain areas of it represent cart memory, certain areas of it represent external RAM/accessories. Also, there are lots of areas that represent registers, and many of those can only be accessed at certain times or cannot even be accessed at all.</td> </tr></table><span class="postbody">
<br/>
This is typical of <span style="font-style: italic">any</span> computer system.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The cart memory I think I can handle alright by putting a catch in there that checks any memory requests and simply loads the appropriate cart location (or writes it) instead.</td> </tr></table><span class="postbody">
<br/>
The GB/GBC memory space is divided largely into eight memory regions each 8 KiB in size: five for the cart (0x0000, 0x2000, 0x4000, 0x6000, 0x8000), and three for the hardware itself (0xA000, 0xC000, 0xE000). Only for the last of the eight will you have to do complicated decoding, as it's where all the I/O registers lie.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">My real concern is how to go about enabling/disabling different parts of the memory.</td> </tr></table><span class="postbody">
<br/>
That's a mapper issue.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I am in Visual Basic .NET, which I have concluded will be more than fast enough for the job.</td> </tr></table><span class="postbody">
<br/>
It should, given that it uses the same compiler back-end as Microsoft's C# compiler, on which Microsoft was briefly betting the proverbial farm.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">What I need to know is, from experience, what is the best way to either block memory from changing, (in an array, mind you) or quickly copy it out and replace it.</td> </tr></table><span class="postbody">
<br/>
Pointers. Lots of pointers. (In the case of VB, it might be called "references to arrays.") See the <a class="postlink" href="http://nesdev.parodius.com/#DocsEmulation" target="_blank">NES emulator development guides on nesdev</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I do not yet kno how to overwrite only a part of an array without a loop of some sort.</td> </tr></table><span class="postbody">
<br/>
The machine will execute loops anyway.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
