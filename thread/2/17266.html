<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Combinatoric Probability (Item Drops as an Example) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>OffTopic > Combinatoric Probability (Item Drops as an Example)</h2>
<div id="posts">
<div class="post">
    <h4>#174109 - sgeos - Tue May 18, 2010 9:00 pm</h4>
    <div class="postbody"><span class="postbody">So, lets say I have four monsters, and each one has a 4.1% chance of dropping an item?  What are the chances of not receiving an item?  Just getting one?  Two?  Three?  Four?
<br/>
<br/>
I remember how to do this in a manual fashion.  Using a spreadsheet to create 16 scenarios (drop VS no drop to the power of 4), this is what I get.
<br/>
0 items @ 84.5813% = (95.9%^4 * 4.1%^0) * 1
<br/>
1 item @ 14.4644% = (95.9%^3 * 4.1%^1) * 4
<br/>
2 items @ 0.9276% = (95.9%^2 * 4.1%^2) * 6
<br/>
3 items @ 0.0264% = (95.9%^1 * 4.1%^3) * 4
<br/>
4 items @ 0.0003% = (95.9%^0 * 4.1%^4) * 1
<br/>
<br/>
This becomes the general formula:
<br/>
(DROP_RATE^DROPS * (1 - DROP_RATE)^(MONSTERS - DROPS)) * X
<br/>
<br/>
I'm having trouble remembering how to derive X from the MONSTERS and DROPS.  (Obviously DROP_RATE doesn't affect it.)  A quick google search didn't turn anything up, although I'm sure it is out there somewhere.  In any case, does anyone remember how do this?  If not, can anyone point me to a site that explains this?
<br/>
<br/>
Thanks.
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span>  The above formula only works for one type of item.  If the monsters have, say, a 4.1% chance of a normal drop, and a 0.9% chance of a rare drop, things quickly become far more complicated.  It is relatively easy to generate a LUT of X (see above formula) when there are only two outcomes (drop VS no drop).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Look Up Table of X
<br/>
<br/>
             Monsters
<br/>
       1   2  3   4   5   6
<br/>
     --- --- --- --- --- ---
<br/>
  0 =  1   1  1   1   1   1
<br/>
D 1 =  1   2  3   4   5   6
<br/>
r 2 =      1  3   6  10  15
<br/>
o 3 =         1   4  10  20
<br/>
p 4 =             1   5  15
<br/>
s 5 =                 1   6
<br/>
  6 =                     1
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
0 and max drops always equal 1, and 1 and (max - 1) drops always equal the number of monsters.  Presumably these are magic numbers that some sort of general formula spits out.  I can't make heads of tails of the numbers in the middle.
<br/>
<br/>
Total X in a column always equals 2^monsters for 2 outcomes.  Presumably the sum of X for a given number of monsters is outcomes^monsters using a more general forumula.  (This could be extended to handle any fixed number of item drops.)
<br/>
<br/>
To get the value in the next column, add the values in the previous column with a "shifted" copy of the previous column.  For example, the values for seven monsters are 1, 7, 21, 35, 35, 21, 7, 1.  (I have not check to see if this will hold with more than 2 outcomes.)
<br/>
<br/>
Unless I'm doing this totally wrong, I've got enough math under my belt to solve any particular problem, but the solution doesn't feel elegant because I need to do more calculations to extend it.
<br/>
<br/>
<span style="font-weight: bold">/EDIT</span></span><span class="gensmall"><br/><br/>Last edited by sgeos on Tue May 18, 2010 9:44 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#174111 - Dwedit - Tue May 18, 2010 9:41 pm</h4>
    <div class="postbody"><span class="postbody">The term is "Binomial distribution"<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174112 - sgeos - Tue May 18, 2010 9:51 pm</h4>
    <div class="postbody"><span class="postbody">Thanks.  What term am I looking for if my problem has more than two outcomes?
<br/>
<br/>
To make things silly, say a monster can drop 19 different types of items.  Obviously I can figure out the probably of receiving two item 12's and one item 3 given a group of six monsters.
<br/>
<br/>
Presumably the formula for that will be some combination of two or three of these:
<br/>
(FAIL_RATE^POW_F * RATE_0^POW_0 * ... * RATE_18^POW_18) * DISTRIBUTION
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span>  "Polynomial distribution" seems like the obvious term, but the results do not seem to point to a general formula of which binomial probability is a simple case... <span style="font-weight: bold">/EDIT</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174118 - elwing - Wed May 19, 2010 6:36 am</h4>
    <div class="postbody"><span class="postbody">hum, just a quick question:
<br/>
since the problem is dead trivial for 1 monster why not use some divide &amp; conquer method? it does not look like you're gonna do this computation every frame and it's not so bad either...
<br/>
<br/>
<br/>
by the way, cearn posted a nice article on probabilities... it's a quite usefull read for people who did never learned probabilty or the one who never used them for the last 5years...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174133 - Cearn - Wed May 19, 2010 5:31 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.coranac.com/2010/05/probabilities-in-simple-random-samples/" target="_blank">Oh hai!</a>
<br/>
<br/>
The general case is given by <a class="postlink" href="http://www.coranac.com/2010/05/probabilities-in-simple-random-samples/#eq-prob-mnom" target="_blank">eq 18</a>. I'm not sure it has a proper name, but I like to call it the multinomial distribution, since the multiple-choice variant of the binomial coefficient is called the multinomial.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">Look Up Table of X
<br/>
<br/>
             Monsters
<br/>
       1   2  3   4   5   6
<br/>
     --- --- --- --- --- ---
<br/>
  0 =  1   1  1   1   1   1
<br/>
D 1 =  1   2  3   4   5   6
<br/>
r 2 =      1  3   6  10  15
<br/>
o 3 =         1   4  10  20
<br/>
p 4 =             1   5  15
<br/>
s 5 =                 1   6
<br/>
  6 =                     1
<br/>
<br/>
<br/>
0 and max drops always equal 1, and 1 and (max - 1) drops always equal the number of monsters. Presumably these are magic numbers that some sort of general formula spits out. I can't make heads of tails of the numbers in the middle.
<br/>
<br/>
Total X in a column always equals 2^monsters for 2 outcomes. Presumably the sum of X for a given number of monsters is outcomes^monsters using a more general formula. (This could be extended to handle any fixed number of item drops.)
<br/>
<br/>
To get the value in the next column, add the values in the previous column with a "shifted" copy of the previous column. For example, the values for seven monsters are 1, 7, 21, 35, 35, 21, 7, 1. (I have not check to see if this will hold with more than 2 outcomes.) </td> </tr></table><span class="postbody">
<br/>
The magic numbers are the result of the binomial coefficient. It gives the number of ways you can distribute two indistinguishable groups of items, like for example the different Left-Right turns you can take to reach a location in Pascal's Triangle. For two choices, the answer is (k1+k2)! / k1! / k2!. For details, interpretation and extension to more choices, see the article. Do note that calculating the coefficient like this can be tricky, as the numbers get big pretty fast.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">To make things silly, say a monster can drop 19 different types of items. Obviously I can figure out the probably of receiving two item 12's and one item 3 given a group of six monsters. </td> </tr></table><span class="postbody">
<br/>
In this case, you'd have three things to consider: choice A (item 12) with a probability <span style="font-style: italic">pa</span> and count <span style="font-style: italic">ka</span>=2, choice B (item 3) with count <span style="font-style: italic">kb</span>=1, <span style="font-weight: bold">and</span> a choice C (neither) with <span style="font-style: italic">pc</span> and <span style="font-style: italic">kc</span>=3. the chance of getting a specific order of results, like <span style="font-style: italic">aabccc</span>, is found by multiplying the probabilities of each sub result: <span style="font-style: italic">pa*pa*pb*pc*pc*pc</span>. This then has to be multiplied by all the different ways you can distribute 2 <span style="font-style: italic">a</span>s, 1 <span style="font-style: italic">b</span> and 3 <span style="font-style: italic">c</span>s, which is 6!/2!/1!/3!.
<br/>
<br/>
You can also break it apart into 'treasure' and 'non-treasure' first, giving the binomial distribution, and then later subdivide the 'treasure' group into A and B. It'll give the same answer, but may take a little longer.
<br/>
<br/>
If you have a graphic calculator, the functions relevant functions will be called something like binompdf for partial probabilities  P(X=k) and binomcdf for cumulative probabilities, P(X≤k).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174141 - sgeos - Thu May 20, 2010 3:10 am</h4>
    <div class="postbody"><span class="postbody">Thanks for the reply.
<br/>
<br/>
Nice article.  Everything makes sense, and it is really simple once you know how to do it.
<br/>
<br/>
This math can even be used for totally unrelated events.  Ie, I have a 17% chance of encountering 4 iron golems.  Each golem has a 28% chance of dropping ore, and a 2% chance of dropping an anvil.  What is the chance of encountering 4 iron golems and receiving at least two ore and one anvil on my first battle.  =)
<br/>
<br/>
The answer is 0.2239104% for an exact match and 0.25696384% if extra items are allowed to drop, right?  (Hopefully I didn't botch that...)
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span>  It seems like there should be some sort of a shortcut for dealing with wildcard results.  In the example above, the behavior of one of the golems doesn't matter... but which particular golem that happens to be is arbitrary... Maybe not?  <span style="font-weight: bold">/EDIT</span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
