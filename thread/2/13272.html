<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>PHP help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>OffTopic > PHP help</h2>
<div id="posts">
<div class="post">
    <h4>#129529 - khan - Wed May 23, 2007 3:45 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
In my free time, I am trying to make a professional looking website on which I would like to display date with message i.e. good morning/afternoon/evening or night.
<br/>
<br/>
I have found a very basic php script however I would really appreciate if someone could expand it so it prints out message along side the side as mentioned above. (BTW I have tried google to no avail)
<br/>
<br/>
<span style="color: red">&lt;?php</span> <span style="color: orange">// Displays in the format Saturday, November 22, 2003 11.38</span>
<br/>
<span style="color: blue">echo date</span>(<span style="color: purple">"l, F d, Y h:i"</span> ,<span style="color: blue">time())</span>;<span style="color: red">?&gt;</span>
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129538 - kusma - Wed May 23, 2007 4:33 pm</h4>
    <div class="postbody"><span class="postbody">Keep in mind that you need the time in the timezone of the user to make sense, not of the server. If not, you'll end up saying "Good night" in the morning etc to people in very different time-zones.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129541 - gauauu - Wed May 23, 2007 5:30 pm</h4>
    <div class="postbody"><span class="postbody">I'm not sure that displaying a "good morning" message is always very professional looking, but here goes.  This is completely untested:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
&lt;?php // Displays in the format Saturday, November 22, 2003 11.38
<br/>
$time = time();
<br/>
$displayDate = date("l, F d, Y h:i" ,$time);
<br/>
$hour = date("G", $time);
<br/>
<br/>
$message = "It's night time!";
<br/>
if (($hour &gt; 6) &amp;&amp; ($hour &lt; 12)) { $message = "Good Morning";}
<br/>
if (($hour &gt; 12) &amp;&amp; ($hour &lt; 17)) { $message = "Good Afternoon";}
<br/>
if (($hour &gt; 17) &amp;&amp; ($hour &lt; 22)) { $message = "Good Evening";}
<br/>
<br/>
echo "$time $message";
<br/>
?&gt;
<br/>
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129544 - keldon - Wed May 23, 2007 5:47 pm</h4>
    <div class="postbody"><span class="postbody">Yes, it is not something that is of any importance. Sounds like you may need to visit the following (just in case):
<br/>
 - <a href="http://www.webpagesthatsuck.com/" target="_blank">http://www.webpagesthatsuck.com/</a>
<br/>
 - <a href="http://www.useit.com/alertbox/991114.html" target="_blank">http://www.useit.com/alertbox/991114.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131126 - khan - Mon Jun 11, 2007 10:59 am</h4>
    <div class="postbody"><span class="postbody">Thank you all for your suggestions/help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143221 - khan - Thu Oct 18, 2007 1:53 pm</h4>
    <div class="postbody"><span class="postbody">Sorry for bothering you guys again but I need help again.
<br/>
<br/>
What I am trying to do right now is to separate customer &amp; admin login from the same login.php page.
<br/>
<br/>
As I understand, I can do the same thing by creating a separate admin table and login page but that is a bit simple and not something I would want.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">&lt;?php
<br/>
session_start();        // Shows we are using sessions
<br/>
include('dbinfo.inc');
<br/>
<br/>
$user = $_POST['username'];    // Gets the inputted username from the form
<br/>
$pass = $_POST['password'];    // Gets the inputted password from the form
<br/>
$time = time();            // Gets the current server time
<br/>
$check = $_POST['setcookie'];        // Checks if the remember me button was ticked
<br/>
$connection = mysql_connect($hostname, $username, $password) or die ("Unable to connect!"); //open connection
<br/>
mysql_select_db($databaseName) or die ("Unable to select database!"); // check for connection errors
<br/>
<br/>
$query = "SELECT * FROM Customer WHERE UserName = '$user' AND Password = '$pass'";
<br/>
$result = mysql_query($query, $connection);
<br/>
<br/>
if(mysql_num_rows($result)) {    // If the username and password are correct do the following;
<br/>
   	$_SESSION["authenticatedUser"] = 1; // Sets the session 'loggedin' to 1
<br/>
	$_SESSION['username'] = $user;
<br/>
    if($check) {
<br/>
    // Check to see if the 'setcookie' box was ticked to remember the user
<br/>
    setcookie("shop[username]", $user, $time + 3600);    // Sets the cookie username
<br/>
    setcookie("shop[password]", $pass, $time + 3600);    // Sets the cookie password
<br/>
    }
<br/>
<br/>
   header("Location: logged_options.php?username=$user"); // Forwards the user to this URL
<br/>
   exit();
<br/>
}
<br/>
else    // If login is unsuccessful forwards the user back to the index page with an error
<br/>
{
<br/>
   header("Location: login_error.php");
<br/>
   exit();
<br/>
}
<br/>
?&gt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I want to send the user to either admin.php or logged_options.php depending upon which <span style="font-weight: bold">Status</span> is set for them in the <span style="font-weight: bold">Customer</span> table but using this same page.
<br/>
<br/>
Here's hoping that it was clear to understand</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143224 - jetboy - Thu Oct 18, 2007 2:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>khan wrote:</b></span></td> </tr> <tr> <td class="quote">Sorry for bothering you guys again but I need help again.</td> </tr></table><span class="postbody">
<br/>
<br/>
You would beter chose one of the below:
<br/>
1. learn programming
<br/>
2. pay someone who can program it for you
<br/>
<br/>
You just cant do any programming work done by taking diferent bits and sticking them together without understanding how they work.
<br/>
<br/>
edit: ah! and saving password in cookies is not a good idea.
<br/>
<br/>
edit2: to make things clear. I like helping people. But doing whole thing for someone is different thing.<br/>_________________<br/>Colors! gallery -&gt; <a href="http://colors.collectingsmiles.com" target="_blank">http://colors.collectingsmiles.com</a>
<br/>
Any questions? Try <a href="http://colors.collectingsmiles.com/faq.php" target="_blank">http://colors.collectingsmiles.com/faq.php</a> first, or official forums <a href="http://forum.brombra.net" target="_blank">http://forum.brombra.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143228 - Vich - Thu Oct 18, 2007 2:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jetboy wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>khan wrote:</b></span></td> </tr> <tr> <td class="quote">Sorry for bothering you guys again but I need help again.</td> </tr></table><span class="postbody">
<br/>
<br/>
You would beter chose one of the below:
<br/>
1. learn programming
<br/>
2. pay someone who can program it for you
<br/>
<br/>
You just cant do any programming work done by taking diferent bits and sticking them together without understanding how they work.
<br/>
<br/>
edit: ah! and saving password in cookies is not a good idea.
<br/>
<br/>
edit2: to make things clear. I like helping people. But doing whole thing for someone is different thing.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I agree.
<br/>
And don't forget the SQL injection security risk in that code!<br/>_________________<br/>[<a class="postlink" href="http://www.lifeisdigital.net" target="_blank">project website</a>] [<a class="postlink" href="http://www.kenvanhoeylandt.net" target="_blank">personal website</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143907 - HyperHacker - Sat Oct 27, 2007 7:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>khan wrote:</b></span></td> </tr> <tr> <td class="quote">$user = $_POST['username'];    // Gets the inputted username from the form
<br/>
$pass = $_POST['password'];    // Gets the inputted password from the form
<br/>
[...]
<br/>
$query = "SELECT * FROM Customer WHERE UserName = '$user' AND Password = '$pass'";
<br/>
$result = mysql_query($query, $connection);</td> </tr></table><span class="postbody">
<br/>
<br/>
Now watch what happens when I enter silly things like this:
<br/>
Username: ' OR 1=1; --
<br/>
Password: anything
<br/>
<br/>
Username: [name of an admin account]
<br/>
Password ' OR 1=1; --
<br/>
<br/>
And this one won't work in all systems, but:
<br/>
Username: anything
<br/>
Password: '; UPDATE Customer SET Password='foo' WHERE UserName='bar'; --
<br/>
<br/>
See the problem here? Try actually typing out what the resulting query string would be. (-- is a comment BTW.)
<br/>
<br/>
There's also the problem that by storing your passwords in plain text, anyone who can read the database can get them all.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143929 - tepples - Sat Oct 27, 2007 2:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>khan wrote:</b></span></td> </tr> <tr> <td class="quote">$query = "SELECT * FROM Customer WHERE UserName = '$user' AND Password = '$pass'";</td> </tr></table><span class="postbody">
<br/>
To fix what HyperHacker is talking about, try this: Before passing any user-entered string to a MySQL query such as SELECT, sanitize it. Ordinarily, you do this by calling <a class="postlink" href="http://us2.php.net/manual/en/function.mysql-real-escape-string.php" target="_blank">mysql_real_escape_string()</a> on each string before passing it to mysql_query().<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144412 - zzo38computer - Thu Nov 01, 2007 7:33 pm</h4>
    <div class="postbody"><span class="postbody">To store login data in cookies, I often use this:
<br/>
<br/>
username . ":" . MD5( username . MD5(password) . client_ip . secret_code )
<br/>
<br/>
where username is the logged in username, password is the password entered in the form, client_ip is the client's IP address, secret_code is a secret code that only the owner of the server knows, and the period is the concatenation operator.<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144452 - kusma - Fri Nov 02, 2007 1:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zzo38computer wrote:</b></span></td> </tr> <tr> <td class="quote">To store login data in cookies, I often use this:[bizarre shit]</td> </tr></table><span class="postbody">
<br/>
you are aware that security by obscurity doesn't work, right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144459 - tepples - Fri Nov 02, 2007 3:44 am</h4>
    <div class="postbody"><span class="postbody">It works if obscurity lies only in the key, which in this case is secret_code.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144470 - kusma - Fri Nov 02, 2007 12:22 pm</h4>
    <div class="postbody"><span class="postbody">I was mostly talking about the double-md5'ing and concatenation of totally unrelated stuff. ofcourse, if you store only the md5 of the password (as you should for politeness) the double md5-ing makes sense, but not as shown in that code-snippet.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144498 - zzo38computer - Sat Nov 03, 2007 1:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">I was mostly talking about the double-md5'ing and concatenation of totally unrelated stuff. ofcourse, if you store only the md5 of the password (as you should for politeness) the double md5-ing makes sense, but not as shown in that code-snippet.</td> </tr></table><span class="postbody">
<br/>
Of course I do store only the MD5 of the password (and I also make the file where the password hash is stored to be inaccessible using .htaccess). The code I wrote isn't the real code anyways, it is just a simplified example that you can use. The client IP address is stored so that even if someone can steal the cookie, then they still can't login.<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144535 - kusma - Sat Nov 03, 2007 3:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zzo38computer wrote:</b></span></td> </tr> <tr> <td class="quote">The client IP address is stored so that even if someone can steal the cookie, then they still can't login.</td> </tr></table><span class="postbody">
<br/>
I find it extremely annoying when a laptop move and change base-station or a router reboots and change public IP. There's better options to minimize the chance of cookie-theft IMO.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144541 - HyperHacker - Sat Nov 03, 2007 5:28 pm</h4>
    <div class="postbody"><span class="postbody">His method of throwing other info in with the password before hashing isn't too bad really. It helps ensure that just knowing the hash of someone's password won't do them much good, because the cookies use the hash of the password plus something else they may not know. If the "secret code" is hardcoded into the source, rather than stored in the database, then having full database access wouldn't be enough to generate a valid cookie.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144547 - Mighty Max - Sat Nov 03, 2007 6:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">His method of throwing other info in with the password before hashing isn't too bad really. It helps ensure that just knowing the hash of someone's password won't do them much good, because the cookies use the hash of the password plus something else they may not know. </td> </tr></table><span class="postbody">
<br/>
<br/>
Salting is good. This however isn't.
<br/>
Where is the security win? You are artificially limiting cookies to one connection only. In which case a cookie is void tbh (*). Rather use PHP's sessioning then instead.
<br/>
<br/>
(*) Because the hashed passwd..IP..salt will not match on another connection again, the user has to provide the password once again. 
<br/>
<br/>
Usually the password is more often exposed by not using https on login forms, then by sniffing the hash.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
