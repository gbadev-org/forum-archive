<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Non-GBA/NDS Beginner Question - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>OffTopic > Non-GBA/NDS Beginner Question</h2>
<div id="posts">
<div class="post">
    <h4>#170104 - the-anonymous-coward - Mon Aug 31, 2009 7:27 am</h4>
    <div class="postbody"><span class="postbody">Okay, so I know by reading around here that data in a header file in a no-no. However, I have been trying to compile multiple class source files that have constants and have ran into problems. I can't figure out how to create constant variable and separate it into a header and source file. The only way I have been able to get rid of the errors is with the code below, but I want to know how to properly do it. So, what <span style="font-style: italic">should</span> I do?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef CONSTANTS_H 
<br/>
#define CONSTANTS_H 
<br/>
<br/>
const int SCREEN_W = 400;
<br/>
const int SCREEN_H = 275;
<br/>
const int SCREEN_BPP = 32;
<br/>
<br/>
#endif 
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170108 - eKid - Mon Aug 31, 2009 11:03 am</h4>
    <div class="postbody"><span class="postbody">I usually use an enum for that kind of stuff.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef STUFF_H
<br/>
#define STUFF_H
<br/>
<br/>
enum {
<br/>
  SCREEN_W = 400,
<br/>
  SCREEN_H = 275,
<br/>
  SCREEN_BPP = 32
<br/>
};
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I <span style="font-style: italic">think</span> it would also be okay if you prefixed 'static' to those const int's.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170110 - gauauu - Mon Aug 31, 2009 3:12 pm</h4>
    <div class="postbody"><span class="postbody">Alternatively (but not necessarily better than the enum), traditionally, this has been one of the accepted uses of the preprocessor:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define SCREEN_W 400
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170115 - the-anonymous-coward - Mon Aug 31, 2009 7:08 pm</h4>
    <div class="postbody"><span class="postbody">Ah, thanks. Works. So it's technically correct to include data in a header if it is in an enum?
<br/>
<br/>
Next problem is declaring pointers in a class header. The compiler doesn't seem to like: 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef WINDOW_H
<br/>
#define WINDOW_H
<br/>
<br/>
#include &lt;string&gt;
<br/>
#include "SDL/SDL.h"
<br/>
using std::string;
<br/>
<br/>
class Window
<br/>
{
<br/>
  public:
<br/>
    Window();
<br/>
    bool create();
<br/>
    void cleanup();
<br/>
  
<br/>
<br/>
  private:
<br/>
    //const int SCREEN_WIDTH = 400;
<br/>
    //const int SCREEN_HEIGHT = 275;
<br/>
    //const int SCREEN_BPP = 32;
<br/>
<br/>
    SDL_Surface *background;
<br/>
    SDL_Surface *screen;
<br/>
<br/>
    bool init();
<br/>
    SDL_Surface *loadImage( string );
<br/>
    void applySurface( int, int, SDL_Surface*, SDL_Surface* ); 
<br/>
};
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170125 - elhobbs - Tue Sep 01, 2009 1:28 pm</h4>
    <div class="postbody"><span class="postbody">error messages are helpful</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170131 - keldon - Tue Sep 01, 2009 4:44 pm</h4>
    <div class="postbody"><span class="postbody">Make that a static const; otherwise you're telling the compiler that every instance of the class has a constant integer to store (do you catch my drift)?
<br/>
<br/>
Move that using std::string into the class, and for the code you've got you can do the following:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Get rid of the include below
<br/>
// #include "SDL/SDL.h"
<br/>
<br/>
class SDL_Surface;
<br/>
<br/>
class Window
<br/>
{
<br/>
   typedef std::string String;    // Notice how I change it to your conventions
<br/>
<br/>
   //
<br/>
   // ...
<br/>
   //
<br/>
<br/>
public:
<br/>
   static const int SCREEN_WIDTH = 400;
<br/>
private:
<br/>
<br/>
   SDL_Surface *load_image ( const String &amp;file_name ); // Notice the const reference
<br/>
<br/>
<br/>
};
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Something like this might also be used instead of enumerations for a list of constants:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">static const int
<br/>
   SCREEN_WIDTH = 400,
<br/>
   SCREEN_HEIGHT = 275,
<br/>
   SCREEN_BPP = 32;
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170135 - the-anonymous-coward - Tue Sep 01, 2009 11:42 pm</h4>
    <div class="postbody"><span class="postbody">I apologize, I will post the error messages asap. 
<br/>
<br/>
Thanks, keldon. The static info helped. I will include the constants in this header now. There are a couple of things I don't understand, however. You are saying I should not include "SDL/SDL.h", right? Is that why you put 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">class SDL_Surface;</td> </tr></table><span class="postbody">
<br/>
<br/>
at the top? Does that allow me to use SDL_Surface without including the entire header? I also don't understand the use of const in the load_image function header. Here is a link to the code that I learned from and am adapting and separating into multiple files:
<br/>
<br/>
page:
<br/>
<a href="http://lazyfoo.net/SDL_tutorials/lesson02/index.php" target="_blank">http://lazyfoo.net/SDL_tutorials/lesson02/index.php</a>
<br/>
<br/>
source:
<br/>
<a href="http://lazyfoo.net/downloads/index.php?file=SDLTut_lesson02" target="_blank">http://lazyfoo.net/downloads/index.php?file=SDLTut_lesson02</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170136 - keldon - Wed Sep 02, 2009 1:13 am</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Re: 'include "SDL/SDL.h"</span>
<br/>
<br/>
Including anything in a header file means that anything that includes the header file also includes those files. <a class="postlink" href="http://www-subatech.in2p3.fr/~photons/subatech/soft/carnac/CPP-INC-1.shtml" target="_blank">Use forward declaration</a> over includes where possible.
<br/>
<br/>
If a class &lt;A&gt; includes only pointer references to class &lt;B&gt; then only a forward declaration of &lt;B&gt; is needed.
<br/>
<br/>
<span style="font-weight: bold">Re: const reference (notice the &amp;reference)</span>
<br/>
<br/>
Your method has no need to modify the string, and copying the string results in a number of needless instructions. In this case it is best to <a class="postlink" href="http://www.codeguru.com/forum/showthread.php?t=231040" target="_blank">avoid the unnecessary overhead</a>, especially given that there is no good reasoning for doing so. This is not premature optimism, but rather copying the string (as was done in the Lazy Foo example) could be regarded as premature pessimism, which is another type of design flaw.
<br/>
<br/>
Whenever passing an object you will not modify that is larger than 4 bytes you will probably find that const references are the best choice.
<br/>
<br/>
---
<br/>
<br/>
However, the purpose of Lazy Foo's SDL tutorial site is to teach SDL and not C++. Experience (and some C++ design books) will tell you when to use a static class constant, namespace constant, enumeration or a function. For now, continue to focus on getting working prototypes that you can refine at a later time - you are making great progress!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170166 - the-anonymous-coward - Sat Sep 05, 2009 1:01 am</h4>
    <div class="postbody"><span class="postbody">Hey. Thanks a lot, keldon. I really appreciate the information, advice, and encouragement. I am actually replying from my cell phone. Going out of town. I would like to ask what design book you would recommend me reading later, when I need one?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170173 - keldon - Sat Sep 05, 2009 4:05 pm</h4>
    <div class="postbody"><span class="postbody">Off the top of my head I can think of the following:
<br/>
 - Effective C++
<br/>
 - More Effective C++
<br/>
 - Design Patterns by Erich Gamma, Richard Helm, Ralph Johnson, and John Vlissides
<br/>
 - Effective STL
<br/>
<br/>
There's a list we have on our work wiki, plus some others that others may suggest. I might add some stuff if I missed anything.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170175 - the-anonymous-coward - Sat Sep 05, 2009 6:12 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, those are actually all on my wish list. Which should I start with. I read that... let me see, was it C++ CODING STANDARDS? ... anyway, I read that something similar to that title was really good. Any in particular I should start with? I always see EFFECTIVE C++ mentioned.
<br/>
<br/>
Also, your work wiki, is it private for the company's viewing only? I didn't see it at sigames.com</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170178 - keldon - Sat Sep 05, 2009 10:05 pm</h4>
    <div class="postbody"><span class="postbody">It's a private wiki; but I think that <a class="postlink" href="http://www.artima.com/cppsource/top_cpp_books.html" target="_blank">Scott Meyer's list of 'important' C++ books</a> pretty much covers the rest. You can also <a class="postlink" href="http://www.mindview.net/Books/DownloadSites/" target="_blank">download Thinking In C++</a> for free!
<br/>
<br/>
Just for completion, here is the list of suggested reading on our wiki:
<br/>
<br/>
<span style="font-weight: bold">C/C++ Books</span>
<br/>
The C++ Programming Language, Bjarne Stroustrup, Addison Wesley
<br/>
The Annotated C++ Reference manual, Margaret Ellis &amp; Bjarne
<br/>
Effective C++
<br/>
More Effective C++
<br/>
<br/>
<span style="font-weight: bold">General programming books</span>
<br/>
The pragmatic programmer, Andrew Hunt ...
<br/>
The practice of programming, Brian Kernighan ...
<br/>
Programming pearls, Jon Bentley
<br/>
Extreme programming explained, Kent Beck ...
<br/>
Design patterns, Gamma / Help / Johnson ..
<br/>
Refactoring, Martin Fowler</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170182 - the-anonymous-coward - Sun Sep 06, 2009 6:07 pm</h4>
    <div class="postbody"><span class="postbody">Thanks!
<br/>
<br/>
Okay, I finally have a chance to post error messages. Here are the current ones: 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
D:\MyProjects\C++\Internship&gt;g++ -o graph.exe main.cpp window.cpp -lmingw32 -lSD
<br/>
Lmain -lSDL
<br/>
C:/mingw/bin/../lib/gcc/mingw32/3.4.5/../../../libSDLmain.a(SDL_win32_main.o): I
<br/>
n function `console_main':
<br/>
/Users/hercules/trunk/SDL-1.2/./src/main/win32/SDL_win32_main.c:246: undefined r
<br/>
eference to `SDL_main'
<br/>
collect2: ld returned 1 exit status
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and here is my current header file:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef WINDOW_H
<br/>
#define WINDOW_H
<br/>
<br/>
#include &lt;string&gt;
<br/>
#include "SDL/SDL.h"
<br/>
<br/>
using std::string;
<br/>
<br/>
class Window
<br/>
{
<br/>
  public:
<br/>
    Window();
<br/>
    void cleanup();
<br/>
  
<br/>
<br/>
  private:
<br/>
    static const int
<br/>
      SCREEN_W = 400,
<br/>
      SCREEN_H = 275,
<br/>
      SCREEN_BPP = 32; 
<br/>
<br/>
    SDL_Surface* background;
<br/>
    SDL_Surface* screen;
<br/>
<br/>
    void create();
<br/>
    void init();
<br/>
    SDL_Surface *loadImage( string );
<br/>
    void applySurface( int, int, SDL_Surface*, SDL_Surface* ); 
<br/>
};
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I plan to add the cleaner code that you made, keldon. But I want to get it working first. I am not sure where to look for the problem; the error message seems somewhat vague, but that's probably just my inexperience. 
<br/>
<br/>
I am going to continue looking at the code. Let me know if you guys need anything else.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170184 - the-anonymous-coward - Sun Sep 06, 2009 6:34 pm</h4>
    <div class="postbody"><span class="postbody">Oh, and this code is embarrassing, but here is Window.cpp: 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//#include "SDL/SDL.h"
<br/>
//#include &lt;string&gt;
<br/>
#include "Window.h"
<br/>
<br/>
Window::Window()
<br/>
{
<br/>
  background = NULL;
<br/>
  screen = NULL;
<br/>
  create();
<br/>
}
<br/>
<br/>
void Window::init()
<br/>
{
<br/>
  // initialize all SDL subsystems
<br/>
  if( SDL_Init( SDL_INIT_EVERYTHING ) == -1 )
<br/>
  {
<br/>
    //return false;
<br/>
  }
<br/>
<br/>
  // set up the screen
<br/>
  screen = SDL_SetVideoMode( SCREEN_W, SCREEN_H, SCREEN_BPP, SDL_SWSURFACE );
<br/>
<br/>
  // check for error in setting up screen
<br/>
  if( screen == NULL )
<br/>
  {
<br/>
   // return false;
<br/>
  }
<br/>
<br/>
  // set the window caption
<br/>
  SDL_WM_SetCaption( "Graphing Window", NULL );
<br/>
}
<br/>
<br/>
SDL_Surface* Window::loadImage( std::string filename ) 
<br/>
{
<br/>
  // temporary storage for the image that's loaded
<br/>
  SDL_Surface* loadedImage = NULL;
<br/>
<br/>
  // optimized image that will be used
<br/>
  SDL_Surface* optimizedImage = NULL;
<br/>
<br/>
  // load the image
<br/>
  loadedImage = SDL_LoadBMP( filename.c_str() );
<br/>
<br/>
  // if nothing went wrong in loading the image
<br/>
  if( loadedImage != NULL )
<br/>
  {
<br/>
    // create an optimized image
<br/>
    optimizedImage = SDL_DisplayFormat( loadedImage );
<br/>
<br/>
    // free the old image
<br/>
    SDL_FreeSurface( loadedImage );
<br/>
  }
<br/>
<br/>
  // return the optimized image
<br/>
  return optimizedImage;
<br/>
}
<br/>
<br/>
void Window::applySurface( int x, int y, SDL_Surface* source, SDL_Surface* destination )
<br/>
{
<br/>
  // make a temporary rectangle to hold the offsets
<br/>
  SDL_Rect offset;
<br/>
<br/>
  // give the offsets to the rectangle
<br/>
  offset.x = x;
<br/>
  offset.y = y;
<br/>
<br/>
  // blit the surface
<br/>
  SDL_BlitSurface( source, NULL, destination, &amp;offset );
<br/>
}
<br/>
<br/>
void Window::create()
<br/>
{
<br/>
  init(); 
<br/>
  
<br/>
  // load backgroung
<br/>
  background = loadImage( "prettyGraph1.bmp" );
<br/>
<br/>
  // apply background to screen
<br/>
  applySurface( 0, 0, background, screen );
<br/>
<br/>
  // update screen
<br/>
  if( SDL_Flip( screen ) == -1 )
<br/>
  {
<br/>
    //return false;
<br/>
  }
<br/>
}
<br/>
<br/>
void Window::cleanup()
<br/>
{
<br/>
  // free background
<br/>
  SDL_FreeSurface( background );
<br/>
<br/>
  // release SDL
<br/>
  SDL_Quit(); 
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Eww. Well, I will clean it up when I figure out the problem. Since it works in my test file that does all this in a single source file, I figure it must be something I don't understand about separating code into separate files, passing references or pointer, or returning them. Something along that line, and I am looking, but I don't see it. Over the past two days I have read all but the final chapter of BEGINNING C++ THROUGH GAME PROGRAMMING, a book I've had for a while. I understand all the concepts as I go through, but haven't applied them enough to see problems in my code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170189 - the-anonymous-coward - Sun Sep 06, 2009 10:17 pm</h4>
    <div class="postbody"><span class="postbody">Ah, I figure it out. I forgot a must while working with SDL. The can't use "int main()" thing. Forgot "int main( int argc, char* args[] )". Now it works.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
