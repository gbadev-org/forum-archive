<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>VB control and C DLLs - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>OffTopic > VB control and C DLLs</h2>
<div id="posts">
<div class="post">
    <h4>#14255 - DiscoStew - Sat Jan 03, 2004 6:55 am</h4>
    <div class="postbody"><span class="postbody">I've been using VB for making programs that help speed up progress in my GBA programming, but now I'm trying to use C DLLs so that all the major processing portions can all be done faster. Although I have succeeded in doing this, I have run into a few problems that I'd like to have figured out.
<br/>
<br/>
1)
<br/>
When my VB program enters my C DLL, VB is unable to do anything until the function call is completed. I'd like to be able to use a VB Timer so that I can access a counter I made in the C DLL for use with a VB Progress Bar, but my attempts have all failed. Sleep() does not allow for outside events to be executed, and my knowledge of Windows API is extreeeeeeemly low, so I don't know what to do. My C DLL only contains two functions, the main processing portion I converted from my original VB code (so it would execute faster), and a function that would return the global counter I mentioned earlier. The VB Timer was supposed to access this function, but it doesn't.
<br/>
<br/>
2)
<br/>
Is there any way to be able to debug a C DLL? I spent about an hour looking through my C code trying to figure out why one of my functions wasn't working, only to find out it was a simple mistake on my part. I know in MS Visual C++ under the Build tab, I can use Start Debug/Go, and specify a program that could use my DLL, but actual debugging is another story.
<br/>
<br/>
These problems are not really a priority on my list at the moment, but getting them out of the way would help nonetheless. If anyone knows what to do, please help. thx<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14256 - sajiimori - Sat Jan 03, 2004 8:28 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
When my VB program enters my C DLL, VB is unable to do anything until the function call is completed.
<br/>
</td> </tr></table><span class="postbody">
<br/>
If you're using VB6, you're in for some real pain.
<br/>
<br/>
Black Belt Programming - Create Worker Threads in DLLs
<br/>
<a class="postlink" href="http://www.fawcette.com/archives/listissue.asp?pubID=1&amp;MagIssueId=190#" target="_blank">http://www.fawcette.com/archives/listissue.asp?pubID=1&amp;MagIssueId=190#</a>
<br/>
<br/>
For the love of god, just switch to .NET.  ;-)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Is there any way to be able to debug a C DLL?
<br/>
</td> </tr></table><span class="postbody">
<br/>
Write a test app that calls your library functions, build your DLL with debugging enabled, build the test app with debugging enabled, then execute your test app in the debugger.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
