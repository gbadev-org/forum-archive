<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Making image palletes with SGADE's SoConverter? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > Making image palletes with SGADE's SoConverter?</h2>
<div id="posts">
<div class="post">
    <h4>#83116 - Kixdemp - Sat May 13, 2006 2:12 am</h4>
    <div class="postbody"><span class="postbody">Hello everyone! :-D
<br/>
OK, I got an assertion error in my emulator, saying
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Image must be paletizzed.</td> </tr></table><span class="postbody">
<br/>
That's because, when I tried to make a pallete with SoConverter, I got this error:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Fatal conversion error:
<br/>
No palette available in the media file loaded.</td> </tr></table><span class="postbody">
<br/>
Why is that? Since the PNG file didn't work, I converted it to 24-bit bitmap in MS Paint, but that didn't work either! Anyone know why this is? Thanks! ;-)
<br/>
<br/>
PS: Here's my bitmap: (First image I could find, I think I found it at some forum or something...):
<br/>
<a href="http://www.sulfurmidis.com/monkey.bmp" target="_blank">http://www.sulfurmidis.com/monkey.bmp</a><br/>_________________<br/>"My wealth has doubled since we last met."
<br/>
-- RICH BOY WILTON, Pokemon Emerald</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83120 - kusma - Sat May 13, 2006 3:10 am</h4>
    <div class="postbody"><span class="postbody">try.. (duh)... palletizing it? (Image -&gt; Mode -&gt; Indexed Color in Photoshop)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83125 - Kixdemp - Sat May 13, 2006 3:42 am</h4>
    <div class="postbody"><span class="postbody">Ooohh... Alright, thanks! ;-)
<br/>
Now... All I get is a color patternized screen of some sort... :-(
<br/>
I want to place this image on the top-left corner of the screen, what's the correct code to do it? I have this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   // set palette
<br/>
<br/>
   SoPaletteSetPalette(SO_SCREEN_PALETTE, monkeyPalette, true);
<br/>
<br/>
<br/>
<br/>
   // Set Mode 4 (bitmap mode)
<br/>
<br/>
   SoDisplaySetMode(0);
<br/>
<br/>
<br/>
<br/>
   // load tile data
<br/>
<br/>
    SoImageBkgLoad(&amp;monkeyImage, 0, 0);
<br/>
<br/>
<br/>
<br/>
   // allocate a background layer
<br/>
<br/>
   SoBkgSetup(0, SO_BKG_PRIORITY_0 | SO_BKG_CHARBASE(0)
<br/>
<br/>
     | SO_BKG_MOSAIC_DISABLE | SO_BKG_CLRMODE_256 | SO_BKG_SCRBASE(0x1f)
<br/>
<br/>
     | SO_BKG_TEXTSIZE_256x256);
<br/>
<br/>
   
<br/>
   // turn on the background display
<br/>
<br/>
   SoBkgEnable(0, true);</td> </tr></table><span class="postbody">
<br/>
<br/>
What must I change? Thanks! ;-)
<br/>
<br/>
Note: That code is just an edited version of the BBA example... :-)<br/>_________________<br/>"My wealth has doubled since we last met."
<br/>
-- RICH BOY WILTON, Pokemon Emerald</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83142 - thegamefreak0134 - Sat May 13, 2006 6:59 am</h4>
    <div class="postbody"><span class="postbody">I'm not entirely sure (you're obviously using some defines I don't recognize) but it looks like you're in a tiled mode. If you want to use a picture, you must be in either mode 3, 4, or 5, which are the bitmap modes. If not, you must convert the picture to a tileset and a map to load into the tiled mode.
<br/>
<br/>
Mode 0 allows tiled modes and nothing else. Change the mode to 4 and copy the image into the appropriate location to see if you've got the image right, then work from there.
<br/>
<br/>
*edit* How much "editing" have you done to this code? What was it supposed to do in the first place? That may hold the answer.<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83184 - Kixdemp - Sat May 13, 2006 11:05 pm</h4>
    <div class="postbody"><span class="postbody">Oops, nevermind - in tileset mode, I get a brown screen, it's in bitmap mode that I get the patternized screen... :-$
<br/>
The original code is the 6th code block in this page:
<br/>
<a href="http://www.suddenpresence.com/bbatutorial/chapter03.html" target="_blank">http://www.suddenpresence.com/bbatutorial/chapter03.html</a> (Ctrl+F for: <span style="font-weight: bold"><span style="font-style: italic">// ***  INITIALIZATION</span></span> )
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">copy the image into the appropriate location to see if you've got the image right</td> </tr></table><span class="postbody">
<br/>
How do I do that? (Sorry, I'm a n00b, I never made GBA games before... :-P )
<br/>
Thanks! ;-)<br/>_________________<br/>"My wealth has doubled since we last met."
<br/>
-- RICH BOY WILTON, Pokemon Emerald</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83224 - thegamefreak0134 - Sun May 14, 2006 7:36 am</h4>
    <div class="postbody"><span class="postbody">memcpy( (u16 *)0x6000000, &amp;&lt;pic&gt;Data, sizeof(&lt;pic&gt;Data) );
<br/>
<br/>
This assumes you've taken a PCX file and converted it to an image array in a header file define. Of course, you said something to the effect of not using PCX files. Anywho (the above is for mode 4 I believe) basically what this does is copies the actual image to the area of RAM (0x6000000) that the GBA uses to draw the screen. It does it in one big lump, so it's nice and fast. Replace "&lt;pic&gt;Data" with whatever your utility of choice outputs as the image array and see what you get.
<br/>
<br/>
Note: If the above makes no sense, you're probably not using that kind of utility. 
<br/>
<br/>
Something just occured to me: Are you using a 240,160 image? If you're not, that might explain your wierd patterened-ness. Can you show us a screenshot of what you're getting? My theory here is that the pattern is all towards the top, indicating that rather than go to the next line arter the width of the image your program is rather continuing on the same line, resulting in vary bad effects. Try making your image 240 by 160 and see if it helps. 
<br/>
<br/>
Cheers!
<br/>
<br/>
-thegamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83288 - Kixdemp - Mon May 15, 2006 1:01 am</h4>
    <div class="postbody"><span class="postbody">I resized the image to 240x160.  I still get a patterned image, but now it doesn't "move"... :-/
<br/>
Here's what I get: <a href="http://sulfurmidis.com/weird.png">[Images not permitted - Click here to view it]</a>
<br/>
Know what's wrong? Thanks! ;-)<br/>_________________<br/>"My wealth has doubled since we last met."
<br/>
-- RICH BOY WILTON, Pokemon Emerald</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83302 - tepples - Mon May 15, 2006 4:57 am</h4>
    <div class="postbody"><span class="postbody">I'll bet money that weird.png is an attempt to display tile data intended for mode 0 in mode 4 (8-bit extended rotation).<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83665 - Kixdemp - Wed May 17, 2006 7:28 pm</h4>
    <div class="postbody"><span class="postbody">Umm... it's a bitmap, why would I want to display it as tiles? :-/
<br/>
Thanks! ;-)<br/>_________________<br/>"My wealth has doubled since we last met."
<br/>
-- RICH BOY WILTON, Pokemon Emerald</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83674 - tepples - Wed May 17, 2006 8:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kixdemp wrote:</b></span></td> </tr> <tr> <td class="quote">Umm... it's a bitmap, why would I want to display it as tiles? :-/</td> </tr></table><span class="postbody">
<br/>
Perhaps because your image converter was set to output tile data. Either use a tile mode to display tile data or use an extended rotation (bitmap) mode to display bitmap data.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
