<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Large Maps - revisited - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > Large Maps - revisited</h2>
<div id="posts">
<div class="post">
    <h4>#10777 - goro - Mon Sep 15, 2003 12:44 pm</h4>
    <div class="postbody"><span class="postbody">I'm using Mode 0 and 16-color tiles. I'm a little confused as to the best way to display a large scrollable map (for this example, I only want horizontal scroll-both ways).
<br/>
<br/>
I looked at this post : <a href="http://forum.gbadev.org/viewtopic.php?t=67" target="_blank">http://forum.gbadev.org/viewtopic.php?t=67</a>
<br/>
And I've studied various tutorials but I still have the following questions :-
<br/>
<br/>
Q1. Do I simply use a 256x256 map and just update the off screen tiles and then
<br/>
<br/>
Q2. Am I right in assuming that I only need to update the edge-row or column? and then,
<br/>
<br/>
Q3. Do I use the hardware scroll to bring them onto screen or some other method?  
<br/>
<br/>
Q4. Do I have to use the backbuffer in tile modes?
<br/>
<br/>
Q5. When I use mapEd095 to create a map array larger than 256x256,
<br/>
I get large(8x8)horizontal line-gaps on the screen. Why?
<br/>
<br/>
Q6. Even my 256x256 map seems to have a vertical misalignment in the 
<br/>
middle of it (only around one pixel off). Why?
<br/>
<br/>
I want smooth scrolling without 'jumpiness' or screen artifacts/relics.
<br/>
<br/>
my code is:-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for(loop = 0; loop &lt; 4182; loop++)  //load tile image data
<br/>
      bg1.tileData[loop] = bgTiles[loop]; //4128
<br/>
<br/>
   //load the map image data
<br/>
   temp = (u16*)map;
<br/>
   for(loop = 0; loop &lt; 32*32/1; loop++)
<br/>
      bg1.mapData[loop] = temp[loop];</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
A code example (that doesn't use dma, cos I haven't learnt that yet) or a mod of my code would be great!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10782 - Nessie - Mon Sep 15, 2003 3:01 pm</h4>
    <div class="postbody"><span class="postbody">mapEd v0.95 Lite only allows creation of primary layers that are 256x256 or smaller....older versions had a 128x128 limit.   Is this something you are seeing with a secondary layer?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10786 - tepples - Mon Sep 15, 2003 3:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>goro wrote:</b></span></td> </tr> <tr> <td class="quote">Q1. Do I simply use a 256x256 map and just update the off screen tiles and then
<br/>
<br/>
Q2. Am I right in assuming that I only need to update the edge-row or column? and then,
<br/>
<br/>
Q3. Do I use the hardware scroll to bring them onto screen or some other method?</td> </tr></table><span class="postbody">
<br/>
Correct.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Q4. Do I have to use the backbuffer in tile modes?</td> </tr></table><span class="postbody">
<br/>
No.  Tile maps have small enough data that you can do all the necessary updating during vblank, so you won't need to use a hardware page flip.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10788 - goro - Mon Sep 15, 2003 5:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">mapEd v0.95 Lite only allows creation of primary layers that are 256x256 or smaller</td> </tr></table><span class="postbody">
<br/>
<br/>
Nessie : -Sorry I was unclear :-  I meant 256x256 pixels not 256x256 tiles.
<br/>
<br/>
 - Im using the 'import bitmap' feature so it's probably a secondary layer in MapEd.
<br/>
When I 'view map' in vba 1.6, I  seem to get artifacts on all layers/bg's.
<br/>
<br/>
Tepples : re Q2 - You said in the other post that this may take more than 1 vblank. Is this true in my case?
<br/>
<br/>
Tepples : re: Q3 -I was looking for a 'one or the other' answer not a yes or no  answer. I.e -"goro - use hardware scrolling" or -"goro use 'some other' method" -again, sorry for being unclear.
<br/>
<br/>
<br/>
New question : In my case - will DMA copying make my BG scroll smoother or should I use this existing method and save dma for music &amp; other stuff?? 
<br/>
<br/>
New question 2 : Is there something wrong with my code that would cause said misalignment on the vertical axis?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16 temp;
<br/>
   bg-&gt;tileData = (u16*)CharBaseBlock(bg-&gt;charBaseBlock);
<br/>
   bg-&gt;mapData = (u16*)ScreenBaseBlock(bg-&gt;screenBaseBlock);
<br/>
   temp = bg-&gt;size | (bg-&gt;charBaseBlock&lt;&lt;CHAR_SHIFT) | (bg-&gt;screenBaseBlock&lt;&lt;SCREEN_SHIFT)
<br/>
      | bg-&gt;colorMode | bg-&gt;mosaic | bg-&gt;wraparound;</td> </tr></table><span class="postbody">
<br/>
<br/>
Also - Any chance of getting -</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">A code example (that doesn't use dma, cos I haven't learnt that yet) or a mod of my code...</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10789 - sgeos - Mon Sep 15, 2003 6:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>goro wrote:</b></span></td> </tr> <tr> <td class="quote">Q4. Do I have to use the backbuffer in tile modes?</td> </tr></table><span class="postbody">
<br/>
No.  Tile maps have small enough data that you can do all the necessary updating during vblank, so you won't need to use a hardware page flip.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
One could use a couple of screen base blocks like a backbuffer if desired.  I'm not convinced that you wish to in this case.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>goro wrote:</b></span></td> </tr> <tr> <td class="quote">New question : In my case - will DMA copying make my BG scroll smoother? </td> </tr></table><span class="postbody">
<br/>
<br/>
Maybe. DMA copying is faster.  I don't know if moving your bg data faster is helpful.
<br/>
<br/>
-Brendan Sechter</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10792 - tepples - Mon Sep 15, 2003 8:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>goro wrote:</b></span></td> </tr> <tr> <td class="quote">re Q2 - You said in the other post that this may take more than 1 vblank. Is this true in my case?</td> </tr></table><span class="postbody">
<br/>
What other post?  I'm guessing that in another post I may have been talking about modes 3, 4, or 5, which do take longer to develop.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">re: Q3 -I was looking for a 'one or the other' answer not a yes or no  answer. I.e -"goro - use hardware scrolling" or -"goro use 'some other' method" -again, sorry for being unclear.</td> </tr></table><span class="postbody">
<br/>
I saw it as "should I use hardware scrolling?" and answered "yes". Yes, you should use hardware scrolling.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">New question : In my case - will DMA copying make my BG scroll smoother</td> </tr></table><span class="postbody">
<br/>
DMA copying doesn't work at 64 byte intervals, which is required for updating vertical strips of map data when scrolling horizontally.  I'd suggest not using DMA for map data, though you should use DMA for tile data and sprite cel data.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">or should I use this existing method and save dma for music &amp; other stuff??</td> </tr></table><span class="postbody">
<br/>
This is a typical assignment of DMA channels.
<br/>
DMA[0]: video raster effects
<br/>
DMA[1]: sound FIFO filling
<br/>
DMA[2]: possibly more raster effects, or stereo sound
<br/>
DMA[3]: free for any memcpy() or memset() operations
<br/>
<br/>
I can't provide a code example right now because I haven't played around with big scrolling tile maps.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10805 - goro - Tue Sep 16, 2003 3:04 pm</h4>
    <div class="postbody"><span class="postbody">Thanks Tepples.
<br/>
<br/>
I really appreciate all your help.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
