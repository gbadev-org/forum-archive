<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>need help with usenti sprite exporting - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > need help with usenti sprite exporting</h2>
<div id="posts">
<div class="post">
    <h4>#178033 - Pepepuhn - Mon Aug 12, 2013 3:24 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I am trying to export the following spritesheet to a .c file using usenti: 
<br/>
<a href="http://files.renemichalke.de/eathworm_running_transparent.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
However when I run the rom in visualboy and try to display the first frame I get the following image:
<br/>
<a href="http://files.renemichalke.de/game_engine_02.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
These are the settings I am using:
<br/>
<a href="http://files.renemichalke.de/Bildschirmfoto.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
When I only export the first frame of the spritesheet (the first 64x64 pixels) the sprite is being displayed properly:
<br/>
<br/>
What am I doing wrong?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#178034 - Dwedit - Mon Aug 12, 2013 3:58 pm</h4>
    <div class="postbody"><span class="postbody">Make sure your sprites are correctly set in the OAM.  Use 16 color mode, not 256 color mode, and check that the tile indexes are correct.
<br/>
Also check using the VRAM viewer that your sprite graphics and palette are correctly loaded as well.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#178035 - Pepepuhn - Mon Aug 12, 2013 5:40 pm</h4>
    <div class="postbody"><span class="postbody">I think the problem is the way I  am exporting the spritesheet, because when I am exporting the following spritesheet: <a href="http://files.renemichalke.de/earthworm_running_1.png">[Images not permitted - Click here to view it]</a>
<br/>
I get the correct result, which is this: <a href="http://files.renemichalke.de/game_engine_01.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
However when I use the exported spritesheet with the multiple frames, I get this image: <a href="http://files.renemichalke.de/game_engine_02.png">[Images not permitted - Click here to view it]</a>
<br/>
I didn't change anything in the code, I just switched the exported .c and .h files. Tile index is set to 0, in both examples. Because I first want to see if frame 1 is being displayed correctly, but it isn't. 
<br/>
<br/>
Tile viewer looks like this with only one frame in spritesheet: <a href="http://files.renemichalke.de/Bildschirmfoto-1.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
And Tile viewer with multiple frame spritesheet: 
<br/>
<a href="http://files.renemichalke.de/Bildschirmfoto-2.png">[Images not permitted - Click here to view it]</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#178037 - Dwedit - Mon Aug 12, 2013 9:55 pm</h4>
    <div class="postbody"><span class="postbody">You shouldn't be seeing any junk underneath the sprite in the tile viewer, no idea where that stuff is coming from.  Are you copying 4 times as many bytes as needed?
<br/>
<br/>
If you were copying tons of random data, you could be overwriting mirrors of VRAM with more junk.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#178038 - Pepepuhn - Mon Aug 12, 2013 11:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Are you copying 4 times as many bytes as needed?</td> </tr></table><span class="postbody">
<br/>
<br/>
As it turns out, I did.
<br/>
<br/>
I was using this piece of code, just like in the tonc tutorial:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">memcpy32(&amp;tile_mem[4][0], fooTiles, fooTilesLen);</td> </tr></table><span class="postbody">
<br/>
<br/>
Using the following fixed it:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">memcpy32(&amp;tile_mem[4][0], fooTiles, fooTilesLen/4);</td> </tr></table><span class="postbody">
<br/>
<br/>
As I now understand memcpy32 uses the number of items to copy, not the size in bytes. 
<br/>
<br/>
Thank you for your help ;)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
