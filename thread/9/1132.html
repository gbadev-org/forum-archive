<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>gba2gfx odd problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > gba2gfx odd problem</h2>
<div id="posts">
<div class="post">
    <h4>#5567 - Xenobach - Fri May 02, 2003 12:35 am</h4>
    <div class="postbody"><span class="postbody">Ok I'm on Chapter 3 on the GBAJunkie tutorials and it uses a .h file for a background display. 
<br/>
<br/>
So I wanted to use my own .h picture and change the cpp code. I've changed the code and it works fine, its just the picture thats off.
<br/>
<br/>
The picture is just a simple b&amp;w defocused picture of myself that I converted into PCX and BMP format using Photoshop. I've tried using both of them but I keep getting just weird b&amp;w lines that dont even come close to representing what I did in Photoshop.
<br/>
<br/>
The ms-dos line of code that I used was:
<br/>
<br/>
gfx2gba test.pcx test.h -t type -s 2 -z 256
<br/>
<br/>
Then I get my .h file but I suppose it doesn't work.
<br/>
<br/>
Anyone have any ideas for this newbie? If you need more info just ask. Thanx in advance. (get it? Advance?..ah forget it).
<br/>
[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5600 - Xenobach - Fri May 02, 2003 8:55 pm</h4>
    <div class="postbody"><span class="postbody">Geez, 26 views and no one can help me? Or even give me a hint?
<br/>
<br/>
Anyways I guess I'll decribe it a little more.
<br/>
<br/>
The picture after converted into a .h file looks like when your looking at the fuzzy television. There is all these b&amp;w lines that just look out of place.
<br/>
<br/>
ANY help would be helpful.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5601 - niltsair - Fri May 02, 2003 9:04 pm</h4>
    <div class="postbody"><span class="postbody">Try aligning your data on a 32bits boundary.
<br/>
<br/>
I'm also having a similar problem that sometime occurs with a Slides Program i'm wokring on. The quick temp fix that worked for me, was to not use weird dimension. So, try converting a 240x160 picture as a first try.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5611 - Xenobach - Sat May 03, 2003 7:00 am</h4>
    <div class="postbody"><span class="postbody">The picture is 240x160. At 256 colors.
<br/>
<br/>
I'll see about the 32 bit boundry. Even though I'm not too keen on that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6946 - Ninj4D4n - Wed Jun 04, 2003 11:10 pm</h4>
    <div class="postbody"><span class="postbody">Xeno,
<br/>
What mode are you in?  There are to graphics converts floating around out there.   One is for tile mode (0,1, 2), one is for bitmap mode (3, 4, 5).   the difference is the way that they strip the pixel data into the array.  One of them just reads straight across the bmp and converts it directly to array.  The other preserves the tile arangement (ie the first 32 numbers are for the first tile, the next 32 for the next tile).
<br/>
<br/>
It does sound like your using the correctly named program, but it sounds like its behaving like the other one.  so i'm not sure if this helps at all.
<br/>
<br/>
also, just try dragging and dropping your pcx file ontop of the gfx2gba.exe and see if that fixes it.
<br/>
<br/>
--Ninj4D4n</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6959 - Quirky - Thu Jun 05, 2003 7:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Xenobach wrote:</b></span></td> </tr> <tr> <td class="quote">The ms-dos line of code that I used was:
<br/>
<br/>
gfx2gba test.pcx test.h -t type -s 2 -z 256
<br/>
<br/>
Then I get my .h file but I suppose it doesn't work.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Which gfx2gba are you using? There are 2 programs with the same name that do different things and have different switches, make sure you use the right one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7681 - Xenobach - Sun Jun 22, 2003 10:16 pm</h4>
    <div class="postbody"><span class="postbody">I still have no clue on how to do this. So I guess I'll provide more information so I can get some help.
<br/>
<br/>
I'm using the gfx2gba program created by D. Sillett and uses the command prompt to enter options. 
<br/>
<br/>
The code I enter I have already put in one of my earlier posts.
<br/>
<br/>
<a class="postlink" href="http://home.attbi.com/~polywave/test.h" target="_blank">Here is my '.h' file.</a> It isn't like the other .h file provided by the person who made the tutorial though. And even if I do get it to be like his (w/ another program), it still doesn't work.
<br/>
<br/>
<a class="postlink" href="http://home.attbi.com/~polywave/imagedisp.elf" target="_blank"> Here is my '.elf' file.</a> My picture is in black and white but this just looks strange. Run the elf file in your GBA emulator and you'll see how it looks.
<br/>
<br/>
Here is what the img file (a bmp made in photoshop) looks like: <a href="http://home.attbi.com/~polywave/test.bmp">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
It is a 256 color (I don't know why...it just came that way) bmp pic as is a 240 x 160. 
<br/>
<br/>
Any help or any questions at all (anything will help) would be greatly appreciated. Thank you in advance.[/url][/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7709 - djei-dot - Mon Jun 23, 2003 11:21 am</h4>
    <div class="postbody"><span class="postbody">The picture looks OK to me. I'm pretty sure the problem is in your code. Could you show us a snippet of it? (I didn't find it in your last posts - I'm not talking about the gfx2gba prompt).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7744 - Xenobach - Mon Jun 23, 2003 9:15 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "gba.h"        //GBA register definitions
<br/>
#include "dispcnt.h"    //REG_DISPCNT register definitions
<br/>
#include "test.h"   //holds the image information in an array
<br/>
<br/>
void PlotPixel(int x,int y, unsigned short int c)
<br/>
{
<br/>
   VideoBuffer[(y) * 120 + (x)] = (c);
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
   int loop;
<br/>
   int x, y;
<br/>
<br/>
        SetMode(MODE_4 | BG2_ENABLE); //set mode 4 and enable background 2
<br/>
<br/>
   for(loop = 0; loop &lt; 256; loop++)                 //256 entries allowed
<br/>
      BGPaletteMem[loop] = testPalette[loop]; //load the palette into palette memory
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
      for(y = 0; y &lt; 160; y++)                  //screen height
<br/>
      {
<br/>
         for(x = 0; x &lt; 120; x++)          //screen width
<br/>
         {
<br/>
            PlotPixel(x,y, testData[y*120+x]);   //load image data into
<br/>
         }                  //memory pixel by pixel
<br/>
      }
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"><br/><br/>Last edited by Xenobach on Mon Jun 23, 2003 9:18 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#7745 - Xenobach - Mon Jun 23, 2003 9:17 pm</h4>
    <div class="postbody"><span class="postbody">I dont think it is the code though since every other picture that has been turned into a .h file (provided by other sources or as a example) works just fine.
<br/>
<br/>
I'm pretty sure its the picture or my misuse of gfx2gba. I'm trying to use the pcx2gba program but I can't get it to work. 
<br/>
<br/>
Thanx for any help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7769 - djei-dot - Tue Jun 24, 2003 11:58 am</h4>
    <div class="postbody"><span class="postbody">OK I got your problem.
<br/>
<br/>
Your gfx2gba instruction uses the -z option, which turns your picture into sprites/tiles. You don't need tiles in bitmap modes (3-5), so you have to remove that option. The correct gfx2gba instruction would be:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gfx2gba test.pcx test.h -8 -s 2</td> </tr></table><span class="postbody">
<br/>
<br/>
The -8 option is to output in Mode 4 format (modes 3 and 5 use -16). Also, you don't need the -t type, because the -s 2 sets the default type. The output of this instruction should work now and should be the same as the output from pcx2gba.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7792 - Xenobach - Tue Jun 24, 2003 7:00 pm</h4>
    <div class="postbody"><span class="postbody">I grovel at your feet djei-dot. Thanx alot (cause it worked).
<br/>
<br/>
Now I can finally move on. 
<br/>
<br/>
I can't say thanx enough but I'll try:
<br/>
<br/>
thanx, thanx, thanx, thanx...(+ 1000.)
<br/>
<br/>
Anyways one final one: Thank you very much djei-dot. I'm glad people like you are here in this community.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7794 - sgeos - Tue Jun 24, 2003 8:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Xenobach wrote:</b></span></td> </tr> <tr> <td class="quote">thanx, thanx, thanx, thanx...(+ 1000.)</td> </tr></table><span class="postbody">
<br/>
<br/>
You could have said something like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int ctr;
<br/>
<br/>
for (ctr = 0; ctr &lt; 65535; ctr++)
<br/>
  printf("thanx\n");
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Or even:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">while (1)
<br/>
  printf("thanx\n");
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7797 - Xenobach - Tue Jun 24, 2003 9:21 pm</h4>
    <div class="postbody"><span class="postbody">I'm not a big fan of talking in code.
<br/>
<br/>
Too geekish.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7800 - Cyberman - Wed Jun 25, 2003 12:36 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Xenobach wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not a big fan of talking in code.
<br/>
<br/>
Too geekish.</td> </tr></table><span class="postbody">
<br/>
Then you should stop posting in GBA dev? ;)
<br/>
<br/>
Really I'm not sure talking C/C++ code is the same as biting chicken's heads off as a carnival performer.
<br/>
<br/>
Cyb - my 2 cents :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7804 - Xenobach - Wed Jun 25, 2003 3:03 am</h4>
    <div class="postbody"><span class="postbody">Ha. I'm not sure what a carnival chicken-head eater has anything to do with "geekish" but I'll take that into consideration.
<br/>
<br/>
Hey Cyberman, I wanted a penny for your thoughts and you gave me your two cents. So do ya want your cent back? ;)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
