<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>bin files using grit[solved but one question left] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > bin files using grit[solved but one question left]</h2>
<div id="posts">
<div class="post">
    <h4>#167713 - Tommmie - Mon Mar 23, 2009 7:25 am</h4>
    <div class="postbody"><span class="postbody">ok so i started with converting a 1024x1024 bg with grit to the bin format. i load the bin's from fat but my ds AND ideas do nothing, my code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
#include &lt;stdlib.h&gt;
<br/>
#include &lt;string.h&gt;
<br/>
#include &lt;dirent.h&gt;
<br/>
#include &lt;fat.h&gt;
<br/>
#include &lt;nitrofs.h&gt;
<br/>
#include "kakariko.h"
<br/>
#include "background.h"
<br/>
<br/>
<br/>
int x;
<br/>
int y;
<br/>
u8 speed;
<br/>
int nx, ny;
<br/>
int rx, ry;
<br/>
unsigned short sourcemap[16384];
<br/>
unsigned short * buffer;
<br/>
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
int main(void)
<br/>
{
<br/>
//---------------------------------------------------------------------------------
<br/>
 videoSetMode(MODE_5_2D | DISPLAY_BG0_ACTIVE);
<br/>
    vramSetBankA(VRAM_A_MAIN_BG);
<br/>
   fatInitDefault();
<br/>
   nitroFSInit("/test.nds");
<br/>
    int bg1 = bgInit(0, BgType_Text8bpp, BgSize_T_512x256, 0, 1);
<br/>
    FILE * pfile;
<br/>
   pfile = fopen("map.bin", "rb");
<br/>
   fread(&amp;sourcemap, kakarikoMapLen, 1, pfile);
<br/>
   fclose (pfile);
<br/>
   
<br/>
   
<br/>
   pfile = fopen("/tiles.bin", "rb");
<br/>
   buffer = (unsigned short*) malloc (kakarikoTilesLen);
<br/>
   fread(&amp;buffer, kakarikoTilesLen, 1, pfile);
<br/>
   fclose (pfile);
<br/>
   dmaCopy(buffer, bgGetGfxPtr(bg1), sizeof(kakarikoTiles));
<br/>
   free(buffer);
<br/>
   
<br/>
   pfile = fopen("/pal.bin", "rb");
<br/>
   buffer = (unsigned short*) malloc (kakarikoPalLen);
<br/>
   fread(&amp;buffer, kakarikoPalLen, 1, pfile);
<br/>
   fclose (pfile);
<br/>
   dmaCopy(buffer, BG_PALETTE, sizeof(kakarikoPal));
<br/>
   free (buffer);
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
ok so i have a new piece of code without that malloc part(it's even smaller now:)), but could someone please say me why that was wrong?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
