<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprites and affines - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > Sprites and affines</h2>
<div id="posts">
<div class="post">
    <h4>#96150 - jfolk - Tue Aug 01, 2006 6:37 pm</h4>
    <div class="postbody"><span class="postbody">Hello all.
<br/>
My question lies in the math.
<br/>
I have several sprites making up one big sprite(no changing this fact).I would like to scale this one big sprite (to pulsate).  The problem is the sprites overlap eachother, and cause warping.  I believe it is fixed point rounding errors, which cannot be prevented.  Any ideas on how to do this?  If so, please describe it mathematically.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96207 - jfolk - Tue Aug 01, 2006 9:11 pm</h4>
    <div class="postbody"><span class="postbody">I am wondering if this question is too broad, or the readers may think that I want them to do it for me...  I'm just puzzled where to start, any response will be appreciated</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96218 - crossraleigh - Tue Aug 01, 2006 10:06 pm</h4>
    <div class="postbody"><span class="postbody">Translate the sprites as you scale them.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96226 - jfolk - Tue Aug 01, 2006 10:45 pm</h4>
    <div class="postbody"><span class="postbody">yes, but by how much?
<br/>
you can scale a sprite from (1&lt;&lt;6) to (1&lt;&lt;10), inclusively, but you at what points do you have to translate it?  I made a small demo game which you increment the scaling factor by one every time you press a key, to watch when it physically changes size.  It seems that, every 16 increments it changes size, although it didnt' map out to a function where it was ALWAYS 16.
<br/>
I have a scale, scale_velocity(which increments the scale every frame), a max_scale, and  min_scale variables.
<br/>
<br/>
ex:
<br/>
u16 scale = 1&lt;&lt;8;
<br/>
u16 scale_velocity = 1;
<br/>
u16 max_scale = 1&lt;&lt;10;
<br/>
u16 min_scale = 1&lt;&lt;6;
<br/>
<br/>
void update(){
<br/>
  if(scale&lt;=min_scale || scale&gt;=max_scale){
<br/>
    scale_velocity=-(scale_velocity);
<br/>
  }
<br/>
<br/>
  scale+=scale_velocity;
<br/>
  /*Apply the scaling*/
<br/>
  /*Translate the sprites when necessary*/
<br/>
}
<br/>
<br/>
So um... when is it necessary.
<br/>
Any help would be appreciated.
<br/>
<br/>
P.S.
<br/>
The sprites positions are in 24.8 fixed point</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96372 - crossraleigh - Wed Aug 02, 2006 10:40 pm</h4>
    <div class="postbody"><span class="postbody">If I were you I'd write some fixed-point ops so I could step away bit farther away from the registers. After that just remember that the scaling value is a <span style="font-style: italic">factor</span>. <span style="font-style: italic">s</span> = 2.0 means the sprite's size should be doubled. You get a new width and height by <span style="font-style: italic">w'</span> = <span style="font-style: italic">sw</span> and <span style="font-style: italic">h'</span> = <span style="font-style: italic">sh</span>.
<br/>
<br/>
Since the transformation doesn't move the center of the sprite, one half of the difference in width goes to the left, the other half goes to the right; one half the difference in height goes to the top, the other half goes to the bottom. So for example if you wanted to keep the top-left corner of a sprite stationary, translate (<span style="font-style: italic">w'</span> - <span style="font-style: italic">w</span>) / 2 units right and (<span style="font-style: italic">h'</span> - <span style="font-style: italic">h</span>) / 2 units down.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96579 - thegamefreak0134 - Thu Aug 03, 2006 11:41 pm</h4>
    <div class="postbody"><span class="postbody">Calculate the scale yourself. Calculate exactly where the bottom right pixel will be (use fixed point math so any errors in the GBA hardware are reflected properly.) when scaled, and then draw the next sprite down-right one pixel from that. (or right or down, depending on positio and stuff.)
<br/>
<br/>
Why do you need a huge sprite anyway? Is 64x64 just too small? It seems like for something like this you might want to consider mapping the image to a background. Course, that depends entrely on what it's being used for and the circumstances and stuff.<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96635 - Cearn - Fri Aug 04, 2006 9:40 am</h4>
    <div class="postbody"><span class="postbody">The general equations for correct affine object placement can be found <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/affobj.htm#sec-combo" target="_blank">here</a>, with examples. Also, I strongly recommend you <span style="font-style: italic">NOT</span> to use u16 for variables here, not only because they are slower, but in affine calculations overflow can happen very quickly and when there are any negative numbers anywhere the whole thing will blow up. Use ints.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
