<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Plotting only one pixel - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > Plotting only one pixel</h2>
<div id="posts">
<div class="post">
    <h4>#20007 - mymateo - Thu Apr 29, 2004 9:22 pm</h4>
    <div class="postbody"><span class="postbody">It's me again, throwing myself at the mercy of smarter, more experienced people.
<br/>
<br/>
I would like to know how to place a single pixel at a time.  Before you reply, read through.
<br/>
<br/>
Here's my entire source code for you gurus to pick at.  I don't see anything wrong, except for the excrutiating slow PutPixel routine.  I was having troubles getting it to place an odd X numbered pixel on the screen in an odd X numbered spot, and even X's in even X's spot.  I thought this would work, but it doesn't.  Don't worry, I would never commit such a haneous crime against fast code in a real game or demo.
<br/>
<br/>
--- BEGIN CODE ---
<br/>
// Program to demonstrate plotting "one" pixel.
<br/>
<br/>
typedef unsigned int u8;
<br/>
typedef unsigned short u16;
<br/>
typedef unsigned long u32;
<br/>
<br/>
u16* Palette = (u16*)0x05000000;
<br/>
u16* videoBuffer = (u16*)0x06000000;
<br/>
u32* VideoMode = (u32*)0x04000000;
<br/>
<br/>
void SetPalette(u8 PalNum,u8 R,u8 G,u8 B){Palette[PalNum] = ((B&lt;&lt;10) | (G&lt;&lt;5) | R);}
<br/>
<br/>
void PutPixel(u8 pX,u8 pY,u16 C)
<br/>
{
<br/>
  int x,y,TempX;
<br/>
  x = 0;
<br/>
  for (y = 0; y &lt; pX; y++)
<br/>
  {
<br/>
    x = 1 - x;  // Switches between "1" and "0" alternating -- Fake binary
<br/>
  }
<br/>
  TempX = pX / 2;  //Change to "TempX = pX;" and see what happens!
<br/>
  if (x = 0){videoBuffer[(pY * 120) + TempX] = C | 0 &lt;&lt; 8;  } // First  pixel
<br/>
  if (x = 1){videoBuffer[(pY * 120) + TempX] = 0 | C &lt;&lt; 8;  } // Second pixel
<br/>
  //For some reason, the result looks like "x" is ALWAYS 1 no matter what...
<br/>
}
<br/>
<br/>
void AgbMain()
<br/>
{
<br/>
  int X, Y;
<br/>
<br/>
  *VideoMode = 0x0404;
<br/>
  SetPalette( 0, 5, 5, 5);
<br/>
  SetPalette( 1,20,20,20);
<br/>
  for (X = 0; X &lt; 100; X++)
<br/>
  {
<br/>
    Y = X;
<br/>
    PutPixel(X,Y,1);  // Having Y is redundant, but for pity's sake
<br/>
  }
<br/>
  while(1);  // Let's not have any hoo-haw here
<br/>
}
<br/>
 --- END CODE ---
<br/>
<br/>
SO, if anyone sees anything wrong, maybe you could help me out?  I'm all for figuring out something for myself, but I've stared at this until I've gone blind.  If you don't want to give away the farm, then I'm happy as a clam just to get a hint as to where to look.  But I'm not proud, either.  I'll take a free hand-out if someone wants to fix my code and hand it back!
<br/>
<br/>
Anyway, thanks everyone.  This forum has so many helpful people on it!  (I wish I could be one...)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20009 - niltsair - Thu Apr 29, 2004 9:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">x = 0;
<br/>
	for (y = 0; y &lt; pX; y++)
<br/>
	{
<br/>
		x = 1 - x; // Switches between "1" and "0" alternating -- Fake binary
<br/>
	}</td> </tr></table><span class="postbody">Replace this by : <span style="font-weight: bold">x = (pX &amp; 0x01);</span> Keep only the last bits, which mean it'll alternate Even and Odd. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">TempX = pX / 2; //Change to "TempX = pX;" and see what happens!</td> </tr></table><span class="postbody"> You need to divide by 2 because you fit 2 pixel per Memory Entry (16bits write);
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
if (x = 0){videoBuffer[(pY * 120) + TempX] = C | 0 &lt;&lt; 8; } // First pixel
<br/>
	if (x = 1){videoBuffer[(pY * 120) + TempX] = 0 | C &lt;&lt; 8; } // Second pixel
<br/>
	//For some reason, the result looks like "x" is ALWAYS 1 no matter what...</td> </tr></table><span class="postbody">Always =1 because of you're missing a '=' in your 'if' <span style="font-weight: bold">if (x == 0)</span>
<br/>
<br/>
You also need to mask the current color to keep the left(or right part) intact when modifying other pixel.</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">x = (pX &amp; 0x01);
<br/>
TempX = pX &gt;&gt; 1; //Same as divide by 2 but faster(if compiler don't optimize it that way itself)
<br/>
if (x == 0)videoBuffer[(pY*120)+TempX] = (videoBuffer[(pY*120)+TempX]&amp;0xFF00) | C; 
<br/>
if (x == 1)videoBuffer[(pY*120)+TempX] = (videoBuffer[(pY*120)+TempX]&amp;0x00FF) | (C&lt;&lt;8);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Ideally, you would create a Macro(#define) with this, instead of a function, faster.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20010 - Miked0801 - Thu Apr 29, 2004 10:58 pm</h4>
    <div class="postbody"><span class="postbody">If you poke around a bit with the search feature, you'll find a couple of nice putpixel routines coded in assembly for you already :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20011 - mymateo - Thu Apr 29, 2004 11:54 pm</h4>
    <div class="postbody"><span class="postbody">For anyone interested, my address is:
<br/>
<br/>
Big Dummy
<br/>
123 Kikmehard St.
<br/>
Idiotsville
<br/>
<br/>
Please come over to my house and beat some sense into me, 'cause apparently I need it.
<br/>
<br/>
The extra '=' was the only thing I needed to accomplish my task as I set out to.  I feel so stupid.  Anyone who knows how to do anything in C should know that, right?  Thanks guys, this is becoming a bad habit for me.  Sigh, stupid little mistakes.  Tell you what, niltsair, if you're ever in my area, I owe you an ice cream.  Or a beer.  Whatever your poison is.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20012 - dagamer34 - Thu Apr 29, 2004 11:56 pm</h4>
    <div class="postbody"><span class="postbody">Your code would be a lot easier to read if it were organized better. And you wouldn't make silly mistakes either.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20015 - mymateo - Fri Apr 30, 2004 2:20 am</h4>
    <div class="postbody"><span class="postbody">I'm all open for suggestions on organization; however, you should know that I didn't preview my message.  The actual source code is indented to make it much easier to read.
<br/>
<br/>
This is how the PutPixel function SHOULD have looked: (I have used underscores as spaces turn out to do NOTHING on this board... html, grr)
<br/>
<br/>
--- BEGIN ---
<br/>
void PutPixel(u8 pX,u8 pY,u16 C) 
<br/>
{ 
<br/>
__int x,y,TempX; 
<br/>
__x = 0; 
<br/>
__for (y = 0; y &lt; pX; y++) 
<br/>
__{ 
<br/>
____x = 1 - x; // Switches between "1" and "0" alternating -- Fake binary 
<br/>
__} 
<br/>
__TempX = pX / 2; //Change to "TempX = pX;" and see what happens! 
<br/>
__if (x = 0){videoBuffer[(pY * 120) + TempX] = C | 0 &lt;&lt; 8; } // First pixel 
<br/>
__if (x = 1){videoBuffer[(pY * 120) + TempX] = 0 | C &lt;&lt; 8; } // Second pixel 
<br/>
__//For some reason, the result looks like "x" is ALWAYS 1 no matter what... 
<br/>
}
<br/>
--- END ---
<br/>
<br/>
An, of course, since I've started using Ultra Edit, the color coding and (some) automatic corrections have made my life much easier.  Any other ideas on how to better organize, now that you know what I'm actually working with?  Thanks for your reply!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20017 - niltsair - Fri Apr 30, 2004 2:33 am</h4>
    <div class="postbody"><span class="postbody">Put your code in between (code) ..... (/code) and it'll keep it's tab. Just replace the () by [] for it to work.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
