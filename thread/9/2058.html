<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>What is ALIGN4? (MapEd 095) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > What is ALIGN4? (MapEd 095)</h2>
<div id="posts">
<div class="post">
    <h4>#10662 - goro - Thu Sep 11, 2003 6:53 pm</h4>
    <div class="postbody"><span class="postbody">Why does this map editor put ALIGN4 in all the output files?
<br/>
<br/>
Can it safely be removed?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//  File generated by: Map Ed v0.95 Lite
<br/>
<br/>
E.g.
<br/>
// width: 32     height: 32
<br/>
const u16 maplay1_map[1024]ALIGN4 = {
<br/>
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
<br/>
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
<br/>
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0001,0x0002,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
<br/>
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x000</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10663 - Nessie - Thu Sep 11, 2003 7:06 pm</h4>
    <div class="postbody"><span class="postbody">You'll typically get faster data access if you know that the data array is aligned to a 2, 4, or 8 byte boundary in memory, the exact alignment depending largely on the processor in question.
<br/>
<br/>
Some compilers might automatically make this optimization...some compilers have it as a compile time optimization flag you can set...etc.
<br/>
<br/>
Maybe someone else can explain it better than I can, but yeah, it isn't  necessary if you could care less about the memory alignment.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10675 - DekuTree64 - Fri Sep 12, 2003 2:43 am</h4>
    <div class="postbody"><span class="postbody">If you want to, for example DMA in your data 32 bits at a time, but have it defined as a u16 array, you should specifically align it. I had some scrambled graphics from that once. In GCC, use
<br/>
#define ALIGN4 __attribute__((aligned (4)))<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10680 - goro - Fri Sep 12, 2003 10:18 am</h4>
    <div class="postbody"><span class="postbody">Lovely. Thanks for that.
<br/>
<br/>
So if I add the define I won't get these syntax errors.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">C:/PROJECTS/GBA/5/palOut.h:4: syntax error before `=' token 
<br/>
In file included from C:/PROJECTS/GBA/5/5.cpp:10:</td> </tr></table><span class="postbody">
<br/>
<br/>
btw -I had to rename the .cpp files to .h because MS Visual Studio refuses to link external files for me :(
<br/>
<br/>
Nessie : Could you set MapEd to automatically add the define to the header file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10684 - Nessie - Fri Sep 12, 2003 3:51 pm</h4>
    <div class="postbody"><span class="postbody">One thing I've been working on is a customization feature for exporting.  
<br/>
<br/>
It will let you set the export filenames, default #includes, and probably a few other things....I'll probably set up the array declaration line so that it can be customised however you'd like (palette Array example shown)...you just specify the format similar to how you would with a printf format.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">"const  %dataType%  bg%mapName%Palette[%arraySize%]ALIGN4 = {"
<br/>
   or
<br/>
"const  u16  bgPalette[%arraySize%] = \n{"
<br/>
   or
<br/>
(insert your own format here)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Would something like this be satisfactory?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10721 - goro - Sat Sep 13, 2003 10:54 am</h4>
    <div class="postbody"><span class="postbody">Absolutely.
<br/>
<br/>
_Also exporting tiles.bmp would be nice too but I feel bad asking for these features because you have already provided an excellent tool to the community.
<br/>
<br/>
Thanks for a great tool, Nessie.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10735 - Nessie - Sat Sep 13, 2003 4:35 pm</h4>
    <div class="postbody"><span class="postbody">Exporting a tiles.bmp would be easy, though there will be something of an issue considering that the tiles will be using 16 colour mode.
<br/>
<br/>
Do I let the user pick a single 16 colour palette to draw the .bmp in?  Do I let the user pick a 256 colour palette (16 banks of 16 colours) and then export 16 different .bmp's...one for each possible colour combo?
<br/>
<br/>
So, because of this single issue, it's not something I'm going to tackle right now (or maybe ever) unless someone wants to pay me to add that feature. :)
<br/>
<br/>
Cheers</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10739 - tepples - Sat Sep 13, 2003 6:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Nessie wrote:</b></span></td> </tr> <tr> <td class="quote">Exporting a tiles.bmp would be easy, though there will be something of an issue considering that the tiles will be using 16 colour mode.
<br/>
<br/>
Do I let the user pick a single 16 colour palette to draw the .bmp in?</td> </tr></table><span class="postbody">
<br/>
You could probably let the user choose 16-color output or 256-color output. Some tile converters are happier with one or the other. Either way, if the user asks for 16-color tile data, you could have the program write a 16x16 pixel 256-color "palette.bmp".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10753 - Nessie - Sun Sep 14, 2003 5:38 pm</h4>
    <div class="postbody"><span class="postbody">Well, I have the export customization done.  It's maybe a lot more complex than I had hoped it would be, but it's also pretty dang flexible.
<br/>
<br/>
The thing I was hoping though, is if some people could offer to help test it out a bit?  (pretty please, heh) 
<br/>
<br/>
I don't want to put up an official build until it's been reasonably tested.  That's not to say that I haven't tested it...actually the opposite is true.  It's just that the code is very complex due to the flexibility it allows...that and this code integrates into the export optimizer code which was already extremely complex to being with...
<br/>
<br/>
So if you can offer your help, either PM me, email me, post here, blah, blah.  It would be most appreciated.
<br/>
<br/>
Cheers,
<br/>
Nessie</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
