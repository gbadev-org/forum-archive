<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Level compositor - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > Level compositor</h2>
<div id="posts">
<div class="post">
    <h4>#31578 - Steve++ - Sun Dec 12, 2004 5:14 pm</h4>
    <div class="postbody"><span class="postbody">I've been searching the forum for ideas for my game and its level editor. I came across this, by tepples:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The WRONG way to design a map editor for a side-view or top-view game is to make a 2D array of what hardware tiles are displayed in what positions. 
<br/>
<br/>
The RIGHT way to design a map editor:
<br/>
Decide what the objects in your game world will be.
<br/>
Decide what they will look like.
<br/>
Create a representation for a list of objects in a level. This representation will depend on characteristics of your target platforms' display systems.
<br/>
Given such a list, decide how to draw them to the display. This code is your compositor.
<br/>
Implement your compositor on both a workstation GUI platform (wxWidgets, GTK+, Allegro, SDL, Qt, or the like) and your target platform(s) (GBA, J2ME, J2SE for Applets, or the like).
<br/>
Make a PC program that lets the user edit the list of objects and draws them to the screen after each edit.</td> </tr></table><span class="postbody">
<br/>
So far I've been thinking about the WRONG way. I like the sound of the RIGHT way. It reminds me of The Last Ninja (C64), although it didn't have scrolling.
<br/>
<br/>
Anyway, I was wondering what approach would be best (most viable) for a compositor on the GBA:
<br/>
1. Generate large tilemaps at the start of each level/room. This requires the tilemaps to live in RAM.
<br/>
2. Render the level on-the-fly. Could be too CPU intensive.
<br/>
<br/>
I'm particularly interested in method #2, because it requires the least RAM usage. I'm just not sure about the best way to go about it. Any ideas?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31579 - tepples - Sun Dec 12, 2004 5:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Steve++ wrote:</b></span></td> </tr> <tr> <td class="quote">So far I've been thinking about the WRONG way. I like the sound of the RIGHT way. It reminds me of The Last Ninja (C64), although it didn't have scrolling.</td> </tr></table><span class="postbody">
<br/>
I apologise. I was a bit Mariocentric in that comment.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Anyway, I was wondering what approach would be best (most viable) for a compositor on the GBA:
<br/>
1. Generate large tilemaps at the start of each level/room. This requires the tilemaps to live in RAM.
<br/>
2. Render the level on-the-fly. Could be too CPU intensive.</td> </tr></table><span class="postbody">
<br/>
NES games typically rendered the level on the fly.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'm particularly interested in method #2, because it requires the least RAM usage. I'm just not sure about the best way to go about it. Any ideas?</td> </tr></table><span class="postbody">
<br/>
One way to make a world is as a grid of metatiles (look them up on Google if you don't know what they are). For each metatile, store several hardware tile numbers plus collision data.
<br/>
<br/>
Another way is to download some NES game editors and play with them in order to get a feel for the map data models used in those games. The "object oriented" approach I described applies to Super Mario World.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31614 - Steve++ - Mon Dec 13, 2004 2:42 am</h4>
    <div class="postbody"><span class="postbody">Thanks tepples. I was hoping you'd reply.
<br/>
<br/>
It seems a grid of metatiles is too constraining. For instance, if the cell size was 4x4 tiles, every object would need to be aligned by four tiles. I'm trying to think of a good scheme whereby objects only need to be aligned by one (hardware) tile. It needs to be fast. I was thinking of dividing the whole level into a grid with a cell size of, let's say, 8x8 tiles. The maximum object size would also be 8x8 tiles; each object would live in one, two or four cells. It should be easy enough to look at which cells are onscreen and, by looking at these cells, decide what to draw. The only problem I forsee is that of overlapping objects in the same BG layer, which just wouldn't work. Obviously, the editor I'm making will have to sort that out.
<br/>
<br/>
I should also talk to my level designer about the requirements. The problem is, until I have a working editor, he'll be fishing most of the time (uncontactable).
<br/>
<br/>
Any suggestions, especially from people who have attempted this sort of thing, are welcome.
<br/>
<br/>
Thanks again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31623 - sajiimori - Mon Dec 13, 2004 4:15 am</h4>
    <div class="postbody"><span class="postbody">Make your artist's day: tell him he can use Photoshop, as long as he's careful to keep a lot of redundancy along tile boundaries.  Then let your tools break up the images into map and pixel data.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31628 - Steve++ - Mon Dec 13, 2004 5:38 am</h4>
    <div class="postbody"><span class="postbody">An intriguing idea, but we don't have photoshop or psp. The only thing I've got is GraphicsGale. I'd rather settle on a format and then build a custom editor for it. Java's my friend. :)
<br/>
<br/>
Between posts I've been playing with various ideas. For instance, for the sake of avoiding palette headaches from importing tile data from bitmaps, I was going to have a colour quantisation process that takes place as part of the data export function. That would allow everything to be edited in 15-bit colour, yet the user would always be made aware of how many unique colours are being used for each level. Now I'm thinking that the quantisation process could take place in-game at the start of each level. The downside is that tiles will require 15 bits of storage per pixel. The upside is that if there are a lot of tiles that are common to a lot of levels, they don't get duplicated for (almost) every level in which they appear.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31631 - tepples - Mon Dec 13, 2004 6:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Steve++ wrote:</b></span></td> </tr> <tr> <td class="quote">Now I'm thinking that the quantisation process could take place in-game at the start of each level. The downside is that tiles will require 15 bits of storage per pixel.</td> </tr></table><span class="postbody">
<br/>
And it'll be dog slow. Real commercial games do the color quantization at compile time.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31634 - Steve++ - Mon Dec 13, 2004 7:32 am</h4>
    <div class="postbody"><span class="postbody">Perhaps I could make the editor restrict the number of colours per level to 255 (by way of restricting addition of further objects). Instead of run-time quantisation, it would simply require runtime palette and tile creation. I can't imagine that being too slow. I would just need an assert until the final build.
<br/>
<br/>
The only other alternative I can think of is some crazy edit-time quantisation algorithm that weeds out as many real duplicate tiles as possible. I would be tearing my hair out for weeks.
<br/>
<br/>
As far as the overlapping problem goes (mentioned earlier), I could probably use two hardware layers as for the foreground. Somehow I can't see four levels of parallax happening; that's just excessive.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31760 - sgeos - Tue Dec 14, 2004 8:48 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Steve++ wrote:</b></span></td> </tr> <tr> <td class="quote">An intriguing idea, but we don't have photoshop or psp. The only thing I've got is GraphicsGale.</td> </tr></table><span class="postbody">
<br/>
You could download the gimp.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31805 - sgeos - Tue Dec 14, 2004 9:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Steve++ wrote:</b></span></td> </tr> <tr> <td class="quote">Somehow I can't see four levels of parallax happening; that's just excessive.</td> </tr></table><span class="postbody">
<br/>
You probably want to save a layer for the HUD or a special effect (fog).  The HUD could be done with sprites.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31820 - tepples - Tue Dec 14, 2004 11:54 pm</h4>
    <div class="postbody"><span class="postbody">Sega Genesis games typically drew the HUD with sprites, using one layer for the playfield and one for the parallax background. It's even more practical to draw a HUD with sprites on the GBA, given the fast transfers to VRAM and the increased amount of VRAM (96 KB, with 32 KB dedicated to sprites, vs. 64 KB of Super NES and Sega Genesis).
<br/>
<br/>
And I second the recommendation of GIMP.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
