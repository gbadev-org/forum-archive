<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>problems! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > problems!</h2>
<div id="posts">
<div class="post">
    <h4>#16744 - darknet - Tue Feb 24, 2004 7:10 am</h4>
    <div class="postbody"><span class="postbody">I know this question has been asked numerous times across the forums, and I have read every answer that I believe is available so here goes:
<br/>
<br/>
I want  a splash screen for my project. A background along with 2 sprites; 1 for 'Start new game' and the other for 'load new game'
<br/>
<br/>
I am in mode 4 and have initalized everything properly. However, no matter what I do I cannot get the sprites to be transparent over the background. Here is a checklist of things I have done:
<br/>
<br/>
-Checked the entry at the beginning of all the palettes were black, created a .pcx file with a black background + white text
<br/>
<br/>
-Have all the proper dimensions and bits set correctly for both the sprite and the background image.
<br/>
<br/>
-Started the sprite at 512 since mode 4 uses 0-511
<br/>
<br/>
Any help would be greatly, greatly appreciated. Below is a snipet of my code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
 setMode(OBJ_MAP_1D | MODE_4 | OBJ_ENABLE | BG2_ENABLE);
<br/>
 
<br/>
  //Load the sprites palette
<br/>
 int loop = 0;
<br/>
 for(loop = 0; loop&lt;256; loop++) {
<br/>
    SpritePal[loop] = startNewPalette[loop];
<br/>
<br/>
 }
<br/>
 
<br/>
 initalizeSprites();
<br/>
<br/>
 unsigned char attrs = 0; //0 is the first set of attrs
<br/>
 
<br/>
 sprites[attrs].attr0 = COLOR_256 | TALL | y;
<br/>
 sprites[attrs].attr1 = SIZE_64 | x;;
<br/>
 sprites[attrs].attr2 = 512;
<br/>
 
<br/>
 //now that its setup, copy the sprite data to char memory
<br/>
 int x_loop = 0;
<br/>
 
<br/>
 //now copy in the sprites bitmap.
<br/>
 for(x_loop = 8192; x_loop &lt; 8320; x_loop++) {
<br/>
   SpriteData[x_loop] = startNewData[x_loop-8192];
<br/>
}
<br/>
<br/>
for(int n = 0; n&lt;256; n++) {
<br/>
    BGPaletteMem[n] = splash_Palette[n];
<br/>
}
<br/>
<br/>
    memcpy(videoBuffer, splash_Bitmap, 38400);
<br/>
<br/>
while(1) {
<br/>
<br/>
    getInput();
<br/>
    moveSprite(&amp;sprites[0], x,y);
<br/>
    waitVSync();
<br/>
    updateSpriteMemory();
<br/>
    
<br/>
}
<br/>
 
<br/>
 return 0;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16748 - sajiimori - Tue Feb 24, 2004 7:47 am</h4>
    <div class="postbody"><span class="postbody">If the sprites appear at all, then your code is not the problem.  When you open VBA's tile viewer and find your sprite tiles, you will see that your intended background pixels are not color 0 (though they may be black).  You must fix your data so the background uses color 0.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16750 - darknet - Tue Feb 24, 2004 8:15 am</h4>
    <div class="postbody"><span class="postbody">First off thank you very much for the quick reply.
<br/>
<br/>
Its good to hear that my code is not the problem =)
<br/>
<br/>
However, I apologize for my ignorance, but how would I go about following your suggestion?  I am using photoshop 7.0 to create my sprites + backgrounds, and I'm coverting the background with gfx2gba and the sprite with pcx2sprites (pcx2gba).
<br/>
<br/>
So in short, how would I go about with that fix?
<br/>
<br/>
Thanks again,
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16758 - tepples - Tue Feb 24, 2004 4:20 pm</h4>
    <div class="postbody"><span class="postbody">You need to use an image editor that can control which color ends up as color 0. Such image editors include at least GIMP and Graphics Gale. For example, in GIMP, color 0 is the color of the pixel in the upper-left corner when you convert an image to indexed mode.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16763 - ScottLininger - Tue Feb 24, 2004 6:14 pm</h4>
    <div class="postbody"><span class="postbody">Photoshop's palette manipulation is one of its few weak points, but the idea of learning GIMP or anything else if you're already comfortable in Photoshop is kind of a pain.
<br/>
<br/>
Here's the only way I have found to reliably get Photoshop to dump your "transparent" pixels out as palette entry 0:
<br/>
<br/>
1. Build your sprite in RGB with Photoshop transparency (not black!) where you want the sprite transparency. Make sure that your pixels are either 100% transparent or 100% solid.
<br/>
<br/>
2. Convert the sprite image to indexed color (IMAGE &gt; MODE &gt; INDEXED COLOR) with the following settings:
<br/>
<br/>
PALETTE: Local Adaptive
<br/>
COLORS: 256 colors
<br/>
FORCED: None
<br/>
TRANSPARENCY: Checked
<br/>
MATTE: None
<br/>
DITHER: Whatever you want
<br/>
<br/>
3. Save as a .PCX and convert using your tools
<br/>
<br/>
<br/>
Once you've done it to your first sprite, all subsequent sprites should be converted using IMAGE &gt; MODE &gt; INDEXED COLOR, with PALETTE set to "Previous," which will apply the palette Photoshop calculated from your first sprite. Of course, this means that your first sprite needs to contain a complete range of colors from ALL of your subsequent sprites.
<br/>
<br/>
I always build one large image that is a collage of all sprites to convert first. That way you get the best color range across all of them.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16764 - johnny_north - Tue Feb 24, 2004 6:17 pm</h4>
    <div class="postbody"><span class="postbody">I hope these instructions will help you (ps 6.0 but should work for ps 7.0)
<br/>
<br/>
Open your sprites in ps.
<br/>
Both should be using indexed color.
<br/>
Inspect the color table for both images.
<br/>
Make sure that each sprite's palette has the same RGB value in the palette's 0 position (this can be RGB(0,0,0) but any color will work as long as all of your sprites are using the same color in palette position 0).
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">For example, in GIMP, color 0 is the color of the pixel in the upper-left corner when you convert an image to indexed mode.</td> </tr></table><span class="postbody">
<br/>
<br/>
I believe this is what ps does as well, because it usually seems to pick the correct transparent color for your image.
<br/>
<br/>
Convert the sprite temporarily to an RGB image.
<br/>
Convert the sprite back to an indexed color image.
<br/>
A dialog box will open with color selection options.
<br/>
In the dialog box, select to convert the image using the LOCAL ADAPTIVE option. 
<br/>
You may optionally reduce the number of colors in your final image here.
<br/>
Under forced colors, select CUSTOM.
<br/>
In the CUSTOM palette, set palette 0 to the RGB you want to be transparent in your sprite.
<br/>
All of the rest of the entries should be blank (greyed out - no selected color).
<br/>
Apply the changes to the CUSTOM palette. 
<br/>
Apply the conversion to your sprite.
<br/>
Repeat for each sprite.
<br/>
<br/>
Now re-inspect the indexed palette, especially entry 0 for each sprite. 
<br/>
Each indexed colored sprite should have the same RGB color in palette entry 0.
<br/>
If not repeat the above process.
<br/>
Save the sprites as .bmp files. gfx2gba 1.13 will take both .pcx and .bmp, but I have experienced problems with .pcx files
<br/>
<br/>
Use gfx2gba 1.3 by markus (there are 2 different gfx2gba by different authors)  to convert the sprites. Options in the readme, but here's a sample:
<br/>
<br/>
gfx2gba -fsrc -m -pbasepal.pal -t8 sprite1.bmp sprite2.bmp &gt;&gt;bgfxlog.txt
<br/>
<br/>
gfx2gba will optimize and collect all of your colors into a single basepal.
<br/>
<br/>
Note: If all of your sprites contain more that 256 unique colors, gfx2gba will fail.
<br/>
<br/>
I admit that some of these step may not be necessary, but following them all should help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16765 - ScottLininger - Tue Feb 24, 2004 6:22 pm</h4>
    <div class="postbody"><span class="postbody">Oh, then there's the quick and dirty fix...
<br/>
<br/>
You can always open your header files and replace whatever color photoshop has dumped out with 00. You just need to find the palette entry number that photoshop chose.
<br/>
<br/>
So for example, if your image array looks like...
<br/>
<br/>
const u16 SpriteData[] = {
<br/>
                    0x5353, 0x3453, 0xAAA0, 0x54AB, 0x654A, ...
<br/>
<br/>
And you know that your first pixel is supposed to be a transparent one, do a text search and replace for "0x53" and replace it with "0x00" then do a search and replace for "53," with "00,".
<br/>
<br/>
You need to do 2 search and replaces because each 16-bit number in the array is actually 2 pixels. Also, if your gfx2sprite tool dumps the palette into the same header file, be careful NOT to do the search across the palette array, or you may garble up some of your colors.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16766 - johnny_north - Tue Feb 24, 2004 6:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You can always open your header files and replace whatever color photoshop has dumped out with 00. You just need to find the palette entry number that photoshop chose. </td> </tr></table><span class="postbody">
<br/>
<br/>
Aye, gfx2gba seems to dump the wrong color 0 if you're converting with .pcx files, or not using the LOCAL ADAPTIVE option in conversion.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16798 - darknet - Wed Feb 25, 2004 4:27 am</h4>
    <div class="postbody"><span class="postbody">Thank you all for your words of wisdom but..
<br/>
<br/>
I have followed all of your instructions and still I am seeing a small black sprite on top of my background image.
<br/>
<br/>
-I have ran checks for the 0th position in the palette in 3 or 4 different graphics programs, still shows it being 0x0000, but  black still shows up in my image,
<br/>
<br/>
I have tried using different background images, and that did not work either. The same goes for creating new sprites in every which way
<br/>
<br/>
I have ran this on two emulators (VBA / Boycott) and hardware, and the same thing results each time.
<br/>
<br/>
The only thing I can think of now is that it may be a problem with my loop through the palette? Here's my sprite loading code again...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int main() {
<br/>
<br/>
 setMode(OBJ_MAP_1D | MODE_4 | OBJ_ENABLE | BG2_ENABLE);
<br/>
 
<br/>
  //Load the sprites palette
<br/>
 int loop = 0;
<br/>
 for(loop = 0; loop&lt;256; loop++) {
<br/>
    SpritePal[loop] = loadPalette[loop];
<br/>
 }
<br/>
 
<br/>
 initalizeSprites();
<br/>
<br/>
 unsigned char attrs = 0; 
<br/>
 
<br/>
 unsigned short char_number = 512;
<br/>
 
<br/>
 sprites[attrs].attr0 = COLOR_256 | SQUARE | y;
<br/>
 sprites[attrs].attr1 = SIZE_64 | x;;
<br/>
 sprites[attrs].attr2 = char_number;
<br/>
 
<br/>
 int x_loop = 0;
<br/>
 
<br/>
 for(x_loop = 8192; x_loop &lt; 8320; x_loop++) {
<br/>
   SpriteData[x_loop] = loadData[x_loop-8192];
<br/>
}
<br/>
<br/>
for(int n = 0; n&lt;256; n++) {
<br/>
    BGPaletteMem[n] = splash_Palette[n];
<br/>
}
<br/>
 memcpy(videoBuffer, splash_Bitmap, 38400);
<br/>
<br/>
while(1) {
<br/>
<br/>
    getInput();
<br/>
    moveSprite(&amp;sprites[0], x,y);
<br/>
    waitVSync();
<br/>
    updateSpriteMemory();
<br/>
    
<br/>
}
<br/>
 
<br/>
 return 0;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16799 - tepples - Wed Feb 25, 2004 4:47 am</h4>
    <div class="postbody"><span class="postbody">Run your program in VisualBoyAdvance and use its tools:<ol type="1"><li>Palette Viewer, to make sure the palette gets loaded</li><li>Tile Viewer, to make sure the sprite cels get loaded at the locations where you expect</li><li>OAM Viewer, to make sure the right sprite cel gets placed with the right palette at the right location</li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16804 - darknet - Wed Feb 25, 2004 5:13 am</h4>
    <div class="postbody"><span class="postbody">Thanks very much for the quick reply, here's the results of your inqueries.
<br/>
<br/>
1. In the palatte Viewer, the proper palette is being loaded!
<br/>
<br/>
2. In the OAM Viewer, the correct positon of the sprite is showing up, however all that comes up in the palette is black, hence why its all black.
<br/>
<br/>
3. In looking at the tile viewer, I assume that my sprite should be loading up in VRAM at location 0x600200 (since I am in mode 4 and its starting at position 512 which is +200 away in VRAM in hex correct?), and once again, it is not. Instead, the background is being painted at that location.
<br/>
<br/>
So I do see the errors and why its coming up the way it is. However, the palette is loaded, that much is certain. How would I go about figuring out why everything else is not loading properly in the right places?
<br/>
<br/>
Any response is appreciated-Thanks a lot,
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16809 - zerosynapse - Wed Feb 25, 2004 10:17 am</h4>
    <div class="postbody"><span class="postbody">Why not simply use a package such as DPaint or its Windows "updated" equivalent such as Promotion? This will give you 256 colour images to work with and obviously full control of the palette.
<br/>
<br/>
Zer0 - Industry Artist<br/>_________________<br/><a class="postlink" href="http://www.putang.co.uk/" target="_blank"> GALLERY Section here - </a><a href="http://www.putang.co.uk" target="_blank">www.putang.co.uk</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16825 - johnny_north - Wed Feb 25, 2004 4:47 pm</h4>
    <div class="postbody"><span class="postbody">Alright Mike, I'll give it one more shot:
<br/>
<br/>
Please post the following:
<br/>
<br/>
A small section of one of your sprite's source - starting from the first line including the delaration and definition of the array.
<br/>
<br/>
The address of SpritePal.
<br/>
<br/>
Hopfully we'll be able to rule out a couple of things, because your last post is somewhat ambiguous in that:
<br/>
<br/>
The palette viewer contains 2 palettes, and you did not specify which palette the colors were being loaded into. We're all assuming it's the sprite but, hey you can't take certain things for granted in a debug situation.
<br/>
<br/>
You refer to the palette in the OAM viewer, but of course you're only getting palette info indirectly by looking at the colors of the tiles.
<br/>
<br/>
"Instead, the background is being painted at that location." Assume you mean that a background tile (bitmap) data exists at the address of your first sprite tile. We're missing some info somewhere.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16922 - darknet - Fri Feb 27, 2004 3:36 am</h4>
    <div class="postbody"><span class="postbody">Thanks so very much johnny_north for all your help on this issue...Here are all the specifics I left out before:
<br/>
<br/>
The important sprite defines:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define SpriteMem ((unsigned short*)0x7000000) //OAM state address
<br/>
#define SpriteData ((unsigned short*)0x6010000) //OAM image address
<br/>
#define SpritePal ((unsigned short*)0x5000200) //OAM palette address
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Here's a snippet of my header file:
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const unsigned short loadData[] = {
<br/>
                    0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD,
<br/>
                    0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD,
<br/>
                    0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD,
<br/>
                    0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 0xFDFD, 
<br/>
                                              .
<br/>
                                              .
<br/>
                                              .
<br/>
const unsigned short loadPalette[] = {
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                                           .
<br/>
                                           . 
<br/>
                                           .
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x13E0, 0x0000,};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The actual picture that is supposed to display is the word 'Load' in green text over the black background that I am trying to make transparent.
<br/>
<br/>
And to answer your question, in VBA's palette viewer the background image is being properly loaded in the background palette and the sprite is being properly loaded in the sprite palette. The problems aforementioned before still apply though ( the OAM viewer shows the right position information for the sprite but only displays all black in the palette).
<br/>
<br/>
The only thing I can at this point think of is that my loop through the palette or OAM is messed up. However, my code is a direct translation from the Pern Project with my custom images being the only real difference. i even use his pcx2gba tool!
<br/>
<br/>
In any case, with the code displayed below I hope i have gathered together enough information for a diagnosis. 
<br/>
<br/>
Thanks again to anyone reading this post and even thinking about a response =)
<br/>
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16924 - poslundc - Fri Feb 27, 2004 4:48 am</h4>
    <div class="postbody"><span class="postbody">Your data for the sprite seems to be using colour #253 of your palette (0xFD). It is unclear whether entry #253 of your palette is green or not (since you didn't include the whole palette, we can't tell), but it looks like it might actually be entry #254 that is green, and NOT entry #253 - depending on how your conversion program outputs its palettes.
<br/>
<br/>
(This would be consistent with you having the correct OAM values and the correct palette, but apparent blackness in the tile data.)
<br/>
<br/>
To correct it, you can change the entry in the palette before the occurrence of 0x13F0 so that it is also 0x13F0.
<br/>
<br/>
I could be wrong; it is impossible to know for sure.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16936 - ScottLininger - Fri Feb 27, 2004 5:24 pm</h4>
    <div class="postbody"><span class="postbody">I still think it's a problem with your conversion tool outputting the wrong palette entry for the transparent pixels. Each element of your loadData array describes two pixels with a palette entry between 0 and 255.  
<br/>
<br/>
Palette entry #0 is transparent regardless of the actual color that is stored in loadPalette[0]. Every other palette entry will display as a solid color, even if that color is Ox0000 (black).
<br/>
<br/>
Like poslundc pointed out, all of those 0xFDFD entries are referencing palette #253, which is black in your palette. 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const unsigned short loadPalette[] = { 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
<br/>
                                           . 
<br/>
                                           . 
<br/>
                                           . 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x13E0, 0x0000,};</td> </tr></table><span class="postbody">
<br/>
<br/>
counting backwards from the end of your array...
<br/>
<br/>
255 (last entry) contains 0x0000 (black)
<br/>
254 contains 0x13E0 (green)
<br/>
253 contains black
<br/>
<br/>
All of those 'FD' entries (hexadecimal for 253) in your loadData are telling the GBA to display color #253. Which is black. Only #0 will be transparent.
<br/>
<br/>
What you want to see is...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const unsigned short loadData[] = { 
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, etc
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
See the examples above for how to fix it.
<br/>
<br/>
Cheers,
<br/>
<br/>
Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16945 - johnny_north - Fri Feb 27, 2004 8:06 pm</h4>
    <div class="postbody"><span class="postbody">I agree with both Scott and Dan. The conversion tool you're using is suspect (this might also result from the bitmap being the wrong depth). Also, I think that if your conversion tool actually created the part of the loadData[] you posted:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">0x0000, 0x0000, 0x0000, 0x0000, 0x13E0, 0x0000,};</td> </tr></table><span class="postbody">
<br/>
<br/>
Then there is definitely a problems because of the trailing comma within the curly braces - although this my be your own edit.
<br/>
<br/>
If you decide to use gfx2gba by marcus, I would be able to walk you through the command line options to get exactly what you want.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16983 - darknet - Sat Feb 28, 2004 6:33 am</h4>
    <div class="postbody"><span class="postbody">Thanks again everyone for your time...
<br/>
<br/>
The conversion program I was using was PCX2GBA. It seems pretty popular around these parts but since I have tried marcus' gfx2gba...heres the results:
<br/>
<br/>
The good news: I finally got the graphic to show up transparent!!!! YES!!
<br/>
<br/>
The bad news: now the image comes out rather mangled looking. 
<br/>
<br/>
To ENSURE it was not my code that was the problem, I took someone elses graphic array and plugged it in to my project and it worked fine. So the problem DOES LIE in me actually converting the graphic files or actually creating the graphic files.
<br/>
<br/>
Here's the command I use for gfx2gba with my image being a 32x16  bitmap still w/black as the transparency (which is ok now..)
<br/>
<br/>
gfx2gba -D -fsrc -pstart.pal -t8 start.bmp
<br/>
<br/>
Here's a small snippet of what it outputs...
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const unsigned char start_Bitmap[512] = {
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 
<br/>
0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x01, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 
<br/>
0x01, 0x00, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x00, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 
<br/>
0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x01, 
<br/>
0x00, 0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 
<br/>
0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
<br/>
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
};
<br/>
<br/>
const unsigned short start_Palette[256] = {
<br/>
0x0000, 0x001f, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
<br/>
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
<br/>
};
<br/>
//note the rest of the palette is 0x0000
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The image is a black background with 'start' typed in RED. The output turns out to be a vertical red block of nothing....
<br/>
<br/>
Is the command I am using the proper one for gfx2gba?
<br/>
<br/>
Thanks again for all of your time,
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16984 - yaustar - Sat Feb 28, 2004 9:00 am</h4>
    <div class="postbody"><span class="postbody">This was from your last code snippet where you forgot to delcare it WIDE although this was in your first post in this thread
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[attrs].attr0 = COLOR_256 | SQUARE | y;
<br/>
 sprites[attrs].attr1 = SIZE_64 | x;;
<br/>
 sprites[attrs].attr2 = char_number; </td> </tr></table><span class="postbody"> to
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[attrs].attr0 = COLOR_256 | SQUARE | y | WIDE;
<br/>
 sprites[attrs].attr1 = SIZE_64 | x;;
<br/>
 sprites[attrs].attr2 = char_number; </td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16985 - josath - Sat Feb 28, 2004 10:11 am</h4>
    <div class="postbody"><span class="postbody">Woah there, I don't think you want square and wide at the same time!
<br/>
<br/>
try this for attribute 0:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[attrs].attr0 = COLOR_256 | WIDE | y;</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16986 - darknet - Sat Feb 28, 2004 10:41 am</h4>
    <div class="postbody"><span class="postbody">All the attribuite stuff is just fine. I plugged in other people's graphics into my project and they worked. I however, for my project need to be able to create and convert properly. From what i see (and what this thread discusses), I am not doing anything wrong..
<br/>
<br/>
Any suggestions would be great.
<br/>
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16994 - yaustar - Sat Feb 28, 2004 2:31 pm</h4>
    <div class="postbody"><span class="postbody">Is this what your sprite looks like at the moment?
<br/>
<a href="http://madsims.net/~yaustarc/misc/gbaev.gif" target="_blank">http://madsims.net/~yaustarc/misc/gbaev.gif</a>
<br/>
<br/>
If it is then the data for the sprites has gone wrong.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17016 - darknet - Sat Feb 28, 2004 11:21 pm</h4>
    <div class="postbody"><span class="postbody">...except that its transparent, but the mangled image is EXACTLY what is happening.
<br/>
<br/>
The natural question is then, how is the data becoming corrupted and how to fix it? Both of the popular tools (gfx2gba + pcx2gba-but the latter has that black background attached as well) have been giving me these results. 
<br/>
<br/>
Funny thing though--just for kicks I wrote a small amount of HAM lib code to display the sprite and it displays fine.....??!? I checked all of the parameters and made sure they matched up with my code...which they do.
<br/>
<br/>
But thats a side note I suppose. Thanks a lot for the reply, any further detail would be greatly appreciated.
<br/>
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17020 - dagamer34 - Sun Feb 29, 2004 12:19 am</h4>
    <div class="postbody"><span class="postbody">Just so you know, I was only able to get pcx2gba working when I used Paint Shop Pro 8. I think it also works with Adobe PhotoShop 7.0 and the GIMP. Try one of those if you aren't using them already.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17031 - darknet - Sun Feb 29, 2004 8:50 am</h4>
    <div class="postbody"><span class="postbody">nothing. The sprites still come out mangled EXACTLY the way yaustar shows they do. The data is going wrong
<br/>
<br/>
Regardless of the graphics program I use (i've used em' all), that is what happens.
<br/>
<br/>
I thank everyone again for my continual questioning on this subject, but If i can't draw sprites, then I will not have a game, so this is important to me.
<br/>
<br/>
Any help on yaustar's comment or anything else anyone has experienced on this matter is greatly appreciated.
<br/>
<br/>
Thanks in advance,
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17033 - tepples - Sun Feb 29, 2004 8:59 am</h4>
    <div class="postbody"><span class="postbody">Have you tried using a direct tile data editor such as <a class="postlink" href="http://www.pineight.com/pc/#ted" target="_blank">this one</a>? Have you tried manually coding sprite data and then, from what you learned, writing your own converter?
<br/>
<br/>
Looks like you could be using your converter in "linear" mode when you should be using it in "tile" mode.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17048 - yaustar - Sun Feb 29, 2004 2:19 pm</h4>
    <div class="postbody"><span class="postbody">Can you email the actual image file you are using?
<br/>
<br/>
<a href="mailto:yaustar_8p@NOSPAMyahoo.co.uk">yaustar_8p@NOSPAMyahoo.co.uk</a> - remove no spam (PS try lowering the colour palette to 8bit (256 colours)<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17099 - darknet - Mon Mar 01, 2004 2:22 am</h4>
    <div class="postbody"><span class="postbody">I sent over the image...and a correction to the text in the e-mail's body --i meant vertical and not horizontal..
<br/>
<br/>
Thanks,
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17101 - yaustar - Mon Mar 01, 2004 3:35 am</h4>
    <div class="postbody"><span class="postbody">I notice it is a 32x8 sprite. Gba cannot do this size. resize the image to 32x16 and write
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[attrs].attr0 = COLOR_256 | WIDE | y;
<br/>
 sprites[attrs].attr1 = SIZE_32 | x;
<br/>
 sprites[attrs].attr2 = char_number;
<br/>
//32x16 I think</td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17105 - tepples - Mon Mar 01, 2004 5:01 am</h4>
    <div class="postbody"><span class="postbody">GBA sprite hardware can handle a 32x8 pixel sprite (wide, size 1). It just can't handle 64x8, 64x16, 8x64, or 16x64 without splitting the sprite into two or more.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17108 - darknet - Mon Mar 01, 2004 9:37 am</h4>
    <div class="postbody"><span class="postbody">After working forever and taking all of your comments into heavy consideration, I finally got proper transparent sprites!
<br/>
<br/>
Long story short, I create a photoshop a certain way and then make sure that palette index 0 is black in paint shop pro. Any attempt and doing something else for me seems to fail, so thats the method i will be using =)
<br/>
<br/>
Thanks very much everyone, you all helped me quite a bit. 
<br/>
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17110 - yaustar - Mon Mar 01, 2004 1:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">GBA sprite hardware can handle a 32x8 pixel sprite (wide, size 1). It just can't handle 64x8, 64x16, 8x64, or 16x64 without splitting the sprite into two or more.</td> </tr></table><span class="postbody">
<br/>
<br/>
*Reading Cowbite Spec again*
<br/>
oh ****. So it does.... :(<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
