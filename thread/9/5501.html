<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Map animation - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Graphics > Map animation</h2>
<div id="posts">
<div class="post">
    <h4>#40706 - ProblemBaby - Thu Apr 21, 2005 6:35 pm</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
Ive started to develop a game with a perspective like zelda 3
<br/>
and Ive to make a good plan how to solve everything.
<br/>
My first problem is map animation..
<br/>
Is it ever used?
<br/>
or is such things replaced with sprites?
<br/>
<br/>
But what about water and such stuff that can take up a lot of the screen then which method is best?, change the tile- or the map data?
<br/>
and what about a torches? if its 24 in one room, and 1 in another.
<br/>
<br/>
<br/>
I need to come up with some standard, when to do what, can someone help me out?
<br/>
And do you have a nice mapeditor to recommend for this purpose?
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40708 - Kyoufu Kawa - Thu Apr 21, 2005 7:13 pm</h4>
    <div class="postbody"><span class="postbody">Go for tiles. It's what the big players use.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40715 - DekuTree64 - Thu Apr 21, 2005 7:53 pm</h4>
    <div class="postbody"><span class="postbody">Both work, and it usually depends on the type of game. For Zelda that has more ambient animations, I'd go with overwriting the tile data, because it's easier to code.
<br/>
<br/>
For something with more animations triggered by the player, swapping out an area of map data tends to work better. 
<br/>
For example, if you have 2 doors and you want one of them to open when the player touches it, you just swap out the map data where that door is. If you do it by tile data, you have to make sure each door uses all unique tiles, so overwriting one won't overwrite the other at the same time.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40717 - ProblemBaby - Thu Apr 21, 2005 8:27 pm</h4>
    <div class="postbody"><span class="postbody">Isnt it better in the door case or if the player lifts something from the map
<br/>
like a bush, that it turns into an object thas is animated, and then change the map data. to floor or ground. I think I will go for that.
<br/>
and change the tiledata for water and big things.
<br/>
Maybe it is best to unpack it to EWRAM so it just is to copy it without having to unpack it from ROM.
<br/>
<br/>
Then Ive another question about animation Ive find out that the player
<br/>
will need about 100 frames for all kind of moves and things he does.
<br/>
he is 24x16 = 6 tiles, 6 * 100 = 600 tiles and thats about half of the whole memory, so I cant copy everything to the sprite memory, so I wonder if the GBA is fast enough to copy all this data, if 6 characters is displayed for example ive to copy 36 tiles?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40719 - Lord Graga - Thu Apr 21, 2005 8:49 pm</h4>
    <div class="postbody"><span class="postbody">For such a large amount of frames, you will have to transfer every frame whenever you need it. Use a fast memory transfer function for it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55237 - Palamon - Mon Sep 26, 2005 8:54 pm</h4>
    <div class="postbody"><span class="postbody">I noticed this done for the metroid games, with the tile data for samus changing with every move.
<br/>
<br/>
What do you mean by a fast memory transfer function?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55238 - poslundc - Mon Sep 26, 2005 9:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Palamon wrote:</b></span></td> </tr> <tr> <td class="quote">What do you mean by a fast memory transfer function?</td> </tr></table><span class="postbody">
<br/>
<br/>
General ways to copy data:
<br/>
<br/>
1. Use a "for" or "while" loop.
<br/>
2. Use memcpy().
<br/>
3. Use the BIOS CpuCopy routine.
<br/>
4. Write an optimized ARM assembly routine and place it in IWRAM.
<br/>
5. Use the DMA.
<br/>
<br/>
Those are roughly in increasing order of speed, although depending on the circumstances there may be little or no difference, or even inversion of ranking.
<br/>
<br/>
<span style="font-weight: bold">Generally</span>, for less than 32 bytes of data or so it's not worth using 3-5. The DMA is useful but not always interrupt safe and is often the source of unexpected hardware "problems", and since it halts the CPU anyway it won't provide a tremendous speed boost over option 4.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59385 - Ultima2876 - Tue Nov 01, 2005 7:57 am</h4>
    <div class="postbody"><span class="postbody">Got any information on how one would go about doing number 4? ;P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59390 - Cearn - Tue Nov 01, 2005 10:59 am</h4>
    <div class="postbody"><span class="postbody">Try the routines in my <a class="postlink" href="http://user.chem.tue.nl/jakvijn/files/core_asm.s" target="_blank">core_asm.s</a> (can also be found among the latest tonc code). memcpy32 and memset32 are basically CpuFastSet with extra code for when the number of words isn't a multiple of 8. memcpy16 and memset16 adds code for alignment-safe u16 copies/sets.
<br/>
<br/>
For course, you do need to know work with assembly files. Use something like "arm-elf-as -mthumb-interwork core_asm.s -o core_asm.o" to assemble, and add the following declarations
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void memcpy32(void *dstv, const void *srcv, u32 wdcount) CODE_IN_IWRAM;
<br/>
void memset32(void *dstv, u32 wd, u32 wdcount) CODE_IN_IWRAM;
<br/>
<br/>
void memcpy16(void *dstv, const void *srcv, u32 hwcount);
<br/>
void memset16(void *dstv, u16 hw, u32 hwcount);
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59451 - ScottLininger - Tue Nov 01, 2005 9:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ultima2876 wrote:</b></span></td> </tr> <tr> <td class="quote">Got any information on how one would go about doing number 4? ;P</td> </tr></table><span class="postbody">
<br/>
<br/>
Don't worry about #4 until you get it working in simple C. Performance might not be great, but you want to make sure you understand the logic and have some reliable code. Then you can worry about optimization.
<br/>
<br/>
:)
<br/>
<br/>
Scott</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
