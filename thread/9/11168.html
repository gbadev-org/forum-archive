<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem with colors of the 2nd Background - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Graphics > Problem with colors of the 2nd Background</h2>
<div id="posts">
<div class="post">
    <h4>#102813 - chewtoy11 - Sun Sep 17, 2006 5:55 am</h4>
    <div class="postbody"><span class="postbody">I've done some preliminary searching for how to fix this, but I'm running out of places to look.
<br/>
<br/>
I'm using background mode 0, and trying to get both of my backgrounds (both 256x256) to display properly.  I can get both backgrounds displaying, and I'm even getting transparency to work fine.  The problem is that the 2nd background's colors are displaying improperly.  The first bg's colors are fine.
<br/>
<br/>
I know both backgrounds are supposed to use the same palette, so I made a palette in Adobe Photoshop, and have been consistently using it for any BMPs that I save.  The BMPs look fine when I preview them, load them up in Photoshop, and even in HAM's Map Editor.
<br/>
<br/>
I'm using gfx2gba to convert the images with this command:
<br/>
<br/>
gfx2gba -t8 -fsrc bg0-tileset.bmp
<br/>
<br/>
This gives me both the palette and raw data files which I'm linking into my source via makefile.  I'm only loading in one palette for this purpose, and the palette consists of all 16 colors that I'm using for both backgrounds.  Both images appear to have the same exact palettes (color order and everything).
<br/>
<br/>
Here is what the map SHOULD look like (minus the obnoxious lime green transparent color):
<br/>
<br/>
<a href="http://i109.photobucket.com/albums/n50/chewtoy11/fg0.jpg">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
The green grass, however, shows up as red and yellow instead of green and light green.  The brown soil winds up being transparent!
<br/>
<br/>
Any ideas?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102817 - Kirby - Sun Sep 17, 2006 6:54 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chewtoy11 wrote:</b></span></td> </tr> <tr> <td class="quote">I'm using gfx2gba to convert the images with this command:
<br/>
<br/>
gfx2gba -t8 -fsrc bg0-tileset.bmp
<br/>
</td> </tr></table><span class="postbody">
<br/>
Try, instead, using:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gfx2gba -t8 -fasm *.bmp</td> </tr></table><span class="postbody">
<br/>
That compiles all your images at the same time (which ensures they have the same palette), and outputs seperate .s files. Then, when compiling you can use:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">as sprDir\*.s -o Sprites.o
<br/>
interflip -mthumb-interwork Sprites.o</td> </tr></table><span class="postbody">
<br/>
That assembles all of your images at the same time (as opposed to having to gcc each of them in turn if they were src files). sprDir is the folder where you outputted the .s files, and Sprites.o is the file that stores all of the images.
<br/>
Then, just link Sprites.o to the rest of your files.<br/>_________________<br/>Knock-knock.
<br/>
Whose there?
<br/>
Kirby.
<br/>
Kirby-who?
<br/>
I told you! Kirby!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102863 - chewtoy11 - Sun Sep 17, 2006 3:02 pm</h4>
    <div class="postbody"><span class="postbody">Thank you very much!  It worked like a charm.  I also like how this method compiles all the images' data and the palette into one file (much cleaner for the makefile).
<br/>
<br/>
You're a godsend, Kirby!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
