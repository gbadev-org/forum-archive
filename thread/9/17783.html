<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprites address 0 has glitch - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Graphics > Sprites address 0 has glitch</h2>
<div id="posts">
<div class="post">
    <h4>#177036 - blessingta@hotmail.co.uk - Fri Dec 02, 2011 1:10 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://postimage.org/image/e9anr50e9/" target="_blank">http://postimage.org/image/e9anr50e9/</a>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include"btaLoadSprites.h"
<br/>
<br/>
void initialise_sprites()
<br/>
{
<br/>
   
<br/>
   // Graphics mode controls
<br/>
   //Pointer to area which controls  the graphics modes
<br/>
   REG_DISPCNT = ((1&lt;&lt;12)|(1&lt;&lt;11)|(1&lt;&lt;10)|(1&lt;&lt;9)|(1&lt;&lt;8)|(1&lt;&lt;6)|(0&lt;&lt;0));
<br/>
   
<br/>
   //(1&lt;&lt;12) sprite objects on/off (1 == on| 0 == off)
<br/>
   //(1&lt;&lt;11) BG3 layer on/off (1 == on| 0 == off)
<br/>
   //(1&lt;&lt;10) BG2 layer on/off (1 == on| 0 == off)
<br/>
   //(1&lt;&lt;9) BG1 layer on/off (1 == on| 0 == off)
<br/>
   //(1&lt;&lt;8) BG0 layer on/off (1 == on| 0 == off)
<br/>
   //(0&lt;&lt;6) (2bits space)1dimensional buffer data on/off (1 == on| 0 == off)
<br/>
   //(0&lt;&lt;0) (3bits) graphics mode
<br/>
   
<br/>
   
<br/>
   
<br/>
   unsigned int * puiMy_Sprites32 = (unsigned int*)0x06010000;
<br/>
   
<br/>
   //Extract sprite data
<br/>
   int iff = 0;
<br/>
   for (iff = 0;iff&lt; 2048;iff++)
<br/>
   {
<br/>
   puiMy_Sprites32[iff] = uisprite_data[iff]; 
<br/>
   }
<br/>
   
<br/>
   //Blanksprite holder 1, blank screen
<br/>
   for (iff = 0;iff&lt; 8;iff++)
<br/>
   {
<br/>
   puiMy_Sprites32[iff] = 0; 
<br/>
   }
<br/>
   
<br/>
   ////////////////////////////////////////////////////
<br/>
   //SPRITE ODER
<br/>
   //1 BLANK SPACE 1(8X1) 32lines
<br/>
   //2 BLUE BALL 2X2 (8TIMES4) 32lines 
<br/>
   //3 RED BALL 2X2 (8TIMES4)lines 
<br/>
   //4 BLUE CURSOR 2X2 (8TIMES4)lines
<br/>
   //5 ??? RED CURSOR 2X2? (8TIMES4)lines
<br/>
   //6 WELL COME 4X8 
<br/>
   //7 MAKE LINE 4X8
<br/>
   ////////////////////////////////////////////////////
<br/>
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177049 - Miked0801 - Fri Dec 02, 2011 4:38 pm</h4>
    <div class="postbody"><span class="postbody">iff is a horrible var name - reads like an if statement.  Use something more verbose (or just i as its just an index) and you and your teacher will be much happier.
<br/>
<br/>
Can't remember, but I don't believe you are allowed to access VRAM in the GBA 32-bits at a time.  The bus I believe is only 16-bits wide.  Change your unsigned int * to a unsigned short *, then double your loop lengths.
<br/>
<br/>
You also would need to up your second loop to 16 so that it outputs 32 bytes of data.  You are aware that the 2nd write is trashing the first 32-bytes of data from your previous right yes?  They both start their writing at 0x06010000.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177051 - Dwedit - Fri Dec 02, 2011 5:19 pm</h4>
    <div class="postbody"><span class="postbody">You are able to access vram 32 bits at a time, that's not a problem.  You just get a 1-cycle penalty for going from 16 bits to 32 bits.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177059 - Cearn - Sat Dec 03, 2011 10:41 am</h4>
    <div class="postbody"><span class="postbody">What exactly are you trying to do? Without a picture of what it's supposed to look like, it's difficult to say what the problem is.
<br/>
<br/>
One thing you're forgetting here is setting the object attributes. VRAM (0601:0000) is just where the graphics are stored, but the objects themselves are controlled via OAM (0700:0000). 
<br/>
<br/>
Look at VBA's tile OAM viewers to see what's actually in memory and what VBA thinks you're telling it to do. That's usually a good way to start. 
<br/>
<br/>
Also, 32-bit copies from ROM to VRAM are fine, and can be about <a class="postlink" href="http://www.coranac.com/tonc/text/text.htm#img-txt-se2" target="_blank">twice as fast</a> as 16-bit copies. Better yet, use DMA.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177063 - Miked0801 - Sat Dec 03, 2011 10:56 pm</h4>
    <div class="postbody"><span class="postbody">My bad - was thinking of 8-bit copies perhaps :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
