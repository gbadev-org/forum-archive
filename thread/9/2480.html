<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Level Mapper from GBATools - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > Level Mapper from GBATools</h2>
<div id="posts">
<div class="post">
    <h4>#13390 - RaBBi - Fri Dec 12, 2003 3:15 pm</h4>
    <div class="postbody"><span class="postbody">Hi all ^^
<br/>
<br/>
Does someone has managed to use this map editor?
<br/>
<br/>
I mean use the exported file format.
<br/>
<br/>
I know it's a topic about "graphics" on GBA, but I would like to extend the ask to the fact I'd need to know how to use binary files in GBA projects.
<br/>
<br/>
Many map editors export their data to .map files for example.
<br/>
As a newbie, I use to use .c files (for palette, tiles and map) which are more concrete for me.
<br/>
With binary files, I didn't know how to "link" them to project and how to "see" their data.
<br/>
<br/>
Thank you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13392 - tepples - Fri Dec 12, 2003 4:18 pm</h4>
    <div class="postbody"><span class="postbody">One way to use binary files in a GBA program is through an appended read-only file system such as <a class="postlink" href="http://www.pineight.com/gba/#gbfs" target="_blank">GBFS</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13393 - RaBBi - Fri Dec 12, 2003 4:38 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, thanks, I already got an example of using your GBFS ^^
<br/>
(exactly with Lua script files)
<br/>
<br/>
But, generally, did we must know how the data in the binary file is structured?
<br/>
What did we must know in fact?
<br/>
<br/>
I saw a tool that converts binary to .c but I don't  figure out that it works to produce that.<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13394 - tepples - Fri Dec 12, 2003 5:01 pm</h4>
    <div class="postbody"><span class="postbody">Yes, you must know how the binary file is structured in order to be able to read it. But usually, export tools will output tiles in one specific format designed to be dma_memcpy()'d directly to VRAM. You might have to read the export documentation to see if it outputs maps linearly (one line of 256 tiles, the next line of 256 tiles, etc) or sorted by pages (one page of 32x32 tiles, the next page of 32x32 tiles, etc).<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13395 - cosmic4z - Fri Dec 12, 2003 5:15 pm</h4>
    <div class="postbody"><span class="postbody">Hi Rabbi,
<br/>
<br/>
All the file formats use by Level Mapper can be found here:
<br/>
<br/>
<a href="http://www.gbatools.com/docs_levelmapper/fileformats.htm" target="_blank">http://www.gbatools.com/docs_levelmapper/fileformats.htm</a>
<br/>
<br/>
You will most likely be interested in the .TS and .MAP formats.
<br/>
<br/>
The Tile Grabber component of Level Mapper can be configured to output different parts (bitmap, palette, bank number, optional metamap etc) of a tileset to raw binary file.
<br/>
<br/>
Using binary data for you game projects is pretty standard stuff and there are a few ways you can get the binary data in your project.
<br/>
<br/>
I never used GBFS ... I use something simular (I call 'file system') that I developed for the purpose of including binary data in GBA projects.
<br/>
<br/>
If there is enough interest ... I'll make this tool available to hobby GBA developers soon.
<br/>
<br/>
Good luck with your game dev RaBBi :)
<br/>
Jamie
<br/>
<a href="http://www.GBAtools.com" target="_blank">www.GBAtools.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13396 - cosmic4z - Fri Dec 12, 2003 5:17 pm</h4>
    <div class="postbody"><span class="postbody">RaBBi ...
<br/>
<br/>
Please let me know if you have any other problems using Level Mapper output. Or indeed any other probs with it.
<br/>
<br/>
Feedback is also very welcome ;)
<br/>
<br/>
Jamie</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13397 - RaBBi - Fri Dec 12, 2003 5:26 pm</h4>
    <div class="postbody"><span class="postbody">ok thanks ^^
<br/>
[edit: this post was initially to tepples, I wrote while comicz too ^^ so I thank both]
<br/>
<br/>
I read this page about file formats used by this soft :
<br/>
<a href="http://www.gbatools.com/docs_levelmapper/fileformats.htm" target="_blank">http://www.gbatools.com/docs_levelmapper/fileformats.htm</a>
<br/>
<br/>
And I understand better how I can work when I know the data sequence of a file.
<br/>
Be sure I'll explore much more their formats ^^
<br/>
<br/>
But, generally in the case someone don't use GBFS for example, how can he input/include a binary to C code to read it?
<br/>
<br/>
And do you think a tool like bin2c will convert the binaries into values and arrays like they're structured and typed in the header of the file for example?
<br/>
<br/>
Thank you<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13398 - RaBBi - Fri Dec 12, 2003 5:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>cosmic4z wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<br/>
If there is enough interest ... I'll make this tool available to hobby GBA developers soon.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Sure I'll be interested in that ^^
<br/>
<br/>
This is not to put aside GBFS, I didn't use it yet, but I like to have several solutions to choose the one which to my problematic.
<br/>
So I think that use tools from a same source (levelmapper and gbatools'FS) would be a sure choice.
<br/>
<br/>
But are there any other ways than a "File System" ?
<br/>
(sorry I'm really n00b in that point)
<br/>
Must we have to own this type of system to manage editors' exported formats?<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13400 - tepples - Fri Dec 12, 2003 6:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RaBBi wrote:</b></span></td> </tr> <tr> <td class="quote">But, generally in the case someone don't use GBFS for example, how can he input/include a binary to C code to read it?
<br/>
<br/>
And do you think a tool like bin2c will convert the binaries into values and arrays like they're structured and typed in the header of the file for example?</td> </tr></table><span class="postbody">
<br/>
A file is a stream of bytes. Tools such as b2x will convert a file into an array representing the stream of bytes. You'll have to cast them to the appropriate struct type.
<br/>
<br/>
One motivation behind GBFS and appended data is that the artists can work independently of the programmers. You don't get this with binary-to-linkable-object conversion.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13404 - RaBBi - Fri Dec 12, 2003 7:00 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I thought about exporting tileset into separated raw files (palette, tiles...) then convert them to C with tool like bin2c, and try to load them with HaM.
<br/>
<br/>
But I think I will look at GBFS ^^
<br/>
<br/>
(highlight me : "raw" means "binary" ?)
<br/>
<br/>
<br/>
EDIT: Wonderful! GBFS is great !
<br/>
<br/>
I manage to load a tileset from LevelMapper format (.til) using GBFS with HAM.
<br/>
In fact, just a part of it, 'cause HaM function needs a parameter that is the size of tiles in 16bits chunks.
<br/>
And I don't find how and where to know it with the levelMapper format.
<br/>
<br/>
So I ask Jamie on how to do that.
<br/>
<br/>
Thank you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13417 - cosmic4z - Sat Dec 13, 2003 12:06 am</h4>
    <div class="postbody"><span class="postbody">Hi RaBBi,
<br/>
<br/>
If GBFS works for you, there is no reason not to use it.
<br/>
<br/>
It also has an advantage over my 'File System' like Tepples says ... it is useful for artists to create GBA roms with no need to compile.
<br/>
<br/>
Although ... my 'File System' does a lot of other very nice things that I think compensate for this. I cannot say too much or compare ... because I have not used GBFS ... only read about it.
<br/>
<br/>
With my 'File System' you do need to link in 2 files ... 'objcopy' will convert them from raw binary files to linkable .obj files.
<br/>
<br/>
My 'File System' is not likely to be available just yet ... but it will be ... along with some other tools.
<br/>
<br/>
So RaBBi ...
<br/>
<br/>
What is this 'size of tiles in 16bits chunks' that HaM function needs ?
<br/>
<br/>
I am not sure what you are looking for here. Can you explain further so I can help you.
<br/>
<br/>
Also RaBBi ... when I say RAW file ... I mean a binary file with no formating and headers etc ... just the raw data.
<br/>
<br/>
Jamie
<br/>
<a href="http://www.GBAtools.com" target="_blank">www.GBAtools.com</a></span><span class="gensmall"><br/><br/>Last edited by cosmic4z on Sat Dec 13, 2003 12:10 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#13433 - RaBBi - Sat Dec 13, 2003 12:09 pm</h4>
    <div class="postbody"><span class="postbody">ok Jamie ^^
<br/>
Don't forget to tell us when your tools will be available ^^
<br/>
<br/>
So for this point of "size", the function I use is the following :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
ham_InitTileset(void * src, u16 size_u16, u8 col_mode, u8 cbb_only_mode)
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It returns a tile_info_ptr that you can assig to the field ti of a BG struct.
<br/>
size_u16 : the size of the tiles to be copied into Tile RAM, in number of 16 bits chunks.
<br/>
<br/>
First I used gfx2gba for tileset, and it produces arrays I was able to use with this ham function.
<br/>
Then I used Nessie's Map Editor, and I configured it to produce the same arrays, so it works with Ham too.
<br/>
<br/>
But in your file formats documentation, I read :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
This is the raw tile bitmap data, in 'GBA ready' format. For 16 colour tile-sets, there are 32 bytes per tile. For 256 colout tile-sets, there are 64 bytes per tile.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So I don't manage to have the good "size" of my tiles in 16bits cause I don't know how to know the size of the tileset file.<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13438 - cosmic4z - Sat Dec 13, 2003 1:28 pm</h4>
    <div class="postbody"><span class="postbody">Hi RaBBi ...
<br/>
<br/>
'GBA ready' ... the tiles can go straight to VRAM ...
<br/>
<br/>
size of tiles in 16bit chunks =
<br/>
<br/>
for 16 colour tiles :- number_of_tiles * 16
<br/>
<br/>
for 256 colour tiles :- number_of_tiles * 32
<br/>
<br/>
the number_of_tiles in a tileset (and also colours_per_tile) is specified in the .TS file header.
<br/>
<br/>
hope that is useful ... let me know how you get on.
<br/>
<br/>
Jamie
<br/>
<a href="http://www.GBAtools.com" target="_blank">www.GBAtools.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13439 - RaBBi - Sat Dec 13, 2003 2:09 pm</h4>
    <div class="postbody"><span class="postbody">Thanks Jamie ^^
<br/>
<br/>
In fact, I don't use the .TS file but .til and .pal separatly.
<br/>
<br/>
So I now have a doubt... .til is the unoptimized tileset, isn't it?
<br/>
<br/>
That's the tileset data in.TS file which is optimized, no?
<br/>
<br/>
It's recommended to use .ts and .map together for best results, isn't it?<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13443 - cosmic4z - Sat Dec 13, 2003 4:44 pm</h4>
    <div class="postbody"><span class="postbody">Well ...
<br/>
<br/>
You need to use the tileset [.TS] file with Level Mapper ...
<br/>
<br/>
But ...
<br/>
<br/>
To include in your project you can use either ...
<br/>
<br/>
The [.TS] file ... OR ... the individual raw data files ... for palette, tile bitmaps, bank numbers (for 16 col tiles).
<br/>
<br/>
Then of couse, you can compress them...
<br/>
<br/>
Jamie</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13447 - RaBBi - Sat Dec 13, 2003 5:23 pm</h4>
    <div class="postbody"><span class="postbody">oki, the number of tiles is specified in the .TS header, but how can I know this number if I only use .TIL in my code?
<br/>
<br/>
Sorry if my question is too stupid, I'm working on a collision detection engine, and my brain is too hot now! ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13469 - cosmic4z - Sun Dec 14, 2003 2:48 am</h4>
    <div class="postbody"><span class="postbody">Hi RaBBi ...
<br/>
<br/>
You can use the filesize (length in bytes) of the .TIL file.
<br/>
<br/>
Divide that by 32 (for 16 colour tiles) or 64 (for 256 colour tiles).
<br/>
<br/>
Depending on the method you use to include binary data files in to your project ... there will be a different way to find the filesize.
<br/>
<br/>
My 'File System' lets you query data length for any data item.
<br/>
<br/>
GBFS will have something simular (I guess it will).
<br/>
<br/>
If you link in as an .OBJ file (first using objcopy in your makefile) ... there are variables set that can be used to determine filesize (have a look in generated mapfile). The variable that is set is determined by the file pathname.
<br/>
<br/>
Jamie</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13470 - tepples - Sun Dec 14, 2003 5:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>cosmic4z wrote:</b></span></td> </tr> <tr> <td class="quote">My 'File System' lets you query data length for any data item.
<br/>
<br/>
GBFS will have something simular (I guess it will).</td> </tr></table><span class="postbody">
<br/>
You guessed right.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>In the manual for GBFS, tepples wrote:</b></span></td> </tr> <tr> <td class="quote">const void *gbfs_get_obj(const GBFS_FILE *file, const char *name, u32 *len);
<br/>
<br/>
Performs a binary search inside the given file for an object with the given name and returns a pointer to the object.  If len is not NULL, gbfs_get_obj() stores the length of the object (in bytes) into the referenced location.</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13473 - RaBBi - Sun Dec 14, 2003 11:14 am</h4>
    <div class="postbody"><span class="postbody">Yes, I saw it in the readme of GBFS.
<br/>
<br/>
But I don't understand very well the way to use this parameter : u32 * len
<br/>
<br/>
and this sentence :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If len is not NULL, gbfs_get_obj() stores the length of the object (in bytes) into the referenced location</td> </tr></table><span class="postbody">
<br/>
<br/>
This function returns a pointer so what is the reference location where the length will be stored?
<br/>
<br/>
What value do I have to use for len? Any values but NULL?
<br/>
<br/>
A last highlight on this point would be a precious help tepples, as I begin to do really cool thing with your GBFS and I didn't imagine it would be so easy ^^
<br/>
<br/>
Thank you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13761 - cosmic4z - Mon Dec 22, 2003 1:45 pm</h4>
    <div class="postbody"><span class="postbody">RaBBi,
<br/>
<br/>
I am guessing that you pass to the function (as a parameter) ... the pointer to your u32.
<br/>
<br/>
The function will then write to this address.
<br/>
<br/>
Maybe you should ask tepples?<br/>_________________<br/>Qwak - <a href="http://www.qwak.co.uk" target="_blank">www.qwak.co.uk</a> | Forum - <a href="http://www.qwak.co.uk/forum/" target="_blank">www.qwak.co.uk/forum/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13776 - RaBBi - Mon Dec 22, 2003 6:14 pm</h4>
    <div class="postbody"><span class="postbody">oh!
<br/>
understood! 
<br/>
<br/>
I think... ^^
<br/>
I had not read the sentence in the right sense ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13862 - cosmic4z - Wed Dec 24, 2003 1:44 am</h4>
    <div class="postbody"><span class="postbody">Well ... try it RaBBi ... experiment and find out ... experimentation is always good !!
<br/>
<br/>
:)<br/>_________________<br/>Qwak - <a href="http://www.qwak.co.uk" target="_blank">www.qwak.co.uk</a> | Forum - <a href="http://www.qwak.co.uk/forum/" target="_blank">www.qwak.co.uk/forum/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
