<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Simple Text tile modes - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > Simple Text tile modes</h2>
<div id="posts">
<div class="post">
    <h4>#2893 - Mug - Fri Feb 14, 2003 9:17 am</h4>
    <div class="postbody"><span class="postbody">can anyone direct me to a good read about how to use background modes like mode 0 for simple text?
<br/>
<br/>
or even better, an open source rom that just shows the use of text in tile modes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2900 - ampz - Fri Feb 14, 2003 10:34 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.hh.se/stud/d99tibr/index5.html" target="_blank">http://www.hh.se/stud/d99tibr/index5.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2904 - Lord Graga - Fri Feb 14, 2003 10:55 am</h4>
    <div class="postbody"><span class="postbody">Go to GBADev.org and download SM's library v 6, it has a lib called lib_text.h, take a look in it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2906 - Mug - Fri Feb 14, 2003 11:02 am</h4>
    <div class="postbody"><span class="postbody">i cant find that library for download anywhere on the site
<br/>
<br/>
actrually how about this, could someone quickly throw together a program in C that displays
<br/>
<br/>
'ABC123'
<br/>
<br/>
or something on the screen using an apropriate tile mode in a simple way? that would be great</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2911 - Quirky - Fri Feb 14, 2003 1:55 pm</h4>
    <div class="postbody"><span class="postbody">You store the tiles for the text in tile ram, then set the map data to the tile index for each letter. It is a peice of cake. Here is some code I wrote to do these steps...
<br/>
<br/>
Tp place the correct char tile at the x, y position in the Bg "bg" I use this. e.g. print_text("ABC123", 0,1, &amp;bg0);
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void print_text(char* text, u16 x, u16 y , Bg* bg)
<br/>
{
<br/>
   u32 indx=0;
<br/>
   u16 newx = x;
<br/>
   
<br/>
   u16 letter;
<br/>
      while( (text[indx]!= 0) ) 
<br/>
      {
<br/>
        letter = text[indx]-0x21; // first thing is !, index 0x21
<br/>
        if (text[indx] != 32)
<br/>
          bg-&gt;mapData[newx+y*32] = letter+bgmapoffset;
<br/>
        else 
<br/>
          bg-&gt;mapData[newx+y*32] = 0;
<br/>
        newx++;
<br/>
        indx++;
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Where Bg is as defined in the pern project.
<br/>
<br/>
The actual tile data is taken from a bmp of letters I drew... loading that into the appropriate tile data section is done like this, where "offset" is how many tiles you want to skip before loading the text, pLetters is a pointer to the bmp data and Bg is the background again:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void SetUpLetters(Bg* bg, u32 offset) {
<br/>
 // transfer in the Letters
<br/>
 bgmapoffset = offset;
<br/>
 u32 realos = bgmapoffset*8*4;
<br/>
<br/>
 REG_DMA3SAD = (u32)pLetters; 
<br/>
 REG_DMA3DAD = (u32)&amp;bg-&gt;tileData[realos];
<br/>
 REG_DMA3CNT = 3104 |DMA_16NOW;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The first text character into the tile ram is a "!" and the letters are in the correct ascii order. This is for 256 colour tiles.
<br/>
<br/>
Knocking up entire C code for a "demo" would lose the idea behind all the set up code. If you implement something like the above (or better, how about non uni-spaced text?), you'll have a far better understanding of how it all works.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
