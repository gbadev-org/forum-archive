<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Backgrounds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Graphics > Backgrounds</h2>
<div id="posts">
<div class="post">
    <h4>#76101 - gs2phateon - Sat Mar 18, 2006 4:42 am</h4>
    <div class="postbody"><span class="postbody">I've had this problem that's driving me absolutely crazy.  I have this formula that I'm using to scroll a background map:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">    for (b = vscroll; b &lt; vscroll + 31; b++){
<br/>
        for (a = hscroll; a &lt; hscroll + 32; a++){
<br/>
            *bg0map2 = testlevel2b_Map[(b * 600) + a];
<br/>
            bg0map2++;
<br/>
        }
<br/>
    }</td> </tr></table><span class="postbody">
<br/>
Where vscroll and hscroll are the number of tiles scrolled down and right (respectively), and bg0map2 is the location of the ScreenBaseBlock of the map (25 in this case).  The 600 you see is the width of the map, in tiles.  This formula has worked pretty well (it's glitchy because it doesn't use DMA, but I'll save that for later...) at scrolling a large 600x40 tile map.
<br/>
<br/>
My problem started when I tried applying all of the EXACT same elements to another program.  For some reason, the tiles on the screen are in the wrong order, and it looks like a random mosaic than the original picture.  I think something is wrong with the tiles, as well.  Both programs used screen mode 0 and are on background 0.
<br/>
<br/>
The only major difference between the good and bad programs is that the bad one uses sprites.  Does this have any effect on how the map and tiles are stored?  If not, do you have any suggestions about what I might be doing wrong?  I even tried replacing the source code of the second program (the one with the sprites) using the code from the working program (the one without the sprites), and the problem still happened.  
<br/>
<br/>
There is one exception I have found to this: the original background I used to test the sprite program DOES still work, and was compatible with the scrolling.  It is a small, 32x32 tile map (same as the background size), and doesn't use a lot of tiles.  However, the larger maps I made have had this map/tile problem.
<br/>
<br/>
I'm sorry this might be difficult to describe, but any help you might have to offer would be very appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76135 - tepples - Sat Mar 18, 2006 3:52 pm</h4>
    <div class="postbody"><span class="postbody">How is your other map's data aligned?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76155 - gs2phateon - Sat Mar 18, 2006 7:47 pm</h4>
    <div class="postbody"><span class="postbody">Both map's data (the 600x40 and 32x32) are aligned the same way, as in they are written straight out.  I think that's 1D, right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76156 - tepples - Sat Mar 18, 2006 7:49 pm</h4>
    <div class="postbody"><span class="postbody">I mean byte vs. word vs. long alignment. What program are you using to export the map data, and how are you loading it in your GBA file?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76164 - gs2phateon - Sat Mar 18, 2006 8:56 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I'm using GFX2GBA, which turns it into a "const unsigned short" array of hexidecimal numbers (0x0000..., so 16 bit right?) within a source file.  And to load it I just #include it.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
