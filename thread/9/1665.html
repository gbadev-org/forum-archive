<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>too many VRAM BG MEM yet? uh ! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Graphics > too many VRAM BG MEM yet? uh !</h2>
<div id="posts">
<div class="post">
    <h4>#8450 - RaBBi - Thu Jul 10, 2003 11:39 pm</h4>
    <div class="postbody"><span class="postbody">Hello, 
<br/>
<br/>
I keep on learning gba dev since 4 days now, with HAM.
<br/>
<br/>
I'm working on tiles mode and try to show a 256x256 bmp (125 unique colors).
<br/>
<br/>
I converted it by gfx2gba 0.13 &gt; OK
<br/>
<br/>
But when I load it, the emulator returns me a error message :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">assertion failed: (( I+CNT)x32) 
<br/>
in file: memory.c 
<br/>
at line: +299 
<br/>
message: HAM_MEMALLOCVRAM BG MEM FULL..DEALLOCATLE FIRST 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It seems the SIZEOF tiles array is too big (25216) for the memory...
<br/>
<br/>
I had a sprite so I think it took too memory, so I disabled it, but I always have this message...
<br/>
<br/>
When I re-think that there are 128 simultaneous sprites at a time...
<br/>
I'm still sceptic about it, if just one pic take the whole mem ^^
<br/>
<br/>
Can anyone take time to make a point on tiles memory please ?
<br/>
than U<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8459 - Cyberman - Fri Jul 11, 2003 5:16 am</h4>
    <div class="postbody"><span class="postbody">It's not likely the case you are allocating too much memory for your tiles.  Very unlikely. You are using 256 color tiles what background layer are you using?  You have 394 tiles used for a 32x32 array of tiles (they are 8x8).  You must be using BG 0 or B1 if you aren't then.. that could be your problem, well IS your problem.
<br/>
<br/>
If you are using visual ham (I recomend this) then you should set a break point wheree you load the tile data and step to that.. continue on into the code tell you get the exception thrown Just a suggestion :)
<br/>
<br/>
Cyb</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8461 - RaBBi - Fri Jul 11, 2003 7:38 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm using mode(0), and BG1 to display tiles (I reserved BG0 to display debug test for the moment ^^).
<br/>
<br/>
In fact, after optimization under gfx2gba, it announces me I have 788 (which is double of 394) tiles used for a 32x32 array of tiles, not 394 as what you say.
<br/>
<br/>
Does the problem comes from that point ?
<br/>
<br/>
I must precise that the picture tiled comes from GBA game : Golden Sun 2, and the mode and bg used to display this is the same way I use (but I fail lol)
<br/>
It's not to steal graphs from this game, just for test ^^
<br/>
They have 959 tiles as I see in MapViewer from VBA.
<br/>
<br/>
I'll try to set a break point, it's a great idea, thank U but Debug is not yet familiar for me ^^
<br/>
<br/>
I'll put here the array lengths to show you what I get : 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/*
<br/>
 * 32x32 map data
<br/>
 */
<br/>
const unsigned short ciel_Map[1024] 
<br/>
<br/>
const unsigned short ciel_Palette[256]
<br/>
<br/>
//
<br/>
// ciel (50432 uncompressed bytes)
<br/>
//
<br/>
const unsigned char ciel_Tiles[50432]</td> </tr></table><span class="postbody">
<br/>
<br/>
EDIT: i tried to set a break point on line I suppose to crash but I didn't find how in VHAM 2.2...<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
