<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Simple trouble... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Graphics > Simple trouble...</h2>
<div id="posts">
<div class="post">
    <h4>#25906 - pio_troland@wp.pl - Tue Aug 31, 2004 1:45 pm</h4>
    <div class="postbody"><span class="postbody">How to change a backgroud?
<br/>
<span style="color: darkred">BG1</span> --&gt; PRESS START --&gt; FLUENT EFFECT OF CHANGE TO --&gt;<span style="color: darkblue"> BG2</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25913 - tepples - Tue Aug 31, 2004 4:40 pm</h4>
    <div class="postbody"><span class="postbody">What kind of effect do you want?
<br/>
<br/>
First try this: scroll out one background, load VRAM, and scroll in another.
<br/>
<br/>
If each screen uses only one rot/scale background or only two text backgrounds, you can use effects such as a crossfade (by using the blend mode registers) or a wipe (by using the window registers).<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25918 - ScottLininger - Tue Aug 31, 2004 5:21 pm</h4>
    <div class="postbody"><span class="postbody">Probably the most old fashioned method is to fade your palette to be all one color (usually black), turn on BG2, then fade your palette back.
<br/>
<br/>
Here are a couple of simple functions. It's not the fastest way to do this, but the code should be clear enough.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// Your palette memory location
<br/>
u16* paletteMem = (u16*)0x5000000;   
<br/>
<br/>
// some predefined colors
<br/>
#define WHITE         0x7FFF
<br/>
#define BLACK         0x0000
<br/>
#define RED            0x395A
<br/>
<br/>
// some macros to pull out specific color bits
<br/>
#define RGB(r,g,b)      ((r)+((g)&lt;&lt;5)+((b)&lt;&lt;10)) 
<br/>
#define REDVALUE(c)      (c &amp; 31)
<br/>
#define GREENVALUE(c)   ((c&gt;&gt;5) &amp; 31)
<br/>
#define BLUEVALUE(c)   (c&gt;&gt;10)
<br/>
<br/>
void FadeIntoColor(u16 targetColor,u16* bmpPalette,int fadeSteps) {
<br/>
<br/>
   int readX, step, red,green,blue;
<br/>
   u16 sourceColor;
<br/>
<br/>
   for (step=0;step&lt;=fadeSteps ;step++ ){
<br/>
      WaitForVblank;
<br/>
      for(readX = 0; readX &lt; 256; readX++) {
<br/>
         
<br/>
         sourceColor = bmpPalette[readX];
<br/>
         red = ((REDVALUE(sourceColor) * (fadeSteps-step)) + (REDVALUE(targetColor) * step)) /fadeSteps;
<br/>
         green = ((GREENVALUE(sourceColor) * (fadeSteps-step)) + (GREENVALUE(targetColor) * step)) /fadeSteps;
<br/>
         blue = ((BLUEVALUE(sourceColor) * (fadeSteps-step)) + (BLUEVALUE(targetColor) * step)) /fadeSteps;
<br/>
<br/>
         paletteMem[readX] = RGB( red , green , blue );
<br/>
      }
<br/>
   }
<br/>
<br/>
}
<br/>
<br/>
void FadeFromColor(u16 targetColor,u16* bmpPalette,int fadeSteps) {
<br/>
<br/>
   int readX, step, red,green,blue;
<br/>
   u16 sourceColor;
<br/>
   
<br/>
<br/>
   for (step=0;step&lt;=fadeSteps ;step++ ){
<br/>
      WaitForVblank();   
<br/>
      for(readX = 0; readX &lt; 256; readX++) {
<br/>
         
<br/>
         sourceColor = bmpPalette[readX];
<br/>
         red = ((REDVALUE(targetColor) * (fadeSteps-step)) + (REDVALUE(sourceColor) * step)) /fadeSteps;
<br/>
         green = ((GREENVALUE(targetColor) * (fadeSteps-step)) + (GREENVALUE(sourceColor) * step)) /fadeSteps;
<br/>
         blue = ((BLUEVALUE(targetColor) * (fadeSteps-step)) + (BLUEVALUE(sourceColor) * step)) /fadeSteps;
<br/>
<br/>
         paletteMem[readX] = RGB( red , green , blue );
<br/>
         
<br/>
      }
<br/>
   }
<br/>
}
<br/>
<br/>
<br/>
// Change palette to black with 15 steps of fading 
<br/>
FadeIntoColor(BLACK,myPalettePointer,15);
<br/>
<br/>
// here's where you'd switch around your backgrounds
<br/>
<br/>
// Change palette back with 15 steps of fading 
<br/>
FadeFromColor(BLACK,myPalettePointer,15);
<br/>
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
