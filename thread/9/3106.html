<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprite / Tile collision handling - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Graphics > Sprite / Tile collision handling</h2>
<div id="posts">
<div class="post">
    <h4>#18276 - darknet - Tue Mar 23, 2004 11:33 am</h4>
    <div class="postbody"><span class="postbody">I see that this question has come up before, and yes, I have read that post, but am having a difficult time understanding it. Hopefully I am not being obnoxious by starting a new thread on the topic and I apologize if I am =/
<br/>
<br/>
So i, like a lot of beginners, am making a breakout clone. I am in mode 0, I got 2 sprites, one for the paddle, the other for the ball. The collision between the ball/walls and ball/paddle works fine, so now I am going to start drawing bricks and I want to make them a background and somehow check for collisions between the ball sprite and the background bricks.
<br/>
<br/>
Heres where I get confused...
<br/>
<br/>
I've read on a few tutorials that the tiles are 8x8. Does that mean that each of my bricks has to be 8x8? That doesn't seem to make sense? If they expand more than 8x8, how would i check for a collision between a ball and one brick? How do i go about properly updating the background? (thats where i got lost on the post that was similar to this one).
<br/>
<br/>
BTW, I plan on using mappy for developing the background of bricks. Is that overkill? Should I just draw it in photoshop and convert it using gfx2gba or another similar program?
<br/>
<br/>
Loaded post, I know. Any help or response would be greatly appreciated.
<br/>
<br/>
Thanks for your time,
<br/>
-Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18278 - Cearn - Tue Mar 23, 2004 3:02 pm</h4>
    <div class="postbody"><span class="postbody">What you have to remember is that the tiles are graphics data ONLY! That is, the only determine how your objects and backgrounds will appear on screen. The GBA is blissfully unaware that there's any collision detection to be done; if you want things to bounce off each other, you have to tell your code to do so. 
<br/>
The simplest way of collision detection is using bounding boxes. Each game object has a box around it. When two boxes overlap, they're said to be in collision. WHat you do with this information is entirely up to you, of course. In breakout you'd bounce the ball off the other object. But you probably know all that, since you got the ball/paddle collisions working already. 
<br/>
For tiles it's the same thing: you define the bounding box of each brick and check for collisions with the ball. That the bricks are made up of background tiles is completely irrelevant, that's just to let the player know that there are things like bricks. 
<br/>
And if you want bricks that are larger than 8x8, so be it: use multiple tiles for one brick then. To make them disappear when the brick's hit, simply erase all the associated tiles from the map. 
<br/>
<br/>
Now, in <span style="font-style: italic">principle</span> collision detection is separate from the tiles and the map, but <span style="font-style: italic">practice</span> you can the tile-map for collision detection as well if you stick to multiple of 8 sizes. 
<br/>
<br/>
For example, if you're bricks are 16x8 in size, that's 2 tiles. The brick at position (<span style="font-style: italic">x,y</span>) would use the map entries (<span style="font-style: italic">x,y</span>) and (<span style="font-style: italic">x+1,y</span>). For collision, you could check whether the ball's and bricks bounding boxes overlap (Or, you could find out if the ball covers the background tiles of the brick with some SHIFTs and ANDs. It's faster, but also more advanced). If the ball hit the brick, clear both map-entries and remove the brick from the check list. Yes, I know there are better ways of collision detection, but this should do.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
BTW, I plan on using mappy for developing the background of bricks. Is that overkill? Should I just draw it in photoshop and convert it using gfx2gba or another similar program?</td> </tr></table><span class="postbody">
<br/>
Kinda depends on how many different level you want to have, really. If it's the same layout of bricks every time (like in the Atari breakout), why not create an array manually?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18313 - darknet - Tue Mar 23, 2004 9:49 pm</h4>
    <div class="postbody"><span class="postbody">in terms of updating the map afterwards, would I just call a function to redraw the entire thing? How else <span style="font-style: italic">could</span> that be done? What would I draw in place of the brick? (nothing I assume...)
<br/>
<br/>
Thanks alot for your reply, however I sense that you don't really care for this form of collision detection =) The only other alternative I could think of is to make each brick a sprite and simply hide that brick (or clear that particular entry) when it collides with a ball. However, i thought the overhead of doing that is greater than the background overhead...or is it not? 
<br/>
<br/>
I guess the argument breaks down to whether or not redrawing the background is better than hiding a sprite? I dunno....
<br/>
<br/>
-Mike[/i]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18317 - Miked0801 - Tue Mar 23, 2004 10:35 pm</h4>
    <div class="postbody"><span class="postbody">Depends how many blocks you want to display.  You get a bunch so sprites would proably be better (imagine hitting the target and having the tile drop or explode or whatever.  Also allows non char alignment if you wish.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18395 - Cearn - Thu Mar 25, 2004 2:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>darknet wrote:</b></span></td> </tr> <tr> <td class="quote">in terms of updating the map afterwards, would I just call a function to redraw the entire thing? How else <span style="font-style: italic">could</span> that be done? What would I draw in place of the brick? (nothing I assume...)
<br/>
</td> </tr></table><span class="postbody">
<br/>
No, you don't have to redraw the entire thing ... unless ... what video mode are you in? A tiled mode (0-2) or bitmapped mode (3-5)?
<br/>
<br/>
In a tiled mode it's dead simple. say you have a map that looks like this
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
wwwwwwwwwwwwwwww
<br/>
w..............w
<br/>
w.aabbaabbaabb.w
<br/>
w.bbaabbaabbaa.w
<br/>
w.aabbaabbxxbb.w
<br/>
w..............w
<br/>
</td> </tr></table><span class="postbody">
<br/>
This more or less represents what you should have in your screen-blocks. 'w' is the wall, '.' is empty space and 'aa', 'bb', 'xx' are the bricks, 
<br/>
16x8 pixel bricks to be precise. Say you've determined that the tile labeled 'xx' has just been hit. To update the screen to indicate that, simply replace the 2 map-entries on the screen block of that brick with the ones representing empty space, so that afterwards it looks like this
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
wwwwwwwwwwwwwwww
<br/>
w..............w
<br/>
w.aabbaabbaabb.w
<br/>
w.bbaabbaabbaa.w
<br/>
w.aabbaabb..bb.w
<br/>
w..............w
<br/>
</td> </tr></table><span class="postbody">
<br/>
Of course, this only works if you're using a tiled video mode. If you're in a video mode it's a little trickier; using sprites would be the easiest method. And has the benefits that Miked0801 mentioned.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18441 - tepples - Fri Mar 26, 2004 12:59 am</h4>
    <div class="postbody"><span class="postbody">Of course, you could do what Super Mario Bros. and Bust-A-Move do: keep each block as tiles and then, once the ball has hit a block, erase the block's tiles and spawn a "dying block" (falling? explosion?) sprite from where it was.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18468 - LOst? - Fri Mar 26, 2004 9:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Of course, you could do what Super Mario Bros. and Bust-A-Move do: keep each block as tiles and then, once the ball has hit a block, erase the block's tiles and spawn a "dying block" (falling? explosion?) sprite from where it was.</td> </tr></table><span class="postbody">
<br/>
<br/>
That's a smart way of using tiles. I didn't think of it. When I'm looking at Puzzle Bobble the arcade version, the bubbles look like sprites because they are not tile aligned. Arcade machines are more powerful, but still having so many sprites shouldn't work right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18476 - tepples - Sat Mar 27, 2004 3:48 am</h4>
    <div class="postbody"><span class="postbody">(For those playing at home where home != USA, Puzzle Bobble is the Japanese name for the USA's Bust-A-Move. In Japan, Bust-A-Move is a dance simulation called Bust-A-Groove in the States.)
<br/>
<br/>
Puzzle Bobble and Zoop for Super NES used a background, modifying the tile memory to draw non-aligned game pieces. The Super NES didn't have a linear bitmap mode analogous to GBA display modes 3-5.
<br/>
<br/>
Puyo Pop for GBA uses 12-pixel-wide tiles on two background layers offset by 12 pixels. It draws even columns on one layer and odd columns on the other layer. It also uses raster effects (writes to the layers' V scroll during Hblank) to cut off the bottom 4 pixels of each 16-pixel space.
<br/>
<br/>
Puzzle Bobble for Neo-Geo, on the other hand, seems to use sprites for the game pieces. So do Super Puzzle Fighter II, Pac-Attack, and Panel de Pon for GBA. Games that need to show more than 128 sprites on the GBA screen at once will stream sprites into OAM during horizontal blank to sort of emulate the Neo-Geo's 384-entry OAM. This may be a bit more complicated for a beginner than just using tiles.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18564 - LOst? - Sun Mar 28, 2004 11:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">(For those playing at home where home != USA, Puzzle Bobble is the Japanese name for the USA's Bust-A-Move. In Japan, Bust-A-Move is a dance simulation called Bust-A-Groove in the States.)
<br/>
<br/>
Puzzle Bobble and Zoop for Super NES used a background, modifying the tile memory to draw non-aligned game pieces. The Super NES didn't have a linear bitmap mode analogous to GBA display modes 3-5.
<br/>
<br/>
Puyo Pop for GBA uses 12-pixel-wide tiles on two background layers offset by 12 pixels. It draws even columns on one layer and odd columns on the other layer. It also uses raster effects (writes to the layers' V scroll during Hblank) to cut off the bottom 4 pixels of each 16-pixel space.
<br/>
<br/>
Puzzle Bobble for Neo-Geo, on the other hand, seems to use sprites for the game pieces. So do Super Puzzle Fighter II, Pac-Attack, and Panel de Pon for GBA. Games that need to show more than 128 sprites on the GBA screen at once will stream sprites into OAM during horizontal blank to sort of emulate the Neo-Geo's 384-entry OAM. This may be a bit more complicated for a beginner than just using tiles.</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks for the info. I had no idea how much you can do with some hacking during the drawing period.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
