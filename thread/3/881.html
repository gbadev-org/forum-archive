<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Flash2Advance architecture? (Yo! ampz!) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Hardware > Flash2Advance architecture? (Yo! ampz!)</h2>
<div id="posts">
<div class="post">
    <h4>#4397 - cesium - Sat Mar 29, 2003 10:40 pm</h4>
    <div class="postbody"><span class="postbody">ampz et. al.,
<br/>
<br/>
The Flash2Advance 128M cart has 4 each of the Intel 28F320B3TC
<br/>
chips. These are 32MBit = 2048k words of 16 bits each. There are
<br/>
21 address lines.
<br/>
<br/>
Fron the GBA side: 16 bit reads are performed with even addresses.
<br/>
<br/>
So... If I were to hook up one of these chips to the GBA I would...
<br/>
GBA___Chip
<br/>
A0-----&gt;No connect
<br/>
A1-----&gt;A0
<br/>
A2-----&gt;A1
<br/>
etc.
<br/>
<br/>
Does this make sense?
<br/>
cesium<span style="font-size: 9px; line-height: normal"></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4399 - mbcook - Sun Mar 30, 2003 12:27 am</h4>
    <div class="postbody"><span class="postbody">There is probably a latch on the cart to controll the high bits of the address, basically banking.<br/>_________________<br/>--Michael</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4403 - cesium - Sun Mar 30, 2003 12:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">I assume that this 128M flash cart of yours contains two 64M flash parts?
<br/>
They are connected in paralell, one part for the upper 8 bits and one part for the lower 8 bits on the 16bit databus.
<br/>
<br/>
Since it's a 16bit bus and we are working with 16bit operations, only even adresses are valid.
<br/>
0x08000000, 0x08000002, 0x08000004, 0x08000006 and so on.
<br/>
Also, when reading device identifier codes, the A0 pin on the flash part is unused. That's why you get the device code from 0x08000004.
<br/>
You should find the block 0 lock configuration at adress 0x08000008.</td> </tr></table><span class="postbody">
<br/>
<br/>
Basically, I don't understand why I'm seeing the chip device id code
<br/>
at 0x08000004. I think that A0 *IS* used on these flash chips.
<br/>
<br/>
cesium</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4409 - ampz - Sun Mar 30, 2003 1:34 pm</h4>
    <div class="postbody"><span class="postbody">Yes, A0 is used on thoose chips since they work in 8bit mode. (two 8bit chips in paralell = 16bit)
<br/>
However, if you read the datasheet, when reading device identifier codes, A0 is ignored.
<br/>
<br/>
BTW, they are connected like this:
<br/>
GBA---flash
<br/>
A0-----A0
<br/>
A1-----A1
<br/>
A2-----A2
<br/>
<br/>
However, since this is a 16bit bus, A0 is NOT the least significant bit of the bus. The least significant bit is not present on the bus at all.
<br/>
<br/>
mbcook: no.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4413 - cesium - Sun Mar 30, 2003 5:09 pm</h4>
    <div class="postbody"><span class="postbody">Hey ampz,
<br/>
I do appreciate your reply. I have never used flash chips before so
<br/>
I am just getting my thoughts organized.
<br/>
<br/>
Also, for anyone reading this, as far as I know, ampz is the only,
<br/>
actively posting, member of this forum who has actually etched boards
<br/>
and made working flash carts. The rest of the postings are just words.
<br/>
<br/>
There is the talk, then there's the walk; and ampz walks the walk.
<br/>
<br/>
Having said that, I'm TOTALLY confused! I looked at my Flash2Advance
<br/>
cart, and I found 4 chips. Each says 28F320B3TC. These are Intel
<br/>
3-V Advanced Boot Block chips. They are in the VFBGA package.
<br/>
<br/>
So I studied the data sheet:
<br/>
<a href="http://www.intel.com/design/flcomp/datashts/29058016.pdf" target="_blank">http://www.intel.com/design/flcomp/datashts/29058016.pdf</a>
<br/>
<br/>
It says that this is a 32Mbit flash chip organized as 2048k words of
<br/>
16 bits each. This makes sense, because I have 4 of these chips for
<br/>
a total of 128Mbits.
<br/>
<br/>
Also, sec 3.2.2 on p. 14 of the data sheet says:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Once in read-identifier mode, A0=0 outputs the manufacturer's
<br/>
identification code, and A0=1 outputs the device identifier (see
<br/>
Table 5) Note: A1 - A21 = 0.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So, I'm just wayyyy confused for 2 reasons:
<br/>
<br/>
1 - I read the device id at 0x08000004. (How the heck is this single
<br/>
bit represented by the 4 in this address getting over to A0 on the chip!!!?)
<br/>
<br/>
2 - You keep saying that these chips are 8-bits wide, and that A0
<br/>
is *NOT* used.
<br/>
<br/>
cesium (Feeling less like cesium, and more like lithium :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4415 - tepples - Sun Mar 30, 2003 6:05 pm</h4>
    <div class="postbody"><span class="postbody">Depends on how the flash chips are wired.
<br/>
<br/>
The cart edge address bus goes from A1 to A24 (A24-A17 direct; A16-A1 multiplexed).  If the four 8-bit-wide flash chips are interleaved in a 32-bit fashion, then A0 of the flash chips goes to A2 of the cart edge.
<br/>
<br/>
But of course, I'm probably talking out of my<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4423 - cesium - Sun Mar 30, 2003 7:49 pm</h4>
    <div class="postbody"><span class="postbody">Right. I don't think we can negelect the possibility that they are
<br/>
in fact interleaved, not put in series in the address space.
<br/>
<br/>
But, again, I'm still confused as to why you too are saying that these
<br/>
chips are 8 bits wide.
<br/>
<br/>
Am I just being an idiot when I read the data sheet?
<br/>
<br/>
You look at the same data sheet that I do and say that they are 8-bits
<br/>
words, not 16-bit words?
<br/>
<br/>
Really, how can this be so confusing?!
<br/>
<br/>
Cheers,
<br/>
<br/>
cesium (Did you like that lithium joke?)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4426 - ampz - Sun Mar 30, 2003 10:47 pm</h4>
    <div class="postbody"><span class="postbody">Yes, they could be interleaved, but that would be a really stupid solution.
<br/>
It adds capacitive load to the data bus, adding even more to the already tight timing, and it makes the PCB layout more complex.
<br/>
That's why they most likely operate in pairs in 8bit mode.
<br/>
<br/>
Of course, F2A engineers may very well be stupid, who knows? :)
<br/>
<br/>
cesium: Intel flash memories can operate in either 8bit or 16bit mode. There is a strap pin that is used to select mode.
<br/>
<br/>
There is no section 3.2.2 in my datasheet, might be a slightly different revision. However, under figure 7 in my datasheet it clearly states that "A0 is not used in either x8 or x16 modes when obtaining these identifier codes."
<br/>
<br/>
tepples: Yes, one could argue that the adress lines present on the GBA cart bus should be named A1-A24, as a matter of fact, I agree with you to some extent, but it is really only a naming convention, and most GBA tech info I've seen refers to them as A0-A23. It is actually quite convenient to number them that way since the same pins are shared with the databus.
<br/>
I know many standard 16/8bit flash memories number the pins A0 to Ax in 16 bit mode, and A-1 to Ax in 8bit mode :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4427 - cesium - Mon Mar 31, 2003 12:18 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">cesium: Intel flash memories can operate in either 8bit or 16bit mode. There is a strap pin that is used to select mode.
<br/>
<br/>
There is no section 3.2.2 in my datasheet, might be a slightly different revision. However, under figure 7 in my datasheet it clearly states that "A0 is not used in either x8 or x16 modes when obtaining these identifier codes."</td> </tr></table><span class="postbody">
<br/>
<br/>
Can I get a copy of your data sheet? What is the title? I'll
<br/>
search Intel for it.
<br/>
<br/>
Would you glance at the one I refer to in the URL in my prev
<br/>
post above and see if it is the proper one?
<br/>
<br/>
From the data sheet that I am reading, there is, in fact, no pin
<br/>
that permits switching between x8 and x16 mode.
<br/>
<br/>
Certainly, the StrataFlash (J3) series has this feature. However the
<br/>
28F320B3 Boot Block Flash chips do not.
<br/>
<br/>
cesium</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4429 - ampz - Mon Mar 31, 2003 1:25 am</h4>
    <div class="postbody"><span class="postbody">I didn't check the part number you quoted since I assumed they use strataflash parts. You are correct, the parts they use do not support 8bit mode so they must be interleaved.
<br/>
The parts they use are much more expensive than strataflash.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
