<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Real Time Clock - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Hardware > Real Time Clock</h2>
<div id="posts">
<div class="post">
    <h4>#16246 - dagamer34 - Wed Feb 11, 2004 4:29 am</h4>
    <div class="postbody"><span class="postbody">I wanted to know how to access the Real Time Clock functions on the GBA. It's not in any of the GBA docs I've read. 
<br/>
<br/>
I can't understand the VBA source because its quite complicated to me. And the PCEAdvance code is also quite complicated. Any help here? There really isn't anything to look at and learn from in previous topics.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16267 - torne - Wed Feb 11, 2004 1:16 pm</h4>
    <div class="postbody"><span class="postbody">The GBA itself has no realtime clock. Several commercial games have an RTC in the cart (pokemon..etc), thus, some flashcarts have added an RTC. The RTC in a flashcart is not neccecarily accessed the same way as in the commercial game (as the flash linker can just patch the game as it writes it); other than disassembling a game that uses an RTC (after patching it) or reading the VBA source, I'm not sure how you'd find out.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16274 - FluBBa - Wed Feb 11, 2004 2:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">I can't understand the VBA source because its quite complicated to me.</td> </tr></table><span class="postbody">
<br/>
Well, reading from and writing to the RTC is quite complicated, I might make a clock program in C soon.
<br/>
On the other hand it shouldnt be so hard to find out what chip is used is Pokemon and then find the documents for that chip.
<br/>
The EZ-whatever flash cart uses a different RTC then the one in Pokemon and patches the game "on the fly" the new X-ROM and F2A Ultra should be at least directly compatible with the RTC in Pokemon.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16309 - dagamer34 - Thu Feb 12, 2004 3:58 am</h4>
    <div class="postbody"><span class="postbody">Flubba, how soon is soon? Like tomorrow?
<br/>
<br/>
That would be real useful to us all. That way we won't have 4 topics over the same thing that lead to nowhere.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16331 - ampz - Thu Feb 12, 2004 7:37 pm</h4>
    <div class="postbody"><span class="postbody">dagamer34: How about like now?
<br/>
I threw together a <a class="postlink" href="http://www.brolinembedded.se/projects/gba_rtc" target="_blank">RTC Demo</a>.
<br/>
Enjoy!</span><span class="gensmall"><br/><br/>Last edited by ampz on Tue Mar 16, 2004 10:36 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#16344 - dagamer34 - Fri Feb 13, 2004 12:58 am</h4>
    <div class="postbody"><span class="postbody">I just happen to own an EZFA... crap. Can I say crap on this board? Will anybody hunt me down?
<br/>
<br/>
How did you find out this info? Would the manufacturer of the EZFA actually give me the information needed to use the RTC?
<br/>
<br/>
One last question, how would you set the date?
<br/>
<br/>
Thanks a lot.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16345 - ampz - Fri Feb 13, 2004 1:16 am</h4>
    <div class="postbody"><span class="postbody">It is a multiboot image. Not sure if VBA can multiboot?
<br/>
You can recompile it to a 'normal' image if you want.
<br/>
The reson for it beeing a multiboot image is so that you can run it on a Pokemon cart if you have one.
<br/>
Currently noone I know of knows how to access the EZ RTC. Dunno if they would give out the info on request, but I doubt it..
<br/>
There is not support in my software for changing the date and time... Yet. Will probably add that at a later time ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16349 - dagamer34 - Fri Feb 13, 2004 2:23 am</h4>
    <div class="postbody"><span class="postbody">Later time being tomorrow?
<br/>
<br/>
Again, I ask, how did you figure this stuff out? Its not exactly in a document or a tutorial.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16350 - ampz - Fri Feb 13, 2004 2:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Later time being tomorrow?</td> </tr></table><span class="postbody">
<br/>
When I have the time to spare and feel like it :)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Again, I ask, how did you figure this stuff out? Its not exactly in a document or a tutorial.</td> </tr></table><span class="postbody">
<br/>
A combination of different sources of information. Mostly RE.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16351 - dagamer34 - Fri Feb 13, 2004 2:49 am</h4>
    <div class="postbody"><span class="postbody">Do you like pulling my strings and yanking my chain??
<br/>
<br/>
How about you do it for me???
<br/>
<br/>
And what is RE?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16357 - tepples - Fri Feb 13, 2004 3:52 am</h4>
    <div class="postbody"><span class="postbody">"RE" == reverse engineering<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16362 - ampz - Fri Feb 13, 2004 11:06 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Do you like pulling my strings and yanking my chain?? How about you do it for me???</td> </tr></table><span class="postbody">
<br/>
I didn't think someone really needed the ability to set the date/time right now. Especially not people with a incompatible EFA cart ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16367 - Cyberman - Fri Feb 13, 2004 6:17 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Do you like pulling my strings and yanking my chain?? How about you do it for me???</td> </tr></table><span class="postbody">
<br/>
I didn't think someone really needed the ability to set the date/time right now. Especially not people with a incompatible EFA cart ;-)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Indeed Stone knives and bear skins.. stone knives and bear skins ;)
<br/>
<br/>
I suppose there is nothing wrong with asking, however I wonder why he is so interested in playing with the RTC (hmmm).
<br/>
<br/>
Cyb<br/>_________________<br/>If at first you don't succeed parachuting is NOT for you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16376 - dagamer34 - Sat Feb 14, 2004 1:26 am</h4>
    <div class="postbody"><span class="postbody">I am trying to make a library that is "complete". RTC is missing, along with saving to EEPROM and Flash ROM. 
<br/>
<br/>
Just curious. Besides, i can't make a game right now since my trial version of PSP8 ran out and I won't get my copy for about 2 weeks.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16377 - tepples - Sat Feb 14, 2004 1:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Besides, i can't make a game right now since my trial version of PSP8 ran out and I won't get my copy for about 2 weeks.</td> </tr></table><span class="postbody">
<br/>
What does PSP do that <a class="postlink" href="http://www2.arnes.si/~sopjsimo/gimp/unstable.html" target="_blank">GIMP 2.0</a> doesn't?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16378 - ampz - Sat Feb 14, 2004 2:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">I am trying to make a library that is "complete". RTC is missing, along with saving to EEPROM and Flash ROM. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
Ah! I see.
<br/>
<br/>
To do things by the book, I should actually make a standard time.h implementation. I did look at it, but it felt kind of stupid because it would require me to first convert the already properly formated and BCD coded date and time to a single integer representing the time since 1979 in seconds. And, after that, the number has to be converted back to BCD coded date and time. That's why I did not do a time.h implementation :)
<br/>
<br/>
Does anyone know what kind of API N use for the RTC?</span><span class="gensmall"><br/><br/>Last edited by ampz on Sat Feb 14, 2004 2:23 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#16381 - dagamer34 - Sat Feb 14, 2004 2:23 am</h4>
    <div class="postbody"><span class="postbody">Words from the manufacturer of the EZFA: "use Nintendo RTC library~ and then let EZFA patch it."
<br/>
<br/>
So, I went looking through Pokemon Ruby and I found this string: "SIIRTC_V001". I suppose it has something to do with N's RTC library, but I think there is more. Any info on this?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16616 - ampz - Sat Feb 21, 2004 2:13 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Words from the manufacturer of the EZFA: "use Nintendo RTC library~ and then let EZFA patch it."
<br/>
<br/>
So, I went looking through Pokemon Ruby and I found this string: "SIIRTC_V001". I suppose it has something to do with N's RTC library, but I think there is more. Any info on this?</td> </tr></table><span class="postbody">
<br/>
<br/>
"use Nintendo RTC library~ and then let EZFA patch it."
<br/>
*LOL* EZFA sure are funny... Nintendo's libraries are not exactly publicly available.
<br/>
It is close to impossible to copy the library from a Pokemon cart. You must have access to the original library. See the problem here? :)
<br/>
<br/>
The string you found is simply the version number of the library.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24047 - dagamer34 - Tue Jul 27, 2004 12:22 am</h4>
    <div class="postbody"><span class="postbody">Sorry for bringing this topic back from the dead, but if I were able to get the "loader" off of the EZFA cart, could someone take a look at it and find out what addresses it writes to in order to access the RTC?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24052 - torne - Tue Jul 27, 2004 1:08 am</h4>
    <div class="postbody"><span class="postbody">Yeah, I'll have a look. My profile is filled with exciting ways to contact me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24075 - FluBBa - Tue Jul 27, 2004 2:24 pm</h4>
    <div class="postbody"><span class="postbody">Doesn't the clock in Pogoshell work on EZFA carts?
<br/>
The funny thing is that there are now 3 different clocks somewhat compatible with each other.
<br/>
My implementation in my emulators works on VBA and Pokemon cart/XRom/F2AU.
<br/>
Pogoshell works on VBA and EZFA (i think it is).
<br/>
Maybe it's possible to implement a routine that works on VBA, EZFA &amp; Pokemon cart.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24092 - dagamer34 - Tue Jul 27, 2004 8:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>torne wrote:</b></span></td> </tr> <tr> <td class="quote">Yeah, I'll have a look. My profile is filled with exciting ways to contact me.</td> </tr></table><span class="postbody">
<br/>
<br/>
Isn't that right! Anyway, it just hit me on the head that you can dump the EZFA cart with a different linker in order to get to the "loader" ROM. I heard someone did this with an EZF II PS. As soon as I get the ROM from this person, I'll give it to you.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24261 - ampz - Sat Jul 31, 2004 12:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">Doesn't the clock in Pogoshell work on EZFA carts?
<br/>
The funny thing is that there are now 3 different clocks somewhat compatible with each other.
<br/>
My implementation in my emulators works on VBA and Pokemon cart/XRom/F2AU.
<br/>
Pogoshell works on VBA and EZFA (i think it is).
<br/>
Maybe it's possible to implement a routine that works on VBA, EZFA &amp; Pokemon cart.</td> </tr></table><span class="postbody">
<br/>
<br/>
X-ROM and F2AU use exactly the same RTC as the Pokemon games. EZFA does not. As far as I know, the EZFA is not even remotely similar.
<br/>
<br/>
I don't see where you get the third RTC?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24270 - phonymike - Sat Jul 31, 2004 6:24 am</h4>
    <div class="postbody"><span class="postbody">I have a boktai cart, and would like to try this code on it. maybe tomorrow :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24279 - wintermute - Sat Jul 31, 2004 11:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Besides, i can't make a game right now since my trial version of PSP8 ran out and I won't get my copy for about 2 weeks.</td> </tr></table><span class="postbody">
<br/>
What does PSP do that <a class="postlink" href="http://www2.arnes.si/~sopjsimo/gimp/unstable.html" target="_blank">GIMP 2.0</a> doesn't?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
update the screen today :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24283 - tepples - Sat Jul 31, 2004 4:00 pm</h4>
    <div class="postbody"><span class="postbody">wintermute: Did you refer to the fact that the link to GIMP 2.0 unstable is now a 404? That's because the link to <a class="postlink" href="http://www2.arnes.si/~sopjsimo/gimp/stable.html" target="_blank">GIMP 2.0 stable</a> now works.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24293 - wintermute - Sat Jul 31, 2004 10:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">wintermute: Did you refer to the fact that the link to GIMP 2.0 unstable is now a 404? That's because the link to <a class="postlink" href="http://www2.arnes.si/~sopjsimo/gimp/stable.html" target="_blank">GIMP 2.0 stable</a> now works.</td> </tr></table><span class="postbody">
<br/>
<br/>
no, I meant if your PC isn't exactly up to date then you can have a coffee while it redraws things.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24299 - dagamer34 - Sun Aug 01, 2004 2:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">wintermute: Did you refer to the fact that the link to GIMP 2.0 unstable is now a 404? That's because the link to <a class="postlink" href="http://www2.arnes.si/~sopjsimo/gimp/stable.html" target="_blank">GIMP 2.0 stable</a> now works.</td> </tr></table><span class="postbody">
<br/>
<br/>
no, I meant if your PC isn't exactly up to date then you can have a coffee while it redraws things.</span></td> </tr></table><span class="postbody">
<br/>
Probably breakfast too.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24417 - FluBBa - Tue Aug 03, 2004 11:01 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">X-ROM and F2AU use exactly the same RTC as the Pokemon games. EZFA does not. As far as I know, the EZFA is not even remotely similar.
<br/>
<br/>
I don't see where you get the third RTC?</td> </tr></table><span class="postbody">
<br/>
VBAs implementation, apparently Pogoshells clock works in VBA, as does my code.
<br/>
Pogoshells clock doesn't work on X-Rom but works on EZFA.
<br/>
My code works on X-Rom but not on EZFA.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24429 - dagamer34 - Tue Aug 03, 2004 4:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">X-ROM and F2AU use exactly the same RTC as the Pokemon games. EZFA does not. As far as I know, the EZFA is not even remotely similar.
<br/>
<br/>
I don't see where you get the third RTC?</td> </tr></table><span class="postbody">
<br/>
VBAs implementation, apparently Pogoshells clock works in VBA, as does my code.
<br/>
Pogoshells clock doesn't work on X-Rom but works on EZFA.
<br/>
My code works on X-Rom but not on EZFA.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Are you sure Pogoshell's clock works on EZFA? Let me go check...<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24450 - ampz - Tue Aug 03, 2004 9:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">X-ROM and F2AU use exactly the same RTC as the Pokemon games. EZFA does not. As far as I know, the EZFA is not even remotely similar.
<br/>
<br/>
I don't see where you get the third RTC?</td> </tr></table><span class="postbody">
<br/>
VBAs implementation, apparently Pogoshells clock works in VBA, as does my code.
<br/>
Pogoshells clock doesn't work on X-Rom but works on EZFA.
<br/>
My code works on X-Rom but not on EZFA.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
If what you say is true then VBA must emulate both the standard RTC and the EZFA RTC, and pogoshell only supports the EZFA RTC.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24459 - dagamer34 - Wed Aug 04, 2004 12:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">X-ROM and F2AU use exactly the same RTC as the Pokemon games. EZFA does not. As far as I know, the EZFA is not even remotely similar.
<br/>
<br/>
I don't see where you get the third RTC?</td> </tr></table><span class="postbody">
<br/>
VBAs implementation, apparently Pogoshells clock works in VBA, as does my code.
<br/>
Pogoshells clock doesn't work on X-Rom but works on EZFA.
<br/>
My code works on X-Rom but not on EZFA.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
What version of PogoShell were you using?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24470 - FluBBa - Wed Aug 04, 2004 8:59 am</h4>
    <div class="postbody"><span class="postbody">Hmmm, was I dreaming? Or did I use Sasq's SDL version of VBA?
<br/>
Sorry for any confusion, I have to check this out.
<br/>
brb.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25211 - dagamer34 - Wed Aug 18, 2004 9:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>torne wrote:</b></span></td> </tr> <tr> <td class="quote">Yeah, I'll have a look. My profile is filled with exciting ways to contact me.</td> </tr></table><span class="postbody">
<br/>
<br/>
I finally got the loader off of the cart. Check your e-mail. I sent it to you earlier.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25224 - MonkeyBoy666 - Thu Aug 19, 2004 1:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">my trial version of PSP8 ran out and I won't get my copy for about 2 weeks.</td> </tr></table><span class="postbody">
<br/>
<br/>
ok i don't know if this works with 8 but it does with 7 and 6 of psp. Why don't you try to set your system clock back to a time when the trial was working. I know this is technally wrong but if you can't wait two weeks for your new one to come then...(it is only for 2 weeks)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25229 - dagamer34 - Thu Aug 19, 2004 2:32 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MonkeyBoy666 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">my trial version of PSP8 ran out and I won't get my copy for about 2 weeks.</td> </tr></table><span class="postbody">
<br/>
<br/>
ok i don't know if this works with 8 but it does with 7 and 6 of psp. Why don't you try to set your system clock back to a time when the trial was working. I know this is technally wrong but if you can't wait two weeks for your new one to come then...(it is only for 2 weeks)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
...
<br/>
<br/>
It might help to look at the time of which I posted that, you know. Because sometimes old threads can be revived, like I did. I already have a legal copy of PSP8. Thanks for trying to help though. :)<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26655 - ampz - Wed Sep 22, 2004 1:46 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">Pogoshells clock doesn't work on X-Rom but works on EZFA.</td> </tr></table><span class="postbody">
<br/>
The pogoshell clock works on X-Rom.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26660 - FluBBa - Wed Sep 22, 2004 10:27 am</h4>
    <div class="postbody"><span class="postbody">Strange... I talked to Sasq yesterday and he said it didn't, I am going to take a look at the code to see what it does.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26663 - ampz - Wed Sep 22, 2004 3:07 pm</h4>
    <div class="postbody"><span class="postbody">Well, the RTC support is not perfect..
<br/>
<br/>
First of all, Pogoshell ignores the RTC if the RTC is set to operate in AM/PM mode.
<br/>
So, make sure the RTC operates in 24 hour mode.
<br/>
<br/>
In 24 hour mode, pogoshell will detect the RTC and correctly display time between 0:00-11:59.
<br/>
However, when the RTC is 12:00-23:59, pogoshell (for some reason) adds another 12 hours to the time. 15:00 becomes 27:00, and so on..
<br/>
<br/>
Seems to me he requires the RTC to be in 24hour mode, but still adds the AM/PM indicator to the total.
<br/>
<br/>
You can use my multiboot RTC utility to view and change RTC settings:
<br/>
<a href="http://www.brolinembedded.se/misc/rtc.mb" target="_blank">http://www.brolinembedded.se/misc/rtc.mb</a>
<br/>
(Works for all Pokemon compatible RTCs)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26679 - FluBBa - Thu Sep 23, 2004 8:43 am</h4>
    <div class="postbody"><span class="postbody">Ok =)
<br/>
You're not planing to share the code to it?
<br/>
Sasq told me he only has one implementation of the RTC code, and it does work on VBA and EZ card (and apparently allmost on X-ROM) so it shouldn't be too hard to make a "generic" routine that really works on all cards, should it?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26680 - ampz - Thu Sep 23, 2004 9:11 am</h4>
    <div class="postbody"><span class="postbody">I released source code for reading the RTC half a year ago:
<br/>
<a class="postlink" href="http://www.brolinembedded.se/projects/gba_rtc/" target="_blank">http://www.brolinembedded.se/projects/gba_rtc/</a>
<br/>
<br/>
The code for setting the RTC is too ugly for someone else than me to see for now... :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26681 - ampz - Thu Sep 23, 2004 9:37 am</h4>
    <div class="postbody"><span class="postbody">The bit read by pogoshell's "check_val" is the 12/24 hour mode bit.
<br/>
If it is 0 the RTC operates in 12 hour mode.
<br/>
If it is 1 the RTC operates in 24 hour mode.
<br/>
The bit can be both read and written.
<br/>
<br/>
(The most significant bit in the hour-register is the AM/PM indicator when in 12 hour mode)
<br/>
<br/>
EDIT
<br/>
<br/>
It is as I suspected, pogoshell requires the RTC to operate in 24hour mode (check_val), and then adds the AM/PM indicator to the result anyway:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   tm-&gt;tm_hour = UNBCD(data[4] &amp; 0x3F);
<br/>
   if(data[4] &amp; 0x80)
<br/>
      tm-&gt;tm_hour += 12;
<br/>
</td> </tr></table><span class="postbody">
<br/>
*****
<br/>
Here is some info on the features of the RTC:
<br/>
<br/>
The command sent to the RTC consist of theese bits:
<br/>
0110ABCD
<br/>
<br/>
0110 are always fixed.
<br/>
ABC is the register we want to read or write.
<br/>
D is the read/write bit. (0=write)
<br/>
<br/>
The registers:
<br/>
000: RTC is reset if this register is read or written.
<br/>
001: Status register.
<br/>
010: RTC data access 1 (reads/writes year, month, day, dayofweek, hours, minutes, seconds)
<br/>
011: RTC data access 2 (only reads/writes hours, minutes and seconds)
<br/>
100: Alarm settings. (Not sure how this works, I think it is supposed to be able to generate a interrupt. Don't think the interrupt pin is connected on any GBA carts anyway)
<br/>
110: Factory test mode stuff. Not sure how it works, don't touch it.
<br/>
111: Factory test mode stuff. Not sure how it works, don't touch it.
<br/>
<br/>
The status register consists of theese bits: 76543210
<br/>
<br/>
7: Power interruption detection. Power has been interrupted if this is 1. RTC needs to be reset to clear this flag.
<br/>
6: 24/12 hour mode.
<br/>
5: Alarm enable.
<br/>
4: Unused.
<br/>
3: Alarm mode setting something.
<br/>
2: Unused.
<br/>
1: Alarm mode setting something.
<br/>
0: Unused.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26684 - FluBBa - Thu Sep 23, 2004 3:53 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the info.
<br/>
Maybe it's time to put together a doc about it?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26695 - dagamer34 - Thu Sep 23, 2004 10:11 pm</h4>
    <div class="postbody"><span class="postbody">Pogoshell RTC works on a EZFA cart?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26711 - FluBBa - Fri Sep 24, 2004 8:46 am</h4>
    <div class="postbody"><span class="postbody">I'm not sure, aren't there two kinds of EZ? like "just" EZ and EZFA?
<br/>
The code in Pogoshell looks just like the code I'm using in my emulators, except I check RTCEnable to be 1 after I have written 1 to it.
<br/>
More info about it after I have done some testing.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26718 - ampz - Fri Sep 24, 2004 1:02 pm</h4>
    <div class="postbody"><span class="postbody">Well, except that pogoshell handle 12:00-23:59 kind of weird :-)
<br/>
<br/>
There is the EFA, it is not the same as EZFA, but I don't think the EFA has a RTC. Are EZ and EZFA two different things?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26720 - FluBBa - Fri Sep 24, 2004 1:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">Are EZ and EZFA two different things?</td> </tr></table><span class="postbody">
<br/>
I don't know =)
<br/>
Stupid manufacturers choosing the same name just to confuse customers.
<br/>
I've got the EZ3 now (no FA in that name at least) which should open up for some new possibilitys.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26721 - ampz - Fri Sep 24, 2004 1:30 pm</h4>
    <div class="postbody"><span class="postbody">At least the xrom does not have a confusing name.
<br/>
What are the features of the EZ3?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26724 - SimonB - Fri Sep 24, 2004 2:01 pm</h4>
    <div class="postbody"><span class="postbody">The Extreme Flash Advance (EFA) has an RTC.
<br/>
<br/>
Simon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26727 - ampz - Fri Sep 24, 2004 2:43 pm</h4>
    <div class="postbody"><span class="postbody">Ok.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26845 - FluBBa - Mon Sep 27, 2004 10:38 am</h4>
    <div class="postbody"><span class="postbody">The EZ3 has got 256Mbit of NOR flash plus 32Mbit more for bootmenu stuff, 128Mbit RAM and 1024Mbit NAND flash with FAT16 filesystem on it.
<br/>
And a RTC...
<br/>
The only change I did in my code to get the RTC to work on the EZ3 was to change the check for RTCEnable to be !=0 instead of ==1.
<br/>
The RTC in Pokemon gives you a 1 after you have written 1 to it, the EZ3 gives you back something else (sorry about not testing it more).<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26861 - ampz - Mon Sep 27, 2004 10:06 pm</h4>
    <div class="postbody"><span class="postbody">Only the least significant bit is valid. You must perform a AND operation with 0x0001 to mask out the RTC enable bit before you can compare it to 1.
<br/>
Usually the other 15 bits are all zeroes, but they don't have to be.
<br/>
<br/>
I don't particularly like the NOR+NAND combination carts... It takes quite a while to switch games, and you rewrite the flash memory every time you switch games. Thoose carts usually use Intel flash with a life-expectancy of only 10000 erase operations.
<br/>
<br/>
128Mbit battery backed RAM sounds... unlikely... (and highly unnecessary). There must be a catch? Low power 128Mbit SRAM chips don't exactly grow on trees...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26886 - FluBBa - Tue Sep 28, 2004 10:24 am</h4>
    <div class="postbody"><span class="postbody">The 128Mbit RAM is not battery backed... do you see where this is heading?
<br/>
It has battery backed ram as well.
<br/>
The 128Mbit RAM is used instead of the NOR flash so the time switching games is quite small.
<br/>
They should probably have skipped the NOR flash completly (except for the 32Mbit bootstuff) and just used 256Mbit RAM instead.
<br/>
<br/>
The RAM can be bank switched to different regions of the address space, so you can have NOR and RAM in the "rom" area of the GBA I think...<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26894 - ampz - Tue Sep 28, 2004 1:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">The 128Mbit RAM is not battery backed... do you see where this is heading?</td> </tr></table><span class="postbody">
<br/>
I am. :)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">They should probably have skipped the NOR flash completly (except for the 32Mbit bootstuff) and just used 256Mbit RAM instead.</td> </tr></table><span class="postbody">
<br/>
Indeed.
<br/>
<br/>
Replacing flash with DRAM is a nice touch. It is probably a decent flash cart.
<br/>
But I dunno... Simplicity is also a good thing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38376 - lotus49 - Sat Mar 26, 2005 8:09 pm</h4>
    <div class="postbody"><span class="postbody">I am currently struggling with the RTC.
<br/>
<br/>
I am pretty new to GBA development and I have seen code to access the RTC on my F2AU cart.  Unfortunately the one I was able to follow (ie Timmy Brolin's RTC demo) didn't work (all it said was "No RTC detected") and the one that worked (ie Goomba) was all in assembler and I am not yet familiar enough with ARM assembler to extract the relevant bit and compile it.
<br/>
<br/>
Has anyone succesfully tested the RTC demo on a F2AU cart?  Does anyone have any suggestions as to why it doesn't work on my GBA SP?
<br/>
<br/>
TIA</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38516 - ampz - Mon Mar 28, 2005 8:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>lotus49 wrote:</b></span></td> </tr> <tr> <td class="quote">I am currently struggling with the RTC.
<br/>
<br/>
I am pretty new to GBA development and I have seen code to access the RTC on my F2AU cart.  Unfortunately the one I was able to follow (ie Timmy Brolin's RTC demo) didn't work (all it said was "No RTC detected") and the one that worked (ie Goomba) was all in assembler and I am not yet familiar enough with ARM assembler to extract the relevant bit and compile it.
<br/>
<br/>
Has anyone succesfully tested the RTC demo on a F2AU cart?  Does anyone have any suggestions as to why it doesn't work on my GBA SP?
<br/>
<br/>
TIA</td> </tr></table><span class="postbody">
<br/>
My code did not detect the F2AU RTC? That's weird..
<br/>
Try removing the check for the "RTC enabled" bit. Perhaps they did a cheap implementation and skipped that feedback bit.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38525 - lotus49 - Mon Mar 28, 2005 10:17 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for replying Timmy - I was hoping you would.
<br/>
<br/>
I have now found that there were two problems with my setup.
<br/>
<br/>
Firstly, the rtc_detect() code didn't correctly detect my F2AU 1GB cart.  The demo didn't work unless I commented out the relevant section of main.c.
<br/>
<br/>
However, doing this wasn't enough.  There were also problems with the call to scrWaitVSync() at the beginning of the main loop.  For some reason that I haven't figured out yet, this doesn't work on my setup and just hangs indefinitely.
<br/>
<br/>
The code I have been using to wait for the next vblank is:
<br/>
<br/>
volatile u16* ScanLineCounter = (volatile u16*)0x4000006;
<br/>
<br/>
void waitVBlank(void)
<br/>
{
<br/>
    while (!(*ScanLineCounter));
<br/>
    while ((*ScanLineCounter));
<br/>
}
<br/>
<br/>
which seems to work.
<br/>
<br/>
I don't know whether the development environment is relevant but I am using HAM and VisualHAM.
<br/>
<br/>
However, the end result of this is that I do now have code that I understand that works on my hardware.  It does look as though the F2AU RTC is mostly, but not completely compatible with the Pokemon carts, although it does seem strange that I have played Pokemon Sapphire all the way through on this cart and the clock based events worked exactly as expected with no error messages of any sort.
<br/>
<br/>
Thanks for your help Timmy, it has been very useful.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38588 - ampz - Tue Mar 29, 2005 11:19 am</h4>
    <div class="postbody"><span class="postbody">The scrWaitVSync() issue is probably a compiler optimization thing.
<br/>
<br/>
Have you tried enabling the rtc_detect() code after you fixed the scrWaitVSync() problem?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38635 - Kyoufu Kawa - Tue Mar 29, 2005 8:16 pm</h4>
    <div class="postbody"><span class="postbody">Hey, quick question. I have that one C code for RTC support, but how exactly does one -set- the time?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38639 - lotus49 - Tue Mar 29, 2005 8:38 pm</h4>
    <div class="postbody"><span class="postbody">I haven't tried this yet, but since the detection code happens before the first call to scrWaitVSync() I wouldn't have thought it would make any difference.
<br/>
<br/>
I'll give it a go and feedback.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38678 - ampz - Wed Mar 30, 2005 6:23 am</h4>
    <div class="postbody"><span class="postbody">The detection code, yes, but not the code that writes the result to the screen, right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38763 - Kyoufu Kawa - Thu Mar 31, 2005 1:01 pm</h4>
    <div class="postbody"><span class="postbody">This is weird. I got Tim's RTC sample and tried assimilating it...
<br/>
<br/>
Considering RTC.C is completely untouched, and I have this in my main code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(rtc_detect())
<br/>
   //write "enabled" message
<br/>
else
<br/>
   //write "failed" message
<br/>
<br/>
while(1)
<br/>
{
<br/>
   DoVBlank();
<br/>
   KeyRead();
<br/>
   rtc_init_transfer();
<br/>
   sprintf(mystring, "%02x/%02x/%02x %d %02x:%02x:%02x", rtc_read(), rtc_read(), rtc_read(), rtc_read(), rtc_read(), rtc_read(), rtc_read());
<br/>
   //write mystring to screen
<br/>
   rtc_end_transfer();
<br/>
   if(Trg &amp; A_BUTTON) break;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
...why do I get <span style="font-weight: bold">00/00/00 0 00:00:00</span>?
<br/>
<br/>
btw, I still can't fathom the idea of ROM space being writable just like that &gt;_&gt;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38772 - ampz - Thu Mar 31, 2005 4:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kyoufu Kawa wrote:</b></span></td> </tr> <tr> <td class="quote">This is weird. I got Tim's RTC sample and tried assimilating it...
<br/>
<br/>
Considering RTC.C is completely untouched, and I have this in my main code:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(rtc_detect())
<br/>
   //write "enabled" message
<br/>
else
<br/>
   //write "failed" message
<br/>
<br/>
while(1)
<br/>
{
<br/>
   DoVBlank();
<br/>
   KeyRead();
<br/>
   rtc_init_transfer();
<br/>
   sprintf(mystring, "%02x/%02x/%02x %d %02x:%02x:%02x", rtc_read(), rtc_read(), rtc_read(), rtc_read(), rtc_read(), rtc_read(), rtc_read());
<br/>
   //write mystring to screen
<br/>
   rtc_end_transfer();
<br/>
   if(Trg &amp; A_BUTTON) break;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
...why do I get <span style="font-weight: bold">00/00/00 0 00:00:00</span>?
<br/>
<br/>
btw, I still can't fathom the idea of ROM space being writable just like that &gt;_&gt;</span></td> </tr></table><span class="postbody">
<br/>
<br/>
The original RTC demo works on your hardware?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38792 - Kyoufu Kawa - Thu Mar 31, 2005 8:59 pm</h4>
    <div class="postbody"><span class="postbody">The original RTC demo froze up in VBA because it couldn't detect the thing, and my hardware doesn't support it.
<br/>
<br/>
Edit: even worse, the damn thing didn't even -start-!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38805 - ampz - Thu Mar 31, 2005 10:59 pm</h4>
    <div class="postbody"><span class="postbody">If it does not even start then perhaps it just needs a header fix. I don't remember if I distributed the rtc.bin file with or without a valid header.
<br/>
I have distributed most if not all my binaries without valid headers due to the legal greyzone.
<br/>
Any of a hundred different program will fix the header for you.
<br/>
<br/>
Note that rtc.bin is a multiboot binary.
<br/>
I made it that way so that you can run it on all kinds of hardware, including original pokemon carts.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38844 - Fatnickc - Fri Apr 01, 2005 11:08 am</h4>
    <div class="postbody"><span class="postbody">Does anyone know how you change the date/time on an EZFA?
<br/>
<br/>
EDIT : Don't worry, Found it is L + R + Start</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38879 - Kyoufu Kawa - Fri Apr 01, 2005 4:41 pm</h4>
    <div class="postbody"><span class="postbody">Well, my header files (romheader.s and crt.s), aside from name and code fields, comes straight from you-know-where, so that can't be it.
<br/>
<br/>
It's not multiboot, btw. VBA, currently my only means of testing, has the RTC turned on.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38907 - lotus49 - Fri Apr 01, 2005 10:17 pm</h4>
    <div class="postbody"><span class="postbody">I can get the code to work fine (with the amendments I referred to earlier in the thread) but it doesn't work on VBA  - I get the same result.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38911 - ampz - Fri Apr 01, 2005 11:20 pm</h4>
    <div class="postbody"><span class="postbody">The rtc.bin file in the .zip file downloadable from: <a href="http://www.brolinembedded.se/projects/gba_rtc/" target="_blank">http://www.brolinembedded.se/projects/gba_rtc/</a> IS a multiboot image.
<br/>
<br/>
If you have recompiled the source code to be cart bootable, then that's another thing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38982 - Kyoufu Kawa - Sat Apr 02, 2005 9:07 pm</h4>
    <div class="postbody"><span class="postbody">Okay consider this.
<br/>
<br/>
I got a non-multiboot game I'm working on and would like it to have an RTC. I use the Library That Shan't Be Named (tm pending), as we all know.
<br/>
<br/>
Why does rtc_read() return zeroes?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38983 - ampz - Sat Apr 02, 2005 9:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kyoufu Kawa wrote:</b></span></td> </tr> <tr> <td class="quote">Okay consider this.
<br/>
<br/>
I got a non-multiboot game I'm working on and would like it to have an RTC. I use the Library That Shan't Be Named (tm pending), as we all know.
<br/>
<br/>
Why does rtc_read() return zeroes?</td> </tr></table><span class="postbody">
<br/>
Dunno. Does the original rtc.bin binary work on your hardware?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39033 - Kyoufu Kawa - Sun Apr 03, 2005 2:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">Dunno. Does the original rtc.bin binary work on your hardware?</td> </tr></table><span class="postbody">Haha. One, the kid next door has my flash card right now, playing Hamtaro. Two, it doesn't have an RTC.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39052 - ampz - Sun Apr 03, 2005 10:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kyoufu Kawa wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">Dunno. Does the original rtc.bin binary work on your hardware?</td> </tr></table><span class="postbody">Haha. One, the kid next door has my flash card right now, playing Hamtaro. Two, it doesn't have an RTC.</span></td> </tr></table><span class="postbody">Your hardware does not have a RTC, and you are asking me why rtc_read() is returning zeroes?
<br/>
<br/>
I don't know if VBA is emulating a RTC decently enough, try some other RTC software based on my code. Goomba or something. See if they work on VBA.
<br/>
<br/>
As a programmer you should know that the question "Why does rtc_read() return zeroes?" cannot be answered. There is simply way too little information given. It is like asking "Why does blabla.exe crash?".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39096 - Kyoufu Kawa - Mon Apr 04, 2005 2:45 pm</h4>
    <div class="postbody"><span class="postbody">You're right. It's not that high a priority anyway, so I'll just be on my way, thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39108 - ampz - Mon Apr 04, 2005 5:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kyoufu Kawa wrote:</b></span></td> </tr> <tr> <td class="quote">You're right. It's not that high a priority anyway, so I'll just be on my way, thanks.</td> </tr></table><span class="postbody">
<br/>
I'd suggest you first try to make the rtc detection routine work. It is very simple. If you get that one to work then you know that you have access to the RTC port.
<br/>
How RTC detection (and enabling) works:
<br/>
(optional) Make a 16 bit read from 0x080000c8, LSB of data read should normally be 0.
<br/>
(mandatory) Make a 16 bit write to 0x080000c8, LSB of data written should be 1.
<br/>
(verification/detection) Make a 16 bit read from 0x080000c8, LSB of data read should now be 1.
<br/>
<br/>
You can disable the RTC again by writing 0 to 0x080000c8</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39119 - Kyoufu Kawa - Mon Apr 04, 2005 6:36 pm</h4>
    <div class="postbody"><span class="postbody">Well, I'll have a quick look then, see if it detects... but I can't do any hardware trials.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39232 - lotus49 - Wed Apr 06, 2005 9:23 am</h4>
    <div class="postbody"><span class="postbody">I have been playing with the code (as you know) and I have just realised why I was having trouble with it.
<br/>
<br/>
On my hardware (F2A Ultra 1Gb) the detection code didn't appear to work (although this may be worth further investigation now) so I removed it.  If I then inserted a delay so the time refreshed every 10 seconds rather than every vblank, the very first time the rtc is read, it returns all zeroes.  For the second and subsequent reads, it works fine.
<br/>
<br/>
I wonder if this it related to not using the detection code but I haven't had time to check.  I'll have a look at this tonight if I have time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39235 - ampz - Wed Apr 06, 2005 10:43 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>lotus49 wrote:</b></span></td> </tr> <tr> <td class="quote">I have been playing with the code (as you know) and I have just realised why I was having trouble with it.
<br/>
<br/>
On my hardware (F2A Ultra 1Gb) the detection code didn't appear to work (although this may be worth further investigation now) so I removed it.  If I then inserted a delay so the time refreshed every 10 seconds rather than every vblank, the very first time the rtc is read, it returns all zeroes.  For the second and subsequent reads, it works fine.
<br/>
<br/>
I wonder if this it related to not using the detection code but I haven't had time to check.  I'll have a look at this tonight if I have time.</td> </tr></table><span class="postbody">
<br/>
Yes, it think could be related.
<br/>
<br/>
The fact that your code works after inserting a 10second delay rather than updating on Vblank suggests that the VBlank detection code is not working properly..
<br/>
<br/>
Something that can cause problems in general is optimizing compilers trying to be a bit too clever. Disabling compiler optimization should of course be the first thing you try when you have problems.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39368 - Dib - Fri Apr 08, 2005 12:43 am</h4>
    <div class="postbody"><span class="postbody">Has anybody ever figured out how to operate the EZFA RTC?
<br/>
<br/>
The EZFA in question is the one from gba-toys.com, manufactured by Borden.  I ask more out of curiosity than necessity, but considering that I own an EZFA 256 it would definitely be nice to know that it's there for me to use if I get around to it.
<br/>
<br/>
I know that Boktai 2, a game heavily reliant on RTC, is able to use it.  It tracks date and time successfully on my cart.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39370 - tepples - Fri Apr 08, 2005 12:55 am</h4>
    <div class="postbody"><span class="postbody">Boktai 2 can talk to the EZFA RTC because the EZFA software patches the Nintendo RTC library. Unfortunately, a year ago, <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=16381#16381" target="_blank">Borden didn't seem to care about homebrewers</a>, who don't have the Nintendo RTC library.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39374 - Dib - Fri Apr 08, 2005 2:33 am</h4>
    <div class="postbody"><span class="postbody">Ah.  I read that post while backreading but it didn't register in relation to this, other than the fact that I already knew Borden doesn't support the cart and refuses to disclose details about it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39432 - lotus49 - Fri Apr 08, 2005 8:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Boktai 2 can talk to the EZFA RTC because the EZFA software patches the Nintendo RTC library. Unfortunately, a year ago, <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=16381#16381" target="_blank">Borden didn't seem to care about homebrewers</a>, who don't have the Nintendo RTC library.</td> </tr></table><span class="postbody">
<br/>
<br/>
If I am to be cynical about it, Borden doesn't care about his customers either.  The software for the EZFA is decidedly flaky (eg sometimes saver backups are corrupt - I lost a saver for a game I had played for &gt;30 hours due to this) and is no longer being maintained.  Borden has long since stopped making an appearance in his own forums.  I shan't be buying anything from him again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39445 - tepples - Fri Apr 08, 2005 11:35 pm</h4>
    <div class="postbody"><span class="postbody">I'm correct in assuming that <a class="postlink" href="http://www.gba-toys.com/default.aspx?tabid=27" target="_blank">Borden</a> has no relation to <a class="postlink" href="http://www.dfamilk.com/who_we_are/plants/products/adbborden/default.htm" target="_blank">Borden</a>, right?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39447 - lotus49 - Fri Apr 08, 2005 11:40 pm</h4>
    <div class="postbody"><span class="postbody">I think that's a pretty safe bet unless he manages to split his time between the Far East and the Mid West.  We've seen plenty of cheesy games for the GBA, but cheesy cartridges, that would be an interesting development.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
