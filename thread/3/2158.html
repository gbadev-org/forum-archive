<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>An alternative to buttons: interfacing? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Hardware > An alternative to buttons: interfacing?</h2>
<div id="posts">
<div class="post">
    <h4>#11206 - cesium - Mon Sep 29, 2003 12:50 am</h4>
    <div class="postbody"><span class="postbody">I need to create my own hardware user interface for the GBA
<br/>
that will be running an existing game.
<br/>
<br/>
I thought it would be pretty easy. (Wrong!)
<br/>
<br/>
I popped open one of my GBAs and I found that most of the buttons are pretty strange.
<br/>
It appears that, for example the up/down/left/right pad is constructed from unique gold plated pads on the PCB.
<br/>
<br/>
I'm not sure, but it looks like
<br/>
the "switch closure" is performed by a little rubber blob that is pushed
<br/>
down across a gap in the pads. What a hassle!!
<br/>
<br/>
Does anyone have a software strategy for implementing a user interface
<br/>
that bypasses the buttons? The games probably read the "key pressed"
<br/>
register just like I do... Would it be possible to "patch" a game to read
<br/>
a different register or call my code?
<br/>
<br/>
That sounds awfully hard, but I thought I'd post it in case you have seen
<br/>
something like this.
<br/>
<br/>
I'll tinker with shorting the gold pads together with a FET transistor.
<br/>
Or even pulling one of them low with a FET.
<br/>
<br/>
Does anyone know the details of which pins on the ARM do the keypad IO?
<br/>
Do you have details of the key pad circuits on the GBA?
<br/>
<br/>
Thanks!,
<br/>
cesium</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11212 - tepples - Mon Sep 29, 2003 4:08 am</h4>
    <div class="postbody"><span class="postbody">If you wanted to make your own GBA input device for your own programs, it'd probably be a better idea to make it a serial device that connects to the "EXT.|&gt;" connector at the edge of the machine.
<br/>
<br/>
It'd be possible to patch others' proprietary programs to change their input methods; just debug and look for reads from 0x04000130. Or you could just short the connectors when needed.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11229 - cesium - Mon Sep 29, 2003 5:11 pm</h4>
    <div class="postbody"><span class="postbody">Hey tepples!
<br/>
Right. I am not too familiar with ARM assembler. I was worried that
<br/>
there are a dozen ways to access the key input register...
<br/>
like on a PIC processor you might see "bit test F and skip if set"
<br/>
as well as ANDing and Oring and Loading....
<br/>
Would I need to basically scan the machine code looking for all
<br/>
commands that would be peeking at this register?
<br/>
<br/>
OOps! I forgot, my "hook" would have to fit into the code that I removed!
<br/>
It would have to be a subroutine call...
<br/>
<br/>
I think I like the "short the pads" method!
<br/>
<br/>
cesium</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11237 - cesium - Mon Sep 29, 2003 7:41 pm</h4>
    <div class="postbody"><span class="postbody">Just saw this on slashdot...
<br/>
<br/>
<a class="postlink" href="http://pages.prodigy.net/tan.ax/GBAConsole/gbaconsole.htm" target="_blank">http://pages.prodigy.net/tan.ax/GBAConsole/gbaconsole.htm</a>
<br/>
<br/>
It had this image for connecting an external joystick...
<br/>
<a href="http://pages.prodigy.net/tan.ax/GBAConsole/GBAtestpoints.jpg" target="_blank">http://pages.prodigy.net/tan.ax/GBAConsole/GBAtestpoints.jpg</a>
<br/>
<br/>
Looks like I just GND the TP's to produce a key press event.
<br/>
<br/>
cesium
<br/>
<br/>
[MOD: please do not "hotlink" images on servers other than your own]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12898 - cesium - Sun Nov 30, 2003 3:27 am</h4>
    <div class="postbody"><span class="postbody">Well, I modded the GBA to use an external controller, but there
<br/>
is a ton of work involved in pulling apart the unit and soldering to
<br/>
traces on the PCB.
<br/>
<br/>
Tepples, does your gut tell you that the idea of looking for
<br/>
reads to the keypad register could be practical?
<br/>
<br/>
I thought of scanning the machine code for instructions that
<br/>
read the register, but you mentioned 'debug' and looking for
<br/>
reads. I'm not sure I follow you.
<br/>
<br/>
Your replies have been tremendous help to me over the past year,
<br/>
thank you.
<br/>
<br/>
cesium</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13369 - haduken - Fri Dec 12, 2003 12:01 am</h4>
    <div class="postbody"><span class="postbody">You could get a SNES controller, for example, and patch it onto (using lots of latches and nand gates...) the GBA's serial port.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13747 - AcidGame - Mon Dec 22, 2003 4:32 am</h4>
    <div class="postbody"><span class="postbody">Not sure if its possible, but like tebbles ( sp? ) said, wouldnt it be a heck of alot easier to make a thing that connects to the EXT|-&gt; port, and a game have registered information send to it?
<br/>
<br/>
edit:
<br/>
<br/>
The hardware being connected obviously ( itself ) registers its own data. Get some emulating information on the object's registers and make your game correspond to both sets of registers.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13748 - tepples - Mon Dec 22, 2003 5:00 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>cesium wrote:</b></span></td> </tr> <tr> <td class="quote">Tepples, does your gut tell you that the idea of looking for reads to the keypad register could be practical?</td> </tr></table><span class="postbody">
<br/>
It worked for <span style="font-style: italic">Mario Paint</span> for Super NES. One of the ROMs floating around has a trainer that allows use of a standard Super NES controller instead of a mouse.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I thought of scanning the machine code for instructions that read the register</td> </tr></table><span class="postbody">
<br/>
That's not quite easy because compilers generate so many different ways to read from a given address on ARM or Thumb. It's not like MIPS where you can just look for lui/lw pairs.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Your replies have been tremendous help to me over the past year, thank you.</td> </tr></table><span class="postbody">
<br/>
You're welcome.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
