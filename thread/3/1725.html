<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Game Boy Player & Single-System Multiplayer - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Hardware > Game Boy Player & Single-System Multiplayer</h2>
<div id="posts">
<div class="post">
    <h4>#8794 - abilyk - Sun Jul 20, 2003 7:41 am</h4>
    <div class="postbody"><span class="postbody">I read on game news site <a href="http://www.gamerfeed.com" target="_blank">www.gamerfeed.com</a> about a month ago that when run on the Game Boy Player, Square's upcoming Sword of Mana would allow 2 players to each connect a 'cube controller to the system and play using only the GB Player.
<br/>
<br/>
I know that GBA games are able to detect the Player; I've seen it done ("Game Boy Player" splash screen) with the Japanese version of Mario Advance 4.  But I can't find any technical information on the Player online... I know that the GBA (SP) only has one keypad input register, but is it possible that N put additional input registers into the GB Player's version of the GBA hardware?
<br/>
<br/>
Was Gamerfeed simply misinformed about Mana's multiplayer features, or might there be some validity to this?  Anybody?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8797 - Lord Graga - Sun Jul 20, 2003 12:02 pm</h4>
    <div class="postbody"><span class="postbody">Well, isn't there only one way to find out?
<br/>
Write a program that listens to different unused registers and upload it to the cube!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9680 - FluBBa - Wed Aug 13, 2003 6:26 pm</h4>
    <div class="postbody"><span class="postbody">I've just been testing the new Pokemon Pinball and it does indeed support rumble on the Gameboy Player and it even detects that it runs on a GBP, you can't select rumble if it's not run on the GBP. I've been doing some preliminary tests on the GBP but haven't found anything yet. Maybe I should download the source to VBA and make some checks in it.
<br/>
Anybody else got any good ideas?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9712 - sgeos - Thu Aug 14, 2003 6:25 pm</h4>
    <div class="postbody"><span class="postbody">Has anyone dumped the GBP bios yet?
<br/>
<br/>
You could also dump the entire I/O area into sram from a GBA (just after it boots), put that in ROM and then compare it the I/O area in the GBP (just after it boots).
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9724 - FluBBa - Fri Aug 15, 2003 8:43 am</h4>
    <div class="postbody"><span class="postbody">I dumped the GBP bios yesterday and it was the same as the normal GBA/SP. I'll try to write a program that dumps/compare the IO area today.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9727 - jenswa - Fri Aug 15, 2003 12:23 pm</h4>
    <div class="postbody"><span class="postbody">Isn't it possible that the gbp just emulates 2 player games.
<br/>
I don't know if emulate is the right word.
<br/>
Prolly it has a build in option that sees the 2nd GC keypad
<br/>
as another GBA, something like that i mean.
<br/>
I just don't have the right words for it.
<br/>
<br/>
Just like the super gameboy for the SNES, was able to let you
<br/>
play with 2 players on one game with 2 SNES pads.
<br/>
(I played KI with a friend).<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9736 - FluBBa - Fri Aug 15, 2003 4:16 pm</h4>
    <div class="postbody"><span class="postbody">I dumped the IO area and both IWRAM and EWRAM no difference to a normal GBA. I used CowBite to look for unknown reads/writes but nothing came up there either. The last thing I tried now was to look at reads from 0x4000130 (joypad) and Pokemon Pinball seem to check for 0xf0 (up, down, left &amp; right, all at the same time) the first few frames.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9737 - tepples - Fri Aug 15, 2003 4:40 pm</h4>
    <div class="postbody"><span class="postbody">Remember that 0x04000130 is active LOW. Do you mean 0x00f0, L+R+A+B+Sel+Start, or do you mean 0x030f, Right+Left+Up+Down?
<br/>
<br/>
I'd like to add that Game Boy games communicated with SGB through the joypad register as well.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9738 - cappeca - Fri Aug 15, 2003 4:46 pm</h4>
    <div class="postbody"><span class="postbody">Is it safe to assume that if there is another input register around, the value when no key is pressed is also 0x03FF?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9749 - NEiM0D - Sat Aug 16, 2003 1:10 am</h4>
    <div class="postbody"><span class="postbody">I checked with Visualboy Advance SDL and there are no writes/reads to any of the Joybus registers.
<br/>
There are also no writes/reads to any of the Communication registers (RCNT etc) on boot up of Pokemon Pinball.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9773 - FluBBa - Sun Aug 17, 2003 6:53 pm</h4>
    <div class="postbody"><span class="postbody">The only thing I've found this far is the address used to store if the game is play on a normal GBA or GBP in Pokemon Pinball, and that is 0x02019C0C.
<br/>
Set it to 0x01 to be able to turn on rumble in the prefs (3rd row at start menu). I can't guarantee that it will try to use the rumble but it probably does. Maybe it uses a special IRQ only found on the GBP?
<br/>
Does anyone have any info on the SGB and how access the functions on it?
<br/>
I read that the 2 highest bits in the Joypad Reg was zero on the SGB and 1's on a normal GB.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9784 - Dev - Mon Aug 18, 2003 2:38 am</h4>
    <div class="postbody"><span class="postbody">If you're positive that &amp;02019C0C is the correct address, you could always do a simple patch to VBA to find out when code accesses that location -- or at least narrow it down to a few places where it's being used.
<br/>
<br/>
Just a guess here, but detection probably takes place early on, and doesn't occur when the title is actually running -- Sure, it's possible, but it's not like a user can "change" whether or not they're using a GBP while it's running!
<br/>
<br/>
Of course, that assumes that detection is something more complicated than just checking a register -- i.e. based on some sort of communication back-and-forth, or somesuch.
<br/>
<br/>
I don't think 1.6 source has been posted yet, but since all you're really interested in is the initial detection, it shouldn't matter and 1.5x should suffice...
<br/>
<br/>
(I just noticed that NEiMOD was already poking around with VBA -- hopefully he'll see your update about the var address and do a quick test to see what's up!)
<br/>
<br/>
If it's checking for &amp;00F0, that could be their "reset your memory card" button sequence -- IIRC, they had a similar sequence in Mario Kart (or one of the multiple Marios out there) that wiped out your saved games if you held those down at startup
<br/>
<br/>
Dev.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9787 - sgeos - Mon Aug 18, 2003 5:31 am</h4>
    <div class="postbody"><span class="postbody">Just a thought:  One might be able to detect the GBP by setting a timer, running a bios function and then looking at the value in the timer.
<br/>
<br/>
As an aside, can the GBP play regular GB games?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9800 - FluBBa - Mon Aug 18, 2003 2:22 pm</h4>
    <div class="postbody"><span class="postbody">It seems that Nintendo is trying to be bad boys now...
<br/>
If there is something wrong with the tiles/tilemap/palette while it display the "Gameboy Player" logo Pokemon Pinball doesn't recognice the GB player.
<br/>
The game DMA's the tilemap every frame before it reads the Joypad port (0x130).
<br/>
I haven't checked if it's just crc or a complete check of the logo data.
<br/>
Don't know if the bldmod/coly regs are important yet.
<br/>
This probably means you need another Nintendo copyrighted logo to be able to detect/use the specific Gameboy Player features  :-(
<br/>
Booooh!
<br/>
But I'll keep on digging. (sorry for all the edits)<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9807 - Dev - Mon Aug 18, 2003 5:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If there is something wrong with the tiles/tilemap/palette while it display the "Gameboy Player" logo Pokemon Pinball doesn't recognice the GB player.
<br/>
The game DMA's the tilemap every frame before it reads the Joypad port (0x130).
<br/>
I haven't checked if it's just crc or a complete check of the logo data.
<br/>
Don't know if the bldmod/coly regs are important yet.
<br/>
This probably means you need another Nintendo copyrighted logo to be able to detect/use the specific Gameboy Player features  :-(
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So your suspicion is that it requires that particular tileset to be sent to the hardware before checking for &amp;00F0, and if the GBP doesn't see that exact sequence of data in memory (or being DMA'd or somesuch), then it won't send the correct signals?
<br/>
<br/>
I take it that you've modified the data being sent down, and observed that the GBP isn't recognized when you change the image?  Or was your testing done on an emulator?
<br/>
<br/>
Dev.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9815 - sgeos - Mon Aug 18, 2003 11:06 pm</h4>
    <div class="postbody"><span class="postbody">Has anyone opened up a GBP and looked at the internal hardware?  What is it like?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9876 - arrid - Wed Aug 20, 2003 11:40 pm</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.gbadev.org/luna/gbplayer/page3.htm" target="_blank">http://www.gbadev.org/luna/gbplayer/page3.htm</a>
<br/>
<br/>
It looks pretty much like a GBA but with an interface to the GC instead of a screen, buttons, speaker and battery/space for two AAs.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10152 - FluBBa - Thu Aug 28, 2003 11:06 am</h4>
    <div class="postbody"><span class="postbody">Ok, I think I've got the hang of how a game detects a GameBoy Player.
<br/>
First thing, the logo.. it must be displayed but you can do it any way you like.
<br/>
You can have it anywhere in VRAM, it can 256 colors or 16bit.
<br/>
You can change all the palette entries that are not used.
<br/>
It seems the GBP can only "see" what is on the LCD.
<br/>
After this you can read the joypad port to check for it's precense.
<br/>
The GBP will send 2 frames with normal 0x03FF and one frame with 0x030F as long as the logo is displayed.
<br/>
I have not found out how to use the rumble and I would very much appreciate if someone could help with debugging this, both Pokemon Pinball and Super Mario Advance 4 supports this.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10222 - Dev - Sat Aug 30, 2003 3:34 am</h4>
    <div class="postbody"><span class="postbody">How do you know it can be 16bit -- do you mean Mode 3/5, or do you mean 4bit per pixel, 16 colour?
<br/>
<br/>
Also, have you tried changing any of the "used" palette entries, or some of the graphic data itself, and checking if the GBP refuses to acknowledge the graphic?
<br/>
<br/>
Dev.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10225 - FluBBa - Sat Aug 30, 2003 11:58 am</h4>
    <div class="postbody"><span class="postbody">I meant exactly what I said, both 256 color modes and 16bit (not 16color) modes can be used, the GBP only get's the LCD output it seems.
<br/>
And changing things was the first tests I did (see some posts back) and everything that changes the logo onscreen makes the test fail.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10228 - Dev - Sat Aug 30, 2003 5:32 pm</h4>
    <div class="postbody"><span class="postbody">Did you have a particular title that used 16bit, or are you saying that you made a screen that was 16bit from the data that was 8bit?
<br/>
<br/>
IOW, you used the same graphics data but in 16bit, and it still worked?
<br/>
<br/>
It just seems very strange that they'd be checking for a specific screen display, rather than a set of DMA transfers of specific length/size/etc.
<br/>
<br/>
It would take a lot of chip space to check for an entire screen display, so I'm a bit surprised that they do it that way.
<br/>
<br/>
Also, in an earlier message, you wrote that it was DMAing the data every frame -- is that still required?
<br/>
<br/>
Dev.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10229 - torne - Sat Aug 30, 2003 5:46 pm</h4>
    <div class="postbody"><span class="postbody">Actually, it wouldn't take any chip space at all. It could trivially be done in software on the Cube. =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10230 - Dev - Sat Aug 30, 2003 5:48 pm</h4>
    <div class="postbody"><span class="postbody">True -- I forgot that you need to boot software first -- perhaps that's exactly how it's being done.
<br/>
<br/>
Dev.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10231 - torne - Sat Aug 30, 2003 6:02 pm</h4>
    <div class="postbody"><span class="postbody">Yep, they can pretty much make it arbitrarily complicated, as both sides are software (the player app on the gc, and the game code on the gba)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10232 - Dev - Sat Aug 30, 2003 6:25 pm</h4>
    <div class="postbody"><span class="postbody">It still seems odd that they'd go to all that trouble instead of, say, requiring a specific code or byte-sequence somewhere in memory, and then using that same memory to pass commands and data.
<br/>
<br/>
IOW, if the cube's software has arbitrary access to memory on the GBA side, why not make it fast and simple?
<br/>
<br/>
Checking for oscillating bits on the control pad after displaying a startup screen seems quite complex.
<br/>
<br/>
Dev.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10233 - torne - Sat Aug 30, 2003 6:29 pm</h4>
    <div class="postbody"><span class="postbody">Who can say why N do things? It is not for mortals to understand their workings. =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10244 - FluBBa - Sun Aug 31, 2003 11:37 am</h4>
    <div class="postbody"><span class="postbody">I just used VBA to take a screenshot off a title that displayed the Game Boy Player logo, then converted it to 15bit raw and used it in PCEAdvance as a splash screen. I changed the code in PCEAdvance to check the joypad port for 0x030F while displaying the splash and it works. No need for DMAing stuff all the time, and no need for a specific screen mode.
<br/>
Now all I want to know is if there is support for more then one player/joypad, and how to implement it.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10249 - sgeos - Sun Aug 31, 2003 5:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">I just used VBA to take a screenshot off...
<br/>
Now all I want to know is if there is support for more then one player/joypad, and how to implement it.</td> </tr></table><span class="postbody">
<br/>
<br/>
I'd also like to *know how* to use the rumble feature.  I'd probably never use it, but it would still be neat to know how.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10470 - Quirky - Sat Sep 06, 2003 12:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">I just used VBA to take a screenshot off a title that displayed the Game Boy Player logo, then converted it to 15bit raw and used it in PCEAdvance as a splash screen. I changed the code in PCEAdvance to check the joypad port for 0x030F while displaying the splash and it works. No need for DMAing stuff all the time, and no need for a specific screen mode.
<br/>
Now all I want to know is if there is support for more then one player/joypad, and how to implement it.</td> </tr></table><span class="postbody">
<br/>
<br/>
So if I understand you correctly, the test for Gameboy Player is:
<br/>
<br/>
<ol type="1">
<br/>
<li>Set the screen to any mode that is not 16-colour tile mode (mode 0-2 256 colour tiles or mode 3-5)
<br/>
</li><li>Place the logo in VRAM so it's on screen
<br/>
</li><li>Scan the joypad for 0x030F (this being register 0x04000130, right?) while displaying this screen
<br/>
</li></ol>
<br/>
<br/>
So I guess you could code it like this, right?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
u8 isGBP = 0; // default not GBP
<br/>
<br/>
int main() {
<br/>
  SetScreen(MODE_3); // or whatever...
<br/>
  LoadGBPLogo();
<br/>
  // show logo for 4 seconds (arbitrary time period...)
<br/>
  int displaying = 240;
<br/>
  while (displaying) {
<br/>
    wait_vsync();
<br/>
    if ( !(KEYS &amp; 0x030F)) {
<br/>
       // Gameboy Player!!
<br/>
       isGBP = 1;
<br/>
    }
<br/>
    displaying--;
<br/>
  }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And that is it? Then later on you could do .... 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if (isGBP) {
<br/>
   doRumble();
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If only we knew what rumble was... I guess that it would be a simple thing like setting some register to some value. Or perhaps a strange bios call? Though that would, I guess, show up in VBA's "unknown swis" code if you forced a game to GBP mode.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10481 - FluBBa - Sat Sep 06, 2003 10:58 am</h4>
    <div class="postbody"><span class="postbody">That's exactly how to do it.
<br/>
I've been doing some more test's with pokemon pinball but haven't found anything yet, it takes so much time to go through all the code just for a frames worth of time.
<br/>
It would have been great if there was an emu which could log everything to a file, every opcode it executes or something like that.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10510 - edwdig - Sat Sep 06, 2003 8:09 pm</h4>
    <div class="postbody"><span class="postbody">I first tried saving a screenshot with VisualBoy Advance, converting it to 256 color, and using that. Didn't work. Next I tried taking the .raw logo file off Flubba's site, including that into my code, and using that. Still didn't work. I'm using almost identical code to what Quirky posted.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10715 - edwdig - Sat Sep 13, 2003 7:37 am</h4>
    <div class="postbody"><span class="postbody">Figured out my problem... Quirky's example showed this:
<br/>
<br/>
if ( !(KEYS &amp; 0x030F)) {
<br/>
<br/>
That has to be changed to:
<br/>
<br/>
if (KEYS == 0x030F) {</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13595 - FluBBa - Wed Dec 17, 2003 11:18 pm</h4>
    <div class="postbody"><span class="postbody">Sorry to drag up this old thread again...
<br/>
Seems like the GBP can generate serial interrupts all by itself, this makes it quite hard to debug it on emulators as they don't generate any serial interrupts (at all?).
<br/>
I hacked "Pokemon Pinball" to halt if the serial irq was taken, this resulted in a crash on the GBP but it worked just fine on a normal GBA (it was also hacked to allow GBP features allways, so if I fired of a serial IRQ in the emulator it also crashed there).
<br/>
Any ideas where to go next?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13606 - tepples - Thu Dec 18, 2003 5:50 am</h4>
    <div class="postbody"><span class="postbody">Perhaps the GBP communication is through the same registers as the serial connection. If this is true, we're not going to see GBP support in emulators for a long time, until somebody else hacks serial support into VisualBoyAdvance.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13613 - FluBBa - Thu Dec 18, 2003 9:37 am</h4>
    <div class="postbody"><span class="postbody">Forgot to mention that if just returned from the serial irq everything worked fine except rumble...
<br/>
I will try to write a program that communicates with the GBP to see if I can get any response at all from it.
<br/>
It is probably easier to "emulate" the GBP then serial communication between 2 VBAs as you dont really need emulate it but more simulate what kind of responce you get from it, though we dont know much about that yet.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38732 - FluBBa - Thu Mar 31, 2005 1:13 am</h4>
    <div class="postbody"><span class="postbody">Ok, got this baby working.
<br/>
The GBP software will try to talk to the GBA side if you set up the SIOCNT register correctly (at least 32bit communication), after that you have to go through a quite long conversation with it and after that it seems that you just need to send 0x40000004 to keep the link and then 0x40000026 to turn on rumble.
<br/>
<br/>
I will put together an example in C and some docs about it soon.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38744 - MumblyJoe - Thu Mar 31, 2005 6:29 am</h4>
    <div class="postbody"><span class="postbody">Good stuff man, thats what I call dedication! Can't wait for more info on this.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38799 - FluBBa - Thu Mar 31, 2005 10:06 pm</h4>
    <div class="postbody"><span class="postbody">I have succesfully implemented it in my upcoming Renegade emulator, so it rumbles when you get hit by the enemies. =)
<br/>
Still has to clean up the code a bit.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39583 - FluBBa - Sun Apr 10, 2005 12:54 pm</h4>
    <div class="postbody"><span class="postbody">Here is the code I use in RumblePong
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "gba.h"
<br/>
<br/>
<br/>
u32 SerialIn,DoRumble;
<br/>
u16 stage,ind;
<br/>
u16 SerOut0, SerOut1;
<br/>
char const GBPData[]={"NINTENDO"};
<br/>
<br/>
void RumbleInterrupt(void) {
<br/>
   u32 OutData=0;
<br/>
   u16 SerIn0, SerIn1;
<br/>
   u16 *GBPD2 = (u16*)GBPData;
<br/>
   
<br/>
   SerialIn = REG_SIODATA32;
<br/>
   switch(stage) {
<br/>
      case 0:
<br/>
         SerIn0 = SerialIn&gt;&gt;16;
<br/>
         SerIn1 = SerialIn;
<br/>
         if(SerIn0 == SerOut1){
<br/>
            if(ind &lt;=3){
<br/>
               if( SerialIn == ~(SerOut1 | (SerOut0&lt;&lt;16)) ){
<br/>
                  ind++;
<br/>
               }
<br/>
            }else{
<br/>
               if(SerIn1 == 0x8002){
<br/>
                  OutData = 0x10000010;
<br/>
                  stage=1;
<br/>
                  break;
<br/>
               }
<br/>
            }
<br/>
         }else{
<br/>
            ind = 0;
<br/>
         }
<br/>
         if(ind &lt;=3){
<br/>
            SerOut0 = GBPD2[ind];
<br/>
         }else{
<br/>
            SerOut0 = 0x8000;
<br/>
         }
<br/>
         SerOut1 = ~SerIn1;
<br/>
         OutData = SerOut1 | (SerOut0&lt;&lt;16);
<br/>
         break;
<br/>
<br/>
      case 1:
<br/>
         if(SerialIn == 0x10000010){
<br/>
            OutData = 0x20000013;
<br/>
            stage=2;
<br/>
         }else{
<br/>
            stage = 4;
<br/>
         }
<br/>
         break;
<br/>
<br/>
      case 2:
<br/>
         if(SerialIn == 0x20000013){
<br/>
            OutData = 0x40000004;
<br/>
            stage=3;
<br/>
         }else{
<br/>
            stage = 4;
<br/>
         }
<br/>
         break;
<br/>
<br/>
      case 3:
<br/>
         if(SerialIn == 0x30000003){
<br/>
            if(DoRumble){
<br/>
               DoRumble--;
<br/>
               OutData = 0x40000026;
<br/>
            }else{
<br/>
               OutData = 0x40000004;
<br/>
            }
<br/>
         }else{
<br/>
            stage = 4;
<br/>
         }
<br/>
         break;
<br/>
<br/>
      case 4:
<br/>
         SerialIn = 0;
<br/>
         DoRumble = 0;
<br/>
         stage = 0;
<br/>
         ind = 0;
<br/>
         SerOut0 = 0;
<br/>
         SerOut1 = 0;
<br/>
         return;
<br/>
   }
<br/>
<br/>
   REG_SIODATA32 = OutData;
<br/>
   REG_SIOCNT |= 0x80;
<br/>
}
<br/>
<br/>
void StartRumbleComs(void) {
<br/>
   if(SerialIn != 0x30000003){
<br/>
      REG_RCNT = 0x0;
<br/>
      REG_SIOCNT = 0x1008;
<br/>
      REG_SIOCNT |= 0x4000;
<br/>
      REG_SIOCNT &amp;=~1;
<br/>
      REG_SIOCNT |= 0x0080;
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
StartRumbleComs should probably be called around once a second, then you write number of frames the rumble should be running in DoRumble.
<br/>
Oh, and remember to show the Gameboy Player logo before you start your game.
<br/>
This is what I have reverse enginered, I haven't done much experimenting to see if there are more commands that can be used on the Gameboy Player, this is implemented in a Pong clone I made and my upcoming Renegade emulator. The full source for RumblePong can be downloaded from my homepage though it is for ARM SDT. If someone can make a version for GCC I would appreciate it, but it would be even better if someone implements rumble in a completly new game  =)<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
