<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Cartridge Encryption and Legal Issues - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Flash Equipment > Cartridge Encryption and Legal Issues</h2>
<div id="posts">
<div class="post">
    <h4>#76030 - xproductions - Fri Mar 17, 2006 9:26 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
It is probably illegal to distribute the encryption key in the DS ARM7 ROM. However, here's a workaround. (I don't know alot about crypto, so this may be incorrect). According to Martin Korth's docs, the BIOS loads the key into RAM, calculates a new key based on the cartridge's gamecode and a constant modulo value (called init_keycode in his docs), and then uses that to decrypt the commands. Would it be legal to distribute to the re-calculated key for a certain code, say, NTR-BEER? I can't think of any technical catches here.
<br/>
<br/>
P.S. Martin's docs say that the key is re calculated three times, but this crypto is only applied to the "Secure Area Disable" and "Secure Area" which are ROM areas (look at his docs for info about that).
<br/>
<br/>
P.P.S. I suck at explaining so please try your best to understand and I can clarify anything you don't understand.<br/>_________________<br/>If you would not be forgotten
<br/>
as soon as you are dead and rotten,
<br/>
either write things worth reading
<br/>
or do things worth writing.
<br/>
<br/>
-- Benjamin Franklin</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76036 - tepples - Fri Mar 17, 2006 9:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>xproductions wrote:</b></span></td> </tr> <tr> <td class="quote">It is probably illegal to distribute the encryption key in the DS ARM7 ROM.</td> </tr></table><span class="postbody">
<br/>
O rly? Search this forum for keywords Accolade, Lexmark, or Chamberlain.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76061 - swimgod - Sat Mar 18, 2006 12:21 am</h4>
    <div class="postbody"><span class="postbody">or google lol<br/>_________________<br/><span style="font-size: 9px; line-height: normal">
<br/>
1x <span style="font-weight: bold">WII</span> 2x remotes
<br/>
2x NDS/L(FMv7-ORG:v4,FMv7-org:DSL)
<br/>
1x GBAMP
<br/>
2x 1gb (MicroDrive{typeII}&amp;SanDisk{typeI})
<br/>
1x SuperPass2
<br/>
1x Supercard-CF</span>
<br/>
<a class="postlink" href="http://swimgod.com/ms_skins" target="_blank">MoonShell skins</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76091 - HyperHacker - Sat Mar 18, 2006 4:07 am</h4>
    <div class="postbody"><span class="postbody">As I asked before, but never got an answer... it's possible to just read the key out of the ARM7 BIOS. Shouldn't that be legal?
<br/>
<br/>
Also I heard something about some way you could get the cartridge to return an encrypted stream of zeros, which makes it really easy to determine the key.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76092 - caitsith2 - Sat Mar 18, 2006 4:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">As I asked before, but never got an answer... it's possible to just read the key out of the ARM7 BIOS. Shouldn't that be legal?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes,  you could just read out the encryption key from the bios.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Also I heard something about some way you could get the cartridge to return an encrypted stream of zeros, which makes it really easy to determine the key.</td> </tr></table><span class="postbody">
<br/>
<br/>
Blowfish encryption is not used for the seperate encrypted stream of 0s.  What is used for that is two hardware LFSRs, each seeded with 2 initial values.  One of those initial values is constant, and the other is based on the RTC, a value looked up from a value contained in the DS card header,  and one constant value.   This LFSR encryption is not something you need to worry about for reading DS game cards inside the DS.  you only need to worry about that encryption mode if your making a DS flash card, or your making a hardware standalone DS game card reader.
<br/>
<br/>
You do have to worry about the blowfish ecryption however, for all of the possible applications, including the DS flash card or standalone DS game card reader, as there is a set of DS game card commands specifically encrypted with the blowfish key,  for reading out the secure area, then switching into the final ds game card read mode.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76810 - HyperHacker - Fri Mar 24, 2006 11:00 pm</h4>
    <div class="postbody"><span class="postbody">OK, so if I wanted to write an app that can like read files from the DS card, run it, etc I'd only need to decrypt it using the blowfish key in the BIOS, and doing so would be completely legal? 'Cause that'd be pretty convienient (boot the DS card without having to hold Select).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77453 - zzo38computer - Fri Mar 31, 2006 9:56 pm</h4>
    <div class="postbody"><span class="postbody">One thing, I don't think you can read anything from the BIOS unless the program-counter is in the BIOS, but maybe you can set the program-counter in the middle of a function and trick the BIOS code..
<br/>
<br/>
And apparently is legal to distribute the private key, if someone find it then the key is broken (oops...)
<br/>
<br/>
And, I wonder now if is possible to write document with instructions to build a DS game card that can be loaded custom software onto it, and maybe even a switch to enable writing mode, so you put in DS, enable writing switch, put GBA card and copy file<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77473 - caitsith2 - Sat Apr 01, 2006 4:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zzo38computer wrote:</b></span></td> </tr> <tr> <td class="quote">One thing, I don't think you can read anything from the BIOS unless the program-counter is in the BIOS, but maybe you can set the program-counter in the middle of a function and trick the BIOS code..
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Look at <a class="postlink" href="http://phpfi.com/97977" target="_blank">http://phpfi.com/97977</a>. There is code nintendo accidently put there as part of their randomly generated blowfish key, that allows complete bios readout.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
