<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GBAMP M3 Questions, Paging, Clarification and Memory Map? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS Flash Equipment > GBAMP M3 Questions, Paging, Clarification and Memory Map?</h2>
<div id="posts">
<div class="post">
    <h4>#78669 - Dwedit - Sat Apr 08, 2006 7:46 pm</h4>
    <div class="postbody"><span class="postbody">So far, I can see that the GBAMP M3 locks itself on boot, and has boot code almost identical to the original GBAMP.  Only the first 512 bytes are visible every 0x4000 bytes, the rest is "an increasing memory pattern" (open bus?).  Is the BIOS unlocked the same way the original GBAMP is unlocked?  Does it still have that funky mirroring?
<br/>
<br/>
How do you switch between the BIOS, CF registers, and 32MB of RAM?  How do you enable or disable writing to RAM?  Is the bios combined with the CF registers, like the original GBAMP?
<br/>
<br/>
It says here [<a class="postlink" href="http://www.bottledlight.com/ds/index.php/Hardware/FlashCartridges" target="_blank">http://www.bottledlight.com/ds/index.php/Hardware/FlashCartridges</a>] that the M3 has an "unlocking sequence", then RAM can be made writable by writing somewhere.
<br/>
<br/>
What does "unlocking sequence" mean?  Does that mean it switches from the RAM back to the BIOS+CF registers?  Then it says that the RAM is made writable by writing 0xAA55 to 0x09FFEFFE, but does that mean that it maps the RAM back in at that point?
<br/>
<br/>
I wonder if there are also similar answers for the Supercard CF, or the SD versions of the M3/Supercard.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78671 - pepsiman - Sat Apr 08, 2006 7:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">What does "unlocking sequence" mean?  Does that mean it switches from the RAM back to the BIOS+CF registers?</td> </tr></table><span class="postbody">Yes. (Not sure about the BIOS).
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Then it says that the RAM is made writable by writing 0xAA55 to 0x09FFEFFE, but does that mean that it maps the RAM back in at that point?</td> </tr></table><span class="postbody">No.  At present nobody knows how to map the RAM back in.</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I wonder if there are also similar answers for the Supercard CF, or the SD versions of the M3/Supercard.</td> </tr></table><span class="postbody">The same sequences work on the M3SD.
<br/>
<br/>
Supercard sequences are on the page you linked to.
<br/>
Some of the supercard RAM remains mapped when accessing the CF.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78723 - Dwedit - Sun Apr 09, 2006 6:02 am</h4>
    <div class="postbody"><span class="postbody">So, would I need to dump the M3's firmware to find out how to switch between RAM and CF mode?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78784 - tepples - Sun Apr 09, 2006 7:52 pm</h4>
    <div class="postbody"><span class="postbody">GBAMP products tend to lock themselves if the initial reads don't come in the right order. You'd probably need to dump it in an "in circuit emulator" fashion, reading 16-bit words from ROM in the same order that the GBA would when running the code.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78795 - pepsiman - Sun Apr 09, 2006 9:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">So, would I need to dump the M3's firmware to find out how to switch between RAM and CF mode?</td> </tr></table><span class="postbody">
<br/>
I have a dump of the M3CF firmware (by Darkfader).
<br/>
I can email it to you.
<br/>
PM me your email.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#79041 - Dwedit - Tue Apr 11, 2006 5:47 am</h4>
    <div class="postbody"><span class="postbody">If you do this:
<br/>
0x09FFFFFE=0xA55A
<br/>
0x09FFFFFE=0xA55A
<br/>
0x09FFFFFE=0x0005
<br/>
0x09FFFFFE=0x0005
<br/>
0x09FFEFFE=0xAA55
<br/>
<br/>
Will it enable the SDRAM on both the Supercard and M3?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#79068 - pepsiman - Tue Apr 11, 2006 10:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">If you do this:
<br/>
0x09FFFFFE=0xA55A
<br/>
0x09FFFFFE=0xA55A
<br/>
0x09FFFFFE=0x0005
<br/>
0x09FFFFFE=0x0005
<br/>
0x09FFEFFE=0xAA55
<br/>
<br/>
Will it enable the SDRAM on both the Supercard and M3?</td> </tr></table><span class="postbody">
<br/>
Should do.
<br/>
Add 0x09FFFFFE=0xAA55 to get the G6 too.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
