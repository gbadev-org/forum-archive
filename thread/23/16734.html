<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dsdoom v1.1.3 in the works - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS homebrew announcements > Dsdoom v1.1.3 in the works</h2>
<div id="posts">
<div class="post">
    <h4>#169170 - (sniper) 109 - Mon Jun 22, 2009 5:20 pm</h4>
    <div class="postbody"><span class="postbody">Hi! I'd like to announce that Fisk and I are recompiling the current dsdoom, here's what have in store
<br/>
<br/>
- Better controls
<br/>
- Fixed saving
<br/>
- removal of doom shadow fading for an increase in FPS
<br/>
- Iwad and Pwad selector
<br/>
- Better user interface
<br/>
<br/>
Here is a small spoiler screenshot ;)
<br/>
<br/>
<a class="postlink" href="http://img29.imageshack.us/i/screenshotnogba20090515.png/" target="_blank"></a><a href="http://img29.imageshack.us/img29/3714/screenshotnogba20090515.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
<br/>
It May not look much different but, the doom shadow fading is gone! It may have looked fairly decent but... The new rendering (without doom shadow fading) increases FPS up to 35fps, Gives a more OpenGL feel to the software rendering and for detailed wads will look much clearer and cleaner, not to mention it will run REALLY fast!
<br/>
<br/>
More info at
<br/>
<a href="http://dsdoommods.freeforums.org/index.php" target="_blank">http://dsdoommods.freeforums.org/index.php</a><br/>_________________<br/><a class="postlink" href="http://top-car-images.com/1987-bmw-750il/" target="_blank">1987 bmw 750il</a> <a class="postlink" href="http://top-car-images.com/2003-bmw-m3-csl/" target="_blank">2003 bmw m3 csl</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169173 - elhobbs - Mon Jun 22, 2009 6:14 pm</h4>
    <div class="postbody"><span class="postbody">so... what is doom shadow fading?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169175 - (sniper) 109 - Mon Jun 22, 2009 6:43 pm</h4>
    <div class="postbody"><span class="postbody">This is shadow fading <a class="postlink" href="http://img151.imageshack.us/i/doom0038.png/" target="_blank"></a><a href="http://img151.imageshack.us/img151/8598/doom0038.th.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
This is the new rendering without shadow fading
<br/>
<a class="postlink" href="http://img151.imageshack.us/i/doom0039.png/" target="_blank"></a><a href="http://img151.imageshack.us/img151/2306/doom0039.th.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
With shadow fading if you were to move away from a wall the wall's hue would get darker. Where as the removal of this code just keeps a solid brightness. Which is why screenshot #2 appears darker.<br/>_________________<br/><a class="postlink" href="http://top-car-images.com/1987-bmw-750il/" target="_blank">1987 bmw 750il</a> <a class="postlink" href="http://top-car-images.com/2003-bmw-m3-csl/" target="_blank">2003 bmw m3 csl</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169181 - elhobbs - Mon Jun 22, 2009 8:35 pm</h4>
    <div class="postbody"><span class="postbody">those are some tiny screen shots! why the tiny/weird resolutions? it makes it hard to see your point.
<br/>
<br/>
is the source code available anywhere?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169183 - (sniper) 109 - Mon Jun 22, 2009 9:39 pm</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.jefklak.com/games/Doom/dsdoom_v110_src.zip" target="_blank">http://www.jefklak.com/games/Doom/dsdoom_v110_src.zip</a>
<br/>
The source as you requested.<br/>_________________<br/><a class="postlink" href="http://top-car-images.com/1987-bmw-750il/" target="_blank">1987 bmw 750il</a> <a class="postlink" href="http://top-car-images.com/2003-bmw-m3-csl/" target="_blank">2003 bmw m3 csl</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169184 - elhobbs - Mon Jun 22, 2009 10:10 pm</h4>
    <div class="postbody"><span class="postbody">I was looking to see your modified source code - not the previously released 1.1.0 code. I am curious to see what you are changing for the "doom shadow fading" removal.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169185 - (sniper) 109 - Mon Jun 22, 2009 11:23 pm</h4>
    <div class="postbody"><span class="postbody">I'd rather keep it between fisk and I. but you could always alter the source code yourself here's how you do it.
<br/>
<br/>
Look for R_draw.c in the ARM9, then cut this code out of the source code.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// R_DrawColumn
<br/>
// Source is the top of the column to scale.
<br/>
//
<br/>
<br/>
lighttable_t *dc_colormap;
<br/>
int     dc_x;
<br/>
int     dc_yl;
<br/>
int     dc_yh;
<br/>
fixed_t dc_iscale;
<br/>
fixed_t dc_texturemid;
<br/>
int     dc_texheight;    // killough
<br/>
byte    *dc_source;      // first pixel in a column (possibly virtual)
<br/>
<br/>
//
<br/>
// A column is a vertical slice/span from a wall texture that,
<br/>
//  given the DOOM style restrictions on the view orientation,
<br/>
//  will always have constant z depth.
<br/>
// Thus a special case loop for very fast rendering can
<br/>
//  be used. It has also been used with Wolfenstein 3D.
<br/>
//
<br/>
<br/>
void R_DrawColumn (void)</td> </tr></table><span class="postbody">[/code]<br/>_________________<br/><a class="postlink" href="http://top-car-images.com/1987-bmw-750il/" target="_blank">1987 bmw 750il</a> <a class="postlink" href="http://top-car-images.com/2003-bmw-m3-csl/" target="_blank">2003 bmw m3 csl</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169186 - Badablek - Mon Jun 22, 2009 11:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">those are some tiny screen shots! why the tiny/weird resolutions? it makes it hard to see your point.
<br/>
<br/>
is the source code available anywhere?</td> </tr></table><span class="postbody">
<br/>
<br/>
just remove .th to the url to see full size images.
<br/>
<br/>
<a href="http://img151.imageshack.us/img151/8598/doom0038.png" target="_blank">http://img151.imageshack.us/img151/8598/doom0038.png</a>
<br/>
<br/>
<a href="http://img151.imageshack.us/img151/2306/doom0039.png" target="_blank">http://img151.imageshack.us/img151/2306/doom0039.png</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169187 - elhobbs - Mon Jun 22, 2009 11:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>(sniper) 109 wrote:</b></span></td> </tr> <tr> <td class="quote">I'd rather keep it between fisk and I. but you could always alter the source code yourself here's how you do it.
<br/>
<br/>
Look for R_draw.c in the ARM9, then cut this code out of the source code.
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// R_DrawColumn
<br/>
// Source is the top of the column to scale.
<br/>
//
<br/>
<br/>
lighttable_t *dc_colormap;
<br/>
int     dc_x;
<br/>
int     dc_yl;
<br/>
int     dc_yh;
<br/>
fixed_t dc_iscale;
<br/>
fixed_t dc_texturemid;
<br/>
int     dc_texheight;    // killough
<br/>
byte    *dc_source;      // first pixel in a column (possibly virtual)
<br/>
<br/>
//
<br/>
// A column is a vertical slice/span from a wall texture that,
<br/>
//  given the DOOM style restrictions on the view orientation,
<br/>
//  will always have constant z depth.
<br/>
// Thus a special case loop for very fast rendering can
<br/>
//  be used. It has also been used with Wolfenstein 3D.
<br/>
//
<br/>
<br/>
void R_DrawColumn (void)</td> </tr></table><span class="postbody">[/code]</span></td> </tr></table><span class="postbody">the source is under gnu so if you release anything you will need to release the source code as well. not really an issue if you do not release anything though it is against the spirit of making doom opensource in the first place.
<br/>
<br/>
your code snippet only includes declarations - no actual code. so, removing would just make the source code unable to compile.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169188 - elhobbs - Mon Jun 22, 2009 11:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Badablek wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">those are some tiny screen shots! why the tiny/weird resolutions? it makes it hard to see your point.
<br/>
<br/>
is the source code available anywhere?</td> </tr></table><span class="postbody">
<br/>
<br/>
just remove .th to the url to see full size images.
<br/>
<br/>
<a href="http://img151.imageshack.us/img151/8598/doom0038.png" target="_blank">http://img151.imageshack.us/img151/8598/doom0038.png</a>
<br/>
<br/>
<a href="http://img151.imageshack.us/img151/2306/doom0039.png" target="_blank">http://img151.imageshack.us/img151/2306/doom0039.png</a></span></td> </tr></table><span class="postbody">thanks for the larger images. why do the ceiling and floor in doom0039.png look so dithered?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169190 - (sniper) 109 - Tue Jun 23, 2009 2:13 am</h4>
    <div class="postbody"><span class="postbody">Because the top one has shadow fading and the other one doesn't. It also effects the walls as well.<br/>_________________<br/><a class="postlink" href="http://top-car-images.com/1987-bmw-750il/" target="_blank">1987 bmw 750il</a> <a class="postlink" href="http://top-car-images.com/2003-bmw-m3-csl/" target="_blank">2003 bmw m3 csl</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169319 - gamefreaks - Thu Jul 02, 2009 11:12 pm</h4>
    <div class="postbody"><span class="postbody">The shading was done using multiple pallete lookups IIRC.
<br/>
<br/>
The bit that does the drawing in R_DrawColumn()
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
*dest = colormap[source[frac &gt;&gt; FRACBITS]];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
By not drawing the fading, you save a lookup per pixel.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169320 - Lazy1 - Thu Jul 02, 2009 11:49 pm</h4>
    <div class="postbody"><span class="postbody">Are you rendering at 256x192 or 320x200 and scaling using the hardware?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169438 - gamefreaks - Fri Jul 10, 2009 8:32 pm</h4>
    <div class="postbody"><span class="postbody">320x200 and scaled down by the looks of it to me.
<br/>
<br/>
Its actually quite difficult to make Doom render to less than 320 across. Its hard-coded in quite a few places, and stuff like the status screen are all drawn in 320.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169443 - Lazy1 - Fri Jul 10, 2009 11:01 pm</h4>
    <div class="postbody"><span class="postbody">There is an easy way around that though.
<br/>
What I did for Wolfenstein was have 2 background layers, 1 512x256 for the UI and any other 320x200 elements and 1 256x256 for the game window.
<br/>
<br/>
That way you get a bit more performance, the game looks nicer and you don't really screw up those hardcoded screens.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
