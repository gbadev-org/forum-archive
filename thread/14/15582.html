<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem including libgba headers in C++ files? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Problem including libgba headers in C++ files?</h2>
<div id="posts">
<div class="post">
    <h4>#157477 - aquaspider - Sun May 25, 2008 9:05 am</h4>
    <div class="postbody"><span class="postbody">Hello. I'm new here, but I've been lurking for a week or so, trying to soak up whatever I can. Can anybody help me with a small problem?
<br/>
<br/>
Specifically, I can't seem to get .cpp files to include the headers from libgba. This is the error message I get:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
aquaspider@vileplume:~/devkitPro/examples/gba/graphics/SimpleBGScroll$ make
<br/>
maincpp.cpp
<br/>
arm-eabi-g++ -MMD -MP -MF /home/aquaspider/devkitPro/examples/gba/graphics/SimpleBGScroll/build/maincpp.d  -c /home/aquaspider/devkitPro/examples/gba/graphics/SimpleBGScroll/source/maincpp.cpp -o maincpp.o
<br/>
/home/aquaspider/devkitPro/examples/gba/graphics/SimpleBGScroll/source/maincpp.cpp:1:22: warning: gba_base.h: No such file or directory
<br/>
/home/aquaspider/devkitPro/examples/gba/graphics/SimpleBGScroll/source/maincpp.cpp:2:23: error: gba_video.h: No such file or directory
<br/>
make[1]: *** [maincpp.o] Error 1
<br/>
make: *** [build] Error 2
<br/>
aquaspider@vileplume:~/devkitPro/examples/gba/graphics/SimpleBGScroll$ 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Here are the files in the project:
<br/>
<br/>
main.c:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;gba_base.h&gt;
<br/>
#include &lt;gba_video.h&gt;
<br/>
<br/>
int main()
<br/>
{
<br/>
   //main_cpp();
<br/>
   return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
main_two.c:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "gba_base.h"
<br/>
#include &lt;gba_video.h&gt;
<br/>
<br/>
int main_two()
<br/>
{
<br/>
   int a = 10;
<br/>
   return a * 2;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
maincpp.cpp:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;gba_base.h&gt;
<br/>
#include "gba_video.h"
<br/>
<br/>
int cpp_function() {
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The two .c files compile just fine, but the .cpp one seems to barf on the libgba headers. As I check out the makefile, it doesn't seem to treat them any differently:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#---------------------------------------------------------------------------------
<br/>
# Clear the implicit built in rules
<br/>
#---------------------------------------------------------------------------------
<br/>
.SUFFIXES:
<br/>
#---------------------------------------------------------------------------------
<br/>
ifeq ($(strip $(DEVKITARM)),)
<br/>
$(error "Please set DEVKITARM in your environment. export DEVKITARM=&lt;path to&gt;devkitARM)
<br/>
endif
<br/>
include $(DEVKITARM)/gba_rules
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# TARGET is the name of the output, if this ends with _mb generates a multiboot image
<br/>
# BUILD is the directory where object files &amp; intermediate files will be placed
<br/>
# SOURCES is a list of directories containing source code
<br/>
# INCLUDES is a list of directories containing extra header files
<br/>
#---------------------------------------------------------------------------------
<br/>
TARGET      :=   SimpleBGScroll_mb
<br/>
BUILD      :=   build
<br/>
SOURCES      :=   source font
<br/>
INCLUDES   :=
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# options for code generation
<br/>
#---------------------------------------------------------------------------------
<br/>
ARCH   :=   -mthumb -mthumb-interwork
<br/>
<br/>
CFLAGS   :=   -g -Wall -O3\
<br/>
         -mcpu=arm7tdmi -mtune=arm7tdmi\
<br/>
          -fomit-frame-pointer\
<br/>
         -ffast-math \
<br/>
         $(ARCH)
<br/>
<br/>
CFLAGS   +=   $(INCLUDE)
<br/>
<br/>
ASFLAGS   :=   $(ARCH)
<br/>
LDFLAGS   =   -g $(ARCH) -Wl,-Map,$(notdir $@).map
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# path to tools - this can be deleted if you set the path in windows
<br/>
#---------------------------------------------------------------------------------
<br/>
export PATH      :=   $(DEVKITARM)/bin:$(PATH)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# any extra libraries we wish to link with the project
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBS   :=   -lgba
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# list of directories containing libraries, this must be the top level containing
<br/>
# include and lib
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBDIRS   :=   $(LIBGBA)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# no real need to edit anything past this point unless you need to add additional
<br/>
# rules for different file extensions
<br/>
#---------------------------------------------------------------------------------
<br/>
ifneq ($(BUILD),$(notdir $(CURDIR)))
<br/>
#---------------------------------------------------------------------------------
<br/>
<br/>
export OUTPUT   :=   $(CURDIR)/$(TARGET)
<br/>
<br/>
export VPATH   :=   $(foreach dir,$(SOURCES),$(CURDIR)/$(dir))
<br/>
export PATH   :=   $(DEVKITARM)/bin:$(PATH)
<br/>
export DEPSDIR   :=   $(CURDIR)/$(BUILD)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# automatically build a list of object files for our project
<br/>
#---------------------------------------------------------------------------------
<br/>
CFILES      :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.c)))
<br/>
CPPFILES   :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.cpp)))
<br/>
SFILES      :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.s)))
<br/>
BINFILES   :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.bin)))
<br/>
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# use CXX for linking C++ projects, CC for standard C
<br/>
#---------------------------------------------------------------------------------
<br/>
ifeq ($(strip $(CPPFILES)),)
<br/>
#---------------------------------------------------------------------------------
<br/>
   export LD   :=   $(CC)
<br/>
#---------------------------------------------------------------------------------
<br/>
else
<br/>
#---------------------------------------------------------------------------------
<br/>
   export LD   :=   $(CXX)
<br/>
#---------------------------------------------------------------------------------
<br/>
endif
<br/>
#---------------------------------------------------------------------------------
<br/>
<br/>
export OFILES   := $(BINFILES:.bin=.o) $(CPPFILES:.cpp=.o) $(CFILES:.c=.o) $(SFILES:.s=.o)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# build a list of include paths
<br/>
#---------------------------------------------------------------------------------
<br/>
export INCLUDE   :=   $(foreach dir,$(INCLUDES),-I$(CURDIR)/$(dir)) \
<br/>
               $(foreach dir,$(LIBDIRS),-I$(dir)/include) \
<br/>
               -I$(CURDIR)/$(BUILD)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# build a list of library paths
<br/>
#---------------------------------------------------------------------------------
<br/>
export LIBPATHS   :=   $(foreach dir,$(LIBDIRS),-L$(dir)/lib)
<br/>
<br/>
.PHONY: $(BUILD) clean
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
$(BUILD):
<br/>
   @[ -d $@ ] || mkdir -p $@
<br/>
   @make --no-print-directory -C $(BUILD) -f $(CURDIR)/Makefile
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
clean:
<br/>
   @echo clean ...
<br/>
   @rm -fr $(BUILD) $(TARGET).elf $(TARGET).gba
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
else
<br/>
<br/>
DEPENDS   :=   $(OFILES:.o=.d)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# main targets
<br/>
#---------------------------------------------------------------------------------
<br/>
$(OUTPUT).gba   :   $(OUTPUT).elf
<br/>
<br/>
$(OUTPUT).elf   :   $(OFILES) $(LIBGBA)/lib/libgba.a
<br/>
<br/>
<br/>
%.o   :   %.bin
<br/>
<br/>
   @echo   $(notdir $&lt;)
<br/>
<br/>
   @$(bin2o)
<br/>
<br/>
<br/>
-include $(DEPENDS)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
endif
<br/>
#---------------------------------------------------------------------------------
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
I'm working from the SimpleBGScroll example from devkitPro. I'm pretty certain I got the toolchain installed correctly. It built libgba from source. And before modifying it, I was able to compile SimpleBGScroll into a .gba rom file. Tried it out in an emulator; was even able to modify the message, recompile, and see the message change in the emulator.
<br/>
<br/>
Yet, cpp files can't include the libgba headers? I'm stumped. (It being 3:00 AM where I am may also play a role in this.)
<br/>
<br/>
I'm running Ubuntu 8.04 and installed devkitPro under my home directory if those are important details?
<br/>
<br/>
Thank you in advance for any assistance you can offer this new homebrew developer!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157478 - Maxxie - Sun May 25, 2008 9:26 am</h4>
    <div class="postbody"><span class="postbody">Replace the "" with &lt;&gt; around the includes.
<br/>
<br/>
This changes the search path for them.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157479 - Cearn - Sun May 25, 2008 9:55 am</h4>
    <div class="postbody"><span class="postbody">For each file type a *FLAGS variable exists to specify which command-line flags should be used. This includes where the searchpaths for headers are. C files use CFLAGS, assembly files use ASFLAGS and C++ files use CXXFLAGS. The problem here is that CXXFLAGS is nowhere to be found in the makefile. This seems to be true for the other gba examples as well. The template makefile, however, does have the correct line:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">CXXFLAGS   :=   $(CFLAGS) -fno-rtti -fno-exceptions
<br/>
</td> </tr></table><span class="postbody">
<br/>
Add that to your makefile, right after the CFLAGS. Examine the template makefile if you're unsure where it goes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157488 - aquaspider - Sun May 25, 2008 6:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">For each file type a *FLAGS variable exists to specify which command-line flags should be used. This includes where the searchpaths for headers are. C files use CFLAGS, assembly files use ASFLAGS and C++ files use CXXFLAGS. The problem here is that CXXFLAGS is nowhere to be found in the makefile. This seems to be true for the other gba examples as well. The template makefile, however, does have the correct line:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">CXXFLAGS   :=   $(CFLAGS) -fno-rtti -fno-exceptions
<br/>
</td> </tr></table><span class="postbody">
<br/>
Add that to your makefile, right after the CFLAGS. Examine the template makefile if you're unsure where it goes.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Thank you! This fixed the problem immediately. This is the relevant section of the Makefile; supplied for anybody who might search on my same problem:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#---------------------------------------------------------------------------------
<br/>
# options for code generation
<br/>
#---------------------------------------------------------------------------------
<br/>
ARCH   :=   -mthumb -mthumb-interwork
<br/>
<br/>
CFLAGS   :=   -g -Wall -O3\
<br/>
         -mcpu=arm7tdmi -mtune=arm7tdmi\
<br/>
          -fomit-frame-pointer\
<br/>
         -ffast-math \
<br/>
         $(ARCH)
<br/>
<br/>
CFLAGS   +=   $(INCLUDE)
<br/>
<br/>
CXXFLAGS   :=   $(CFLAGS) -fno-rtti -fno-exceptions 
<br/>
<br/>
ASFLAGS   :=   $(ARCH)
<br/>
LDFLAGS   =   -g $(ARCH) -Wl,-Map,$(notdir $@).map
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks again Cearn!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
