<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Bad habits in popular tutorials - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Bad habits in popular tutorials</h2>
<div id="posts">
<div class="post">
    <h4>#20594 - tepples - Thu May 13, 2004 3:47 pm</h4>
    <div class="postbody"><span class="postbody">Several popular GBA programming tutorials, such as the ones at gbajunkie and Pern Project, are commonly held to teach bad habits. Which are those? I'm thinking about writing at least part of a GBA programming tutorial free of such bad habits.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20595 - poslundc - Thu May 13, 2004 3:53 pm</h4>
    <div class="postbody"><span class="postbody">The one that constantly gets my goat (as everyone on here probably knows by now) is data being put into header files.
<br/>
<br/>
I would like to see a tutorial that shows how to append data as an array in a simple C file with a corresponding header file. It could also talk about using assembly files, binary files, and file systems such as GBFS, but this is the simplest, easiest-to-understand way to include data and it should be made available to newbies.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20605 - mr_schmoe - Thu May 13, 2004 6:04 pm</h4>
    <div class="postbody"><span class="postbody">I would like to see a tutorial on the GBFS. I looked into it once, but it was bit too complicated for me. (Maybe at the time I wasn't well versed enough on the subject to understand.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20606 - ScottLininger - Thu May 13, 2004 6:06 pm</h4>
    <div class="postbody"><span class="postbody">The "incorrect" tutorials I learned from (like so many on this forum) were the excellent Pern tutorials.
<br/>
<br/>
A new set of up-to-date tutorials would be wonderful. Just keep it SIMPLE. The thing that I loved about the Pern tutorials is that I was able install the devkit and compile the first little game in under an hour. From there, it only took me another couple of hours to build my own crappy game.
<br/>
<br/>
Granted, it was all Mode4 without sprites, but it was EASY. 
<br/>
<br/>
After that, I was hooked, and I've slowly learned the "proper" way to do stuff. 
<br/>
<br/>
So... if you want to write a "beginner's" tutorial, make sure that it's simple enough for a bonehead like me to figure out. Assume your audience knows VIRTUALLY NOTHING about hardware registers, endian-issues, and the like. And provide some demos that include complete make files that are as idiot proof as possible.
<br/>
<br/>
Or, perhaps a better approach would be to write some "intermediate" tutorials that assume you've already gone through the PERN stuff, and now will enlighten us to a little better way.
<br/>
<br/>
Either way, it's a good idea. If it's half as good as the FAQ, the community would benefit greatly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20607 - sajiimori - Thu May 13, 2004 6:07 pm</h4>
    <div class="postbody"><span class="postbody">One word:  OAMData.
<br/>
<br/>
Ok, another word cuz I can't resist:  DMA_TIMEING_...
<br/>
<br/>
Edit for elaboration: More than just a misspelling, the choice of "OAMData" as a name for sprite character RAM has caused more than a few confused readers to post here.</span><span class="gensmall"><br/><br/>Last edited by sajiimori on Thu May 13, 2004 6:28 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#20608 - ScottLininger - Thu May 13, 2004 6:11 pm</h4>
    <div class="postbody"><span class="postbody">This one drives me nuts:
<br/>
<br/>
TRANSPERENT</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20609 - wintermute - Thu May 13, 2004 6:23 pm</h4>
    <div class="postbody"><span class="postbody">objcopy can also be used to attach binary data which saves having to convert to a c file at all. You can actually link the raw data directly using the -b binary option when linking i.e. :-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
 arm-elf-gcc -Wl,-b,binary,binfile.dat &lt;rest of objects&gt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
my pet peeves with the average 'tutorial'
<br/>
<br/>
1. #including binary files as converted arrays.
<br/>
2. using batch files full of dos commands to build projects.
<br/>
3. using Nmake for gcc based projects.
<br/>
4. using ld directly to link projects then specifying several paths to libraries in order to compensate.
<br/>
5. gba defines that need to be cast in order to use them.
<br/>
6. inline asm without clobber lists.
<br/>
7. having conditional elements in the crt0.
<br/>
8. Spelling mistakes.
<br/>
9. poor grammar.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20610 - CyberSlag5k - Thu May 13, 2004 6:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Ok, another word cuz I can't resist: DMA_TIMEING_...</td> </tr></table><span class="postbody">
<br/>
<br/>
Heh, I noticed that one too.<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20614 - mr_schmoe - Thu May 13, 2004 6:44 pm</h4>
    <div class="postbody"><span class="postbody">Two things.
<br/>
<br/>
First:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">3. using Nmake for gcc based projects. </td> </tr></table><span class="postbody">
<br/>
What would you recommend for that?
<br/>
<br/>
Second:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
8. Spelling mistakes. 
<br/>
9. poor grammar.
<br/>
</td> </tr></table><span class="postbody">
<br/>
That's just lazyness on the programmers part. But I agree wholeheartedly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20619 - poslundc - Thu May 13, 2004 8:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ScottLininger wrote:</b></span></td> </tr> <tr> <td class="quote">This one drives me nuts:
<br/>
<br/>
TRANSPERENT</td> </tr></table><span class="postbody">
<br/>
<br/>
How about the TIMMER registers?
<br/>
<br/>
I had a field day going through and correcting all the spelling mistakes in my gba.h...
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20624 - tepples - Thu May 13, 2004 10:08 pm</h4>
    <div class="postbody"><span class="postbody">Here's my plan, indexed to correspond to wintermute's list:
<br/>
<br/>
0. Publish each chapter of the new tutorial under a free documentation license (probably Creative Commons by-sa) so that others can fix <span style="font-style: italic">my</span> bugs without having to rewrite the whole hoover-dam thing from scratch. <ol type="1"><li>I'll use a bin2s tool, which outputs assembly language (.s) source code, because those are less likely to tempt users into #include "data.c". </li><li>I too will start off with batch files until I introduce GNU Make in an early chapter. </li><li>You have no chance to survive; <a class="postlink" href="http://www.gnu.org/software/make/" target="_blank">GNU Make</a> your time. </li><li>Link only with gcc or g++. Ganon uses ld. </li><li>My header file, which names registers differently from the purported official header to avoid even the slightest appearance of infringement, includes the proper casts. It also includes macros done the right way. </li><li>I won't teach inline assembly language, as I feel it's just as fast to call a subroutine as to handle GCC's horrid clobber syntax. Besides, the reader is already used to adding .s files to the project from fix-plan[1]. </li><li>I'll use the standard GBA crt0 and link script that come with the GCC distribution I choose (probably devkitARM). </li><li>I have won the school spelling bee three times, and I know to go to Google if a word looks wrong. </li><li>I don't have a problem with grammar either.</li></ol> And yes, I'll introduce macros in the header file that make modes 3 and 5 ridiculously easy to use, as if they were just a 2D array of pixels.
<br/>
<br/>
I will assume familiarity with the C programming language, referring users to the alt.comp.lang.learn.c-c++ FAQ list. How much other familiarity should I assume?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20629 - poslundc - Thu May 13, 2004 11:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">I'll use a bin2s tool, which outputs assembly language (.s) source code, because those are less likely to tempt users into #include "data.c".</td> </tr></table><span class="postbody">
<br/>
<br/>
I think this is the only thing I really take issue with. Not because the advantages of data in assembly over C aren't apparent, just because I believe having to do <span style="font-style: italic">anything</span> involving assembly will be intimidating to new users. And they have to get their data into a raw format anyway before they can use bin2s.
<br/>
<br/>
I like the idea of teaching C arrays because it is very familiar, is compatible with the famous tools everyone seems to use (less work = more appealing to newbies), and means they'll be less likely to just go and do it the way Pern and GBAJunkie show them how.
<br/>
<br/>
I guess my point is: make it easy for them to append the data <span style="font-style: italic">properly</span>, early on. They can worry about what the best method is later, so long as they aren't screwing around with improper header files.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">My header file, which names registers differently from the purported official header to avoid even the slightest appearance of infringement, includes the proper casts. It also includes macros done the right way.</td> </tr></table><span class="postbody">
<br/>
<br/>
*sigh* This is probably the most sensible way to go, although since I'm using the standard DKA header file it'll be a pain to answer questions.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20631 - dagamer34 - Fri May 14, 2004 1:03 am</h4>
    <div class="postbody"><span class="postbody">Maybe dividing up the tutorials in to different levels might help a bit. And a dictionary for common terms is a must. I don't know how many people have asked what an ISR is.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20634 - MumblyJoe - Fri May 14, 2004 2:40 am</h4>
    <div class="postbody"><span class="postbody">If I can make a suggestion, and I know I will get flamed with "meh dont do it that way" replys but whatever...
<br/>
<br/>
instead of:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define SOMEREGISTER *(u16*)0xF000000</td> </tr></table><span class="postbody">
<br/>
<br/>
or
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define SOMERAM (u16*)0xF000000;</td> </tr></table><span class="postbody">
<br/>
<br/>
try:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16&amp; SOMEREGISTER = *(u16*)0xF000000;</td> </tr></table><span class="postbody">
<br/>
<br/>
and
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16* const SOMERAM = (u16*)0xF000000;</td> </tr></table><span class="postbody">
<br/>
<br/>
And yes I know that one of those is C++ specific and thats why I expect to get flamed. But honestly I prefer to have better type information attached to my constants and pointer, using #defines really is a terrible way to do things. Besides, with a good compiler (and I wont say that gcc is a good compiler) it shouldn't matter.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20637 - sajiimori - Fri May 14, 2004 4:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
using #defines really is a terrible way to do things.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Maybe you could give a situation where your way is better...?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Besides, with a good compiler (and I wont say that gcc is a good compiler) it shouldn't matter.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Even your hypothetical "good compiler" would create a memory object for SOMEREGISTER, and accessing it will involve work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20638 - poslundc - Fri May 14, 2004 5:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MumblyJoe wrote:</b></span></td> </tr> <tr> <td class="quote">using #defines really is a terrible way to do things.</td> </tr></table><span class="postbody">
<br/>
<br/>
Why?
<br/>
<br/>
I'm genuinely interested in hearing your reasoning. Because I can't think of a single reason to favour your way, which as sajimori already pointed out requires accessing of a memory object, and also purports to make linking a huge mess for large projects.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20644 - NoMis - Fri May 14, 2004 8:24 am</h4>
    <div class="postbody"><span class="postbody">I think the tutorials are good that way they are, except for the spelling mistakes like TIMMER or TIMEING. But its just an easier way to begin with data included as a header file. I learnd C/C++ in school and therefor know that its bad habbit and wont make it in my real game. But for experimenting and trying the system its quick and easy.
<br/>
I think that someone who want to programm the gba should have a good understanding of C/C++ first and therefor should already know that its messy.
<br/>
<br/>
@ MumblyJoe
<br/>
I don't think you get flamed. This forum is realy great and you can actualy have a nice diskussion about such things (i know terrible forums where you get flamed bye 5 guy for a simple question and have no chance to diskus something because the forum is full of kiddies). 
<br/>
In my oppinion every programmer has his personal style and if its efficient enough i don't see a problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20646 - Sweex - Fri May 14, 2004 8:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MumblyJoe wrote:</b></span></td> </tr> <tr> <td class="quote">using #defines really is a terrible way to do things.</td> </tr></table><span class="postbody">
<br/>
<br/>
Why?
<br/>
<br/>
I'm genuinely interested in hearing your reasoning. Because I can't think of a single reason to favour your way, which as sajimori already pointed out requires accessing of a memory object, and also purports to make linking a huge mess for large projects.
<br/>
<br/>
Dan.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Why? Two reasons why: You cannot put #defines in your watch/variables window when debugging, and the second: It is not typesafe so a bigger chance on weird behaviour! 
<br/>
<br/>
Now, having sais that, the first reason is less important on GBA as I think most of us aren't using any debugger.<br/>_________________<br/>If everything fails, read the manual: If even that fails, post on forum!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20647 - Sweex - Fri May 14, 2004 8:41 am</h4>
    <div class="postbody"><span class="postbody">Oh, and I just wanted to say that with the gained experience in general here, it is a great idea to make some now tutorials!<br/>_________________<br/>If everything fails, read the manual: If even that fails, post on forum!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20660 - poslundc - Fri May 14, 2004 2:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sweex wrote:</b></span></td> </tr> <tr> <td class="quote">You cannot put #defines in your watch/variables window when debugging</td> </tr></table><span class="postbody">
<br/>
<br/>
This is true, but it only means you need to manually know/look up the addresses in memory you wish to debug. This is a tradeoff for not bogging down the elf file with tons of extra symbols that aren't necessary programmatically.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">It is not typesafe so a bigger chance on weird behaviour!</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't see how. The compiler should perform the same typechecks on statements involving macro-ed pointers that it does on actual variable objects.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20668 - wintermute - Fri May 14, 2004 4:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sweex wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Why? Two reasons why: You cannot put #defines in your watch/variables window when debugging, and the second: It is not typesafe so a bigger chance on weird behaviour! 
<br/>
<br/>
Now, having sais that, the first reason is less important on GBA as I think most of us aren't using any debugger.</td> </tr></table><span class="postbody">
<br/>
<br/>
#defines are generally used for the GBA hardware registers so putting them in your watch/variables is unlikely to do what you want.
<br/>
<br/>
what's not typesafe about this?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
#define   REG_DISPCNT   *(vu16 *)(REG_BASE + 0x00)
<br/>
#define   REG_DISPSTAT   *(vu16 *)(REG_BASE + 0x04)
<br/>
#define   REG_VCOUNT   *(vu16 *)(REG_BASE + 0x06)
<br/>
#define   BGCTRL      ((vu16 *)(REG_BASE + 0x08))
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
find me a compiler that won't place 4 bytes in the rodata section for every single one of your definitions.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20674 - Lupin - Fri May 14, 2004 5:43 pm</h4>
    <div class="postbody"><span class="postbody">Using variables for registers sounds like a joke to me... Not only the 4 wasted bytes is the problem but the slowdown when reading/writing to a register... and you really get no more typesafety since ALL pointers in C will be 32 bit (because of 32 bit addressing), no matter what type of pointer.
<br/>
I really don't get the advantage of using memory... I think you should take a look into asm and try to understand how it works in hardware and then you will understand what your code will compile to.
<br/>
<br/>
wintermute, this is like the first time i see you on the gbadev board :)<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20679 - sajiimori - Fri May 14, 2004 6:48 pm</h4>
    <div class="postbody"><span class="postbody">Lupin, don't insinuate that people must not know how compilers work, while in the same breath making an error about the nature of pointers.
<br/>
<br/>
Type safety is not just about the size of pointers -- it's also about the size of the objects they point to (and how those objects are handled).  The point was that casting immediate values results in the same typesafety as using variables.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20681 - wintermute - Fri May 14, 2004 9:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
1. I'll use a bin2s tool, which outputs assembly language (.s) source code, because those are less likely to tempt users into #include "data.c". 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Personally I'd rather see tools that output gcc object files and autogenerated headers - I have no idea why people persist in turning binary data in source code 8 times bigger than the original data only to have the compiler turn it back into binary again. If you have a look at some of the code examples (such as they are so far :) ) you'll see the method I generally use for data. For bigger projects this method combined with GBA crusher <a href="http://members.cox.net/jsensebe/gba/GBACrusher.zip" target="_blank">http://members.cox.net/jsensebe/gba/GBACrusher.zip</a> is pretty much ideal. DevkitARM also provides a version of GAS which includes the .incbin directive for another alternative.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
5. My header file, which names registers differently from the purported official header to avoid even the slightest appearance of infringement, includes the proper casts. It also includes macros done the right way. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I can't see any reason to avoid the 'official' names since they are publically available on many sites, including the main documents used by homebrew developers - gbatek &amp; cowbite. The headers in libgba are based largely on those documents and I'd be more than happy to receive feedback on how those could be improved. Ideally I'd like to see libgba become a community effort with contributions from everyone who finds it useful.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20682 - wintermute - Fri May 14, 2004 9:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupin wrote:</b></span></td> </tr> <tr> <td class="quote">Using variables for registers sounds like a joke to me... Not only the 4 wasted bytes is the problem but the slowdown when reading/writing to a register... and you really get no more typesafety since ALL pointers in C will be 32 bit (because of 32 bit addressing), no matter what type of pointer.
<br/>
I really don't get the advantage of using memory... I think you should take a look into asm and try to understand how it works in hardware and then you will understand what your code will compile to.
<br/>
<br/>
wintermute, this is like the first time i see you on the gbadev board :)</td> </tr></table><span class="postbody">
<br/>
<br/>
Hi :)
<br/>
<br/>
I'm afraid you're a bit misinformed about what the compiler does with the variables that Sweex has suggested using. He's right in that gcc will generate identical code for the register access when defining registers as const but unfortunately additional data is placed in the .rodata section. Understanding asm &amp; looking at the compiler output is a good idea though :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20694 - sgeos - Sat May 15, 2004 4:08 am</h4>
    <div class="postbody"><span class="postbody">I'd be happy to read any 'up to date' tutorial.  For starters, I'd like to know how to include raw data in a file and muck about with from my code.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20695 - crossraleigh - Sat May 15, 2004 4:13 am</h4>
    <div class="postbody"><span class="postbody">I do like the <span style="font-style: italic">pin8gba.h</span> header much more than others I have seen; a tutorial that uses it would be very nice.
<br/>
<br/>
I don't have any particular bad habits to point out, but I do have an alternative way to access OAM entries:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">union oam_entry {
<br/>
   struct {
<br/>
      u16 y;
<br/>
      u16 x;
<br/>
      u16 data_index;
<br/>
      u16 pad;
<br/>
   };
<br/>
   long long options;
<br/>
};
<br/>
<br/>
#define OAM ((volatile union oam_entry*) 0x07000000)
<br/>
<br/>
// Initialize a 32x32 16-color sprite at (45,10).
<br/>
OAM[0].options = OAM_32x32 | OAM_PAL(7) | OAM_PRI(1);
<br/>
OAM[0].data_index |= OAM_DATA_INDEX_MASK &amp; 16;
<br/>
OAM[0].x |= OAM_X_MASK &amp; 45;
<br/>
OAM[0].y |= OAM_Y_MASK &amp; 10;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
For me, this is better than the 16-bit attribute method, and should be superior to bitfields in any case. At least in my OAM usage, the options can be determined at compile time, so there is no significant overhead using <span style="font-style: italic">long long</span>. This method is not ideal, however, for anyone who ? for instance ? is often using H-flip or V-flip.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20697 - Lupin - Sat May 15, 2004 11:09 am</h4>
    <div class="postbody"><span class="postbody">sajiimori, i am aware that in C the pointer type specifies the size of the object they point to, I just tried to point out that there is no difference in defining the pointer type by using a variable or by using a register because you have to specify the pointer type in both cases, but i think everything got said by now :)<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20725 - MumblyJoe - Sun May 16, 2004 2:15 am</h4>
    <div class="postbody"><span class="postbody">OK, I started a tiny argument before about defines and references and just thought I would quickly compile and disassemble some code to show the difference.
<br/>
<br/>
Here is the code (i know there was a better way to do conditional defines but whatever):
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef volatile unsigned short vu16;
<br/>
<br/>
#define USEDEFINE
<br/>
<br/>
#ifdef USEDEFINE
<br/>
<br/>
#define BULLPOINTER (vu16*)0x6000000
<br/>
<br/>
int main()
<br/>
{
<br/>
<br/>
<br/>
   *BULLPOINTER = 0x0500;
<br/>
<br/>
   while(1){}
<br/>
<br/>
   return 0;
<br/>
}
<br/>
<br/>
#else
<br/>
<br/>
vu16&amp; reference = *(vu16*)0x6000000;
<br/>
<br/>
int main()
<br/>
{
<br/>
<br/>
<br/>
   reference = 0x0500;
<br/>
<br/>
   while(1){}
<br/>
<br/>
   return 0;
<br/>
}
<br/>
<br/>
#endif</td> </tr></table><span class="postbody">
<br/>
<br/>
I compiled it with the following options:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">g++ -c -O3 -mthumb -mthumb-interwork -fno-rtti -fno-exceptions -o reftest.o reftest.cpp</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
When a define is used I get:
<br/>
<br/>
<a href="http://users.bigpond.com/duncansmowing/withdefine.jpg">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
When I use a reference I get:
<br/>
<br/>
<a href="http://users.bigpond.com/duncansmowing/withref.jpg">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
<br/>
So basically take a look and see how it works, I think it is worth the effort and it's never made a speed difference for me, even in loops.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20726 - poslundc - Sun May 16, 2004 3:27 am</h4>
    <div class="postbody"><span class="postbody">Two load operations versus two arithmetic operations? I'll take the arithmetic operations, thank you. Especially when loading from ROM, where you'll be wasting a ton of cycles on cache misses (which slows you down on hardware, not emulation).
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20729 - MumblyJoe - Sun May 16, 2004 5:01 am</h4>
    <div class="postbody"><span class="postbody">I see your point poslundc, so I did a little test just out of curiosity (not to argue that I am right). According to several tests I have read, gcc is a shitty compiler compared to alot of them. So I did a quick test with borlands compiler with speed optimisations turned on and its fairly interesting to see how it handled it. Of course this is x86 asm and moving data around in arm differs a bit but you can see what I mean in this code.
<br/>
<br/>
With defines:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   .686p
<br/>
   ifdef ??version
<br/>
   if ??version GT 500H
<br/>
   .mmx
<br/>
   endif
<br/>
   endif
<br/>
   model flat
<br/>
   ifndef   ??version
<br/>
   ?debug   macro
<br/>
   endm
<br/>
   endif
<br/>
   ?debug   S "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp"
<br/>
   ?debug   T "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp"
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_TEXT   ends
<br/>
_DATA   segment dword public use32 'DATA'
<br/>
_DATA   ends
<br/>
_BSS   segment dword public use32 'BSS'
<br/>
_BSS   ends
<br/>
DGROUP   group   _BSS,_DATA
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_main   segment virtual
<br/>
   align   2
<br/>
@_main   proc   near
<br/>
?live16385@0:
<br/>
 ;   
<br/>
 ;   int main()
<br/>
 ;   {
<br/>
 ;      #ifdef USEDEFINE
<br/>
 ;      *SOMEPLACE = 0x500;
<br/>
 ;   
<br/>
@1:
<br/>
   mov eax,100663296
<br/>
   mov dword ptr [eax],1280
<br/>
 ;   
<br/>
 ;      #else
<br/>
 ;      someplace = 0x500;
<br/>
 ;      #endif
<br/>
 ;   
<br/>
 ;      return 0;
<br/>
 ;   
<br/>
   xor eax,eax
<br/>
 ;   
<br/>
 ;   }
<br/>
 ;   
<br/>
@3:
<br/>
@2:
<br/>
   ret 
<br/>
@_main   endp
<br/>
_main   ends
<br/>
_TEXT   ends
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_TEXT   ends
<br/>
   ?debug   D "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp" 12464 28143
<br/>
   end
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
With references:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   .686p
<br/>
   ifdef ??version
<br/>
   if ??version GT 500H
<br/>
   .mmx
<br/>
   endif
<br/>
   endif
<br/>
   model flat
<br/>
   ifndef   ??version
<br/>
   ?debug   macro
<br/>
   endm
<br/>
   endif
<br/>
   ?debug   S "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp"
<br/>
   ?debug   T "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp"
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_TEXT   ends
<br/>
_DATA   segment dword public use32 'DATA'
<br/>
_DATA   ends
<br/>
_BSS   segment dword public use32 'BSS'
<br/>
_BSS   ends
<br/>
DGROUP   group   _BSS,_DATA
<br/>
_DATA   segment dword public use32 'DATA'
<br/>
   align   4
<br/>
_someplace   label   dword
<br/>
   dd   100663296
<br/>
_DATA   ends
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_main   segment virtual
<br/>
   align   2
<br/>
@_main   proc   near
<br/>
?live16385@0:
<br/>
 ;   
<br/>
 ;   int main()
<br/>
 ;   {
<br/>
 ;      #ifdef USEDEFINE
<br/>
 ;      *SOMEPLACE = 0x500;
<br/>
 ;      #else
<br/>
 ;      someplace = 0x500;
<br/>
 ;   
<br/>
@1:
<br/>
   mov eax,dword ptr [_someplace]
<br/>
   mov dword ptr [eax],1280
<br/>
 ;   
<br/>
 ;      #endif
<br/>
 ;   
<br/>
 ;      return 0;
<br/>
 ;   
<br/>
   xor eax,eax
<br/>
 ;   
<br/>
 ;   }
<br/>
 ;   
<br/>
@3:
<br/>
@2:
<br/>
   ret 
<br/>
@_main   endp
<br/>
_main   ends
<br/>
_TEXT   ends
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_TEXT   ends
<br/>
   public   _someplace
<br/>
   ?debug   D "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp" 12464 28130
<br/>
   end
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And last using a pointer:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   .686p
<br/>
   ifdef ??version
<br/>
   if ??version GT 500H
<br/>
   .mmx
<br/>
   endif
<br/>
   endif
<br/>
   model flat
<br/>
   ifndef   ??version
<br/>
   ?debug   macro
<br/>
   endm
<br/>
   endif
<br/>
   ?debug   S "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp"
<br/>
   ?debug   T "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp"
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_TEXT   ends
<br/>
_DATA   segment dword public use32 'DATA'
<br/>
_DATA   ends
<br/>
_BSS   segment dword public use32 'BSS'
<br/>
_BSS   ends
<br/>
DGROUP   group   _BSS,_DATA
<br/>
_DATA   segment dword public use32 'DATA'
<br/>
   align   4
<br/>
_someplace   label   dword
<br/>
   dd   100663296
<br/>
_DATA   ends
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_main   segment virtual
<br/>
   align   2
<br/>
@_main   proc   near
<br/>
?live16385@0:
<br/>
 ;   
<br/>
 ;   int main()
<br/>
 ;   {
<br/>
 ;      #ifdef USEDEFINE
<br/>
 ;      *SOMEPLACE = 0x500;
<br/>
 ;      #else
<br/>
 ;      *someplace = 0x500;
<br/>
 ;   
<br/>
@1:
<br/>
   mov eax,dword ptr [_someplace]
<br/>
   mov dword ptr [eax],1280
<br/>
 ;   
<br/>
 ;      #endif
<br/>
 ;   
<br/>
 ;      return 0;
<br/>
 ;   
<br/>
   xor eax,eax
<br/>
 ;   
<br/>
 ;   }
<br/>
 ;   
<br/>
@3:
<br/>
@2:
<br/>
   ret 
<br/>
@_main   endp
<br/>
_main   ends
<br/>
_TEXT   ends
<br/>
_TEXT   segment dword public use32 'CODE'
<br/>
_TEXT   ends
<br/>
   public   _someplace
<br/>
   ?debug   D "C:\Documents and Settings\Dirk Ramrod\Desktop\proof\proof.cpp" 12464 28362
<br/>
   end
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The pointer and ref code is identical here but I understand good compilers can optimise better with references because they cant be changed to point elsewhere.
<br/>
<br/>
Anyway, not trying to prove a point just showing that there are other options. In my x86 code the whole difference is 4 bytes in memory and a single instruction that does a fetch. I would allow a little sacrifice like that for nicer code :P
<br/>
<br/>
Oh and before anyone says it I know that using defines for conditional compiles so I can show why I don't like defines is kinda ironic :P<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20731 - sajiimori - Sun May 16, 2004 5:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
In my x86 code the whole difference is 4 bytes in memory and a single instruction that does a fetch.
<br/>
</td> </tr></table><span class="postbody">
<br/>
...which is what we said from the beginning. ;)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I would allow a little sacrifice like that for nicer code :P
<br/>
</td> </tr></table><span class="postbody">
<br/>
So it's an aesthetic thing?  I like consistency, and if C were powerful enough to do away with the preprocessor I'd gladly do so, but I still can't think of any objective way it's nicer...
<br/>
<br/>
BTW, you're talking to a guy whose current favorite language is Lisp (to some fans, the only "beautiful language"), so I definitely consider aesthetically pleasing code an end in itself, even at the expense of efficiency.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20733 - MumblyJoe - Sun May 16, 2004 10:05 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">So it's an aesthetic thing?  I like consistency, and if C were powerful enough to do away with the preprocessor I'd gladly do so, but I still can't think of any objective way it's nicer...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Well, its kind of an aesthetic thing, but also a very functional thing. I'm too young to have been poisoned by C (joking) and learnt C++. Most C++ experts pick on C's way of doing things alot, I'm a little more liberal though and use <span style="font-style: italic">some</span> C style things. So functionally I prefer getting variable names in my error messages etc. Also I like the readability of code to be high, and I find defines can mess that up.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20736 - poslundc - Sun May 16, 2004 2:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MumblyJoe wrote:</b></span></td> </tr> <tr> <td class="quote">So functionally I prefer getting variable names in my error messages etc.</td> </tr></table><span class="postbody">
<br/>
<br/>
That's a valid choice, but keep in mind that when you are doing GBA programming you are doing hardware programming, and you are using memory-mapped registers, not variables. #define simply keeps your code closer to the true hardware representation; using variables instead adds a layer of abstraction that I find pointless.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Also I like the readability of code to be high, and I find defines can mess that up.</td> </tr></table><span class="postbody">
<br/>
<br/>
Again, I don't see how.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20749 - MumblyJoe - Mon May 17, 2004 1:15 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Also I like the readability of code to be high, and I find defines can mess that up.</td> </tr></table><span class="postbody">
<br/>
<br/>
Again, I don't see how.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Well lets say I want to move to a new layer of abstraction, such as a class which represents a register. An imaginary example is:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">class Reg
<br/>
{
<br/>
    public:
<br/>
    static void Enable(){control|=0x0001;}
<br/>
    private:
<br/>
    static vu16&amp; control;
<br/>
};
<br/>
vu16&amp; Reg::control = *(vu16*)0x6000000;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I do this alot, especially with registers that have slightly strange uses, to use a define here I would really have to undefine it after the code to keep my code from having names like _VIDEO___CONTROL and shit like that which I see in tutorials. I far prefer my engine.Background2.Colors(256) over remembering the defines every time, and my code runs pretty damn fast,and the files are small.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20750 - col - Mon May 17, 2004 1:45 am</h4>
    <div class="postbody"><span class="postbody">If you are using c++, this should work, depending on packing etc. i've not fully tested it...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
struct Regs{
<br/>
   u32 DISPCNT;
<br/>
   u16 DISPSTAT;
<br/>
   u16 VCOUNT;
<br/>
    //etc
<br/>
};
<br/>
<br/>
Regs* const reg = (Regs*)0x4000000;
<br/>
<br/>
....then somewhere in your code....
<br/>
<br/>
reg -&gt; DISPCNT =  MODE0 | BG0_ENABLE | OBJ_ENABLE | OBJ_MAP_1D;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
or if you want to use references:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
struct Regs{
<br/>
   u32 DISPCNT;
<br/>
   u16 DISPSTAT;
<br/>
   u16 VCOUNT;
<br/>
    //etc
<br/>
};
<br/>
<br/>
Regs&amp; const reg = *(Regs*)0x4000000;
<br/>
<br/>
....then somewhere in your code....
<br/>
<br/>
reg.DISPCNT =  MODE0 | BG0_ENABLE | OBJ_ENABLE | OBJ_MAP_1D;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this way you get your neat code with no macros, the pointer version costs the same as using #defines, if you use the references version, you only pay the extra 8 bytes once instead of per register.
<br/>
[EDIT: using references costs per access as pointed out in sajiimoris reply - and the const shouldnt be there in the references version]
<br/>
<br/>
Col</span><span class="gensmall"><br/><br/>Last edited by col on Mon May 17, 2004 2:54 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#20751 - sajiimori - Mon May 17, 2004 2:16 am</h4>
    <div class="postbody"><span class="postbody">You can't do <span style="font-weight: bold">type&amp; const x;</span> because all references are const (in that you can't change what they refer to).  Declaring a reference <span style="font-weight: bold">static</span> should give the compiler the option of optimizing it away, but GCC doesn't do this.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
...you only pay the extra 8 bytes once instead of per register.
<br/>
</td> </tr></table><span class="postbody">
<br/>
...and then of course each time you access it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20753 - MumblyJoe - Mon May 17, 2004 2:22 am</h4>
    <div class="postbody"><span class="postbody">Actually the more I test gcc to see how it is optimising my code the more I am starting to agree that #defines could be good sometimes :P
<br/>
<br/>
If only borland made an ARM/Thumb compiler, then we could write some awsome fast shit :P<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20754 - sajiimori - Mon May 17, 2004 2:26 am</h4>
    <div class="postbody"><span class="postbody">Meh... if it's really important, hand code it. ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20755 - col - Mon May 17, 2004 2:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">You can't do <span style="font-weight: bold">type&amp; const x;</span> because all references are const (in that you can't change what they refer to).  Declaring a reference <span style="font-weight: bold">static</span> should give the compiler the option of optimizing it away, but GCC doesn't do this.</td> </tr></table><span class="postbody">
<br/>
oops, that was a cut'n'paste error - forgot to take out the const :)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
...you only pay the extra 8 bytes once instead of per register.
<br/>
</td> </tr></table><span class="postbody">
<br/>
...and then of course each time you access it.</span></td> </tr></table><span class="postbody">
<br/>
ouch - i missed that.
<br/>
well - i did say i hadn't tested it :)
<br/>
<br/>
col</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20767 - f(DarkAngel) - Mon May 17, 2004 12:39 pm</h4>
    <div class="postbody"><span class="postbody">Some ARM asm tutorials say that asl/asr can be freely replaced with lsl/lsr. I've manually found that this is not true (took me ~2 days to find the problem in matrix multiplication <a href="http://cvs.sourceforge.net/viewcvs.py/demi/stdgba/src/stdgba_math.S?rev=1.4&amp;view=auto" target="_blank">http://cvs.sourceforge.net/viewcvs.py/demi/stdgba/src/stdgba_math.S?rev=1.4&amp;view=auto</a> ), and logical shifts seems to be for unsigned values while arithmetic shift is for signed values.<br/>_________________<br/>death scream...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20768 - wintermute - Mon May 17, 2004 1:11 pm</h4>
    <div class="postbody"><span class="postbody">cue something else that really annoys me - why do so many people feel the need to use &lt;my library name&gt;_bios_&lt;function name&gt;? Then there's people using ARM code all over the place despite it being a recommended practice to use thumb code in ROM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20769 - wintermute - Mon May 17, 2004 1:25 pm</h4>
    <div class="postbody"><span class="postbody">further to the #define vs reference debate a quick test of the 3 methods available
<br/>
<br/>
first the source
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//---------------------------------------------------------------------------------
<br/>
typedef   unsigned short int      u16;
<br/>
typedef   volatile u16         vu16;
<br/>
<br/>
#define   REG_BASE   0x04000000
<br/>
<br/>
#define   REG_DISPCNT      *(vu16 *)(REG_BASE + 0x00)
<br/>
static vu16* const DISPCNT = (vu16*)(REG_BASE + 0x00);
<br/>
static vu16&amp; reference = *(vu16*)(REG_BASE + 0x00);
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
static void constval()
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   *DISPCNT=0;
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
static void referenceval()
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   reference=0;
<br/>
}
<br/>
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
static void defineval()
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   REG_DISPCNT=0;
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
int main(void)
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   defineval();
<br/>
   constval();
<br/>
   referenceval();
<br/>
<br/>
   return(0);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this was compiled with arm-elf-g++ -O3 -mthumb -mthumb-interwork -fomit-frame-pointer -save-temps and resulted in the following assembly
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   .code   16
<br/>
   .file   "main.c"
<br/>
   .section   .rodata
<br/>
   .align   2
<br/>
   .type   reference, %object
<br/>
   .size   reference, 4
<br/>
reference:
<br/>
   .word   67108864
<br/>
   .text
<br/>
   .align   2
<br/>
   .global   main
<br/>
   .code 16
<br/>
   .thumb_func
<br/>
   .type   main, %function
<br/>
main:
<br/>
   ldr   r0, .L5
<br/>
   mov   r3, #128
<br/>
   lsl   r1, r3, #19
<br/>
   ldr   r3, [r0]
<br/>
   mov   r2, #0
<br/>
   mov   r0, #0
<br/>
   strh   r2, [r1]
<br/>
   strh   r2, [r1]
<br/>
   @ sp needed for prologue
<br/>
   strh   r2, [r3]
<br/>
   bx   lr
<br/>
.L6:
<br/>
   .align   2
<br/>
.L5:
<br/>
   .word   reference
<br/>
   .size   main, .-main
<br/>
   .ident   "GCC: (GNU) 3.4.0 (mingw special)"
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
as you can see, the pointer variant &amp; the #define result in identical code. The reference generates an unneeded memory reference and an additional 4 bytes in the .rodata section. My personal preference would be for the #define variant given that I'm a lazy swine and typing an extra * is too much effort :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20771 - poslundc - Mon May 17, 2004 2:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>f(DarkAngel) wrote:</b></span></td> </tr> <tr> <td class="quote">Some ARM asm tutorials say that asl/asr can be freely replaced with lsl/lsr.</td> </tr></table><span class="postbody">
<br/>
<br/>
ASL and LSL assemble into the same thing. I suppose theoretically an arithmetic left-shift would produce a carry output whereas a logical left-shift wouldn't, but on the ARM this is handled by the CPSR-update flag.
<br/>
<br/>
ASR and LSR are mightily different, as ASR sign-extends whereas LSR only pads with zeros. Most mathematical applications, as you observed, require the use of ASR whereas most bit-juggling applications use LSR.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20773 - f(DarkAngel) - Mon May 17, 2004 4:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">cue something else that really annoys me - why do so many people feel the need to use &lt;my library name&gt;_bios_&lt;function name&gt;?</td> </tr></table><span class="postbody">
<br/>
<br/>
This is a C convention. There's no namespace in C.
<br/>
The reason for using this not "feeling the need", this method reduces the chance for name conflicts, especially when using differrent libraries in the same program, probably not considering whether if you're annoyed or not.<br/>_________________<br/>death scream...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20828 - Cearn - Tue May 18, 2004 2:35 pm</h4>
    <div class="postbody"><span class="postbody">Turning back to peeves for a while, I was pretty annoyed when I found out that the matrix PERN gives for rotation/scaling doesn't do what one would expect it too, and got pretty pissed when I found the bad matrix just about everywhere I looked. If you plan on including something about affine functions, &lt;i&gt;please&lt;/i&gt; make sure it gives a proper matrix.
<br/>
<br/>
On including binary data: as much as I can see why this would be a good thing, I've always wondered just how to do this since it's not an easy thing to find in manuals. A particular question would be: what'd be the name of the variable/reference/point whatever that one would use to find it? In assembly you can use a label, but somehow I doubt that'd work for pure binary files. Related to this is the question of what you actually got in the binary file, what's the width/height bpp of the data? Would the binary have a header, or should you just remember all that? Also, in the event that the conversion to GBA data went awry, browsing throught C or assembly is a lot easier than through pure binary. But of course, converters never fail, right? :P
<br/>
<br/>
Slightly off-topic, what kind of form were you planning on using (html, pdf, doc (only kidding) )? I'm asking because the more I use html for <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/index.htm" target="_blank">Tonc</a>, the more I wish I had something that would keep all my (numbered) references and equations in check.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20848 - wintermute - Tue May 18, 2004 6:35 pm</h4>
    <div class="postbody"><span class="postbody">the docs you want for objcopy are here :- <a href="http://sources.redhat.com/binutils/docs-2.15/binutils/objcopy.html" target="_blank">http://sources.redhat.com/binutils/docs-2.15/binutils/objcopy.html</a>
<br/>
<br/>
admittedly they're not stupendously clear if you haven't used objcopy much. I tend to use a make macro for dealing with raw to object file conversion.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
define bin2o
<br/>
   cp $(&lt;) $(*).tmp
<br/>
   $(OBJCOPY) -I binary -O elf32-littlearm -B arm \
<br/>
   --rename-section .data=.rodata,readonly,data,contents \
<br/>
   --redefine-sym _binary_$*_tmp_start=$*\
<br/>
   --redefine-sym _binary_$*_tmp_end=$*_end\
<br/>
   --redefine-sym _binary_$*_tmp_size=$*_size\
<br/>
   $(*).tmp $(@)
<br/>
   echo "extern const u8" $(*)"[];" &gt; $(*).h
<br/>
   echo "extern const u32" $(*)_size[]";" &gt;&gt; $(*).h
<br/>
   rm $(*).tmp
<br/>
endef
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
%.o   :   %.pcx
<br/>
#---------------------------------------------------------------------------------
<br/>
   @echo $(notdir $&lt;)
<br/>
   @$(bin2o)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
what this does is redefine the standard _binary_&lt;filename&gt;_&lt;extension&gt;_start style labels to &lt;filename&gt;_start, &lt;filename&gt;_end and &lt;filename&gt;_size and generate a header with the appropriate externs. By default objcopy places things in the data section, --rename-section takes care of that &amp; moves things to the .rodata section where they belong.
<br/>
<br/>
Ideally you want some sort of header with your binary data to make things a bit easier otherwise you're pretty much stuck with doing things manually. You can of course write tools which will ouput directly to an elf object and allow a little more flexibility.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20897 - LOst? - Wed May 19, 2004 2:14 pm</h4>
    <div class="postbody"><span class="postbody">I know one thing I hate so much.
<br/>
<br/>
Don't spell INTERRUPT:
<br/>
<br/>
INTERUPT
<br/>
INTRUPT
<br/>
INTERPT
<br/>
<br/>
I can't stand the registers having bad spelling.
<br/>
<br/>
<br/>
Also, I must say that I want the game to operate with HBlank and VBlank correctly. Not just some void function with if conditions.
<br/>
<br/>
And the flags for setting interrupts that have been used, it should be something that's taken care of automatically. It's just confusing and annoying since I can't seem to understand what it's good for.
<br/>
<br/>
No more for-loops for loading sprites and graphics. I know it seems more easy to do it that way, but it's so crappy. Memcpy or DMACOPY it instead. It's the samr thing and everyone understands it.
<br/>
<br/>
Be sure to give out tools that work. Not just that worked with this sample, like some crappy PCX2SPR
<br/>
<br/>
And also, I hate this thing so much. All tools use different ways of storing data. Some is in header files. Some is in C files with externs. And most of them use u16 types but doesn't include the type. And some of them never add the last line that GCC complain about, making it hard to see if you got errors.
<br/>
<br/>
There is really much that I get annoyed at, but we should be happy there is a lot of people that have done this for us!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20901 - Cearn - Wed May 19, 2004 3:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">The docs you want for objcopy are here :- <a href="http://sources.redhat.com/binutils/docs-2.15/binutils/objcopy.html" target="_blank">http://sources.redhat.com/binutils/docs-2.15/binutils/objcopy.html</a>
<br/>
admittedly they're not stupendously clear if you haven't used objcopy much. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
I have a feeling it's safe to say that a good number of Windows users have have little experience with command-line programs, lets alone objcopy.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">I tend to use a make macro for dealing with raw to object file conversion. </td> </tr></table><span class="postbody">
<br/>
which I somehow missed when browsing through your makefiles, d'oh! Not sure you want to see something like that in the first makefile you ever see, though.
<br/>
<br/>
at Lost?
<br/>
How about the many variations of <span style="font-weight: bold">palette</span>? :P
<br/>
On the HBlank, VBlank thing, I'm assuming you're talking (at least partially) about using the VBlank interrupt for vsyncing instead of checking REG_VCOUNT? As much as I agree this is better, the use of interrupts is still often done via a custom crt0.S/lnkscript where you have to uncomment certain things (if you can find it amidst the assembly and comments). This is probably not something you want newbies to confront with right at the start. Having a nice separate interrupt handler (like devkitARM's libgba's single_ints.s) for that would certainly help, but even then you'd have to wait until after discussing interrupts (and possibly assembly). 
<br/>
And isn't it possible to set the interrupt flags in the main interrupt handler so the separate isr's don't have to?
<br/>
<br/>
On copies: yeah dma is great, but apparently you should go overboard with it, see <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=3392" target="_blank">http://forum.gbadev.org/viewtopic.php?t=3392</a> and <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=1803" target="_blank">http://forum.gbadev.org/viewtopic.php?t=1803</a>. Wish I'd known about that stuff sooner. And about using the standard memory routines, remember that these assume bytes, not (half)words. Though memcpy should convert itself to use 32bit copies (at least the Visual C version does, I don't know about the GCC one), using memset can wreak havoc, especially when trying to copy to VRAM.
<br/>
<br/>
<span style="font-size: 8px; line-height: normal">Spelling edit; how in the world can I spell "great" as "create"?!?</span></span><span class="gensmall"><br/><br/>Last edited by Cearn on Thu Dec 22, 2005 7:57 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#20902 - LOst? - Wed May 19, 2004 3:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
at Lost?
<br/>
How about the many variations of <span style="font-weight: bold">palette</span>? :P
<br/>
On the HBlank, VBlank thing, I'm assuming you're talking (at least partially) about using the VBlank interrupt for vsyncing instead of checking REG_VCOUNT? As much as I agree this is better, the use of interrupts is still often done via a custom crt0.S/lnkscript where you have to uncomment certain things (if you can find it amidst the assembly and comments). This is probably not something you want newbies to confront with right at the start. Having a nice separate interrupt handler (like devkitARM's libgba's single_ints.s) for that would certainly help, but even then you'd have to wait until after discussing interrupts (and possibly assembly). 
<br/>
And isn't it possible to set the interrupt flags in the main interrupt handler so the separate isr's don't have to?
<br/>
</td> </tr></table><span class="postbody">
<br/>
You are right, but still better force people to use Interrupts instead of making them being lazy. Sooner or later they will have to understand them anyway.
<br/>
<br/>
Yea, we got pallette, pallet, pallete, palete, palets.... Argh! English please!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20905 - poslundc - Wed May 19, 2004 4:21 pm</h4>
    <div class="postbody"><span class="postbody">I disagree entirely with the notion that interrupts should be taught as the method to sync to VBlank in tutorials.
<br/>
<br/>
Checking REG_VCOUNT is <span style="font-style: italic">infinitely</span> easier for new programmers to understand, it gets them thinking about and understanding the relation between their code and the hardware's performance and behaviour, and even more to the point, using the interrupt is an <span style="font-style: italic">optimization</span> and not something that is required for or contributes to basic functionality or even performance of a program.
<br/>
<br/>
At best, all that using the interrupts does is spare a little battery drain. At worst, it confuses the heck out of a new programmer.
<br/>
<br/>
And it's an <span style="font-style: italic">optimization</span>, people! Remember Knuth! I <span style="font-style: italic">still</span> use REG_VCOUNT to sync my programs in the dev stage to VBlank, and I have yet to be told a compelling reason not to!
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20907 - Lord Graga - Wed May 19, 2004 6:03 pm</h4>
    <div class="postbody"><span class="postbody">I agree with you poslundc.
<br/>
<br/>
while doing the REG_VCOUNT check you don't WASTE any cycles if you aren't doing interrupts. Notice how it wouldn't actually waste any cycles that the coder has used anyway. So, no harm done, and screw batteries.
<br/>
<br/>
On the other hand, wouldn't it take extra cycles to have an interrupt running?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20921 - dagamer34 - Wed May 19, 2004 11:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lord Graga wrote:</b></span></td> </tr> <tr> <td class="quote">I agree with you poslundc.
<br/>
<br/>
while doing the REG_VCOUNT check you don't WASTE any cycles if you aren't doing interrupts. Notice how it wouldn't actually waste any cycles that the coder has used anyway. So, no harm done, and screw batteries.
<br/>
<br/>
On the other hand, wouldn't it take extra cycles to have an interrupt running?</td> </tr></table><span class="postbody">
<br/>
<br/>
So, the real reason why I see that there are bad habits in tutorials, is that there is no <span style="font-weight: bold">one</span> way to do something on the GBA. Questions like, "Should we teach them how to use DMA first, or have them use a for loop?" and "Are interrupts something a newbie really needs to learn first (for VSync), or will checking REG_VCOUNT be ok?", confuse tutorial writers, and they end up writing about whatever feels comfortable to them.
<br/>
<br/>
Without answering questions like these, this topic could go on for several pages without anything actually being done to change it.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20924 - poslundc - Wed May 19, 2004 11:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">So, the real reason why I see that there are bad habits in tutorials, is that there is no <span style="font-weight: bold">one</span> way to do something on the GBA. Questions like, "Should we teach them how to use DMA first, or have them use a for loop?" and "Are interrupts something a newbie really needs to learn first (for VSync), or will checking REG_VCOUNT be ok?", confuse tutorial writers, and they end up writing about whatever feels comfortable to them.</td> </tr></table><span class="postbody">
<br/>
<br/>
DMA copying and interrupt-based VBlank synching are both optimizations that have simple, C-based equivalents.
<br/>
<br/>
#including object data in a header file is erroneous and leads to worlds of problems as a project grows. The fact that the compiler lets you get away with it is no excuse for teaching it that way.
<br/>
<br/>
There is a tremendous difference between the two.
<br/>
<br/>
In the case of the former, I will always advocate teaching the C-based technique first and introducing the optimization later. Otherwise you end up with people who can't even debug their code properly because it relies on them using the DMA incorrectly or something. (I regularly use the DMA, but one of the first things I'll do when a block of code doesn't work properly is take out the DMA and replace it with a for-loop copy.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20932 - tepples - Thu May 20, 2004 4:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>LOst? wrote:</b></span></td> </tr> <tr> <td class="quote">Also, I must say that I want the game to operate with HBlank and VBlank correctly. Not just some void function with if conditions.</td> </tr></table><span class="postbody">
<br/>
What exactly do you mean by this?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">And the flags for setting interrupts that have been used, it should be something that's taken care of automatically. It's just confusing and annoying since I can't seem to understand what it's good for.</td> </tr></table><span class="postbody">
<br/>
So do you want macros for IRQ_PROLOG and IRQ_EPILOG?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">No more for-loops for loading sprites and graphics. I know it seems more easy to do it that way, but it's so crappy. Memcpy or DMACOPY it instead.</td> </tr></table><span class="postbody">
<br/>
When I get to loading tiles, I'll teach using cpu_memcpy() and then dma_memcpy(), modeled after the similarly named function from the C library.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Be sure to give out tools that work.</td> </tr></table><span class="postbody">
<br/>
I plan to eat my own dogfood, to teach with the same tools I used to make my own games.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">All tools use different ways of storing data. Some is in header files. Some is in C files with externs.</td> </tr></table><span class="postbody">
<br/>
C files with externs are strongly preferred to header files, and assembly files with externs are slightly preferred to C files with externs. However, I'll be teaching with GBFS because Windows developers seem to be more familiar with loading files and resources by name.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">And most of them use u16 types but doesn't include the type.</td> </tr></table><span class="postbody">
<br/>
Already fixed in my tools.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">And some of them never add the last line that GCC complain about, making it hard to see if you got errors.</td> </tr></table><span class="postbody">
<br/>
Already fixed in my tools.
<br/>
<br/>
And I have checked the spellings of interrupt, timer, palette, and other terms against a dictionary published by Merriam-Webster.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20936 - yanos - Thu May 20, 2004 6:07 am</h4>
    <div class="postbody"><span class="postbody">What is actualy wrong with putting data in header files?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20937 - MumblyJoe - Thu May 20, 2004 6:16 am</h4>
    <div class="postbody"><span class="postbody">I wish I had waited and read your tutorials as a start tepples, sounds like they will be awsome. It's a crying shame that alot of the people who wrote the original tutorials that are floating around never updated or corrected thier problems.
<br/>
<br/>
As a suggestion, how about including a chapter (marked optional because it's not really neccessary to know this) on writing your own tools. Personally I think that would be great because I am only now starting to get a set of reliable tools together because I wrote them myself (and honestly they would probably seem useless to alot of people who do things differently to me).
<br/>
<br/>
As for using GBFS in a tutorial... well I have never used it and I think its overkill for resource management... you will have to sell that idea to me :P<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20946 - poslundc - Thu May 20, 2004 1:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yanos wrote:</b></span></td> </tr> <tr> <td class="quote">What is actualy wrong with putting data in header files?</td> </tr></table><span class="postbody">
<br/>
<br/>
Header files are meant to contain meta-data: basically shared information on how to access other information. This can include structs, function prototypes, references to external variables, and macro definitions.
<br/>
<br/>
They should never, ever contain executable code (exception: static inline functions) and that includes arrays of data.
<br/>
<br/>
A data file that is #included into two separate C files will end up defining the same symbol twice, which will cause an error when you get to the linking stage. These errors can be very difficult to track down.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20947 - poslundc - Thu May 20, 2004 1:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">No more for-loops for loading sprites and graphics. I know it seems more easy to do it that way, but it's so crappy. Memcpy or DMACOPY it instead.</td> </tr></table><span class="postbody">
<br/>
When I get to loading tiles, I'll teach using cpu_memcpy() and then dma_memcpy(), modeled after the similarly named function from the C library.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">All tools use different ways of storing data. Some is in header files. Some is in C files with externs.</td> </tr></table><span class="postbody">
<br/>
C files with externs are strongly preferred to header files, and assembly files with externs are slightly preferred to C files with externs. However, I'll be teaching with GBFS because Windows developers seem to be more familiar with loading files and resources by name.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
*sigh* I'm telling you, when all is said and done people will just wind up using the Pern tutorials instead.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20948 - wintermute - Thu May 20, 2004 1:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lord Graga wrote:</b></span></td> </tr> <tr> <td class="quote">I agree with you poslundc.
<br/>
<br/>
while doing the REG_VCOUNT check you don't WASTE any cycles if you aren't doing interrupts. Notice how it wouldn't actually waste any cycles that the coder has used anyway. So, no harm done, and screw batteries.
<br/>
<br/>
On the other hand, wouldn't it take extra cycles to have an interrupt running?</td> </tr></table><span class="postbody">
<br/>
<br/>
VblankIntrWait puts the CPU into sleep mode until an interrupt occurs, it is not simply a loop like the REG V_COUNT check. If you don't have any interrupts then it is wasting ALL the cycles from the start of the loop until the vblank period.
<br/>
<br/>
If you're working on a commercial game and you don't use the IntrWait functions you *will* fail Nintendo lot check</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20949 - poslundc - Thu May 20, 2004 2:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">VblankIntrWait puts the CPU into sleep mode until an interrupt occurs, it is not simply a loop like the REG V_COUNT check. If you don't have any interrupts then it is wasting ALL the cycles from the start of the loop until the vblank period.</td> </tr></table><span class="postbody">
<br/>
<br/>
So? You make it sound like it is wasting food or crude oil or something. It simply keeps the CPU alive and doesn't bother to conserve a tiny amount of battery power. "Wasting cycles" only has significance if those cycles could have otherwise been made useful for calculations or something. But they couldn't, and your code doesn't perform the slightest bit poorer as a result.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">If you're working on a commercial game and you don't use the IntrWait functions you *will* fail Nintendo lot check</td> </tr></table><span class="postbody">
<br/>
<br/>
This should hardly be a concern of a beginner's tutorial.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20951 - wintermute - Thu May 20, 2004 3:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">VblankIntrWait puts the CPU into sleep mode until an interrupt occurs, it is not simply a loop like the REG V_COUNT check. If you don't have any interrupts then it is wasting ALL the cycles from the start of the loop until the vblank period.</td> </tr></table><span class="postbody">
<br/>
<br/>
So? You make it sound like it is wasting food or crude oil or something. It simply keeps the CPU alive and doesn't bother to conserve a tiny amount of battery power. "Wasting cycles" only has significance if those cycles could have otherwise been made useful for calculations or something. But they couldn't, and your code doesn't perform the slightest bit poorer as a result.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">If you're working on a commercial game and you don't use the IntrWait functions you *will* fail Nintendo lot check</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
This should hardly be a concern of a beginner's tutorial.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
The point is that Nintendo feel the impact on battery life is significant enough to fail games that don't use this method. 
<br/>
<br/>
The beginners of today may well be the game developers of tomorrow - I fail to see why they should be taught bad habits in the early stages.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20954 - poslundc - Thu May 20, 2004 4:13 pm</h4>
    <div class="postbody"><span class="postbody">It's not a bad habit. Bad habits are things like passing structs instead of pointers, using floats without a coprocessor, and optimizing the crap out of non-time-critical routines. There is nothing programatically even questionable about hanging in a loop in order to catch up with a display frequency. It's simply an easier-to-implement and easier-to-understand way of doing it.
<br/>
<br/>
The fact that Nintendo wants you to <span style="font-weight: bold">optimize</span> it into an interrupt <span style="font-style: italic">before your game is published</span> has absolutely nothing to do with <span style="font-style: italic">getting people started programming the GBA</span>. Beginners will gravitate towards the tutorial that's easiest to understand and simplest to get successfully coding in. And I guarantee you that anyone new to the hardware will find hanging in a loop a lot more straightforward than fiddling with interrupts.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20957 - wintermute - Thu May 20, 2004 5:38 pm</h4>
    <div class="postbody"><span class="postbody">Disregard for power management in a portable system is an extremely bad habit. I suggest you run some tests with the two methods, you might be quite unpleasantly surprised by the results.
<br/>
<br/>
As for the simple to understand - the interrupt dispatcher can be supplied as 'black box' code to be used in a standard project framework with suitable 'accessor' functions for initialising and setting up interrupt routines.
<br/>
<br/>
Personally I feel that 'don't worry about this for now, it works' is much better than 'here's a completely unacceptable method which isn't reliable and should never be used if you ever hope to work in a commercial environment'
<br/>
<br/>
There are circumstances where the loop approach will never complete - admittedly those are rarely encountered but the potential for complete failure is there. Martin Korth's emulator complains about loops like this for good reason and the warnings should be heeded.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20960 - sajiimori - Thu May 20, 2004 6:30 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
There are circumstances where the loop approach will never complete - admittedly those are rarely encountered but the potential for complete failure is there.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Can you explain which circumstances those are?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20963 - poslundc - Thu May 20, 2004 7:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Disregard for power management in a portable system is an extremely bad habit. I suggest you run some tests with the two methods, you might be quite unpleasantly surprised by the results.</td> </tr></table><span class="postbody">
<br/>
<br/>
Care to enlighten me? I've used software I've developed for hours on end with no noticeable reduction in battery life.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">As for the simple to understand - the interrupt dispatcher can be supplied as 'black box' code to be used in a standard project framework with suitable 'accessor' functions for initialising and setting up interrupt routines.</td> </tr></table><span class="postbody">
<br/>
<br/>
And most people will just go to the Pern tutorials instead so they can easily get started programming without having to muck around with other people's frameworks. (If I wanted to use a framework I'd have learned HAMLib.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Personally I feel that 'don't worry about this for now, it works' is much better than 'here's a completely unacceptable method which isn't reliable and should never be used if you ever hope to work in a commercial environment'</td> </tr></table><span class="postbody">
<br/>
<br/>
It <span style="font-style: italic">is</span> reliable. Show that it isn't. I've not <span style="font-style: italic">once</span> run into a problem using it.
<br/>
<br/>
And like I said, if Nintendo has a problem with it you can easily optimize it into an interrupt. But homebrew tutorials aren't there to teach Nintendo publishing standards. Heck, we aren't even supposed to know what they are.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20975 - alek - Thu May 20, 2004 10:22 pm</h4>
    <div class="postbody"><span class="postbody">This thread is starting to get quit large so I might have missed if someone already has suggested this but I think your tutorial should include a chapter on sound and sound mixing. Just my two cents...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20978 - dagamer34 - Fri May 21, 2004 12:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>alek wrote:</b></span></td> </tr> <tr> <td class="quote">This thread is starting to get quit large so I might have missed if someone already has suggested this but I think your tutorial should include a chapter on sound and sound mixing. Just my two cents...</td> </tr></table><span class="postbody">
<br/>
Actually, no one has mentioned it yet. But if he does put it in, I'm thinking a series of tutorials divided up into sections would be easier for him to write and update.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20988 - MrMr[iCE] - Fri May 21, 2004 1:03 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Care to enlighten me? I've used software I've developed for hours on end with no noticeable reduction in battery life.</td> </tr></table><span class="postbody">
<br/>
<br/>
I'd love to. I wrote a book reader app for the SP. During testing (aka reading full length books), on a full charge I could get about 5-6 hours with the frontlight on. I already knew about the intrwait functions and used them to halt the sp until next keypress.  I also added in code to disabe sound, making sure only the key interupt was active, etc. The result was on a full charge, I could get over 9 hours reading time. I know this is not related to vblank intrwaits, but it is relevant to the issue, and is useful info for those who wish to develop apps that need to conserve battery life.
<br/>
<br/>
Frankly, I dont see why this is such a major issue discussing why not to use a *built in feature* intended for the purpose of syncing to hardware events. Beginner or not, this is something that needs to be learned from the start.<br/>_________________<br/>Does the corpse have a familiar face?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20991 - poslundc - Fri May 21, 2004 2:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MrMr[iCE] wrote:</b></span></td> </tr> <tr> <td class="quote">I know this is not related to vblank intrwaits, but it is relevant to the issue, and is useful info for those who wish to develop apps that need to conserve battery life.</td> </tr></table><span class="postbody">
<br/>
<br/>
OK, forgive me for being blunt, but I've just moved a whole apartment into a trailer and I'm dead tired. You're right that it's not relevant to VBlank syncing. Your frontlight battery-draining example on the SP has no bearing whatsoever on my question. So what's your point, then? Yes, it's useful info for those who want to develop apps that need to conserve battery life. But for the umpteenth time, it's not necessary for an introductory tutorial and makes things unnecessarily complicated for beginners.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Frankly, I dont see why this is such a major issue discussing why not to use a *built in feature* intended for the purpose of syncing to hardware events. Beginner or not, this is something that needs to be learned from the start.</td> </tr></table><span class="postbody">
<br/>
<br/>
DMA is a built-in feature, but I don't expect beginners to use it to load data into memory. Why? Because it's an optimization. It's nice-to-know, not need-to-know. Beginners need to know the need-to-know stuff. The nice-to-know stuff can come in the later chapters, but if you try to dump it all on them at once they'll just do things the Pern way because it's more familiar to them, and you'll have accomplished nothing.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20994 - MumblyJoe - Fri May 21, 2004 2:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">The beginners of today may well be the game developers of tomorrow - I fail to see why they should be taught bad habits in the early stages.</td> </tr></table><span class="postbody">
<br/>
<br/>
Because even if the beginners of today read all the tutorials around and worked as hard as humanly possible it's unlikely that they would ever find work developing for the GBA, considering the handheld is having a midlife crisis about now.
<br/>
<br/>
EDIT: I realised this made me sound jaded, I really do think that you should teach the best way first no matter how technical it is, I know too many people who have read a shitty "Teach yourself C++ in 24 Hours" book and not only dont know anything advanced, they know the <span style="font-style: italic">wrong</span>way to do simple things.
<br/>
<br/>
<br/>
Also someone mentioned the tests nintendo does to allow publishing of games, could someone send me a comprehensive list of these?<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20995 - sajiimori - Fri May 21, 2004 4:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I know too many people who have read a shitty "Teach yourself C++ in 24 Hours" book and not only dont know anything advanced, they know the wrongway to do simple things.
<br/>
</td> </tr></table><span class="postbody">
<br/>
The alternative, which is more common in the real world, are people who think they know how to do specific "advanced" things, but don't understand the principles enough to extend their knowledge.
<br/>
<br/>
Teaching the simple way first is right.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20996 - tepples - Fri May 21, 2004 6:11 am</h4>
    <div class="postbody"><span class="postbody">In case you just joined us:
<br/>
<br/>
<span style="font-weight: bold">What has been agreed upon</span>
<br/>
<ol type="1"><li>Don't do bin2c and then #include "data.c". Use an appended data method instead. </li><li>Include PC-side tools that Just Work. </li><li>Start with mode 3, arguably the simplest mode, as the frame buffer is just a 2D array. </li><li>Don't confuse sprite cel VRAM with OAM. </li><li>Correct spelling is a good thing. </li><li>Introduce GNU Make early on. </li><li>Emphasize -mthumb and -marm as appropriate. </li><li>Link with gcc. </li><li>Cast to the proper type inside the header file's macros. </li><li>Don't encourage inline assembly language. </li><li>Use devkitARM rather than DevKit Advance; reasons include devkitARM's cleaner crt0 and linker script. </li><li>Use clones of memcpy() to load data into VRAM. Make a CPU version and a DMA version with the same arguments. </li><li>Include a dictionary for systems programming techniques. </li><li>Make sure to publish the tutorial under a free documentation license. </li></ol>
<br/>
<span style="font-weight: bold">What's still under debate</span>
<br/>
<ol type="1"><li>Introduce VBlankIntrWait() early on vs. in a later chapter on interrupts. </li></ol>
<br/>
<br/>
dagamer34: What terms should I put in the glossary? You mentioned ISR; what others?
<br/>
<br/>
And other than putting mode 3 first (direct hi-color, direct pixel addressing, making primitives dead easy), in what order should I explain the various modes, and when should I introduce sprites?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20997 - abilyk - Fri May 21, 2004 6:20 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">Teaching the simple way first is right.</td> </tr></table><span class="postbody">
<br/>
<br/>
I definitely agree.  With the majority of my math and computer hardware classes, we'd have to learn the long, drawn-out ways of doing things before we learned the "shortcuts."  Granted, these shortcuts represented the <span style="font-style: italic">right way</span> to solve the problem, and advanced students and professionals, I'm sure, would use them.  But beginning students won't appreciate these shortcuts and will likely have a more difficult time understanding the concepts if they don't muck through the simple, less efficient way first.
<br/>
<br/>
Also, I agree with pretty much all of what Dan has been saying, especially regarding GBFS.  Tepples, I'm sure any tutorial you'd write would be correct and concise and a great learning tool.  But if you force people to use GBFS, you'll probably lose a chunk of your audience, if only for that section of the tutorial.  Many people will want to code everything by themselves, and others still may not want to learn an additional system to get their demo to work.
<br/>
<br/>
Personally, when I started out, I read about things like DMA and interrupts, but I didn't bother implementing them right away because I could achieve the same results doing something I already knew how to do (using memcpy, waiting for Vblank using a loop).  Had your upcoming tutorial been around back then, I probably would have skimmed over the GBFS section and used another source to show how to include data the "quick and dirty" way.  I think you should keep the GBFS info in there, sure, but I'd suggest doing it in addition to explaining the simpler way first as a more basic technique.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21004 - niltsair - Fri May 21, 2004 2:38 pm</h4>
    <div class="postbody"><span class="postbody">I agree about not teaching VBlank interupt right off the bat. When first starting a lot fo people will not event know what's the use of VBlank synching so after a couple of basic lessons, teach them to add <span style="font-style: italic">while(VBLANK&lt;160);</span> and later on have a <span style="font-style: italic">VBLank revisisted</span> section teaching them to sync with interupt and why. While at it, add in the section how to create a timer with VBlank interupt to time your game (took me some time to figure out why my game was running fine in 1 emulator and too fast/slow in others (was using hardware timers)). 
<br/>
<br/>
Interupts require more planning that beginer shouldn't worry about (keeping a copy of OAM and update real OAM during VBlank, same with Video Registers, etc...).<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21032 - wintermute - Fri May 21, 2004 11:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>niltsair wrote:</b></span></td> </tr> <tr> <td class="quote">I agree about not teaching VBlank interupt right off the bat. When first starting a lot fo people will not event know what's the use of VBlank synching so after a couple of basic lessons, teach them to add <span style="font-style: italic">while(VBLANK&lt;160);</span> and later on have a <span style="font-style: italic">VBLank revisisted</span> section teaching them to sync with interupt and why.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Vblank syncing is one of the most fundamental tasks when writing a game, especially on a machine like the GBA where access to VRAM is restricted outside the vblank period. If you want to put things on screen you *need* to know about it.
<br/>
<br/>
while (REG_VCOUNT&lt;160); is not sufficient for a working wait for vsync, especially with simple programs. The correct way to do this is to wait for the vblank period to finish, then wait for it to start again.
<br/>
<br/>
Given that REG_DISPSTAT contains a flag which will tell you if the machine is currently in the vblank period, I fail to see why people feel the need to use the scan line counter for this purpose apart from someone getting it wrong back in the mists of time.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while (!(REG_DISPSTAT &amp; 1)); // wait for vblank period to start
<br/>
...
<br/>
code to be executed during vblank
<br/>
...
<br/>
code which isn't vblank critical 
<br/>
...
<br/>
while (REG_DISPSTAT &amp; 1); // wait for vblank period to end
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If the second wait is not present and your code does not consume the entire vblank period then it will quite happily execute several times a frame.
<br/>
<br/>
The problem with this is that most of the time your code will be sitting in a loop doing nothing more than consuming the battery. This can translate into 50 - 60% less battery life (yes you did read that right) and so the IntrWait functions have been provided as a simple method to wait for events while conserving energy.
<br/>
<br/>
The issues people have with complexity are, I think, related to having only full interrupt dispatchers available as examples. To make use of the IntrWait functions does not require that all the interrupts are serviced, it merely needs some code to indicate that an interrupt has taken place.
<br/>
<br/>
here's a spectacularly nasty piece of code - I wanted to put together a completely self contained example for illustration purposes. The IntrMain function is given as inline assembly only to allow the mixing of ARM and thumb code within a single source file. The confusing casting &amp; anding of the function pointer is part of making this work. Normally the definitions would be in a header file and the interrupt handler in a separate file, compiled as ARM code.
<br/>
<br/>
This code is not what I would consider clean and is only given as an illustration of using the IntrWait functions.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef   unsigned short int      u16;
<br/>
typedef   volatile u16         vu16;
<br/>
<br/>
#define   REG_BASE   0x04000000
<br/>
<br/>
typedef void ( * IntFn)(void);
<br/>
#define INT_VECTOR      *(IntFn *)(0x03007ffc)      // BIOS Interrupt vector
<br/>
#define   REG_IME         *(vu16 *)(REG_BASE + 0x208)   // Interrupt Master Enable
<br/>
#define   REG_IE         *(vu16 *)(REG_BASE + 0x200)   // Interrupt Enable
<br/>
#define   REG_IF         *(vu16 *)(REG_BASE + 0x202)   // Interrupt Request
<br/>
<br/>
#define   REG_DISPCNT      *(vu16 *)(REG_BASE + 0x000)
<br/>
#define   REG_DISPSTAT   *(vu16 *)(REG_BASE + 0x004)
<br/>
<br/>
#define   VRAM      ((u16*)0x06000000)
<br/>
<br/>
#define   MODE_3   3      // BG Mode 3
<br/>
#define   BG2_ON   (1&lt;&lt;10)   // enable background 2
<br/>
<br/>
#define IE_VBL      (1&lt;&lt;0)
<br/>
#define LCDC_VBL   (1&lt;&lt;3)
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
#if   defined   ( __thumb__ )
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"\n" :::  "r0", "r1", "r2", "r3")
<br/>
#else
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"   &lt;&lt; 16\n" :::"r0", "r1", "r2", "r3")
<br/>
#endif
<br/>
<br/>
#define   VBlankIntrWait()   SystemCall(5)
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
void IntrMain(void)
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   asm (   ".code 32\n"                  // Main interrupt handler must be ARM
<br/>
         "mov      r3,   #0x4000000\n"      // REG_BASE
<br/>
         "ldr      r2,   [r3,#0x200]\n"      // Read   REG_IE
<br/>
         "and      r1,   r2,   r2,   lsr   #16\n"   // r1 =   IE &amp; IF
<br/>
<br/>
         "ldrh   r2, [r3, #-8]\n"      // mix up with BIOS irq flags at 3007FF8h,
<br/>
         "orr   r2, r2, r1\n"         // aka mirrored at 3FFFFF8h, this is required
<br/>
         "strh   r2, [r3, #-8]\n"      // when using the (VBlank)IntrWait functions
<br/>
         "add   r3,r3,#0x200\n"
<br/>
         "strh   r2,   [r3, #2]\n"         // Clear the interrupt flag
<br/>
         "mov   pc,lr\n"            // return - gcc inserts thumb prologue
<br/>
      );
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
int main(void)
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   INT_VECTOR = (IntFn)((unsigned int)IntrMain &amp; -4);      // set up the ISR
<br/>
   REG_IE = IE_VBL;         // Enable the vblank Interrupt
<br/>
   REG_DISPSTAT = LCDC_VBL;   // Enable the lcd controller vblank
<br/>
   REG_IME =1;               // Interrupts on
<br/>
<br/>
   REG_DISPCNT = MODE_3 | BG2_ON;
<br/>
<br/>
   int x=120&lt;&lt;8;
<br/>
   int   y=80&lt;&lt;8;
<br/>
<br/>
   int dx = 0.75 * 256;
<br/>
   int dy = 1.25 * 256;
<br/>
<br/>
   int lastx = x;
<br/>
   int lasty = y;
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
<br/>
      lastx= x;
<br/>
      lasty=y;
<br/>
<br/>
      x+=dx;
<br/>
      y+=dy;
<br/>
      if ( (x&gt;&gt;8)&lt;0 || (x&gt;&gt;8)&gt;239)
<br/>
      {
<br/>
         dx= -dx;
<br/>
         x+=dx;
<br/>
      }
<br/>
<br/>
      if ( (y&gt;&gt;8)&lt;0 || (y&gt;&gt;8)&gt;159)
<br/>
      {
<br/>
         dy= -dy;
<br/>
         y+=dy;
<br/>
      }
<br/>
<br/>
      VBlankIntrWait();      // wait for next vblank
<br/>
<br/>
      VRAM[(lasty&gt;&gt;8) * 240 + (lastx&gt;&gt;8)] = 0;
<br/>
      VRAM[(y&gt;&gt;8) * 240 + (x&gt;&gt;8)] = -1;
<br/>
   }
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
 While at it, add in the section how to create a timer with VBlank interupt to time your game (took me some time to figure out why my game was running fine in 1 emulator and too fast/slow in others (was using hardware timers)).
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this is a problem with the emulators, not your code.
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Interupts require more planning that beginer shouldn't worry about (keeping a copy of OAM and update real OAM during VBlank, same with Video Registers, etc...).</td> </tr></table><span class="postbody">
<br/>
<br/>
this has absolutely nothing to do with interrupts. You can only update OAM during the vblank period whether you have interrupts enabled or not.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21039 - tepples - Sat May 22, 2004 2:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Vblank syncing is one of the most fundamental tasks when writing a game, especially on a machine like the GBA where access to VRAM is restricted outside the vblank period. If you want to put things on screen you *need* to know about it.</td> </tr></table><span class="postbody">
<br/>
Unlike GBC VRAM, GBA VRAM is dual-ported. OAM, on the other hand, needs to be updated either in vblank or (if the unlock bit of DISPCNT is set) in hblank.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">while (REG_VCOUNT&lt;160); is not sufficient for a working wait for vsync, especially with simple programs. The correct way to do this is to wait for the vblank period to finish, then wait for it to start again.</td> </tr></table><span class="postbody">
<br/>
I've already covered this in my draft of chapter 2 (mode 3 and basic animation). You have to wait while(VCOUNT &gt;= 160) and then wait while(VCOUNT &lt; 160).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Given that REG_DISPSTAT contains a flag which will tell you if the machine is currently in the vblank period, I fail to see why people feel the need to use the scan line counter for this purpose apart from someone getting it wrong back in the mists of time.</td> </tr></table><span class="postbody">
<br/>
Spinning on DISPSTAT and spinning on VCOUNT take the same amount of CPU effort.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">To make use of the IntrWait functions does not require that all the interrupts are serviced, it merely needs some code to indicate that an interrupt has taken place.</td> </tr></table><span class="postbody">
<br/>
This is the hard part, and without extremely hairy hacks, it seems to require compiling separate source files, one for main() in Thumb, and one for isr() in ARM. Then I have to teach about object files and all that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">here's a spectacularly nasty piece of code - I wanted to put together a completely self contained example for illustration purposes. The IntrMain function is given as inline assembly only to allow the mixing of ARM and thumb code within a single source file.</td> </tr></table><span class="postbody">
<br/>
Which is why I wait to introduce the minimal ISR and IntrWait() until after having introduced multiple source files and GNU Make in chapter 3.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">This code is not what I would consider clean</td> </tr></table><span class="postbody">
<br/>
Tutorials need clean code.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define   VRAM      ((u16*)0x06000000)</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Want to see a really clever way of accessing mode 3?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef u16 MODE3_LINE[240];
<br/>
#define MODE3_FB ((MODE3_LINE *)0x06000000)</td> </tr></table><span class="postbody">
<br/>
Then one can access pixels as if they were in a 2D array, making it dead easy to write quick prototypes.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//---------------------------------------------------------------------------------
<br/>
#if   defined   ( __thumb__ )
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"\n" :::  "r0", "r1", "r2", "r3")
<br/>
#else
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"   &lt;&lt; 16\n" :::"r0", "r1", "r2", "r3")
<br/>
#endif
<br/>
#define   VBlankIntrWait()   SystemCall(5)
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Clever. Thanks. Do you have a macro for SWIs that take arguments? I seem to recall that a register may not appear both in the input list and in the clobber list.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
 While at it, add in the section how to create a timer with VBlank interupt to time your game (took me some time to figure out why my game was running fine in 1 emulator and too fast/slow in others (was using hardware timers)).</td> </tr></table><span class="postbody">
<br/>
this is a problem with the emulators, not your code.</span></td> </tr></table><span class="postbody">
<br/>
I'm already hinting that counting vblanks is the right way to time animations.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21054 - keldon - Sat May 22, 2004 3:00 pm</h4>
    <div class="postbody"><span class="postbody">that is what's wrong with the tutorials - - you're telling them how to run the 100 metres before they've learned how to jump off the launch pad.
<br/>
<br/>
In your tutorials get them to do the basic stuff - but include the complex code as <span style="font-weight: bold">your tutorial include</span>, letting them know it's behind so that they don't have to worry about it. Then let them write their own VBlank routine / handler for another tutorial so they know how to do it themselves later.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21074 - poslundc - Sun May 23, 2004 2:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">while (REG_VCOUNT&lt;160); is not sufficient for a working wait for vsync, especially with simple programs. The correct way to do this is to wait for the vblank period to finish, then wait for it to start again.</td> </tr></table><span class="postbody">
<br/>
<br/>
This is true, and it's important that tutorials teach it this way. I'm not certain whether or not the Pern tutorials do.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Given that REG_DISPSTAT contains a flag which will tell you if the machine is currently in the vblank period, I fail to see why people feel the need to use the scan line counter for this purpose apart from someone getting it wrong back in the mists of time.</td> </tr></table><span class="postbody">
<br/>
<br/>
Let's be clear on one thing: counting scanlines isn't "getting it wrong". It's not wrong because it works just fine and makes perfect sense from a hardware perspective.
<br/>
<br/>
But yes, checking REG_DISPSTAT is just as effective and an equally viable way to teach VBlank synching. One is not inherently more right than the other, though.
<br/>
<br/>
I like using the scanline counter because often I am interested in trapping other phases of the CPU in addition to VBlank. Scanline counting is an easy way to do this.
<br/>
<br/>
I like scanline counting in tutorials because it gets the programmers thinking about and comprehending the way their software interacts timing-wise with the hardware.
<br/>
<br/>
But these are both personal, subjective reasons. I think a tutorial that teaches either method is fine.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The problem with this is that most of the time your code will be sitting in a loop doing nothing more than consuming the battery. This can translate into 50 - 60% less battery life (yes you did read that right)</td> </tr></table><span class="postbody">
<br/>
<br/>
My own experience doesn't support those findings one bit. Perhaps if you had a program that did nothing but call VBlankIntrWait vs. a program that hangs in an infinite loop? But then I would still be surprised at those numbers.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">here's a spectacularly nasty piece of code
<br/>
<br/>
&lt;nasty code snipped&gt;</td> </tr></table><span class="postbody">
<br/>
<br/>
This is how you want to train beginners?! They will take Pern over your tutorial any day!
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21082 - mr_schmoe - Sun May 23, 2004 5:50 pm</h4>
    <div class="postbody"><span class="postbody">So, when are ya'll going to get around to writing these updated tutorials?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21084 - Lord Graga - Sun May 23, 2004 7:58 pm</h4>
    <div class="postbody"><span class="postbody">One thing that I would enjoy quite a lot was, if all basic things had 2 or 3 documents that explained it, making it easier to go "Uh, I don't get that, lemme check what the other one tells me about this!". :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21085 - tepples - Sun May 23, 2004 7:58 pm</h4>
    <div class="postbody"><span class="postbody">I'm writing them a little bit every day.  So far here's a <a class="postlink" href="http://pinocchio.jk0.org/gbatuto.zip" target="_blank">draft of the outline and the first section</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21090 - ecurtz - Sun May 23, 2004 8:21 pm</h4>
    <div class="postbody"><span class="postbody">I'd love to see the Mac and Linux information included as well, maybe linked in pages in the sections where you were explaining Windows specific stuff. I'm not volunteering (yet) but I'm sure you could get somebody to write those sections for you if you didn't have time or inclination.
<br/>
<br/>
I think the current order looks good. IMO sprites are sipler to understand than the tiled graphics modes and should come first.
<br/>
<br/>
It would be VERY cool, although obviously more work, to have the tools such as image conversion written in Java or something so the source could be included. I think it helps a lot to think about how the data is getting used to understand how you're creating the data in the first place.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21094 - sgeos - Sun May 23, 2004 8:48 pm</h4>
    <div class="postbody"><span class="postbody">I think it would be neat if each lesson was a stand alone module with prerequisite module knowledge listed.  That would also make it easier for other authors to help write tutorial modules.
<br/>
<br/>
For example:
<br/>
Mode 7 (needs scale/rotate bgs, ISRs, and fixed point math)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21098 - tepples - Sun May 23, 2004 9:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ecurtz wrote:</b></span></td> </tr> <tr> <td class="quote">I'd love to see the Mac and Linux information included as well</td> </tr></table><span class="postbody">
<br/>
If I had a recent enough Macintosh computer (that is, not a 75 MHz POS running Mac OS 8.1 that grandpa uses to do a pub's books) or a PC video card that worked well with X11 (Mandrake 9.2 couldn't put my ATI Radeon 9000 into an accelerated mode), I would be able to develop and test such instructions myself. Under the free documentation licenses that cover the tutorial, any volunteer is free to do that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">It would be VERY cool, although obviously more work, to have the tools such as image conversion written in Java or something so the source could be included.</td> </tr></table><span class="postbody">
<br/>
I'm already including the C source code for all tools I provide.
<br/>
<br/>
And no, Brendan, "mode 7" (that is, rotation and scaling of individual scanlines of a background) doesn't need interrupts. It needs only HDMA. But I still find your dependency idea interesting.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21100 - sgeos - Sun May 23, 2004 9:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">And no, Brendan, "mode 7" (that is, rotation and scaling of individual scanlines of a background) doesn't need interrupts. It needs only HDMA. But I still find your dependency idea interesting.</td> </tr></table><span class="postbody">
<br/>
<br/>
Thats the neat thing about dependencies is that different authors could write different tutorials:
<br/>
<br/>
"mode 7" speed version (needs rot scale bgs, and HDMA)
<br/>
"mode 7" space version (needs rot scale bgs, and ISRs)
<br/>
<br/>
Assuming that more than one version of a topic has been written, it allows for specialization.  Somebody might finish learning about HDMA and really like the concept.  Great!  There is tutorial out there that draws on those skills.  If the learner skipped DMA and learned about ISRs first, then s/he can still learn about the "mode 7" effect.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21103 - wintermute - Sun May 23, 2004 10:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The problem with this is that most of the time your code will be sitting in a loop doing nothing more than consuming the battery. This can translate into 50 - 60% less battery life (yes you did read that right)</td> </tr></table><span class="postbody">
<br/>
<br/>
My own experience doesn't support those findings one bit. Perhaps if you had a program that did nothing but call VBlankIntrWait vs. a program that hangs in an infinite loop? But then I would still be surprised at those numbers.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
then you haven't tested it. As I said in the original post, you'd be unpleasantly surprised by the numbers.
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">here's a spectacularly nasty piece of code
<br/>
<br/>
&lt;nasty code snipped&gt;</td> </tr></table><span class="postbody">
<br/>
<br/>
This is how you want to train beginners?! They will take Pern over your tutorial any day!
<br/>
<br/>
Dan.[/quote]
<br/>
<br/>
No, as I said, it's a spectacularly nasty piece of code it was just done that way to get a completely self contained example for purposes of illustration..
<br/>
<br/>
Secondly, I'm not the one writing tutorials.
<br/>
<br/>
Thirdly, it looks to me like you're a bit of a troll.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21108 - poslundc - Sun May 23, 2004 11:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">My own experience doesn't support those findings one bit. Perhaps if you had a program that did nothing but call VBlankIntrWait vs. a program that hangs in an infinite loop? But then I would still be surprised at those numbers.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
then you haven't tested it. As I said in the original post, you'd be unpleasantly surprised by the numbers.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
What can I say? I've never observed more than maybe 20% difference in battery drain in the programs I've written.
<br/>
<br/>
As for the example... I have little use for a program that does nothing but wait for VBlank to occur, and you've already expressed in an interest in making tutorial information practical.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">No, as I said, it's a spectacularly nasty piece of code it was just done that way to get a completely self contained example for purposes of illustration..</td> </tr></table><span class="postbody">
<br/>
<br/>
Of what, exactly? We already know how VBlank syncing with interrupts is done. This is a thread about what ought to be taught in tutorials. I fail to see how a messy example of VBlank syncing furthers that resolution.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Thirdly, it looks to me like you're a bit of a troll.</td> </tr></table><span class="postbody">
<br/>
<br/>
That's such a ridiculously inappropriate thing to say I can barely formulate a response to it. I could point out that I've backed up every single point I've made with logic and relevance to the topic. I could point out that if I am a troll, I must be a very good one since you're the first person to find me out in the 800-odd posts I've made; I've managed to trick just about everyone else in thinking I'm a valued contributor to the forums. I could point out that a troll is someone who baits others into responding with intentionally inflammatory, non-substantial posts, not someone who argues a point well. I could say it looks to me like you're a bit of an idiot who isn't capable of attacking my argument so is trying to attack my character instead.
<br/>
<br/>
But instead I will simply say that I don't have the time to waste on mudslingers. Let me know when you have something salient to say in response to my points.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21109 - wintermute - Mon May 24, 2004 12:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Vblank syncing is one of the most fundamental tasks when writing a game, especially on a machine like the GBA where access to VRAM is restricted outside the vblank period. If you want to put things on screen you *need* to know about it.</td> </tr></table><span class="postbody">
<br/>
Unlike GBC VRAM, GBA VRAM is dual-ported. OAM, on the other hand, needs to be updated either in vblank or (if the unlock bit of DISPCNT is set) in hblank.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Odd, a lot of documention suggests that this isn't the case. I've also seen it reported that it is not possible to write to VRAM which is currently being accessed by the LCD controller.
<br/>
<br/>
I've just done some tests which confirm that this doesn't appear to be the case. I find it difficult to believe that the VRAM is actually dual ported though - it seems more likely that wait states are inserted (Nintendo being renowned for doing things on the cheap - DMA and the 16bit write to VRAM being prime examples). Must try some speed tests later.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Spinning on DISPSTAT and spinning on VCOUNT take the same amount of CPU effort.</td> </tr></table><span class="postbody">
<br/>
<br/>
just checked some gcc thumb output, the DISPSTAT one is 4bytes shorter and has 2 fewer instructions in the loop so actually they don't. That's just picky though :P 
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
This is the hard part, and without extremely hairy hacks, it seems to require compiling separate source files, one for main() in Thumb, and one for isr() in ARM. Then I have to teach about object files and all that.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
yeah, I was a bit surprised by how hairy that example was :)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Tutorials need clean code.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
completely, as I said it was just done that way to get a self contained example for illustration.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define   VRAM      ((u16*)0x06000000)</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Want to see a really clever way of accessing mode 3?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef u16 MODE3_LINE[240];
<br/>
#define MODE3_FB ((MODE3_LINE *)0x06000000)</td> </tr></table><span class="postbody">
<br/>
Then one can access pixels as if they were in a 2D array, making it dead easy to write quick prototypes.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
That's quite neat, shame you can't do that for mode 4. Consider it nicked :)
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//---------------------------------------------------------------------------------
<br/>
#if   defined   ( __thumb__ )
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"\n" :::  "r0", "r1", "r2", "r3")
<br/>
#else
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"   &lt;&lt; 16\n" :::"r0", "r1", "r2", "r3")
<br/>
#endif
<br/>
#define   VBlankIntrWait()   SystemCall(5)
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Clever. Thanks. Do you have a macro for SWIs that take arguments? I seem to recall that a register may not appear both in the input list and in the clobber list.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
The best way to do this is just to put the calls in a library as I've done with llibgba. GCC uses r0 - r3 as parameters to functions with 4 or less arguments with the rest going on the stack for 5 or more. I've played around with inlining these calls but I came to the conclusion that it's just not worth the trouble.
<br/>
<br/>
*Warning*  do not place this function declaration in the same file as code which calls it. At higher optimisation levels gcc will inline the function and mess it up quite badly. Fixing this makes the compiler generate more code tthan it would for a simple function call so, personally, I'd recommend just not bothering.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "gba_systemcalls.h"
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
void CpuSet( const void *source,  void *dest, u32 mode)
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   SystemCall(11);
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
void CpuFastSet( const void *source,  void *dest, u32 mode)
<br/>
//---------------------------------------------------------------------------------
<br/>
{
<br/>
   SystemCall(12);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
For functions which return parameters it seems to be easiest just to resort to assembly.
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
prototype in header file
<br/>
<br/>
u16 Sqrt(u32 X);
<br/>
<br/>
in assembly file
<br/>
<br/>
<br/>
   .text
<br/>
   .code 16
<br/>
<br/>
   .global   Sqrt
<br/>
   .thumb_func
<br/>
Sqrt:
<br/>
   swi      8
<br/>
   bx      lr
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21110 - wintermute - Mon May 24, 2004 12:37 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
But instead I will simply say that I don't have the time to waste on mudslingers. Let me know when you have something salient to say in response to my points.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
ditto</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21118 - tepples - Mon May 24, 2004 5:04 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">The best way to do this is just to put the calls in a library as I've done with llibgba.</td> </tr></table><span class="postbody">
<br/>
When do you plan on having a draft libgba manual so that I can build the tutorial around it?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21121 - sajiimori - Mon May 24, 2004 7:08 am</h4>
    <div class="postbody"><span class="postbody">Boy wm, you are digging quite a hole for yourself.  You have a lot of nerve calling Dan names, especially since several people have already backed him up.  Or are we all conspiring to troll just for you?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
just checked some gcc thumb output, the DISPSTAT one is 4bytes shorter and has 2 fewer instructions in the loop so actually they don't. That's just picky though :P
<br/>
</td> </tr></table><span class="postbody">
<br/>
Utter nonsense.  A short loop and a long loop take the same CPU cycles if they run for the same amount of time, which they obviously will if they are waiting for the same event.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21122 - Dracula-X - Mon May 24, 2004 9:49 am</h4>
    <div class="postbody"><span class="postbody">My .02 -  if you don't like it, I couldn't care less. :)
<br/>
<br/>
Battery life is of <span style="font-weight: bold">paramount</span> importance, regardless of what a personal 'finding' may be. Nintendo, being the ultimate authority on official protocol and guidelines, has layed out what is termed as proper, and dismissing battery life is just downright juvenile.  A fundamental question would be what do you think most beginners would prefer to be taught - the proper way, as outlined by Nintendo themselves, or in a manner that is contrary (particularly because some post on this board says it's ok)?  I would wager most would want to be taught what is proper, as defined by Nintendo, especially if they have sights on pursuing a career in the industry.  There is a 'right' way, and beginners ought to be taught the right way - or don't teach them at all.
<br/>
<br/>
I'm a bit dismayed at how this thread has turned sour, especially over so trivial a matter.  I'd also like to point out that no amount of posting to these boards should ever be a measure of some self-imagined authority over what is proper and what is not.  This is Nintendo hardware, and we should be following their guidelines - and let's not bring up the fact that we shouldn't even be aware of said guidelines when everyone is being pointed to documentations and manuals that often lift naming conventions and documentation verbatim and everything the homebrew 'scene' has (docs, emulators) is owed to leaked material (*sniff*, *sniff* what's that? oh! that is the smell of hypocrisy!).
<br/>
<br/>
Let's agree to disagree and keep it at that, and leave it civil.  My vote is for teaching the proper method.  I am agreeable to counting scanlines as long as there is sufficient documentation explaining why this hits the batteries hard (yes, it <span style="font-weight: bold">does</span>).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21126 - poslundc - Mon May 24, 2004 12:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">(*sniff*, *sniff* what's that? oh! that is the smell of hypocrisy!). 
<br/>
<br/>
Let's agree to disagree and keep it at that, and leave it civil.</td> </tr></table><span class="postbody">
<br/>
<br/>
Speaking of hypocrisy... why not drop the sarcastic attitude if you care at all about civility.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Battery life is of paramount importance, regardless of what a personal 'finding' may be.</td> </tr></table><span class="postbody">
<br/>
<br/>
- It is clearly of paramount importance to <span style="font-weight: bold">you</span>. That does <span style="font-style: italic">not</span> make it of paramount importance to a beginner's tutorial. What <span style="font-style: italic">is</span> important to a beginner's tutorial is getting new programmers started on the GBA hardware with minimal difficulty and effort, so they will be able to fill in the gaps and learn the rest on their own. As such, Nintendo considering something to be an industry standard for publication is <span style="font-style: italic">completely irrelevant</span> to such a tutorial.
<br/>
<br/>
- I'll say it again: it is not the job of a beginner's tutorial to teach new programmers the optimizations Nintendo expects them to use if/when their game gets published. Anyone who writes GBA software good enough to merit publication will be perfectly able to optimize their VBlank syncing with interrupts when the time comes. None of them will come crying to the forum that their beginner's tutorial taught them to count scanlines instead.
<br/>
<br/>
- My "personal findings" are useless if there is any hard documentation to the contrary around. Currently there is none. We welcome you to perform and document the necessary tests to develop the curve relating battery drain to CPU activity (also taking into account things like areas of memory the instructions are being run from, prefetch state, etc.). We would thank you greatly for it. But until this is done your claim that it "hits the batteries hard (yes, it <span style="font-weight: bold">does</span>)" is just as meaningless a "personal finding" as mine.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'd also like to point out that no amount of posting to these boards should ever be a measure of some self-imagined authority over what is proper and what is not.</td> </tr></table><span class="postbody">
<br/>
<br/>
Since this is an obvious reference to my mentioning of my post-count, I'll just say you are totally off-base with regards to my meaning. I have no interest in establishing authority of any sort; we have admins here for that. I don't think I am more "special" than anyone else because of it; certainly there are people on this board who post less than me who know a hell of a lot more, in fact, many of them taught me the stuff I know. I was called a troll, and simply rebutting the insult. Read the post again.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21128 - Dracula-X - Mon May 24, 2004 2:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">Speaking of hypocrisy... why not drop the sarcastic attitude if you care at all about civility.</td> </tr></table><span class="postbody">
<br/>
I'll reserve the right to a sarcastic remark in the face of hypocrisy, the fact that you resorted to a schoolyard "I know you are but what am I" retort brings a smile to my face.  You can drop it now.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Battery life is of paramount importance, regardless of what a personal 'finding' may be.</td> </tr></table><span class="postbody">
<br/>
- It is clearly of paramount importance to <span style="font-weight: bold">you</span>. That does <span style="font-style: italic">not</span> make it of paramount importance to a beginner's tutorial. What <span style="font-style: italic">is</span> important to a beginner's tutorial is getting new programmers started on the GBA hardware with minimal difficulty and effort, so they will be able to fill in the gaps and learn the rest on their own. As such, Nintendo considering something to be an industry standard for publication is <span style="font-style: italic">completely irrelevant</span> to such a tutorial.</span></td> </tr></table><span class="postbody">
<br/>
Subjective opinion is what that is.  You want to start them out on the wrong road in the name hand-holding.  I'd rather they learn the right way with documentation on a level they can understand.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">- I'll say it again: it is not the job of a beginner's tutorial to teach new programmers the optimizations Nintendo expects them to use if/when their game gets published. Anyone who writes GBA software good enough to merit publication will be perfectly able to optimize their VBlank syncing with interrupts when the time comes. None of them will come crying to the forum that their beginner's tutorial taught them to count scanlines instead.</td> </tr></table><span class="postbody">
<br/>
I see, you've appointed yourself an authority on what beginner tutorials should teach too, because I don't see an "I think" or "I feel" in there anywhere, so you must be right!.  I'll say it again, you ask a newcomer if he or she would rather learn the way the professionals do it, the way Nintendo wants it done, or some halfhearted method for the sake of being simple and making things 'easy' because you don't have faith in the tutorial writer's ability to explain it properly (which is bordering absurdity because setting up a vblank irq and syncing with it is trivial), my gut tells me the majority of beginners will want to do it the <span style="font-weight: bold">right way</span>.  A well constructed tutorial will guide readers appropriately and explain things thoroughly using the industry accepted methods. End of story.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">- My "personal findings" are useless if there is any hard documentation to the contrary around. Currently there is none. We welcome you to perform and document the necessary tests to develop the curve relating battery drain to CPU activity (also taking into account things like areas of memory the instructions are being run from, prefetch state, etc.). We would thank you greatly for it. But until this is done your claim that it "hits the batteries hard (yes, it <span style="font-weight: bold">does</span>)" is just as meaningless a "personal finding" as mine.</td> </tr></table><span class="postbody">
<br/>
Ooh, very clever, and very convenient.  For those of us who make a living and must abide by <span style="font-weight: bold">Nintendo's</span> regulations to put a game on the shelf must all be suffering from some mass delusion, and Nintendo must have pulled this stipulation from their arse (I guess they want to be cheeky). All because poslundc 'says so' - that's really what it comes down to.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'd also like to point out that no amount of posting to these boards should ever be a measure of some self-imagined authority over what is proper and what is not.</td> </tr></table><span class="postbody">
<br/>
Since this is an obvious reference to my mentioning of my post-count, I'll just say you are totally off-base with regards to my meaning. I have no interest in establishing authority of any sort; we have admins here for that. I don't think I am more "special" than anyone else because of it; certainly there are people on this board who post less than me who know a hell of a lot more, in fact, many of them taught me the stuff I know. I was called a troll, and simply rebutting the insult. Read the post again.</span></td> </tr></table><span class="postbody">
<br/>
Really could have fooled me :)  An <span style="font-weight: bold">industry veteran</span> of 2 decades (that's right kids, wintermute has been doing this a LONG time) suggests using the proper method in the tutorial (not only because it is the way the pros do it, not only because it's the way Nintendo wants it done, but because there is nothing inherently complex or confusing about it if explained the way it needs to be - or do you not have faith in Tepples' ability to handle it?) and because it doesn't resonate with your 'zen of scanline counting' you get your panties in a bunch.  Wonderful.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21140 - sajiimori - Mon May 24, 2004 7:17 pm</h4>
    <div class="postbody"><span class="postbody">Move it to Offtopic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21142 - keldon - Mon May 24, 2004 8:05 pm</h4>
    <div class="postbody"><span class="postbody">:D lolol</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21146 - Miked0801 - Mon May 24, 2004 10:10 pm</h4>
    <div class="postbody"><span class="postbody">ty.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21150 - dagamer34 - Mon May 24, 2004 10:20 pm</h4>
    <div class="postbody"><span class="postbody">This topic is really turning sour. Is there anyway to save it? Perhaps someone really <span style="font-weight: bold">should</span> do those battery tests.
<br/>
<br/>
I don't think the number of posts should affect the quality of an answer. There are no prizes, or rankings as such, so if someone has 800+ posts and hasn't had their account deleted, they <span style="font-weight: bold">must</span> have done something right?
<br/>
<br/>
And if people are going to bicker, don't even move it to Off Topic. Just PM each other and go at it there.
<br/>
<br/>
It's sad to see our boards turn this way. Just when I had thought I had found a place where there is no fighting, differences come between us.
<br/>
<br/>
EDIT: tepples, I think you should add a "Common Pitfalls" section to the tutorials that would include things like "No 8-bit writes to VRAM" and stuff like that.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21152 - wintermute - Mon May 24, 2004 10:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">The best way to do this is just to put the calls in a library as I've done with libgba.</td> </tr></table><span class="postbody">
<br/>
When do you plan on having a draft libgba manual so that I can build the tutorial around it?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
dang, I guess I'm going to have to shuffle this one up my todo list a touch :P
<br/>
<br/>
It's been something I've been meaning to do for a while but haven't yet decided on a format for. One of the problems I keep coming back to is just how much depth to go into regarding the hw register definitions - it seems like a lot of work to essentially replicate extremely good documentation like gbatek.
<br/>
<br/>
Perhaps building your tutorials around libgba would be a good approach towards a good set of documentation. Having the tutorials explain the registers and  having a quick reference guide with libgba.
<br/>
<br/>
I'm open to suggestions as to the best way to do it</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21156 - keldon - Tue May 25, 2004 12:25 am</h4>
    <div class="postbody"><span class="postbody">I feel it is important to let newbies know there is a lot more to creating games than using these libraries. But not by principle, I do this so that they don't develop games for months wondering why they CANNOT do X and Y - - and saying "if only they didn't put such a mask over me"
<br/>
<br/>
I don't mean to shower them with information. But balance good practice with the learning curve. Nothing should take more than 20 minutes to learn, and anything bigger than that should be carefully taught (usually by breaking it down).
<br/>
<br/>
One problem people have is that they forget that a complete beginner cannot even program, let alone deal with hardware. And we will never teach beginners unless we remember this.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21158 - tepples - Tue May 25, 2004 1:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dracula-X wrote:</b></span></td> </tr> <tr> <td class="quote">A fundamental question would be what do you think most beginners would prefer to be taught - the proper way, as outlined by Nintendo themselves</td> </tr></table><span class="postbody">
<br/>
The "proper way" is to get a developer license before even looking at a tutorial. Don't worry; I plan to introduce VBlankIntrWait() as soon as I've introduced hardware and software interrupts.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I would wager most would want to be taught what is proper, as defined by Nintendo</td> </tr></table><span class="postbody">
<br/>
Would evidence of "proper" behavior include Nintendo's legal action against vendors of flash carts?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">This is Nintendo hardware</td> </tr></table><span class="postbody">
<br/>
I'm typing this on Dell hardware.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">and we should be following their guidelines</td> </tr></table><span class="postbody">
<br/>
Nintendo's guidelines are "don't."
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Let's agree to disagree and keep it at that, and leave it civil.  My vote is for teaching the proper method.</td> </tr></table><span class="postbody">
<br/>
Do you mean "teaching the proper method" or "teaching the proper method" FIRST? The "proper method" requires either more complicated build scripts or extremely hairy assembly hacks?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">they forget that a complete beginner cannot even program</td> </tr></table><span class="postbody">
<br/>
I do list C programming as a prerequisite in the first chapter.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21162 - sgeos - Tue May 25, 2004 4:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">This topic is really turning sour. Is there anyway to save it?</td> </tr></table><span class="postbody">
<br/>
That depends on one's personal definition of save.  Once you ignore the noise, this topic *is* saved.  People can argue about how a tutorial can be done from now until the end of time, but until they have written a tutorial and received feedback on it, I can not give their side comments much merit.
<br/>
<br/>
I'd rather hear the constructive criticism that the tutorial writers have received instead of theories about what would make a better tutorial.  I think that talking about how existing tutorial material could be inproved is productive.
<br/>
<br/>
Bickering over another persons opinion strikes me as out of place.  My question is, "do you feel strongly enough about it to write your own tutorial?"  Yes?  Excellent.  I look forward to reading it.  No?  Let it go and the thread will become less noisy.  (Note that unless one *is* a troll, should not not bickering result in less stress?)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21166 - tepples - Tue May 25, 2004 5:35 am</h4>
    <div class="postbody"><span class="postbody">"Put up or shut up" eh? OK, I'll put up. Here's <a class="postlink" href="http://pinocchio.jk0.org/gbatuto.zip" target="_blank">my tutorial so far</a> with draft chapters 1 and 2. I'd like to see somebody run through the steps, particularly in chapter 1 about tool setup, and let me know how well they work.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21347 - bats - Fri May 28, 2004 3:00 am</h4>
    <div class="postbody"><span class="postbody">I tested the tool setup on my desktop, and everything went through without a hitch.
<br/>
<br/>
General comments on the tutorial:
<br/>
<ul>
<br/>
I like the code. Very clean, nice comments.
<br/>
<br/>
The header file is so simple! Very nice for a beginner's tutorial.
<br/>
<br/>
The documentation is a little cold -- maybe a little too technical for my taste [emotionally -- the technical aspects of the document have the right amount of technicality :) ]. Maybe that's what you were going for, though. I like when technical documents throw in some jokes, a quote at the beginning of the chapter, that kind of thing.
<br/>
<br/>
The flow through chapter 2 seemed a little awkward, the jump from GBA info into fixed-point arithmetic and Newtonian physics mainly. If I were reading a book I would expect those things to be in appendices.
<br/>
<br/>
The physics section could be fleshed out a bit, also. Next draft, I'd suppose.
<br/>
</ul>
<br/>
Other than that, a very nice start!
<br/>
<br/>
Ben</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21355 - tepples - Fri May 28, 2004 3:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>bats wrote:</b></span></td> </tr> <tr> <td class="quote">I like when technical documents throw in some jokes</td> </tr></table><span class="postbody">
<br/>
I can see two reasons for that: <ul><li>My personality includes Asperger syndrome, a mild form of autism that preserves high function but deadens my pragmatic language skills such as distinguishing a joke from a serious admonition. I enjoy puns, but some jokes make me think of ways that they could in fact be serious. Remember that the widely hated Digital Millennium Copyright Act and foreign counterparts started out perceived as a joke. </li><li>In this X-rated world, I tend to have trouble keeping jokes entirely G-rated. </li></ul>If somebody were to provide a humor patch against my tutorials, I would gladly review it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>bats wrote:</b></span></td> </tr> <tr> <td class="quote">The flow through chapter 2 seemed a little awkward, the jump from GBA info into fixed-point arithmetic and Newtonian physics mainly. The physics section could be fleshed out a bit, also. Next draft, I'd suppose.</td> </tr></table><span class="postbody">
<br/>
Don't those two goals conflict a bit? And does there exist a Free tutorial for game physics that I could include as a prerequisite? I'll work on a transition paragraph.
<br/>
<br/>
Otherwise, thanks.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21359 - sajiimori - Fri May 28, 2004 4:09 am</h4>
    <div class="postbody"><span class="postbody">There's an HTML typo in the section about installing MinGW.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
&lt;li&gt;Install MinGW by running the executable that you downloaded.
<br/>
    Remember that GCC and other programs from the
<br/>
    &lt;acronym title="Unified Information and
<br/>
    Control System"&gt;UNIX&lt;/acronym"&gt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
The UNIX acronym applies to the rest of the document. =)
<br/>
<br/>
edit: another one in Ch2
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
&lt;acronym title="video RAM"&gt;VRAM&lt;/acronym"&gt;
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21384 - bats - Fri May 28, 2004 2:13 pm</h4>
    <div class="postbody"><span class="postbody">I knew I shoulda kept my big mouth shut. Oh, well. Hope I didn't offend.
<br/>
<br/>
I don't think the goals conflict. It's just that when I was reading along, the fixed-point section kinda caught me be surprise. I'm probably making a bigger deal of this than is necessary. As for the physics section, it just seemed a little thin -- some simple formulas and concepts might be nice. Then again, an already finished game physics tutorial might be nicer. :)
<br/>
<br/>
I'd give gamedev.net a good search.
<br/>
<br/>
Ben</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21396 - sgeos - Fri May 28, 2004 6:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>bats wrote:</b></span></td> </tr> <tr> <td class="quote">I knew I shoulda kept my big mouth shut. Oh, well. Hope I didn't offend.</td> </tr></table><span class="postbody">
<br/>
<br/>
Any reasonable person likes to get feedback.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21582 - DigitalChaos - Tue Jun 01, 2004 11:42 am</h4>
    <div class="postbody"><span class="postbody">I just read the first two chapters. They're very good. Keep going and finish it. Gread code. Keep it up, how long do you expect it to be?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21640 - jeromie - Wed Jun 02, 2004 8:29 am</h4>
    <div class="postbody"><span class="postbody">Hi Guys - 
<br/>
<br/>
I just wanted to offer myself to the group as a guinnea pig for future tutorial stuff.
<br/>
<br/>
A little bit about me: 
<br/>
<br/>
I'm an experienced PHP developer with a few years of web development under my belt.  I'm familiar with basic C structures and constructs -- PHP borrows heavily from C and C++.  I understand general OO design concepts (classes, methods, functions, pointers), but I'm *not* used to accessing hardware and memory directly.
<br/>
<br/>
Hopefully I can be a good resource for you guys, providing feedback on the tutorial from the perspective of a user competent at the core skill set, but one who's still a neophyte for all intents and purposes.
<br/>
<br/>
I'm terribly bored with web development, and am looking to develop a new skill set.  I'm very appreciative of your efforts, and am looking forward to really getting my game development chops together.
<br/>
<br/>
Please let me know if I can be of any assistance.
<br/>
<br/>
Best regards,
<br/>
Jeromie Clark</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22018 - DigitalChaos - Fri Jun 11, 2004 9:37 am</h4>
    <div class="postbody"><span class="postbody">Any updates on this man?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22032 - tepples - Fri Jun 11, 2004 5:11 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, I got off track with Tournamix, a choreography competition on another phpBB forum I read. I'll probably have another chance to work on this today.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22039 - DigitalChaos - Fri Jun 11, 2004 8:13 pm</h4>
    <div class="postbody"><span class="postbody">awesome, i'm really looking forward to this</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22220 - Krakken - Tue Jun 15, 2004 12:18 am</h4>
    <div class="postbody"><span class="postbody">I've had a look through it and i'm impressed. Like someone mentioned just now though, some of the subjects are very, very brief. For example, the physics section, I think that should be made into a whole tutorial topic. It would be a valuable asset to a lot of people to understand concepts like the laws of physics and how they are applied in programming. Unless i'm mistaken also, physics has not been covered in any other GBA tutorials.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22246 - Fatnickc - Tue Jun 15, 2004 5:19 pm</h4>
    <div class="postbody"><span class="postbody">Sorry to ask this if it has already been asked, or it is not ready to be read by us yet, but what is the address of the tutorial?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22250 - alek - Tue Jun 15, 2004 9:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Fatnickc wrote:</b></span></td> </tr> <tr> <td class="quote">Sorry to ask this if it has already been asked, or it is not ready to be read by us yet, but what is the address of the tutorial?</td> </tr></table><span class="postbody">
<br/>
If you look at the previous page and the post second from the bottom I think you might find what you are looking for</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22258 - DigitalChaos - Wed Jun 16, 2004 7:31 am</h4>
    <div class="postbody"><span class="postbody">still waitin on updates...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22272 - Fatnickc - Wed Jun 16, 2004 5:23 pm</h4>
    <div class="postbody"><span class="postbody">thank you for that. I need to improve my skills and figure it would be better to start again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22514 - tepples - Wed Jun 23, 2004 8:54 am</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">T u t o r i a l . P a r t . 3</span>
<br/>
<br/>
covering bitmap images in modes 3 and 5
<br/>
<br/>
can be found <a class="postlink" href="http://pinocchio.jk0.org/gbatuto.zip" target="_blank">here</a>
<br/>
<br/>
provided my internet connection isn't down
<br/>
<br/>
have any bad habits snuck in?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22566 - skinnybeans - Thu Jun 24, 2004 10:37 am</h4>
    <div class="postbody"><span class="postbody">ive read through the first 2 tutes and really like them. They are much easier to understand than the pern project ones!!
<br/>
<br/>
I hope you keep up the good work. Are interrupts like callbacks?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22574 - tepples - Thu Jun 24, 2004 2:48 pm</h4>
    <div class="postbody"><span class="postbody">Yes, interrupts on the GBA are a bit like callbacks, but I won't get to them until chapter 6.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22700 - skinnybeans - Sun Jun 27, 2004 11:08 am</h4>
    <div class="postbody"><span class="postbody">cool, i look forward to it.
<br/>
<br/>
not sure if i should post this here or in another thread, but seeing as im using the setup from the tutorial, and its kinda related teaching newbies things ill ask here:
<br/>
<br/>
How do you debug your gba proggies when they are running?? Ive taken the code from the second tute and tried to add a generic line drawing fucntion that uses bresenhams algorithm but it aint working, and not being able to check the values of variables at run-time means i have pretty much no chance of getting it working proplerly!
<br/>
<br/>
Im used to developing in visual studio and setting breakpoints and all that jazz, is there anyway i can do something like this for gba dev? is this going to be covered in one of your tutorials?
<br/>
<br/>
Ive got mappy and it seems to allow some of these features if you load an elf file into it. I tried but had no success =(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22701 - wintermute - Sun Jun 27, 2004 11:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>skinnybeans wrote:</b></span></td> </tr> <tr> <td class="quote">cool, i look forward to it.
<br/>
<br/>
How do you debug your gba proggies when they are running?? Ive taken the code from the second tute and tried to add a generic line drawing fucntion that uses bresenhams algorithm but it aint working, and not being able to check the values of variables at run-time means i have pretty much no chance of getting it working proplerly!
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Go to <a href="http://www.devkit.tk" target="_blank">http://www.devkit.tk</a>
<br/>
<br/>
in the downloads section you'll find Insight 5.2.1 and Visualboy Advance 1.7.1 SDL version.
<br/>
<br/>
Start that version of VBA from a command shell with the command line 'vba -Gtcp' (you can also do this with a batch file or add the parameters to a windows shortcut)
<br/>
<br/>
Start arm-elf-gdb from the Insight package , File-&gt;open and select the elf file that you compiled ( I hope you used devkitARM :P) Now click File-&gt;Target Settings - here select Remote/TCP, 127.0.0.1 in the hostname box and 55555 in the Port box. Click the run button.
<br/>
<br/>
you need to add -g to the parameters for beth link and compile.
<br/>
<br/>
Hey presto full source level debugging.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22710 - tepples - Sun Jun 27, 2004 6:15 pm</h4>
    <div class="postbody"><span class="postbody">I will warn you that GBFS won't work with .elf files, but if you use bin2s on your GBFS file instead of appending it and then using find_first_gbfs_file(), you can still debug a program that uses GBFS.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22722 - dagamer34 - Sun Jun 27, 2004 10:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">I will warn you that GBFS won't work with .elf files, but if you use bin2s on your GBFS file instead of appending it and then using find_first_gbfs_file(), you can still debug a program that uses GBFS.</td> </tr></table><span class="postbody">
<br/>
<br/>
Do you have an example to the bin2s method?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22734 - tepples - Mon Jun 28, 2004 7:27 am</h4>
    <div class="postbody"><span class="postbody">The bin2s way, for the builds used within the programming department for source level debugging:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">(in make.bat)
<br/>
bin2s data.gbfs &gt; data.s
<br/>
gcc -Wall -O -mthumb -mthumb-interwork main.c data.s -o main.elf
<br/>
<br/>
(in main.c)
<br/>
extern const GBFS_FILE data_gbfs[];</td> </tr></table><span class="postbody">
<br/>
The appended way, for the builds sent to the assets department:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">(in make.bat)
<br/>
gcc -Wall -O -mthumb -mthumb-interwork main.c -o main.elf
<br/>
objcopy -O binary main.elf main.bin
<br/>
padbin 256 tmp.bin
<br/>
copy /b tmp.bin+data.gbfs main.gba
<br/>
<br/>
(in main.c)
<br/>
const GBFS_FILE *data_gbfs;
<br/>
int main() {
<br/>
  find_first_gbfs_file(find_first_gbfs_file);
<br/>
  /* ... */
<br/>
}</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24117 - dagamer34 - Wed Jul 28, 2004 3:58 am</h4>
    <div class="postbody"><span class="postbody">I guess I should have posted this a while back... but here are the things I think would be good to put in the dictionary:
<br/>
<br/>
ISR, VBlank, HBlank, DMA, HDMA, Modes 0-5(brief description), EEPROM, SRAM, Flash ROM, EWRAM, IWRAM, OAM, Tiles, Interrupts. 
<br/>
<br/>
That's what I have so far. If you want me to, I can also come up with the definitions.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24123 - dovoto - Wed Jul 28, 2004 7:28 am</h4>
    <div class="postbody"><span class="postbody">A quick response in defense of the pern project.
<br/>
<br/>
1) They are being rewritten with proper grammar and spelling (at least more proper)
<br/>
<br/>
2) Day 1, and 2 rewrites are complete and up, and include such things as how to get data into your games by every means other then some sort of proprietary rom file system.  The new graphics converter (improperly named pcx2sprite) can output raw, c, header, object file, and source code will be provided when I have time to comment it.  Day 3, and 9 should be up in this weekend.
<br/>
<br/>
3) Defines are fine for registers...if your emulator does not have a register viewer get a new emulator.  But the tutorials purpose is not to give you a library but to teach you the hardware.  The implementation is completely up to you.  Use bitfields for all I care :)
<br/>
<br/>
4) Day 3 and nine should be up by the end of the week.
<br/>
<br/>
5) make is a waste of time for single file projects such as 90% of my tutorials and I felt (and still feel) that make is a complexity that has no place in my tutorial.
<br/>
<br/>
6) In response to 5 and as a compromise I will add an appendix to cover make files, and be sure to enlighten readers on the proper way to manage projects.  
<br/>
<br/>
7) I have several hundred hours of effort invested in my tutorials and well over a hundred pages of GBA info.. I have no editor and I can?t spell, but I do now write my text in a word processor before posting it for the world to see.  My tutorials are always open to feedback of any sort. 
<br/>
<br/>
8) I have only made it to page two of this thread and felt compelled to post so if i am being redundant please forgive :)
<br/>
<br/>
9) My tutorials were at one time very popular and their accuracy and "correctness" both in a technical sense and in an aesthetic sense are important to me.  Instead of starting a new series can we instead just give me feedback to incorporate into my rewrite?  
<br/>
<br/>
<br/>
-i am going to finish reading this thread and see if there is anything else to add.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24144 - tepples - Wed Jul 28, 2004 3:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dovoto wrote:</b></span></td> </tr> <tr> <td class="quote">2) Day 1, and 2 rewrites are complete and up, and include such things as how to get data into your games by every means other then some sort of proprietary rom file system.</td> </tr></table><span class="postbody">
<br/>
Slight correction: GBFS isn't <a class="postlink" href="http://www.gnu.org/philosophy/categories.html#ProprietarySoftware" target="_blank">proprietary</a> but rather <a class="postlink" href="http://www.gnu.org/philosophy/categories.html#FreeSoftware" target="_blank">free software</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">5) make is a waste of time for single file projects such as 90% of my tutorials</td> </tr></table><span class="postbody">
<br/>
Anything that involves converting bitmaps won't be a single file project, as you need at least one file for code and one for graphics. Anything on or after the day ISRs are introduced won't be a single file project, as you need at least one file for Thumb code in ROM and another for ARM code in IWRAM.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">9) My tutorials were at one time very popular and their accuracy and "correctness" both in a technical sense and in an aesthetic sense are important to me.  Instead of starting a new series can we instead just give me feedback to incorporate into my rewrite?</td> </tr></table><span class="postbody">
<br/>
I wish you good luck on version 2.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25256 - Deanonious - Thu Aug 19, 2004 4:09 pm</h4>
    <div class="postbody"><span class="postbody">I have significant experience writing software in Windows... mostly Visual Basic and some Visual C++, and because of that I have absolutely no hardware programming experience, so prior windows programming experience a side, I consider myself a complete newbie.
<br/>
<br/>
I have looked through many of the tutorials out there, I even read through all of Mr. Harbour's book, and I have some comments on what I have found or not found in them, and I think this insight would be quite useful to the discussion at hand.
<br/>
<br/>
1) Coming from a totally "Modern" Windows programming background I do not completely understand Timers or Interrupts.  I understand procedural programs and Event driven programs, and although Message Handlers are a direct descendent of Interrupt Handlers I have been so completely sheltered from the hardware aspects of coding them that Interrupt Handlers still remain mysterious to me.  I do realize and undestand there importance in GBA programming, but I have not found a concise and adaquate reference on them.  I believe that a good introduction to them should be made as early as possible in the Beginner Tutorials, and then as the tutorials progress more in depth coverage of them should be given.
<br/>
<br/>
2)  Memory management is another GBA programming issue that I somewhat struggle with, "Modern" PC programmers are not taught to maximize memory usage, and since I have started learning GBA programming I have decided that this is a great shame, and I now consider it "bad" programming practices.  I believe that the non-technical aspects of memory management should be covered very early, perhaps even in the introduction to the tutorials, and then more in depth coverage should be given as the tutorials progress.  
<br/>
<br/>
I am a Math/Computer Science major at Texas Tech University, and most modern Computer Science classes (here anyway) don't ever cover 
<br/>
malloc(), realloc(), memmove(), memcpy()... in fact in the last CS class I took I actually got in trouble for using memcpy() in my code and was told that the For Loop method for copying memory was the only "Acceptable" method (besides using the STL Allocator Class) because most modern programmers would not understand my code.
<br/>
<br/>
3)  File System Support (or the lack thereof) is a huge stumbling block for me, from my non-hardware programming background, I do not understand how to attach binary data to an executable but I very often find myself needing (or atleast wanting to) include binary (or even occassionaly ASCII) data to my programs.  I do agree that using a "third party" library like GBFS may not be the best approach to teaching this, but attention needs to be given to this subject early on.  Perhaps even an Advanced Tutorial on how to write your own GBFS like library.
<br/>
<br/>
4) Lastly I want to see a detailed well commented Header file of ALL the registers that are needed for programming the GBA.  Although, I agree that a beginner should be introduced to them slowly and as needed, some of the tutorial writers seem to lump the needed ones togather every project and I find it tedious to re-write #define's all the time, besides from personal experience typing in memory addresses is extremely error prone, it's easy to make a typo in a memory address and until you become familiar with the addresses it isn't always easy to find where you made the typo.  I know that DevKitAdvance and HAM both have there own Register Defintions included but I would like to learn GBA programming from scratch, so I would like go through tutorials and eventually write my own complete Register Defination file.
<br/>
<br/>
I hope that you find some of my comments helpful.
<br/>
<br/>
Dean</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25268 - sajiimori - Thu Aug 19, 2004 6:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
...in the last CS class I took I actually got in trouble for using memcpy() in my code and was told that the For Loop method for copying memory was the only "Acceptable" method (besides using the STL Allocator Class) because most modern programmers would not understand my code.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Then that was not a very good class.  Part of knowing the language is knowing the standard library, and if a "professional" C programmer doesn't know C then they have no claim to that title.
<br/>
<br/>
Anyway, these particular tutorials have the prerequisite of knowing C, so it's appropriate to leave out explanations of standard library functions.  There are many C tutorials already out there.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
a "third party" library like GBFS
<br/>
</td> </tr></table><span class="postbody">
<br/>
Everything in the homebrew community is 3rd party.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Lastly I want to see a detailed well commented Header file of ALL the registers that are needed for programming the GBA.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Check the GBATek document -- it's pretty complete.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25273 - Deanonious - Thu Aug 19, 2004 10:12 pm</h4>
    <div class="postbody"><span class="postbody">Dude Sajiimori you don't have to be a jerk about it. 
<br/>
<br/>
I was just saying Universities do NOT teach "C" anymore, it's considered outdated and obsolete.  From day one when you walk into a CS Class at Texas Tech University you start learning C++, strings are the STL String class, C-Strings are just some stupid thing left over from C so if you need one call string::c_str() and all dynamic memory is either handled by new/delete and for loops or by the STL Allocator class.  It's been that way since before I started here in 2000.  I personally thinks it's stupid my self, I learned C over 10 years ago that's why I know the C-standard library, but that is the way things are going now.  Sorry.
<br/>
<br/>
As far as the GBATek goes, yes it is a wonderful reference; however, a beginner isn't going to want to weed through technical references to look for something, when they probably won't even know what they are looking for.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25277 - poslundc - Thu Aug 19, 2004 10:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Deanonious wrote:</b></span></td> </tr> <tr> <td class="quote">I was just saying Universities do NOT teach "C" anymore, it's considered outdated and obsolete.  From day one when you walk into a CS Class at Texas Tech University you start learning C++, strings are the STL String class, C-Strings are just some stupid thing left over from C so if you need one call string::c_str() and all dynamic memory is either handled by new/delete and for loops or by the STL Allocator class.</td> </tr></table><span class="postbody">
<br/>
<br/>
A couple of things to be aware of:
<br/>
<br/>
1. Universities still teach C. <span style="font-style: italic">Your</span> university doesn't teach C. You may believe that your university is better for this reason, but you would have an extremely difficult time making an irrefutable case for it. Already working against it:
<br/>
<br/>
2. Extensions like STL are a total speed/memory kill on a platform like the GBA. So those "outdated", "obsolete", "stupid things left over from C" are, ironically, of critical importance if you want to do anything on many embedded platforms.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25282 - sajiimori - Thu Aug 19, 2004 11:53 pm</h4>
    <div class="postbody"><span class="postbody">I didn't mean to offend you, but in my honest opinion it's a bad idea to teach students to be willfully ignorant about certain parts of the subject language.
<br/>
<br/>
Ask yourself why the standard C library is included in the C++ definition.  It's for backward compatability, right?  Well if C++ was designed with backward compatability in mind, shouldn't C++ programmers be backward compatable as well by knowing the standard C library?
<br/>
<br/>
This may seem like an abstract or overly intuitive argument, but cross-platform compatability is one of the main reasons C++ has become so popular, and firms that use the language take advantage of this feature regularly (e.g. by using 3rd party libraries written in C).
<br/>
<br/>
About GBATek, I thought you were looking for a reference.  Sorry if I misinterpreted.  At this point I'm not sure what you were asking for, because a big list of all the registers and their usage sounds like a reference to me, and I can't imagine how such a list could alleviate the chore of hunting down the information you need.  Tutorials have that goal, which is why I tended to rely on them until I was more comfortable with the hardware.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25284 - dagamer34 - Fri Aug 20, 2004 1:01 am</h4>
    <div class="postbody"><span class="postbody">Take a look at <a class="postlink" href="http://www.thepernproject.com/" target="_blank">The Pern Project</a>. It's currently being redone so check it every so often.
<br/>
<br/>
Universities don't teach you everything you need to know. Now you know that. So, simply move on.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25289 - Deanonious - Fri Aug 20, 2004 4:02 am</h4>
    <div class="postbody"><span class="postbody">I never said that I agreed with my Universities policy on not teaching C or what they claim is obsolete programming techniques.  In fact I have gotten in a LOT of trouble because I challanged and/or refused to buy into there crap.  I am like most of you I started with C over 10 years ago, and I totally disagree with my Universities teaching approaches to Computer Science.  I never said that I think my university is better than any other university, I was merely pointing out the fact that some "programmers" are coming from a different background than most of you and that they shouldn't be talked down too because they weren't taught techniques that they are assumed to know.  Yes I think it's a real shame that a lot of these techniques aren't taught at my university, I have gone too the Chairman of the Department on numerous occassions to voice my opionions on the subject, and have debated with numerous professors over there "policies" and/or teaching style.  Hell, I almost failed a C++ class because I used OOP techniques???
<br/>
<br/>
I was trying to point out a few things that I believe should be addressed in a beginner tutorial, I never said that you should go out and write the next "Teach yourself systems programming in C in 21 days" book, I was just making a few points on my experiences as a beginner GBA programmer and certain things about Memory/Resource Management were and in some cases still are a mystery to me.  At least include a link to Rafael Baptista's great article "Gameboy Advance Resource Management" on Gamasutra.com and maybe in the introduction link to a few really good C tutorials that are pertinent to the subject, and say something like "Hey if you aren't familiar with 'C Standard Library Memory Management' go brush up here... &lt;insert link&gt;"
<br/>
<br/>
The URL to the Baptista Article is: 
<br/>
<a class="postlink" href="http://www.gamasutra.com/features/20010509/baptista_01.htm" target="_blank">http://www.gamasutra.com/features/20010509/baptista_01.htm</a>
<br/>
<br/>
Unfortunately, I think that you have to log-in to Gamasutra.com to read it :(.  The Code is no longer available as Nintendo has decreed that it as usual violated there intellectual property rights and has confiscated it, those among us that are "licensced" still have the joy of obtaining it via Nintendo's developer site.  He wrote a more general "Memory Manager" tutorial on his website it can be found here.
<br/>
<br/>
<a class="postlink" href="http://www.oroboro.com/rafael/docserv.php?index=algorithms&amp;article=memmgr" target="_blank">http://www.oroboro.com/rafael/docserv.php?index=algorithms&amp;article=memmgr</a>
<br/>
<br/>
&lt;begin Totally Off-Topic Rant&gt;
<br/>
<br/>
It makes me really sad that Nintendo is such a jerk, I can understand some kind of Quality Assurance testing, like maybe Windows, if you want to put a Microsoft Windows Approved sicker on your game you have to pass there QA tests, but making developers pay thousands of dollars to write Software for your system is just crappy.  
<br/>
<br/>
If I were Nintendo I would want people to develop software for my system it seems to be that the more quality games that are out there the more people are going to want to buy your system and that means more profit.  With the PSP coming out soon with all it's raw power, Nintendo may very well die if they don't come to there senses, in my opionion Nintendo hasn't had a home console worth buying since the SNES, the Gameboy is there only saving grace.
<br/>
<br/>
Sorry, that just came to be because I was trying to dl the source to Mr. Baptista's article and I got really depressed when I couldn't.
<br/>
<br/>
&lt;end Totally Off-Topic Rant&gt;
<br/>
<br/>
I didn't want or mean to start another flame war in this thread, I merely wanted to aid the community by stating my take on the current state of GBA programming tutorials.  I'm sorry for causing such a stir, I just wanted to help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25291 - tepples - Fri Aug 20, 2004 5:09 am</h4>
    <div class="postbody"><span class="postbody">&lt;offtopic&gt;
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Deanonious wrote:</b></span></td> </tr> <tr> <td class="quote">If I were Nintendo I would want people to develop software for my system it seems to be that the more quality games that are out there the more people are going to want to buy your system and that means more profit.</td> </tr></table><span class="postbody">
<br/>
Think of Nintendo's position in 1985. The U.S. video game market had just crashed from a glut of poor-quality third-party software for Atari 2600 and a few other early 8-bit console platforms that didn't use signed binaries.
<br/>
<br/>
&lt;/offtopic&gt;
<br/>
<br/>
That said, I'm still working on my tutorial off and on, but given that The Pern Project's tutorial is being rewritten, I might trim down the scope of my project to cover only what New Pern doesn't.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25328 - expos1994 - Fri Aug 20, 2004 6:06 pm</h4>
    <div class="postbody"><span class="postbody">Nintendo was smart to limit the 3rd party developers in 1985, but that business model doesn't work quite as well today.
<br/>
Sony proved that when Playstation became the #1 console back in the mid-late nineties.  They charged developers something like $5 for a license.  Nintendo has been playing catch-up ever since.
<br/>
<br/>
It make me wonder about how well the PSP is going to do up against the DS.  If I had to put money on it, I'd put it on the PSP.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
