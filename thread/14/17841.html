<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>My first game works only in the emulator but not in the gba - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > My first game works only in the emulator but not in the gba</h2>
<div id="posts">
<div class="post">
    <h4>#177312 - tuket - Fri Apr 06, 2012 12:30 am</h4>
    <div class="postbody"><span class="postbody">I have created a very simple game for gba and it work in the amulator but not in the cartridge. I have an EZ flash IV. It is just a red pixel that moves on the screen. When I start the game in the gameboy it apears the leters of GAMEBOY but where it should be written NINTENDO there are some random pixels like when it has dust inside. Here is the code
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define RGB16(r,g,b)  ((r)+(g&lt;&lt;5)+(b&lt;&lt;10))
<br/>
#include "keypad.h"
<br/>
   unsigned short* Screen = (unsigned short*)0x6000000;  
<br/>
   void showpo(char* x,char* y);
<br/>
   void dele(char* x, char* y);
<br/>
int main()
<br/>
{   
<br/>
   *(unsigned long*)0x4000000 = 0x403; // mode3, bg2 on
<br/>
   struct p{
<br/>
      char x;
<br/>
      char y;
<br/>
   };
<br/>
   struct p p={0,0};
<br/>
   showpo(&amp;p.x,&amp;p.y);
<br/>
   char x,y;  
<br/>
<br/>
   // clear screen, and draw a blue back ground
<br/>
   for(x = 0; x&lt;240;x++)   //loop through all x
<br/>
   {
<br/>
      for(y = 0; y&lt;160; y++)  //loop through all y
<br/>
      {
<br/>
         Screen[x+y*240] = RGB16(0,0,0);  
<br/>
      }
<br/>
   }
<br/>
<br/>
   while(1){
<br/>
      if(!((*KEYS) &amp; KEY_UP)){dele(&amp;p.x,&amp;p.y);--p.y;showpo(&amp;p.x,&amp;p.y);}
<br/>
      if(!((*KEYS) &amp; KEY_DOWN)){dele(&amp;p.x,&amp;p.y);++p.y;showpo(&amp;p.x,&amp;p.y);}
<br/>
      if(!((*KEYS) &amp; KEY_RIGHT)){dele(&amp;p.x,&amp;p.y);++p.x;showpo(&amp;p.x,&amp;p.y);}
<br/>
      if(!((*KEYS) &amp; KEY_LEFT)){dele(&amp;p.x,&amp;p.y);--p.x;showpo(&amp;p.x,&amp;p.y);}
<br/>
      char i;
<br/>
      for(i=0;i&lt;100;i++){
<br/>
         char j;
<br/>
         for(j=0;j&lt;100;j++);
<br/>
         }
<br/>
      }   //loop forever
<br/>
}
<br/>
<br/>
void showpo(char* x,char* y){
<br/>
   Screen[(*x)+(*y)*240]=RGB16(31,0,0);
<br/>
}
<br/>
void dele(char* x, char* y){
<br/>
   Screen[(*x)+(*y)*240]=RGB16(0,0,0);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I hope you can help me. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177313 - dantheman - Fri Apr 06, 2012 3:37 am</h4>
    <div class="postbody"><span class="postbody">Ah, a very simple fix.  Just run the output GBA file through a program that fixes the header (which is the cause for the garbled Nintendo logo).  GBATA can do it, and I think the command-line "gbafix" program is included with DevKitARM which would also do the job.
<br/>
<br/>
EDIT:  also, quick note, in that RGB macro at the top, be sure to put "g" and "b" in parenthesis just like the "r" currently is.  This will make it safe when you try to send in something more than just an integer value as an argument to the macro.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177317 - tuket - Fri Apr 06, 2012 2:25 pm</h4>
    <div class="postbody"><span class="postbody">Thank you very much that utility worked fine. I had devKitAdv so I had to download devKitARM. Now I wonder why this happens. I think divkitAdv should be not depending on that tool "gbafix" it should have its own tool to fix the gba games. As I said thank you very much, the answer was accurate :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177318 - gauauu - Fri Apr 06, 2012 3:09 pm</h4>
    <div class="postbody"><span class="postbody">Here's a good explanation of what was going on, from <a class="postlink" href="http://gameboy.mongenel.com/dmg/asmmemmap.html" target="_blank">http://gameboy.mongenel.com/dmg/asmmemmap.html</a>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">This area in the GameBoy address space contains information about the cartridge that is inserted, including; type of cartridge, size of rom, size of ram, a Nintendo logo, and other information. Also, at $0100, there is a NOP instruction, followed by a JUMP to the start of the program, usually $0150. The GameBoy's CPU begins execution at $0100, that is why this is included. If the Nintendo logo bytes are not correct, the GameBoy will not execute the game. Upon power up, the system ROM in a GameBoy will verify that the logo is correct. Nintendo has tried to use the logo to keep only authorized developers from publishing games, since the logo is a registered trademark of Nintendo. But, a legal precedent was set in the United States in a case of Sega vs. Accolade (c.1993). Sega's Genesis console also has a signature that is a copyright of Sega, and Accolade used this logo so that their games, which were not approved by Sega, would be able to play on the Genesis console. The judge ruled in favor of Accolade, stating that using a logo to that degree was an anti-competetive practice, and therefore, Accolade was allowed to continue selling their games. At least, that's what I heard. =P</td> </tr></table><span class="postbody">
<br/>
<br/>
As to why devkitAdv doesn't deal with it? I don't really know why a tool to fix the header wasn't bundled with devkitAdv. But you are better off using devkitARM anyway. It's more up-to-date and maintained, has better tools, and better support from this community.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177319 - tuket - Fri Apr 06, 2012 3:38 pm</h4>
    <div class="postbody"><span class="postbody">Now it makes total sense.
<br/>
I am going to use devKitARM from now. Thanks :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
