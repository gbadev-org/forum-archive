<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Large Arrays in Old Versions of DevKitAdv - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Large Arrays in Old Versions of DevKitAdv</h2>
<div id="posts">
<div class="post">
    <h4>#111704 - biolizard89 - Sat Dec 09, 2006 5:45 am</h4>
    <div class="postbody"><span class="postbody">I see this in the FAQ:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Q: How do I put large (&gt; 16 KB) arrays into a program without it crashing?
<br/>
<br/>
The linker script included with devkitARM puts arrays and other variables into IWRAM unless you tell it otherwise. Trouble is IWRAM is only 32 KiB. For arrays that you don't plan to modify, use the keyword const, which will instruct the linker to put the entire array into ROM (or EWRAM for .mb programs). For arrays that you do plan to modify, put them into EWRAM using a section attribute on the array's definition:
<br/>
<br/>
    * __attribute__((section (".sbss"))) char foo[8192];
<br/>
      Puts the variable in EWRAM and initializes it to zero at program start. (Initializer values are ignored.)
<br/>
    * __attribute__((section (".ewram"))) char foo[8192] = {3, 4, /*... */ };
<br/>
      Puts the variable in EWRAM and initializes it to the given values at program start. (This uses space in the binary even if initializer values are not given.) </td> </tr></table><span class="postbody">
<br/>
I've been working with a program which does use the const keyword on some arrays (6 Direct Sound recordings which total 230KiB compiled), but it crashes when the arrays are compiled in.  When the arrays are replaced with a single 4-byte array, the program works perfectly.  Thing is, I'm using an old version of DevKitAdv (older than Aug 2004).  Do old versions of DevKitAdv not recognize the const keyword the same way as current versions of DevKitARM?
<br/>
<br/>
Thanks in advance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#111714 - tepples - Sat Dec 09, 2006 10:04 am</h4>
    <div class="postbody"><span class="postbody">The first GBA port of TOD (developed in 2002) was done on DevKit Advance, and it seemed to do the right thing with the <span style="font-weight: bold">const</span> qualifier back then.
<br/>
<br/>
When you run <span style="font-weight: bold">arm-agb-elf-nm -n mygame.elf</span> (in modern devkit replace arm-agb-elf- with arm-eabi-), what addresses does it give for the sound? And is it really a size issue or just an alignment issue? And are you using C or assembly language to "compile in" the arrays?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#111727 - gmiller - Sat Dec 09, 2006 3:11 pm</h4>
    <div class="postbody"><span class="postbody">I generally produce a map file to see where everything is loaded. It can be informative.  I was surprised to see the use of the different memory regions.  
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Archive member included because of file (symbol)
<br/>
<br/>
c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
                              c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o (_call_via_r3)
<br/>
c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
                              c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o (__libc_init_array)
<br/>
c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
                              main.o (rand)
<br/>
c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
                              c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o) (_impure_ptr)
<br/>
c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
                              c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o (fake_heap_end)
<br/>
<br/>
Memory Configuration
<br/>
<br/>
Name             Origin             Length             Attributes
<br/>
rom              0x08000000         0x02000000
<br/>
iwram            0x03000000         0x00008000
<br/>
ewram            0x02000000         0x00040000
<br/>
*default*        0x00000000         0xffffffff
<br/>
<br/>
Linker script and memory map
<br/>
<br/>
                0x08000000                __text_start = 0x8000000
<br/>
                0x02040000                __eheap_end = 0x2040000
<br/>
                0x03000000                __iwram_start = 0x3000000
<br/>
                0x03008000                __iwram_top = 0x3008000
<br/>
                0x03007f00                __sp_irq = (__iwram_top - 0x100)
<br/>
                0x03007e00                __sp_usr = (__sp_irq - 0x100)
<br/>
                0x03007ff8                __irq_flags = 0x3007ff8
<br/>
                0x08000000                . = __text_start
<br/>
<br/>
.init           0x08000000      0x224
<br/>
 *(.init)
<br/>
 .init          0x08000000      0x20c c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
                0x080000c4                __boot_method
<br/>
                0x080000c5                __slave_number
<br/>
                0x08000000                _start
<br/>
                0x080000e0                start_vector
<br/>
 .init          0x0800020c        0xc c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
                0x0800020c                _init
<br/>
 .init          0x08000218        0xc c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
                0x08000224                . = ALIGN (0x4)
<br/>
<br/>
.plt            0x08000224        0x0
<br/>
 *(.plt)
<br/>
                0x08000224                . = ALIGN (0x4)
<br/>
<br/>
.text           0x08000228      0x9d0
<br/>
 *(EXCLUDE_FILE(*.iwram*) .text)
<br/>
 .text          0x08000228        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
 .text          0x08000228        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .text          0x08000228       0xa4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .text          0x080002cc        0x8 bg.raw.o
<br/>
                0x080002cc                bg_Bitmap_Size
<br/>
 .text          0x080002d4      0x794 main.o
<br/>
                0x0800033c                MoveSprite
<br/>
                0x080003cc                InitSprite
<br/>
                0x0800045c                WaitVBlank
<br/>
                0x08000310                HideSprites
<br/>
                0x08000394                UpdateSpriteMemory
<br/>
                0x08000480                main
<br/>
                0x080002d4                Memory_DMAFastCopy
<br/>
 .text          0x08000a68       0x3c c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
                0x08000a70                _call_via_r2
<br/>
                0x08000a80                _call_via_r6
<br/>
                0x08000a7c                _call_via_r5
<br/>
                0x08000a74                _call_via_r3
<br/>
                0x08000a94                _call_via_fp
<br/>
                0x08000a88                _call_via_r8
<br/>
                0x08000a84                _call_via_r7
<br/>
                0x08000a68                _call_via_r0
<br/>
                0x08000a90                _call_via_sl
<br/>
                0x08000a9c                _call_via_sp
<br/>
                0x08000a8c                _call_via_r9
<br/>
                0x08000a78                _call_via_r4
<br/>
                0x08000a6c                _call_via_r1
<br/>
                0x08000a98                _call_via_ip
<br/>
                0x08000aa0                _call_via_lr
<br/>
 .text          0x08000aa4       0xd4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
                0x08000af0                __libc_init_array
<br/>
                0x08000aa4                __libc_fini_array
<br/>
 .text          0x08000b78       0x80 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
                0x08000b94                rand
<br/>
                0x08000b78                srand
<br/>
 .text          0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 .text          0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
 .text          0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
 .text          0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
 *(.text.*)
<br/>
 *(.stub)
<br/>
 *(.gnu.warning)
<br/>
 *(.gnu.linkonce.t*)
<br/>
 *(.glue_7)
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .glue_7        0x08000bf8        0x0 bg.raw.o
<br/>
 .glue_7        0x08000bf8        0x0 main.o
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
 .glue_7        0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
 *(.glue_7t)
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .glue_7t       0x08000bf8        0x0 bg.raw.o
<br/>
 .glue_7t       0x08000bf8        0x0 main.o
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
 .glue_7t       0x08000bf8        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
                0x08000bf8                . = ALIGN (0x4)
<br/>
                0x08000bf8                __text_end = .
<br/>
<br/>
.fini           0x08000bf8       0x18
<br/>
 *(.fini)
<br/>
 .fini          0x08000bf8        0xc c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
                0x08000bf8                _fini
<br/>
 .fini          0x08000c04        0xc c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
                0x08000c10                . = ALIGN (0x4)
<br/>
<br/>
.rodata         0x08000c10    0x13208
<br/>
 *(.rodata)
<br/>
 .rodata        0x08000c10    0x12c00 bg.raw.o
<br/>
                0x08000c10                bg_Bitmap
<br/>
 .rodata        0x08013810      0x600 main.o
<br/>
                0x08013c10                ballPalette
<br/>
                0x08013810                ballData
<br/>
 .rodata        0x08013e10        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
                0x08013e10                _global_impure_ptr
<br/>
 *all.rodata*(*)
<br/>
 *(.roda)
<br/>
 *(.rodata.*)
<br/>
 .rodata.str1.4
<br/>
                0x08013e14        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 *(.gnu.linkonce.r*)
<br/>
                0x08013e18                . = ALIGN (0x4)
<br/>
<br/>
.ARM.extab
<br/>
 *(.ARM.extab* .gnu.linkonce.armextab.*)
<br/>
                0x08013e18                __exidx_start = .
<br/>
<br/>
.ARM.exidx
<br/>
 *(.ARM.exidx* .gnu.linkonce.armexidx.*)
<br/>
                0x08013e18                __exidx_end = .
<br/>
<br/>
.ctors          0x08013e18        0x0
<br/>
 *crtbegin.o(.ctors)
<br/>
 *(EXCLUDE_FILE(*crtend.o) .ctors)
<br/>
 *(SORT(.ctors.*))
<br/>
 *(.ctors)
<br/>
                0x08013e18                . = ALIGN (0x4)
<br/>
<br/>
.dtors          0x08013e18        0x0
<br/>
 *crtbegin.o(.dtors)
<br/>
 *(EXCLUDE_FILE(*crtend.o) .dtors)
<br/>
 *(SORT(.dtors.*))
<br/>
 *(.dtors)
<br/>
                0x08013e18                . = ALIGN (0x4)
<br/>
<br/>
.eh_frame       0x08013e18        0x4
<br/>
 *(.eh_frame)
<br/>
 .eh_frame      0x08013e18        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .eh_frame      0x08013e18        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
                0x08013e1c                . = ALIGN (0x4)
<br/>
<br/>
.gcc_except_table
<br/>
                0x08013e1c        0x0
<br/>
 *(.gcc_except_table)
<br/>
                0x08013e1c                . = ALIGN (0x4)
<br/>
                0x08013e1c                __iwram_lma = .
<br/>
<br/>
.iwram          0x03000000        0x0 load address 0x08013e1c
<br/>
                0x03000000                __iwram_start = &lt;code 342&gt; (.)
<br/>
 *(.iwram)
<br/>
 *iwram.*(.text)
<br/>
                0x03000000                . = ALIGN (0x4)
<br/>
                0x03000000                __iwram_end = &lt;code 342&gt; (.)
<br/>
                0x08013e1c                __data_lma = (__iwram_lma + SIZEOF (.iwram))
<br/>
<br/>
.bss            0x03000000     0x1024
<br/>
                0x03000000                __bss_start = &lt;code 342&gt; (.)
<br/>
                0x03000000                __bss_start__ = &lt;code 342&gt; (.)
<br/>
 *(.dynbss)
<br/>
 *(.gnu.linkonce.b*)
<br/>
 *(.bss*)
<br/>
 .bss           0x03000000        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
 .bss           0x03000000        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .bss           0x03000000       0x1c c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .bss           0x0300001c        0x0 bg.raw.o
<br/>
 .bss           0x0300001c     0x1000 main.o
<br/>
 .bss           0x0300101c        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
 .bss           0x0300101c        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
 .bss           0x0300101c        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
 .bss           0x0300101c        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 .bss           0x0300101c        0x8 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
                0x03001020                fake_heap_start
<br/>
                0x0300101c                fake_heap_end
<br/>
 .bss           0x03001024        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
 .bss           0x03001024        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
 *(COMMON)
<br/>
                0x03001024                . = ALIGN (0x4)
<br/>
                0x03001024                __bss_end = &lt;code 342&gt; (.)
<br/>
                0x03001024                __bss_end__ = __bss_end
<br/>
<br/>
.data           0x03001024      0x41c load address 0x08013e1c
<br/>
                0x03001024                __data_start = &lt;code 342&gt; (.)
<br/>
 *(.data)
<br/>
 .data          0x03001024        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
 .data          0x03001024        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .data          0x03001024        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
                0x03001024                __dso_handle
<br/>
 .data          0x03001028        0x0 bg.raw.o
<br/>
 .data          0x03001028        0x0 main.o
<br/>
 .data          0x03001028        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
 .data          0x03001028        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
 .data          0x03001028        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
 .data          0x03001028      0x418 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
                0x03001028                _impure_ptr
<br/>
 .data          0x03001440        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
 .data          0x03001440        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
 .data          0x03001440        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
 *(.data.*)
<br/>
 *(.gnu.linkonce.d*)
<br/>
                0x03001440                . = ALIGN (0x4)
<br/>
                0x08014238                __preinit_lma = (__data_lma + SIZEOF (.data))
<br/>
                0x03001440                PROVIDE (__preinit_array_start, .)
<br/>
<br/>
.preinit_array  0x03001440        0x0 load address 0x08014238
<br/>
 *(.preinit_array)
<br/>
                0x03001440                PROVIDE (__preinit_array_end, .)
<br/>
                0x08014238                __init_lma = (__preinit_lma + SIZEOF (.preinit_array))
<br/>
                0x03001440                PROVIDE (__init_array_start, .)
<br/>
<br/>
.init_array     0x03001440        0x4 load address 0x08014238
<br/>
 *(.init_array)
<br/>
 .init_array    0x03001440        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
                0x03001444                PROVIDE (__init_array_end, .)
<br/>
                0x03001444                PROVIDE (__fini_array_start, .)
<br/>
                0x0801423c                __fini_lma = (__init_lma + SIZEOF (.init_array))
<br/>
<br/>
.fini_array     0x03001444        0x4 load address 0x0801423c
<br/>
 *(.fini_array)
<br/>
 .fini_array    0x03001444        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
                0x03001448                PROVIDE (__fini_array_end, .)
<br/>
                0x08014240                __jcr_lma = (__fini_lma + SIZEOF (.fini_array))
<br/>
<br/>
.jcr            0x03001448        0x4 load address 0x08014240
<br/>
 *(.jcr)
<br/>
 .jcr           0x03001448        0x0 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .jcr           0x03001448        0x4 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
                0x0300144c                __data_end = &lt;code 342&gt; (.)
<br/>
                0x08014244                __iwram_overlay_lma = (__jcr_lma + SIZEOF (.jcr))
<br/>
                0x0300144c                __iwram_overlay_start = .
<br/>
<br/>
.iwram0         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram0)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram0 = LOADADDR (.iwram0)
<br/>
                0x08014244                __load_stop_iwram0 = (LOADADDR (.iwram0) + SIZEOF (.iwram0))
<br/>
<br/>
.iwram1         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram1)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram1 = LOADADDR (.iwram1)
<br/>
                0x08014244                __load_stop_iwram1 = (LOADADDR (.iwram1) + SIZEOF (.iwram1))
<br/>
<br/>
.iwram2         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram2)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram2 = LOADADDR (.iwram2)
<br/>
                0x08014244                __load_stop_iwram2 = (LOADADDR (.iwram2) + SIZEOF (.iwram2))
<br/>
<br/>
.iwram3         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram3)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram3 = LOADADDR (.iwram3)
<br/>
                0x08014244                __load_stop_iwram3 = (LOADADDR (.iwram3) + SIZEOF (.iwram3))
<br/>
<br/>
.iwram4         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram4)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram4 = LOADADDR (.iwram4)
<br/>
                0x08014244                __load_stop_iwram4 = (LOADADDR (.iwram4) + SIZEOF (.iwram4))
<br/>
<br/>
.iwram5         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram5)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram5 = LOADADDR (.iwram5)
<br/>
                0x08014244                __load_stop_iwram5 = (LOADADDR (.iwram5) + SIZEOF (.iwram5))
<br/>
<br/>
.iwram6         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram6)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram6 = LOADADDR (.iwram6)
<br/>
                0x08014244                __load_stop_iwram6 = (LOADADDR (.iwram6) + SIZEOF (.iwram6))
<br/>
<br/>
.iwram7         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram7)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram7 = LOADADDR (.iwram7)
<br/>
                0x08014244                __load_stop_iwram7 = (LOADADDR (.iwram7) + SIZEOF (.iwram7))
<br/>
<br/>
.iwram8         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram8)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram8 = LOADADDR (.iwram8)
<br/>
                0x08014244                __load_stop_iwram8 = (LOADADDR (.iwram8) + SIZEOF (.iwram8))
<br/>
<br/>
.iwram9         0x0300144c        0x0 load address 0x08014244
<br/>
 *(.iwram9)
<br/>
                0x0300144c                . = ALIGN (0x4)
<br/>
                0x08014244                __load_start_iwram9 = LOADADDR (.iwram9)
<br/>
                0x08014244                __load_stop_iwram9 = (LOADADDR (.iwram9) + SIZEOF (.iwram9))
<br/>
                0x08014244                __ewram_lma = __load_stop_iwram9
<br/>
                0x0300144c                __iwram_overlay_end = .
<br/>
                0x0300144c                __iheap_start = .
<br/>
                0x02000000                __ewram_start = 0x2000000
<br/>
<br/>
.ewram          0x02000000        0x0 load address 0x08014244
<br/>
 *(.ewram)
<br/>
                0x02000000                . = ALIGN (0x4)
<br/>
                0x08014244                __pad_lma = (__ewram_lma + SIZEOF (.ewram))
<br/>
<br/>
.sbss           0x02000000        0x0
<br/>
                0x02000000                __sbss_start = &lt;code 342&gt; (.)
<br/>
 *(.sbss)
<br/>
                0x02000000                . = ALIGN (0x4)
<br/>
                0x02000000                __sbss_end = &lt;code 342&gt; (.)
<br/>
                0x02000000                __ewram_end = __sbss_end
<br/>
                0x02000000                __eheap_start = __sbss_end
<br/>
                0x02000000                __end__ = __sbss_end
<br/>
                0x02000000                end = __sbss_end
<br/>
<br/>
.pad            0x02000000        0x8 load address 0x08014244
<br/>
                0x02000000        0x4 LONG 0x52416b64
<br/>
                0x02000004        0x4 LONG 0x4d
<br/>
                0x02000008                . = ALIGN (0x4)
<br/>
<br/>
.stab
<br/>
 *(.stab)
<br/>
<br/>
.stabstr
<br/>
 *(.stabstr)
<br/>
<br/>
.stab.excl
<br/>
 *(.stab.excl)
<br/>
<br/>
.stab.exclstr
<br/>
 *(.stab.exclstr)
<br/>
<br/>
.stab.index
<br/>
 *(.stab.index)
<br/>
<br/>
.stab.indexstr
<br/>
 *(.stab.indexstr)
<br/>
<br/>
.comment        0x00000000      0x150
<br/>
 *(.comment)
<br/>
 .comment       0x00000000       0x2a c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .comment       0x0000002a       0x2a bg.raw.o
<br/>
 .comment       0x00000054       0x2a main.o
<br/>
 .comment       0x0000007e       0x2a c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
 .comment       0x000000a8       0x2a c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
 .comment       0x000000d2       0x2a c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 .comment       0x000000fc       0x2a c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
 .comment       0x00000126       0x2a c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
<br/>
.debug
<br/>
 *(.debug)
<br/>
<br/>
.line
<br/>
 *(.line)
<br/>
<br/>
.debug_srcinfo
<br/>
 *(.debug_srcinfo)
<br/>
<br/>
.debug_sfnames
<br/>
 *(.debug_sfnames)
<br/>
<br/>
.debug_aranges  0x00000000       0x50
<br/>
 *(.debug_aranges)
<br/>
 .debug_aranges
<br/>
                0x00000000       0x28 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .debug_aranges
<br/>
                0x00000028       0x28 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
<br/>
.debug_pubnames
<br/>
 *(.debug_pubnames)
<br/>
<br/>
.debug_info     0x00000000       0xb6
<br/>
 *(.debug_info)
<br/>
 .debug_info    0x00000000       0x5b c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .debug_info    0x0000005b       0x5b c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
<br/>
.debug_abbrev   0x00000000       0x20
<br/>
 *(.debug_abbrev)
<br/>
 .debug_abbrev  0x00000000       0x10 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .debug_abbrev  0x00000010       0x10 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
<br/>
.debug_line     0x00000000       0x92
<br/>
 *(.debug_line)
<br/>
 .debug_line    0x00000000       0x49 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .debug_line    0x00000049       0x49 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
<br/>
.debug_frame
<br/>
 *(.debug_frame)
<br/>
<br/>
.debug_str
<br/>
 *(.debug_str)
<br/>
<br/>
.debug_loc
<br/>
 *(.debug_loc)
<br/>
<br/>
.debug_macinfo
<br/>
 *(.debug_macinfo)
<br/>
<br/>
.debug_weaknames
<br/>
 *(.debug_weaknames)
<br/>
<br/>
.debug_funcnames
<br/>
 *(.debug_funcnames)
<br/>
<br/>
.debug_typenames
<br/>
 *(.debug_typenames)
<br/>
<br/>
.debug_varnames
<br/>
 *(.debug_varnames)
<br/>
<br/>
.stack          0x00080000        0x0
<br/>
                0x00080000                _stack = .
<br/>
 *(.stack)
<br/>
<br/>
.note.gnu.arm.ident
<br/>
 *(.note.gnu.arm.ident)
<br/>
<br/>
.ARM.attributes
<br/>
                0x00000000       0x10
<br/>
 *(.ARM.attributes)
<br/>
 .ARM.attributes
<br/>
                0x00000000       0x20 c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
 .ARM.attributes
<br/>
                0x00000020       0x1e c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
 .ARM.attributes
<br/>
                0x0000003e       0x1e c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
 .ARM.attributes
<br/>
                0x0000005c       0x1e bg.raw.o
<br/>
 .ARM.attributes
<br/>
                0x0000007a       0x1e main.o
<br/>
 .ARM.attributes
<br/>
                0x00000098       0x1e c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a(_call_via_rX.o)
<br/>
 .ARM.attributes
<br/>
                0x000000b6       0x1e c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(init.o)
<br/>
 .ARM.attributes
<br/>
                0x000000d4       0x1e c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(rand.o)
<br/>
 .ARM.attributes
<br/>
                0x000000f2       0x1c c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a(impure.o)
<br/>
 .ARM.attributes
<br/>
                0x0000010e       0x1c c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a(malloc_vars.o)
<br/>
 .ARM.attributes
<br/>
                0x0000012a       0x1c c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
 .ARM.attributes
<br/>
                0x00000146       0x1e c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
<br/>
/DISCARD/
<br/>
 *(.note.GNU-stack)
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib/gba_crt0.o
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crti.o
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtbegin.o
<br/>
LOAD bg.raw.o
<br/>
LOAD main.o
<br/>
LOAD c:/devkitPro/libgba/lib\libgba.a
<br/>
START GROUP
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1\libgcc.a
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a
<br/>
END GROUP
<br/>
START GROUP
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libsysbase.a
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/lib\libc.a
<br/>
END GROUP
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtend.o
<br/>
LOAD c:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/crtn.o
<br/>
OUTPUT(c:/cygwin/home/gmiller/ham/Sources/Chapter07/BounceSprite/BounceSprite.elf elf32-littlearm)
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#111741 - biolizard89 - Sat Dec 09, 2006 7:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">The first GBA port of TOD (developed in 2002) was done on DevKit Advance, and it seemed to do the right thing with the <span style="font-weight: bold">const</span> qualifier back then.
<br/>
<br/>
When you run <span style="font-weight: bold">arm-agb-elf-nm -n mygame.elf</span> (in modern devkit replace arm-agb-elf- with arm-eabi-), what addresses does it give for the sound? And is it really a size issue or just an alignment issue? And are you using C or assembly language to "compile in" the arrays?</td> </tr></table><span class="postbody">
<br/>
The arrays are in C, and I doubt that it's an alignment issue, because the files containing the arrays were taken verbatim from another program which works.  Haven't tried the arm-agb-elf-nm thing, because I just realized that the program does work fine with the 230KiB arrays compiled in, as long as a bunch of the other conditionally compiled program features are disabled, which reduces the file size of the program significantly.  So I now think that it's the total file size of the program (592KiB with the sounds [doesn't work], 362KiB without the sounds [works], 386KiB with the sounds but with the three aforementioned features disabled [works]) that is causing problems.  I'm using a Charmed Labs Xport Botball Controller (robotics controller which uses a GBA for processing purposes), along with official Charmed Labs libraries, so I guess my next step is to ask the guys at Charmed Labs whether a large program size is known to screw things up.  Thanks for the help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#111756 - tepples - Sat Dec 09, 2006 9:48 pm</h4>
    <div class="postbody"><span class="postbody">I'd still like to see relevant lines from nm so as to know whether you are 1. misaligning something, 2. overrunning IWRAM, or 3. overrunning EWRAM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#112122 - biolizard89 - Wed Dec 13, 2006 1:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">I'd still like to see relevant lines from nm so as to know whether you are 1. misaligning something, 2. overrunning IWRAM, or 3. overrunning EWRAM.</td> </tr></table><span class="postbody">
<br/>
Sorry for the delay, the results of nm are uploaded at <a href="http://staff.littlemoonproductions.com/biolizard89/interactive_c/arm-agb-elf-nm_firmware_toobig.txt" target="_blank">http://staff.littlemoonproductions.com/biolizard89/interactive_c/arm-agb-elf-nm_firmware_toobig.txt</a>
<br/>
<br/>
The sound files are named ahh, blue, hokey, muchacha, ouch, and prado.
<br/>
<br/>
Any ideas?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115556 - biolizard89 - Wed Jan 17, 2007 3:35 am</h4>
    <div class="postbody"><span class="postbody">Sorry to bump, but does the fact that no one has replied here indicate that the nm output I posted doesn't help?
<br/>
<br/>
Anyone have any clue what could be wrong?  Any more questions about what I'm doing, feel free to ask.
<br/>
<br/>
Thanks, and sorry for the bump.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115557 - tepples - Wed Jan 17, 2007 3:46 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">08020000 T _start</td> </tr></table><span class="postbody">
<br/>
What the heck? I've always seen this set to 08000000, the start of cart space. Are you trying to use a custom link script to build a multi-game compilation with a 128 KiB start point for this ROM?
<br/>
<br/>
All six symbols that you named seem to be aligned correctly. Are you running out of stack?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115600 - biolizard89 - Wed Jan 17, 2007 7:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">08020000 T _start</td> </tr></table><span class="postbody">
<br/>
What the heck? I've always seen this set to 08000000, the start of cart space. Are you trying to use a custom link script to build a multi-game compilation with a 128 KiB start point for this ROM?
<br/>
<br/>
All six symbols that you named seem to be aligned correctly. Are you running out of stack?</span></td> </tr></table><span class="postbody">
<br/>
Now that you mention it, I remember that the program is loaded onto the XBC through a bootloader.  The bootloader starts at 08000000, and starts my program at 08020000.  That would explain the weird start address.
<br/>
<br/>
I have noticed another weird characteristic of my problem.  Regardless of the file size of my program, it boots fine at first.  My program receives a compiled P-code program over the XBC's RS232 port and stores it in the XBC's flash.  When my program's file size is too big, it seems to be overwriting the P-code program stored in flash when I send my program to the XBC through the bootloader (because it reports that there is no program there, when I know for a fact that there was).  It then works fine until I reload the P-code program onto it, after which my program refuses to boot (crashing at a different stage of booting depending on things that I'm not completely sure of - seems to include the file size of my program as well as the P-code program that was sent to it).
<br/>
<br/>
This makes me suspect that the problem is that the location in flash of the P-code program is hardcoded, and when the P-code program is loaded, it is corrupting the data in my program.  I might be able to fix this by changing the location of the stored P-code program in flash.  Problem is, most of this program wasn't written by me (it was written mostly by the Charmed Labs / KISS Institute for Practical Robotics people), so I'm not 100% sure what will happen if I try to reconfigure those locations.  Looks like I'll have to contact Charmed Labs or KIPR again.
<br/>
<br/>
(Do my conclusions as to what the problem might be sound somewhat logical?  I don't want to try to figure this out if it's probably not the main problem anyway.)
<br/>
<br/>
Thanks for the help.
<br/>
<br/>
EDIT: I looked through the code from Charmed Labs / KIPR and noticed a #define called IC_FLASH_ADDR.  It was set to 0x08080000.  This would correspond to the size limit I was encountering (0x08080000 - 0x08020000 = 0x60000, which would be 384KiB).  I just tried setting that #define to 0x08150000, which would yield a limit of 1216KiB, and, amazingly, it worked without any other modifications!  Now I can load huge binaries onto my XBC, with the serial transfer of P-code programs working fine.  Problem (apparently) solved!  Thanks again for the helpful comments.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
