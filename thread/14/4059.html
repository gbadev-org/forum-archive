<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to work out screen and charBaseBlock for backgrounds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > How to work out screen and charBaseBlock for backgrounds</h2>
<div id="posts">
<div class="post">
    <h4>#26287 - mr_square - Sat Sep 11, 2004 4:08 pm</h4>
    <div class="postbody"><span class="postbody">Hi all - I have a single 256*256 text background which works fine. When I try to add a second background, it goes all wrong - looking in the map viewer in VBA shows that the second background is present and correct, but the first is just a load of garbage made up of the 2nd one's tiles. I assume from this that I'm putting the new tiles in the wrong position in memory, and so they're overwriting the first background's tiles.
<br/>
<br/>
My code currently, using GBAJunkie's background definitions:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
background1.number = 1;
<br/>
background1.charBaseBlock = 0;
<br/>
background1.screenBaseBlock = 28;
<br/>
background1.colorMode = BG_COLOR_256;
<br/>
background1.size = TEXTBG_SIZE_256x256;
<br/>
background1.mosaic = 0;
<br/>
background1.x_scroll = 0;
<br/>
background1.y_scroll = 43;
<br/>
<br/>
background2.number = 2;
<br/>
background2.charBaseBlock = 16;
<br/>
background2.screenBaseBlock = 30;
<br/>
background2.colorMode = BG_COLOR_256;
<br/>
background2.size = TEXTBG_SIZE_256x256;
<br/>
background2.mosaic = 0;
<br/>
background2.x_scroll = 0;
<br/>
background2.y_scroll = 43;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm fairly sure its either the 
<br/>
background2.charBaseBlock or background2.screenBaseBlock lines thats messing it up, as I just took them from an example that happened to be using the same size text backgrounds. What should they be, and how would I calculate them?
<br/>
<br/>
thanks
<br/>
<br/>
<br/>
*edit* - tried setting charBaseBlock to 17 and it seems to have worked, but I'd still quite like to know why!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26288 - Lord Graga - Sat Sep 11, 2004 4:21 pm</h4>
    <div class="postbody"><span class="postbody">Char block 0 address = 0x6000000
<br/>
Tile map block 0 = 0x6000000
<br/>
<br/>
You are overlapping somewhere.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26289 - tepples - Sat Sep 11, 2004 4:32 pm</h4>
    <div class="postbody"><span class="postbody">Char block base address can be 0, 1, 2, or 3, for pattern tables starting at 0x06000000, 0x06004000, 0x06008000, or 0x0600c000.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26292 - mr_square - Sat Sep 11, 2004 5:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Char block base address can be 0, 1, 2, or 3, for pattern tables starting at 0x06000000, 0x06004000, 0x06008000, or 0x0600c000.</td> </tr></table><span class="postbody">
<br/>
<br/>
thanks 
<br/>
<br/>
Looking in VBA, I now have background 0 at CharBase 0x06000000, and background 1 at CharBase 0x06004000, which seems to be right
<br/>
<br/>
However, the graphics are still dodgy on background 1 - the tiles all come from the right tile data, but they're slightly out of place. Background 0's MapBase is set at 28 (which is 0x0600E000) and Background 1's is at 29 (0x0600E800) - does that sound right? It could simply be my map editor playing up - its being doing dodgy things to its output recently so this might just be that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26294 - sajiimori - Sat Sep 11, 2004 5:33 pm</h4>
    <div class="postbody"><span class="postbody">Unless you've changed your code since your initial post, you're setting one of your char base blocks to 16, which is much too high.  Like tepples said, your options are 0-3.  Char block 0 corresponds to screen blocks 0-7, 1 corresponds to 8-15, and so on.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
