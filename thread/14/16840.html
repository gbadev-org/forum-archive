<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>"(file) does not have a DLDI section" - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > "(file) does not have a DLDI section"</h2>
<div id="posts">
<div class="post">
    <h4>#170094 - wallacoloo - Sun Aug 30, 2009 12:42 am</h4>
    <div class="postbody"><span class="postbody">I'm trying to get libfat to work on my GBA.
<br/>
I am following <a class="postlink" href="http://www.1emulation.com/forums/index.php?showtopic=21405" target="_blank">this</a> tutorial.
<br/>
<br/>
I made a quick program that tries to initialize libFat and create a new file. I added some tests that check to make sure that libfat initialized correctly:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;stdio.h&gt;
<br/>
#include &lt;fat.h&gt;
<br/>
<br/>
unsigned short* Screen = (unsigned short*)0x6000000;
<br/>
void setRed() {
<br/>
    int i = 0;
<br/>
    while(i &lt; 38400) {
<br/>
            Screen[i] = 31;
<br/>
            i++;
<br/>
    } 
<br/>
}
<br/>
void setWhite() {
<br/>
    int i = 0;
<br/>
    while(i &lt; 38400) {
<br/>
            Screen[i] = 32767;
<br/>
            i++;
<br/>
    } 
<br/>
}
<br/>
<br/>
int main() {
<br/>
    *(unsigned long*)0x4000000 = 0x403; // mode3, bg2 on 
<br/>
    int res = fatInitDefault();
<br/>
    if (res) { //Success
<br/>
        setWhite();
<br/>
    } else { //Failure
<br/>
        setRed();
<br/>
    }
<br/>
    
<br/>
    FILE* pFile;
<br/>
    char buffer[] = "test";
<br/>
    pFile = fopen ( "myfile.bin" , "wb" );
<br/>
    fwrite (buffer, 1, sizeof(buffer), pFile);
<br/>
    fclose (pFile);
<br/>
    
<br/>
    while(1){}
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
When I get to step 3 in the tutorial, I get the following error while attempting to apply the DLDI patch to the resulting rom:
<br/>
"(file) does not have a DLDI section"
<br/>
<br/>
I tried testing the program anyways, the screen turned red (indicates that libfat didn't initialize correctly).
<br/>
<br/>
Any ideas on what I'm doing wrong?
<br/>
(And yes, I remembered to add -lfat to the LIBS section of my makefile)</span><span class="gensmall"><br/><br/>Last edited by wallacoloo on Tue Sep 01, 2009 12:14 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#170095 - DiscoStew - Sun Aug 30, 2009 2:43 am</h4>
    <div class="postbody"><span class="postbody">You haven't mentioned it, so I assume you haven't done it. Did you add "-lfat" to the LIBS line in your Makefile?<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170096 - wallacoloo - Sun Aug 30, 2009 5:26 am</h4>
    <div class="postbody"><span class="postbody">Yes, I have the lib included. Maybe I should've mentioned that.
<br/>
My libs section says this:
<br/>
<br/>
LIBS	:= -lfat -lgba
<br/>
<br/>
Now in their example, they had this:
<br/>
<br/>
LIBS	:= -lfat -lnds9
<br/>
<br/>
I figure that since I'm developing for the GBA, I didn't need to include libnds.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170289 - wallacoloo - Wed Sep 16, 2009 1:53 am</h4>
    <div class="postbody"><span class="postbody">Hmm, I really don't know why this solution worked, but I solved it.
<br/>
<br/>
I compiled it as a multiboot rom. Anybody know why that made a difference?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
