<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>irq handler and mode 4 gfx - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > irq handler and mode 4 gfx</h2>
<div id="posts">
<div class="post">
    <h4>#25778 - quickcup - Sat Aug 28, 2004 8:05 am</h4>
    <div class="postbody"><span class="postbody">I have been struggling with a problem for quite some time now and need some help.
<br/>
<br/>
The problem boils down to this:
<br/>
- I am using mode 4 graphics.
<br/>
- I have graphics drawing functions that work correctly at all times 'except ' when my interrupt handler is on the stack.
<br/>
<br/>
When my irq handler is on the stack and I try using my graphics functions I get indeterminate behaviour (lockups, distorted graphics, program resets, etc...)
<br/>
<br/>
Is this at all normal??
<br/>
Thks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25786 - poslundc - Sat Aug 28, 2004 4:20 pm</h4>
    <div class="postbody"><span class="postbody">In most configurations, IRQs use a different stack than the main program that is only 160 bytes deep. Could this be the source of your problem?
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25826 - quickcup - Sun Aug 29, 2004 2:53 am</h4>
    <div class="postbody"><span class="postbody">I guess my next question then is how do I prevent the cpu from switching to the interrupt stack when an interrupt is triggered?
<br/>
<br/>
I have dug around a bit on how to do this but I'm still fuzzy.   
<br/>
Can it be done without using any assembly?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25834 - poslundc - Sun Aug 29, 2004 4:47 am</h4>
    <div class="postbody"><span class="postbody">In my version of Devkit Advance (which is pretty old by now, I imagine) you can specify different interrupt modes, and the Multiple Interrupt mode uses the main stack. So if you can configure your program to work with multiple interrupts you can access it that way with relaitve ease.
<br/>
<br/>
Otherwise, you cannot switch to the main stack without tinkering in assembly, as it requires accessing the GBA's system-control register to change the state.
<br/>
<br/>
But do you know if this is what's causing the problem? Better to figure out why you're getting the error rather than blindly stumbling around for a solution.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
