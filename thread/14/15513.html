<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to handle more than 15 sprites (size 16x16, 16 col)? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > How to handle more than 15 sprites (size 16x16, 16 col)?</h2>
<div id="posts">
<div class="post">
    <h4>#156472 - mca - Sat May 10, 2008 10:13 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm new to this forum and to DS development. I read Patater's great manual, in which he explains sprite handling in detail.
<br/>
<br/>
In my first project I need to display a maximum of 63 different sprites.
<br/>
Each sprite is 16 color  and 16x16 pixels in size.
<br/>
<br/>
I use </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">vramSetBankE(VRAM_E_MAIN_SPRITE);</td> </tr></table><span class="postbody">
<br/>
for holding the sprite data (tiles,palette,...).
<br/>
<br/>
With each sprite displayed I assign a new <span style="font-weight: bold">SpriteBuffer</span> in the <span style="font-weight: bold">OAM</span>.
<br/>
I calculate a new <span style="font-weight: bold">TileStartingAdress</span> (address aligned to the standard 32 byte) and a new <span style="font-weight: bold">palette adress</span>. 
<br/>
<br/>
As long as I display fewer than 16 sprites all works fine.
<br/>
Displaying any more than 15 sprites results in strange artifacts, corrupted tiledata and palette data. After placing 48 sprites it even comes to an error in the palette of the main background. I don't understand the things happening here.
<br/>
Can someone shed light on this?
<br/>
Is there any code example handlig with this amount of sprites?
<br/>
<br/>
Thanks in advance...
<br/>
mca</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156474 - silent_code - Sat May 10, 2008 11:49 am</h4>
    <div class="postbody"><span class="postbody">well, welcome to the scene! :^)
<br/>
<br/>
it depends on how you handle the sprites.
<br/>
in general, you have only 256 colors for the palette.
<br/>
using 16 color (4 bit) sprites, gives you 16 sub palettes, which can be assigned to any sprite.
<br/>
if you write past the 256th color, you'll corrupt other memory.
<br/>
check out <a class="postlink" href="http://nocash.emubase.de/gbatek.htm" target="_blank">gbatek</a> to see how the memory areas are layed out!
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gbatek wrote:</b></span></td> </tr> <tr> <td class="quote">  5000000h Engine A Standard BG Palette (512 bytes)
<br/>
  5000200h Engine A Standard OBJ Palette (512 bytes)
<br/>
  5000400h Engine B Standard BG Palette (512 bytes)
<br/>
  5000600h Engine B Standard OBJ Palette (512 bytes)
<br/>
  7000000h Engine A OAM (1024 bytes)
<br/>
  7000400h Engine B OAM (1024 bytes)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
depending on your game's requirements, you can also reuse existing sprite tilesets (graphics) for different sprites, that look the same.
<br/>
<br/>
happy coding!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156476 - mca - Sat May 10, 2008 12:22 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for clarifying.
<br/>
<br/>
While re-reading Pataters manual I saw, that I oversaw this info about sprites:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">...Another advantage of using 16-color sprites is the ability to use 16 different palettes. ...</td> </tr></table><span class="postbody">
<br/>
<br/>
....and not more. You pointed it out.
<br/>
My first (errorous) thought for an easy approach was to give each sprite its own palette and own tiledata.
<br/>
<br/>
Because the 63 sprites are made of only 8 different shapes/palettes, I'll now go for 
<br/>
initializing the 8 sprites and map them on VRAM and then
<br/>
let the OAM attributes for 63 sprites  point to these areas.
<br/>
<br/>
Hope this will work.
<br/>
<br/>
Frohe Pfingsten...
<br/>
mca</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156479 - silent_code - Sat May 10, 2008 2:02 pm</h4>
    <div class="postbody"><span class="postbody">hahahaha!
<br/>
frohe pfingsten! :^D
<br/>
i'll keep writing in english, though. ;^)
<br/>
<br/>
you can also use the extended palette feature of the nds, in case you need to use more palette entries than are available in the standard oam palette.
<br/>
yes, i just wrote "palette" three times in just one sentence! :^P</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
