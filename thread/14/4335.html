<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>multiplayer questions - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > multiplayer questions</h2>
<div id="posts">
<div class="post">
    <h4>#28706 - greyboy - Thu Nov 04, 2004 9:01 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
I just have a few questions about multiplayer which I thought I'd toss out there.  I was taking a look at sgade's multiplayer module.
<br/>
<br/>
1) Now, this might be just how sgade chose to implement their multiplayer library, but...are packets broadcast to every gba (assume 4 connected), or are they sent specifically to targetted receivers?
<br/>
<br/>
2) at 60 fps, and 4 players, how many bytes of data can I anticipate sending each frame, i.e. how much data can each gba package up and send per frame.
<br/>
<br/>
3) If I want to make a 4-player twitch game, is the general correct approach to record the input of your gba on frame 0 and transmit that data at the end of your processing loop (before the vsync() to copy your data to hardware just before rendering).  Then, process the resultant effect of everyone's (including your) input in frame zero at once during frame 1?  Does my question make sense?  :)
<br/>
<br/>
Pointers to good tutorials on this (i've found sgade, thanks) would be great.
<br/>
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28738 - ScottLininger - Fri Nov 05, 2004 6:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>greyboy wrote:</b></span></td> </tr> <tr> <td class="quote">1) Now, this might be just how sgade chose to implement their multiplayer library, but...are packets broadcast to every gba (assume 4 connected), or are they sent specifically to targetted receivers?</td> </tr></table><span class="postbody">
<br/>
<br/>
At the hardware level there are four 16bit registers that handle the data transfer. Each gameboy in the chain has write access to one of these (via a fifth register), and read access to the other three. But only the master gameboy can send the "update all" command that shares the values out to everyone.
<br/>
<br/>
So yeah, anytime a value is broadcast it goes to all of the other gameboys. 
<br/>
<br/>
A "packet" is really a higher level construct... your software could be written to handle it as a "send from A to B" or "send to all" or even a client/server model. SGADE is the "send to all" model, if I remember right.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">2) at 60 fps, and 4 players, how many bytes of data can I anticipate sending each frame, i.e. how much data can each gba package up and send per frame.</td> </tr></table><span class="postbody">
<br/>
<br/>
I really don't know. My <a class="postlink" href="http://www.thingker.com" target="_blank">multiplayer code</a> performs fast enough to exchange about 20bytes of data between two gameboys at a rate that's okay for twitch games like pong... but it's definitely not exhanging that 60 times per second. I haven't actually tested to see how many wasted frames happen during the transfer.
<br/>
<br/>
Anyway, my code doesn't even use proper packets with checksums and stuff... it will only transfer a byte once it's been echoed back from every client. That's considerably slower than doing it "the right way," and yet it's fast enough that it works for pong.
<br/>
<br/>
My point is that you can exchange a fair amount of data at a rate that's perfectly acceptable for twitch games.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">3) If I want to make a 4-player twitch game, is the general correct approach to record the input of your gba on frame 0 and transmit that data at the end of your processing loop (before the vsync() to copy your data to hardware just before rendering).  Then, process the resultant effect of everyone's (including your) input in frame zero at once during frame 1?  Does my question make sense?  :)</td> </tr></table><span class="postbody">
<br/>
<br/>
Good question. Personally, I think it makes more sense for the master gameboy to maintain the game state, period. The other gameboys just send their button states back to the master, and the master updates everything and sends back out the status of the game.
<br/>
<br/>
No matter what library you're using, you're going to have challenges with dropped packets and gameboys that run slightly out of sync. If every gameboy is running it's own engine based on its own input, you'll have a nightmare getting it all to sync up perfectly.
<br/>
<br/>
I hope I understood the question. ;)
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28743 - greyboy - Fri Nov 05, 2004 7:46 am</h4>
    <div class="postbody"><span class="postbody">That's an awesome bit of info.  I checked out the registers and it makes more sense now, but what is the baud rate used for?  Why would you want to transfer anything at a slower rate ever?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28744 - Krakken - Fri Nov 05, 2004 7:51 am</h4>
    <div class="postbody"><span class="postbody">I have just opened a thread for a proposed packet management system. I'm waiting to get some feedback. Feel free to use it, it should go pretty fast as long as my thoerey is correct.
<br/>
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=4342" target="_blank">http://forum.gbadev.org/viewtopic.php?t=4342</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28751 - ScottLininger - Fri Nov 05, 2004 3:17 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>greyboy wrote:</b></span></td> </tr> <tr> <td class="quote">That's an awesome bit of info.  I checked out the registers and it makes more sense now, but what is the baud rate used for?  Why would you want to transfer anything at a slower rate ever?</td> </tr></table><span class="postbody">
<br/>
<br/>
This came up some time ago, and I think the conclusion was that the slower baud rates are only for serial communication with devices other than connected gameboys.
<br/>
<br/>
For multiplayer, max speed is best.
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28813 - Miked0801 - Sat Nov 06, 2004 9:00 pm</h4>
    <div class="postbody"><span class="postbody">Agreed.  SLowing it down didn't improve error handling or error occurance, so we left it at highest.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
