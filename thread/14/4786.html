<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>movesprites before or atfer wait for vsync? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > movesprites before or atfer wait for vsync?</h2>
<div id="posts">
<div class="post">
    <h4>#33684 - jenswa - Thu Jan 06, 2005 8:44 pm</h4>
    <div class="postbody"><span class="postbody">The question simple,
<br/>
<br/>
should i move my sprites before waitforvsync or should i move them after the waitforvsync is over?
<br/>
<br/>
Like this
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Movesprites();
<br/>
WaitForVsync();</td> </tr></table><span class="postbody">
<br/>
<br/>
or
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">WaitForVsync();
<br/>
Movesprites();</td> </tr></table><span class="postbody">
<br/>
<br/>
These code is within the main loop of my program.
<br/>
<br/>
thanks
<br/>
Jenswa[/code]<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33685 - DekuTree64 - Thu Jan 06, 2005 8:50 pm</h4>
    <div class="postbody"><span class="postbody">Usually you want to do all your movement and collision detection BEFORE VBlank, and only set up the OAM entries inside VBlank. 
<br/>
Most people make an array of OAM entries in RAM and fill that out during the sprite updating (outside VBlank), and only DMA that to the hardware OAM in VBlank. Faster overall, since you don't have to go back through your list of sprites a second time to set up the OAMs.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33686 - Wriggler - Thu Jan 06, 2005 9:03 pm</h4>
    <div class="postbody"><span class="postbody">Yep, so your code will look like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
moveSprites();
<br/>
waitForVBlank();
<br/>
copyOAM();
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
That's the way to go, do all of your internal calculations in moveSprites(), then just do a quick memory copy inside of copyOAM(). I like to think of it as double buffering sprites, so you update your "sprite backbuffer" during moveSprites(), and then swap your buffers in copyOAM(). Not the most technically correct explanation, but it helped me understand it!
<br/>
<br/>
Ben</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33689 - jenswa - Thu Jan 06, 2005 9:32 pm</h4>
    <div class="postbody"><span class="postbody">Thanks guys.
<br/>
<br/>
I always seem to forget this and then later on have some weird sprites not moving correctly.
<br/>
<br/>
Jenswa<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
