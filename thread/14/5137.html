<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DMA problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > DMA problem</h2>
<div id="posts">
<div class="post">
    <h4>#37170 - demitri - Tue Mar 08, 2005 1:22 pm</h4>
    <div class="postbody"><span class="postbody">Hey Everyone,
<br/>
I'm having some issues with DMA.  I'm trying to place some pointers in a specific place in memory.  I can, however, create the pointers, but when I attempt to place an int into those memory addresses. I cannot find the value. here is my code.  If you have any ideas. please let me know. thanks.
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define VariableData ((unsigned short*)0x8000000)
<br/>
unsigned short* cdph_h= VariableData +4; 
<br/>
unsigned short* cdph_t = VariableData + 5;
<br/>
unsigned short* cdph_s = VariableData + 6;
<br/>
unsigned short* cdph_dt = VariableData + 7; 
<br/>
unsigned short* cdph_dh = VariableData + 8; 
<br/>
<br/>
<br/>
unsigned short* tdph_h = VariableData + 9;
<br/>
unsigned short* tdph_t = VariableData + 10;
<br/>
unsigned short* tdph_s = VariableData + 11;
<br/>
unsigned short* tdph_dt = VariableData + 12;
<br/>
unsigned short* tdph_dh = VariableData + 13;
<br/>
<br/>
<br/>
unsigned short* pdph_h = VariableData + 14;
<br/>
unsigned short* pdph_t = VariableData + 15;
<br/>
unsigned short* pdph_s = VariableData + 16;
<br/>
unsigned short* pdph_dt = VariableData + 17;
<br/>
unsigned short* pdph_dh = VariableData + 18;
<br/>
.
<br/>
.
<br/>
.
<br/>
<br/>
int main (void){
<br/>
<br/>
*cdph_h = 1;
<br/>
*cdph_t = 2;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
etc. thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37184 - poslundc - Tue Mar 08, 2005 5:45 pm</h4>
    <div class="postbody"><span class="postbody">The 0x08000000 region of memory points to ROM data, which is read-only.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37331 - tepples - Thu Mar 10, 2005 3:37 pm</h4>
    <div class="postbody"><span class="postbody">Whether the data in the ROM section of the address map is read-only depends on your cart. For official Game Paks and EFA flash carts, it is read-only. For most other flash carts, it is read-only unless you execute a specific unlocking sequence, but that's a bit advanced for most of us, and given the quality reputation of Chinese no-name electronics, I wouldn't recommend repeated flash writes.
<br/>
<br/>
Use EWRAM instead, (EDIT) unless you need persistence. In that case, use SRAM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"><br/><br/>Last edited by tepples on Fri Mar 11, 2005 4:14 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#37343 - poslundc - Thu Mar 10, 2005 5:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Whether the data in the ROM section of the address map is read-only depends on your cart.</td> </tr></table><span class="postbody">
<br/>
<br/>
So long as we're referring to it as the <span style="font-style: italic">ROM</span> section, though, I'm inclined to think of it primarily as read-only. ;)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37358 - demitri - Thu Mar 10, 2005 8:39 pm</h4>
    <div class="postbody"><span class="postbody">Fair Enough. 
<br/>
Thanks.  
<br/>
So i''ve moved my thinking.  Now i'm goin to write to EEPROM on the cart. so now i just have to write the functions to do so.  Does anyone know of some working code i may have a look at.  I have viewed the code in  the post named "EEPROM Troubles".  anyone know of any other code. I haven't tried that code yet. I'm in the process of doing so. Regardless, many sources are always a better learning tool...  So if anyone knows of any please let me know.  Thank again!
<br/>
-Demitri</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37401 - FluBBa - Fri Mar 11, 2005 11:49 am</h4>
    <div class="postbody"><span class="postbody">It's way easier to start out with just SRAM, starts at 0x0E00000 and ends at 0x0E007FFF.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37440 - demitri - Fri Mar 11, 2005 6:33 pm</h4>
    <div class="postbody"><span class="postbody">I would use sram, but i can't.  I'm actually going to write to EEPROM within a microchip PIC.  thus, i need to write the EEPROM read/write protocol... 
<br/>
-demitri
<br/>
<br/>
thanks for the info though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37478 - ymalik - Fri Mar 11, 2005 10:21 pm</h4>
    <div class="postbody"><span class="postbody">What is the minimum amount the DMA can copy and still be fast?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37482 - poslundc - Fri Mar 11, 2005 11:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ymalik wrote:</b></span></td> </tr> <tr> <td class="quote">What is the minimum amount the DMA can copy and still be fast?</td> </tr></table><span class="postbody">
<br/>
<br/>
It depends what memory regions you are copying to/from, but as a rule of thumb I usually don't bother to use DMA for copies under 32 bytes.
<br/>
<br/>
At that small an amount, of course, the speed advantage of one method or the other approaches insignificance, so I defer to software copying, which is generally less likely to interfere with other GBA systems and is easier to read and debug.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37492 - ymalik - Sat Mar 12, 2005 1:29 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
It depends what memory regions you are copying to/from, but as a rule of thumb I usually don't bother to use DMA for copies under 32 bytes.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Much thanks.
<br/>
<br/>
I'm going to be copying either from ROM to VRAM, ROM to IRAM, IRAM to VRAM, ROM to WRAM, or WRAM to VRAM.  Of course, I won't use all combinations:  based on the size of the data from the ROM, I'm still deciding whether to use WRAM or IRAM for a temporary buffer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37537 - gb_feedback - Sat Mar 12, 2005 9:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I would use sram, but i can't. I'm actually going to write to EEPROM within a microchip PIC. thus, i need to write the EEPROM read/write protocol... </td> </tr></table><span class="postbody">
<br/>
<br/>
That's a bit of a thread stopper. Do you mean that the EEPROM you want is in a PIC which is in a Cart? Or that you are going to use a PIC to write to the EEPROM on an official cart, or a commercial cart which uses EEPROM? This leaves me very confused.<br/>_________________<br/><a class="postlink" href="http://www.bookreader.co.uk/" target="_blank">http://www.bookreader.co.uk/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#37751 - demitri - Tue Mar 15, 2005 8:38 pm</h4>
    <div class="postbody"><span class="postbody">yes...  hahah. ok sorry.
<br/>
<br/>
The EEPROM is in a PIC which is in a Cartridge.  its a home-made pcb board/cartridge, which contains the PIC.  Internal to the PIC lives an EEPROM which i need to write to.  
<br/>
I have found the protocol i was looking for, and it doesn't freeze up the gameboy. well using an EZFA cartridge.  the home-made cart is being built soon. 
<br/>
<br/>
Thanks for everyone's input.
<br/>
-demitri</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
