<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Insight/GDB Debug Problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Insight/GDB Debug Problem</h2>
<div id="posts">
<div class="post">
    <h4>#120328 - notunusual - Fri Mar 02, 2007 10:54 pm</h4>
    <div class="postbody"><span class="postbody">I've downloaded/installed devkitpro using the 1.4.2 updater program.
<br/>
<br/>
I then downloaded the VBA SDL version 1.7.1.
<br/>
<br/>
Also from the same page, I've downloaded version 6.4.50 of the insight/gdb, which it says works with this version of VBA to debug.
<br/>
<br/>
I've set vba running and waiting on tcp port 55555, then I load the elf file (just trying this with one of the included examples, ansi_console in this case), and set insight to run the program and get the following message in my vba window:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">VisualBoyAdvance-SDL version 1.7.1
<br/>
Windows version
<br/>
Seaching for file VisualBoyAdvance.cfg
<br/>
Searching current dir: C:\devkitPro\VBA_SDL_1.7.1
<br/>
Searching PATH
<br/>
Configuration file NOT FOUND (using defaults)
<br/>
Listening for a connection at port 55555
<br/>
Got a connection from 127.0.0.1 2968
<br/>
Color depth: 32
<br/>
Unknown packet pf#d6
<br/>
Shutting down
<br/>
Closing remote socket
<br/>
Closing listen socket
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm not sure what I'm doing wrong, i've searched high and low for an answer and had no luck.
<br/>
<br/>
Also if I try and use the version of insight that is downloaded/installed with the devkitpro updater, which I believe is version 6.5, the arm-eabi-insight.exe doesn't even load when attemping to execute it.
<br/>
<br/>
Any and all help is appreciated.[/quote]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120330 - gmiller - Fri Mar 02, 2007 11:22 pm</h4>
    <div class="postbody"><span class="postbody">It would be help full to see how you startup the insight code.  The startup of insight will control what gets sent to and from the VBA code.  Just so you are aware most of the SDL version of VBA have a number of problems dealing with the debugger.  If you are interested there is a fixed version that has most of the debugging issues cleared up available.  I use this version every month in my classes with a good number of students so it is pretty stable.
<br/>
<br/>
I will come back and post my startup of insight and the SDL version of VBA so you can see how I do it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120333 - notunusual - Fri Mar 02, 2007 11:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gmiller wrote:</b></span></td> </tr> <tr> <td class="quote">It would be help full to see how you startup the insight code.  The startup of insight will control what gets sent to and from the VBA code.  Just so you are aware most of the SDL version of VBA have a number of problems dealing with the debugger.  If you are interested there is a fixed version that has most of the debugging issues cleared up available.  I use this version every month in my classes with a good number of students so it is pretty stable.
<br/>
<br/>
I will come back and post my startup of insight and the SDL version of VBA so you can see how I do it.</td> </tr></table><span class="postbody">
<br/>
<br/>
Not sure what you're asking me for... I used the gui to load the .elf file output, setup the target using the example on <a href="http://www.devkitpro.org/debugging-with-vba-and-insight.shtml" target="_blank">http://www.devkitpro.org/debugging-with-vba-and-insight.shtml</a> , then tried to hit run.
<br/>
<br/>
I've also tried to use gdb by hand, setting the target, then "load my.elf", and the same thing happens...
<br/>
<br/>
I appreciate you taking the time to help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120344 - gmiller - Sat Mar 03, 2007 1:56 am</h4>
    <div class="postbody"><span class="postbody">I start the insight as part of my make file and here is the section:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#---------------------------------------------------------------------------------
<br/>
startsdl:
<br/>
   $(DEVKITPRO)/tools/win32/vbaSDL/vba.exe -3 -Gtcp:44444 &amp;
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
makeini:
<br/>
   echo "File $(TARGET).elf" &gt; insight.ini
<br/>
   echo "target remote 127.0.0.1:44444" &gt;&gt;insight.ini
<br/>
   echo "load $(TARGET).elf" &gt;&gt;insight.ini
<br/>
   echo "b main" &gt;&gt;insight.ini
<br/>
   echo "directory $(GDB_DIRS)"&gt;&gt;insight.ini
<br/>
   echo "c" &gt;&gt;insight.ini
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
startinsight:
<br/>
   $(DEVKITPRO)/insight/insight-6.4.50/bin/arm-elf-insight.exe --command=insight.ini $(TARGET).elf
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
rungdb: startsdl makeini startinsight
<br/>
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
To start debugging I use the following:
<br/>
<br/>
make rungdb
<br/>
<br/>
NOTE:
<br/>
My setup uses port 44444 just because I had issues with the default but that was because of another piece of software which you may not be running.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120380 - notunusual - Sat Mar 03, 2007 2:06 pm</h4>
    <div class="postbody"><span class="postbody">Great using that and modifying the make file works like a charm, strange that it would affect things... (also had a huge fight with my editor not inserting real tabs which screwed with the make file for a while).
<br/>
<br/>
Thanks again for the help!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120383 - gmiller - Sat Mar 03, 2007 2:14 pm</h4>
    <div class="postbody"><span class="postbody">You can do it by hand by using commands like those but I hate retyping things that I can automate.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126887 - RickA - Fri Apr 27, 2007 10:06 pm</h4>
    <div class="postbody"><span class="postbody">gmiller: I've tried to use your fixed version of VBA, but am unable to even get that running with the -Gtcp option. Running vbawin.exe works, but that doesn't take any command options. Running vba.exe crashes, asking me if I want to debug it (I've got Visual Studio installed).
<br/>
<br/>
I'm running on WinXP, and have tried to follow the same tutorial notunusual has, with similar succes. For some reason, I'm unable to add new targets to my makefile, so I can't actually test your makefile directly. The following is my current makefile:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
# Clear the implicit built in rules
<br/>
#---------------------------------------------------------------------------------
<br/>
.SUFFIXES:
<br/>
#---------------------------------------------------------------------------------
<br/>
ifeq ($(strip $(DEVKITARM)),)
<br/>
$(error "Please set DEVKITARM in your environment. export DEVKITARM=&lt;path to&gt;devkitARM)
<br/>
endif
<br/>
include $(DEVKITARM)/gba_rules
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# TARGET is the name of the output, if this ends with _mb generates a multiboot image
<br/>
# BUILD is the directory where object files &amp; intermediate files will be placed
<br/>
# SOURCES is a list of directories containing source code
<br/>
# INCLUDES is a list of directories containing extra header files
<br/>
#---------------------------------------------------------------------------------
<br/>
TARGET      :=   spritetest
<br/>
BUILD      :=   build
<br/>
SOURCES      :=   source font
<br/>
INCLUDES   :=
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# options for code generation
<br/>
#---------------------------------------------------------------------------------
<br/>
ARCH   :=   -mthumb -mthumb-interwork
<br/>
<br/>
CFLAGS   :=   -g -Wall -O3\
<br/>
         -mcpu=arm7tdmi -mtune=arm7tdmi\
<br/>
          -fomit-frame-pointer\
<br/>
         -ffast-math \
<br/>
         $(ARCH)
<br/>
<br/>
CFLAGS   +=   $(INCLUDE)
<br/>
CXXFLAGS   = $(CFLAGS)
<br/>
<br/>
ASFLAGS   :=   $(ARCH)
<br/>
LDFLAGS   =   -g $(ARCH) -Wl,-Map,$(notdir $@).map
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# path to tools - this can be deleted if you set the path in windows
<br/>
#---------------------------------------------------------------------------------
<br/>
export PATH      :=   $(DEVKITARM)/bin:$(PATH)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# any extra libraries we wish to link with the project
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBS   :=   -lgba
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# list of directories containing libraries, this must be the top level containing
<br/>
# include and lib
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBDIRS   :=   $(LIBGBA)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# no real need to edit anything past this point unless you need to add additional
<br/>
# rules for different file extensions
<br/>
#---------------------------------------------------------------------------------
<br/>
ifneq ($(BUILD),$(notdir $(CURDIR)))
<br/>
#---------------------------------------------------------------------------------
<br/>
<br/>
export OUTPUT   :=   $(CURDIR)/$(TARGET)
<br/>
<br/>
export VPATH   :=   $(foreach dir,$(SOURCES),$(CURDIR)/$(dir))
<br/>
export PATH   :=   $(DEVKITARM)/bin:$(PATH)
<br/>
export DEPSDIR   :=   $(CURDIR)/$(BUILD)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# automatically build a list of object files for our project
<br/>
#---------------------------------------------------------------------------------
<br/>
CFILES      :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.c)))
<br/>
CPPFILES   :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.cpp)))
<br/>
SFILES      :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.s)))
<br/>
BINFILES   :=   $(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.bin)))
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# use CXX for linking C++ projects, CC for standard C
<br/>
#---------------------------------------------------------------------------------
<br/>
ifeq ($(strip $(CPPFILES)),)
<br/>
#---------------------------------------------------------------------------------
<br/>
   export LD   :=   $(CC)
<br/>
#---------------------------------------------------------------------------------
<br/>
else
<br/>
#---------------------------------------------------------------------------------
<br/>
   export LD   :=   $(CXX)
<br/>
#---------------------------------------------------------------------------------
<br/>
endif
<br/>
#---------------------------------------------------------------------------------
<br/>
<br/>
export OFILES   := $(BINFILES:.bin=.o) $(CPPFILES:.cpp=.o) $(CFILES:.c=.o) $(SFILES:.s=.o)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# build a list of include paths
<br/>
#---------------------------------------------------------------------------------
<br/>
export INCLUDE   :=   $(foreach dir,$(INCLUDES),-I$(CURDIR)/$(dir)) \
<br/>
               $(foreach dir,$(LIBDIRS),-I$(dir)/include) \
<br/>
               -I$(CURDIR)/$(BUILD)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# build a list of library paths
<br/>
#---------------------------------------------------------------------------------
<br/>
export LIBPATHS   :=   $(foreach dir,$(LIBDIRS),-L$(dir)/lib)
<br/>
<br/>
.PHONY: $(BUILD) clean
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
$(BUILD):
<br/>
   @[ -d $@ ] || mkdir -p $@
<br/>
   @make --no-print-directory -C $(BUILD) -f $(CURDIR)/Makefile
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
clean:
<br/>
   @echo clean ...
<br/>
   @rm -fr $(BUILD) $(TARGET).elf $(TARGET).gba
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
else
<br/>
<br/>
DEPENDS   :=   $(OFILES:.o=.d)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# main targets
<br/>
#---------------------------------------------------------------------------------
<br/>
$(OUTPUT).gba   :   $(OUTPUT).elf
<br/>
<br/>
$(OUTPUT).elf   :   $(OFILES) $(LIBGBA)/lib/libgba.a
<br/>
<br/>
test:
<br/>
   echo hello
<br/>
   
<br/>
#---------------------------------------------------------------------------------
<br/>
startsdl:
<br/>
   $(DEVKITPRO)/tools/win32/vbaSDL/vba.exe -3 -Gtcp:44444 &amp;
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
makeini:
<br/>
   echo "File $(TARGET).elf" &gt; insight.ini
<br/>
   echo "target remote 127.0.0.1:44444" &gt;&gt;insight.ini
<br/>
   echo "load $(TARGET).elf" &gt;&gt;insight.ini
<br/>
   echo "b main" &gt;&gt;insight.ini
<br/>
   echo "directory $(GDB_DIRS)"&gt;&gt;insight.ini
<br/>
   echo "c" &gt;&gt;insight.ini
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
startinsight:
<br/>
   $(DEVKITPRO)/insight/bin/arm-elf-insight.exe --command=insight.ini $(TARGET).elf
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
rungdb: startsdl makeini startinsight 
<br/>
<br/>
%.o   :   %.bin
<br/>
   @echo   $(notdir $&lt;)
<br/>
   @$(bin2o)
<br/>
<br/>
-include $(DEPENDS)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
endif
<br/>
#---------------------------------------------------------------------------------
<br/>
</td> </tr></table><span class="postbody">
<br/>
Neither your targets, nor my own 'test' target work: No rule to make target 'test' pops up. I have converted all spaces to tabs (although it took me a while to realize that as well).
<br/>
<br/>
Any tips you can give me would be much appreciated, as I don't know assembly, so a source-level debugger would be much appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126895 - wintermute - Fri Apr 27, 2007 11:00 pm</h4>
    <div class="postbody"><span class="postbody">RickA: could you zip up your problematic project and mail it to me please?
<br/>
<br/>
I'll have a look &amp; see what I can do.
<br/>
<br/>
Gmiller: If you're still paying attention to this thread I'd like to look at using your vba 1.8.0 in preference to the 1.7.1 I have on the devkitpro site at present.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126913 - gmiller - Sat Apr 28, 2007 12:45 am</h4>
    <div class="postbody"><span class="postbody">I can post a link to the vba code or PM you a link to it.  I tried to post a message on the devkitPRO site but got no reply.  
<br/>
<br/>
RickA you can only debug in the SDL version the vbawin version's debug is useless (in my opinion).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127481 - RickA - Wed May 02, 2007 9:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">RickA: could you zip up your problematic project and mail it to me please?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Much appreciated. I've uploaded it to <a class="postlink" href="http://www.daedalus-development.net/ricka/spritetest.zip" target="_blank">http://www.daedalus-development.net/ricka/spritetest.zip</a>.
<br/>
<br/>
gmiller: I gathered such might be the case. Unfortunately, I'm also unable to get the SDL version working correctly.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
