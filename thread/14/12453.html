<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Score problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Score problem</h2>
<div id="posts">
<div class="post">
    <h4>#118479 - Sabr3wulf - Tue Feb 13, 2007 9:12 pm</h4>
    <div class="postbody"><span class="postbody">Hey, I'm having a problem with a scoring system.
<br/>
<br/>
I have the following code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   
<br/>
answer = 2;         
<br/>
CheckAnswer();
<br/>
</td> </tr></table><span class="postbody">
<br/>
Which gets the value of what's been shot then checks to see if it's the correct answer.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void CheckAnswer(void)
<br/>
{
<br/>
   if (a + b == answer)   
<br/>
   {
<br/>
      score ++;   
<br/>
   }
<br/>
   else            
<br/>
   {
<br/>
      score --;      
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
Which adds 1 to the score if it's correct.
<br/>
<br/>
The score is displayed by getting the value of score and moving a sprite for that number into the score area as follows:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   
<br/>
if (score == 0)
<br/>
{
<br/>
   xscorezero = 210;
<br/>
   xscoreone = 240;
<br/>
}
<br/>
.
<br/>
.
<br/>
.
<br/>
.
<br/>
.
<br/>
.
<br/>
.
<br/>
.
<br/>
else if (score == 9)
<br/>
{
<br/>
   xscoreeight = 240;
<br/>
   xscorenine = 210;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
However, instead of incrementing by one when the answer is correct, it cycles through the sprites from 1 until it gets to 9. Anyone know what's up? Sorry for the poor code, I'm only a beginner :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118482 - Miked0801 - Tue Feb 13, 2007 9:35 pm</h4>
    <div class="postbody"><span class="postbody">Is score initialized to 0?
<br/>
<br/>
Also, you might be better off posting all the code to make sure there isn't a hidden gotcha.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118495 - tepples - Tue Feb 13, 2007 11:29 pm</h4>
    <div class="postbody"><span class="postbody">Another tip: Instead of using separate sprites for the digits 0 through 9, you can use one sprite and change its attribute 2 to point to different sprite cels in VRAM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118587 - KayH - Wed Feb 14, 2007 12:33 pm</h4>
    <div class="postbody"><span class="postbody">In the CheckAnswer() method there should be also a range check similar to:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if(score &lt; 0)
<br/>
{
<br/>
   score = 0;
<br/>
}
<br/>
if(score &gt; 9)
<br/>
{
<br/>
   score = 9;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
Otherwise the score could cycle through all numbers inside the range of your type (int?)
<br/>
If this method is called at regular timebase (e.g. vblank) the mentioned effect could occur.
<br/>
<br/>
It would be also good to have the answer (and maybe other variables too) as method parameter instead of global variables. e.g.:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int CheckAnswer(int answer)
<br/>
{
<br/>
   ...
<br/>
   return score;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
HTH
<br/>
KaY</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118605 - sgeos - Wed Feb 14, 2007 3:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>KayH wrote:</b></span></td> </tr> <tr> <td class="quote">It would be also good to have the answer (and maybe other variables too) as method parameter instead of global variables. e.g.:</td> </tr></table><span class="postbody">
<br/>
I agree with KayH in that parameters make for a better architecture.  If you insist on global variables, please, at the very least, mark them as such:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// globals - g for global
<br/>
int gA;
<br/>
int gB;
<br/>
int gAnswer;
<br/>
int gScore;
<br/>
<br/>
void checkScore(void)
<br/>
{
<br/>
    if (gA + gB == gAnswer)
<br/>
        gScore++;
<br/>
    else
<br/>
        gScore--;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
This way when variables pop out of nowhere, people know that they are global.  This becomes very important in longer functions.  ("Where did *that* come from?  No, it's not at the top of the function...")
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118701 - neilio - Thu Feb 15, 2007 9:29 pm</h4>
    <div class="postbody"><span class="postbody">I see that you're using IF functions to do different things depending on the value of score (your code for this is shown below).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (score == 0) 
<br/>
{ 
<br/>
   xscorezero = 210; 
<br/>
   xscoreone = 240; 
<br/>
} 
<br/>
. 
<br/>
. 
<br/>
. 
<br/>
. 
<br/>
. 
<br/>
. 
<br/>
. 
<br/>
. 
<br/>
else if (score == 9) 
<br/>
{ 
<br/>
   xscoreeight = 240; 
<br/>
   xscorenine = 210; 
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
I've found that when doing this kind of thing it's better to use the SWITCH statement, which in your case would go something like...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
switch(score)
<br/>
{
<br/>
    case 0:
<br/>
        xscorezero = 210; 
<br/>
        xscoreone = 240;
<br/>
        break;
<br/>
<br/>
    case 1;
<br/>
        xscorezero = 210; 
<br/>
        xscoreone = 240;
<br/>
        break;
<br/>
<br/>
'
<br/>
'
<br/>
'
<br/>
'
<br/>
'
<br/>
    case 9:
<br/>
        xscoreeight = 240; 
<br/>
        xscorenine = 210;
<br/>
        break;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I think I had a similar problem to you and this helped solve it, though I never figured out what caused the problem! Hope this helps.<br/>_________________<br/>I'd like to think this signature is under development, but it isn't.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118707 - Miked0801 - Thu Feb 15, 2007 10:51 pm</h4>
    <div class="postbody"><span class="postbody">Actually, a ROM table would be even cleaner.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
static const u32 ScoreTab[MAX_SCORE_VALUES][2] = 
<br/>
{ 
<br/>
    {210, 240},
<br/>
   ...
<br/>
    {240, 210},
<br/>
};
<br/>
<br/>
int foo(void)
<br/>
{
<br/>
    xScorezero = ScoreTab[0][0];
<br/>
    xScorenine = ScoreTab[0][1];
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118806 - Sabr3wulf - Fri Feb 16, 2007 10:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">Is score initialized to 0?</td> </tr></table><span class="postbody">
<br/>
Yup.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">Also, you might be better off posting all the code to make sure there isn't a hidden gotcha.</td> </tr></table><span class="postbody">
<br/>
I wish I could as it'd be a great help but unfortunately I can't.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>KayH wrote:</b></span></td> </tr> <tr> <td class="quote">In the CheckAnswer() method there should be also a range check similar to:
<br/>
Otherwise the score could cycle through all numbers inside the range of your type (int?)</td> </tr></table><span class="postbody">
<br/>
Cheers, didn't think of that!
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>KayH wrote:</b></span></td> </tr> <tr> <td class="quote">If this method is called at regular timebase (e.g. vblank) the mentioned effect could occur.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
CheckAnswer is being called when the laser hits one of the targets (I think)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void HitNine(void) // check if the laser sprite has hit the 9 sprite
<br/>
{
<br/>
   if ((xlaser &gt;= xnine - 5) &amp;&amp; (xlaser &lt;= xnine + 9)) // the shot will have hit the 9 sprite
<br/>
   {
<br/>
      if (ylaser &lt; ynine + 16)
<br/>
      {
<br/>
         xnine = 240;      // move the 9 sprite off the screen, making it 'disappear'
<br/>
         xlaser = 240;      // move the laser sprite off the screen, making it 'disappear'
<br/>
         shots = 0;         // set shots back to 0
<br/>
         c = 9;            // set c to hold the value of the sprite (9)
<br/>
         CheckAnswer();
<br/>
      }
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
It doesn't help that the code is very hacked together and gets quite confusing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118814 - KayH - Sat Feb 17, 2007 12:48 am</h4>
    <div class="postbody"><span class="postbody">well ...
<br/>
<br/>
You have (at least) two sprites: the laser (bullet) and the target (ship). What you probably do is to move the laser from one position on the screen to the next position. This is done on regular timebase (I hope you use the VBlank for timing this! Although it does not matter for the following.)
<br/>
<br/>
Now, you regularly make a hittest. Your target has 14 pixel in the x dimension. After the first hit your test and score is positive started. But now you should either stop the propagation of the laser or you should tweak your hittest! Otherwise you get a positive hittest on each following propagation cycle, which result in continuously increasing the score ... and you get a cycling score value.
<br/>
<br/>
Please make you also familiar with "struct" element of C/C++. This will make your code a lot better to understand. :-)
<br/>
<br/>
Also there are a lot of very good hittest threads in the forum. Please search for these and you will get a better impression of how you should do this.
<br/>
<br/>
HTH
<br/>
KaY</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
