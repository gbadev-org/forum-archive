<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Another sprite problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Another sprite problem</h2>
<div id="posts">
<div class="post">
    <h4>#10113 - Phil Hale - Wed Aug 27, 2003 10:58 am</h4>
    <div class="postbody"><span class="postbody">I'm have problems displaying sprites. Ever another sprite is displayed correctly. Sprites 0, 2, 4, and 6 work fine, and sprites 1, 3, and 5 do not, plus there is a 'artifact' in the top left of the screen. I have initialised the sprites to an off screen position so I have no idea why the artifact appears.
<br/>
<br/>
Heres the code (I have been following gbajunkies tutorials so thats where most of the code is from):
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "sprite.h"
<br/>
#include "gba.h"
<br/>
#include "dispcnt.h"
<br/>
#include "sprites\palette.h"
<br/>
#include "sprites\ball.h"
<br/>
#include "sprites\bat.h"
<br/>
#include "sprites\block1.h"
<br/>
#include "sprites\block2.h"
<br/>
#include "sprites\block3.h"
<br/>
#include "sprites\block4.h"
<br/>
#include "sprites\block5.h"
<br/>
<br/>
<br/>
int main()
<br/>
{
<br/>
  u16 loop;
<br/>
  u16* temp;
<br/>
<br/>
  SetMode(MODE_1 | OBJ_ENABLE | OBJ_MAP_1D); 
<br/>
<br/>
  for(loop = 0; loop &lt; 256; loop++)   
<br/>
    OBJPaletteMem[loop] = palette[loop];
<br/>
<br/>
  InitializeSprites();
<br/>
<br/>
   sprites[0].attribute0 = COLOR_256 | SQUARE | 142;     
<br/>
   sprites[0].attribute1 = SIZE_8 | 11;
<br/>
   sprites[0].attribute2 = 0;      
<br/>
                    
<br/>
   for(loop = 0; loop &lt; 32; loop++)       {
<br/>
     OAMData[loop] = ballData[loop];
<br/>
   }
<br/>
      
<br/>
   sprites[1].attribute0 = COLOR_256 | WIDE | 147;     
<br/>
   sprites[1].attribute1 = SIZE_16 | 107;              
<br/>
   sprites[1].attribute2 = 2;                          
<br/>
<br/>
    for(loop = 32; loop &lt; 160; loop++)       {
<br/>
      OAMData[loop] = batData[loop-32];
<br/>
    }
<br/>
      
<br/>
  sprites[2].attribute0 = COLOR_256 | WIDE | 35;     
<br/>
  sprites[2].attribute1 = SIZE_16 | 12;              
<br/>
  sprites[2].attribute2 = 10;                          
<br/>
<br/>
   for(loop = 160; loop &lt; 288 ; loop++)       {
<br/>
     OAMData[loop] = block1Data[loop-160];
<br/>
   }
<br/>
   
<br/>
   sprites[3].attribute0 = COLOR_256 | WIDE | 35;     
<br/>
   sprites[3].attribute1 = SIZE_16 | 56;              
<br/>
   sprites[3].attribute2 = 18;                          
<br/>
<br/>
   for(loop = 288; loop &lt; 416 ; loop++)       {
<br/>
      OAMData[loop] = block2Data[loop-288];
<br/>
   }
<br/>
<br/>
   sprites[4].attribute0 = COLOR_256 | WIDE | 35;     
<br/>
   sprites[4].attribute1 = SIZE_16 | 102;              
<br/>
   sprites[4].attribute2 = 26;                          
<br/>
<br/>
   for(loop = 416; loop &lt; 544 ; loop++)      {
<br/>
     OAMData[loop] = block3Data[loop-416];
<br/>
   }
<br/>
<br/>
   sprites[5].attribute0 = COLOR_256 | WIDE | 35;     
<br/>
   sprites[5].attribute1 = SIZE_16 | 147;              
<br/>
   sprites[5].attribute2 = 34;                          
<br/>
<br/>
   for(loop = 544; loop &lt; 672 ; loop++)                          {
<br/>
      OAMData[loop] = block4Data[loop-544];
<br/>
   }
<br/>
<br/>
   sprites[6].attribute0 = COLOR_256 | WIDE | 35;     
<br/>
   sprites[6].attribute1 = SIZE_16 | 192;              
<br/>
   sprites[6].attribute2 = 42;                          
<br/>
<br/>
   for(loop = 672; loop &lt; 800 ; loop++)                          {
<br/>
      OAMData[loop] = block5Data[loop-672];
<br/>
   }
<br/>
<br/>
  while(1)   //the main game loop
<br/>
  {
<br/>
    WaitForVsync();      
<br/>
    CopyOAM();         
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
The first sprite is 8x8 and the rest are 32x8. I have swapped TALL and WIDE in sprite.h so they are the correct way round.
<br/>
<br/>
Can anyone tell me what I have done wrong??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10179 - yaustar - Fri Aug 29, 2003 1:52 am</h4>
    <div class="postbody"><span class="postbody">is it possible to post the rom image?
<br/>
<br/>
Also waht tool did you use to convert the images?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10196 - Phil Hale - Fri Aug 29, 2003 11:37 am</h4>
    <div class="postbody"><span class="postbody">I used devotos pcx2sprite, which I'm pretty sure is the right program
<br/>
How do I post the rom image?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10221 - yaustar - Sat Aug 30, 2003 3:05 am</h4>
    <div class="postbody"><span class="postbody">upload to some webspace and post a link to it...
<br/>
<br/>
and yes, that is the right tool<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10645 - Master Mofo - Thu Sep 11, 2003 3:02 pm</h4>
    <div class="postbody"><span class="postbody">Sorry for not going through your code rightnow, I do not have the Compiler . But I promise to compile it when I go home. 
<br/>
<br/>
but till that time try this:
<br/>
 MAke sure that your calculations of the Loop variable are correct. you see 256 Color sprites take the double ammount of bytes the 16 Color ones take. for example a SQUARE 8x8 16 Col sprite occupies 32 bytes in the Char memory. While an 8x8 256 Col sprite occupies 32*2 bytes. (Twice the tiles). So your loop must be from 0 to 32 for the 256 sprite. If you know this already ignore what I have said. So your problem may be the Data arrays. You may have converted them the wrong way. MAke sure your data is defined as an u16 array instead of an U8.
<br/>
<br/>
- Try displaying Sprites one at a time. First make sure that the ball sprite is correctly displayed. after that add the 2nd sprite and so on.<br/>_________________<br/>"You have to finish what you have started"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11030 - mandarin - Tue Sep 23, 2003 9:24 pm</h4>
    <div class="postbody"><span class="postbody">I'm not sure whats wrong but this might help try it out
<br/>
<br/>
its a function I wrote,you can just customize it a bit to your needs let me know if it works.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int spritedisplay(int x, int y, int size, int no, int priority,int attrnum,int onoff)
<br/>
<br/>
{
<br/>
   u16 loop;
<br/>
   
<br/>
<br/>
   if(onoff == 0)
<br/>
{
<br/>
   initsprites();
<br/>
}
<br/>
   if(onoff==1)
<br/>
{
<br/>
<br/>
   callsprites();
<br/>
   
<br/>
   if(size == 3232)
<br/>
{
<br/>
   sprites[no].attribute0 = COLOR_256 | SQUARE | x;
<br/>
   sprites[no].attribute1 = SIZE_32 | y;
<br/>
   sprites[no].attribute2 = attrnum | PRIORITY(priority);
<br/>
<br/>
   if(no==0)
<br/>
   {
<br/>
      for(loop = 0; loop &lt; 512; loop++)
<br/>
         OAMData[loop] = characterData[loop];
<br/>
   }
<br/>
   if(no&gt;0)
<br/>
   {
<br/>
      for(loop = no*512; loop &lt; no*512+512; loop++)
<br/>
         OAMData[loop] = characterData[loop];
<br/>
   }
<br/>
}
<br/>
<br/>
<br/>
   if(size == 1632)
<br/>
{
<br/>
   sprites[no].attribute0 = COLOR_256 | WIDE | x;
<br/>
   sprites[no].attribute1 = SIZE_32 | y;
<br/>
   sprites[no].attribute2 = attrnum | PRIORITY(priority);
<br/>
<br/>
   if(no==0)
<br/>
   {
<br/>
      for(loop = 0; loop &lt; 256; loop++)
<br/>
         OAMData[loop] = characterData[loop];
<br/>
   }
<br/>
   if(no&gt;0)
<br/>
   {
<br/>
      for(loop = no*256; loop &lt; no*256+256; loop++)
<br/>
         OAMData[loop] = characterData[loop];
<br/>
   }
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11031 - mandarin - Tue Sep 23, 2003 9:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void initsprites()
<br/>
<br/>
{
<br/>
   u16 loop;
<br/>
<br/>
   for(loop=0;loop&lt;128;loop++)
<br/>
   {
<br/>
      sprites[loop].attribute0 = 160;
<br/>
      sprites[loop].attribute1 = 240;
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11032 - mandarin - Tue Sep 23, 2003 9:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void callsprites()
<br/>
{
<br/>
   u16 loop;
<br/>
   
<br/>
   for(loop = 0; loop &lt; 256;loop++)
<br/>
      OBJPaletteMem[loop] = spritePalette[loop];
<br/>
<br/>
   initsprites();
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11038 - yaustar - Wed Sep 24, 2003 12:43 am</h4>
    <div class="postbody"><span class="postbody">Are you using the right dimensions for the wide sprites? I think they have set sizes for how wide is wide etc.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
