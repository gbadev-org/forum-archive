<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Code for moving sprite (left, right, up, and down) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Code for moving sprite (left, right, up, and down)</h2>
<div id="posts">
<div class="post">
    <h4>#149696 - Cave Johnson - Thu Jan 24, 2008 3:33 am</h4>
    <div class="postbody"><span class="postbody">I've been trying to code a simple game, including a fish. I have all of the code written, except i cannot figure out how to program the fish to move in simple directions with a press of the corresponding Dpad button. I want the fish to move up, down, left, and right, and to reverse directions right and left. This is what i have so far for moving the fish in my fish.cpp file:
<br/>
<br/>
void fish::up() {
<br/>
    float incX = thrust * sin(angle);
<br/>
    float incY = -(thrust * cos(angle));
<br/>
velocity.x += incX;
<br/>
if (velocity.x &gt; maxSpeed) {
<br/>
        velocity.x = maxSpeed;
<br/>
    }
<br/>
    if (velocity.x &lt; -maxSpeed) {
<br/>
        velocity.x = -maxSpeed;
<br/>
    }
<br/>
<br/>
velocity.y += incY;
<br/>
if (velocity.y &gt; maxSpeed) {
<br/>
        velocity.y = maxSpeed;
<br/>
    }
<br/>
    if (velocity.y &lt; -maxSpeed) {
<br/>
        velocity.y = -maxSpeed;
<br/>
    }
<br/>
}
<br/>
<br/>
void fish::movefish() {
<br/>
    position.x += velocity.x;
<br/>
    position.y += velocity.y;
<br/>
}
<br/>
<br/>
void fish::reverseTurn() {
<br/>
    angle = (2 * PI) - atan2(velocity.x, velocity.y);
<br/>
}
<br/>
<br/>
And here is the controls in my main.cpp:
<br/>
<br/>
void updateInput(touchPosition * touch) {
<br/>
	scanKeys();
<br/>
<br/>
    *touch = touchReadXY();
<br/>
}
<br/>
<br/>
void handleInput(fish * fish, MathVector2D&lt;int&gt; SpriteInfo, touchPosition * touch) {
<br/>
<br/>
	if (keysHeld() &amp; KEY_UP) {
<br/>
		fish-&gt;up();
<br/>
	} else if (keysHeld() &amp; KEY_DOWN) {
<br/>
		ship-&gt;down();
<br/>
        }
<br/>
<br/>
	if (keysHeld() &amp; KEY_LEFT) {
<br/>
		ship-&gt;reverseTurnLeft();
<br/>
        } else if (keysHeld() &amp; KEY_RIGHT) {
<br/>
		ship-&gt;reverseTurnRight();
<br/>
	}
<br/>
<br/>
Im pretty sure i have the code to move the fish up, that the reverse is not what i want it to be, and i know i have no left, right, or down code. If anyone could help me write this code, that would be great. Thanks.</span><span class="gensmall"><br/><br/>Last edited by Cave Johnson on Thu Jan 24, 2008 11:35 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#149742 - Miked0801 - Thu Jan 24, 2008 7:11 pm</h4>
    <div class="postbody"><span class="postbody">Ok, let me see if I can understand your code:
<br/>
<br/>
First of all: Comments please!  Without comments, we have to guess at functionality.
<br/>
<br/>
Press Up is accelerate in the current direction (angle)
<br/>
<br/>
reverseTurn doesn't reverse a turn.  To reverse direction, just flip your angle 180 degrees.  Your solution is flipping your velocity around the 0 degree axis.  If that is along the Y (up/down) axis, then it might be doing what you want, but the name of the function is misleading.
<br/>
<br/>
You also have no way to change the angle of your fish.  Perhaps increment and decrement the angle based on Shoulder Buttons or something. 
<br/>
<br/>
<br/>
Or, are you trying to just move your fish in simple Up/Down/Left/Right movements without acceleration and such?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149836 - Cave Johnson - Fri Jan 25, 2008 9:44 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for all the help, i fixed the problem, but i now have a new one. In the tutorial i followed, the sprite continued to coast along after the button was lifted. How do i fix this to make the sprite stop exactly when the button is lifted? I'm not sure what file this would be located in (main, the general sprite.cpp , or the fish.cpp for my fish sprite) so i wont post the file unless anyone has any idea. Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149844 - gauauu - Fri Jan 25, 2008 10:50 pm</h4>
    <div class="postbody"><span class="postbody">If you want the fish to stop after you stop pressing Up, you need to check and see if the user is NOT pressing up, or pressing down, then set it's Y velocity to 0.
<br/>
<br/>
Something like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if (keysHeld() &amp; KEY_UP) {
<br/>
     fish-&gt;up();
<br/>
} else if (keysHeld() &amp; KEY_DOWN) {
<br/>
     fish-&gt;down();
<br/>
}  else
<br/>
{
<br/>
     fish-&gt;stopYMovement();
<br/>
}
<br/>
<br/>
....
<br/>
<br/>
void fish::stopYMovement() {
<br/>
   velocity.y = 0;
<br/>
} 
<br/>
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Of course, this doesn't address inertia or other external forces on your fish, which your velocity system seems to suggest might exist.  (You could alternatively decrement the y velocity down to 0 to make it slow down and stop).
<br/>
<br/>
For a simpler model, to get you started, it might be easier if you remove the angular stuff, and remove the variable velocity, and just update the fish's position directly:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void fish::up() {
<br/>
   position.y--;
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Then, when you stop pushing up, it stops going up.  Although this doesn't let you have as much flexibility with inertia, acceleration, angles, outside forces, etc, it is much easier for a beginner to get something working that makes sense.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151260 - mrhaboobi - Fri Feb 22, 2008 2:10 am</h4>
    <div class="postbody"><span class="postbody">HI, whats the tutorial your using for the movement?  I'm interested to know i've also got plenty of questions regarding simple movement.  Thanks</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
