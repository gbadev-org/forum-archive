<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Corrupt data [Solved] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Corrupt data [Solved]</h2>
<div id="posts">
<div class="post">
    <h4>#173814 - Azenris - Sun May 02, 2010 4:57 pm</h4>
    <div class="postbody"><span class="postbody">I have the following code before a function call
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (GetLevel()-&gt;m_tiles_per_level != 576)
<br/>
{
<br/>
   DEBUG_MSG(0, "before")
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
And i have at the top of the function being called
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (GetLevel()-&gt;m_tiles_per_level != 576)
<br/>
{
<br/>
   DEBUG_MSG(0, "after")
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm getting the message "after". how is the act of calling a function corrupting my data.
<br/>
<br/>
Not sure how to fix it as I'm not really sure what the problem is.
<br/>
<br/>
TY for any help!<br/>_________________<br/><a class="postlink" href="http://sacredpotion.blogspot.com/" target="_blank"><span style="color: red">My Homebrew Games</span></a></span><span class="gensmall"><br/><br/>Last edited by Azenris on Sun May 02, 2010 9:46 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#173815 - DiscoStew - Sun May 02, 2010 5:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">GetLevel()-&gt;m_tiles_per_level</td> </tr></table><span class="postbody">
<br/>
<br/>
Can you tell us what GetLevel is, because from the look of it, you are trying to get a member of a function. Last I remember, function's can't have members, yet how it can be compiled as such is beyond me.
<br/>
<br/>
Now, if GetLevel is a pointer to an object of a class  and m_tiles_per_level is a method (function), then it would need to look something like this...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">GetLevel-&gt;m_tiles_per_level()</td> </tr></table><span class="postbody"><br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173817 - Cearn - Sun May 02, 2010 6:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DiscoStew wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">GetLevel()-&gt;m_tiles_per_level</td> </tr></table><span class="postbody">
<br/>
<br/>
Can you tell us what GetLevel is, because from the look of it, you are trying to get a member of a function. Last I remember, function's can't have members, yet how it can be compiled as such is beyond me.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Functions can't have members, but the structs they return might.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
struct Foo { int m_bar; }    // Struct definition
<br/>
<br/>
static Foo s_foo;         // Global variable (static for encapsulation)
<br/>
<br/>
Foo *GetFoo()         // Get foo instance
<br/>
{
<br/>
    return &amp;s_foo;
<br/>
}
<br/>
<br/>
// Somewhere else
<br/>
GetFoo()-&gt;m_bar= 3;         // Set member via wrapper function.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
As for the actual problem, I suppose it's possible that DEBUG_MSG does more than you think it does. Or less than you think it does. Maybe it needs a flush to actually print. I've also noticed that if you call stdio functions before initializing the console, later initializations don't really take and printf is basically in sulk-mode, only obeying when it feels like it. If the "before" doesn't print when you change its condition to == 576, the problem is probably in DEBUG_MSG.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173818 - Azenris - Sun May 02, 2010 7:27 pm</h4>
    <div class="postbody"><span class="postbody">yea GetLevel returns a class with a public variable being accessed
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">inline CLevelManager *GetLevel(void) const {return m_pLevel;}</td> </tr></table><span class="postbody">
<br/>
<br/>
It does print when changed to ==
<br/>
<br/>
I also changed it slightly to print exactly what the variable is becoming, it changes from 576 to -535752702
<br/>
<br/>
The function is called 4 times and on the fifth attempt it fails as the variable becomes that garbage
<br/>
<br/>
The DEBUG_OUT calls a function that sets up the console and prints it, but they are only called after the variables fails at the checks. one before the call and after, the after being the only that fails as something changes it
<br/>
<br/>
hmmm! :(
<br/>
<br/>
Ill keep trying
<br/>
<br/>
EDIT: I just tried to print some stats on the actual entity its acting on, all my entities have dataID's and this one is returning on that doesnt exist so the whole entity is messed up. it must only show once calling that function. Guess I gotta look further back
<br/>
<br/>
EDIT: The problem was with my enemy spawner, it spawned the enemy "attacking" so it hit its target which was random memory. It now spawns correctly and the pTarget variable default set NULL.
<br/>
<br/>
oopsie! Ty for any help<br/>_________________<br/><a class="postlink" href="http://sacredpotion.blogspot.com/" target="_blank"><span style="color: red">My Homebrew Games</span></a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
