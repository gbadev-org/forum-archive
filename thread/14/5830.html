<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>whats the best way to load bg (for dummies?) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > whats the best way to load bg (for dummies?)</h2>
<div id="posts">
<div class="post">
    <h4>#43758 - sabkaraja - Thu May 26, 2005 9:27 am</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
I searched much of the beginners forum for a best way to load bg. At the moment, I am able to do it by trial and error, but the clever way to do this eludes me.
<br/>
I am clear with loading sprites to VRAM and find the character index. Similarly, I believe there must be some way to load bg's and put them in appropriate charbase and screenblock.
<br/>
<br/>
Thanks
<br/>
<br/>
Rajesh</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43786 - tepples - Thu May 26, 2005 8:19 pm</h4>
    <div class="postbody"><span class="postbody">Have you tried <a class="postlink" href="http://www.pineight.com/gba/#agbtty" target="_blank">AGBTTY</a>? Here's a gentle way to learn the basics of tiled backgrounds on a GBA: <ol type="1"><li>Install and learn AGBTTY. </li><li>Learn how to write to arbitrary positions on the map (hint: MAP[n][y][x]). </li><li>Hack the font in a tile editor. </li><li>Replace the font with a 4-bit-per-pixel font. </li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43819 - sabkaraja - Fri May 27, 2005 1:02 am</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
I believe I was not clear enough. When we are loading sprites into the VRAM, I use this method:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//ball is sprite of size (8*8) * 4 frames
<br/>
//box is a sprite of size (32*32)
<br/>
//cat is a sprite of size (64*32) * 5 frames
<br/>
<br/>
//so I load them like this
<br/>
<br/>
#define BALL_VRAM   OBJ_MODE0_VRAM
<br/>
#define BOX_VRAM    BALL_VRAM + (8*8*4) // ball's size
<br/>
#define CAT_VRAM    BOX_VRAM + (32 * 32) // box's size
<br/>
<br/>
//and the CHARS are
<br/>
<br/>
#define BALL_CHAR   (BALL_VRAM - OBJ_MODE0_VRAM)/ 0x20
<br/>
#define BOX_CHAR    (BOX_VRAM -  OBJ_MODE0_VRAM)/ 0x20
<br/>
#define CAT_CHAR    (CAT_VRAM -  OBJ_MODE0_VRAM)/ 0x20</td> </tr></table><span class="postbody">
<br/>
<br/>
In this way I am able to load the images. However I am not sure this is the best method. I would like to listen to the expert comments on this as well.
<br/>
<br/>
Similarly, there must be some way where you can load the images into RAM and place them using some calculation.
<br/>
<br/>
What it might be?
<br/>
<br/>
Regards
<br/>
<br/>
Rajesh</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43830 - tepples - Fri May 27, 2005 2:32 am</h4>
    <div class="postbody"><span class="postbody">These macros should help:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/* Pattern tables
<br/>
<br/>
   For example, tile 137 of pattern table 2 is PATRAM4(2, 137)
<br/>
   or PATRAM8(2, 137) depending on the bitdepth.
<br/>
*/
<br/>
<br/>
#define PATRAM(x) ((u32 *)(0x06000000 | ((x) &lt;&lt; 14)))
<br/>
#define PATRAM4(x, c) ((u32 *)(0x06000000 | (((x) &lt;&lt; 14) + ((c) &lt;&lt; 5)) ))
<br/>
#define PATRAM8(x, c) ((u32 *)(0x06000000 | (((x) &lt;&lt; 14) + ((c) &lt;&lt; 6)) ))
<br/>
#define SPR_VRAM(x) ((u32 *)(0x06010000 | ((x) &lt;&lt; 5)))
<br/>
<br/>
/* Nametables
<br/>
<br/>
They may or may not be called "nametables" in official
<br/>
Nintendo GBA documentation, but because I come from
<br/>
the NES community, and the NES community calls the
<br/>
map data areas "nametables", that's what I call them.
<br/>
<br/>
fedcba9876543210  Text nametable entries
<br/>
||||||||||||||||
<br/>
||||||++++++++++- Tile number
<br/>
|||||+----------- Flip tile horizontally (b &lt;-&gt; d)
<br/>
||||+------------ Flip tile vertically (b &lt;-&gt; P)
<br/>
++++------------- Palette number, that is,
<br/>
                  bits 4-7 of palette index for opaque pixels
<br/>
                  of 16-color tiles
<br/>
<br/>
*/
<br/>
typedef u16 NAMETABLE[32][32];
<br/>
<br/>
#define MAP ((NAMETABLE *)0x06000000)
<br/>
#define MAP_HFLIP      0x0400
<br/>
#define MAP_VFLIP      0x0800
<br/>
#define MAP_FLIP       0x0c00
<br/>
#define MAP_PALETTE(x) ((x) &lt;&lt; 12)</td> </tr></table><span class="postbody">
<br/>
<br/>
Then to access tile number c of CHR base block x, use PATRAM4(x, c) in 16-color mode or PATRAM8(x, c) in 256-color mode. To write to map #n at tile position (x, y), use MAP[n][y][x].<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43875 - sabkaraja - Fri May 27, 2005 3:39 pm</h4>
    <div class="postbody"><span class="postbody">Thanks mate. I will look into it over the weekend</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
