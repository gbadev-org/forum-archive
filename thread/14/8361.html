<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>question about vsync - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > question about vsync</h2>
<div id="posts">
<div class="post">
    <h4>#69642 - deltree - Tue Jan 31, 2006 10:22 pm</h4>
    <div class="postbody"><span class="postbody">hi,
<br/>
I've been wondering about a problem:
<br/>
most people advise me to use the vsync interrupt as a timer.
<br/>
of course, this is a very regular event, it happens 60 times per second, so, it's a good timer.
<br/>
<br/>
but what if I use a function that is too much big, and doesn't complete in time before the next interrupt happends, and call that function again?
<br/>
what if my variables are not updated in time?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69650 - DekuTree64 - Tue Jan 31, 2006 11:02 pm</h4>
    <div class="postbody"><span class="postbody">That's what interrupt handlers are for :)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71066 - SeanMon - Fri Feb 10, 2006 4:38 am</h4>
    <div class="postbody"><span class="postbody">What happens if the VBlank handler doesn't complete before the next VBlank?  Does it call the VBlank handler again while inside of the current one (I don't think so), or does it ignore the new interupt to finish the current one?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71072 - wintermute - Fri Feb 10, 2006 5:36 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SeanMon wrote:</b></span></td> </tr> <tr> <td class="quote">What happens if the VBlank handler doesn't complete before the next VBlank?  Does it call the VBlank handler again while inside of the current one (I don't think so), or does it ignore the new interupt to finish the current one?</td> </tr></table><span class="postbody">
<br/>
<br/>
depends how the interrupts are set up.
<br/>
<br/>
If you allow nesting then the next vbl irq will interrupt the current handler and end up trashing the irq stack. If nesting isn't allowed then the interrupt will be  serviced immediately on return from the current handler.
<br/>
<br/>
With the libgba interrupt dispatcher the irq will be ignored and the vblank handler will no longer be called 60 times a second. It disables the interrupt being serviced and re-enables when the handler has completed.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71078 - DekuTree64 - Fri Feb 10, 2006 6:47 am</h4>
    <div class="postbody"><span class="postbody">Generally you'll want to keep the VBlank interrupt handler small enough that it finishes before the next frame starts drawing, so it's not an issue. 
<br/>
<br/>
Do as much game logic as possible outside VBlank, and queue up any display updates (OAM, BG regs, maybe some VRAM transfers). Once you've finished processing for the frame, set a flag to tell your interrupt handler to do all the display updates next time it fires.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
