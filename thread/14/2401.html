<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Collision map for bricks game - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Collision map for bricks game</h2>
<div id="posts">
<div class="post">
    <h4>#12877 - cooper - Sat Nov 29, 2003 7:51 am</h4>
    <div class="postbody"><span class="postbody">Hello All!
<br/>
<br/>
I'm attmepting to make a breakout type clone, and I've been succesfull at getting the ball to bounce around on the screen, and off the paddel, but now I would like to add some bricks.  I'm familiar with C, C++, but very new to game programming.  From a high level, what would be the best way to do this?  Should each brick be a sprite, then have a collision map for each level?    Or should I do a map with brick tiles, and have an ID set for the bricks?  I've only found the source for one breakout clone on GBA, and unfortunatly it was a bit confusing.  Any suggestions would be greatly appreciated.
<br/>
<br/>
Thanks in advance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12882 - tepples - Sat Nov 29, 2003 3:01 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-style: italic">Arkanoid</span> on the NES and <span style="font-style: italic">Alleyway</span> on the monochrome Game Boy draw the bricks with tiles. Then you can read the tile map to see if the ball has overlapped a brick.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12924 - NeoGeo - Mon Dec 01, 2003 1:17 am</h4>
    <div class="postbody"><span class="postbody">Here is a nice tutorial on collision detection
<br/>
<br/>
<a href="http://www.ahchay.com/ngpcdev/tutorial4.htm" target="_blank">http://www.ahchay.com/ngpcdev/tutorial4.htm</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13115 - sgeos - Fri Dec 05, 2003 7:53 pm</h4>
    <div class="postbody"><span class="postbody">Your display should reflect the contents of your game state.  Your game state should not be stored in the display.  It is not important how you display your blocks.
<br/>
<br/>
I'd use an array of ints for the collision map:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define MAP_W 10
<br/>
#define MAP_H 5
<br/>
<br/>
int cmap[MAP_W * MAP_H];</td> </tr></table><span class="postbody">
<br/>
<br/>
When you start a map, copy the stage data into your array:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">const int stage1[] = {
<br/>
   3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
<br/>
   2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
<br/>
   1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
<br/>
   1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
<br/>
   1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
<br/>
};
<br/>
<br/>
void load_stage(const int *src, int *dst)
<br/>
{
<br/>
   int i;
<br/>
<br/>
   for (i = 0; i &lt; MAP_W * MAP_H; i++)
<br/>
      dst[i] = src[i];
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
When a block gets hit, reduce that member by 1.  The stage map indicates number of hits to destroy the block.  When that number is 0, the block is destroyed:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void hit(int y, int x, int *map)
<br/>
{
<br/>
   if (may[y * MAP_W + x] == NOBREAK_VALUE)  /* Can't break me! */
<br/>
      return;
<br/>
   if (may[y * MAP_W + x])
<br/>
      may[y * MAP_W + x]--;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
By isolating the display code, you can do different things.  3 hits can be yellow, 2 hits red, and one hit blue.  For bonus stages, each block can be a random color, and change to a random color when hit.  Anything else could be done.  My point is that the game state should not be tied to the display.
<br/>
<br/>
I'd used a 16 color text BG for the display.  When you hit a block, I would do this:
<br/>
1) Cover the block with a sprite
<br/>
2) Change the color (palette) of the text BG block
<br/>
3) Make the sprite flash
<br/>
4) Move sprite offscreen to show the block underneath
<br/>
<br/>
If you feel like making things simple, palette 0 could be all balck, that way you do not have to remove an blocks from the map.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13147 - sajiimori - Sat Dec 06, 2003 5:29 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
My point is that the game state should not be tied to the display.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Absolutely.  But we can surely forgive NES developers for being thrifty with their memory usage.  On the other hand, given 144 times as much RAM with the GBA, we have no excuse.  ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13154 - jma - Sat Dec 06, 2003 1:40 pm</h4>
    <div class="postbody"><span class="postbody">While coded in BASIC, perhaps my version of Breakout for Dragon BASIC will help? Check it out at <a href="http://www.jm-basic.com/dragon/code/gallery/breakout.zip" target="_blank">http://www.jm-basic.com/dragon/code/gallery/breakout.zip</a>
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13162 - NeoGeo - Sat Dec 06, 2003 8:30 pm</h4>
    <div class="postbody"><span class="postbody">I could give you the code for my gba game Paddle Panic a four way breakout game I made for the gbadev compo in september. If you want it just mail me :)
<br/>
its just 1000 lines</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13173 - sgeos - Sun Dec 07, 2003 3:49 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
My point is that the game state should not be tied to the display.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Absolutely.  But we can surely forgive NES developers for being thrifty with their memory usage.  On the other hand, given 144 times as much RAM with the GBA, we have no excuse.  ;-)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Actually, I was not responding to tepples comment.  When I was less experienced, I did not realize where the state of a progrom should be stored.  I remember reading an Open GL book and thinking that I could use Open GL to *store* 3D worlds, as oppose to putting them on the screen.  That would be backwards.
<br/>
<br/>
This is what I was responding to:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">... now I would like to add some bricks ... what would be the best way to do this?  Should each brick be a sprite, then have a collision map for each level?</td> </tr></table><span class="postbody">
<br/>
<br/>
Should implies a goal.  What one "should" do depends on one's goals.  To the extent that a single question involving both game state and display was asked, my recommendation is that the display should be kept separate from the game state.  There are a bunch of good ways to add bricks to a game like this.
<br/>
<br/>
-Brendan
<br/>
<br/>
PS 144 times as much RAM?  That is a fair bit more memory.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
