<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sound Engines? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Sound Engines?</h2>
<div id="posts">
<div class="post">
    <h4>#11056 - Wildginger - Wed Sep 24, 2003 8:42 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
What sound engines do you all use?
<br/>
<br/>
In the recent compo, there were some good music in the games, but I struggled to get sound in mine, I got sound effects, but not music. I did it using the odd tutorial here and there, but I see theres lots of engines available.
<br/>
<br/>
Which ones are the best / easiest to use?
<br/>
<br/>
Also, I noticed most of these require you to be using crt0.s and a makefile. I dont, I just use a bat file with the following info in:
<br/>
<br/>
==============================================
<br/>
path=c:\gba development\gba\bin
<br/>
<br/>
<br/>
g++  -o KA.elf CMainGame.cpp main.cpp bg.cpp CSoundEngine.cpp CLevel.cpp cMapFunctions.cpp CLetters.cpp
<br/>
<br/>
objcopy -O binary KA.elf KA.bin
<br/>
pause
<br/>
KA.bin
<br/>
==============================================
<br/>
<br/>
how would I incorporate crt0.s into that? 
<br/>
<br/>
Sorry if this is way basic, but Im not too 'up' on makefiles etc - once upon a time, the above method worked, and then I just went from there.
<br/>
<br/>
Any help would be GREATLY appreciated, and would make Kitchen Acadamy, much better :-)
<br/>
<br/>
Cheers,
<br/>
<br/>
Jim.<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11064 - tepples - Thu Sep 25, 2003 1:34 am</h4>
    <div class="postbody"><span class="postbody">I use the Tri Engine, which is my own original work.  It can be found in <a class="postlink" href="http://www.pineight.com/tod/" target="_blank">TOD</a>.  It mixes Dsound in mono and can play music through Dsound and the GBC channels, but it's not yet ready for public consumption for several reasons, mostly involving lack of stereo mixing support, lack of a graphical music sequence editor (sequences are currently written in a musical assembly language and compiled to my own module format[1]), and lack of time to produce documentation. Once I do get it done, it will be released under the GNU LGPL.
<br/>
<br/>
[1] I didn't "just use S3M" because I wanted something where each voice could have a separate order list so that I didn't have to cut and paste my drum and bass lines every time the melody changed a bit.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11067 - DekuTree64 - Thu Sep 25, 2003 2:37 am</h4>
    <div class="postbody"><span class="postbody">I used Krawall in my compo entry. It's really easy to set up, but it takes quite a bit of IWRAM. AAS (http://www.apex-designs.net/tools_aas.html)is currently the fastest mixer around, and only takes 2.5K IWRAM. The only reason I didn't use it is it only supports 4 channel MODs (8 channels total though, so you still have plenty for SFX), and my song has 8 channels, so I'd suggest checking it out if you don't need bunches of channels in your music.
<br/>
If you try writing your own mixer, beware, it can consume your life very quickly. It's really fun though^_^<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11236 - jd - Mon Sep 29, 2003 7:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">AAS (http://www.apex-designs.net/tools_aas.html) is currently the fastest mixer around, and only takes 2.5K IWRAM. The only reason I didn't use it is it only supports 4 channel MODs (8 channels total though, so you still have plenty for SFX), and my song has 8 channels, so I'd suggest checking it out if you don't need bunches of channels in your music.</td> </tr></table><span class="postbody">
<br/>
<br/>
Just thought I'd write to let you know that AAS has now been expanded to support 1-8 channel MODs, better redundancy checking and a few other things. The latest release can be found here:
<br/>
<br/>
<a class="postlink" href="http://www.apex-designs.net/tools_aas.html" target="_blank">http://www.apex-designs.net/tools_aas.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11254 - Sweex - Tue Sep 30, 2003 11:06 am</h4>
    <div class="postbody"><span class="postbody">I've used AAS in Critical Velocity and it was quite easy to get working. Also fairly easy to play sound effects.<br/>_________________<br/>If everything fails, read the manual: If even that fails, post on forum!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11273 - Wildginger - Tue Sep 30, 2003 9:45 pm</h4>
    <div class="postbody"><span class="postbody">Hi All, 
<br/>
<br/>
Thanks for the replies, ASS looks really good, but I dont use a makefile, and AAS does. It seems to use crt0.s for the callback function or something, and I just cant seem to get crt0.s to be build with my project.
<br/>
<br/>
Can anyone tell me how I can get crt0.s into my project without using a makefile? Or get the required callback working in my project? I tried compiling crt0.s with the rest of my source files but got loads of warnings about multiple definitions.
<br/>
<br/>
I even tried making a new makefile project in VisualC++ using the files in the AASExample, but I got nowhere - Got it building ok, but couldnt get a rom to be built for the life of me.
<br/>
<br/>
As Ive said, Im not clued up on makefiles at all.
<br/>
<br/>
Cheers,<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11307 - jd - Thu Oct 02, 2003 12:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Can anyone tell me how I can get crt0.s into my project without using a makefile? Or get the required callback working in my project? I tried compiling crt0.s with the rest of my source files but got loads of warnings about multiple definitions.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I can't claim to be an expert either, but I'll do my best. Basically, a makefile has a set of rules in it that specify what the "make" tool should do to certain input files and types. To use it, just launch devkitadv, go to the folder with the makefile in it and type "make". Anyway, I had a go at converting the AASExample makefile into a .bat file and this is what I came up with:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
path=c:\devkitadv-r5-beta-3\bin
<br/>
<br/>
conv2aas AAS_Data
<br/>
arm-agb-elf-as -mthumb-interwork -o AAS_Data.o AAS_Data.s
<br/>
<br/>
arm-agb-elf-gcc -mthumb -O3 -ffixed-r14 -funroll-loops -ILibAAS -mthumb-interwork -fomit-frame-pointer -mapcs-32 -mcpu=arm7tdmi -ffast-math -fno-exceptions -fno-rtti -c AASExample.c -o AASExample.o
<br/>
<br/>
arm-agb-elf-gcc -mthumb-interwork -Xlinker -Map map.out -nostartfiles -Tlnkscript -o AASExample.tmp crt0.o AAS_Data.o AASExample.o -LLibAAS -lAAS
<br/>
<br/>
objcopy -O binary AASExample.tmp AASExample.gba
<br/>
pause
<br/>
AASExample.gba
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This code has been tested under devkitadv-r5-beta-3 - you'll need to change the path on your setup. The key differences between this and your make.bat are as follows:
<br/>
<br/>
1) The C/ASM files are being explicitly compiled into different .o files and then linked together. This allows different options to be used depending on what's best for that file. You also need to use the -mthumb-interwork option if you're mixing ARM and thumb code.
<br/>
<br/>
2) The .c files (which by default go into ROM) are being compiled to the thumb instruction set. I believe the default (which was what was being used in your original make.bat) is ARM code, which is very slow when executed from ROM. I'm also passing lots of other options, partially to work around bugs in GCC's thumb output (-ffixed-r14, -mlong-calls), partially to improve performance (-ffast-math, -funroll-loops) and partially to disable features I'm not using (-fno-exceptions, -fno-rtti). You may not want/need some of these options in your project.
<br/>
<br/>
3) At the linking phase, the default start files are being disabled and crt0.s  (compiled to crt0.o) is being used instead. It's also being linked to the AAS library and a map.out file is being produced (this can be used to find out the addresses of your global variables and other useful information).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11425 - Wildginger - Mon Oct 06, 2003 3:26 pm</h4>
    <div class="postbody"><span class="postbody">Hi there,
<br/>
<br/>
Thanks for that reply, its helped a lot and Im on my way now, but Im still not quite there.
<br/>
<br/>
When you run the above batch file, does it build cleanly? At the moment, I am getting a lot of warnings about multiple instances of variables in crt0 (Im not at my PC at the moment, so cant remember exactly), and I also get "undefined reference to main" and undefined reference to "InterruptProcess". Im running this batch file against the example.
<br/>
<br/>
Im trying different things to correct it at the moment, hence my lack of reply over the last few days, but is there anything you can think of that would cause the above? Im sure its something basic and simple Ive missed!
<br/>
<br/>
Thanks again, and I'll keep on trying.
<br/>
<br/>
Jim.<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11428 - jd - Mon Oct 06, 2003 6:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
When you run the above batch file, does it build cleanly?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
At the moment, I am getting a lot of warnings about multiple instances of variables in crt0 (Im not at my PC at the moment, so cant remember exactly), and I also get "undefined reference to main" and undefined reference to "InterruptProcess". Im running this batch file against the example.
<br/>
<br/>
Im trying different things to correct it at the moment, hence my lack of reply over the last few days, but is there anything you can think of that would cause the above? Im sure its something basic and simple Ive missed!
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It sounds like some built-in default startup code is still being linked in, although I'm not sure why that would happen as the "-nostartfiles" option included at the link phase in the makefile/make.bat is supposed to prevent this. Would it be possible to download devkitadv-r5-beta3 and use that instead of your current build environment? The latest version of DevKit Advance is available here:
<br/>
<br/>
<a class="postlink" href="http://devkitadv.sourceforge.net/" target="_blank">http://devkitadv.sourceforge.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11434 - Wildginger - Mon Oct 06, 2003 9:22 pm</h4>
    <div class="postbody"><span class="postbody">Hello again,
<br/>
<br/>
I was actually using devkitadv-r5-beta3, although it didnt have arm-agb-elf-gcc, or at least not in bin directory, so I copied it from previous setup.
<br/>
<br/>
Just to make sure, I downloaded the example again, made a batch file using your above example, and ran it. The output was as follows:
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;path=c:\devkitadv-r5-beta-3\bin
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;conv2aas AAS_Data
<br/>
<br/>
/---------------------------------------------\
<br/>
| Conv2AAS v1.05        WAV, RAW &amp; MOD -&gt; AAS |
<br/>
| Copyright (c) 2003, Apex Designs            |
<br/>
\---------------------------------------------/
<br/>
<br/>
Adding WAV Ambulance.wav...Done!
<br/>
<br/>
Adding RAW Boom.raw...Done!
<br/>
<br/>
Adding MOD FlatOutLies.mod...4 channels...Done!
<br/>
song_length:32 last_pattern:23
<br/>
<br/>
Writing AAS_SampleData (Unique:31 Actual:31 Length:155828)...Done!
<br/>
Writing AAS_PatternData (Unique:63 Actual:96 Length:16128)...Done!
<br/>
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;arm-agb-elf-as -mthumb-interwork -o AAS_Data.o AAS_Data.s
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;arm-agb-elf-as -mthumb-interwork -o crt0.o crt0.s
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;arm-agb-elf-gcc -mthumb -O3 -ffixed-r14 -funroll-loops -ILibAAS -mthumb-interwork -fom
<br/>
it-frame-pointer -mapcs-32 -mcpu=arm7tdmi -ffast-math -fno-exceptions -fno-rtti -c AASExample.c -o AASExample.o
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;arm-agb-elf-gcc -mthumb-interwork -Xlinker -nostartfiles -Tlnkscript -o AASExample.tmp
<br/>
 crt0.o AAS_Data.o AASExample.o -LLibAAS -lAAS
<br/>
crt0.o: In function `_start':
<br/>
crt0.o(.text+0x0): multiple definition of `_start'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x0): fir
<br/>
st defined here
<br/>
crt0.o: In function `__boot_method':
<br/>
crt0.o(.text+0xc4): multiple definition of `__boot_method'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0xc4): fi
<br/>
rst defined here
<br/>
crt0.o: In function `__slave_number':
<br/>
crt0.o(.text+0xc5): multiple definition of `__slave_number'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0xc5): fi
<br/>
rst defined here
<br/>
crt0.o: In function `__FarProcedure':
<br/>
crt0.o(.text+0x186): multiple definition of `__FarFunction'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x25c): f
<br/>
irst defined here
<br/>
crt0.o: In function `__FarProcedure':
<br/>
crt0.o(.text+0x186): multiple definition of `__FarProcedure'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x25c): f
<br/>
irst defined here
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: section .iwram [080340a8
<br/>
 -&gt; 08034a73] overlaps section .rodata [0802d908 -&gt; 080340c7]
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: section .ewram [08034a7c
<br/>
 -&gt; 08035863] overlaps section .jcr [08034a7c -&gt; 08034a7f]
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o: In function `_
<br/>
_crt0_multiboot_start':
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0xe0): un
<br/>
defined reference to `__load_start_footer'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o: In function `_
<br/>
_crt0_reset':
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1c0): u
<br/>
ndefined reference to `__memmap_rom_start'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1d8): u
<br/>
ndefined reference to `__appended_start'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1e4): u
<br/>
ndefined reference to `__load_start_data'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1e8): u
<br/>
ndefined reference to `__load_stop_data'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1f8): u
<br/>
ndefined reference to `__load_start_ewram'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x204): u
<br/>
ndefined reference to `__load_start_iwram'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.footer+0x0): u
<br/>
ndefined reference to `__load_stop_appended'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.footer+0x4): u
<br/>
ndefined reference to `__load_start_appended'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.footer+0x8): u
<br/>
ndefined reference to `__load_stop_appended'
<br/>
collect2: ld returned 1 exit status
<br/>
crt0.o: In function `_start':
<br/>
crt0.o(.text+0x0): multiple definition of `_start'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x0): fir
<br/>
st defined here
<br/>
crt0.o: In function `__boot_method':
<br/>
crt0.o(.text+0xc4): multiple definition of `__boot_method'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0xc4): fi
<br/>
rst defined here
<br/>
crt0.o: In function `__slave_number':
<br/>
crt0.o(.text+0xc5): multiple definition of `__slave_number'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0xc5): fi
<br/>
rst defined here
<br/>
crt0.o: In function `__FarProcedure':
<br/>
crt0.o(.text+0x186): multiple definition of `__FarFunction'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x25c): f
<br/>
irst defined here
<br/>
crt0.o: In function `__FarProcedure':
<br/>
crt0.o(.text+0x186): multiple definition of `__FarProcedure'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x25c): f
<br/>
irst defined here
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: section .iwram [080340a8
<br/>
 -&gt; 08034a73] overlaps section .rodata [0802d908 -&gt; 080340c7]
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: section .ewram [08034a7c
<br/>
 -&gt; 08035863] overlaps section .jcr [08034a7c -&gt; 08034a7f]
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o: In function `_
<br/>
_crt0_multiboot_start':
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0xe0): un
<br/>
defined reference to `__load_start_footer'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o: In function `_
<br/>
_crt0_reset':
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1c0): u
<br/>
ndefined reference to `__memmap_rom_start'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1d8): u
<br/>
ndefined reference to `__appended_start'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1e4): u
<br/>
ndefined reference to `__load_start_data'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1e8): u
<br/>
ndefined reference to `__load_stop_data'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x1f8): u
<br/>
ndefined reference to `__load_start_ewram'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.text+0x204): u
<br/>
ndefined reference to `__load_start_iwram'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.footer+0x0): u
<br/>
ndefined reference to `__load_stop_appended'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.footer+0x4): u
<br/>
ndefined reference to `__load_start_appended'
<br/>
c:\devkitadv-r5-beta-3\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\interwork\crt0.o(.footer+0x8): u
<br/>
ndefined reference to `__load_stop_appended'
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;objcopy -O binary AASExample.tmp AASExample.gba
<br/>
objcopy: AASExample.tmp: No such file or directory
<br/>
<br/>
C:\GBA DEVELOPMENT\AAS\AASExample&gt;pause
<br/>
Press any key to continue . . .
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
All I changed was to add the converting of crt0.s to crt0.o, and I removed map.out option, as it complained about file not found.
<br/>
<br/>
Any ideas? Ive noticed that this time, Im not getting "undefined reference to main" - just quite a few more warnings etc . . .
<br/>
<br/>
I'll keep trying in the mean time, and thanks for your time . . .<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11454 - jd - Tue Oct 07, 2003 7:17 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I was actually using devkitadv-r5-beta3, although it didnt have arm-agb-elf-gcc, or at least not in bin directory, so I copied it from previous setup.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
That's a bad sign - they're definitely included in the archives (I've just checked.) Did you download and install all the archives correctly? The ones I've installed are:
<br/>
<br/>
agb-win-binutils-r5-beta-3.zip
<br/>
agb-win-core-r5-beta-3.zip
<br/>
agb-win-gcc-r5-beta-3.zip
<br/>
agb-win-insight-r5-beta-3.zip
<br/>
agb-win-libstdcpp-r5-beta-3.zip
<br/>
agb-win-newlib-r5-beta-3.zip
<br/>
<br/>
I think "agb-win-insight-r5-beta-3.zip" is optional, I'm not sure about the others. ("agb-win-gcc-r5-beta-3.zip" is the one with arm-agb-elf-gcc in it. All these archives should be extracted to c:\
<br/>
<br/>
Incidentally, since you're now using devkitadv, you can quite easily use the standard makefile by launching devkitadv (double click on "c:\devkitadv-r5-beta-3\devkit-advance-r5-beta-3") cd'ing to the AASExample folder (I recommend installing it in "c:\devkitadv-r5-beta-3\projects\AASExample") and then typing "make". (You'll need to modify "Makefile" slightly so that the "CROSS = /devkitadv/bin/" line reads "CROSS = arm-agb-elf-" instead.) It might be useful to try compiling it this way as it would rule out any mistakes in make.bat as the cause of the problems.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
All I changed was to add the converting of crt0.s to crt0.o, and I removed map.out option, as it complained about file not found.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Not explicitly assembling crt0.s in the make.bat I suggested was a mistake on my part. Having said that, it shouldn't be necessary to remove the map.out option - the cause of this is probably related to the missing files mentioned above.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11463 - Wildginger - Tue Oct 07, 2003 11:15 pm</h4>
    <div class="postbody"><span class="postbody">Well, Im finally there :)
<br/>
<br/>
Not sure what happened with missing files etc, but a reinstall of devkit made sure everything was there.
<br/>
<br/>
I had to comment out gbafix in the makefile, but apart from that, everything now works fine. As for the batch file, that still wont work, but now the makefile setup is working, I'll stick with it.
<br/>
<br/>
My last game was written in c++, and I had a quick go at linking it up with AAS, but I had a few problems, like "undefined reference to InterruptProcess" etc, but as Im starting a new game, I might just go with C for now. Been hacking about with these sound problems for too long now!
<br/>
<br/>
Anyways, cheers jd, you've been a massive help, and AAS looks / sounds excellent. Now for the game . . .<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11475 - jd - Wed Oct 08, 2003 6:11 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I had to comment out gbafix in the makefile, but apart from that, everything now works fine. As for the batch file, that still wont work, but now the makefile setup is working, I'll stick with it.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, sorry, I forgot to mention about removing the reference to gbafix - although I'd recommend installing it if you send a ROM to a publisher as the ROM won't work on a Nintendo cartridge without being gbafixed first.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
My last game was written in c++, and I had a quick go at linking it up with AAS, but I had a few problems, like "undefined reference to InterruptProcess" etc, but as Im starting a new game, I might just go with C for now. Been hacking about with these sound problems for too long now!
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It should be possible to amend the makefile to compile c++ - just add a rule that compiles .cpp files in a similar way to .c files.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11498 - Wildginger - Wed Oct 08, 2003 8:44 pm</h4>
    <div class="postbody"><span class="postbody">So what would I have to change in the make file? Ive changed gcc to g++,
<br/>
added:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
%.o: %.cpp
<br/>
   $(CC) $(DEFAULT) $(INCLUDES) $(CFLAGS) -c $&lt; -o $@</td> </tr></table><span class="postbody">
<br/>
<br/>
and changed the SRC to:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
# Files you want to go in ROM (AAS_Data.o must go first)
<br/>
SRC =   AAS_Data.o CMainGame.o CSoundEngine.o CLetters.o CLevel.o CMapFunctions.o bg.o main_file.o
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
but unforunately Im still getting undefined reference to InterruptProcess and 3 other undefined references. My InterruptProcess() is not in a class, its in main_file.cpp.
<br/>
<br/>
Oh yeah, Ive changed the crt0.s file to include c++ support as well.
<br/>
<br/>
Any ideas? I'll get there one day,
<br/>
<br/>
Jim.
<br/>
<br/>
P.S. heres the output I get:
<br/>
<br/>
<br/>
crt0.o: In function 'intr_main':
<br/>
crt0.o(.iwram+0x8): undefined reference to 'InterruptProcess'
<br/>
<br/>
then I get undefined reference to the following
<br/>
'__appended_end'
<br/>
'__heap_limit'
<br/>
__appended_start
<br/>
<br/>
which are apparantly in function '_sbrk' (agb-<b style="color:#FFA34F">sbrk</b>.o)<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11519 - jd - Thu Oct 09, 2003 5:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
but unforunately Im still getting undefined reference to InterruptProcess and 3 other undefined references. My InterruptProcess() is not in a class, its in main_file.cpp.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You need to declare InterruptProcess as follows to stop C++ from mangling the function's name:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
extern "C" void InterruptProcess()
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wildginger wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
then I get undefined reference to the following
<br/>
'__appended_end'
<br/>
'__heap_limit'
<br/>
__appended_start
<br/>
<br/>
which are apparantly in function '_sbrk' (agb-<b style="color:#FFA34F">sbrk</b>.o)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I guess your C++ code is being linked with agb-<b style="color:#FFA34F">sbrk</b>.o, and this expects "__appended_end", "__heap_limit" and "__appended_start" to be defined in the linkerscript. There's a default one in "C:\devkitadv-r5-beta-3\crtls\lnkscript" but the makefile included with AAS overrides this, hence the problems.
<br/>
<br/>
Assuming you can't stop agb-<b style="color:#FFA34F">sbrk</b>.o from being linked with your project, you'll either need to modify AAS's lnkscript to include these definitions (although exactly what you'll need to set them to I'm not sure) or you'll need to modify the devkitadv lnkscript to include the definitions that AAS needs. (It's annoying that there's so many different lnkscripts floating around.) I've hacked a version together that seems to work, although I can't vouch for it 100%. Use the board's pm feature to let me know your email address if you want me to send it to you.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
