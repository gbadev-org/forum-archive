<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>The pernproject "Scrolling both ways the not so easy wa - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > The pernproject "Scrolling both ways the not so easy wa</h2>
<div id="posts">
<div class="post">
    <h4>#15171 - alek - Sun Jan 18, 2004 3:05 pm</h4>
    <div class="postbody"><span class="postbody">I've been looking at the code for scrolling backgrounds larger than 512x512 in Mode0 found in the pernproject example "Scrolling both ways the not so easy way" and I have not been able to figure out a few things. I've been looking at this code a long time and the map viewer in VisualBoy Advance. I sent a email to dovoto but he hasn't answered so I hope you guys can give me a hand. So the questions I have are:
<br/>
<br/>
1. Why do you have to AND the x and y vule with 31?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
for(loopx = 0; loopx &lt; 31; loopx++)
<br/>
{
<br/>
//this is were the data from our map editor is copied to video memory
<br/>
bgMap[((loopx+x)&amp;31) + (y &amp; 31) * 32] = data[(loopx+x) + (y) * dataw];
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
2. How does the oldy thing work? 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
static int oldy = -1;
<br/>
//do we need to copy in new data?   
<br/>
if(y == oldy)
<br/>
return(0);
<br/>
oldy = y;
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15176 - LOst? - Sun Jan 18, 2004 4:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>alek wrote:</b></span></td> </tr> <tr> <td class="quote">I've been looking at the code for scrolling backgrounds larger than 512x512 in Mode0 found in the pernproject example "Scrolling both ways the not so easy way" and I have not been able to figure out a few things. I've been looking at this code a long time and the map viewer in VisualBoy Advance. I sent a email to dovoto but he hasn't answered so I hope you guys can give me a hand. So the questions I have are:
<br/>
<br/>
1. Why do you have to AND the x and y vule with 31?
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
for(loopx = 0; loopx &lt; 31; loopx++)
<br/>
{
<br/>
//this is were the data from our map editor is copied to video memory
<br/>
bgMap[((loopx+x)&amp;31) + (y &amp; 31) * 32] = data[(loopx+x) + (y) * dataw];
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
ANDing the x anf y value with 31 will make x and y loop between 0 and 31.
<br/>
<br/>
So if x is 32, then x = 0. And if x is 33, then x = 1.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15179 - poslundc - Sun Jan 18, 2004 4:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>alek wrote:</b></span></td> </tr> <tr> <td class="quote">2. How does the oldy thing work?</td> </tr></table><span class="postbody">
<br/>
<br/>
I haven't looked at the Pern code, but my guess is that it's checking to see if the value for your y-position has changed from one frame to the next, so that it will only update if it needs to.
<br/>
<br/>
This works because each frame oldy will contain the value of y from the previous frame. So if the current value of y is the same as the value of y from the previous frame, then no update is necessary. (Otherwise, y has changed from the last frame, so we need to update the map accordingly.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15180 - YopYop - Sun Jan 18, 2004 5:08 pm</h4>
    <div class="postbody"><span class="postbody">(x &amp; 31) is equal to x%32
<br/>
you can replace %nb by &amp;(nb-1) if nb is a 2 powered number  
<br/>
<br/>
<br/>
static int oldy = -1;  // static means that oldy is initialized to -1 only in the first function call (it's like a global variable for the compilo)
<br/>
<br/>
//do we need to copy in new data?    
<br/>
if(y == oldy) //for all function call he verify y
<br/>
return(0); //if y has not change he have nothing to do
<br/>
oldy = y; //but if it chang he update oldy
<br/>
<br/>
//here he may copy in the new data
<br/>
<br/>
I hope it will help you</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15183 - alek - Sun Jan 18, 2004 5:43 pm</h4>
    <div class="postbody"><span class="postbody">So thats what static does. Thanks for the help. 
<br/>
<br/>
Lostr:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">ANDing the x anf y value with 31 will make x and y loop between 0 and 31. 
<br/>
<br/>
So if x is 32, then x = 0. And if x is 33, then x = 1.</td> </tr></table><span class="postbody">
<br/>
I hade figured that much out, why do you have to do it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15184 - LOst? - Sun Jan 18, 2004 6:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>alek wrote:</b></span></td> </tr> <tr> <td class="quote">So thats what static does. Thanks for the help. 
<br/>
<br/>
Lostr:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">ANDing the x anf y value with 31 will make x and y loop between 0 and 31. 
<br/>
<br/>
So if x is 32, then x = 0. And if x is 33, then x = 1.</td> </tr></table><span class="postbody">
<br/>
I hade figured that much out, why do you have to do it?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
You don't need to copy more than 32 tiles on the bg. The rest of the bg will not be visible.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15185 - alek - Sun Jan 18, 2004 6:17 pm</h4>
    <div class="postbody"><span class="postbody">Thanks, now I can go on  with my little project =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15189 - poslundc - Sun Jan 18, 2004 7:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>alek wrote:</b></span></td> </tr> <tr> <td class="quote">So thats what static does. Thanks for the help.</td> </tr></table><span class="postbody">
<br/>
<br/>
Actually, it depends on where the static keyword is used.
<br/>
<br/>
If a variable inside a function is declared as static, it means that the variable's value is retained from one function call to the next. It's like using a global variable, except the scope of the variable is still limited to the function.
<br/>
<br/>
If a global variable or function is declared as static, it is an indicator to the compiler that the variable/function is for internal use only (ie. only accessible by functions in the same C file) and should not be made available to the linker.
<br/>
<br/>
It's one of the wackier little quirks of C syntax that has evolved over the years...
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15193 - alek - Sun Jan 18, 2004 8:39 pm</h4>
    <div class="postbody"><span class="postbody">Appriciate all the help, it has really helped alot.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
