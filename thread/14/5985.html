<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Screen shake effect - any ideas? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Screen shake effect - any ideas?</h2>
<div id="posts">
<div class="post">
    <h4>#45243 - Ultima2876 - Wed Jun 08, 2005 11:58 pm</h4>
    <div class="postbody"><span class="postbody">Is there any good way I can shake the screen using windows or some other method? I wanna make an earthquake type effect, and changing the scroll registers really wouldn't work too well because th sprites wouldn't move... I suppose I could go through changing all the X/Y positions of the sprites (and collisions) too, but obviously if there's a way using something like windowing I'd like to know. Thanks very much.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#45245 - poslundc - Thu Jun 09, 2005 12:13 am</h4>
    <div class="postbody"><span class="postbody">Windows only determine what regions visual elements are displayed in, not where those elements are located. You will have to iterate through your sprites and offset them. Which really shouldn't be a very big deal.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#45246 - ScottLininger - Thu Jun 09, 2005 12:28 am</h4>
    <div class="postbody"><span class="postbody">Well, here's a possible trick, but it's hard to explain.
<br/>
<br/>
If you swap out the screen mode during an hblank, the entire screen will be redrawn starting from the line you are hblanked on. This is a way of "virtually" scrolling the entire screen up and down, sprites and all.
<br/>
<br/>
So let's say that you're using Mode0 for your game. If you want to "shake" the screen vertically, you could do something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void HBLANK(void)
<br/>
{
<br/>
<br/>
  // shakeOffsetY would be set randomly each frame
<br/>
  // to provide the "shake" effect. A value between 0 and 5
<br/>
  // would probably look okay
<br/>
  if (REG_VCOUNT &gt;= shakeOffsetY ) 
<br/>
  {
<br/>
     // set the "standard" game mode
<br/>
     SetMode(MODE_0 | BG3_ENABLE | OBJ_ENABLE | OBJ_MAP_1D); 
<br/>
  } 
<br/>
  else 
<br/>
  {
<br/>
      //set some other mode 
<br/>
      SetMode(MODE_3);  
<br/>
  }
<br/>
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
If combined with some background scroll registers, this would probably be pretty convincing. The sprites wouldn't shake side to side, but they would shake vertically.
<br/>
<br/>
I used this "multiple modes in a single frame" trick to create a mode0 RPG game area on top of the screen and a mode3 dialog area on the bottom, and it was stable under emulation and hardware.
<br/>
<br/>
Cheers,
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#45331 - Ultima2876 - Thu Jun 09, 2005 6:01 pm</h4>
    <div class="postbody"><span class="postbody">Scott,
<br/>
<br/>
It doesn't seem to work... it doesn't start drawing from the beginning when you set the mode to 0, it starts drawing from whatever scanline it is on, so that wouldn't cause the screen to shake, it would just cause the top few scanlines to not be drawn x.x</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
