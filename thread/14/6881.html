<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Strange problem with a pointer - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Strange problem with a pointer</h2>
<div id="posts">
<div class="post">
    <h4>#54282 - Ultima2876 - Sat Sep 17, 2005 6:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int *map_write_x = 0;
<br/>
map_write_x = &amp;columnx1;
<br/>
for(loop = 0; loop &lt; 18; loop++)   //update the tiles at the edge of the screen
<br/>
                     {
<br/>
                        ((u16*)map_vram)[(32 * loop) + columnx1] = ((u16*)map)[(map_width * loop) + *map_position_x];
<br/>
                     }</td> </tr></table><span class="postbody">
<br/>
<br/>
That does exactly what I want it to do.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int *map_write_x = 0;
<br/>
map_write_x = &amp;columnx1;
<br/>
for(loop = 0; loop &lt; 18; loop++)   //update the tiles at the edge of the screen
<br/>
                     {
<br/>
                        ((u16*)map_vram)[(32 * loop) + *map_write_x] = ((u16*)map)[(map_width * loop) + *map_position_x];
<br/>
                     }</td> </tr></table><span class="postbody">
<br/>
<br/>
But this doesn't. I want to have a pointer to columnx1, and reference the pointer instead of the variable itself. (This is because I'll have different columnx's and would rather just change the pointer than have multiple copies of the code). This is only the bit of the code with problems - the rest of the code is pretty big and would just clutter stuff if I put it in this post. The pointer is referenced in the rest of the code too - for example:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">*map_write_x += 1;
<br/>
                  *map_write_x = *map_write_x &amp; 0x1F;</td> </tr></table><span class="postbody">
<br/>
<br/>
That actually does its job - adds 1 to columnx1, and if columnx1 goes above 31 it wraps it to 0.
<br/>
<br/>
But why can't I use the pointer to the variable in my for loop? Is there something I'm missing?
<br/>
<br/>
Thanks in advance =P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54286 - poslundc - Sat Sep 17, 2005 6:52 pm</h4>
    <div class="postbody"><span class="postbody">Your code looks fine, but the problem might not actually be there. Do some kind of debug-print or memory dump to see if the memory values you're getting for ((u16 *)map_vram)[(32 * loop) + columnx1] matches the memory values you're getting for ((u16 *)map_vram)[(32 * loop) + *map_write_x].
<br/>
<br/>
If you get the same values, it's an indicator that your problem is elsewhere in source, and this is just a symptom of the problem, not the source of the problem itself.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54289 - Ultima2876 - Sat Sep 17, 2005 7:13 pm</h4>
    <div class="postbody"><span class="postbody">Aha. It turns out that for some reason I had columnx1 as a u8. I use ints all the time now, but I'm actually rehashing some code that I wrote when I was just starting out.
<br/>
<br/>
That helped enormously, thanks very much.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54452 - Miked0801 - Mon Sep 19, 2005 5:13 pm</h4>
    <div class="postbody"><span class="postbody">Reason 102849 not to use u8s unless you really really mean it :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
