<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Help with sticking stuff into the BGPalatte memory - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Help with sticking stuff into the BGPalatte memory</h2>
<div id="posts">
<div class="post">
    <h4>#55630 - BrokenMemories - Fri Sep 30, 2005 3:46 am</h4>
    <div class="postbody"><span class="postbody">Okay I'm doing the gbajunkie tutorials but using devkitARM and the header files that come with dkARM.
<br/>
<br/>
Now this is the code that comes with the tutorial
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void PlotPixel(int x,int y, unsigned short int c)
<br/>
{
<br/>
   VideoBuffer[(y) * 120 + (x)] = (c);
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
   int loop;
<br/>
   int x, y;
<br/>
<br/>
        SetMode(MODE_4 | BG2_ENABLE);                //set mode 4 and enable background 2
<br/>
<br/>
   for(loop = 0; loop &lt; 256; loop++)                    //256 entries allowed
<br/>
      BGPaletteMem[loop] = junkiePalette[loop];       //load the palette into palette memory
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
      for(y = 0; y &lt; 160; y++)                       //screen height
<br/>
      {
<br/>
         for(x = 0; x &lt; 120; x++)                   //screen width
<br/>
         {
<br/>
            PlotPixel(x,y, junkieData[y*120+x]);   //load image data into
<br/>
         }                                 //memory pixel by pixel
<br/>
      }
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
relevent (i think) headers stuff
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
u16* BGPaletteMem    =(u16*)0x5000000;
<br/>
u16* VideoBuffer       =(u16*)0x6000000;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
junkiePalette is a .h file with the bin data for an image.
<br/>
<br/>
anyways what I gather from this code is that BGPaletteMem is a memory address, right? and then he just  pipes the data from junkiePalette straight into it. What I want to know is what is the relative #define in the DevKitARM headers (they are funny to read, sorry for being such a newb)
<br/>
<br/>
what does this mean, (form gba_video of dkA libgba)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define BG_PALETTE(m)      ((m)&lt;&lt;12)</td> </tr></table><span class="postbody">
<br/>
<br/>
If I get this right, thats a macro that says what ever 'm' is, do something to 'm' by using &lt;&lt;12. What I want to know is what does  &lt;&lt;12 mean. All of the devKitARM headers use it eg
<br/>
<br/>
snipit from gba_video.h from libgba of dkA
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define BACKBUFFER   (1&lt;&lt;4)   // buffer display select
<br/>
#define OBJ_1D_MAP   (1&lt;&lt;6)   // sprite 1 dimensional mapping
<br/>
#define   LCDC_OFF   (1&lt;&lt;7)   // LCDC OFF
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm assuming it is short hand for memory/register addresses, I just dont know how to read it into 0x05000200 etc.
<br/>
<br/>
thanks in advance to replys :-)
<br/>
<br/>
~BM~</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55634 - BrokenMemories - Fri Sep 30, 2005 4:19 am</h4>
    <div class="postbody"><span class="postbody">Okay I figured out that 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
u16* BGPaletteMem    =(u16*)0x5000000;
<br/>
u16* VideoBuffer       =(u16*)0x6000000;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
from junkies tuts is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define BG_COLORS      ((u16 *)0x05000000)
<br/>
<br/>
//and VideoBuffer can be made by adding this too gba_video.h
<br/>
<br/>
#define VRAM_CTRL      ((u16 *)VRAM)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Still lost to what the
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define XDEFINED         (1&lt;&lt;12)</td> </tr></table><span class="postbody">
<br/>
<br/>
etc means
<br/>
<br/>
~BM~</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55635 - BrokenMemories - Fri Sep 30, 2005 4:25 am</h4>
    <div class="postbody"><span class="postbody">Oh and this is the modified code should anyone want it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//////////////////////////////////////////////////////////////////////////
<br/>
// File:    imagedisp.                                                  //
<br/>
// Description: A program that displays an image on the GBA            //
<br/>
// Author:   gbajunkie (with lots of code from dovoto)               //
<br/>
//         slightly modified my BrokenMemories for DevKitARM         // 
<br/>
//   Date:    15th March 2002                                            //
<br/>
//////////////////////////////////////////////////////////////////////////
<br/>
<br/>
#include &lt;gba_base.h&gt;
<br/>
#include &lt;gba_types.h&gt;
<br/>
#include &lt;gba_video.h&gt;
<br/>
#include "junkie.h"   //holds the image information in an array
<br/>
<br/>
void PlotPixel(int x,int y, unsigned short int c)
<br/>
{
<br/>
   VRAM_INPUT[(y) * 120 + (x)] = (c);
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
   int loop;
<br/>
   int x, y;
<br/>
<br/>
        SetMode(MODE_4 | BG2_ENABLE);                //set mode 4 and enable background 2
<br/>
<br/>
   for(loop = 0; loop &lt; 256; loop++)                    //256 entries allowed
<br/>
      BG_COLORS[loop] = junkiePalette[loop];       //load the palette into palette memory
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
      for(y = 0; y &lt; 160; y++)                       //screen height
<br/>
      {
<br/>
         for(x = 0; x &lt; 120; x++)                   //screen width
<br/>
         {
<br/>
            PlotPixel(x,y, junkieData[y*120+x]);   //load image data into
<br/>
         }                                 //memory pixel by pixel
<br/>
      }
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55640 - tepples - Fri Sep 30, 2005 5:02 am</h4>
    <div class="postbody"><span class="postbody">The &lt;&lt; operator means a binary shift to the left. For example, 1 &lt;&lt; 12 is 1 shifted to the left 12 places, or 0001000000000000(binary) = 4096.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
