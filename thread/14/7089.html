<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>BG with Sprites at different priorities - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > BG with Sprites at different priorities</h2>
<div id="posts">
<div class="post">
    <h4>#56394 - wiz - Sat Oct 08, 2005 12:58 pm</h4>
    <div class="postbody"><span class="postbody">Hello!
<br/>
<br/>
I'm not entirely sure if this is curable, but here is the problem;
<br/>
<br/>
I have a screen in mode 4, which displays a picture.  I also have moving sprites on the screen, some are set to be behind the picture and some are infront.  All that works correctly but when a sprite "behind" and a sprite "infront" of the picure enter the same coordinates you can see the sprite which is "behind" the picture appear in front of the picure (but still behind the top sprite)
<br/>
<br/>
Hopefully that makes sense, is this a known problem and is it fixable?
<br/>
<br/>
Thanks!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56406 - tepples - Sat Oct 08, 2005 4:25 pm</h4>
    <div class="postbody"><span class="postbody">Are you making sure that the sprite in front has a lower index in OAM than the sprite in back?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56496 - gauauu - Sun Oct 09, 2005 2:42 am</h4>
    <div class="postbody"><span class="postbody">tepples:  do you mean that when sprites overlap, the index in OAM takes precedence over the sprite priority you set?  I'm a little confused.....</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56501 - tepples - Sun Oct 09, 2005 3:09 am</h4>
    <div class="postbody"><span class="postbody">Yes, the OAM index takes precedence over the sprites' background priority when two sprites overlap. The 2-bit priority is used only for sprite-background interactions.
<br/>
<br/>
Here's a model for how the compositor works on the NES, the Super NES, and the GBA: <ol type="1"><li>Sort all backgrounds from front to back based on their priority. </li><li>Render backgrounds, preserving each pixel's priority in a Z-buffer. </li><li>Render sprites in OAM index order with lower-numbered sprites on top, preserving each sprite pixel's priority in a Z-buffer. </li><li>Combine the two buffers, putting the frontmost background pixel in front if it has a lower-numbered priority than the frontmost sprite pixel. </li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56510 - gauauu - Sun Oct 09, 2005 6:25 am</h4>
    <div class="postbody"><span class="postbody">Interesting....slightly non-intuitive, and different than some of the tutorials describe, but good to know.  
<br/>
<br/>
Thanks for the detailed description!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56533 - wiz - Sun Oct 09, 2005 1:54 pm</h4>
    <div class="postbody"><span class="postbody">oh! err, yes that fixed it !  one thing I forgot to mention in my original post was the sprites are double sized and scaling etc, which is where I thought the problem was coming from.  but nope, as it now works fine!
<br/>
<br/>
thanks for the great explanation too :)
<br/>
<br/>
*smacks head*</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
