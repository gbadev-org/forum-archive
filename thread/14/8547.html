<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem with VHam and gfx2gba... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Problem with VHam and gfx2gba...</h2>
<div id="posts">
<div class="post">
    <h4>#71444 - Nave Adair - Sun Feb 12, 2006 11:17 pm</h4>
    <div class="postbody"><span class="postbody">I've been into GBA development lately (been doing othe languages for about a year, but I just started HAM). I'm working on a pong game to get used to it, and I'm not having any problems with the programming. However, I'm having trouble with the graphics I'm converting with gfx2gba. Somewhere along the way, something messes them up, expecially the ball's sprite.
<br/>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/ball.bmp" target="_blank">Ball sprite.</a>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/gfx2gba.html" target="_blank">Conversion code</a>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/ballpalc.txt" target="_blank">ball.pal.c</a>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/ballrawc.txt" target="_blank">ball.raw.c</a>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/intmain.txt" target="_blank">int main()</a>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/PongGBa.gba" target="_blank">GBA file to see how ball shows up.</a>
<br/>
<br/>
Anyone who can tell me where it was messed up and how to fix it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71451 - Cearn - Sun Feb 12, 2006 11:54 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-style: italic">Note, I am not a HAM expert</span>
<br/>
<br/>
The reason the ball is off is because you're converting it as a bitmap, rather than as tiles. I believe you should use '-t8' rather that '-t1' for that.
<br/>
<br/>
Also, you only have one object palette of 256 colors that is shared by all sprites. By using ham_LoadObjPal twice, you're overwriting the what you did with the first call.
<br/>
<br/>
Ham's text services work only for tiles text, i.e., not modes 3,4,5.
<br/>
<br/>
Why most of object VRAM is filled with 0x01's is still a bit of a mystery to me, though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71453 - Nave Adair - Mon Feb 13, 2006 12:02 am</h4>
    <div class="postbody"><span class="postbody">It looks more like a ball, but it is still off.
<br/>
<br/>
<a class="postlink" href="http://naveadair.mobius-x.com/PongGBa.gba" target="_blank">Almost there... any other ideas?</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71459 - Cearn - Mon Feb 13, 2006 12:39 am</h4>
    <div class="postbody"><span class="postbody">I'm guessing <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/bitmaps.htm#sec-data" target="_blank">data alignment</a>.
<br/>
<br/>
From what I can tell, the sprite data is put at 0201:913E, which is a valid halfword address, but not a valid word address. HAM uses a 32bit DMA to copy in the data, which screws up because of the mis-alignment.
<br/>
<br/>
I'll take a wild stab and assume you're #including the data arrays, rather than linking them separately? That, combined with using non-word arrays is a recipe for disaster. So don't do that then.
<br/>
<br/>
Alternatively, use the '-align' flag. I think that may fix it as well.
<br/>
<br/>
Do a search for alignment here. This problem crops up from time to time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71466 - Nave Adair - Mon Feb 13, 2006 1:24 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">Alternatively, use the '-align' flag. I think that may fix it as well.</td> </tr></table><span class="postbody">
<br/>
<br/>
That worked <span style="font-weight: bold">perfectly</span>, thank you for all the help!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
