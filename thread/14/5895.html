<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Blank Screen Problem - Have read the FAQ - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Blank Screen Problem - Have read the FAQ</h2>
<div id="posts">
<div class="post">
    <h4>#44279 - Kris_Allen - Tue May 31, 2005 5:21 pm</h4>
    <div class="postbody"><span class="postbody">Hiya,
<br/>
<br/>
I know this has probably been posted a lot already but I've got this blank screen problem. I've read a few other posts, and the FAQ, but still can't seem to solve the problem.
<br/>
<br/>
Here's my code. I've been using the headers that come with the PERN tutorial, but for the sake of pasting here I'm just plucking out the definitions that I'm using. I'm also using pretty much the same code from the tutorial.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef unsigned char u8;
<br/>
typedef unsigned short u16;
<br/>
typedef unsigned long u32;
<br/>
<br/>
typedef volatile unsigned  char vu8;
<br/>
typedef volatile unsigned  short vu16;
<br/>
typedef volatile unsigned  long vu32;
<br/>
<br/>
#define VideoBuffer    ((u16*)0x6000000)
<br/>
<br/>
#define SCREEN_WIDTH 240 
<br/>
#define SCREEN_HEIGHT 160 
<br/>
<br/>
#define BIT(n) (1&lt;&lt;(n))
<br/>
<br/>
#define BG0_ENABLE      BIT(0x8)
<br/>
#define BG1_ENABLE      BIT(0x9) 
<br/>
#define BG2_ENABLE      BIT(0xA)
<br/>
#define BG3_ENABLE      BIT(0xB)
<br/>
#define OBJ_ENABLE      BIT(0xC) 
<br/>
<br/>
#define SetMode(mode) REG_DISPCNT = (mode) 
<br/>
<br/>
#define REG_DISPCNT         (*(vu32*)0x4000000)
<br/>
<br/>
#define RGB16(r,g,b)  ((r)|((g)&lt;&lt;5)|((b)&lt;&lt;10))
<br/>
<br/>
//--------------
<br/>
<br/>
<br/>
int main() {
<br/>
<br/>
   unsigned char x,y;  
<br/>
<br/>
   SetMode(3 | BG2_ENABLE);    
<br/>
<br/>
   for(x = 0; x &lt; SCREEN_WIDTH; x++) {
<br/>
       for(y = 0; y &lt; SCREEN_HEIGHT; y++) {  
<br/>
           VideoBuffer [x+y*SCREEN_WIDTH] = RGB16(31,0,0); 
<br/>
      }
<br/>
   }
<br/>
   while(1) {
<br/>
      
<br/>
   }
<br/>
 }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This is my compile batch file:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
set PATH=d:\dev\gba\devkitarm\bin\
<br/>
arm-elf-gcc -Wall -mthumb -mthumb-interwork -specs=gba_mb.specs test.cpp -o test.elf
<br/>
arm-elf-objcopy -v -O binary test.elf test.gba
<br/>
gbafix test.gba
<br/>
pause
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Compiling works fine, and as you can see I haven't forgotten the thumb/interwork options.
<br/>
<br/>
Any ideas? 
<br/>
<br/>
Thanks,
<br/>
Kris.
<br/>
<br/>
Edit: Well, that's odd. I switched to DevKitAdv out of curiosity and changed my batch to this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
@echo off
<br/>
set PATH=d:\dev\gba\devkitadv\bin\
<br/>
arm-agb-elf-gcc -Wall -mthumb -mthumb-interwork test.cpp -o test.elf
<br/>
arm-agb-elf-objcopy -v -O binary test.elf test.gba
<br/>
del test.elf
<br/>
pause
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
... And now it works fine!! Why is this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44288 - strager - Tue May 31, 2005 5:52 pm</h4>
    <div class="postbody"><span class="postbody">Use int's instead on u8's for the loop, although it doesn't relate to the question...
<br/>
<br/>
Change (*(vu32 *)...) to (*(vu16 *)...).
<br/>
<br/>
In your compiling process: That's correct, but unhealthy.  I use this for DevKitAdv:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#
<br/>
# MAKEFILE
<br/>
#
<br/>
<br/>
# Variables
<br/>
CC=gcc
<br/>
CCFLAGS=-mthumb-interwork ${DEBUG} -DMULTIBOOT
<br/>
DEBUG=
<br/>
ELFFLAGS=-nostartfiles -nostdlib -Wl,-T,lnkscript -w 
<br/>
OBJFLAGS=-c -g -w
<br/>
OBJS=crt0.o main.o
<br/>
<br/>
# Compiles
<br/>
all: gba.gba
<br/>
<br/>
clean:
<br/>
   rm ${OBJS} ${GBA}.elf
<br/>
<br/>
gba.gba: gba.elf
<br/>
   objcopy -v -O binary -S ${GBA}.elf ${GBA}.gba
<br/>
<br/>
gba.elf: ${OBJS}
<br/>
   ${CC} ${CCFLAGS} ${ELFFLAGS} -o gba.elf ${OBJS} ${LIBS}
<br/>
<br/>
crt0.o: crt0.s
<br/>
   ${CC} ${CCFLAGS} ${OBJFLAGS} -o crt0.o crt0.s
<br/>
<br/>
main.o: main.c
<br/>
   ${CC} ${CCFLAGS} ${OBJFLAGS} -o main.o main.c
<br/>
<br/>
<br/>
<br/>
REM
<br/>
REM BATCHFILE
<br/>
REM
<br/>
<br/>
@echo off
<br/>
make
<br/>
pause
<br/>
<br/>
gbarm.exe -v gba.gba
<br/>
pause
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Filelist:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
(source code files).c/.s
<br/>
crt0.s
<br/>
gbarm.exe
<br/>
Makefile
<br/>
make.bat
<br/>
lnkscript
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Maybe you should replace gbarm with gbafix...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44293 - Lord Graga - Tue May 31, 2005 6:41 pm</h4>
    <div class="postbody"><span class="postbody">Don't use DevkitAdvance, it's outdated. Use DevkitARM instead.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44305 - Kris_Allen - Tue May 31, 2005 7:18 pm</h4>
    <div class="postbody"><span class="postbody">yeah, I would if I could get it to work
<br/>
<br/>
edit: strager: I've tried setting all the options to how you've specified but it still seems to do it. Anything else it could be?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44306 - strager - Tue May 31, 2005 7:20 pm</h4>
    <div class="postbody"><span class="postbody">Can you upload your compilation?  I may be able to look at it in VBA.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44307 - Kris_Allen - Tue May 31, 2005 7:28 pm</h4>
    <div class="postbody"><span class="postbody">Of course. Thanks. <a class="postlink" href="http://kris.acsv.net/TestGame.zip" target="_blank">http://kris.acsv.net/TestGame.zip</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44320 - strager - Tue May 31, 2005 8:25 pm</h4>
    <div class="postbody"><span class="postbody">It seems that you are not compiling/linking your crt0 script.  Make sure it is FIRST in the list of objects, or it will not work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44322 - Kris_Allen - Tue May 31, 2005 8:41 pm</h4>
    <div class="postbody"><span class="postbody">Ahh... thanks, I didn't actually know about that. I'll have to go and learn about it</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
