<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>screen redraw is slow, any suggestions please? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > screen redraw is slow, any suggestions please?</h2>
<div id="posts">
<div class="post">
    <h4>#47056 - solarwind__ - Mon Jul 04, 2005 5:28 pm</h4>
    <div class="postbody"><span class="postbody">i have created a program which draws a little blue rectange (10x20 px) in the topleft corner of the gba emulator window. I have used user input (currently only two keys, up and down) to move the little blue rectangle up and down on the screen. The program works but to animate the little blue rectangle, i had to repaint the screen black to prevent the blue rectangle from drawing like a pencil =|. If you understand what I mean. Anyway, the screen repainting is very slow and every time i press the down or up key. the block moves but is very slow due to the screen repainting. 
<br/>
<br/>
If anyone has any suggestions on how to improve speed or even accomplish the same task which is to (create a little blue rectangle and move up or down the screen when the user press the up or down key) using a different method, i would greatly appreciate it.
<br/>
<br/>
Here is my code 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//GBA resolution is 240 x 160
<br/>
<br/>
#include "keypad.h"
<br/>
<br/>
#define RGB16(r,g,b)  ((r)+(g&lt;&lt;5)+(b&lt;&lt;10)) 
<br/>
<br/>
int main()
<br/>
{
<br/>
   char x;
<br/>
   char y;
<br/>
   char a; // something like char x
<br/>
   char b; // something like char y
<br/>
   char v = 0; //variable that keeps track of the little blue square on the vertical line
<br/>
   char h = 0; //variable that keeps track of the little blue square on the horizontal line
<br/>
   
<br/>
   char k = 5;
<br/>
   char l = 15;
<br/>
   unsigned short* Screen = (unsigned short*)0x6000000; 
<br/>
   *(unsigned long*)0x4000000 = 0x403; // mode3, bg2 on 
<br/>
<br/>
   for (x = 0; x &lt; 240; x++) //starts off with a black screen
<br/>
      {
<br/>
         for (y = 0; y &lt; 160; y++)
<br/>
            {
<br/>
               Screen[x+y*240] = RGB16(0,0,0);
<br/>
<br/>
            }
<br/>
         
<br/>
      }
<br/>
<br/>
<br/>
<br/>
<br/>
   
<br/>
   while(1)
<br/>
   {
<br/>
<br/>
<br/>
<br/>
         if(!((*KEYS) &amp; KEY_DOWN))
<br/>
         {
<br/>
<br/>
<br/>
               for (x = 0; x &lt; 240; x++)
<br/>
               {
<br/>
                  for (y = 0; y &lt; 160; y++)
<br/>
                  {
<br/>
                  Screen[x+y*240] = RGB16(0,0,0);
<br/>
<br/>
                  }
<br/>
         
<br/>
               }
<br/>
<br/>
<br/>
            k = k + 15;
<br/>
            l = l + 15;
<br/>
         
<br/>
<br/>
                        for (a = 0; a &lt; 20; a++)
<br/>
            {   
<br/>
            
<br/>
               
<br/>
               for (b = k; b &lt; l; b++)
<br/>
               {
<br/>
               Screen[a+b*240] = RGB16(0,0,30);
<br/>
            
<br/>
               
<br/>
               }
<br/>
         
<br/>
            }   
<br/>
<br/>
            
<br/>
         }  
<br/>
<br/>
// ==============================================================================
<br/>
<br/>
<br/>
         if(!((*KEYS) &amp; KEY_UP))
<br/>
         {
<br/>
<br/>
<br/>
               for (x = 0; x &lt; 240; x++)
<br/>
               {
<br/>
                  for (y = 0; y &lt; 160; y++)
<br/>
                  {
<br/>
                  Screen[x+y*240] = RGB16(0,0,0);
<br/>
<br/>
                  }
<br/>
         
<br/>
               }
<br/>
<br/>
<br/>
            k = k - 15;
<br/>
            l = l - 15;
<br/>
         
<br/>
<br/>
                        for (a = 0; a &lt; 20; a++)
<br/>
            {   
<br/>
            
<br/>
               
<br/>
               for (b = k; b &lt; l; b++)
<br/>
               {
<br/>
               Screen[a+b*240] = RGB16(0,0,30);
<br/>
            
<br/>
               
<br/>
               }
<br/>
         
<br/>
            }   
<br/>
         }
<br/>
<br/>
<br/>
            
<br/>
            
<br/>
<br/>
   }
<br/>
<br/>
<br/>
}
<br/>
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I would greatly appreciate it if anyone could supply the code to accomplish the same task even with a completly different method but any suggestions are a big help. 
<br/>
<br/>
THANKS in advace<br/>_________________<br/>#solarwind</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47057 - poslundc - Mon Jul 04, 2005 5:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>solarwind__ wrote:</b></span></td> </tr> <tr> <td class="quote">If anyone has any suggestions on how to improve speed or even accomplish the same task which is to (create a little blue rectangle and move up or down the screen when the user press the up or down key) using a different method</td> </tr></table><span class="postbody">
<br/>
<br/>
Sure, use a sprite. That's what they're there for, and you won't have to redraw anything.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47069 - Quirky - Mon Jul 04, 2005 7:24 pm</h4>
    <div class="postbody"><span class="postbody">After that, try it with a bg layer, a tile and the scroll registers. You'll then have a good basic knowledge of the GBA graphics hardware.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47073 - solarwind__ - Mon Jul 04, 2005 8:22 pm</h4>
    <div class="postbody"><span class="postbody">thanks  a lot but what is a sprite? and where can i learn more about them?<br/>_________________<br/>#solarwind</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47074 - solarwind__ - Mon Jul 04, 2005 8:24 pm</h4>
    <div class="postbody"><span class="postbody">i have heard about sprites but had trouble learning about them, if anyone of you can post some links or tell me where i can go to learn more about them, it would be great.
<br/>
<br/>
thanks a lot in advance...<br/>_________________<br/>#solarwind</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47090 - poslundc - Tue Jul 05, 2005 1:52 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://thepernproject.com/tutorials/GBA/day_3.html" target="_blank">http://thepernproject.com/tutorials/GBA/day_3.html</a>
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
