<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Garbled mess... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Garbled mess...</h2>
<div id="posts">
<div class="post">
    <h4>#46479 - GarrettVD - Sat Jun 25, 2005 8:28 pm</h4>
    <div class="postbody"><span class="postbody">I just started to learn how to develop for the GBA the other day, and I am having a spot of trouble on getting my map to show up. I am experimenting with the code from Ch. 6a of the GBAJunkie tutorials, about setting up a background. I tried to input my own BG that I made in Map Ed v0.98.5, but I am having some trouble getting it to display. What I get is a garbled mess of random tiles. Most of which I am sure aren't even on the tilemap itself. I've included code, and at the moment I am pretty much stumped. Any help would be great. Thanks.
<br/>
<br/>
Files: <a href="http://emw.onewinged.org/garbledmess.zip" target="_blank">http://emw.onewinged.org/garbledmess.zip</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46555 - Cearn - Mon Jun 27, 2005 9:30 am</h4>
    <div class="postbody"><span class="postbody">The main reason it looks garbled is that the exported map uses 16colors, while the background is set up for 256. Changing that will show recognizable tiles, but even then there seems to be something funny with the palettes. 
<br/>
<br/>
If you're wondering why it takes a while before anything shows up, it's busy filling the SIN/COS tables. Do <span style="font-style: italic">not</span> use floating point unless you absolutely have to, and even then its often possible to fake them using fixed point. Something similar goes for variables and array-types/casts: the GBA is a 32bit machine, int/u32 can work twice as fast as u16.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46560 - tepples - Mon Jun 27, 2005 1:02 pm</h4>
    <div class="postbody"><span class="postbody">In general, the sin/cos tables are best done at compile time. Use a PC based program to create fixed-point sin/cos tables and write them to a .c file, then compile that .c file into your GBA project.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46598 - GarrettVD - Mon Jun 27, 2005 9:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">The main reason it looks garbled is that the exported map uses 16colors, while the background is set up for 256. Changing that will show recognizable tiles, but even then there seems to be something funny with the palettes. 
<br/>
<br/>
If you're wondering why it takes a while before anything shows up, it's busy filling the SIN/COS tables. Do <span style="font-style: italic">not</span> use floating point unless you absolutely have to, and even then its often possible to fake them using fixed point. Something similar goes for variables and array-types/casts: the GBA is a 32bit machine, int/u32 can work twice as fast as u16.</td> </tr></table><span class="postbody">
<br/>
<br/>
I took out the whole SIN/COS thing. I really don't need rotating backgrounds etc. at this point in time. I just made a new map in MapEd, exported it, and got the three files (palette, tiles, and map). I changed the colour from 256 to 16, and you are right, I do see some recognizable tiles, but the palette or tile files must be screwed up somehow. Why is this? And is there another way to generate a tile or palette file? (Depending on whichever is screwed up). Thanks for your help this far guys.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46830 - GarrettVD - Fri Jul 01, 2005 4:46 am</h4>
    <div class="postbody"><span class="postbody">...Anyone???</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46848 - poslundc - Fri Jul 01, 2005 6:29 am</h4>
    <div class="postbody"><span class="postbody">Use the various debugging tools in GBA (tile viewer, etc.) to see if the contents of VRAM match what you expect them to be. Other than that, I've not used MapEd so I can't comment on what it outputs.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46884 - GarrettVD - Fri Jul 01, 2005 7:18 pm</h4>
    <div class="postbody"><span class="postbody">There are debugging tools in the GBA itself? Oh boy I feel stupid, I never knew :p How do you access them?
<br/>
<br/>
EDIT: Now that I come to think of it, I want to know what tools everyone else uses to make maps, and convert tiles into .cpp/.h files etc. Any recommendations? MapEd isn't working out for me as I thought it would.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46891 - poslundc - Fri Jul 01, 2005 8:46 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, I meant VBA, not GBA.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46968 - GarrettVD - Sat Jul 02, 2005 8:00 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, I've narrowed it down to just my tiles being screwed... I don't know why. I converted the BMP to palette/raw data in GFX2GBA, so it should technically work fine...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46984 - LOst? - Sun Jul 03, 2005 3:15 am</h4>
    <div class="postbody"><span class="postbody">GarrettVD, the problem with MapEd and other tools are that they forget to add <span style="font-weight: bold">const</span> in front of the arrays.
<br/>
<br/>
Always add <span style="font-weight: bold">const</span> in front of the palette, map, and tile data, as well as the pre-calced sine tables.
<br/>
<br/>
Example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const u16 array_in_rom [size] = {0, 0, 0};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
const will store the data in ROM space and not in RAM. GBA has very limited RAM size. Adding const will also fix the garbled mess.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
