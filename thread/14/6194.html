<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>A linker error building some GBA examples - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > A linker error building some GBA examples</h2>
<div id="posts">
<div class="post">
    <h4>#46861 - avelino - Fri Jul 01, 2005 11:52 am</h4>
    <div class="postbody"><span class="postbody">Hi, all, I am ussing devkitpro (release 13) and followed all installation instructions on my Linux box but I am getting a linker error compiling the PCXView example for GBA:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">splash.pcx
<br/>
pcx_view.c
<br/>
linking multiboot
<br/>
pcx_view.o: In function `main':
<br/>
/root/gba/examples/gba/PCXView/src/pcx_view.c:56: undefined reference to
<br/>
`splash_pcx'
<br/>
collect2: ld returned 1 exit status
<br/>
make[1]: *** [/root/gba/examples/gba/PCXView/PCXView_mb.elf] Error 1
<br/>
make: *** [build] Error 2
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
With the PlayBoyScout example there is a simmilar error:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">ScoutSplash.pcx
<br/>
tune.bgf
<br/>
PlayBoyScout.c
<br/>
linking multiboot
<br/>
PlayBoyScout.o: In function `main':
<br/>
/root/gba/examples/gba/PlayBoyScout/source/PlayBoyScout.c:74: undefined
<br/>
reference to `tune_bgf'
<br/>
/root/gba/examples/gba/PlayBoyScout/source/PlayBoyScout.c:74: undefined
<br/>
reference to `ScoutSplash_pcx'
<br/>
collect2: ld returned 1 exit status
<br/>
make[1]: *** [/root/gba/examples/gba/PlayBoyScout/PlayBoyScout_mb.elf]
<br/>
Error 1
<br/>
make: *** [build] Error 2
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I think that it could be a bin2o related problem because that program converts pcx/binary files to object ones. By the way, the "mbv2print" example compiles and links ok but when I run the "sprite.gba" generated using que "VisualBoyAdvance", the result is a white screen in the emulator (no text displayed) . Please, help.
<br/>
<br/>
Thanks in advance.<br/>_________________<br/>Avelino Herrera Morales
<br/>
<a class="postlink" href="http://avelino.gabiot.com" target="_blank">http://avelino.gabiot.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46877 - Fatnickc - Fri Jul 01, 2005 5:58 pm</h4>
    <div class="postbody"><span class="postbody">Perhaps, for the second one, try replacing the '_'s with '.'s.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46908 - tepples - Fri Jul 01, 2005 11:04 pm</h4>
    <div class="postbody"><span class="postbody">Most of the 'bin2*' utilities transform filename dots into underscores because unlike the dot, the underscore works in a C symbol name. And it might be spitting out a symbol name other than what you expect; try using the 'nm' command on the .o file.
<br/>
<br/>
What command is executed under 'linking multiboot'?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47016 - avelino - Sun Jul 03, 2005 2:10 pm</h4>
    <div class="postbody"><span class="postbody">Hi all
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Most of the 'bin2*' utilities transform filename dots into underscores because unlike the dot, the underscore works in a C symbol name. And it might be spitting out a symbol name other than what you expect; try using the 'nm' command on the .o file.</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks very much for the idea :-). I finally found the problem with the "nm": the bin2o generates a symbol name ussing the *ENTIRE* path of the binary file not the file name. I edited the resulting .h, I changed the variable definitions and the code linked and run ok :-). Thank you very much! ^_^<br/>_________________<br/>Avelino Herrera Morales
<br/>
<a class="postlink" href="http://avelino.gabiot.com" target="_blank">http://avelino.gabiot.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47070 - Quirky - Mon Jul 04, 2005 7:26 pm</h4>
    <div class="postbody"><span class="postbody">I had completely forgotten about that novel effect - it had me stumped for ages a while back. I now use a Makefile in the image directory, so that the symbol names are not path dependent.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49258 - zazery - Wed Jul 27, 2005 9:52 pm</h4>
    <div class="postbody"><span class="postbody">I decided to build this example to give me an idea of how to include graphic files without converting them into C-arrays. However, I get the following error:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">F:\GBA\Projects\examples\gba\PCXView&gt;make
<br/>
make[1]: *** No rule to make target `splash.o', needed by `/f/GBA/Projects/examp
<br/>
les/gba/PCXView/PCXView_mb.elf'.  Stop.
<br/>
make: *** [build] Error 2</td> </tr></table><span class="postbody">
<br/>
Some more information:
<br/>
-I installed devkitARM, msys and libgba yesterday using the links from devkitPro's web page.
<br/>
<br/>
Environment variables:
<br/>
-LIBGBA = /c/devkitPro/libgba/include;/c/devkitPro/libgba/lib;
<br/>
-DEVKITPRO = /c/devkitPro
<br/>
-DEVKITARM = /c/devkitPro/devkitARM
<br/>
-Path = C:\msys\1.0\bin;c:\devkitPro\devkitARM\bin; (plus other application paths)
<br/>
<br/>
Over the past few days I have been learning a bit more about makefiles, however I haven't quite grasped everything yet.  I have noticed that bin2o was changed from darkfader's bin2o program into a rule in the file base_rules so I assume that the makefile in the PCXView folder would automatically generate the splash_pcx.h and the object file. Am I wrong?
<br/>
<br/>
It's probably something very obvious but I haven't been able to figure it out. Below are some other errors when building the other examples:
<br/>
<br/>
mbv2print &amp; XbooLoad: no problems.
<br/>
<br/>
PlayBoyScout: 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">F:\GBA\Projects\examples\gba\PLAYBO~1&gt;make
<br/>
make[1]: *** No rule to make target `ScoutSplash.o', needed by `/f/GBA/Projects/
<br/>
examples/gba/PLAYBO~1/PlayBoyScout_mb.elf'.  Stop.
<br/>
make: *** [build] Error 2</td> </tr></table><span class="postbody">
<br/>
<br/>
SimpleBGScroll:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">F:\GBA\Projects\examples\gba\SIMPLE~1&gt;make
<br/>
main.c
<br/>
f:/GBA/Projects/examples/gba/SIMPLE~1/source/main.c:47:32: r6502_portfont_bin.h:
<br/>
 No such file or directory
<br/>
f:/GBA/Projects/examples/gba/SIMPLE~1/source/main.c: In function `main':
<br/>
f:/GBA/Projects/examples/gba/SIMPLE~1/source/main.c:215: error: `r6502_portfont_
<br/>
bin' undeclared (first use in this function)
<br/>
f:/GBA/Projects/examples/gba/SIMPLE~1/source/main.c:215: error: (Each undeclared
<br/>
 identifier is reported only once
<br/>
f:/GBA/Projects/examples/gba/SIMPLE~1/source/main.c:215: error: for each functio
<br/>
n it appears in.)
<br/>
make[1]: *** [main.o] Error 1
<br/>
make: *** [build] Error 2</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49312 - strager - Thu Jul 28, 2005 1:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zazery wrote:</b></span></td> </tr> <tr> <td class="quote">Some more information:
<br/>
-I installed devkitARM, msys and libgba yesterday using the links from devkitPro's web page.</td> </tr></table><span class="postbody">
<br/>
<br/>
Did you download the base rules fix?  There was a little problem with the b2o (the entire path was being put into the variable) and was fixed a few days after r13 of DevKitARM.
<br/>
<br/>
And try a 'make clean'.  It worked for me when I tried it with the GBA examples (for some reason).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49330 - zazery - Thu Jul 28, 2005 7:54 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Edit:</span> I have created a quick html page outlining the steps I took to completely install everything on a computer with no prior gba development tools. The issue wasn't resolved and I recieved the same errors. Click <a class="postlink" href="http://members.shaw.ca/eraue/TEMP/gbaproblem/problem.html" target="_blank">here</a>  to see the html file. I have also included the example, gba_rules, and base_rules files at the bottom of the page. 
<br/>
[end of edit]
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>strager wrote:</b></span></td> </tr> <tr> <td class="quote">Did you download the base rules fix?  There was a little problem with the b2o (the entire path was being put into the variable) and was fixed a few days after r13 of DevKitARM.</td> </tr></table><span class="postbody">
<br/>
<br/>
I remember reading that post, however I have devkitARM r14 installed. To make sure it wasn't  the problem I have just downloaded devkitARM r14 4.0.1 (had just devkitARM 14 before), libgba-20050615 and the examples(from the CVS), same problem.
<br/>
<br/>
Here is the bin2o rule of base_rules: (file last modified: Thursday, July 21, 2005, 3:18:20 PM)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">define bin2o
<br/>
   padbin 4 $(&lt;)
<br/>
   $(OBJCOPY) -I binary -O elf32-littlearm -B arm \
<br/>
   --rename-section .data=.rodata,readonly,data,contents,alloc \
<br/>
   --redefine-sym _binary_`(echo $(&lt;) | sed -e 's/^\/\([a-zA-Z]\/\)/\1_/' | tr . _ | tr / _)`_start=`(echo $(&lt;F) | tr . _)`\
<br/>
   --redefine-sym _binary_`(echo $(&lt;) | sed -e 's/^\/\([a-zA-Z]\/\)/\1_/' | tr . _ | tr / _)`_end=`(echo $(&lt;F) | tr . _)`_end\
<br/>
   --redefine-sym _binary_`(echo $(&lt;) | sed -e 's/^\/\([a-zA-Z]\/\)/\1_/' | tr . _ | tr / _)`_size=`(echo $(&lt;F) | tr . _)`_size\
<br/>
   $(&lt;) $(@)
<br/>
   echo "extern const u32" `(echo $(&lt;F) | tr . _)`"_end[];" &gt; `(echo $(&lt;F) | tr . _)`.h
<br/>
   echo "extern const u8" `(echo $(&lt;F) | tr . _)`"[];" &gt;&gt; `(echo $(&lt;F) | tr . _)`.h
<br/>
   echo "extern const u32" `(echo $(&lt;F) | tr . _)`_size[]";" &gt;&gt; `(echo $(&lt;F) | tr . _)`.h
<br/>
endef</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>strager wrote:</b></span></td> </tr> <tr> <td class="quote">And try a 'make clean'.  It worked for me when I tried it with the GBA examples (for some reason).</td> </tr></table><span class="postbody">
<br/>
I tried to 'make clean', however all that does for me is clean out the o files etc. is it supposed to do something else?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
