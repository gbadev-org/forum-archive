<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Two background woes - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Two background woes</h2>
<div id="posts">
<div class="post">
    <h4>#23110 - Rommel - Sun Jul 04, 2004 11:02 pm</h4>
    <div class="postbody"><span class="postbody">Edit: Forgot to explain problem ^^
<br/>
<br/>
What I'm trying to do is set up a background on the top fifth of the screen, and the main background is supposed to cover the rest. I went with making pink my transparent color and in the top most background used that where I want to see the other background. Then I write in the top one, then the second. Setting the top one with the higher priority then the second so the second should just show through the transparent colors, however this doesn't end up happening. Depending on how I write in the backgrounds (order) I'll either see the top portion flash then the later one will take the whole screen (ignoring priorities it seems) or if I write the top last it will indeed show up but the transparent color is all black instead of showing the other background. I've looked through the faq, and have searched through the posts here for the last hour or so for simular problems, but none have had the answer I'm looking for. Anyways, here's the code I'm using, thanks for any help.
<br/>
<br/>
SetMode(MODE_1 | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
bg2.number = 1;
<br/>
bg2.bg_priority = 3;
<br/>
bg2.charBaseBlock = 0;
<br/>
bg2.screenBaseBlock = 28;
<br/>
bg2.colorMode = BG_COLOR_256;
<br/>
bg2.size = TEXTBG_SIZE_512x512;
<br/>
bg2.mosiac = 0;
<br/>
bg2.x_scroll = 0;
<br/>
bg2.y_scroll = 0;
<br/>
EnableBackground(&amp;bg2);
<br/>
<br/>
bg1.number = 2;
<br/>
bg1.bg_priority = 1;
<br/>
bg1.charBaseBlock = 0;
<br/>
bg1.screenBaseBlock = 28;
<br/>
bg1.colorMode = BG_COLOR_256;
<br/>
bg1.size = ROTBG_SIZE_512x512;
<br/>
bg1.mosiac = 0;
<br/>
bg1.x_scroll = 0;
<br/>
bg1.y_scroll = 0;
<br/>
EnableBackground(&amp;bg1);
<br/>
<br/>
for(loop = 0; loop &lt; 256; loop++)
<br/>
BGPaletteMem[loop] =topmenutilespal[loop];
<br/>
<br/>
for(loop = 0; loop &lt; topmenutiles_WIDTH * topmenutiles_HEIGHT /2; loop++)
<br/>
bg1.tileData[loop] =topmenutilesdata[loop];
<br/>
<br/>
temp = (u16*)topmenu;
<br/>
for(loop = 0; loop &lt; 64*64/2; loop++)
<br/>
bg1.mapData[loop] = temp[loop];
<br/>
<br/>
for(loop = 0; loop &lt; tiles_WIDTH * tiles_HEIGHT /2; loop++)
<br/>
bg2.tileData[loop] =tilesData[loop];
<br/>
<br/>
temp = (u16*)level1;
<br/>
for(loop = 0; loop &lt; 64*64/2; loop++)
<br/>
bg2.mapData[loop] = temp[loop];</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23112 - poslundc - Sun Jul 04, 2004 11:16 pm</h4>
    <div class="postbody"><span class="postbody">You cannot choose a "transparent colour". Palette entry #0 is always the transparent colour, regardless of what settings you may have had in your image creation stage (eg. if you used the GIF file format, which lets you choose a transparent colour).
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23113 - dagamer34 - Sun Jul 04, 2004 11:23 pm</h4>
    <div class="postbody"><span class="postbody">You have 2 problems:
<br/>
<br/>
1) Your tile data is overlapping. Notice that you use the same exact char block for both. Unless you have offsets in your map, you are going to have artifacts. You only see the main background because that is what you copied last. Either switch char blocks or combine the tilesets into one and recreate the map so it correct.
<br/>
<br/>
2) Your map data is also overlapping. Each map needs to have its own screen block otherwise problems can occur.
<br/>
<br/>
It's important that you realize where everything is in memory when copying data to VRAM. It can serve multiple purposes and is confusing to beginners. It took a while for me to understand tile modes.
<br/>
<br/>
Oh, I'm also going to hijack your topic while I'm here. Is it possible to use half a char block for tile data and the other half for map data as long as they don't overlap? That would really save some VRAM.
<br/>
<br/>
EDIT: I beat you to it Dan!!<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23115 - Rommel - Sun Jul 04, 2004 11:34 pm</h4>
    <div class="postbody"><span class="postbody">Ah, thank you very much dagamer. I didn't know about that.
<br/>
<br/>
Thanks again :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23117 - dagamer34 - Sun Jul 04, 2004 11:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Rommel wrote:</b></span></td> </tr> <tr> <td class="quote">Ah, thank you very much dagamer. I didn't know about that.
<br/>
<br/>
Thanks again :)</td> </tr></table><span class="postbody">
<br/>
<br/>
You're welcome.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23127 - tepples - Mon Jul 05, 2004 4:11 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">Is it possible to use half a char block for tile data and the other half for map data as long as they don't overlap? That would really save some VRAM.</td> </tr></table><span class="postbody">
<br/>
Yes. For example, in the in-game screen of <span style="font-style: italic">Tetanus On Drugs</span>, I overlapped the rot/scale playfield (32x32 tiles, 1 KB) into an unused area of the font tiles (covering tiles 0-31).
<br/>
<br/>
In chapter 5 of the tutorial I'm working on, which will cover tiled backgrounds, I'll stress that beginners should use CHR base blocks 0-2 and maps 24-31.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23129 - Abscissa - Mon Jul 05, 2004 5:13 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Yes. For example, in the in-game screen of <span style="font-style: italic">Tetanus On Drugs</span>, I overlapped the rot/scale playfield (32x32 tiles, 1 KB) into an unused area of the font tiles (covering tiles 0-31).</td> </tr></table><span class="postbody">
<br/>
<br/>
Wow, I didn't realize you had made Tetanus on Drugs.  That game is so awesome :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
