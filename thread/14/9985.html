<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Weird problem in gba linking - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Weird problem in gba linking</h2>
<div id="posts">
<div class="post">
    <h4>#88583 - Legolas - Tue Jun 20, 2006 1:35 pm</h4>
    <div class="postbody"><span class="postbody">I have updated devkitPro to r19a and some code I have does not link animore. I get a strange error:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
...
<br/>
linking cartridge
<br/>
d:\devkitpro\devkitarm\arm-eabi\bin\ld.real.exe: error: no memory region specified for loadable section `.ARM.extab'
<br/>
collect2: ld returned 1 exit status
<br/>
make[1]: *** [/d/devkitpro/WinDS_devKit/Examples/GBA/WGL/SwSprites/SwSprites.elf] Error 1
<br/>
make: *** [build] Error 2
<br/>
</td> </tr></table><span class="postbody">
<br/>
I have rebuilt all libraries, but no way to make the linker working.
<br/>
Even more strange is that I'm able to link all devkitPro gba examples.<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88602 - wintermute - Tue Jun 20, 2006 3:52 pm</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.devkitpro.org/index.php?action=fullnews&amp;id=112" target="_blank">http://www.devkitpro.org/index.php?action=fullnews&amp;id=112</a><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88621 - Legolas - Tue Jun 20, 2006 5:37 pm</h4>
    <div class="postbody"><span class="postbody">Ok, this patch resolves the linking stage. Now the problem is that my generated ROM crashes both on emus and real hardware (black screen). No$gba says that "elf file contains code/data outside of usual ROM area".<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89256 - Legolas - Fri Jun 23, 2006 8:30 pm</h4>
    <div class="postbody"><span class="postbody">In gba_cart.ld file from arm-elf there is:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">__eheap_end = 0x2040000;</td> </tr></table><span class="postbody">
<br/>
but in arm-eabi one:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">__eheap_end = ORIGIN(ewram) + LENGTH(iwram);
<br/>
</td> </tr></table><span class="postbody">
<br/>
LENGTH(iwram) is 32K=0x8000, so __eheap_end is 0x2008000, instead of 0x2040000, like in arm-elf. Is it a typo or the right value?
<br/>
<br/>
<span style="font-weight: bold"><span style="color: red">Edit</span></span>: maybe I have found why the rom does not work. Seems that the executable misses .ctors and .dtors sections, even if in my code I use classes. Any help is appreciated ^_^<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89342 - wintermute - Sat Jun 24, 2006 1:23 pm</h4>
    <div class="postbody"><span class="postbody">That would be a typo, sorry.  The correct value should be LENGTH(ewram)
<br/>
<br/>
arm-eabi handles constructors/destructors in a different way to arm-elf.
<br/>
<br/>
Where did you get the source for winDS?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89348 - Legolas - Sat Jun 24, 2006 2:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">That would be a typo, sorry.  The correct value should be LENGTH(ewram)
<br/>
<br/>
arm-eabi handles constructors/destructors in a different way to arm-elf.
<br/>
<br/>
Where did you get the source for winDS?</td> </tr></table><span class="postbody">
<br/>
<br/>
Ok, so I'll correct it :)
<br/>
<br/>
About my problem, VBA logging gives me a lot of errors like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Illegal word read: 80058004 at 002b0026
<br/>
Undefined THUMB instruction e92d at 002b002a
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
As LiraNuna lost his interest in WinDS, I asked him the sources, in order to go on with the development. I'll put the sources on sourceforge svn ASAP :)
<br/>
<br/>
<span style="font-weight: bold">Edit</span>: ok, now the sources are on <a class="postlink" href="https://sourceforge.net/projects/gbawins/" target="_blank">svn</a><br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90104 - Legolas - Wed Jun 28, 2006 1:06 pm</h4>
    <div class="postbody"><span class="postbody">A little update: I have been able to make a working demo by using multiboot linkerscript; the same code does not work at all using "cartridge" linking. :/<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
