<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Strange errors in VHAM, can't deploy with XBOO - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Strange errors in VHAM, can't deploy with XBOO</h2>
<div id="posts">
<div class="post">
    <h4>#166895 - miamicanes - Mon Feb 23, 2009 8:05 am</h4>
    <div class="postbody"><span class="postbody">Is there a "howto" somewhere that walks you through building a project using Visual HAM, then uploading it to a GBA using a XBOO cable under Vista (where presumably you have to use something like PortTalk's AllowIO to enable direct access to the parallel port hardware)?
<br/>
<br/>
I'm having multiple problems. For one thing, when I hit f7 to build + run in VBA, I get the following output:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-as.exe -mthumb-interwork  c:/apps/gbaHAM/system/crt0.s -ocrt0.o
<br/>
c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-gcc.exe  -I c:/apps/gbaHAM/gcc-arm/include -I c:/apps/gbaHAM/gcc-arm/arm-thumb-elf/include -I c:/apps/gbaHAM/include -I c:/apps/gbaHAM/system  -c -DHAM_HAM  -DHAM_MULTIBOOT  -DHAM_ENABLE_MBV2LIB -O2 -DHAM_WITH_LIBHAM  -mthumb-interwork -mlong-calls -Wall -save-temps -fverbose-asm -nostartfiles main.c -o main.o
<br/>
<span style="font-weight: bold">3 [main] arm-thumb-elf-gcc 6404 fork_copy: linked dll data/bss pass 0 failed, 0x32F000..0x32F040, done 0, windows pid 6456, Win32 error 487</span>
<br/>
c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-ld.exe    -L c:/apps/gbaHAM/gcc-arm/lib/gcc-lib/arm-thumb-elf/3.3.2/interwork -L c:/apps/gbaHAM/gcc-arm/lib/gcc-lib/arm-thumb-elf/3.3.2 -L c:/apps/gbaHAM/gcc-arm/arm-thumb-elf/lib/interwork -L c:/apps/gbaHAM/gcc-arm/arm-thumb-elf/lib -L c:/apps/gbaHAM/gcc-arm/lib  --script c:/apps/gbaHAM/system/lnkscript-afm -o demo.elf crt0.o main.o    -lafm -lham -lm -lstdc++ -lsupc++ -lgcc -lc -lgcc
<br/>
c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-objcopy.exe  -v -O binary demo.elf demo.gba  
<br/>
copy from demo.elf(elf32-littlearm) to demo.gba(binary)
<br/>
------------------------------------------------------------------
<br/>
 HAM Win32 installation information:
<br/>
<br/>
 HAM version:        2.8 in c:/apps/gbaHAM
<br/>
 GCC/GDB version:    3.3.2 / 6.0
<br/>
 Newlib/Binutils:    1.11.0 / 2.14
<br/>
 Krawall ena/regged:  / 
<br/>
------------------------------------------------------------------
<br/>
c:/apps/gbaHAM/tools/win32/rm -f *.o *.i *.ii
<br/>
c:/apps/gbaHAM/tools/win32/gbafix.exe demo.gba  -tdemo
<br/>
ROM fixed!
<br/>
c:/apps/gbaHAM/tools/win32/vba.exe demo.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
Note the "487 error". Nevertheless, it seems to run under VBA.
<br/>
<br/>
Problem #2: the only way to kill VBA is with task manager. 
<br/>
<br/>
Problem #3: I can't deploy it to my GBA/SP. Here's the output when I hit f8 with the cable I built connected and the GBA/SP powered up:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-as.exe -mthumb-interwork  c:/apps/gbaHAM/system/crt0.s -ocrt0.o
<br/>
c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-gcc.exe  -I c:/apps/gbaHAM/gcc-arm/include -I c:/apps/gbaHAM/gcc-arm/arm-thumb-elf/include -I c:/apps/gbaHAM/include -I c:/apps/gbaHAM/system  -c -DHAM_HAM  -DHAM_MULTIBOOT  -DHAM_ENABLE_MBV2LIB -O2 -DHAM_MBV2_USED -DHAM_DEBUGGER -DHAM_WITH_LIBHAM  -mthumb-interwork -mlong-calls -Wall -save-temps -fverbose-asm -nostartfiles main.c -o main.o
<br/>
<span style="font-weight: bold">4 [main] arm-thumb-elf-gcc 4220 fork_copy: linked dll data/bss pass 0 failed, 0x8AF000..0x8AF040, done 0, windows pid 4212, Win32 error 87
<br/>
1034954 [main] arm-thumb-elf-gcc 4220 fork_copy: linked dll data/bss pass 0 failed, 0x8AF000..0x8AF040, done 0, windows pid 6220, Win32 error 87
<br/>
3138306 [main] arm-thumb-elf-gcc 4220 fork_copy: linked dll data/bss pass 0 failed, 0x8AF000..0x8AF040, done 0, windows pid 6428, Win32 error 87
<br/>
7223148 [main] arm-thumb-elf-gcc 4220 fork_copy: linked dll data/bss pass 0 failed, 0x8AF000..0x8AF040, done 0, windows pid 6520, Win32 error 87</span>
<br/>
c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-ld.exe    -L c:/apps/gbaHAM/gcc-arm/lib/gcc-lib/arm-thumb-elf/3.3.2/interwork -L c:/apps/gbaHAM/gcc-arm/lib/gcc-lib/arm-thumb-elf/3.3.2 -L c:/apps/gbaHAM/gcc-arm/arm-thumb-elf/lib/interwork -L c:/apps/gbaHAM/gcc-arm/arm-thumb-elf/lib -L c:/apps/gbaHAM/gcc-arm/lib  --script c:/apps/gbaHAM/system/lnkscript-afm -o demo.elf crt0.o main.o    -lafm -lham -lm -lstdc++ -lsupc++ -lgcc -lc -lgcc
<br/>
c:/apps/gbaHAM/gcc-arm/bin/arm-thumb-elf-objcopy.exe  -v -O binary demo.elf demo.gba  
<br/>
copy from demo.elf(elf32-littlearm) to demo.gba(binary)
<br/>
------------------------------------------------------------------
<br/>
 HAM Win32 installation information:
<br/>
<br/>
 HAM version:        2.8 in c:/apps/gbaHAM
<br/>
 GCC/GDB version:    3.3.2 / 6.0
<br/>
 Newlib/Binutils:    1.11.0 / 2.14
<br/>
 Krawall ena/regged:  / 
<br/>
------------------------------------------------------------------
<br/>
c:/apps/gbaHAM/tools/win32/rm -f *.o *.i *.ii
<br/>
c:/apps/gbaHAM/tools/win32/mb.exe -c -x 500 -w 50 -s demo.gba 
<br/>
<span style="font-weight: bold">3 [main] sh 7032 proc_subproc: Couldn't duplicate my handle&lt;0x3C&gt; for pid 7076, Win32 error 6</span>
<br/>
make: *** [mbv2] Error 1</td> </tr></table><span class="postbody">
<br/>
<br/>
I know about the problems with NT/Win2k/XP/Vista and parallel ports, and I launched VHAM itself using PortTalk's AllowIO.exe:
<br/>
<br/>
<span style="font-weight: bold">C:\apps\gbaHAM\vham&gt;allowio vham.exe 0x378</span>
<br/>
<br/>
Unfortunately, I'm not even sure whether that's the problem, one of several problems, or irrelevant because it's dying long before that even has a chance to BE the problem ;-)
<br/>
<br/>
So... any ideas or suggestions as to where to start?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166921 - miamicanes - Tue Feb 24, 2009 3:50 am</h4>
    <div class="postbody"><span class="postbody">Well, I found one big, huge problem: <span style="font-weight: bold">XBOO != MBV2</span>.
<br/>
<br/>
Using XCOMMS_win32 with UserPort, I was able to successfully flash vham-samples\vham_c_helloworld to my SP.
<br/>
<br/>
New Problem(*): For some reason, I can't power up my GBA/SP with the XBOO cable connected. I have to physically unplug it, power up while holding down select+start, THEN connect the cable. I have a hunch I screwed up the cable somewhere along the line, but I'm not quite sure where. Any ideas?
<br/>
<br/>
(*)OK, not exactly a NEW problem... I had the same behavior last night. It's just that last night, I wasn't even making it far enough for this specific problem to be on the radar ;)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
