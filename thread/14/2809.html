<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Programming a simple demo - need help please - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Programming a simple demo - need help please</h2>
<div id="posts">
<div class="post">
    <h4>#16015 - Killua - Fri Feb 06, 2004 10:28 am</h4>
    <div class="postbody"><span class="postbody">Hi guys.
<br/>
<br/>
I'm currently programming a first gba demo. I do this using C, no HAM or SGADE libs, and no ASM as I can easily do C code but I'm too newb with asm to start with that...
<br/>
<br/>
The aim is to display a background, and a texte that slowly appears lines after lines from the top of the screen (actually even letters appearing from the top pixels to the bottom ones, just like every pixel lines are displayed one after one, would be even better). When the whole text is displayed, on keypress I switch the background and display a second text, the same way.
<br/>
<br/>
I want to finish this before valentine's day, as the background and text are intended for my gf :) I offered her a GBA this christmas (the third one in my house -_- GBA SP this time :p), and we bought a EZFA.
<br/>
<br/>
I started yesterday evening (devkitadvance, it was already installed), and currently I have 2 background displayed on keypress (J_LEFT display the 1st one and J_RIGHT the second one). And because I want to do this before valentine I don't want to jump into asm &gt;_&lt; I did my C code with the help of "The Pern Project".
<br/>
<br/>
<br/>
Here is the point now :
<br/>
Can you guys help me by providing some example sources/demos that does almost what I want ? I don't know yet how to display the text slowly from top to bottom, and if something like that already exists I'd like to know, It might save me a lot of time (because if I do this quickly, I may think about adding sound too). I've search many demos on this site, but too much of them are in asm too :/ I've seen AGBTTY a few minutes ago, though I'm at work and I'll check it deeper tonight ^_^
<br/>
<br/>
This is btw my idea, but I'm opened to suggestions, like displaying the text letter after letter (which should be easier right ?). Just tell me ^_^
<br/>
<br/>
Thanks a lot for any help you can provide me :)<br/>_________________<br/>Killua</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16018 - qw3rty - Fri Feb 06, 2004 11:22 am</h4>
    <div class="postbody"><span class="postbody">the effect you want, could be done, by scrolling the BG depending on the rasterline (REG_VCOUNT).
<br/>
<br/>
make a 512x256 text-background, write your text in the "2nd" screen (2nd screen == 256 &lt; x &gt; 512)
<br/>
<br/>
the scroll code could look something like this :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define BIT1 2
<br/>
s16 x_scroll;
<br/>
u16 y;
<br/>
for (y = 0;y &lt;= 256; y++)
<br/>
{
<br/>
     while (REG_VCOUNT != 160) //do while screen is drawn
<br/>
     {
<br/>
          if (REG_VCOUNT &lt;= y)
<br/>
         {
<br/>
              x_scroll = 256;
<br/>
         }
<br/>
         else
<br/>
         {
<br/>
              x_scroll = 0;
<br/>
         }
<br/>
         while ((*DISPSTAT &amp; BIT1) ==0); //wait for h-blank
<br/>
         REG_BGxHOFS = x_scroll;  //exchange the "x" with the according number
<br/>
         while ((*DISPSTAT &amp; BIT1) != 0); //wait for next line to be drawn
<br/>
     }
<br/>
<br/>
     while (REG_VCOUNT != 227); //wait for next frame
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this code is untested, but it should give you the idea ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16019 - Killua - Fri Feb 06, 2004 11:48 am</h4>
    <div class="postbody"><span class="postbody">yep :) as I said I'm at work I'll test tonight :) ( currently almost 12am CET)
<br/>
If you have other ideas until then, feel free to help ^_^<br/>_________________<br/>Killua</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16023 - qw3rty - Fri Feb 06, 2004 1:43 pm</h4>
    <div class="postbody"><span class="postbody">I found a few mistakes :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define BIT1 2
<br/>
s16 x_scroll;
<br/>
u16 y;
<br/>
while (REG_VCOUNT != 227); //*ADDED* wait for end of current frame
<br/>
for (y = 0;y &lt;= 160; y++) //*CHANGED* upper border for y to 160 (last line visible)
<br/>
{
<br/>
     while (REG_VCOUNT != 160) //do while screen is drawn
<br/>
     {
<br/>
          if (REG_VCOUNT &lt;= y)
<br/>
         {
<br/>
              x_scroll = 256;
<br/>
         }
<br/>
         else
<br/>
         {
<br/>
              x_scroll = 0;
<br/>
         }
<br/>
         while ((*DISPSTAT &amp; BIT1) ==0); //wait for h-blank
<br/>
         REG_BGxHOFS = x_scroll;  //exchange the "x" with the according number
<br/>
         while ((*DISPSTAT &amp; BIT1) != 0); //wait for next line to be drawn
<br/>
     }
<br/>
<br/>
     while (REG_VCOUNT != 227); //wait for next frame
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
P.S. if you want to speed this up, change the stride of the for-loop (e.g. y+=2)....to slow it down, iterate y only every n-th frame....</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16038 - crossraleigh - Sat Feb 07, 2004 12:08 am</h4>
    <div class="postbody"><span class="postbody">If you want a full text system where you can use a puts() function to write to a BG, there are lots of examples. tepples has <a class="postlink" href="http://www.pineight.com/gba/" target="_blank">AGBTTY</a>, Dan has the <a class="postlink" href="http://www.danposluns.com/gbadev/textutils.html" target="_blank">PFont</a> engine (which has variable-width font and still uses tile mode), and the SGADE has a Mode 0 print function.
<br/>
<br/>
You will certainly learn more if you write everything yourself, but if you use a library it will be a lot easier. In fact, the SGADE has SoBkgCreditScroll which does exactly what you want. (I think I know what you want anyway. qw3rty's code is doing strange things to the X ofset in H-blank, instead of changing the Y ofset in V-blank.) You could set it up in a dozen or so lines. (For an example see [url=http://cvs.sourceforge.net/viewcvs.py/*checkout*/sgade/RELEASE_1_02/sample/source/SampleEffectCredits.c?content-type=text%2Fplain&amp;rev=1.3]SampleEffectsCredits.c[/url].)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16039 - qw3rty - Sat Feb 07, 2004 12:58 am</h4>
    <div class="postbody"><span class="postbody">if you want something like this :
<br/>
<a class="postlink" href="http://qwerty.myvnc.com:66/test.bin" target="_blank">http://qwerty.myvnc.com:66/test.bin</a>
<br/>
<br/>
you could use my code...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16040 - Killua - Sat Feb 07, 2004 1:43 am</h4>
    <div class="postbody"><span class="postbody">that's it, though actually I used the mode 4 example from the pern project and I use 240x160 pictures
<br/>
I guess I shouldn't use mode 4 for 256*256 pictures. Still I can't compile this code because of the *DISPSTAT (which is actually for me REG_DISPSTAT, from eloist's gba.h. 
<br/>
<br/>
And I'd like not to use those libraries for now if I can do so, but well ... kinda fun but hard ^_^<br/>_________________<br/>Killua</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16041 - qw3rty - Sat Feb 07, 2004 1:46 am</h4>
    <div class="postbody"><span class="postbody">hmmm....I assumed you were using a tile-background (mode 0-2) and not a bitmapped mode (mode 3-5)...my code only works for tile-backgrounds...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16045 - Killua - Sat Feb 07, 2004 2:24 am</h4>
    <div class="postbody"><span class="postbody">ok tried with mode 0 but still I have difficulties -_- is tile background better though for that kind of work ?<br/>_________________<br/>Killua</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16048 - crossraleigh - Sat Feb 07, 2004 4:17 am</h4>
    <div class="postbody"><span class="postbody">Ah, after looking at the demo and re-reading the post I understand what he meant.
<br/>
<br/>
I think a simpler method is to set up a window and decrement the top Y coordinate of it each V-blank. Windows can be used to all sorts of nice effects: the vertical wipe you want, and horizontal and diagonal wipes; interlacing of images; growing diamond or circle transitions; on and on. You could even use both windows and make some sort of heart transition. darkcloud has some window effects on <a class="postlink" href="http://sinewave3.tripod.com" target="_blank">his website</a>.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
