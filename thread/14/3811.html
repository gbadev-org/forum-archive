<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>#include screws up output - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > #include screws up output</h2>
<div id="posts">
<div class="post">
    <h4>#24300 - underthesun - Sun Aug 01, 2004 3:27 am</h4>
    <div class="postbody"><span class="postbody">I dont know why, but
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/*
<br/>
 * 1x97 map data
<br/>
 */
<br/>
const unsigned short kroegerbw_Map[97] = {
<br/>
0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007, 
<br/>
0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f, 
<br/>
0x0010, 0x0011, 0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017, 
<br/>
0x0018, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f, 
<br/>
0x0020, 0x0021, 0x0022, 0x0023, 0x0024, 0x0025, 0x0026, 0x0027, 
<br/>
0x0028, 0x0029, 0x002a, 0x002b, 0x002c, 0x002d, 0x002e, 0x002f, 
<br/>
0x0030, 0x0031, 0x0032, 0x0033, 0x0034, 0x0035, 0x0036, 0x0037, 
<br/>
0x0038, 0x0039, 0x003a, 0x003b, 0x003c, 0x003d, 0x003e, 0x003f, 
<br/>
0x0040, 0x0041, 0x0042, 0x0043, 0x0044, 0x0045, 0x0046, 0x0047, 
<br/>
0x0048, 0x0049, 0x004a, 0x004b, 0x004c, 0x004d, 0x004e, 0x004f, 
<br/>
0x0050, 0x0051, 0x0052, 0x0053, 0x0054, 0x0055, 0x0056, 0x0057, 
<br/>
0x0058, 0x0059, 0x005a, 0x005b, 0x005c, 0x005d, 0x005e, 0x005f, 
<br/>
0x0060
<br/>
};</td> </tr></table><span class="postbody">
<br/>
<br/>
including the above with an #include clause screws up my program, by making my sprite look like sif it's been shredded..
<br/>
<br/>
and when I remove the #include my sprite goes back to normal. the above is a map file for a font tile.
<br/>
<br/>
i'm currently using visual ham (although not using hamLib). is it possible that because HAM puts all code in wram or something, and the memory runs out.. or..? Im completely baffled. If anybody got any ideas, thanks in advance :)
<br/>
<br/>
edit: more info : i am currently in mode 0, and enabling / disabling the backgrounds have no effects. the only sprite on the game screws up.. ill try post an image soon.<br/>_________________<br/><span style="font-size: 1px; line-height: normal"><a class="postlink" href="http://utgc.port5.com" target="_blank">I</a> am just a gba noob. be gentle :p</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24304 - underthesun - Sun Aug 01, 2004 3:47 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.cse.unsw.edu.au/~ywid062/ship.jpg">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
and also, not using include, basically pasting the code to the stuff still screws it up. O_O the weirdest error i've ever had..<br/>_________________<br/><span style="font-size: 1px; line-height: normal"><a class="postlink" href="http://utgc.port5.com" target="_blank">I</a> am just a gba noob. be gentle :p</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24309 - sajiimori - Sun Aug 01, 2004 6:38 am</h4>
    <div class="postbody"><span class="postbody">It might be an alignment issue.  Try declaring the array this way:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const unsigned short kroegerbw_Map[97] __attribute__((aligned (4)))
<br/>
</td> </tr></table><span class="postbody">
<br/>
Edit: actually, the relevant alignment would be on the later objects, but as a rule you'll want all your global data to be 4 byte aligned.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24312 - underthesun - Sun Aug 01, 2004 10:37 am</h4>
    <div class="postbody"><span class="postbody">sorry, but i dont really understand how to actually implement that, never seen such __ in C before..
<br/>
<br/>
anyhow i found my way around this problem, thanks v. much anyways :)<br/>_________________<br/><span style="font-size: 1px; line-height: normal"><a class="postlink" href="http://utgc.port5.com" target="_blank">I</a> am just a gba noob. be gentle :p</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24314 - col - Sun Aug 01, 2004 12:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>underthesun wrote:</b></span></td> </tr> <tr> <td class="quote">sorry, but i dont really understand how to actually implement that, never seen such __ in C before..
<br/>
<br/>
anyhow i found my way around this problem, thanks v. much anyways :)</td> </tr></table><span class="postbody">
<br/>
<br/>
If you post a problem, then find a solution yourself, it is normal practice to explain the solution you found.  This way, others with similar problems can possibly get some help without starting a new thread on the same old subject !
<br/>
<br/>
col</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24323 - tepples - Sun Aug 01, 2004 4:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>underthesun wrote:</b></span></td> </tr> <tr> <td class="quote">sorry, but i dont really understand how to actually implement that, never seen such __ in C before..</td> </tr></table><span class="postbody">
<br/>
It's a GCC extension. Try reading through the <a class="postlink" href="http://www.google.com/search?q=gcc%20manual" target="_blank">GCC manual</a> and becoming familiar with the extra features that GCC's C frontend adds to the language.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24328 - sajiimori - Sun Aug 01, 2004 5:18 pm</h4>
    <div class="postbody"><span class="postbody">Thankfully you don't have to implement it -- it's already implemented in GCC.  You only have to use it, and I pasted the exact code you need so I don't understand your confusion.
<br/>
<br/>
Was your solution to compile the array seperately?  Or put it at the end of the file?  Either of those would be a quick workaround because then the array wouldn't screw up the alignment of later data objects.  In the end, you'll want to have the alignment attribute available to you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24356 - underthesun - Mon Aug 02, 2004 3:48 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>col wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<br/>
If you post a problem, then find a solution yourself, it is normal practice to explain the solution you found.  This way, others with similar problems can possibly get some help without starting a new thread on the same old subject !
<br/>
<br/>
col</td> </tr></table><span class="postbody">
<br/>
<br/>
Oh, sorry, the problem wasn't actually fixed, but rather i just ended up not using the map file. It was done by gfx2gba, and i realised I didnt really need that map file. The array is a map for a font tile, (which later I just stopped using the map, and have a Bitmap instead)..
<br/>
<br/>
that is, i have this long 8 x 776 bitmap file of this font called kroeger, and all these fonts are slotted on an 8x8 basis. To actually generate a tile for this is easy, just gfx2gba as a normal sprite. But i specified it as a map file, and that screws things up because of compression, and that the map file isn't really needed. Thankfully it's not needed, i just stopped using the map file, and all seems to be fine. The problem seems to still be mysterious though :(..
<br/>
<br/>
So yeah, my solution was not to use it at all, since its not needed, and i have no idea what happens.. I just started learning C a while ago, and doing gba programming is an excuse for learning C i guess.. thanks for the helps.
<br/>
<br/>
I'll do a bit more research on gcc extensions. thanks!<br/>_________________<br/><span style="font-size: 1px; line-height: normal"><a class="postlink" href="http://utgc.port5.com" target="_blank">I</a> am just a gba noob. be gentle :p</span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
