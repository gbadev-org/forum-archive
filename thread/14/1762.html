<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DevKitAdv - multiboot and cart ROM? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > DevKitAdv - multiboot and cart ROM?</h2>
<div id="posts">
<div class="post">
    <h4>#8984 - mtg101 - Fri Jul 25, 2003 3:48 pm</h4>
    <div class="postbody"><span class="postbody">I've found on these forums that using DevKitAdv I can declare:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int __gba_multiboot;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
To make my project compile as multiboot. However, I read in the devrs.com MB FAQ (http://www.devrs.com/gba/files/mbv2faqs.php) that it's possible to make a ROM that's both MB and a normal cart ROM. But I don't understand how to do it - I don't know ASM and don't know all the gcc command line options...
<br/>
<br/>
So - is there an easy way using DevKitAdv to get a MB/cart ROM?  If not, can someone point me to an example of how to compile for both?
<br/>
<br/>
<br/>
Thanks,
<br/>
Russell<br/>_________________<br/>---
<br/>
Speaker for the Dead</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8988 - tepples - Fri Jul 25, 2003 5:45 pm</h4>
    <div class="postbody"><span class="postbody">Multiboot programs compiled and linked with DevKitAdv R4 and DevKitAdv R5 beta 3 are already this way. They will copy themselves from cart ROM to EWRAM if necessary. (This was broken in the first two betas of R5.) However, with R5 beta 3, you'll need to look for appended assets (GBFS, etc) in both EWRAM and ROM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8991 - mtg101 - Fri Jul 25, 2003 5:52 pm</h4>
    <div class="postbody"><span class="postbody">I followed the gbajunkie guide to getting DevKitAdv working, so I'm using R4. However when I just add "int __gba_multiboot;" the ROM only works over multiboot. When I try to run from a cart (EZ-F) it just returns to the boot menu.
<br/>
<br/>
Is there something other than just adding "int __gba_multiboot;" that I have to do to get this working?
<br/>
<br/>
<br/>
Cheers
<br/>
Russell<br/>_________________<br/>---
<br/>
Speaker for the Dead</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9012 - mtg101 - Sat Jul 26, 2003 3:32 pm</h4>
    <div class="postbody"><span class="postbody">I've changed over to using Jeff's crt0.S v1.28 instead of the ones that came with DevKitAdv, but using the crtbegin.o and crtend.o from DevKitAdv. But I'm still getting the same problem - works via MB, but not when downloaded to my EZ-F cart (works fine from cart when I remove the int __bga_multiboot). I've also tested simpler tutorial projects and they have the same behaviour.
<br/>
<br/>
So, I think I've removed any dependancy on DevKitAdv by using Jeff's crt0.S stuff... so I can only assume I'm building things wrong.  Here's my makefile... any obvious mistakes?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
CFLAGS = -c
<br/>
MODEL = -mthumb -mthumb-interwork 
<br/>
NAME = mydemo
<br/>
LIST =  $(NAME).o tilebg.o bgtext.o intro.o 
<br/>
<br/>
<br/>
all: $(NAME).mb.gba
<br/>
<br/>
$(NAME).mb.gba: $(NAME).elf 
<br/>
   objcopy -O binary $(NAME).elf $(NAME).mb.gba 
<br/>
   c:/gba/dev/gbaromfixer/gbafix -t$(NAME) $(NAME).mb.gba
<br/>
<br/>
$(NAME).elf: $(LIST) crt0.o
<br/>
   gcc $(MODEL) -nostartfiles -T lnkscript -o $(NAME).elf crt0.o obj/crtbegin.o obj/crtend.o $(LIST) -lm
<br/>
<br/>
$(LIST): %.o: %.cpp
<br/>
   gcc $(MODEL) $(CFLAGS) $&lt;
<br/>
<br/>
crt0.o: crt0.s 
<br/>
   gcc $(CFLAGS) $(MODEL) crt0.S
<br/>
<br/>
clean:
<br/>
   rm -f *.o
<br/>
   rm -f *.elf
<br/>
   rm -f $(NAME).mb.gba
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Cheers
<br/>
Russell<br/>_________________<br/>---
<br/>
Speaker for the Dead</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
