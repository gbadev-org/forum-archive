<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GBA - programming external devices (parallel port) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > GBA - programming external devices (parallel port)</h2>
<div id="posts">
<div class="post">
    <h4>#44750 - ghost Leinad - Sun Jun 05, 2005 1:31 am</h4>
    <div class="postbody"><span class="postbody">please...i need this by tomorrow!!!!
<br/>
<br/>
there's any way to use an external pad in the Visual boy advance...device is connected in the parallel port (base address 378h)...but without using any drivers...
<br/>
<br/>
pseudocode
<br/>
<br/>
_asm
<br/>
{
<br/>
mov dx,378h //base address
<br/>
in dx,al   // signal 
<br/>
}
<br/>
<br/>
if(AL,1) 
<br/>
{
<br/>
c='1' // if c=1 my button one is activated
<br/>
}
<br/>
<br/>
i know that i can do that in plain c but when programming on GBA???
<br/>
<br/>
please how this could be done...and i need this information by tomorrow
<br/>
meanwhile i'll do some investigation by my own
<br/>
<br/>
thank you very much</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44777 - tepples - Sun Jun 05, 2005 5:48 am</h4>
    <div class="postbody"><span class="postbody">I can't exactly understand what you're asking for. Do you want to get the GBA to read its main 10-button controller, or do you want to get the GBA to read an external Super NES controller connected to the link port?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44779 - cory1492 - Sun Jun 05, 2005 6:38 am</h4>
    <div class="postbody"><span class="postbody">I think what he is attempting to do is code for a Visual Boy Advanced controller 'plugin' from within the gba code instead of just using VBA+regular controller drivers+Joypad options, I doubt you are able to directly access the PC hardware (ie: lpt port) from directly within a GBA program running in VBA without using VBA's control 'interpreter' (for lack of knowing what they actually call it), but I could be wrong on that as I have never looked into VBA's method of using PC controllers, and I never looked for a parallel port in the GBA (which is what VBA is emulating).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44796 - arundel - Sun Jun 05, 2005 12:02 pm</h4>
    <div class="postbody"><span class="postbody">Writing a little app that detects the signals of your controller (connected via LPT) shouldn't be a big problem. Just do somthing like:
<br/>
<br/>
IN %reg, %port
<br/>
fprint("%h", %reg)
<br/>
<br/>
(^^pseudo code)
<br/>
<br/>
That should make it possible to figure out all the signals. Don't forget that parallel ports use 3 port addrsses: data, status and control. So for the first LPT device that would be 378h, 379h and 37Ah.
<br/>
<br/>
However: In order for VBA to use that information you have to code some kind of interface that will be accessed by VBA in some form. So you'll need to program a device driver.
<br/>
<br/>
Another option would be to hack your code directly into the VBA source.
<br/>
<br/>
Good luck.<br/>_________________<br/><span style="font-weight: bold">http://www.nausicaa.net</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44803 - tepples - Sun Jun 05, 2005 4:09 pm</h4>
    <div class="postbody"><span class="postbody">"but without using any drivers"
<br/>
<br/>
It might make it easier for us to help you if you clarify why you can't use a driver.
<br/>
<br/>
If you're trying to get VBA to read an external device, the most reliable method is to install a system-wide driver. Only drivers can do the 'in' and 'out' assembly language instructions without causing an exception. There might already be a driver for your controller; search Google for NTpad XP (on Win2k/WinXP) or DirectPad Pro (on Win9x).
<br/>
<br/>
Or must you use a PC that you do not own? In that case, wait until you turn 18 and buy your own PC.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44814 - arundel - Sun Jun 05, 2005 7:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<br/>
Only drivers can do the 'in' and 'out' assembly language instructions without causing an exception. There might already be a driver for your controller; search Google for NTpad XP (on Win2k/WinXP) or DirectPad Pro (on Win9x).</td> </tr></table><span class="postbody">
<br/>
<br/>
Well...there are ways to bypass this limitation. Under Linux/Unix can open /dev/io as root, thus being able to acces all the ports. Or you can use set/get_ioperm.
<br/>
<br/>
Under Windows OSes using the old DOS kern you can access I/O anyway. The ones that are native multiuser OSes and use the NT kern forbid accessing the I/O ports directly. However you can install a driver that re-routes your I/O read/writes so they actually get forwarded onto the bus.
<br/>
<br/>
But there's no real reason to hardcode keypad signals into VBA, instead of using a proper device driver.
<br/>
<br/>
Maybe you can tell us, why you don't want to use a driver?<br/>_________________<br/><span style="font-weight: bold">http://www.nausicaa.net</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44851 - ghost Leinad - Mon Jun 06, 2005 12:13 am</h4>
    <div class="postbody"><span class="postbody">why I dont want to use a driver???
<br/>
because that's the point...if i use a driver mi teacher won't not accept my work
<br/>
<br/>
you know, windows XP forbids external access. 
<br/>
look, i already connected a SNES pad to the computer, then installed some drivers so i can play, well this works well.
<br/>
<br/>
but now im making a program just to check the signals,(some signals MUST be send), but when i press a button nothing changes, that's only can mean that my conection to my parallel port is wrong...but why is working when i install the driver???
<br/>
<br/>
i just want to get the signal, any signal and a diferent one for each single button, after that is easy...
<br/>
<br/>
this is my code so far
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
entrada:
<br/>
    mov dx,379h
<br/>
    IN  AL,DX
<br/>
    mov dl,al
<br/>
    mov ah,2
<br/>
    int 21h
<br/>
    jmp entrada
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this will be checking the signal in the parallel port and then will print the signal in the screen, if i press a diferrent button the signal MUST change, but nothing happenned :(
<br/>
<br/>
or my code is wrong or the conection is wrong but i dont think that the conecttion is wrong so it must be the software
<br/>
<br/>
this is the best i can explain...thank you very much</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44865 - tepples - Mon Jun 06, 2005 6:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ghost Leinad wrote:</b></span></td> </tr> <tr> <td class="quote">why I dont want to use a driver???
<br/>
because that's the point...if i use a driver mi teacher won't not accept my work</td> </tr></table><span class="postbody">
<br/>
Can you explain the details of the negotiation with the teacher over this point? In any case, the 'in' instruction <span style="font-style: italic">will fail</span>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44920 - arundel - Mon Jun 06, 2005 7:58 pm</h4>
    <div class="postbody"><span class="postbody">1. Which operating system are  you using?
<br/>
2. As I said before the parallel port uses three I/O port addresses. You're only reading out asingle port.
<br/>
3. The base port address doesn't necessarily has to be 378h. It depends upon your BIOS settings and whether the parallel port is number 1, 2, ....
<br/>
4. If you want to check for available parallel ports and their addresses from within your program you can read out the words stored at 40h:08h - 40h:0Eh.
<br/>
<br/>
Also you don't necessarily have to write your own program. There are apps available that will display the value of each PIN of your parallel port.<br/>_________________<br/><span style="font-weight: bold">http://www.nausicaa.net</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44991 - ghost Leinad - Tue Jun 07, 2005 2:39 am</h4>
    <div class="postbody"><span class="postbody">ok, here are the conclussions.
<br/>
<br/>
first i MUST use a external power from any kind,(5V ,i think), otherwise the devide won't work
<br/>
<br/>
how to solve this, well i have to use the driver to get the power from the computer, but i use the driver just to get the power not to make the device work. or you can add some power supply in one on the wires and that's all
<br/>
<br/>
two...the program was fine, the direction is 379h for input data. 
<br/>
then i just need to change the pad signal onto a keyboard signal which was easy...all games have the function to change the controls...now, as long as my program is running i can play any game i want! lol i even can use the pad to controle some letters on the notepad or word.
<br/>
<br/>
but let me explain the whole thing (at least i will try). the original project was make a tic tac toe game using external inputs(arcade buttons, push buttons, etz)...we are using a 8255 ppi to get all the signal we need, but we tried and tried and tried over and over again, and it just doesn't work...the time was running out and i tried to make the parallel interface, and after a while, worked....well tha's is the story...
<br/>
and in the end of all, the teacher didn'd accept our project today because "he need to be at home earlier "...
<br/>
<br/>
thank you everybody for all your help,really, you are a very kind group of people. lol</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44994 - ghost Leinad - Tue Jun 07, 2005 2:49 am</h4>
    <div class="postbody"><span class="postbody">by the way..somebody knows what happened with my tamagotchi clon(e-mach)..is my first complete game i made...lol...i sended it but i cant see it anywhere :(</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
