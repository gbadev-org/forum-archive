<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Why won't it work? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Why won't it work?</h2>
<div id="posts">
<div class="post">
    <h4>#53657 - biubid_boy - Sat Sep 10, 2005 10:23 am</h4>
    <div class="postbody"><span class="postbody">I'm using this code for my pacman clone but I keep getting heaps of errors. They're mainly parse errors and something about conflicting types for CopyOAM. Does anyone know how to fix it? 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "gba.h"
<br/>
#include "bg.h"
<br/>
#include "enemy.h"
<br/>
<br/>
void InitializeSprites(void);
<br/>
void CopyOAM(void);
<br/>
void MoveSprite(OAMEntry* sp, int x, int y);
<br/>
void MoveEnemy(void);
<br/>
<br/>
OAMEntry sprites[128];
<br/>
<br/>
u16 xenemy = 30;
<br/>
u16 yenemy = 50;
<br/>
u16 randomDirection = rand();
<br/>
u16 timer
<br/>
<br/>
u8 enemyDirection = 0;   
<br/>
<br/>
u8 xMax = 240;      
<br/>
u8 yMax = 160;      
<br/>
u8 xMin = 1;      
<br/>
u8 yMin = 1;      
<br/>
<br/>
int main() {
<br/>
    
<br/>
   u16 loop;
<br/>
<br/>
   SetMode(MODE_4 | BG2_ENABLE | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
   for(loop = 0; loop &lt; 256; loop++) {
<br/>
   OBJ_PaletteMem[loop] = enemyPalette[loop];
<br/>
   }
<br/>
<br/>
   for (loop = 0; loop &lt; 256; loop++) {
<br/>
      BG_PaletteMem[loop]=bgPalette[loop];
<br/>
   }
<br/>
<br/>
   for (loop = 0; loop &lt; (120*160); loop++) {
<br/>
      FrontBuffer[loop] = bgData[loop] ;
<br/>
   }
<br/>
<br/>
   memcpy( (u16 *)0x06014000, &amp;enemyData, sizeof(enemyData) );
<br/>
<br/>
   sprites[0].attribute0 = COLOR_256 | SQUARE | yenemy;
<br/>
   sprites[0].attribute1 = SIZE_8 | xenemy;
<br/>
   sprites[0].attribute2 = 512;
<br/>
 
<br/>
while(1)
<br/>
   {
<br/>
      MoveEnemy();
<br/>
      MoveSprite(&amp;sprites[0],xenemy,yenemy);
<br/>
      for (timer = 0; timer &lt; 60; timer++)
<br/>
        {
<br/>
        if(RandomDirection &lt;= 25) {  
<br/>
        enemyDirection == 0;
<br/>
        } else (RandomDirection &lt;= 50) {
<br/>
        enemyDirection == 1; 
<br/>
        } else (RandomDirection &lt;= 75) {
<br/>
        enemyDirection == 2;
<br/>
        } else (RandomDirection &lt;= 100) {
<br/>
        enemyDirection == 3; 
<br/>
        } else (RandomDirection == 100) { 
<br/>
        enemyDirection == 0; }
<br/>
        {
<br/>
        WaitForVsync();
<br/>
      CopyOAM();
<br/>
   } 
<br/>
   
<br/>
    return 0;
<br/>
<br/>
}
<br/>
<br/>
void InitializeSprites(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   for(loop = 0; loop &lt; 128; loop++) {
<br/>
      sprites[loop].attribute0 = 160;
<br/>
      sprites[loop].attribute1 = 240;
<br/>
   }
<br/>
}
<br/>
<br/>
void CopyOAM(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   u16* temp;
<br/>
   temp = (u16*)sprites;
<br/>
   for(loop = 0; loop &lt; 128*4; loop++)   {
<br/>
      OAM_Mem[loop] = temp[loop];
<br/>
   }
<br/>
}
<br/>
<br/>
void MoveSprite(OAMEntry* sp, int x, int y)
<br/>
{
<br/>
   sp-&gt;attribute1 = sp-&gt;attribute1 &amp; 0xFE00;
<br/>
   sp-&gt;attribute1 = sp-&gt;attribute1 | x;
<br/>
<br/>
   sp-&gt;attribute0 = sp-&gt;attribute0 &amp; 0xFF00;
<br/>
   sp-&gt;attribute0 = sp-&gt;attribute0 | y;
<br/>
}
<br/>
<br/>
<br/>
void MoveEnemy(void) {
<br/>
   if (enemyDirection == 0 &amp;&amp; xenemy &lt; xMax &amp;&amp; yenemy &lt; yMax) {
<br/>
      xenemy++;
<br/>
   }
<br/>
   if (enemyDirection == 0 &amp;&amp; (xenemy &gt;= xMax || yenemy &gt;= yMax )) {
<br/>
      if (xenemy &gt;= xMax) {
<br/>
         enemyDirection = 3;
<br/>
      } else {
<br/>
         enemyDirection = 1;
<br/>
      }
<br/>
   }
<br/>
<br/>
   if (enemyDirection == 1 &amp;&amp; xenemy &lt; xMax &amp;&amp; yenemy &gt; yMin) {
<br/>
      xenemy++;
<br/>
   }
<br/>
   if (enemyDirection == 1 &amp;&amp; (xenemy &gt;= xMax || yenemy &lt;= yMin )) {
<br/>
      if (xenemy &gt;= xMax) {
<br/>
         enemyDirection = 2;
<br/>
      } else {
<br/>
         enemyDirection = 0;
<br/>
      }
<br/>
   }
<br/>
<br/>
   if (enemyDirection == 2 &amp;&amp; xenemy &gt; xMin &amp;&amp; yenemy &gt; yMin) {
<br/>
      xenemy--;
<br/>
   }
<br/>
   if (enemyDirection == 2 &amp;&amp; (xenemy &lt;= xMin || yenemy &lt;= yMin )) {
<br/>
      if (xenemy &lt;= xMin) {
<br/>
         enemyDirection = 1;
<br/>
      } else {
<br/>
         enemyDirection = 3;
<br/>
      }
<br/>
   }
<br/>
<br/>
   if (enemyDirection == 3 &amp;&amp; xenemy &gt; xMin &amp;&amp; yenemy &lt; yMax) {
<br/>
      xenemy--;
<br/>
   }
<br/>
   if (enemyDirection == 3 &amp;&amp; (xenemy &lt;= xMin  || yenemy &gt;= yMax)) {
<br/>
      if (xenemy &lt;= xMin) {
<br/>
         enemyDirection = 0;
<br/>
      } else {
<br/>
         enemyDirection = 2;
<br/>
      }
<br/>
   }
<br/>
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If i use </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while(1)
<br/>
   {
<br/>
      MoveBall();
<br/>
      MoveSprite(&amp;sprites[0],xball,yball);
<br/>
      WaitForVsync();
<br/>
      CopyOAM();
<br/>
   }
<br/>
</td> </tr></table><span class="postbody"> Instead of the one in my code, it compiles perfectly. 
<br/>
Thanks for any help,
<br/>
Biubid_boy.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53660 - Fatnickc - Sat Sep 10, 2005 11:20 am</h4>
    <div class="postbody"><span class="postbody">The for loop is your problem, obviously. In my first game, I used while loops for automated character loops, meaning that it 'paused' the rest of the game whilst doing that. Think about it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53666 - biubid_boy - Sat Sep 10, 2005 12:46 pm</h4>
    <div class="postbody"><span class="postbody">Nup, don't get it. Apparently the logic center of my brain isn't developed yet. I need things spelled out for me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53669 - Mighty Max - Sat Sep 10, 2005 1:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
  while(1) { 
<br/>
      MoveEnemy(); 
<br/>
      MoveSprite(&amp;sprites[0],xenemy,yenemy); 
<br/>
      for (timer = 0; timer &lt; 60; timer++)  { 
<br/>
        if(RandomDirection &lt;= 25) {  
<br/>
            enemyDirection == 0; 
<br/>
        } else (RandomDirection &lt;= 50) { 
<br/>
            enemyDirection == 1; 
<br/>
        } else (RandomDirection &lt;= 75) { 
<br/>
            enemyDirection == 2; 
<br/>
        } else (RandomDirection &lt;= 100) { 
<br/>
            enemyDirection == 3; 
<br/>
        } else (RandomDirection == 100) { 
<br/>
            enemyDirection == 0; 
<br/>
        } 
<br/>
        { 
<br/>
            WaitForVsync(); 
<br/>
            CopyOAM(); 
<br/>
   } 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I moved the text a bit around to look where it opens/closes blocks ... guess you cut something out here, or ? At least there is one { to much (just before WaitForVSync();) and one } to less. (Closing the for-loop)
<br/>
<br/>
The code this way does not make much sense tbh.
<br/>
<br/>
There are missing some if too<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53673 - Fatnickc - Sat Sep 10, 2005 2:26 pm</h4>
    <div class="postbody"><span class="postbody">Maybe put the for loop inside a function, and make the equivalant with if statements.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53731 - biubid_boy - Sun Sep 11, 2005 7:49 am</h4>
    <div class="postbody"><span class="postbody">Instead of my for loop, I'm using this
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while(1)
<br/>
   {
<br/>
         MoveEnemy();
<br/>
         MoveSprite(&amp;sprites[0],xenemy,yenemy);
<br/>
         while (1)
<br/>
        {
<br/>
         if (timer &lt; 60) {
<br/>
         timer + 1; }
<br/>
         else if (timer &gt;= 60) {               
<br/>
               if(randomDirection &lt;= 25) {  
<br/>
               enemyDirection == 0;
<br/>
               } else if (randomDirection &lt;= 50) {
<br/>
               enemyDirection == 1; 
<br/>
               } else if(randomDirection &lt;= 75) {
<br/>
               enemyDirection == 2;
<br/>
               } else if(randomDirection &lt;= 100) {
<br/>
               enemyDirection == 3; 
<br/>
               } else if (randomDirection &gt;= 100) { 
<br/>
               enemyDirection == 0; }
<br/>
          }
<br/>
        }</td> </tr></table><span class="postbody">
<br/>
which seems to be working OK. Now I get an error about the decleration of MoveEnemy. Can't see why though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53732 - headspin - Sun Sep 11, 2005 8:07 am</h4>
    <div class="postbody"><span class="postbody">Because you are calling the MoveEnemy() function before it is defined. Place a function prototype above your main() function. It looks like this..
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void MoveSprite(OAMEntry* sp, int x, int y); </td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53736 - biubid_boy - Sun Sep 11, 2005 9:07 am</h4>
    <div class="postbody"><span class="postbody">What the... Now my sprite isn't showing up at all! It was before...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53740 - Fatnickc - Sun Sep 11, 2005 11:08 am</h4>
    <div class="postbody"><span class="postbody">That's because in your post where you said what you are now using, you forgot to add
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">WaitForVsync();
<br/>
copyOAM();</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53825 - biubid_boy - Mon Sep 12, 2005 9:48 am</h4>
    <div class="postbody"><span class="postbody">Ok. Compiled without errors, but my random direction system for the enemy isn't working. This is my code:
<br/>
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "gba.h"
<br/>
#include "bg.h"
<br/>
#include "enemy.h"
<br/>
<br/>
void InitializeSprites(void);
<br/>
void CopyOAM(void);
<br/>
void MoveSprite(OAMEntry* sp, int x, int y);
<br/>
void MoveEnemy(void);
<br/>
<br/>
OAMEntry sprites[128];
<br/>
<br/>
u16 xenemy = 30;
<br/>
u16 yenemy = 50;
<br/>
<br/>
u8 enemyDirection = 0;   
<br/>
<br/>
u8 xMax = 240;      
<br/>
u8 yMax = 160;      
<br/>
u8 xMin = 1;      
<br/>
u8 yMin = 1;      
<br/>
<br/>
int main() {
<br/>
    
<br/>
    u16 randomDirection = rand();
<br/>
    u16 timer = 0;
<br/>
   u16 loop;
<br/>
<br/>
   SetMode(MODE_4 | BG2_ENABLE | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
   for(loop = 0; loop &lt; 256; loop++) {
<br/>
   OBJ_PaletteMem[loop] = enemyPalette[loop];
<br/>
   }
<br/>
<br/>
   for (loop = 0; loop &lt; 256; loop++) {
<br/>
      BG_PaletteMem[loop]=bgPalette[loop];
<br/>
   }
<br/>
<br/>
   for (loop = 0; loop &lt; (120*160); loop++) {
<br/>
      FrontBuffer[loop] = bgData[loop] ;
<br/>
   }
<br/>
<br/>
   memcpy( (u16 *)0x06014000, &amp;enemyData, sizeof(enemyData) );
<br/>
<br/>
   sprites[0].attribute0 = COLOR_256 | SQUARE | yenemy;
<br/>
   sprites[0].attribute1 = SIZE_8 | xenemy;
<br/>
   sprites[0].attribute2 = 512;
<br/>
 
<br/>
while(1)
<br/>
   {
<br/>
      MoveEnemy();
<br/>
      MoveSprite(&amp;sprites[0],xenemy,yenemy);
<br/>
         if (timer &lt; 60) {
<br/>
         timer + 1; }
<br/>
         else if (timer &gt;= 60) {               
<br/>
               if(randomDirection &lt;= 25) {  
<br/>
               enemyDirection == 0;
<br/>
               } else if (randomDirection &lt;= 50) {
<br/>
               enemyDirection == 1; 
<br/>
               } else if(randomDirection &lt;= 75) {
<br/>
               enemyDirection == 2;
<br/>
               } else if(randomDirection &lt;= 100) {
<br/>
               enemyDirection == 3; 
<br/>
               } else if (randomDirection &gt;= 100) { 
<br/>
               enemyDirection == 0; }     }
<br/>
        WaitForVsync();
<br/>
      CopyOAM();
<br/>
 }    
<br/>
   
<br/>
    return 0;
<br/>
<br/>
}
<br/>
<br/>
<br/>
void InitializeSprites(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   for(loop = 0; loop &lt; 128; loop++) {
<br/>
      sprites[loop].attribute0 = 160;
<br/>
      sprites[loop].attribute1 = 240;
<br/>
   }
<br/>
}
<br/>
<br/>
void CopyOAM(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   u16* temp;
<br/>
   temp = (u16*)sprites;
<br/>
   for(loop = 0; loop &lt; 128*4; loop++)   {
<br/>
      OAM_Mem[loop] = temp[loop];
<br/>
   }
<br/>
}
<br/>
<br/>
void MoveSprite(OAMEntry* sp, int x, int y)
<br/>
{
<br/>
   sp-&gt;attribute1 = sp-&gt;attribute1 &amp; 0xFE00;
<br/>
   sp-&gt;attribute1 = sp-&gt;attribute1 | x;
<br/>
<br/>
   sp-&gt;attribute0 = sp-&gt;attribute0 &amp; 0xFF00;
<br/>
   sp-&gt;attribute0 = sp-&gt;attribute0 | y;
<br/>
}
<br/>
<br/>
<br/>
void MoveEnemy(void) {
<br/>
   if (enemyDirection == 0 &amp;&amp; xenemy &lt; xMax &amp;&amp; yenemy &lt; yMax) {
<br/>
      xenemy++;
<br/>
   }
<br/>
   if (enemyDirection == 0 &amp;&amp; (xenemy &gt;= xMax || yenemy &gt;= yMax )) {
<br/>
      if (xenemy &gt;= xMax) {
<br/>
         enemyDirection = 3;
<br/>
      } else {
<br/>
         enemyDirection = 1;
<br/>
      }
<br/>
   }
<br/>
<br/>
   if (enemyDirection == 1 &amp;&amp; xenemy &lt; xMax &amp;&amp; yenemy &gt; yMin) {
<br/>
      xenemy++;
<br/>
   }
<br/>
   if (enemyDirection == 1 &amp;&amp; (xenemy &gt;= xMax || yenemy &lt;= yMin )) {
<br/>
      if (xenemy &gt;= xMax) {
<br/>
         enemyDirection = 2;
<br/>
      } else {
<br/>
         enemyDirection = 0;
<br/>
      }
<br/>
   }
<br/>
<br/>
   if (enemyDirection == 2 &amp;&amp; xenemy &gt; xMin &amp;&amp; yenemy &gt; yMin) {
<br/>
      xenemy--;
<br/>
   }
<br/>
   if (enemyDirection == 2 &amp;&amp; (xenemy &lt;= xMin || yenemy &lt;= yMin )) {
<br/>
      if (xenemy &lt;= xMin) {
<br/>
         enemyDirection = 1;
<br/>
      } else {
<br/>
         enemyDirection = 3;
<br/>
      }
<br/>
   }
<br/>
<br/>
   if (enemyDirection == 3 &amp;&amp; xenemy &gt; xMin &amp;&amp; yenemy &lt; yMax) {
<br/>
      xenemy--;
<br/>
   }
<br/>
   if (enemyDirection == 3 &amp;&amp; (xenemy &lt;= xMin  || yenemy &gt;= yMax)) {
<br/>
      if (xenemy &lt;= xMin) {
<br/>
         enemyDirection = 0;
<br/>
      } else {
<br/>
         enemyDirection = 2;
<br/>
      }
<br/>
   }
<br/>
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53844 - Fatnickc - Mon Sep 12, 2005 5:07 pm</h4>
    <div class="postbody"><span class="postbody">Looks very much like code from Webbesen.dk/gba's tutorial. 
<br/>
If it is based on that, read the original stuff over and check how yours differs.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53904 - biubid_boy - Tue Sep 13, 2005 6:03 am</h4>
    <div class="postbody"><span class="postbody">It's not based off it, but I'll check anyway.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53907 - Fatnickc - Tue Sep 13, 2005 6:52 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">         if (timer &lt; 60) { 
<br/>
         timer + 1; } 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Maybe you should change that to timer += 1; or timer++; ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54022 - Miked0801 - Wed Sep 14, 2005 7:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
         if (timer &lt; 60) { 
<br/>
         timer + 1; } 
<br/>
         else if (timer &gt;= 60) {                
<br/>
               if(randomDirection &lt;= 25) {  
<br/>
               enemyDirection == 0; 
<br/>
               } else if (randomDirection &lt;= 50) { 
<br/>
               enemyDirection == 1; 
<br/>
               } else if(randomDirection &lt;= 75) { 
<br/>
               enemyDirection == 2; 
<br/>
               } else if(randomDirection &lt;= 100) { 
<br/>
               enemyDirection == 3; 
<br/>
               } else if (randomDirection &gt;= 100) { 
<br/>
               enemyDirection == 0; }     } 
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
This is very broken.  Your main loop never updates your timer and your randomDirection is only called once and will never change.  I've also cleaned up some other things here and there to make the code easier to read and maintain.  Your MoveEnemy() function also needs some help, but that I leave to you.  Here:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int main(void) 
<br/>
{ 
<br/>
    u16 randomDirection; 
<br/>
    u16 timer = 0; 
<br/>
    u16 loop; 
<br/>
<br/>
    // Set game to mode 4, sprites on, 1D VRAM
<br/>
    SetMode(MODE_4 | BG2_ENABLE | OBJ_ENABLE | OBJ_MAP_1D); 
<br/>
<br/>
    // Copy both sprite and OBJ palettes into VRAM
<br/>
    for(loop = 0; loop &lt; 256; loop++) 
<br/>
    { 
<br/>
        OBJ_PaletteMem[loop] = enemyPalette[loop]; 
<br/>
        BG_PaletteMem[loop]=bgPalette[loop]; 
<br/>
    } 
<br/>
<br/>
    // Paint first screen
<br/>
    for (loop = 0; loop &lt; (120*160); loop++) 
<br/>
    { 
<br/>
        FrontBuffer[loop] = bgData[loop] ; 
<br/>
    } 
<br/>
<br/>
    // Copy sprite VRAM data
<br/>
    memcpy( (u16 *)0x06014000, &amp;enemyData, sizeof(enemyData) ); 
<br/>
<br/>
    // Setup OAM for sprite
<br/>
    sprites[0].attribute0 = COLOR_256 | SQUARE | yenemy; 
<br/>
    sprites[0].attribute1 = SIZE_8 | xenemy; 
<br/>
    sprites[0].attribute2 = 512; 
<br/>
  
<br/>
    while(1) 
<br/>
    {
<br/>
        // Update enemy and sprite positions
<br/>
        MoveEnemy(); 
<br/>
        MoveSprite(&amp;sprites[0],xenemy,yenemy); 
<br/>
<br/>
        // Don't change direction for a few seconds        
<br/>
        if (timer &gt;= 60) 
<br/>
        {
<br/>
            // Get a number from 0 to 255 I guess???
<br/>
            randomDirection = rand();
<br/>
<br/>
            // Choose a new direction based on random value
<br/>
            enemyDirection = randomDirection / 25;
<br/>
            if(enemyDirection &gt;= 4)
<br/>
            {
<br/>
                 enemyDirection = 0;
<br/>
            }
<br/>
        }
<br/>
<br/>
        // Wait for vblank and copy data
<br/>
        WaitForVsync(); 
<br/>
        CopyOAM(); 
<br/>
<br/>
        // Next tic.
<br/>
        timer++;
<br/>
    }    
<br/>
<br/>
    return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Notice the comments and code spacing/indenting.  This tells in English what is going on and why.  Some people like dense code, I prefer mine spread out just a little bit so I'm reading only 1 idea at a time.  Makes it easier for me to debug and understand.  Good luck!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54246 - biubid_boy - Sat Sep 17, 2005 2:18 am</h4>
    <div class="postbody"><span class="postbody">Thanks Mike! Your code is way more efficient than my one, but it's still not working. I guess it may have something to do with moveEnemy, so I'll check it out.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54330 - biubid_boy - Sun Sep 18, 2005 11:09 am</h4>
    <div class="postbody"><span class="postbody">Umm..... I'm still using the same code, but my sprite keeps getting stuck when it hits the end of the screen.....</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54331 - Fatnickc - Sun Sep 18, 2005 11:13 am</h4>
    <div class="postbody"><span class="postbody">Well it would. In your MoveEnemy function, it checks that xenemy is less than xMin. If it did go off screen totally, you might get some 'chopping' appearing, and a messed up sprite appearing at the other end.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54453 - Miked0801 - Mon Sep 19, 2005 5:16 pm</h4>
    <div class="postbody"><span class="postbody">Your "Logic" for changing sprite direction that I emulated will cause the AI to tend to bounce against the top of the screen forever due to the weight you've given it.  I noticed it originally, but wanted to move your code ideas over as is and let you take a crack at it.  For random movement, you either neeed to bias towards a goal, or weight it completely evenly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54558 - biubid_boy - Tue Sep 20, 2005 12:07 pm</h4>
    <div class="postbody"><span class="postbody">Weight? Do you mean when I do the sizeof thingy?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54600 - Miked0801 - Tue Sep 20, 2005 7:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
               if(randomDirection &lt;= 25) {  
<br/>
               enemyDirection == 0; 
<br/>
               } else if (randomDirection &lt;= 50) { 
<br/>
               enemyDirection == 1; 
<br/>
               } else if(randomDirection &lt;= 75) { 
<br/>
               enemyDirection == 2; 
<br/>
               } else if(randomDirection &lt;= 100) { 
<br/>
               enemyDirection == 3; 
<br/>
               } else if (randomDirection &gt;= 100) { 
<br/>
               enemyDirection == 0; }     } 
<br/>
  </td> </tr></table><span class="postbody">
<br/>
<br/>
This code is setup such that 25 values are assigned to 1, 2, and 3, and 181 values are assigned to direction 0.  That means there is a 7 to 1 bias for your random routine to go direction 0 over any other direction.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54663 - biubid_boy - Wed Sep 21, 2005 12:22 pm</h4>
    <div class="postbody"><span class="postbody">So if I change what I divide by, then my code shouldn't be biased anymore, right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54714 - Miked0801 - Wed Sep 21, 2005 10:01 pm</h4>
    <div class="postbody"><span class="postbody">I'm done, next tutor please.  (Yes, dividing my 64 will fix this problem.  Your task is to tell me why 64 will work.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54786 - tepples - Thu Sep 22, 2005 3:55 pm</h4>
    <div class="postbody"><span class="postbody">There are 256 possible values. Divide by 64 (rounding toward 0, as operator/(int, int) always does) produces four possible values.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54993 - biubid_boy - Sat Sep 24, 2005 9:09 am</h4>
    <div class="postbody"><span class="postbody">I think Mike wanted me to figure that out. Anyway, how come every time I reset VisualBoyAdvance, the enemy moves in the same pattern as before?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55015 - tepples - Sat Sep 24, 2005 5:36 pm</h4>
    <div class="postbody"><span class="postbody">The enemy moves in the same pattern because pseudorandom number generators always produce the same sequence. You have to specify a "seed", or a starting position for the sequence. This is usually generated by calculating the time (in vblanks since power on, and possibly the scanline as well) at which the player presses the start button.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55064 - biubid_boy - Sun Sep 25, 2005 3:51 am</h4>
    <div class="postbody"><span class="postbody">Wait. So you want me to make a 'seed' that counts the vblacks since the start of the game.... How does that make the enemy change its pattern?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55067 - tepples - Sun Sep 25, 2005 4:03 am</h4>
    <div class="postbody"><span class="postbody">The sequence of enemy patterns is usually at least billions of steps long. If you change the seed, it starts the sequence of enemy patterns from a different point in this sequence.
<br/>
<br/>
If you're using a GBA flash card with a documented RTC, or you are on the Nintendo DS, you can use the traditional seed of the current date and time. If you have a savegame, you can checksum the savegame data to get a seed. Otherwise, you need to wait for press start and then use the elapsed time as a seed.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55075 - biubid_boy - Sun Sep 25, 2005 5:31 am</h4>
    <div class="postbody"><span class="postbody">I'll be using this on the M3 (hopefully), but I still need to know how to implement the seed thing and what registers the date and time are.
<br/>
<br/>
BTW: In case you didn't know, M3 has a clock/calendar built in.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55191 - biubid_boy - Mon Sep 26, 2005 5:06 am</h4>
    <div class="postbody"><span class="postbody">Anyone?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55192 - tepples - Mon Sep 26, 2005 5:10 am</h4>
    <div class="postbody"><span class="postbody">I believe the question was "what does the seed do?" which I answered. If not, what was the question again?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55194 - biubid_boy - Mon Sep 26, 2005 5:15 am</h4>
    <div class="postbody"><span class="postbody">I still need to know how to implement the seed thing and what registers the date and time are.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55198 - poslundc - Mon Sep 26, 2005 6:04 am</h4>
    <div class="postbody"><span class="postbody">Since you are using the ANSI rand() function, you should be able to set the seed to any value using the srand() function before the first time you call rand().
<br/>
<br/>
This means you'll have to take the call to rand() out of the variable's declaration in the file scope and declare it in code that you know will be executed after the call to srand().
<br/>
<br/>
It also means that if you want to produce a different set of random numbers each time your program executes, you'll have to come up with a way of passing a different number into srand() each time the program executes. A number of ways have already been suggested.
<br/>
<br/>
Sorry, but I can't help you with the RTC, except to say that there's a good chance that your emulator won't support that kind of custom feature, so it might be a good idea to find a different way.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55199 - biubid_boy - Mon Sep 26, 2005 6:23 am</h4>
    <div class="postbody"><span class="postbody">Every time I try to load a value into srand (eg. srand() = 7) I get an invalid lvalue assignment error.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55200 - Fatnickc - Mon Sep 26, 2005 6:54 am</h4>
    <div class="postbody"><span class="postbody">I think you're meant to use
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">srand(7);</td> </tr></table><span class="postbody">
<br/>
However, you will probably want to use a different number each time. So, use, for example, and integer that you've been incrementing by one every tic, until Start is pressed, in order to seed the rand function 'randomly'. However, as has been mentioned, you'll have to make sure that this is done before using rand().</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55201 - tepples - Mon Sep 26, 2005 6:57 am</h4>
    <div class="postbody"><span class="postbody">Most flash carts' RTCs have the same register level interface as the one used in Pokemon games. Google <a class="postlink" href="http://www.google.com/search?q=gba+rtc+demo" target="_blank">GBA RTC demo</a> gives <a class="postlink" href="http://www.brolinembedded.se/projects/gba_rtc/" target="_blank">a demo by AmPz</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55205 - biubid_boy - Mon Sep 26, 2005 9:32 am</h4>
    <div class="postbody"><span class="postbody">@Fatnickc: I'd tried that before but I thought it must have been wrong because my sprite doesn't move at all when I do it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55214 - Fatnickc - Mon Sep 26, 2005 1:28 pm</h4>
    <div class="postbody"><span class="postbody">Are you sure?
<br/>
Perhaps that's because you were just lucky with the random number you used to get, as it wouldn't change. However, now that we're in the big wide world of seeding our rands, you may, and probably will, get very big numbers sometimes. So, for this, you could use modulus.
<br/>
For example, to get a random number below 160, you could use :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">...
<br/>
srand(s);
<br/>
y=rand()%160;
<br/>
...</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55222 - poslundc - Mon Sep 26, 2005 5:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>biubid_boy wrote:</b></span></td> </tr> <tr> <td class="quote">Every time I try to load a value into srand (eg. srand() = 7) I get an invalid lvalue assignment error.</td> </tr></table><span class="postbody">
<br/>
<br/>
Please read a book or tutorial on C. A large part of the reason you are having difficulty is because you are stumbling on very basic elements of the language.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55248 - biubid_boy - Tue Sep 27, 2005 1:17 am</h4>
    <div class="postbody"><span class="postbody">Sorry. I've been meaning to do some pc programming for a while but never got round to it. Thank you all for your help so far and putting up with my newby questions.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55274 - Fatnickc - Tue Sep 27, 2005 9:07 am</h4>
    <div class="postbody"><span class="postbody">It is very helpful to have a background of some programming. Not only will it enable you to code a few lines without having to look up how to do something, but it will mean that you have ideas of how you could solve problems, and which solution would work the best.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
