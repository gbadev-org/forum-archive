<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Pixel collsion problems - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Pixel collsion problems</h2>
<div id="posts">
<div class="post">
    <h4>#41117 - Strobe - Mon Apr 25, 2005 2:09 pm</h4>
    <div class="postbody"><span class="postbody">Hi All,
<br/>
<br/>
I've only just started off coding for the GBA and so far i've made some great progress thanks to the wealth of onfo available on this forum. I'm going to stick my neck out though and ask for help on a problem that i haven't been able to find any previous postings for.
<br/>
<br/>
Please excuse me if this doesn't make any sense.
<br/>
<br/>
I've been playing aroud with collision detection for a sprite against a text background. I created a collision map with MapEd and have been able to get bounding box detection working with thanks to staringmonkey and his RPG demo code. However I've also been wanting to do some some per pixel detection  and tried playing around with the function in staringmonkeys code. This seems to work when i use a sprite that is only 1 tile wide and however many high but doesn't if the sprite is 2 or more tiles wide. I'm trying to do a 16 x 16 sprite with some transparency around the edges. After using pcx2gba to create the sprite data and setting the transparent pixels to value 0 i can display the sprite with no problems however i can't get the collision detection routine to work correctly.
<br/>
<br/>
I'm using 1D mapping for the sprites and the problems seems to be with indexing the current pixel being processed for collision against the sprite data to see if it is transparent(solid or not). I'm checking the sprite data just as below
<br/>
<br/>
for(y = 0; y &lt; height; y++) //Height is 16
<br/>
	{
<br/>
	for(x = 0; x &lt; width; x++) //Width is 16
<br/>
		{
<br/>
		if(sprite[y*width+x])
<br/>
<br/>
I can see from looking at the sprite data produced by pcx2gba that it is arranged tile by tile and not in a linear fashion like a bitmap. If that makes sense.
<br/>
<br/>
In other words if the value checked evaluates to
<br/>
<br/>
if(sprite[10]) 
<br/>
<br/>
then this will check the 10th pixel of the 1st tile rather than the 2nd pixel of the secod tile along the top.
<br/>
<br/>
I'm guessing i need to calculate some kind of offset based on the number and format of the tiles in the sprite?
<br/>
<br/>
This probably makes no sense as i've gone round in circles and got my head too far into the problem to step back. Either that or there is a much better way of doing pixel level collision?
<br/>
<br/>
However, if anyone can understand the issue i'm having and can offer a solution i would be most grateful.
<br/>
<br/>
Thanks again</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41126 - sajiimori - Mon Apr 25, 2005 5:47 pm</h4>
    <div class="postbody"><span class="postbody">A better way is to store collision data seperately, using 1 bit per pixel in a linear array.  Then you can collide pairs of rows with just a bitwise 'and'.  If the result is nonzero, there was a collision.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41127 - Strobe - Mon Apr 25, 2005 6:00 pm</h4>
    <div class="postbody"><span class="postbody">Thanks Sajiimori,
<br/>
<br/>
I'd liketo give it a go, However.....
<br/>
<br/>
What method would you use to create the collision data. Can this be created by reading in the sprite data in a certain way so that it is  formated in a linear fashion?
<br/>
<br/>
Sorry if i seem a little sloooow, kinda new to this.
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41130 - sajiimori - Mon Apr 25, 2005 8:03 pm</h4>
    <div class="postbody"><span class="postbody">Well, you could read back the tiled graphics into a linear array, but if you've got your original bitmap files, you could use a library that can read that format directly.
<br/>
<br/>
Beyond that, if you know how to read and write files, and you know how to do bitwise operations, that's all you should need.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
