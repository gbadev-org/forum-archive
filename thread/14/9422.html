<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Linker script, crt0 and compiler issues - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Linker script, crt0 and compiler issues</h2>
<div id="posts">
<div class="post">
    <h4>#81638 - Legolas - Sun Apr 30, 2006 8:21 pm</h4>
    <div class="postbody"><span class="postbody">Really I don't know if tis is the right place where I should start this thread, but... :)
<br/>
<br/>
Briefly: I'm working on a porting of the <a class="postlink" href="http://www.freepascal.org" target="_blank">freepascal compiler</a> for gba. Most of the work on the compiler itself is done, and I'm able to compile some small demos with it, by using a reduced crt0.s file taken from somewhere (really I don't remember where). 
<br/>
Now that all seems working fine, I would like to use Jeff Frohwein's crt0 &amp; linkerscript. The problem is that, using it, all rtti and resource strings (coming from freepascal rtl) are put in .bss at 0x03000000, making the executable not working on gba. 
<br/>
Assumed that I don't know anything about linker scripts, can someone point me towards a solution?
<br/>
<br/>
Thanks in Advance :)<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81661 - tepples - Mon May 01, 2006 12:23 am</h4>
    <div class="postbody"><span class="postbody">Any constants should be put in section ".rodata".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81670 - wintermute - Mon May 01, 2006 1:44 am</h4>
    <div class="postbody"><span class="postbody">You might also care to look at building your compiler with MinGW rather than cygwin. You'll end up with a faster compiler that doesn't depend on cygwin1.dll.
<br/>
<br/>
The devkitARM buildscripts contain the necessary patches for building binutils with MinGW. <a href="http://sourceforge.net/project/showfiles.php?group_id=114505&amp;package_id=124206" target="_blank">http://sourceforge.net/project/showfiles.php?group_id=114505&amp;package_id=124206</a><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81697 - Legolas - Mon May 01, 2006 2:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">You might also care to look at building your compiler with MinGW rather than cygwin. You'll end up with a faster compiler that doesn't depend on cygwin1.dll.
<br/>
<br/>
The devkitARM buildscripts contain the necessary patches for building binutils with MinGW. <a href="http://sourceforge.net/project/showfiles.php?group_id=114505&amp;package_id=124206" target="_blank">http://sourceforge.net/project/showfiles.php?group_id=114505&amp;package_id=124206</a></td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, in fact I'm using binutils from your devkitARM<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81875 - Legolas - Tue May 02, 2006 4:30 pm</h4>
    <div class="postbody"><span class="postbody">After a bit of investigation I have found that fpc compiler puts resource strings and RTTI infos in .data segment. It is possible to safely move it in .rodata?<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81883 - tepples - Tue May 02, 2006 5:04 pm</h4>
    <div class="postbody"><span class="postbody">Any data that will never be modified can go in .rodata. Is there a specification for the language that fpc accepts? If so, does this specification permit a program to overwrite a string constant? If not, then a string constant will never be modified, and it can go in .rodata.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81887 - wintermute - Tue May 02, 2006 5:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Legolas wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Yes, in fact I'm using binutils from your devkitARM
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
cool :) Why do you have cygwin1.dll in the packages though?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
After a bit of investigation I have found that fpc compiler puts resource strings and RTTI infos in .data segment. It is possible to safely move it in .rodata?</td> </tr></table><span class="postbody">
<br/>
<br/>
That should work provided the application doesn't expect to be able to write to that data. I'd imagine resource strings could be moved to .rodata with few problems but I'm not sure about RTTI.
<br/>
<br/>
You could place .data in EWRAM to give you some breathing space.
<br/>
<br/>
Remember that the .data section needs to be copied from ROM to RAM by the crt0.
<br/>
<br/>
Most of the standard crt0/linkscript combinations place the stack, .data and .bss in the 32K iwram.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81889 - Legolas - Tue May 02, 2006 5:28 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I'll try to put all in EWRAM :)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Legolas wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Yes, in fact I'm using binutils from your devkitARM
<br/>
</td> </tr></table><span class="postbody">
<br/>
cool :) Why do you have cygwin1.dll in the packages though?
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Well the package in my site is an old version. Now I'm working on a new version that should be fast enough to make games for gba with pascal too :)<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83111 - Legolas - Sat May 13, 2006 1:21 am</h4>
    <div class="postbody"><span class="postbody">So, I have tryed to move around things among sections, but still does not work. I have found that the problem is that the executable suffers of bad alignment, but only if I link 2 or more objects in it.
<br/>
<br/>
For example: an excutable made of prt0.o, main.o and system.o works, but another made of eg. prt0.o, main.o, system.o and math.o doesn't.<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83158 - wintermute - Sat May 13, 2006 2:19 pm</h4>
    <div class="postbody"><span class="postbody">Can you give me some more details of what you mean by bad alignment? A specific example of source, link command line and a mapfile would help. You can output a mapfile using arm-elf-ld -Map mapfile.txt ...<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83161 - Legolas - Sat May 13, 2006 2:50 pm</h4>
    <div class="postbody"><span class="postbody">Yes, sorry ^_^
<br/>
Because of size of map file, I have uploaded all <a class="postlink" href="http://www.uppo.it/download.php?file=06511e1445b1ee2524adec726da0fcdd" target="_blank">here</a> (makefile, source, map file, ...).<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83188 - wintermute - Sun May 14, 2006 12:50 am</h4>
    <div class="postbody"><span class="postbody">From a brief look at the rom with no$gba it seems to be blowing it's stack.
<br/>
<br/>
Try shifting the .data section into ewram to start with
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
OUTPUT_FORMAT("elf32-littlearm", "elf32-bigarm", "elf32-littlearm")
<br/>
OUTPUT_ARCH(arm)
<br/>
ENTRY(_start)
<br/>
<br/>
<br/>
<br/>
<br/>
MEMORY {
<br/>
   rom      : ORIGIN = 0x08000000, LENGTH = 32M
<br/>
   iwram   : ORIGIN = 0x03000000, LENGTH = 32K
<br/>
   ewram   : ORIGIN = 0x02000000, LENGTH = 256K
<br/>
}
<br/>
<br/>
__text_start       =   0x8000000;
<br/>
__eheap_end         =   0x2040000;
<br/>
__iwram_start      =   0x3000000;
<br/>
__iwram_end         =   0x3008000;
<br/>
<br/>
__sp_irq         =   __iwram_end - 0x100;
<br/>
__sp_usr         =   __sp_irq - 0x100;
<br/>
<br/>
<br/>
<br/>
SECTIONS
<br/>
{
<br/>
<br/>
   . = __text_start;
<br/>
   .init :
<br/>
   {
<br/>
      KEEP (*(.init))
<br/>
      . = ALIGN(4);
<br/>
   } &gt;rom =0xff
<br/>
<br/>
   .plt :
<br/>
   {
<br/>
      *(.plt)
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom
<br/>
<br/>
   .text :   /* ALIGN (4): */
<br/>
   {
<br/>
      *(EXCLUDE_FILE (*.iwram*) .text)
<br/>
      *(.text.*)
<br/>
      *(.stub)
<br/>
      /* .gnu.warning sections are handled specially by elf32.em.  */
<br/>
      *(.gnu.warning)
<br/>
      *(.gnu.linkonce.t*)
<br/>
      *(.glue_7)
<br/>
      *(.glue_7t)
<br/>
      . = ALIGN(4);  /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom = 0xff
<br/>
<br/>
   __text_end = .;
<br/>
   .fini           :
<br/>
   {
<br/>
      KEEP (*(.fini))
<br/>
      . = ALIGN(4);  /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom =0
<br/>
<br/>
   .rodata :
<br/>
   {
<br/>
      *(.rodata)
<br/>
      *all.rodata*(*)
<br/>
      *(.roda)
<br/>
      *(.rodata.*)
<br/>
      *(.gnu.linkonce.r*)
<br/>
      SORT(CONSTRUCTORS)
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom = 0xff
<br/>
<br/>
   .ctors :
<br/>
   {
<br/>
      /*   gcc uses crtbegin.o to find the start of the constructors, so
<br/>
         we make sure it is first.  Because this is a wildcard, it
<br/>
         doesn't matter if the user does not actually link against
<br/>
         crtbegin.o; the linker won't look for a file to match a
<br/>
         wildcard.  The wildcard also means that it doesn't matter which
<br/>
         directory crtbegin.o is in.  */
<br/>
      KEEP (*crtbegin.o(.ctors))
<br/>
      KEEP (*(EXCLUDE_FILE (*crtend.o) .ctors))
<br/>
      KEEP (*(SORT(.ctors.*)))
<br/>
      KEEP (*(.ctors))
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
  } &gt;rom = 0
<br/>
<br/>
   .dtors :
<br/>
   {
<br/>
      KEEP (*crtbegin.o(.dtors))
<br/>
      KEEP (*(EXCLUDE_FILE (*crtend.o) .dtors))
<br/>
      KEEP (*(SORT(.dtors.*)))
<br/>
      KEEP (*(.dtors))
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom = 0
<br/>
<br/>
   .jcr            : { KEEP (*(.jcr)) } &gt;rom 
<br/>
<br/>
   .eh_frame :
<br/>
   {
<br/>
      KEEP (*(.eh_frame))
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom = 0
<br/>
<br/>
   .gcc_except_table :
<br/>
   {
<br/>
      *(.gcc_except_table)
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;rom = 0
<br/>
<br/>
<br/>
<br/>
<br/>
   __iwram_lma = .;
<br/>
<br/>
   .iwram __iwram_start : AT (__iwram_lma)
<br/>
   {
<br/>
      __iwram_start = ABSOLUTE(.) ;
<br/>
      *(.iwram)
<br/>
      *iwram.*(.text)
<br/>
      . = ALIGN(4);   /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;iwram = 0xff
<br/>
<br/>
   __iwram_end = . ;
<br/>
<br/>
   .bss ALIGN(4) :
<br/>
   {
<br/>
      __bss_start = ABSOLUTE(.);
<br/>
      __bss_start__ = ABSOLUTE(.);
<br/>
      *(.dynbss)
<br/>
      *(.gnu.linkonce.b*)
<br/>
      *(.bss*)
<br/>
      *(COMMON)
<br/>
      . = ALIGN(4);    /* REQUIRED. LD is flaky without it. */
<br/>
   } &gt;iwram
<br/>
<br/>
   __bss_end = . ;
<br/>
   __bss_end__ = . ;
<br/>
<br/>
<br/>
   __iwram_overlay_lma = __iwram_lma + SIZEOF(.iwram);
<br/>
<br/>
   __iwram_overlay_start = . ;
<br/>
<br/>
   OVERLAY ALIGN(4) : NOCROSSREFS AT (__iwram_overlay_lma)
<br/>
   {
<br/>
      .iwram0 { *(.iwram0) . = ALIGN(4);}
<br/>
      .iwram1 { *(.iwram1) . = ALIGN(4);}
<br/>
      .iwram2 { *(.iwram2) . = ALIGN(4);}
<br/>
      .iwram3 { *(.iwram3) . = ALIGN(4);}
<br/>
      .iwram4 { *(.iwram4) . = ALIGN(4);}
<br/>
      .iwram5 { *(.iwram5) . = ALIGN(4);}
<br/>
      .iwram6 { *(.iwram6) . = ALIGN(4);}
<br/>
      .iwram7 { *(.iwram7) . = ALIGN(4);}
<br/>
      .iwram8 { *(.iwram8) . = ALIGN(4);}
<br/>
      .iwram9 { *(.iwram9) . = ALIGN(4);}
<br/>
   }&gt;iwram = 0xff
<br/>
<br/>
<br/>
<br/>
<br/>
   __ewram_lma = LOADADDR(.iwram0) + SIZEOF(.iwram0)+SIZEOF(.iwram1)+SIZEOF(.iwram2)+SIZEOF(.iwram3)+SIZEOF(.iwram4)+SIZEOF(.iwram5)+SIZEOF(.iwram6)+SIZEOF(.iwram7)+SIZEOF(.iwram8)+SIZEOF(.iwram9);
<br/>
<br/>
   __iwram_overlay_end = . ;
<br/>
   __iheap_start = . ;
<br/>
<br/>
   __ewram_start = 0x2000000;
<br/>
   .ewram __ewram_start : AT (__ewram_lma)
<br/>
   {
<br/>
      *(.ewram)
<br/>
      . = ALIGN(4);  /* REQUIRED. LD is flaky without it. */
<br/>
   }&gt;ewram = 0xff
<br/>
<br/>
   __data_lma = __ewram_lma + SIZEOF(.ewram) ;
<br/>
<br/>
   .data ALIGN(4) : AT (__data_lma)
<br/>
   {
<br/>
      __data_start = ABSOLUTE(.);
<br/>
      *(.data)
<br/>
      *(.data.*)
<br/>
      *(.gnu.linkonce.d*)
<br/>
      CONSTRUCTORS
<br/>
      . = ALIGN(4);
<br/>
   } &gt;ewram = 0xff
<br/>
<br/>
   __data_end  =  .;
<br/>
<br/>
   __ewram_overlay_lma = __data_lma + SIZEOF(.data);
<br/>
<br/>
   .sbss ALIGN(4):
<br/>
    {
<br/>
      __sbss_start = ABSOLUTE(.);
<br/>
       *(.sbss)
<br/>
       . = ALIGN(4);
<br/>
    } &gt;ewram
<br/>
   
<br/>
   __sbss_end  = .;
<br/>
<br/>
   __ewram_end = . ;
<br/>
   __ewram_overlay_start = . ;
<br/>
<br/>
   OVERLAY ALIGN(4): NOCROSSREFS AT (__ewram_overlay_lma)
<br/>
   {
<br/>
      .ewram0 { *(.ewram0) . = ALIGN(4);}
<br/>
      .ewram1 { *(.ewram1) . = ALIGN(4);}
<br/>
      .ewram2 { *(.ewram2) . = ALIGN(4);}
<br/>
      .ewram3 { *(.ewram3) . = ALIGN(4);}
<br/>
      .ewram4 { *(.ewram4) . = ALIGN(4);}
<br/>
      .ewram5 { *(.ewram5) . = ALIGN(4);}
<br/>
      .ewram6 { *(.ewram6) . = ALIGN(4);}
<br/>
      .ewram7 { *(.ewram7) . = ALIGN(4);}
<br/>
      .ewram8 { *(.ewram8) . = ALIGN(4);}
<br/>
      .ewram9 { *(.ewram9) . = ALIGN(4);}
<br/>
   }&gt;ewram = 0xff
<br/>
<br/>
   __pad_lma = LOADADDR(.ewram0) + SIZEOF(.ewram0)+SIZEOF(.ewram1)+SIZEOF(.ewram2)+SIZEOF(.ewram3)+SIZEOF(.ewram4)+SIZEOF(.ewram5)+SIZEOF(.ewram6)+SIZEOF(.ewram7)+SIZEOF(.ewram8)+SIZEOF(.ewram9);
<br/>
<br/>
   /* EZF Advance strips trailing 0xff bytes, add a pad section so nothing important is removed */
<br/>
   .pad ALIGN(4) : AT (__pad_lma)
<br/>
   {
<br/>
      LONG(0x52416b64)
<br/>
      LONG(0x4d)
<br/>
      . = ALIGN(4);  /* REQUIRED. LD is flaky without it. */
<br/>
   } = 0xff
<br/>
<br/>
   __ewram_overlay_end = . ;
<br/>
   __eheap_start = . ;
<br/>
<br/>
   _end = .;
<br/>
   __end__ = _end ; /* v1.3 */
<br/>
   PROVIDE (end = _end); /* v1.3 */
<br/>
<br/>
<br/>
<br/>
<br/>
   /* Stabs debugging sections.  */
<br/>
   .stab 0 : { *(.stab) }
<br/>
   .stabstr 0 : { *(.stabstr) }
<br/>
   .stab.excl 0 : { *(.stab.excl) }
<br/>
   .stab.exclstr 0 : { *(.stab.exclstr) }
<br/>
   .stab.index 0 : { *(.stab.index) }
<br/>
   .stab.indexstr 0 : { *(.stab.indexstr) }
<br/>
   .comment 0 : { *(.comment) }
<br/>
   /*   DWARF debug sections.
<br/>
      Symbols in the DWARF debugging sections are relative to the beginning
<br/>
      of the section so we begin them at 0.  */
<br/>
   /* DWARF 1 */
<br/>
   .debug          0 : { *(.debug) }
<br/>
   .line           0 : { *(.line) }
<br/>
   /* GNU DWARF 1 extensions */
<br/>
   .debug_srcinfo  0 : { *(.debug_srcinfo) }
<br/>
   .debug_sfnames  0 : { *(.debug_sfnames) }
<br/>
   /* DWARF 1.1 and DWARF 2 */
<br/>
   .debug_aranges  0 : { *(.debug_aranges) }
<br/>
   .debug_pubnames 0 : { *(.debug_pubnames) }
<br/>
   /* DWARF 2 */
<br/>
   .debug_info     0 : { *(.debug_info) }
<br/>
   .debug_abbrev   0 : { *(.debug_abbrev) }
<br/>
   .debug_line     0 : { *(.debug_line) }
<br/>
   .debug_frame    0 : { *(.debug_frame) }
<br/>
   .debug_str      0 : { *(.debug_str) }
<br/>
   .debug_loc      0 : { *(.debug_loc) }
<br/>
   .debug_macinfo  0 : { *(.debug_macinfo) }
<br/>
   /* SGI/MIPS DWARF 2 extensions */
<br/>
   .debug_weaknames 0 : { *(.debug_weaknames) }
<br/>
   .debug_funcnames 0 : { *(.debug_funcnames) }
<br/>
   .debug_typenames 0 : { *(.debug_typenames) }
<br/>
   .debug_varnames  0 : { *(.debug_varnames) }
<br/>
   .stack 0x80000 : { _stack = .; *(.stack) }
<br/>
   /* These must appear regardless of  .  */
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
This linkscript can probably be reduced quite a bit as well - you don't really need the overlay sections and I don't think you need the constructor &amp; destructor stuff.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83191 - Legolas - Sun May 14, 2006 1:07 am</h4>
    <div class="postbody"><span class="postbody">I tryed this liker script, but unfortunately <a class="postlink" href="http://www.uppo.it/download.php?file=c4716d0ac5fd13d5ce6cfd6c29570b91" target="_blank">same result</a>.  At least now I have all stuff in the right places ^_^<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83254 - wintermute - Sun May 14, 2006 4:03 pm</h4>
    <div class="postbody"><span class="postbody">I don't see anything that's misaligned in the map output, everything seems to be on 4 byte boundaries.
<br/>
<br/>
There appears to be a problem somewhere inside SYSTEM_ALLOC_OSCHUNK$LONGINT$LONGINT$$POINTER which, from it's name, I'd guess is trying to allocate memory. How does Free Pascal determine where it's free memory is addressed?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83453 - Legolas - Tue May 16, 2006 2:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
There appears to be a problem somewhere inside SYSTEM_ALLOC_OSCHUNK$LONGINT$LONGINT$$POINTER which, from it's name, I'd guess is trying to allocate memory. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks to your help I have found the bug. That call (SYSTEM_ALLOC_OSCHUNK) grows the heap; Freepascal does not have a flag to disable heap allocation, so I have made some changes to disable it and now it works :)<br/>_________________<br/><a class="postlink" href="http://itaprogaming.free.fr/" target="_blank">My homepage</a>!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
