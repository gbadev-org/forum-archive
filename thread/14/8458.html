<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dialog System - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Dialog System</h2>
<div id="posts">
<div class="post">
    <h4>#70562 - Sasami-chan - Tue Feb 07, 2006 9:50 am</h4>
    <div class="postbody"><span class="postbody">Call me an idiot. know how to print text onto the screen, but I can't seem to figure out a way to efficiently store dialog text. How are dialog text stored in commercial games? Please help! A pointer to some kind of tutorial is deeply appreciated. I did a search on the forum before posting, but I couldn't find anything. Thanks! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70563 - sgeos - Tue Feb 07, 2006 10:29 am</h4>
    <div class="postbody"><span class="postbody">You'll want to write custom tools to convert your messages to a format like this:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;stdio.h&gt;
<br/>
<br/>
const char msg_000[] = "";
<br/>
const char msg_001[] = "Hello world!";
<br/>
const char msg_002[] = "Do you like cheese?";
<br/>
const char msg_003[] = "Yes";
<br/>
const char msg_004[] = "No";
<br/>
<br/>
const char const *const msg[] =
<br/>
{
<br/>
   msg_000,
<br/>
   msg_001,
<br/>
   msg_002,
<br/>
   msg_003,
<br/>
   msg_004,
<br/>
};
<br/>
<br/>
const int msg_cnt = sizeof(msg) / sizeof(const char *const);
<br/>
<br/>
int main(void)
<br/>
{
<br/>
   int i;
<br/>
<br/>
   for (i = 0; i &lt; msg_cnt; i++)
<br/>
      printf("%s\n", msg[i]);
<br/>
   return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70592 - naleksiev - Tue Feb 07, 2006 3:57 pm</h4>
    <div class="postbody"><span class="postbody">I'm a big fan of C# so all the tools that I create are using C#. For storing the texts in my game I use XML file that describe my texts. Than I have a tool that transform this texts in better format for using it with GBA/C++.
<br/>
<br/>
For example my xml is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">&lt;texts&gt;
<br/>
   &lt;text id="HELLO" value="Hello World!"/&gt;
<br/>
   &lt;text id="CHEESE" value="Do you like cheese?"/&gt;
<br/>
   &lt;text id="YES" value="Yes"/&gt;
<br/>
   &lt;text id="NO" value="No"/&gt;
<br/>
&lt;/texts&gt;</td> </tr></table><span class="postbody">
<br/>
<br/>
The tool that I create for my game read this XML and generate 2 files. One is with defines:
<br/>
<br/>
texts.h
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define STR_HELLO 0
<br/>
#define STR_CHEESE 1
<br/>
#define STR_YES 2
<br/>
#define STR_NO 3</td> </tr></table><span class="postbody">
<br/>
<br/>
that contain in the begining offset of every text in 2 bytes so in this case I will have 8 bytes with the offsets of the strings. Than I have the strings and after every string I have 0 byte. So you can directly use it with char*.
<br/>
<br/>
I have one small function char* getString(u16 id); that I use like getString(STR_HELLO);
<br/>
<br/>
There are some advantages to use this than hard coded string. 
<br/>
<br/>
 - You can verry easely localize your game. 
<br/>
 - If you want to rearange something in your strings like if you want to add one more greating message after Hello World (just to group the texts in more butiful order) you don't need to change enything in your code. just the texts.h file will be regenerated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70593 - ScottLininger - Tue Feb 07, 2006 4:16 pm</h4>
    <div class="postbody"><span class="postbody">You can also store your dialog right inside your "scripting" code. Here's an example of code that gets compiled right into the game, where the main character speaks with his superior officer:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (getVar(currentAssignment) == NOASSIGNMENT) {
<br/>
    
<br/>
    Speak(ALVIN,"Excuse me, are you the Chief? My name is Alvin. I just got here and I was told to report...");
<br/>
    WaitForButton();
<br/>
    Speak(WILLIAM,"I know who are, son, and yes, I'm the Chief, but everyone calls me William. We don't have time for formalities around here.");
<br/>
    WaitForButton();
<br/>
    Speak(WILLIAM,"We'll get you settled in, but first I have an assignment for you. My coffee mug is empty. I need a refill. Now.");
<br/>
    setVar(currentAssignment,GETCOFFEE);
<br/>
  
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
The "Speak" function would look something like this. It essentially just calls your text-writing function. The important part is the const char *myString. That's how you can pass a string to a function.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void Speak(int characterID,const char *myString) {
<br/>
   
<br/>
    DisplayDialogBox(characterID);
<br/>
    BlitString(str);
<br/>
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I agree with Brendan that eventually, you may want to write your own "map building" tool that allow you to attach dialog to characters and events within a simplified GUI, then have the tool output the code.
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70658 - Miked0801 - Wed Feb 08, 2006 1:20 am</h4>
    <div class="postbody"><span class="postbody">We Huffman compress our text and store a bit offset to each string.  33% compression or so after the lookup overhead.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70664 - tepples - Wed Feb 08, 2006 1:45 am</h4>
    <div class="postbody"><span class="postbody">Have you tried huffword? Huffword involves mapping each word (segment of alphanumeric characters) or nonword (segment of non-alphanumeric characters) to an integer symbol and then Huffman-compressing those.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70850 - Sasami-chan - Thu Feb 09, 2006 2:16 am</h4>
    <div class="postbody"><span class="postbody">These are exactly the kind of answers I was looking for.
<br/>
Thank you all so much!
<br/>
I kept trying to think of a way to store the script externally...
<br/>
Can't wait to go home and try some things tonight! :)
<br/>
<br/>
Does there exist a tool for converting XML scripts into codes?
<br/>
If not, I will definitely be writing one to save myself the hassle.
<br/>
And if everything works out, I will try a Huffword implementation to reduce the file size.
<br/>
<br/>
ScottLininger, that's one wicked script. Very funny!
<br/>
<br/>
Thanks again, guys! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71019 - tepples - Fri Feb 10, 2006 12:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ScottLininger wrote:</b></span></td> </tr> <tr> <td class="quote">You can also store your dialog right inside your "scripting" code. Here's an example of code that gets compiled right into the game, where the main character speaks with his superior officer:</td> </tr></table><span class="postbody">
<br/>
Watch out. If you want to distribute your game outside the United States, the United Kingdom, Australia, and New Zealand, then you're not going to want to make things <span style="font-style: italic">harder</span> for your translators by putting human-language scripts into C code.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
