<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How do I scroll? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > How do I scroll?</h2>
<div id="posts">
<div class="post">
    <h4>#38338 - utilizes - Sat Mar 26, 2005 12:53 pm</h4>
    <div class="postbody"><span class="postbody">Hello. I have been doing Mode 4 games for a few months now, but now I wish to go onto scrolling. I used the Webbesen tutorial. I have read the FAQ but it does not detail how to do it. Could somebody please tell me how to do this ot show me a place where I can learn this?
<br/>
I have looked at the Pern Project, but recently the scrolling is not there, and I never had the chance to look at it. 
<br/>
Thank you for your hopeful replies,
<br/>
Utilizes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38339 - Wriggler - Sat Mar 26, 2005 1:32 pm</h4>
    <div class="postbody"><span class="postbody">Look for a tutorial on Mode 0 graphics. You'll need to load tiles and maps into memory in a certain way, and then it's just a case of updating a single register to do scrolling. It's easy, once you've got it all set up.
<br/>
<br/>
Ben</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38343 - Kyoufu Kawa - Sat Mar 26, 2005 3:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define REG_BG0HOFS 0x04000010 //found in several forms in several available headers
<br/>
<br/>
u16 myScrollCounter;
<br/>
<br/>
//elsewhere...
<br/>
myScrollCounter++; //or whatever you wanted to do...
<br/>
<br/>
//after VBlank...
<br/>
*(vu16 *)REG_BG0HOFS = myScrollCounter;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Quick and easy. Thankyoudrivethrough.
<br/>
<br/>
Edit: That's the register thingy Wriggler just mentioned.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38345 - utilizes - Sat Mar 26, 2005 3:19 pm</h4>
    <div class="postbody"><span class="postbody">Thank you! Can scrolling be done only in Mode 0?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38346 - Kyoufu Kawa - Sat Mar 26, 2005 3:30 pm</h4>
    <div class="postbody"><span class="postbody">Very muchly not. Lemme look it up...
<br/>
<br/>
Nope. Scrolling in this manner works for any non-rotscale background layer, so that's all four layers in mode 0 and the first two in mode 1. Any rotating/scaling layer needs a different approach, which applies to BG2 in mode 1 and BG2 and 3 in mode 2, which lacks BGs 0 and 1.
<br/>
<br/>
I suggest, unless you need a rotscaling layer, that you stick to mode 0.</span><span class="gensmall"><br/><br/>Last edited by Kyoufu Kawa on Sat Mar 26, 2005 3:34 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#38347 - ymalik - Sat Mar 26, 2005 3:30 pm</h4>
    <div class="postbody"><span class="postbody">No, you can do it mode 4, too, but it's just easier in mode 0.  In mode 4 you'll have to work with two buffers in VRAM:  when one buffer is being drawn, update the second buffer, and then swap the two buffer (this requires simply flipping a big in a register).  Of course, if you want to scroll a massive image in mode 0, that's much harder.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38350 - Kyoufu Kawa - Sat Mar 26, 2005 3:36 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, massive maps kill a newbie a day. But at least Util now knows how to work the registers.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38356 - utilizes - Sat Mar 26, 2005 4:11 pm</h4>
    <div class="postbody"><span class="postbody">I now understand how it works and what it should do, but i do not know how to implement it. I have looked at the tutorial "Backgrounds in Modes 0-1-2" but it does not show how to actually do it. Could one of you please point me in the right direction?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38371 - ymalik - Sat Mar 26, 2005 7:41 pm</h4>
    <div class="postbody"><span class="postbody">Try scrolling around in 256x256 background first.  Load the tileset and tilemap data created from gfx2gba and based on the arrow key, either decrement or increment the x, y values.  Then load the x, y values into the offset registers of the background.  Checkout chapter 6 of <a class="postlink" href="http://www.jharbour.com/gameboy/default.aspx" target="_blank">Harbour's book</a> to how to do it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38375 - utilizes - Sat Mar 26, 2005 8:07 pm</h4>
    <div class="postbody"><span class="postbody">As I have never done tile modes, i really do not understand the J Harbour E-Book chapter you just mentioned. Also, I use devkitadv. As for some reason I can't download anything from the gbadev.org site (it says the HTTP referrer doesn't allow me to do anything).. I can't download any source codes. Does anyone have alternate addresses for code? Thank you..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38409 - ymalik - Sun Mar 27, 2005 4:39 am</h4>
    <div class="postbody"><span class="postbody">If you're new to GBA programming, I recommend using <a class="postlink" href="http://www.ngine.de/modules.php?name=Downloads&amp;d_op=viewdownload&amp;cid=1" target="_blank">HAM</a>.    This has everything you need to start developing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38415 - utilizes - Sun Mar 27, 2005 9:07 am</h4>
    <div class="postbody"><span class="postbody">But I can cope fine with DevkitAdv, just not scrolling.. Oh well, I will give it a try.. Still, if anyone does have any code for me, you know who I am.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38427 - ymalik - Sun Mar 27, 2005 6:14 pm</h4>
    <div class="postbody"><span class="postbody">Here is some code:
<br/>
<a href="http://www.cs.stevens.edu/~ymalik/tilemode0.zip" target="_blank">http://www.cs.stevens.edu/~ymalik/tilemode0.zip</a>
<br/>
<br/>
It is from Harbour's book with some modifications.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38431 - utilizes - Sun Mar 27, 2005 8:22 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for that file, and it works with DevKit Adv, but there is one problem. WhenI try to change the background, it looks absolutely nothing like the one I actually made. could you try changing the background, and if it works tell me how?
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38453 - ymalik - Mon Mar 28, 2005 1:27 am</h4>
    <div class="postbody"><span class="postbody">That's probably because you are using an 8 BPP image.  Use a program like PictView32 to reduce the palette to 4 BPP.  Make sure to run gfx2gba with the -c16 option.  Also, make sure you that you change the amount of bytes copied in the the call to DMAFastCopy that copies the tile set.  If you want to use an 8 BPP image, then you'll have to change REG_BG0CNT and the two calls to DMAFastCopy that deal with the palette and tile set.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38478 - utilizes - Mon Mar 28, 2005 9:31 am</h4>
    <div class="postbody"><span class="postbody">OK, thanks. I'll try it out now.
<br/>
<br/>
<br/>
Yay, it works. But it only displays half of the image.. I coudln't work out how to use that utility you suggested, so I used paint and saved it as a 16-color Bitmap, which did the job.
<br/>
See Below Now.
<br/>
<br/>
EDIT : Actually, I just found a nicer way to do it : Use less than 16 colours in a palette in Photoshop Elements, and it'll let you save as 8 BPP anyway. I've also resloved the half image.
<br/>
Also, i have now resolved the problem I had. It only seemed to happen with the map I tried to use borrowed from J Harbour. however, when I use my own, it works.
<br/>
<br/>
EDIT #2 : most simple maps work, but more complex ones only show about half..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38490 - ymalik - Mon Mar 28, 2005 3:35 pm</h4>
    <div class="postbody"><span class="postbody">You're getting half of image because you probably haven't changed how many tiles you're copying in the call to DMAFastCopy():
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   //copy the tile images into the tile memory
<br/>
   DMAFastCopy((void*)Tiles, (void*)CharBaseBlock(0),
<br/>
      12064/4, DMA_32NOW);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You'll have to change the "12064" to whatever number of bytes is in the array generated by gfx2gba.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38595 - utilizes - Tue Mar 29, 2005 12:39 pm</h4>
    <div class="postbody"><span class="postbody">This is all very good so far, and I can modify the backgrounds to my needs. However, I can't seem to work otu how to use sprites with this background. I'm trying to do it the way I did in Mode 4 things by including "gba.h" and then showing the attributes and WaitForVblank()ing and CopyOAM()ing but it doesn't seem to work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38599 - ymalik - Tue Mar 29, 2005 2:37 pm</h4>
    <div class="postbody"><span class="postbody">Why don't you post some code?  It should be the same in mode 0 as well.  I also recommend using PictView32 because it seems to save most of the important colors.  For example, the map I had in my zip file was actually a 8 BPP image, but when I reduced the palette in MSPaint, the beige became gray.  Do PVW32Con [file to covert] -w --c16.  PictView is also from the command line so you can do batch processing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38607 - utilizes - Tue Mar 29, 2005 3:57 pm</h4>
    <div class="postbody"><span class="postbody">Instead of using the Paint feature (which screwed up all of my colours totally), I found a nice way in Photoshop Elements, where you make it Indexed colours, draw your map in another window, then put only the colours which are in the other window into your palette, by cutting the current colours (ctrl+click rears its head on Windows) and then use the colour-dropper tool to get the colours from the other image. You could also draw your image in that window at choose Exact in the Palette Menu, but you can't always select it. Then, you can choose which colours you feel are important (up to 16 of them) and choose them. Then, when you choose to save as .bmp, it allows you to choose the value you want, which if you used under 16 colours, will be the only available one : 8BPP.
<br/>
The code I use for putting my sprites up is as follows :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//this sets out the attributes
<br/>
sprites[0].attribute0 = COLOR_256 | SQUARE | 50;
<br/>
sprites[0].attribute1 = SIZE_8 | 50;
<br/>
sprites[0].attribute2 = 512;
<br/>
<br/>
//then I copy it over
<br/>
WaitForVsync();
<br/>
CopyOAM();
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I like to use pcx2gba for my sprites, instead of gfx2gba which I use for my maps. I find it is far easier for sprites as there are often lots of them, and you can just drag the sprite onto the executable.
<br/>
Maybe the reason my sprites don't show up is that I'm not doing this right.
<br/>
Do I have to use tiled options with gfx2gba perhaps? If so, what would I do?
<br/>
<br/>
If you want to see my definitions, it is just from <a class="postlink" href="http://www.webbesen.dk/gba" target="_blank">http://www.webbesen.dk/gba</a>'s tutorial.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38651 - ymalik - Tue Mar 29, 2005 11:48 pm</h4>
    <div class="postbody"><span class="postbody">Show what's in CopyOAM() .
<br/>
In mode 3-5, the character data memory is cut by half, so the sprite name begins at 512.  Perhaps you are refering to the wrong sprite.  Make sure you are copying the character data to the proper location.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38686 - utilizes - Wed Mar 30, 2005 10:42 am</h4>
    <div class="postbody"><span class="postbody">this is CopyOAM(); :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void CopyOAM(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   u16* temp;
<br/>
   temp = (u16*)sprites;
<br/>
   for(loop = 0; loop &lt; 128*4; loop++)   {
<br/>
      OAM_Mem[loop] = temp[loop];
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38695 - ymalik - Wed Mar 30, 2005 2:47 pm</h4>
    <div class="postbody"><span class="postbody">Are you copying the character data into the right location?  Perhaps you are copying it at the beggining of tile 0, but you are using tile 512, instead.
<br/>
By the way, you can use DMA to copy in the OAM data:
<br/>
DMA_COPY(3, (void *) sprites, (void *) OAM, 128&lt;&lt;2, DMA16_NOW);</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38700 - utilizes - Wed Mar 30, 2005 4:31 pm</h4>
    <div class="postbody"><span class="postbody">So what should I be writing for my sprites?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38705 - ymalik - Wed Mar 30, 2005 7:03 pm</h4>
    <div class="postbody"><span class="postbody">Post your code for copying the character data as well.  Later on in the day when I'll have time I'll post a demo of space invaders-like game that I made that should give you a good idea of how to store character data.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38757 - utilizes - Thu Mar 31, 2005 12:18 pm</h4>
    <div class="postbody"><span class="postbody">This is what I do :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
memcpy( (u16 *)0x06014000, &amp;spriteData, sizeof(spriteData) );
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38777 - Miked0801 - Thu Mar 31, 2005 6:38 pm</h4>
    <div class="postbody"><span class="postbody">as an side, what is the sizeof() of your struct?  It doesn't matter yet, but I have the feeling your swinging a sledge hammer at a thumb tack...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38780 - ymalik - Thu Mar 31, 2005 7:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">as an side, what is the sizeof() of your struct?  It doesn't matter yet, but I have the feeling your swinging a sledge hammer at a thumb tack...</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, is your spriteData a constant pointer or just a regular pointer?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38823 - Miked0801 - Fri Apr 01, 2005 1:59 am</h4>
    <div class="postbody"><span class="postbody">Not the point - I have a feeling that it is a standard 2 byte oam struct for which memcpy is the wrong tool for copying.  It might be the larger struct which contains the affine data, but even that is not worthy of memcpy.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38845 - utilizes - Fri Apr 01, 2005 11:13 am</h4>
    <div class="postbody"><span class="postbody">How do I find the sizeof of it though? Ive looked in the pcx2sprite output file, and it doesn't have the sizeof attribute there, and I can't find it anywhere else. However, it is somewhere as DevKitAdv would kick up a fight otherwise.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38904 - Miked0801 - Fri Apr 01, 2005 8:31 pm</h4>
    <div class="postbody"><span class="postbody">Look at your assembler output or printf() it to the screen.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39031 - utilizes - Sun Apr 03, 2005 10:34 am</h4>
    <div class="postbody"><span class="postbody">You can't printf to gba screen, and I don't know where this assembler output is..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39039 - tepples - Sun Apr 03, 2005 5:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>utilizes wrote:</b></span></td> </tr> <tr> <td class="quote">You can't printf to gba screen</td> </tr></table><span class="postbody">
<br/>
You can with sprintf() and <a class="postlink" href="http://www.pineight.com/gba/#agbtty" target="_blank">a bare-bones terminal emulator</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">and I don't know where this assembler output is..</td> </tr></table><span class="postbody">
<br/>
Take the command that says 'gcc -c' and turn it into 'gcc -S' instead.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39077 - utilizes - Mon Apr 04, 2005 9:46 am</h4>
    <div class="postbody"><span class="postbody">OK. It is 1024 then.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39118 - Miked0801 - Mon Apr 04, 2005 6:24 pm</h4>
    <div class="postbody"><span class="postbody">Huh?  1K for a sprite struct?  Seems very high.  Are you sure you didn't make an endian mistake?  0x04 0x00 is very close to 0x00 0x04</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39260 - utilizes - Wed Apr 06, 2005 6:11 pm</h4>
    <div class="postbody"><span class="postbody">well it says this : 	
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
.size   bcData,1024</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39274 - tepples - Wed Apr 06, 2005 9:16 pm</h4>
    <div class="postbody"><span class="postbody">1024 bytes is the size of OAM. It contains 128 structures, each of 8 bytes.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#39314 - utilizes - Thu Apr 07, 2005 10:29 am</h4>
    <div class="postbody"><span class="postbody">So what should I look for in the S output?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
