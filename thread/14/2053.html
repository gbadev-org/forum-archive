<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>sin cos undeclared? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > sin cos undeclared?</h2>
<div id="posts">
<div class="post">
    <h4>#10636 - goro - Thu Sep 11, 2003 10:11 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm doing GBA Junkie's tutorial on maps and BG's and I get
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">C:/PROJECTS/GBA/4/4.cpp:243: `sin' undeclared (first use this function)
<br/>
C:/PROJECTS/GBA/4/4.cpp:243: (Each undeclared identifier is reported only once 
<br/>
   for each function it appears in.)
<br/>
C:/PROJECTS/GBA/4/4.cpp:244: `cos' undeclared (first use this function)</td> </tr></table><span class="postbody">
<br/>
<br/>
when I try to compile :-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include"gba.h"         //GBA register definitions
<br/>
#include"bg.h"          //background definitions
<br/>
#include&lt;math.h&gt;
<br/>
<br/>
#include"exptiles.h"
<br/>
#include"128128map.c"
<br/>
<br/>
//Rotation variables (don't worry about them here) done in later chapter
<br/>
FIXED angle = 0;
<br/>
FIXED zoom = 1&lt;&lt;8;  //zoom is a fixed point number
<br/>
<br/>
FIXED SIN[360]={0x0000, edited to save forum space, 0xFFFFFB88,};  
<br/>
                 
<br/>
FIXED COS[360]={0x10000,edited to save forum space, 0xFFF6,};      
<br/>
             
<br/>
char RotIndexCounter = 0;  //global to keep track of rotation indexes used
<br/>
<br/>
void EnableBackground(Bg* bg)
<br/>
{edited to save forum space}
<br/>
<br/>
void UpdateBackground(Bg* bg)
<br/>
{edited to save forum space}
<br/>
<br/>
void RotateBackground(Bg* bg, int angle,int center_x, int center_y, FIXED zoom)
<br/>
{
<br/>
<br/>
   center_y = (center_y * zoom)&gt;&gt;8;
<br/>
   center_x = (center_x * zoom)&gt;&gt;8;
<br/>
<br/>
   bg-&gt;DX = ((bg-&gt;x_scroll&lt;&lt;8)-center_y*SIN[angle]-center_x*COS[angle]);
<br/>
   bg-&gt;DY = ((bg-&gt;y_scroll&lt;&lt;8)-center_y*COS[angle]+center_x*SIN[angle]);
<br/>
<br/>
   bg-&gt;PA = (COS[angle]*zoom)&gt;&gt;8;  //cos&amp;sin are LUTs that are .8 fixed numbers
<br/>
   bg-&gt;PB = (SIN[angle]*zoom)&gt;&gt;8;  //zoom is also fixed
<br/>
   bg-&gt;PC = (-SIN[angle]*zoom)&gt;&gt;8;
<br/>
   bg-&gt;PD = (COS[angle]*zoom)&gt;&gt;8;
<br/>
}
<br/>
<br/>
Bg bg2;
<br/>
<br/>
void WaitForVsync()
<br/>
{   while((volatile u16)REG_VCOUNT != 160){}}
<br/>
<br/>
void GetInput()
<br/>
{edited to save forum space}
<br/>
<br/>
int main()
<br/>
{
<br/>
   int index = 0;  //generic loop variables
<br/>
   u16 loop;
<br/>
   u16* temp;      //temporary storage pointer
<br/>
<br/>
   //compute my Look up tables (Rotation stuff again)
<br/>
   for(loop = 0; loop &lt; 360; loop++)
<br/>
   {
<br/>
                  SIN[loop] = (FIXED)(sin(RADIAN(loop)) * 256);  //sin and cos are computed and cast to fixed                     //fixed
<br/>
      COS[loop] = (FIXED)(cos(RADIAN(loop)) * 256);
<br/>
   }
<br/>
<br/>
   //set mode 2 and enable sprites and 1d mapping
<br/>
   SetMode(MODE_1 | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
   -edited to save forum space
<br/>
   
<br/>
                //Main Game loop
<br/>
   while(1)
<br/>
   {
<br/>
      GetInput();    //check for input
<br/>
      RotateBackground(&amp;bg2,angle,119,79,zoom);       WaitForVsync();               UpdateBackground(&amp;bg2); 
<br/>
   }
<br/>
   return(0);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
I've tried creating a make.bat file and adding -lm but that doesn't work either. please help</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10638 - consolecoder - Thu Sep 11, 2003 11:51 am</h4>
    <div class="postbody"><span class="postbody">Your source is a cpp file and surely need to know that sin and cos are in a c lib.
<br/>
<br/>
Try to add prototypes starting with : extern "C"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10639 - goro - Thu Sep 11, 2003 12:31 pm</h4>
    <div class="postbody"><span class="postbody">Ok. I don't quite understand but I'm experiencing a similar problem with my bg palette data.
<br/>
<br/>
the header file (that I have included) has in it :-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern const u16 backgroundPalette[256];</td> </tr></table><span class="postbody">
<br/>
<br/>
I have included palOut.cpp in my project (this contains the palette array)
<br/>
<br/>
but I still get 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
undefined reference to `backgroundPalette'</td> </tr></table><span class="postbody">
<br/>
<br/>
I understand that it is probably not seeing palOut.cpp.
<br/>
<br/>
How do I make it see it. The compiler I'm using is MS Visual Studio.
<br/>
<br/>
Edit : If I edit make.bat to include the .cpp files, I think it goes a step further but then says
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> palOut.cpp:4:syntax error before '=' token</td> </tr></table><span class="postbody">
<br/>
<br/>
here is the code in palOut.cpp (line 4)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">const u16 backgroundPalette[256]ALIGN4 = {
<br/>
0x0000,0x7e6a,0x7463,0x7f52,0x7d44,0x352c,0x</td> </tr></table><span class="postbody">
<br/>
<br/>
What should I do to fix this!?!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10664 - jenswa - Thu Sep 11, 2003 8:02 pm</h4>
    <div class="postbody"><span class="postbody">You prolly shoud link palout.cpp in your makefile for visual studio
<br/>
(i use make.bat, so i don't know exactly if i am right) and somewhere in the main source you should have it declared as extern.<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10677 - yaustar - Fri Sep 12, 2003 3:20 am</h4>
    <div class="postbody"><span class="postbody">I dont think it likes the 'ALIGN4' bit brfore the '=' sign.
<br/>
<br/>
cant see why it doesnt recognise 'sin' or 'cos', you have the right header file for it...<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10679 - tepples - Fri Sep 12, 2003 5:58 am</h4>
    <div class="postbody"><span class="postbody">There seems to be <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=2058" target="_blank">another thread in the graphics section</a> that gives the solution to the ALIGN4 issue.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10706 - yaustar - Sat Sep 13, 2003 1:30 am</h4>
    <div class="postbody"><span class="postbody">I dont understand a part of your code..
<br/>
<br/>
if you have already decleared the values in 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">FIXED SIN[360]={0x0000, edited to save forum space, 0xFFFFFB88,}; 
<br/>
                 
<br/>
FIXED COS[360]={0x10000,edited to save forum space, 0xFFF6,};   </td> </tr></table><span class="postbody">
<br/>
<br/>
why recalculatte them later in
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//compute my Look up tables (Rotation stuff again)
<br/>
   for(loop = 0; loop &lt; 360; loop++)
<br/>
   {
<br/>
                  SIN[loop] = (FIXED)(sin(RADIAN(loop)) * 256);  //sin and cos are computed and cast to fixed                     //fixed
<br/>
      COS[loop] = (FIXED)(cos(RADIAN(loop)) * 256);
<br/>
   } </td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10718 - goro - Sat Sep 13, 2003 10:10 am</h4>
    <div class="postbody"><span class="postbody">I really couldn't tell you cos I'm a noobie. It's from GBA Junkies tutorial.
<br/>
I've moved onto mode0 animating/updating/scrolling tile backgrounds but I'll get back to mode1/rotation when I get everything else working properly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10730 - cooky - Sat Sep 13, 2003 3:31 pm</h4>
    <div class="postbody"><span class="postbody">Goro you seem to have every problem I have. I'll point you in the right direction later.
<br/>
<br/>
Edit: this might be what is wrong. (Although I carn't garentee it. My make file consistently tries and wins at confusing me)
<br/>
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=2001" target="_blank">http://forum.gbadev.org/viewtopic.php?t=2001</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10746 - yaustar - Sun Sep 14, 2003 1:16 am</h4>
    <div class="postbody"><span class="postbody">THing is, in gbajunkies' tutorials, this
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
FIXED SIN[360]={0x0000, edited to save forum space, 0xFFFFFB88,};
<br/>
                 
<br/>
FIXED COS[360]={0x10000,edited to save forum space, 0xFFF6,};   
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
is written as 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">FIXED SIN[360];
<br/>
                 
<br/>
FIXED COS[360];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Also, do you have the latest DevKitAdv?
<br/>
If all else fails, you can use my precalculated headers for SIN and COS at <a href="http://www31.brinkster.com/yaustar/dev/gba.html" target="_blank">http://www31.brinkster.com/yaustar/dev/gba.html</a><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
