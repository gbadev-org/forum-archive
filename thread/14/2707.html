<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Help on tiles - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Help on tiles</h2>
<div id="posts">
<div class="post">
    <h4>#15259 - Cuauhtemoc - Tue Jan 20, 2004 4:34 am</h4>
    <div class="postbody"><span class="postbody">Hello, I wrote(tried) a simple mode 0 program, but it doesn't work. I'm just a newbie, I can't figure why it doesn't work. Could somebody help me ?
<br/>
<br/>
#include "tile.c"
<br/>
#include "map.c"
<br/>
#include "palette.c"
<br/>
<br/>
#define REG_DISPCNT *(unsigned short*)0x4000000
<br/>
#define Video ((unsigned short*)0x6000000)
<br/>
#define BG0 0x100
<br/>
#define BG_PAL ((unsigned short *)0x5000000)
<br/>
<br/>
#define BG0CTRL *(unsigned short*) 0x4000008
<br/>
#define CharBlock(n) (((n)*0x4000)+0x6000000)
<br/>
#define ScreenBlock(n) (((n)*0x800)+0x6000000)
<br/>
<br/>
<br/>
int main(void)
<br/>
{
<br/>
 unsigned short c;
<br/>
 unsigned short* Tile =((unsigned short*) CharBlock(1));
<br/>
 unsigned short* Map =((unsigned short*) ScreenBlock(0));
<br/>
 REG_DISPCNT=(0x0|0x100); // (MODE_0 | BG0)
<br/>
 BG0CTRL=(0x80|8&lt;&lt;0|2&lt;&lt;1);// (256clrs|ScrnBlk|ChrBlk)
<br/>
 for(c=0;c&lt;256;c++)BG_PAL[c]=Pal[c];
<br/>
 for(c=0;c&lt;3072;c++)Tile[c]=tiles[c];
<br/>
 for(c=0;c&lt;1024;c++)Map[c]=_map_[c];
<br/>
 while(1){}
<br/>
 return 0;
<br/>
}
<br/>
<br/>
<br/>
THANK YOU VERY MUCH</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15261 - dagamer34 - Tue Jan 20, 2004 5:02 am</h4>
    <div class="postbody"><span class="postbody">I can't exactly tell what you are trying to do but take a look at the tutorials on this site. This might help when loading a textbg map.
<br/>
<br/>
<a href="http://home.no/neogeo/HOVEDSIDE_INDEX/GBA_HOVEDSIDE_INDEX_ENGELSK/index.html" target="_blank">http://home.no/neogeo/HOVEDSIDE_INDEX/GBA_HOVEDSIDE_INDEX_ENGELSK/index.html</a>
<br/>
<br/>
I STRONGLY suggest that use use defines when setting up data and memory registers. Try to do something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
SetMode (MODE_0 | BG0_ENABLE);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Its easier to remember. There is also a list of defines that make life easier. For example, unsigned short can be shortened to u16 and unsigned char becomes u8.
<br/>
<br/>
What size of BG do you want anyway? I can't tell from your code. Missing a lot of info here.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15265 - poslundc - Tue Jan 20, 2004 5:18 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cuauhtemoc wrote:</b></span></td> </tr> <tr> <td class="quote">Hello, I wrote(tried) a simple mode 0 program, but it doesn't work. I'm just a newbie, I can't figure why it doesn't work. Could somebody help me ?</td> </tr></table><span class="postbody">
<br/>
<br/>
Might help if you told us what happened when you try to run it. Does it compile properly? Do you get any errors? Does the ROM launch in the emulator? What do you get on screen when it does? What do you expect to get onscreen?
<br/>
<br/>
Some other notes:
<br/>
<br/>
- You are #including C files. Bad, bad, bad. Compile them separately and link them.
<br/>
<br/>
- You might want to fix up your coding style. Don't put statements on the same line as your "for" control statements. Indent stuff. (You need to encase your code in the code tags for the indents to show up on this bulletin board.) This is all a matter of personal preference, of course, but the easier you make it for us to read your code the more likely it is we will be able to help you with it.
<br/>
<br/>
- All the stuff dagamer34 said.
<br/>
<br/>
Good luck,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15275 - Cuauhtemoc - Tue Jan 20, 2004 8:07 am</h4>
    <div class="postbody"><span class="postbody">I thank you both for replying my post.
<br/>
<br/>
Well, the program was supposed to show a Final Fantasy IV room(a bedroom). I got no errors or warnings when compiling it. The emulator(Visual Boy and Mappy with the same results)launchs it but I get just a black screen. What could the problem be ?
<br/>
<br/>
<br/>
Thanks Again[/quote]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15277 - sajiimori - Tue Jan 20, 2004 9:28 am</h4>
    <div class="postbody"><span class="postbody">Looks to me like you're setting the BG control register incorrectly.
<br/>
<br/>
Seriously, you should use #defines for the bits of the registers you use.  For example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define BG_COLOR_256 0x80
<br/>
#define BG_TILEBLK(x) ((x) &lt;&lt; 2)
<br/>
#define BG_MAPBLK(x) ((x) &lt;&lt; 8)
<br/>
<br/>
REG_BG0CNT = BG_COLOR_256 | BG_TILEBLK(1) | BG_MAPBLK(0);
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15279 - yaustar - Tue Jan 20, 2004 9:49 am</h4>
    <div class="postbody"><span class="postbody">Are the tiles/map being loaded into memory correctly?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15280 - qw3rty - Tue Jan 20, 2004 11:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
.
<br/>
.
<br/>
.
<br/>
BG0CTRL=(0x80|8&lt;&lt;0|2&lt;&lt;1);// (256clrs|ScrnBlk|ChrBlk)
<br/>
unsigned short* Tile =((unsigned short*) CharBlock(1));
<br/>
unsigned short* Map =((unsigned short*) ScreenBlock(0)); .
<br/>
<br/>
.
<br/>
.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You are TRYING to enable background 0 with  screenbaseblock 8, but your are enabling BG0 with char-base-block 3 (8 &lt;&lt; 0 == 8 ; 2 &lt;&lt; 1 = 4; 8+3 = 12 == BIT2 &amp; BIT 3) 
<br/>
You should change "8&lt;&lt;0" with "0 &lt;&lt; 8" (or 0 ;) ) and "2&lt;&lt;1" with "1 &lt;&lt; 2".
<br/>
<br/>
Furthermore you are forgetting to enable the background (forgot to set REG_DIPCNT( := *(u32*)0x4000000))
<br/>
<br/>
I suggest you read again day 1 &amp; 2 at the pern-project !
<br/>
(http://www.thepernproject.com/)
<br/>
<br/>
P.S. : I just noticed, that you ARE setting the display mode ( I haven`t checked for errors though...)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15403 - Cuauhtemoc - Thu Jan 22, 2004 3:15 am</h4>
    <div class="postbody"><span class="postbody">Thank's qw3rty, it is working now :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
