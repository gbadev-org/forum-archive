<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Mode 0 Graphics Tools - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Mode 0 Graphics Tools</h2>
<div id="posts">
<div class="post">
    <h4>#34314 - arock99 - Mon Jan 17, 2005 6:28 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
Although I'm not new to programming in general (I have been doing various things for over 10 years now) pretty much everything i'm doing now is being learned as I go for GBA Development. 
<br/>
I have written code to scroll though a Mode 0 Map and using someone else's already generated .h header file everything looks and works ok.  When I try and use a .h header file I generate by using either pcx2gba or pcx2sprite I get garbled graphics.  What tool should I be using?  I use pcx2gba and pcx2sprite by dragging and dropping the pcx file on to them.
<br/>
I'm using photoshop and am using an indexed pcx file as per the tutorials.
<br/>
<br/>
Here is my main function:
<br/>
int main() {
<br/>
	int xBg = 0, yBg = 0;//start x,y position of screen in map
<br/>
	unsigned short* bg0map =(unsigned short*)ScreenBaseBlock(31);//Create a pointer to background 0 tilemap buffer
<br/>
	REG_BG0CNT = BG_COLOR256 | TEXTBG_SIZE_256x256 | (31 &lt;&lt; SCREEN_SHIFT) | WRAPAROUND;//set up background 0
<br/>
	SetMode(0 | BG0_ENABLE);//set video mode 0 with background 0
<br/>
	DMAFastCopy((void*)bgPalette, (void*)BGPaletteMem,256, DMA_16NOW);//copy the palette into the background palette memory
<br/>
	DMAFastCopy((void*)bgData, (void*)CharBaseBlock(0),sizeof(bgData)/4, DMA_32NOW);//copy the tile images into the tile memory
<br/>
	DMAFastCopy((void*)lvlMap, (void*)bg0map, 512, DMA_32NOW);//copy the tile map into background 0
<br/>
<br/>
	while (1) {
<br/>
		while(REG_VCOUNT &lt; 160); //wait for the start of VBLANK
<br/>
<br/>
		//D-pad moves background
<br/>
		if(!(BUTTONS &amp; BUTTON_LEFT)) xBg--;
<br/>
		if(!(BUTTONS &amp; BUTTON_RIGHT)) xBg++;
<br/>
		if(!(BUTTONS &amp; BUTTON_UP)) yBg--;
<br/>
		if(!(BUTTONS &amp; BUTTON_DOWN)) yBg++;
<br/>
<br/>
		REG_BG0HOFS = xBg; //x position of start of background
<br/>
		REG_BG0VOFS = yBg; //y position of start of background
<br/>
<br/>
		while(REG_VCOUNT &gt; 160); //wait for end of VBLANK
<br/>
	}
<br/>
<br/>
	return 0;
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34317 - Celeryface - Mon Jan 17, 2005 8:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>arock99 wrote:</b></span></td> </tr> <tr> <td class="quote">.
<br/>
<br/>
	DMAFastCopy((void*)bgData, (void*)CharBaseBlock(0),sizeof(bgData)/4, DMA_32NOW);//copy the tile images into the tile memory
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
In this line here, you're using sizeof(bgData). Won't this return the size of the type, rather than the size of the array? Or are you using another function of your own that returns the size of the array? :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34319 - arock99 - Mon Jan 17, 2005 9:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Celeryface wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>arock99 wrote:</b></span></td> </tr> <tr> <td class="quote">.
<br/>
<br/>
	DMAFastCopy((void*)bgData, (void*)CharBaseBlock(0),sizeof(bgData)/4, DMA_32NOW);//copy the tile images into the tile memory
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
In this line here, you're using sizeof(bgData). Won't this return the size of the type, rather than the size of the array? Or are you using another function of your own that returns the size of the array? :)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I did not create a function of my own no...I have already tried putting in the size of my array and that didn't do it.  I have also tried dividing by everything from 1 to 8 ;) I'm going to have to double check some documents I have a feeling there are a few things i might have missed</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34321 - Celeryface - Mon Jan 17, 2005 9:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>arock99 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Celeryface wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>arock99 wrote:</b></span></td> </tr> <tr> <td class="quote">.
<br/>
<br/>
	DMAFastCopy((void*)bgData, (void*)CharBaseBlock(0),sizeof(bgData)/4, DMA_32NOW);//copy the tile images into the tile memory
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
In this line here, you're using sizeof(bgData). Won't this return the size of the type, rather than the size of the array? Or are you using another function of your own that returns the size of the array? :)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I did not create a function of my own no...I have already tried putting in the size of my array and that didn't do it.  I have also tried dividing by everything from 1 to 8 ;) I'm going to have to double check some documents I have a feeling there are a few things i might have missed</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah, normally when you're using 256-colour mode for backgrounds,  you'd divide the size of your tile array by 4 when copying the tiles into memory.  Have you tried using gfx2gba to make your background header files?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34324 - sajiimori - Mon Jan 17, 2005 9:39 pm</h4>
    <div class="postbody"><span class="postbody">There are lots of threads about this sort of thing.  In fact, I think there was one just a few days ago.  You might check around here.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
