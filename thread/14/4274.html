<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>What are Function Pointers - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > What are Function Pointers</h2>
<div id="posts">
<div class="post">
    <h4>#27994 - QuantumDoja - Mon Oct 25, 2004 9:01 pm</h4>
    <div class="postbody"><span class="postbody">Hi, I know what a pointer is, but what is a function pointer?<br/>_________________<br/>Chris Davis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#27996 - Abscissa - Mon Oct 25, 2004 9:06 pm</h4>
    <div class="postbody"><span class="postbody">It's basically just what it sounds. A function pointer is a pointer to a function, just like an int pointer is a pointer to an int.
<br/>
<br/>
If you're familiar with any newer languages like Java, C# or D, then it's  like a primitive version of a delegate.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28002 - sajiimori - Mon Oct 25, 2004 10:27 pm</h4>
    <div class="postbody"><span class="postbody">Pick up a good C book -- I recommend the "C Primer Plus".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28025 - pan69 - Tue Oct 26, 2004 7:32 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.function-pointer.org/" target="_blank">http://www.function-pointer.org/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28032 - yaustar - Tue Oct 26, 2004 11:50 am</h4>
    <div class="postbody"><span class="postbody">I know what they are myself but I still dont understand what are they used for. Someone said something about 'dynamically changing the flow of the program at run time' :S<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28035 - poslundc - Tue Oct 26, 2004 2:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">I know what they are myself but I still dont understand what are they used for. Someone said something about 'dynamically changing the flow of the program at run time' :S</td> </tr></table><span class="postbody">
<br/>
<br/>
Because a function-pointer can point to any function, it means I could have, for example, a game where every loop I call a function to draw the screen. Normally it draws the cars and the racetrack, but when someone switches to the menu mode I can change it to instead point to a function that draws the menus.
<br/>
<br/>
Taken to a more sophisticated level, I could have structs to represent generic characters in my game, containing sprite-related data that all the characters require, but a function pointer that can point to different functions depending on what the character is supposed to actually do in the game. This is one of the underlying concepts that polymorphism (that's so popular in object-oriented languages) is based upon.
<br/>
<br/>
There are other things you can do as well, such as have an array of function pointers and then use an index into that array to choose which function to call, depending on what you are trying to do. This is how single interrupt support was implemented in Devkit Advance (if you did things the PERN way, and probably many other tutorials as well).
<br/>
<br/>
Basically, it gives you an abstract way to have your code call a function, without specifying what function it is that will be called. This is what is meant by dynamically changing the flow at runtime.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28048 - jma - Tue Oct 26, 2004 4:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">I know what they are myself but I still dont understand what are they used for.</td> </tr></table><span class="postbody">
<br/>
<br/>
They are most commonly used in state machines, bytecode interpreters, etc. Anything that typically links a number to a function call. It is much better to do this that a series of <span style="font-weight: bold">if</span> statements or a giant <span style="font-weight: bold">switch</span> statement with hundreds of <span style="font-weight: bold">case</span>s. Here's a trivial example (with declarations missing for readability):
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef void (*state)();
<br/>
<br/>
// the one and only global game state
<br/>
static state g_state = title_screen();
<br/>
<br/>
void title_screen() {
<br/>
  draw_main_menu();
<br/>
  if (user_selection() == new_game) {
<br/>
    g_state = load_game;
<br/>
  }
<br/>
}
<br/>
<br/>
void load_game() {
<br/>
  load_all_level_graphics();
<br/>
  g_state = play_game();
<br/>
}
<br/>
<br/>
void play_game() {
<br/>
  draw_game();
<br/>
  accept_input();
<br/>
  if (game_over == true) {
<br/>
    g_state = title_screen;
<br/>
  }
<br/>
}
<br/>
<br/>
void main() {
<br/>
  while(1) {
<br/>
    vblank();
<br/>
    g_state();
<br/>
  }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
As you can see, this simple state-machine makes the main game loop extremely simple. It doesn't actually do anything other than wait for a vertical blank, then call the current game function. Each state function is resposible for progressing the "machine" along to the next state.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28115 - yaustar - Wed Oct 27, 2004 12:13 am</h4>
    <div class="postbody"><span class="postbody">Does it help a little with code optimsiation as I remember (abliet vaugely) that if/switch statements create branches in the code where a function pointer seems to avoid it altogether?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28121 - Gene Ostrowski - Wed Oct 27, 2004 12:54 am</h4>
    <div class="postbody"><span class="postbody">To an extent, yes.  
<br/>
<br/>
In a highly contrived scenario, assume you have a routine that plots pixels.  You then want to create a version that plots one for an 8-bit screen, a 16-bit screen, a 24-bit screen, a 32-bit screen, etc.
<br/>
<br/>
Then, you have a structure that maintains the "display" information (resolution, bit-depth, etc.).  You could also save the pointer to the "proper" draw function so that when you can call:
<br/>
<br/>
screen-&gt;plotPixel(x,y,color)
<br/>
<br/>
...the system will know which "version" of the routine to use since it's pointing to the one that corresponds to the type of display.
<br/>
<br/>
It keeps you from having to code the routine in some variation of the following:
<br/>
<br/>
plotPixel(x,y,color)
<br/>
{
<br/>
   if (screen-&gt;depth==8) { // plot it in 8 bit }
<br/>
   else if (screen-&gt;depth==16) { // plot it in 16-bit }
<br/>
   else if (screen-&gt;depth==24) { // plot it in 24-bit }
<br/>
   ...
<br/>
}
<br/>
<br/>
If you can get past the C vs C++ debate of the thread, and the "validity" of using function pointers for this in C, I posted some information about exactly this topic in <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=4257" target="_blank">http://forum.gbadev.org/viewtopic.php?t=4257</a><br/>_________________<br/>------------------
<br/>
Gene Ostrowski</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
