<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Multiplayer - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Multiplayer</h2>
<div id="posts">
<div class="post">
    <h4>#14140 - dagamer34 - Wed Dec 31, 2003 3:32 am</h4>
    <div class="postbody"><span class="postbody">I cannot find any solid to really get me started in coding a multiplayer app. I have found only one demo that works, Multiplayer Pong, but it didn't come with source.
<br/>
<br/>
When looking at old posts, people kept talking about this site:
<br/>
<a href="http://downtou.cjb.net/" target="_blank">http://downtou.cjb.net/</a> but I can't seem to access it for its tutorials. Is it still up? If not, does anybody have the source so I can look at it?
<br/>
<br/>
And when trying to compile the mbclient from <a href="http://www.devrs.com/gba/mbclient.txt," target="_blank">www.devrs.com/gba/mbclient.txt,</a> I get these errors:
<br/>
<br/>
<br/>
/cygdrive/c/DOCUME~1/Jeofrey/LOCALS~1/Temp/cclrTLrd.s: Assembler messages:
<br/>
/cygdrive/c/DOCUME~1/Jeofrey/LOCALS~1/Temp/cclrTLrd.s:8631: Error: bad instruction `lsr r2,#24'
<br/>
/cygdrive/c/DOCUME~1/Jeofrey/LOCALS~1/Temp/cclrTLrd.s:8649: Error: Bad arguments to instruction
<br/>
NMAKE : fatal error U1077: 'C:\Consoles\GBA\DevKits\DevKitAdv\v4\bin\gcc' : return code '0x1'
<br/>
Stop.
<br/>
Error executing NMAKE.
<br/>
<br/>
Thaks for all your help!<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14143 - crossraleigh - Wed Dec 31, 2003 4:04 am</h4>
    <div class="postbody"><span class="postbody">The <a class="postlink" href="http://www.suddenpresence.com/sgade/" target="_blank">SGADE</a> has a nice multiplayer module as well an explanatory demo.
<br/>
<br/>
If you are wanting multiboot (i.e., multiplayer using only one cartridge), I don't know where else to send you besides Jeff's example. As far as the compilation problems, it looks like you don't have the <span style="font-style: italic">-mthumb</span> option enabled.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14169 - dagamer34 - Wed Dec 31, 2003 3:31 pm</h4>
    <div class="postbody"><span class="postbody">I'm pretty sure its enabled. But it still does not want to work. Where would I put it in a makefile? In the compile flags or linker flags?
<br/>
<br/>
My makefile:
<br/>
<br/>
PROJECT = GBALibTest 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define some directories; 
<br/>
# ------------------------------------------- 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Base Directory for gcc arm-agb-elf replace with 
<br/>
# wherever you put your gba devkitadv files. 
<br/>
# ------------------------------------------- 
<br/>
<br/>
DEVDIR  = C:\Consoles\GBA\DevKits\DevKitAdv\v4 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Source directory (where your project's source files are located.) 
<br/>
# ------------------------------------------- 
<br/>
<br/>
SRCDIR  = C:\Consoles\GBA\Projects\DevKitAdv\GBALibTest\ 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Compiler Directories for binaries, includes and libs. 
<br/>
# ------------------------------------------- 
<br/>
<br/>
CMPDIR  = $(DEVDIR)\bin 
<br/>
LIBDIR  = $(DEVDIR)\lib\gcc-lib\arm-agb-elf\3.0.2\interwork 
<br/>
LIBDIR2 = $(DEVDIR)\arm-agb-elf\lib\interwork 
<br/>
INCDIR  = $(DEVDIR)\lib\gcc-lib\arm-agb-elf\3.0.2\include 
<br/>
INCDIR2 = $(DEVDIR)\arm-agb-elf\include 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# END of directory defines 
<br/>
# ------------------------------------------- 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define what extensions we use; 
<br/>
# ------------------------------------------- 
<br/>
.SUFFIXES : .cpp .c .s 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define the flags for the compilers; 
<br/>
# ------------------------------------------- 
<br/>
CFLAGS  = -I $(INCDIR2) -I $(INCDIR) -I $(SRCDIR) -mthumb -mthumb-interwork -c -g -O2 -Wall -fverbose-asm 
<br/>
SFLAGS  = -I $(INCDIR2) -I $(INCDIR) -mthumb-interwork 
<br/>
LDFLAGS = -L $(LIBDIR) -L $(LIBDIR2) -T LinkScript 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define the list of all O files; 
<br/>
# Just follow the syntax shown to add any 
<br/>
# other objects your project may need to 
<br/>
# compile properly. You will need to add 
<br/>
# files to this part to make it work with 
<br/>
# your project add a \ to the end of all o 
<br/>
# files except the last one. Like below. 
<br/>
# ------------------------------------------- 
<br/>
<br/>
O_FILES			 = \
<br/>
                   crt0.o       \
<br/>
                   crtbegin.o   \
<br/>
                   crtend.o     \
<br/>
                   GBALibTest.o
<br/>
<br/>
<br/>
# ------------------------------------------- 
<br/>
# There should be no need to modify anything 
<br/>
# below here. 
<br/>
# ------------------------------------------- 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define the final dependecy; 
<br/>
# ------------------------------------------- 
<br/>
all : $(PROJECT).gba 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define the copy from .elf to .bin file 
<br/>
# ------------------------------------------- 
<br/>
$(PROJECT).gba : $(PROJECT).elf 
<br/>
   $(CMPDIR)\objcopy -v -O binary $(PROJECT).elf $(PROJECT).gba 
<br/>
   -@echo ------------------------------------------ 
<br/>
   -@echo Done 
<br/>
   -@echo ------------------------------------------ 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define the linker instruction; 
<br/>
# ------------------------------------------- 
<br/>
$(PROJECT).elf : $(O_FILES) 
<br/>
   $(CMPDIR)\ld $(LDFLAGS) -o $(PROJECT).elf $(O_FILES) -lstdc++ -lm -lgcc -lc -lgcc
<br/>
<br/>
   -@echo ------------------------------------------ 
<br/>
   -@echo Linking Done 
<br/>
   -@echo ------------------------------------------ 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define each compile; 
<br/>
# ------------------------------------------- 
<br/>
{$(SRCDIR)}.cpp.o:: 
<br/>
   $(CMPDIR)\gcc  $(CFLAGS) $&lt;
<br/>
   -@echo ------------------------------------------ 
<br/>
   -@echo CPP-Sources Compiled 
<br/>
   -@echo ------------------------------------------ 
<br/>
<br/>
{$(SRCDIR)}.c.o:: 
<br/>
   $(CMPDIR)\gcc  $(CFLAGS) $&lt; 
<br/>
   -@echo ------------------------------------------ 
<br/>
   -@echo C-sources Compiled 
<br/>
   -@echo ------------------------------------------ 
<br/>
<br/>
# ------------------------------------------- 
<br/>
# Define each assemble; 
<br/>
# ------------------------------------------- 
<br/>
{$(SRCDIR)}.s.o: 
<br/>
   $(CMPDIR)\as $(SFLAGS) $(SRCDIR)\$*.s -o$@ 
<br/>
   -@echo ------------------------------------------ 
<br/>
   -@echo ASM-Sources Compiled 
<br/>
   -@echo ------------------------------------------<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14172 - johnny_north - Wed Dec 31, 2003 5:27 pm</h4>
    <div class="postbody"><span class="postbody">Try removing the -O2 from your compile options. I think it causes problems with Jeff's inline assembly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14173 - dagamer34 - Wed Dec 31, 2003 5:47 pm</h4>
    <div class="postbody"><span class="postbody">Changing the option to -O makes no difference. The funny thing is that i just tried using a batch file and it worked! What's the diff?
<br/>
<br/>
path=C:\Consoles\GBA\DevKits\DevKitAdv\v4\bin
<br/>
<br/>
gcc  -o GBALibTest.elf GBALibTest.cpp -lstdc++ -lm -lgcc -lc -mthumb -mthumb-interwork
<br/>
<br/>
objcopy -O binary GBALibTest.elf GBALibTest.gba
<br/>
<br/>
pause
<br/>
<br/>
This makefile stuff is just screwing me over.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14175 - johnny_north - Wed Dec 31, 2003 6:52 pm</h4>
    <div class="postbody"><span class="postbody">When I was new to makefiles, I was having similar problems. Figuring out a massive group of makefile wild cards is difficult. Search the forums for a recent makefile post by me. I gave an example of a functional mikefile for a c++ project using Jeff F's crt0 and linkscript. This file uses no wildcards.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14179 - Miked0801 - Wed Dec 31, 2003 9:05 pm</h4>
    <div class="postbody"><span class="postbody">&lt;evil laugh&gt; Welcome to the Hell that is GBA multiplayer.  It took us months and months to get a 2 player game 100% solid while allowing HBlank interrupts to interrupt it w/o causing packet loss and then another month to get it extended to 4 player.  GBA sucks nearly as bad as GBC at multiplayer.  Unless you really, really, really, need multiplayer (or enjoy a whole bunch of pain), don't go there.  It's a big pain in the ass with almost no good sources to get it working correctly.  Oh and the Nintendo sample code for it is a big joke - as usual :)
<br/>
<br/>
Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14186 - dagamer34 - Wed Dec 31, 2003 11:23 pm</h4>
    <div class="postbody"><span class="postbody">So that's why there is little documentation for it. Those who can't get i give up, and those who do get it KEEP it to themselves by signing some kind of contract.
<br/>
<br/>
Why does it always happen this way....
<br/>
<br/>
So there is absolutely no hope for me? All i need is for it to send some little data, like the position of a sprite, between 2 GBAs and that would be good enough for me.
<br/>
<br/>
Thanks for your help anyway.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15066 - ScottLininger - Fri Jan 16, 2004 8:28 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.thingker.com/gba/MultiplayerV1.zip" target="_blank">http://www.thingker.com/gba/MultiplayerV1.zip</a>
<br/>
<br/>
I just got this thing working last night, and YES, multiplayer is a pain to make stable.
<br/>
<br/>
I'm sure once this code starts getting used in games with interrupts, it'll be back to the drawing board.
<br/>
<br/>
;)
<br/>
<br/>
Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15100 - dagamer34 - Sat Jan 17, 2004 2:42 am</h4>
    <div class="postbody"><span class="postbody">Hmm... thats a pretty good example!!! Though, why are you using variables in EWRAM? Does the program assume that there is some random value in EWRAM?? And is this meant to be flashed onto a cart or replicated like Jeff's multiboot replicating example?
<br/>
<br/>
This does show me what packets are and how they work, briefly. If possible, and I get the hell we like to call multiplayer to work, I think I'll work on a tutorial.
<br/>
<br/>
Does everybody use agbtty for printing letters to the screen?
<br/>
<br/>
And how would you do error and drop-checking?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15136 - ScottLininger - Sat Jan 17, 2004 9:01 pm</h4>
    <div class="postbody"><span class="postbody">The demo is indeed meant to be run as a MULTIBOOT (and replicated to the slave GBA like Jeff's demo--in fact, that part of the code is pretty much exactly from his program.) Any reference to EWRAM is just because of the multiboot. 
<br/>
<br/>
However, the basic idea would work cart-to-cart as well (with no multiboot) I just haven't tried that yet. I'll give it a shot and post and update when I get a chance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15138 - ScottLininger - Sat Jan 17, 2004 9:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Does everybody use agbtty for printing letters to the screen?
<br/>
<br/>
And how would you do error and drop-checking?</td> </tr></table><span class="postbody">
<br/>
<br/>
agbtty is just one of many options. I use it because I have it working and it's versatile.
<br/>
<br/>
"Error checking," i.e. making sure packets don't get corrupted in transfer, is sort-of built into the code, since the transfer will keep trying until each and every packet is transferred and <span style="font-style: italic">sent back</span> by the other players. 
<br/>
<br/>
"Drop checking," i.e. figuring out when someone is disconnected, is a little more complex. I guess the simple thing would be to keep track of how many times you've tried to send a packet without any response, and if you've tried 1000 times without success you assume something's disconnected. I need to dig back into the IO registers and see if there's anything that gives you more useful information.
<br/>
<br/>
I know that when a gameboy is "not connected," its data register is set to 0xFFFF, but I'm pretty sure that this is also the default state for connected gameboys that are simply not sending anything. We'll just need to experiment.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15148 - dagamer34 - Sun Jan 18, 2004 1:54 am</h4>
    <div class="postbody"><span class="postbody">What about the error bit that is set in the REG_SIOCNT register? Doesn't that tell when an error has occured (other than lost packets)??
<br/>
<br/>
Once, I successfully send a MB ROM from a flash cart, however, I didn't know anything about multiplayer. I'll try to see if i can get it working again, maybe send you the code, whatever I have, so we can get this &amp;$#@ thing to work.
<br/>
<br/>
I envy those who have the official GBA docs... how do they figure this stuff out anyway!?!?!?!?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15201 - Miked0801 - Sun Jan 18, 2004 10:27 pm</h4>
    <div class="postbody"><span class="postbody">We don't.  We have (had) to guess like the rest of you and burn months of man hours to get it working.  The Nintendo example code barely works (it might if it was the only thing running) and doesn't stay in sync.  The code samples on the net are better sources than Nintendo stuff.  Nintedo docs are not the holy grail.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
