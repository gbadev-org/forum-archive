<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Looking for a "viewing window" solution (maps) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Looking for a "viewing window" solution (maps)</h2>
<div id="posts">
<div class="post">
    <h4>#7021 - Wildginger - Fri Jun 06, 2003 11:26 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I have a 512x512 map where my character can happily walk around. At present, the screen is full with the current part of the map that is viewable.
<br/>
<br/>
What I would like to do is put a window/map over the top of the scrolling background, so that the user can only see 144x144 of the screen ( pixel 0 - 143, x and y ). The rest of the map would be covered at all times by the covering map, and I would present data in these areas.
<br/>
<br/>
Im sure this can be done somehow, but does anyone know how? Ive heard about map layers, but could a map have a "transparent" area in it, like a sprite can? So I could have the second map over the background map, with the top left 144x144 transparent?
<br/>
<br/>
Or am I barking up the wrong tree in the wrong forest?
<br/>
<br/>
Thanks for any ideas / pointers,
<br/>
<br/>
Jim<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7024 - Sweex - Fri Jun 06, 2003 11:58 am</h4>
    <div class="postbody"><span class="postbody">Taken from the Cowbite hardware specification document:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Windowing is a method of dividing the screen into subsections known as (surprise) windows. The windows serve as boundary areas to determine where various layers of the GBA will be shown and where they will be clipped. There are two primary windows, win0 and win1, which can be enabled in REG_DISPCNT. There is also the "obj" window, which can be thought of as another window which is defined by the visible regions of the objs on screen. Finally there is the "outside" or "out" window - the area of the screen not already occupied by any other winodw. The position and size of WIN0 and WIN1 are determined by REG_WIN0H, REG_WIN1H, REG_WIN0V, and REG_WIN1V (I/O offsets 0x40, 0x42, 0x44, 0x46). Exactly which characters and backgrounds appear within or without win0, win1, and the obj window is determined by REG_WININ and REG_WINOUT (0x48 and 0x4A). 
<br/>
<br/>
Here are some things to keep in mind when using windows : 
<br/>
<br/>
- WIN0 and WIN1 are drawn from the left and top boundary up to but not including the right and bottom boundaries.
<br/>
- Everything in WIN0 appears "above" WIN1 (i.e. it has higher priority), and everything in windows 0 &amp; 1 appears above the WINOUT and obj windows.
<br/>
- If a bg or the obj's are turned off in dispcnt, they're off in all windows regardless of the settings in win_in and win_out.
<br/>
- If only one window is on, WINOUT affects everything outside of it (if both windows are on, WINOUT affects everything outside both of them. IE, it affects (!WIN0)&amp;&amp;(!WIN1) ).
<br/>
- If a window is on, but the effective display bits are all clear, the backdrop is displayed.
<br/>
- If the window left coordinate is greater than the window right coordinate, the window will be drawn outside of this region (i.e. to the left and to the right) rather than in the area inbetween.
<br/>
- Likewise, if the window top coordinate is greater than the window bottom coordinate, the window will be drawn to the top and the bottom.
<br/>
- A completely inverted window is drawn in the area outside of the "+" shaped region defined by its boundaries. 
<br/>
<br/>
Windows can be used in console games for a variety of different effects. Though the window registers define a square region, differently shaped windows can be achieved by using hdma or hblank interrupts to change the parameters each scanline. Lantern lighting (when the hero has a lantern or flashlight that illuminates a certain region of a cave) and x-ray vision (use of the window to cut away layers that are in front) are two common effects created with windows. More are certainly possible.
<br/>
<br/>
Thanks again to gbcft for most of these notes and for his extensive testing on the nature of windowing. </td> </tr></table><span class="postbody">
<br/>
<br/>
I am pretty sure you can use the window registers to achieve what you want!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7031 - niltsair - Fri Jun 06, 2003 1:38 pm</h4>
    <div class="postbody"><span class="postbody">Like sweex said, there's a register to use a viewable window just like you said. Never tried it.
<br/>
<br/>
Another less efficient solution, would be to use another layer like you said. Just use color 0 of your palette to tell the layer that this color is transparent.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7033 - Wildginger - Fri Jun 06, 2003 2:34 pm</h4>
    <div class="postbody"><span class="postbody">Thanks both of you for the replies.
<br/>
<br/>
Ive looked up the window register info, and while it looks like it would be exactly what I need, I might not quite be ready for that yet, but very handy to know it exists.
<br/>
<br/>
As for the layered maps, Im quite happy to be "not as efficient" while Im learning, and the layers sound fairly straight forward.
<br/>
<br/>
So if I make a map with a rectangle of black, and put it onto of the existing map, I will be able to see the bottom map through that rectangle?
<br/>
<br/>
Hope so as this would be ideal at this stage . . 
<br/>
<br/>
Jim.
<br/>
<br/>
P.S. What is the priority order of the backgrounds? Is BG0 always on top? Or is BG3 always on top?<br/>_________________<br/>---
<br/>
Wildginger (aka JimTownsend)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7039 - niltsair - Fri Jun 06, 2003 5:10 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, i perfectly understand about first trying it out with layers. Beside, if you have a spare layer to spare, then that's not problem and mroe flexible (can have any see through shape . (Can be done with windows by using interupt, but harder and can't have multiple , windows)
<br/>
<br/>
No, not the RGB color  0, the index 0 in your palette (whatever that color is).
<br/>
<br/>
You can set individual priority to each layer. By default Layer 0 is the topmost or bottommost (can't remember which's which) just try it out and see.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7052 - sgeos - Fri Jun 06, 2003 11:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>niltsair wrote:</b></span></td> </tr> <tr> <td class="quote">if you have a spare layer to spare, then that's not problem and mroe flexible (can have any see through shape .</td> </tr></table><span class="postbody">
<br/>
<br/>
I should think the window regs would be easier to use if all you want is a square window.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
