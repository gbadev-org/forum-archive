<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Looking for explanations of Raycasting. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Looking for explanations of Raycasting.</h2>
<div id="posts">
<div class="post">
    <h4>#18753 - zazery - Sat Apr 03, 2004 10:22 pm</h4>
    <div class="postbody"><span class="postbody">I've searched the forums, the site and other websites. I have read the theories on: <a href="http://www.permadi.com/tutorial/raycast/raycbb.html" target="_blank">http://www.permadi.com/tutorial/raycast/raycbb.html</a>
<br/>
However I can't seem to grasp the actual code needed to create one of these. I've got the code from the file section on this website (raycaster 0.7) and find it abit more confusing that I want it to be.
<br/>
<br/>
I understand tiles, sprites, game logic and various other things to do with 2D games. However I can't grasp raycastinig. I looked at the build engine but obviously that is large complex and confusing. I am looking for some websites with concepts so I can understand what is happening and also very basic code to run either on the PC in C or on the GBA in C.
<br/>
<br/>
I did look at Raycaster 0.7 in the files section as I said however I just want some little code that will teach me how to create the basic raycaster. Something like maybe 4 "blocks" with walls surrounding:
<br/>
<br/>
1111
<br/>
1001
<br/>
1010
<br/>
1111
<br/>
<br/>
Any help would be appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18804 - niltsair - Mon Apr 05, 2004 7:52 pm</h4>
    <div class="postbody"><span class="postbody">I programmed one using this exact tutorial.
<br/>
<br/>
It's quite sufficient to build yourself a basic raycast engine. 
<br/>
<br/>
You should create the basic routine in a Windows program :
<br/>
1- Create base rendering loop, unoptimzed.
<br/>
2- Once everything work(albeight slowly) Optimize it (use a trigo table insted of functions, etc...)
<br/>
3- Replace all of your float/double by fixed mathematic.
<br/>
4- Port your code to Gba.
<br/>
<br/>
For the Gba, use mode 5 with the Bg rotated 90degree and scaled 2x in height : (http://www.gbadev.org/files/newmode.txt) This will give you 16bits mode, with backbuffer.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18816 - zazery - Tue Apr 06, 2004 1:10 am</h4>
    <div class="postbody"><span class="postbody">I will try using Mode 5 and that tutorial as my basis along with the example on the GBA. However I don't understand one thing. When you are tracing each ray, does that account for one pixel on the screen? I'm not entirely sure how and what I should be drawing to the screen. I've had lots of experience with modes 0-3, 4 not so much and 5 not at all. Putting pixels in their proper place is not a problem, I just don't know how to determine what to put where.
<br/>
<br/>
I'm under the impression that each ray is a line and you draw all the lines. However I'm thinking that it should be casted pixel by pixel, am I right? 
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18818 - tepples - Tue Apr 06, 2004 1:49 am</h4>
    <div class="postbody"><span class="postbody">In a Wolfenstein style raycasting engine, each ray corresponds to a column of pixels on the screen. A mode 3 or mode 5 double-buffered full screen has 120 such columns.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18829 - niltsair - Tue Apr 06, 2004 4:21 pm</h4>
    <div class="postbody"><span class="postbody">Like Tepples explained, you cast 120 'rays' untill you hit a 'wall'. Each ray is a column, and the height of the column depends on the distance it took to hit the wall. You basicly treat it like a 2D map, from overhead then deduce the height from the distance.
<br/>
<br/>
In my previous post, I said you scale in height, my bad, it's in width.
<br/>
<br/>
The advantage of using the mode 5 rotated/scaled is that :
<br/>
1-You get 1/2 rays less to calculate (120 columns instead of 240).
<br/>
2-You can write directly 2 consecutives pixels when drawing you column. (since BG is rotated 2 adjacents pixels are not on the same line, they're on the same column.)<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18838 - zazery - Tue Apr 06, 2004 11:27 pm</h4>
    <div class="postbody"><span class="postbody">Alright now it's starting to make more sense. Thanks to both niltsair and tepples for clearing up some questions I had. 
<br/>
<br/>
I'll be working on this and another small game over the long weekend so I'll let you guys know how I make out and post any questions I have.
<br/>
<br/>
Thanks again, wish me luck.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18846 - niltsair - Wed Apr 07, 2004 1:23 am</h4>
    <div class="postbody"><span class="postbody">Good luck :)<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19537 - corranga - Wed Apr 21, 2004 5:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>niltsair wrote:</b></span></td> </tr> <tr> <td class="quote">I programmed one using this exact tutorial.
<br/>
<br/>
You should create the basic routine in a Windows program :
<br/>
1- Create base rendering loop, unoptimzed.
<br/>
2- Once everything work(albeight slowly) Optimize it (use a trigo table insted of functions, etc...)
<br/>
3- Replace all of your float/double by fixed mathematic.
<br/>
4- Port your code to Gba.
<br/>
<br/>
For the Gba, use mode 5 with the Bg rotated 90degree and scaled 2x in height : (http://www.gbadev.org/files/newmode.txt) This will give you 16bits mode, with backbuffer.</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
There is a <span style="font-weight: bold">LOVELY</span> little API (well, really a sort of wrapper clas for DirectDraw I suppose) that I used when working on my 3D stuff.  It is called TinyPTC and I would recommend it tgo anyone wanting to try anything for GBA.  It allows you to set up a window with only 1 or 2 lines of code, and drawing to a buffer is done by inserting colour values into an array - <span style="font-weight: bold">just like the GBA!</span> but with the additional use of all things windows programming allows (so you have floating point numbers, and a console window for output if yuo make a console application)
<br/>
<br/>
I actually used exactly the same rendering code with this as I do on the GBA (with a slight change to the popular RGB16 macro)
<br/>
<br/>
Get it from:  <a class="postlink" href="http://www.gaffer.org/" target="_blank">http://www.gaffer.org/</a>
<br/>
<br/>
Chris<br/>_________________<br/>If virtual reality is ever on a par with reality, I want to be Bomberman! :D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19556 - zazery - Wed Apr 21, 2004 11:36 pm</h4>
    <div class="postbody"><span class="postbody">It sounds interesting. I'll check it out later tonight. I haven't had time to start on the code. I read through some documents and stuff but I just need to apply it now. I'm currently concentraiting on microchip programming until that project is done, which should be by May 1st. After that I will attempt this project again. Thanks for the comments and help.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
