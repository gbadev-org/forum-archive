<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>What is the register for 'when no buttons are pressed'? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > What is the register for 'when no buttons are pressed'?</h2>
<div id="posts">
<div class="post">
    <h4>#9445 - yaustar - Tue Aug 05, 2003 1:14 am</h4>
    <div class="postbody"><span class="postbody">I am trying to put in an operation when no buttons are pressed by the user. 
<br/>
Please help....<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9446 - Freke - Tue Aug 05, 2003 2:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "keypad.h"
<br/>
<br/>
if ((*KEYS &amp; KEY_UP) &amp;&amp; (*KEYS &amp; KEY_DOWN) &amp;&amp; (*KEYS &amp; KEY_LEFT) &amp;&amp; (*KEYS &amp; KEY_RIGHT) &amp;&amp; (*KEYS &amp; KEY_L) &amp;&amp; (*KEYS &amp; KEY_R) &amp;&amp; (*KEYS &amp; KEY_START) &amp;&amp; (*KEYS &amp; KEY_SELECT))
<br/>
{
<br/>
// Do stuff
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Untested...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9447 - yaustar - Tue Aug 05, 2003 2:27 am</h4>
    <div class="postbody"><span class="postbody">I thought about that, is there a short hand way of doing it?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9448 - funkeejeffou - Tue Aug 05, 2003 4:32 am</h4>
    <div class="postbody"><span class="postbody">unsigned short int *INPUT_REG = (unsigned short int *)0x4000130h;
<br/>
<br/>
if (((*INPUT_REG) &amp; (0x3FF)) == 0x3FF)
<br/>
          //do funky stuff, here any key is pressed
<br/>
<br/>
If you have put O3 optimization level, declare the INPUT REG as volatile.
<br/>
<br/>
Hope this helps.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9480 - yaustar - Tue Aug 05, 2003 10:43 pm</h4>
    <div class="postbody"><span class="postbody">thank you, that works perfectly. How did you know that?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9492 - funkeejeffou - Wed Aug 06, 2003 10:02 am</h4>
    <div class="postbody"><span class="postbody">I'm happy it works cause I wrote it on the fly.
<br/>
0x4000130h is the adress of the register where the keypad state is stored.
<br/>
It is 16 bit wide so we declare a unsigned short int pointing at this adress.
<br/>
As there are 10 buttons on the GBA, only the lower 10 bits of this variable are used, so we mask what is contained by the keypad register to keep these 10 significants bits(maybe it is not vital to do this, but I do it for security as we don't know what value is stored in the 6 upper bits) :
<br/>
*KEY_INPUT &amp; 0x3FF
<br/>
//0x3FF = 0000001111111111
<br/>
Each bit represents the state of a button. If the button is pressed, the corresponding bit is equal to 0, otherwise it is set to 1.
<br/>
So when any key is pressed, all the 10 last bits are set to 1 :
<br/>
if ((*KEY_INPUT &amp; 0x3FF) = 0x3FF)
<br/>
       //no key pressed
<br/>
<br/>
This is easy to figure out, just grap a doc like cowbite or GbaTek (Gbatek rocks!), and read each time the technica info about registers and other stuff. That way you could implement whatever you want (DMA, bios functiun...).
<br/>
<br/>
Cheers</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9512 - yaustar - Thu Aug 07, 2003 1:58 am</h4>
    <div class="postbody"><span class="postbody">It works for what I want it to do, ie do something when NOTHING is pressed. but you seem to say that the code is for when ANY button is pressed.
<br/>
??<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9514 - funkeejeffou - Thu Aug 07, 2003 11:09 am</h4>
    <div class="postbody"><span class="postbody">The code is for no button pressed, excuse my english, I'm french.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9537 - yaustar - Thu Aug 07, 2003 10:06 pm</h4>
    <div class="postbody"><span class="postbody">that's ok, just wanted to be sure :p<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
