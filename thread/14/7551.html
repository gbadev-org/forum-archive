<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>devkitARM/devkitadv & Linux crt0.o compile error - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > devkitARM/devkitadv & Linux crt0.o compile error</h2>
<div id="posts">
<div class="post">
    <h4>#61456 - Savage - Sun Nov 20, 2005 1:53 pm</h4>
    <div class="postbody"><span class="postbody">Hi all, I've been playing with GBA dev on Windows, and am trying to move my operation over to Linux, I've tried both devkitARM and devkitadv, added the path for either and attempted to compile with the following output:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">[savage@savnet-wrk-03 sokoban]$ arm-elf-gcc -o sokoban.elf main.c
<br/>
/opt/devkitARM/bin/../lib/gcc/arm-elf/4.0.2/../../../../arm-elf/bin/ld: crt0.o: No such file: No such file or directory
<br/>
collect2: ld returned 1 exit status</td> </tr></table><span class="postbody">
<br/>
<br/>
Does anyone have any suggestions as to what's causing this? or more importantly, how to fix it :D
<br/>
<br/>
Cheers, Savage</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61460 - pepsiman - Sun Nov 20, 2005 2:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Savage wrote:</b></span></td> </tr> <tr> <td class="quote">Does anyone have any suggestions as to what's causing this? or more importantly, how to fix it :D</td> </tr></table><span class="postbody">
<br/>
You're not using the template.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61463 - Quirky - Sun Nov 20, 2005 3:24 pm</h4>
    <div class="postbody"><span class="postbody">Not sure what template pepsiman means, but try adding -specs=gba.specs:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Â arm-elf-gcc -o sokoban.elf main.c -specs=gba.specs</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61478 - Savage - Sun Nov 20, 2005 5:43 pm</h4>
    <div class="postbody"><span class="postbody">Thanks guys, that's got it compiling without error, next problem :P
<br/>
<br/>
The sokoban.elf file produced is 57Kb smaller than the .elf file produced by the Windows version, and after objcopy, just goes black in the emulator...
<br/>
<br/>
Thanks, Savage</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61482 - wintermute - Sun Nov 20, 2005 6:52 pm</h4>
    <div class="postbody"><span class="postbody">PM me the source, assuming you don't mind, &amp; I'll take a look at what's going on.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61498 - Savage - Sun Nov 20, 2005 11:04 pm</h4>
    <div class="postbody"><span class="postbody">I've just this minute put the source up on me site:
<br/>
<br/>
<a class="postlink" href="http://www.savagereactor.co.uk/?page=computing/gba/sokoban/default.php" target="_blank">http://www.savagereactor.co.uk/?page=computing/gba/sokoban/default.php</a>
<br/>
<br/>
It's not a problem with the source (I don't think), it compiles and works fine on Windows, but I'm trying to move over to Linux as it's my preferred OS, I think it's a problem with devkitARM on Linux, but I've only been into GBA programming for the past week.
<br/>
<br/>
Thanks, Savage</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61519 - wintermute - Mon Nov 21, 2005 4:00 am</h4>
    <div class="postbody"><span class="postbody">You're not kidding about "I strongly recommend against using it as any kind of reference" :P
<br/>
<br/>
Anyway, I've just tried the source on both linux and windows devkitARM and it seems to be working fine for me. The ELF from both systems appears to be identical so I'm not entirely sure what's going on on your system.
<br/>
<br/>
The command line I used was arm-elf-gcc -mthumb -mthumb-interwork -specs=gba.specs main.c -o sokoban.elf
<br/>
<br/>
the -mthumb flag is generally recommended since it produces smaller code overall although ARM code can be much faster in the right circumstances. The data bus to the GBA cart is 16bit which slows ARM code down due to the need to make two fetches for each instruction.
<br/>
<br/>
The important part of the command line is the -mthumb-interwork switch which allows thumb and arm code to call each other, switching state as appropriate. This is mainly necessary for certain parts of the crt0 startup code and interrupt code where ARM code *must* be used.
<br/>
<br/>
There are some issues with the code, related more to good coding practices which make this fairly unsuitable to use as a basis for anything else. I assume you've followed some of the horrendous "tutorials" that plague the homebrew programming scene.
<br/>
<ul>
<br/>
<li> C files should *never* be #included from other C files.
<br/>
</li><li> .h files should never contain code or data, with the exception of static inline functions.
<br/>
</li></ul>
<br/>
<br/>
An extremely good set of tutorials can be found at <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/toc.htm" target="_blank">Cearn Space</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61542 - Savage - Mon Nov 21, 2005 12:42 pm</h4>
    <div class="postbody"><span class="postbody">Cool, that's got it working, thanks :D
<br/>
<br/>
As for the coding, yes I'd agree it's awful, it was my very first attempt at a C program (excluding a hello world app 3 months ago) lol.
<br/>
<br/>
I'd blame myself more than the tutorials I followed, I started with a very basic how to draw a PCX, borrowed those gba_*.h files from Tank Advance, and dived in head first. I'm a self-taught "programmer", if you can call me that, so I've never really been exposed to any good practises, but it's one of my goals for this GBA mission.
<br/>
<br/>
I wasn't going to put the source on the site initially, it's a little embarrassing, but we all have to start somewhere :P
<br/>
<br/>
*edit* coming to think of it, do you know any sites that do document good programming practices?
<br/>
<br/>
Thanks for you're help
<br/>
<br/>
Savage</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
