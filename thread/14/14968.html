<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to simulate an arc (basketball). - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > How to simulate an arc (basketball).</h2>
<div id="posts">
<div class="post">
    <h4>#150359 - 3dfx - Sun Feb 03, 2008 2:20 am</h4>
    <div class="postbody"><span class="postbody">Hey guys, I'm trying to make a 2d bball game. My problem is, how do I make the ball move properly. The ball has a moveX and moveY variable that is added to its x and y position once it is shot. The hoop has its own hoop.x, hoop.y position. How can I find the proper moveX and moveY values for it? -Many thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150364 - Dwedit - Sun Feb 03, 2008 3:11 am</h4>
    <div class="postbody"><span class="postbody">Make it 3D instead.
<br/>
Let's assume you have a Double Dribble or NBA Jam style view of the action.  You have 3 axes: left to right (X), front view to back view (Z), and floor to ceiling (Y).  Make the sprite's Y position a function of Z and Y.
<br/>
<br/>
Simple Newtonian physics says that the X and Z velocity of the ball will remain constant, and there is acceleration on the Y axis due to gravity.
<br/>
<br/>
If you choose to make it completely 2D, making the basketball court into a single straight line, throw out the Z axis.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150365 - tepples - Sun Feb 03, 2008 3:54 am</h4>
    <div class="postbody"><span class="postbody">Sir Isaac Newton's first law of motion is that an object in motion will move at the same velocity unless acted upon by an outside force. This means that in each frame, you should add the velocity into the position of the ball:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  ball.x += ball.dx;
<br/>
  ball.y += ball.dy;
<br/>
  ball.z += ball.dz; </td> </tr></table><span class="postbody">
<br/>
Newton's law of gravity is that objects are attracted by a force proportional to each mass and inversely proportional to the square of the distance between their centers. For objects the size of a basketball on Earth's surface, this force is pretty much constant: 9.8 m/s^2 times the mass of the ball.
<br/>
<br/>
Newton's second law of motion is that the acceleration of an object is proportional to the force applied to it: F = m*a, or a = F/m. In the case of gravity, the mass cancels out, leaving a = 9.8 m/s^2. This means that in each frame, you should add a constant to the height coordinate of velocity:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  ball.dy += M_S2(9.8);</td> </tr></table><span class="postbody">
<br/>
<br/>
By now, you are dealing with quantities smaller than 1 pixel/frame^2, so you should be using some sort of <a class="postlink" href="http://en.wikipedia.org/wiki/Fixed-point_arithmetic" target="_blank">fixed-point arithmetic</a>.
<br/>
<br/>
<br/>
EDIT: clarification of which vector's height coordinate that gravity affects<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"><br/><br/>Last edited by tepples on Sun Feb 03, 2008 11:53 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#150404 - gauauu - Sun Feb 03, 2008 10:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
This means that in each frame, you should add a constant to the height coordinate: 
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  ball.dy += M_S2(9.8);</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Just a nitpick, but to avoid confusion...the code is correct, but you're adding the constant to the y velocity, not to the height itself  (as Tepple's explanation sounds like)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150407 - 3dfx - Sun Feb 03, 2008 10:24 pm</h4>
    <div class="postbody"><span class="postbody">Thanks guys, but I already know how to simulate gravity. My question is how do I make sure the ball has the proper arc to always hit the rim each time the player shoots?
<br/>
<br/>
Here's how I do gravity;
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//ball.x and ball.y are 16.16 fixed point
<br/>
if(ball.released){
<br/>
    ball.vX = somevalue;
<br/>
    ball.dY = -anothervalue;
<br/>
}
<br/>
<br/>
ball.x += ball.vX;
<br/>
ball.dY += GRAVITY;
<br/>
ball.y += ball.dY;
<br/>
<br/>
displaySprite(ball.id, (ball.x&gt;&gt;16), (ball.y&gt;&gt;16));
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Right now, in order to get the right arc I'm just playing around with vX and the initial dY value depending on the player's location.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150408 - Miked0801 - Sun Feb 03, 2008 10:41 pm</h4>
    <div class="postbody"><span class="postbody">Ah, you get to use 1st year physics to solve that problem.  I don't have a book in front of me at the moment, but you are basically giving a start and end x/z positions and probably a starting velocity and need to find the correct shoot angle(s) that will solve the problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150409 - Dwedit - Sun Feb 03, 2008 10:41 pm</h4>
    <div class="postbody"><span class="postbody">Given an initial position, a final position, constant acceleration, and a length of time, you can calculate the initial velocity.
<br/>
<br/>
Vinitial= ( Xfinal-Xinitial - .5 * a*t^2 ) / t
<br/>
<br/>
Vinitial, Xfinal, Xinitial, and a are 3d vectors.  Because there is only acceleration in Y, .5*a*t^2 = 0 for the X and Z axes.
<br/>
<br/>
This probably won't give very good arcs though, since it takes in T as a parameter.
<br/>
<br/>
This also probably explains why the grenades in "Worms" have timed fuses.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150448 - Miked0801 - Mon Feb 04, 2008 7:05 pm</h4>
    <div class="postbody"><span class="postbody">Derived from:
<br/>
1/2 a*(t^2) + Vinit * t + Xfinal - Xinit = 0
<br/>
<br/>
The equation of the parabala is:
<br/>
<br/>
y = (tan ElevationAngle)x - (g / 2(Vinit * cos ElevationAngle) ^ 2) * x^2
<br/>
<br/>
Alas, my physics book has nothing on how to calculate angles when the starting elevation is different between positions.  I believe google is your friend here.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150484 - Cearn - Tue Feb 05, 2008 4:53 pm</h4>
    <div class="postbody"><span class="postbody">The basic equations are:
<br/>
<br/>
x(t) = x0 + vx0*t
<br/>
y(t) = y0 + vy0*t - ½g*t²
<br/>
<br/>
These can be rewritten to the parabola in the space-domain:
<br/>
<br/>
<span style="font-weight: bold">(1)</span> y(x)= A*t² + B*t + C
<br/>
<br/>
With A, B, C having some relation to the initial velocities, vx0 and vy0. To solve this, you'd need three control points, (x0, y0), (x1, y2), and (x2, y2). (x0, y0) and (x2, y2) you have: those are the initial position and the position of the hoop. The other point you're free to choose. With eq (1), these form three new linear equations which corresponds to a matrix formula: <span style="font-weight: bold">M</span>?(A, B C) = (y0, y1, y2), but solving this manually is somewhat unpleasant.
<br/>
<br/>
You can simplify things by switching to <span style="font-weight: bold">relative</span> coordinates: x= x-x0 and y= y-y0. This reduces the system to 2 equations rather then 3:
<br/>
<br/>
⌈ x1² x1 ⌉ ? ⌈ A ⌉ = ⌈ y1 ⌉
<br/>
⌊ x2² x2 ⌋   ⌊ B ⌋    ⌊ y2 ⌋
<br/>
<br/>
Inverting the equation gives
<br/>
<br/>
A = ( x2*y1 - x1*y2)/(x1*x2*(x1-x2))
<br/>
B = (-x2²*y1 + x1²*y2)/(x1*x2*(x1-x2))
<br/>
<br/>
The initial velocities vx0 and vy0 then follow from the first couple of equations:
<br/>
<br/>
vx0 = sqrt(-g/(2A))
<br/>
vy0 = vx0*B
<br/>
<br/>
<a class="postlink" href="http://www.coranac.com/files/misc/arc.xls" target="_blank">Example excel sheet with solution</a>.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150520 - 3dfx - Wed Feb 06, 2008 2:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">Derived from:
<br/>
1/2 a*(t^2) + Vinit * t + Xfinal - Xinit = 0
<br/>
<br/>
The equation of the parabala is:
<br/>
<br/>
y = (tan ElevationAngle)x - (g / 2(Vinit * cos ElevationAngle) ^ 2) * x^2
<br/>
<br/>
Alas, my physics book has nothing on how to calculate angles when the starting elevation is different between positions.  I believe google is your friend here.</td> </tr></table><span class="postbody">
<br/>
<br/>
That was somewhat my problem. At first, I was going to create a parabola but because of the high likelihood of elevation change, I couldn't do that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Inverting the equation gives
<br/>
<br/>
A = ( x2*y1 - x1*y2)/(x1*x2*(x1-x2))
<br/>
B = (-x2?*y1 + x1?*y2)/(x1*x2*(x1-x2))
<br/>
<br/>
The initial velocities vx0 and vy0 then follow from the first couple of equations:
<br/>
<br/>
vx0 = sqrt(-g/(2A))
<br/>
vy0 = vx0*B 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks Cearn! I'll test this out. it looks right to me!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
