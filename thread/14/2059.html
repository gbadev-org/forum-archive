<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>32-bit video buffer writing - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > 32-bit video buffer writing</h2>
<div id="posts">
<div class="post">
    <h4>#10666 - Burton Radons - Thu Sep 11, 2003 8:26 pm</h4>
    <div class="postbody"><span class="postbody">I noticed that when I wrote a horizontal line segment rendering routine to store u32 instead of u16 that it doubled in speed when using VisualBoy Advance to test.  Would this optimisation show up on a real GBA as well, would the 16-bit port size force the same speed, or would it only store the 16-bit and ignore the top half-word?  The HLine code is:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void HLine3 (volatile u16* buffer, int sx, int y, int ex, u16 color)
<br/>
{
<br/>
    volatile u32 *b, *e;
<br/>
<br/>
    /* Parameter clipping excised. */    
<br/>
    b = (u32*) (buffer + sx + y * VideoWidth);
<br/>
    e = b + (ex - sx) / 2;
<br/>
    
<br/>
    while (b &lt;= e)
<br/>
        *b ++ = color | (color &lt;&lt; 16);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
(Yeah, I know that it won't do odd-length lines properly.)  If this is a false optimisation, are there any GBA emulators which insert slowdown after every instruction or set of instructions to keep the emulated processor running at the same speed as the physical one?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10667 - tepples - Thu Sep 11, 2003 9:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Burton Radons wrote:</b></span></td> </tr> <tr> <td class="quote">I noticed that when I wrote a horizontal line segment rendering routine to store u32 instead of u16 that it doubled in speed when using VisualBoy Advance to test.  Would this optimisation show up on a real GBA as well, would the 16-bit port size force the same speed, or would it only store the 16-bit and ignore the top half-word?</td> </tr></table><span class="postbody">
<br/>
A 32-bit write to VRAM works properly, taking only one more cycle than a 16-bit write.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10668 - Burton Radons - Thu Sep 11, 2003 11:20 pm</h4>
    <div class="postbody"><span class="postbody">So a 32-bit write to the VRAM takes three cycles, while two 16-bit writes to the VRAM takes four?  Great, thanks.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
