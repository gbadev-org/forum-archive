<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Platformer Game Coding - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Platformer Game Coding</h2>
<div id="posts">
<div class="post">
    <h4>#33465 - Celeryface - Mon Jan 03, 2005 9:07 pm</h4>
    <div class="postbody"><span class="postbody">I'm just starting to write a platformer game-type demo, and I was wondering if anyone has seen a site/FAQ for the collision detection for this game type?
<br/>
<br/>
For example: Collision detection between the player and the platform, or the player and the enemy.
<br/>
<br/>
It doesn't have to be GBA-specific, but rather the theory on this subject, and on the way to make the player jump (for example the way Super Mario jumps in Super Mario Bros. 3).
<br/>
<br/>
Thanks in advance. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33485 - BlackAura - Tue Jan 04, 2005 11:04 am</h4>
    <div class="postbody"><span class="postbody">The collision detection depends entirely on how you're storing the level data, and how you're moving the objects around. For 3D games, there's really only one basic way to do it (and a few variations), but for 2D games there are many, many more ways. Although, since virtually everything on a GBA is going to be tile-based, it narrows it down a little.
<br/>
<br/>
Movement is a bit easier. Probably the best way is to simulate how objects move in the real world. Every object (including the player) should have a position, a velocity vector, and an acceleration vector. Every frame, you add the velocity vector (or some scalar factor of it) to the position vector, and you add the acceleration vector to the velocity vector. To simulate gravity, you set the acceleration vector to straight down.
<br/>
<br/>
For example (in C-style pseudo code), you might do something like this:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">variable_type player_x, player_y, player_vx, player_vy;
<br/>
<br/>
while(main_loop_is_doing_something)
<br/>
{
<br/>
    // Player controls
<br/>
    if((getJoypad() &amp;&amp; BUTTON_A)&amp;&amp;(playerOnGround))
<br/>
    {
<br/>
        player_vy = -100;
<br/>
        playerOnGround = false;
<br/>
    }
<br/>
<br/>
    // Move the player
<br/>
    player_x += player_vx;
<br/>
    player_y += player_vy;
<br/>
<br/>
    // Check for collisions with the ground
<br/>
    if(playerHitTheGround())
<br/>
    {
<br/>
        playerOnGround = true;
<br/>
        player_vy = 0;
<br/>
    }
<br/>
<br/>
    // Apply gravity if the player is in the air
<br/>
    if(playerOnGround)
<br/>
        player_vy += 1;</td> </tr></table><span class="postbody">
<br/>
<br/>
That's just a basic outline, and you'd have to change it to allow for more complex movements, state changes, and proper collision detection. This technique doesn't work very well if you're using integers for the position and velocity of the objects, so it's best if you use floating point on systems with an FPU (not a GBA, but a PC or something), or fixed point values on systems without an FPU (like a GBA).
<br/>
<br/>
As for the collision detection, it depends on exactly what you want to do with it. What you need to do is check if your player will pass through a wall / the floor after it has moved, and then react to that collision appropriately.
<br/>
<br/>
Generally speaking, unless you want collision with non-square shapes, you basically want to test if two bounding boxes are intersecting. The simplest way is to first check if it's not intersecting - do some test to determine if the objects are not intersecting. If you fail all of those tests, then you have a collision. For example:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct thing_s
<br/>
{
<br/>
   int x, y;
<br/>
   int width, height;
<br/>
} thing_t;
<br/>
<br/>
// Returns true if two things are overlapping
<br/>
int isOverlapping(thing_t *thing, thing_t *other)
<br/>
{
<br/>
   // Is thing to the left of other?
<br/>
   if( (thing-&gt;x + thing-&gt;width) &lt; other-&gt;x )
<br/>
      return 0;
<br/>
 
<br/>
 // Is thing to the right of other?
<br/>
 if( (other-&gt;x + other-&gt;width) &lt; thing-&gt;x )
<br/>
  return 0;
<br/>
<br/>
 // Is thing above other?
<br/>
 if( (thing-&gt;y + thing-&gt;height) &lt; other-&gt;y )
<br/>
  return 0;
<br/>
<br/>
 // Is thing below other?
<br/>
 if( (other-&gt;y + other-&gt;height) &lt; thing-&gt;x )
<br/>
  return 0;
<br/>
<br/>
 // They must be colliding then...
<br/>
 return 1;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
If you want to make sure that works, get a pen and a piece of paper and draw it all out.
<br/>
<br/>
If you want to do collisions with non-square shapes, you'd best learn some geometry.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33496 - identitycrisisuk - Tue Jan 04, 2005 3:22 pm</h4>
    <div class="postbody"><span class="postbody">There's a few threads I've started around here that might be useful to you (or not):
<br/>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=4610" target="_blank">Walking down diagonal tiles</a>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=4385" target="_blank">Methods of jumping in a platform game</a>
<br/>
<br/>
The first one goes into collisions a bit using a non square tile but one that isn't very hard to work out collisions. The other one has some discussion on how you would jump using velocity and an array of set velocity values (not something I've tried).<br/>_________________<br/></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">CanIKickIt(YES_YOU_CAN);</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#33509 - Celeryface - Tue Jan 04, 2005 7:01 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the replies :)
<br/>
<br/>
Does anyone have any info on using large tiled maps for scrolling? I saw a thread on here about stiching backgrounds together, but I'm not sure how to do that or f that method is the correct way. 
<br/>
<br/>
Thanks! :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
