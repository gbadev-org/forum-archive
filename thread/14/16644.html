<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Together Sprite&Background displaying - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Together Sprite&Background displaying</h2>
<div id="posts">
<div class="post">
    <h4>#168578 - semihce - Thu May 07, 2009 2:48 pm</h4>
    <div class="postbody"><span class="postbody">Hi everybody,
<br/>
<br/>
I want to display Sprite and Background images together. When I want to display only background or sprite, it is ok, I can display them seperately. 
<br/>
But when I want to display them together, I got an orange background and my sprite stands there. What happens to my background image?
<br/>
<br/>
Here are my defines:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Set graphics mode
<br/>
#define SCREENMODE_0    0x0     ///&lt; Enable screen mode 0
<br/>
#define SCREENMODE_1    0x1     ///&lt; Enable screen mode 1
<br/>
#define BG1_ENABLE      0x200   ///&lt; Enable background 1
<br/>
#define OBJMAP_1D       0x40    ///&lt; 1D object(sprite) mapping
<br/>
#define OBJ_ENABLE      0x1000   ///&lt; Enables sprites</td> </tr></table><span class="postbody">
<br/>
<br/>
When I want to display only background, I use this code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | BG1_ENABLE | OBJMAP_1D );</td> </tr></table><span class="postbody">
<br/>
<br/>
And when I want to display only sprite, I use this code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | OBJ_ENABLE | OBJMAP_1D );</td> </tr></table><span class="postbody">
<br/>
<br/>
And now, What should I do in order to display both of them together? Please help me..
<br/>
<br/>
Here is a link to the GBA output:
<br/>
<a class="postlink" href="http://ktuce.ktu.edu.tr/~baysemi/GameRevolution.gba" target="_blank">http://ktuce.ktu.edu.tr/~baysemi/GameRevolution.gba</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168579 - Ruben - Thu May 07, 2009 3:49 pm</h4>
    <div class="postbody"><span class="postbody">From what you've said, it should be
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | OBJ_ENABLE | BG1_ENABLE | OBJMAP_1D );</td> </tr></table><span class="postbody">
<br/>
<br/>
However, looking at the binary, it seems that BG0 is the one that holds the correct data so this should be
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | OBJ_ENABLE | BG0_ENABLE | OBJMAP_1D );</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168580 - semihce - Thu May 07, 2009 4:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ruben wrote:</b></span></td> </tr> <tr> <td class="quote">From what you've said, it should be
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | OBJ_ENABLE | BG1_ENABLE | OBJMAP_1D );</td> </tr></table><span class="postbody">
<br/>
<br/>
However, looking at the binary, it seems that BG0 is the one that holds the correct data so this should be
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | OBJ_ENABLE | BG0_ENABLE | OBJMAP_1D );</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
I have done this but still I got the same result</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168581 - Ruben - Thu May 07, 2009 4:44 pm</h4>
    <div class="postbody"><span class="postbody">Well, the #define for BG0 should be 0x0800.. what is the definition of setMode? Is it a libgba function? If so, I'm not much help. :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168582 - semihce - Thu May 07, 2009 5:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ruben wrote:</b></span></td> </tr> <tr> <td class="quote">Well, the #define for BG0 should be 0x0800.. what is the definition of setMode? Is it a libgba function? If so, I'm not much help. :P</td> </tr></table><span class="postbody">
<br/>
<br/>
Here my definitions:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define BG0_ENABLE      0x100   ///&lt; Enable background 0
<br/>
#define BG1_ENABLE      0x200   ///&lt; Enable background 1
<br/>
#define BG2_ENABLE      0x400   ///&lt; Enable background 2
<br/>
#define BG3_ENABLE      0x800   ///&lt; Enable background 3
<br/>
#define OBJ_ENABLE      0x1000  ///&lt; Enable sprites
<br/>
#define REG_DISPCNT   (*(volatile u32*)0x4000000)</td> </tr></table><span class="postbody">
<br/>
<br/>
And here is setMode function:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void Lypson_Graphics::setMode(u16 mode)
<br/>
{
<br/>
   REG_DISPCNT = mode;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168583 - Ruben - Thu May 07, 2009 5:19 pm</h4>
    <div class="postbody"><span class="postbody">Er, my bad, it should've been 0x100, so that's fine..
<br/>
<br/>
DISPCNT is a 16-bit non-volatile register.. that is..
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define REG_DISPCNT   (*(u16*)0x4000000)</td> </tr></table><span class="postbody">
<br/>
<br/>
EDIT: I wrote 32-bit... maybe that's a sign that I should sleep :P
<br/>
EDIT 2: Can you upload a binary with BG0 on?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168585 - semihce - Thu May 07, 2009 5:52 pm</h4>
    <div class="postbody"><span class="postbody">ok, thank you very much.. when I tried this code, it worked
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">setMode( SCREENMODE_0 | OBJ_ENABLE | OBJMAP_1D | BG0_ENABLE );</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
