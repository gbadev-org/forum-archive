<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>NO$GBA errors (Sleep in main loop) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > NO$GBA errors (Sleep in main loop)</h2>
<div id="posts">
<div class="post">
    <h4>#70571 - wiz - Tue Feb 07, 2006 1:15 pm</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
In my main loop I use the following statement to put the GBA to sleep, as I read this is best to help with power saving.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   asm("swi 0x05");</td> </tr></table><span class="postbody">
<br/>
<br/>
However this causes no$gba to report an error (when you click Utilities-&gt;Errors (or F3)).  This is the only line in my current test project, and the error vanishes when I remark the line.
<br/>
<br/>
Why could this be?
<br/>
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70575 - FluBBa - Tue Feb 07, 2006 1:30 pm</h4>
    <div class="postbody"><span class="postbody">Are you calling it from ARM or Thumb mode?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70577 - wiz - Tue Feb 07, 2006 1:44 pm</h4>
    <div class="postbody"><span class="postbody">ok let me see, I believe it is THUMB code.  If I change it to ARM the emulator says "the rom image has crashed"
<br/>
<br/>
sorry if I seem a bit thick just incase you need to see here is my compile statement
<br/>
<br/>
THUMB?:
<br/>
<br/>
arm-elf-g++ -O2 -g -mcpu=arm7tdmi -mthumb -mthumb-interwork -c main.c
<br/>
<br/>
<br/>
here is what I think is correct to change it to ARM?:
<br/>
arm-elf-g++ -O2 -g -mcpu=arm7tdmi -mthumb-interwork -c main.c</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70590 - FluBBa - Tue Feb 07, 2006 3:18 pm</h4>
    <div class="postbody"><span class="postbody">Maybe you have to tell GCC that the SWI can destroy the r0-r3,r12 registers?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70591 - wiz - Tue Feb 07, 2006 3:51 pm</h4>
    <div class="postbody"><span class="postbody">Any clue on how to do that please =)
<br/>
<br/>
believe me - Im a n00b ;D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70605 - wintermute - Tue Feb 07, 2006 6:36 pm</h4>
    <div class="postbody"><span class="postbody">from libgba gba_base.h
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//---------------------------------------------------------------------------------
<br/>
/*! \def SystemCall(Number)
<br/>
<br/>
    \brief helper macro to insert a bios call.
<br/>
      \param Number swi number to call
<br/>
      
<br/>
      Inserts a swi of the correct format for arm or thumb code.
<br/>
<br/>
*/
<br/>
#if   defined   ( __thumb__ )
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"\n" :::  "r0", "r1", "r2", "r3")
<br/>
#else
<br/>
#define   SystemCall(Number)    asm ("SWI     "#Number"   &lt;&lt; 16\n" :::"r0", "r1", "r2", "r3")
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70609 - wiz - Tue Feb 07, 2006 7:20 pm</h4>
    <div class="postbody"><span class="postbody">That did it!
<br/>
<br/>
Thanks a lot you two!
<br/>
<br/>
Back to technically perfect ;)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
