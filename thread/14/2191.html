<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>SHowing sprites on GBA - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > SHowing sprites on GBA</h2>
<div id="posts">
<div class="post">
    <h4>#11430 - HolyHoppsan - Mon Oct 06, 2003 7:43 pm</h4>
    <div class="postbody"><span class="postbody">HI!
<br/>
I have a problem. I?m using the pern tutorials, to learn how to display sprites. Althou I almost copied the sourcecode it does not work, whats wrong, heres my code:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;stdio.h&gt;
<br/>
#include &lt;stdlib.h&gt;
<br/>
#include "gba.h"
<br/>
#include "dispcnt.h"
<br/>
#include "mode.h"
<br/>
#include "pacsprite.h"
<br/>
#include "palette.h"
<br/>
#include "sprites.h"
<br/>
<br/>
u16* SpritePaletteMem = (u16*)0x5000200;
<br/>
u16* ScreenBuffer = (u16*)0x6000000;
<br/>
u16* OAM = (u16*)0x7000000;
<br/>
u16* SpriteData = (u16*)0x6100000;
<br/>
OAMEntry sprites[128];
<br/>
<br/>
pRotData rotData = (pRotData)sprites;
<br/>
<br/>
//Kopiera sprites till sk?rmen
<br/>
void CopyOAM()
<br/>
{
<br/>
   u16 loop;//looping variable for loops
<br/>
   u16* temp;//pointer to sprites
<br/>
   temp = (u16*)sprites;
<br/>
   //loop trough sprites
<br/>
   for(loop = 0; loop &lt; 128*4; loop++)
<br/>
   {
<br/>
      OAM[loop] = temp[loop];
<br/>
   }
<br/>
}//end copyOam
<br/>
<br/>
//initialize Sprites(set them offscreen)
<br/>
void InitializeSprites()
<br/>
{
<br/>
   u16 loop; //loop variable
<br/>
   for(loop = 0; loop &lt; 128; loop++)
<br/>
   {
<br/>
      sprites[loop].attribute0 = 160;//set y offscreen
<br/>
      sprites[loop].attribute1 = 240;//set x to offscreen
<br/>
   }
<br/>
}
<br/>
<br/>
//sync screen drawing
<br/>
void WaitForVsync()
<br/>
{
<br/>
   while((volatile u16)REG_VCOUNT != 160){}
<br/>
}
<br/>
<br/>
void PlotPixel(int x, int y, unsigned short int c);
<br/>
<br/>
int main()
<br/>
{
<br/>
   int loop;
<br/>
   s16 x = 40;
<br/>
   s16 y = 40;
<br/>
   SetMode(MODE_1 | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
   for(loop = 0; loop &lt; 256; loop++)
<br/>
   {
<br/>
   OBJPaletteMem[loop] = palette[loop];
<br/>
   }
<br/>
   
<br/>
   InitializeSprites();
<br/>
<br/>
      sprites[0].attribute0 = COLOR_256 | SQUARE | y;
<br/>
      sprites[0].attribute1 = SIZE_16 | x;
<br/>
      sprites[0].attribute2 = 0;
<br/>
<br/>
            for(loop = 0; loop &lt; 128; loop++)
<br/>
            {
<br/>
            SpriteData[loop] = pacspriteData[loop];
<br/>
            }
<br/>
<br/>
   while(1)
<br/>
   {   
<br/>
      WaitForVsync();
<br/>
      CopyOAM();
<br/>
   }
<br/>
   return(0);
<br/>
}
<br/>
<br/>
void PlotPixel(int x, int y, unsigned short int c)
<br/>
{
<br/>
   ScreenBuffer[y * 120 + x] = c;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11432 - tepples - Mon Oct 06, 2003 7:56 pm</h4>
    <div class="postbody"><span class="postbody">Here's a step-by-step procedure I use to isolate "It doesn't appear!" problems using VisualBoyAdvance's debugging tools:<ol type="1"><li>Try to find your palette data in the Palette Viewer.</li><li>Try to find your sprite cel data in the Tile Viewer.</li><li>Try to find your sprites in the OAM Viewer.</li></ol>
<br/>
Find which step fails, and you're one step closer to finding the responsible lines of code.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11435 - yaustar - Mon Oct 06, 2003 10:49 pm</h4>
    <div class="postbody"><span class="postbody">First off, you dont need 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;stdio.h&gt;
<br/>
#include &lt;stdlib.h&gt; 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
because they are windows specific
<br/>
<br/>
second you dont need
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void PlotPixel(int x, int y, unsigned short int c)
<br/>
{
<br/>
   ScreenBuffer[y * 120 + x] = c;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
because we are using tile modes not bitmap.
<br/>
<br/>
Can you elaborate on 'It does not work', does it compile? blank screen etc<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11436 - sajiimori - Mon Oct 06, 2003 11:54 pm</h4>
    <div class="postbody"><span class="postbody">stdio.h and stdlib.h are *not* Windows-specific.  They are part of the Standard C Library.  stdio.h is not very useful on GBA, but stdlib.h contains abs(), atoi(), malloc(), free(), rand(), and qsort(), which can be handy sometimes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11439 - yaustar - Tue Oct 07, 2003 12:39 am</h4>
    <div class="postbody"><span class="postbody">ahhhh..fair enough, I stand corrected (feeling like a moron).
<br/>
In that case, the code should work....something wrong with the sprite data file maybe?
<br/>
<br/>
edit: Found it! yours said
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16* SpriteData = (u16*)0x6100000;</td> </tr></table><span class="postbody">
<br/>
<br/>
when it should be
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16* SpriteData = (u16*)0x6010000;</td> </tr></table><span class="postbody">
<br/>
<br/>
notice the value<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11523 - HolyHoppsan - Thu Oct 09, 2003 1:25 pm</h4>
    <div class="postbody"><span class="postbody">with it doesn?t wor i mean that the sprite isn?t show, not in the OAM viewer not in paletteViewer and not in tileviewer!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11527 - yaustar - Thu Oct 09, 2003 2:46 pm</h4>
    <div class="postbody"><span class="postbody">Check my previous post, 'u16* SpriteData' was defined to the wrong value.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
