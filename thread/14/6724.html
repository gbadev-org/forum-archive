<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>assignment of value - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > assignment of value</h2>
<div id="posts">
<div class="post">
    <h4>#52626 - Tomik - Thu Sep 01, 2005 1:39 pm</h4>
    <div class="postbody"><span class="postbody">How can I give a Adress a static value ??
<br/>
<br/>
Adress: 0x4000204 
<br/>
Value: 0x0800 
<br/>
<br/>
??
<br/>
<br/>
Thanks for help, Thomas</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52632 - Cearn - Thu Sep 01, 2005 3:52 pm</h4>
    <div class="postbody"><span class="postbody">Pointers, maybe?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16 *ptr= (u16*)0x04000204;  // create pointer reference
<br/>
*ptr= 0x0800;                // dereference
<br/>
<br/>
*(u16*)0x04000204 = 0x0800;  // all at once
<br/>
<br/>
// or the preferred way: defines (and volatiles)
<br/>
#define REG_WSCNT         *(vu16*)(0x04000204)
<br/>
REG_WSCNT= 0x0800;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Don't forget to dereference the pointer. Merely using "ptr= 0x0800" just reassigns the pointer (make it point to another address), not the value at that address.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52634 - Tomik - Thu Sep 01, 2005 4:08 pm</h4>
    <div class="postbody"><span class="postbody">Thankis first, BUT if i do thi I get messages like:
<br/>
<br/>
error C2371: 'ptr' : newdefinition; different basictyps
<br/>
<br/>
what can i do, i tried all the source variantes, but nothing works!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52635 - Cearn - Thu Sep 01, 2005 4:17 pm</h4>
    <div class="postbody"><span class="postbody">What's the <span style="font-style: italic">exact</span> code you're trying? And do all the demos and tutorial examples give the same problem, because this is the way pretty much everything is done. Do you have all the typedefs you need? (u16, vu16, etc)
<br/>
<br/>
Absolutely minimal, yet full, code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int main()
<br/>
{
<br/>
    *(unsigned short*)0x04000000 = 0x0403;
<br/>
    *(unsigned short*)0x06001E40 = 0x001F;
<br/>
<br/>
    while(1);
<br/>
<br/>
    return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
puts 0x0403 into address 0x04000000, and 0x001F into 0x06001E40. If the numbers don't make sense to you, that's exactly why we're using named constants is so important :P.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52639 - Tomik - Thu Sep 01, 2005 4:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// memory location defines
<br/>
u16* FrontBuffer = (u16*)0x6000000;   
<br/>
u16* BackBuffer = (u16*)0x600A000;
<br/>
u16* videoBuffer;
<br/>
volatile u16* ScanlineCounter = (volatile u16*)0x4000006;
<br/>
<br/>
u16 *ptr= (u16*)0x04000204;  // create pointer reference 
<br/>
*ptr= 0x0800;                // dereference 
<br/>
<br/>
*(u16*)0x04000204 = 0x0800;  // all at once 
<br/>
<br/>
<br/>
u16 *paletteMem = (u16*)0x5000000;      // PalMemory is 256 16 bit BGR values starting at 0x5000000
<br/>
<br/>
void EraseScreen(void);            // erases the screen in mode4
<br/>
void Flip(void);               // flips between the back/front buffer
<br/>
void WaitForVblank(void);         // waits for the drawer to get to end before flip
<br/>
void Raster(void);               // draws the raster
<br/>
void Logo(void);               // display the mie logo and sleeps for some seconds   
<br/>
void Pixel(int *yArr);            // draws the 120 pixels and scrolls them
<br/>
void RandomValue(int *yArr);      // random value generator - later use: signal input
<br/>
<br/>
int main(void)
<br/>
{
<br/>
   *(unsigned short*)0x04000204 = 0x0800; 
<br/>
<br/>
   int yArr[120];
<br/>
   int i;
<br/>
<br/>
   for(i=0;i&lt;120;i++)
<br/>
   {
<br/>
      yArr[i]=80;
<br/>
   }
<br/>
   
<br/>
   SetMode(MODE_4 | BG2_ENABLE ); //set mode 4
<br/>
<br/>
   EraseScreen();
<br/>
   Logo();
<br/>
   WaitForVblank();
<br/>
   Flip();
<br/>
   Sleep(100);
<br/>
   RandomValue(yArr);
<br/>
   
<br/>
   while(1)
<br/>
   {   
<br/>
      Raster();
<br/>
      Pixel(yArr);                        
<br/>
      WaitForVblank();
<br/>
      Flip();      
<br/>
   }
<br/>
} </td> </tr></table><span class="postbody">
<br/>
<br/>
And still the Clock at the PHIP Pin is not working !!
<br/>
<br/>
Thomas</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52644 - Cearn - Thu Sep 01, 2005 4:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Tomik wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// &lt;snip&gt;
<br/>
<br/>
u16 *ptr= (u16*)0x04000204;  // create pointer reference 
<br/>
*ptr= 0x0800;                // dereference 
<br/>
<br/>
*(u16*)0x04000204 = 0x0800;  // all at once 
<br/>
<br/>
// &lt;snip&gt;
<br/>
int main(void)
<br/>
{
<br/>
    // &lt;snip&gt;
<br/>
} </td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Assignments can only be done inside functions, not global scop. that's probably why this doesn't compile. Just to be sure what I mean here, this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u16 *ptr= (u16*)0x04000204;  // create pointer reference 
<br/>
</td> </tr></table><span class="postbody">
<br/>
is the definition of a pointer (<span style="font-style: italic">ptr</span>); a global pointer in fact. "But the '=', that's an assignment". Well, technically, it is an initialization (definition+assignment), which is still legal to use outside functions (at least, I think it's called an initialization, it might be something else). Move the assignment inside a function and it should work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52645 - Tomik - Thu Sep 01, 2005 5:01 pm</h4>
    <div class="postbody"><span class="postbody">i checked it and well, no problems with compile but the clock is still not alive ?
<br/>
what can i do ?
<br/>
<br/>
Thomas
<br/>
<br/>
Ps: have to leave now, be back in some hours !!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#52718 - Tomik - Fri Sep 02, 2005 8:54 am</h4>
    <div class="postbody"><span class="postbody">@Cearn: IT WORKS ... I got the Clock ... thanks a lot !!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
