<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DevKitARM setup question - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > DevKitARM setup question</h2>
<div id="posts">
<div class="post">
    <h4>#82494 - jensen - Sat May 06, 2006 10:14 pm</h4>
    <div class="postbody"><span class="postbody">I have used devkitadv for a while and finally switched to devkitarm.  using devkitpro-updater-1.2.7.exe i installed the devkitARM package with msys, libgba, etc..  After following a number of different tutorials, i basically arrive at the same crash point each time.  When I limit the PATH variable to just the devkitarm\bin folder and run this batch file:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">PATH= c:\devkitPro\devkitARM\bin;
<br/>
arm-elf-gcc -mthumb-interwork -c first.c
<br/>
arm-elf-gcc -specs=gba_mb.specs -mthumb-interwork first.o -o first.elf
<br/>
arm-elf-objcopy -O binary first.elf first.gba
<br/>
gbafix first.gba</td> </tr></table><span class="postbody">
<br/>
I get this error. &gt; collect2: _spawnvp: No such file or directory
<br/>
If I add c:\devkitPro\msys\bin to the front of the PATH it hangs on the 3rd line (line where first.elf is outputted). after a while it dumps this..
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">c:\devkitPro\msys\bin\sh.exe: *** WFSO timed out
<br/>
expr: syntax error
<br/>
expr: syntax error
<br/>
dirname: too few arguments
<br/>
Try `dirname --help' for more information.
<br/>
c:\devkitpro\devkitarm\bin\..\lib\gcc\arm-elf\4.1.0\..\..\..\..\arm-elf\bin\ld:
<br/>
exec: .real: not found
<br/>
collect2: ld returned 127 exit status</td> </tr></table><span class="postbody">
<br/>
also, devkitpro and devkitarm are both declared in my env vars as /c/devkitpro during the auto-update.  any help is greatly appreciated!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82499 - Lord Graga - Sat May 06, 2006 10:37 pm</h4>
    <div class="postbody"><span class="postbody">Welcome, another dane?
<br/>
<br/>
Maybe something is wrong with your PATH, try and paste it here.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82500 - jensen - Sat May 06, 2006 10:49 pm</h4>
    <div class="postbody"><span class="postbody">thanks for the reply!  my system env path is set to 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">c:\devkitPro\msys\bin;c:\devkitPro\devkitarm\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\system32\WBEM;C:\Program Files\Perl\bin\;C:\Program Files\Common Files\Adaptec Shared\System;C:\Nokia\Update_Manager\bin;c:\j2sdk1.4.2_06;c:\j2sdk1.4.2_06\bin;c:\j2me\midp2.0fcs\bin</td> </tr></table><span class="postbody">
<br/>
i have tried including "PATH= c:\devkitPro\devkitARM\bin;" as the first line of my batch file (similar to what i'd do with devkitadv).  yes another dane (but born in new jersery).  my mor is from Koge and my far is from Taars.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82522 - wintermute - Sun May 07, 2006 1:46 am</h4>
    <div class="postbody"><span class="postbody">Hmm, in the first case you've discarded the path to msys/bin which is why you get the _spawnvp error. In the second case it appears that the elf2flt ld shellscript is failing - it appears that argv[0] is blank which really shouldn't be the case. I certainly can't reproduce this error here.
<br/>
<br/>
You can rename some files. In devkitPro/devkitARM/arm-elf/bin you'll see ld and ld.real.exe. Rename ld to ld.old and ld.real.exe to ld.exe then everything should work again.
<br/>
<br/>
Despite the fact that most tutorials show you how to use batch files to make compiling a project easier it's actually the wrong way to do it and has several flaws which will show up in more complex projects.
<br/>
<br/>
The right way is to use make and makefiles. devkitPro provides some example templates which are designed to allow the novice to get on with programming without understanding makefiles in detail. If you have the examples installed you'll find a simple base project which includes a PN2 project file. In your case c:\devkitPro\examples\gba\template
<br/>
<br/>
If you open up the makefile you'll see a block like this near the top
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#---------------------------------------------------------------------------------
<br/>
# TARGET is the name of the output, if this ends with _mb a multiboot image is generated
<br/>
# BUILD is the directory where object files &amp; intermediate files will be placed
<br/>
# SOURCES is a list of directories containing source code
<br/>
# DATA is a list of directories containing data files
<br/>
# INCLUDES is a list of directories containing header files
<br/>
#---------------------------------------------------------------------------------
<br/>
TARGET      :=   $(shell basename $(CURDIR))
<br/>
BUILD      :=   build
<br/>
SOURCES      :=   source
<br/>
DATA      :=   
<br/>
INCLUDES   :=
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
TARGET can be an actual name - the default entry is just a bit of code that uses the name of the directory so you don't even have to bother editing the makefile.
<br/>
<br/>
BUILD is the name of the folder where intermediate files will be placed. You don't have to worry about this either, it's simply to keep things tidy.
<br/>
<br/>
SOURCES is a list of directories which contain source files. These must be specified relative to the makefile directory, in this case &lt;path/to/project/&gt;source will be searched for .c and .cpp files.
<br/>
<br/>
DATA is the same thing for files which will be added as pure binary - don't worry about that for now.
<br/>
<br/>
INCLUDE is a list of directories for .h files which will be added to the compilers search path for includes. Again these are relative to the makefile .
<br/>
<br/>
All you really need to do is copy the template directory somewhere, rename it to suit and add your .c or .cpp files to the source directory. You can create an include directory and place your .h files in there or simply place those in the source directory too - the compiler searches for files specified with #include "&lt;filename&gt;.h" in the same directory as the .c or .cpp first.
<br/>
<br/>
Double click the .pnproj file and Programmer's Notepad should open, showing the files you've added in the project tree at the left. Clicking Tools-&gt;make should build the project leaving you with a  .gba file in the top level project directory.
<br/>
<br/>
There are some guides to setting up some other editors in the <a class="postlink" href="http://www.devkitpro.org/faq.shtml" target="_blank">FAQ</a>.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"><br/><br/>Last edited by wintermute on Sun May 07, 2006 5:25 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#82594 - jensen - Sun May 07, 2006 5:13 pm</h4>
    <div class="postbody"><span class="postbody">Great!  Changing the ld files fixed my problems.  Many thanks for your guidelines with make files as well.  Your feedback was extremely helpful!
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You can rename some files. In devkitPro/devkitARM/arm-elf/bin you'll see ld and ld.real.exe. Rename ld to ld.old and ld.real.exe to ld.exe then everything should work again. </td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
