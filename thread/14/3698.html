<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Easy question about linking - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Easy question about linking</h2>
<div id="posts">
<div class="post">
    <h4>#23368 - doudou - Sun Jul 11, 2004 2:25 am</h4>
    <div class="postbody"><span class="postbody">I'm trying to use Apex. I want the Apex architecture to be invisble to my game. Since I have developped a generic GBA engine that produce a MyGenericGBAEngine.o that I link with my game files to create my .gba, I would like to have it encapsulated in MyGenericGBAEngine.o. 
<br/>
<br/>
Simple question : how do I link the a compiled file when I compile MyGenericGBAEngine ? 
<br/>
<br/>
ps : I'm using DevKitAdv without MakeFiles, just batch files</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23373 - jd - Sun Jul 11, 2004 5:55 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doudou wrote:</b></span></td> </tr> <tr> <td class="quote">I'm trying to use Apex.</td> </tr></table><span class="postbody">
<br/>
<br/>
Would I be right in thinking that by "Apex" you mean the Apex Audio System?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doudou wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I want the Apex architecture to be invisble to my game.</td> </tr></table><span class="postbody">
<br/>
<br/>
What do you mean by "invisible"? You're going to need to use AAS's API to get it do anything.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doudou wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Since I have developped a generic GBA engine that produce a MyGenericGBAEngine.o that I link with my game files to create my .gba, I would like to have it encapsulated in MyGenericGBAEngine.o.</td> </tr></table><span class="postbody">
<br/>
<br/>
You want to put AAS in the same object file as your code? To the best of my knowledge that isn't possible, although I'm not sure what the benefit would be.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doudou wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Simple question : how do I link the a compiled file when I compile MyGenericGBAEngine ? 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If you include "-lAAS" at the linking stage then "libAAS.a" (which is basically a collection of .o files) will be linked to your project, assuming that you've got libAAS.a in your library search path (you can add extra folders with the "-L" switch).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doudou wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
ps : I'm using DevKitAdv without MakeFiles, just batch files</td> </tr></table><span class="postbody">
<br/>
<br/>
I'd recommend you switch to using proper makefiles as they're easier in the long run and there's more to getting AAS working than just linking the library to your project - it's all shown in the example makefiles.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23391 - sajiimori - Sun Jul 11, 2004 6:26 pm</h4>
    <div class="postbody"><span class="postbody">I think he wants to wrap the AAS interface with his own module, and then hide AAS from all other modules.  On a system with an OS you would use a dynamically linked library to do this, but does anybody know an easy way in a bare environment?
<br/>
<br/>
Since all the AAS symbols have a prefix, it should be easy to avoid using them accidentally.  If you're still concerned about perfect encapsulation, you should be using C++.  If you are using C++, you can recompile AAS, wrapping everything in a namespace.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23441 - doudou - Tue Jul 13, 2004 1:28 am</h4>
    <div class="postbody"><span class="postbody">sajiimori is right about my intention of wrapping AAS with my own sound module. 
<br/>
<br/>
But for right now, I would accept to link it directly in my game. I tried this : 
<br/>
<br/>
g++ -lAAS -mthumb -mthumb-interwork -o MyGame.elf Framework.o main.o
<br/>
<br/>
and I have this error :
<br/>
<br/>
c:\projets\gba\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: cannot find -lAAS
<br/>
collect2: ld returned 1 exit status
<br/>
<br/>
I don't have libAAS.a in my library path, but I put libAAS.a in my game folder.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23444 - doudou - Tue Jul 13, 2004 1:40 am</h4>
    <div class="postbody"><span class="postbody">ok, there is a progression. I putted the libAAS.a in my lib folder and I now have this :
<br/>
<br/>
<br/>
libAAS.a(AAS_MOD.o): In function `AAS_MOD_SetSongPos':
<br/>
AAS_MOD.o(.text+0xbc): undefined reference to `AAS_Sequence'
<br/>
AAS_MOD.o(.text+0xc8): undefined reference to `AAS_PatternData'
<br/>
c:\projets\gba\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\libAAS.a(AAS_MOD.o): In function `AAS_MOD_Play':
<br/>
AAS_MOD.o(.text+0x2e4): undefined reference to `AAS_DATA_NUM_MODS'
<br/>
<br/>
Is there another .a that I should use ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23445 - jd - Tue Jul 13, 2004 2:15 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doudou wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
libAAS.a(AAS_MOD.o): In function `AAS_MOD_SetSongPos':
<br/>
AAS_MOD.o(.text+0xbc): undefined reference to `AAS_Sequence'
<br/>
AAS_MOD.o(.text+0xc8): undefined reference to `AAS_PatternData'
<br/>
c:\projets\gba\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\libAAS.a(AAS_MOD.o): In function `AAS_MOD_Play':
<br/>
AAS_MOD.o(.text+0x2e4): undefined reference to `AAS_DATA_NUM_MODS'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You also need to run Conv2AAS to convert all your sound files (.mod/.raw/.wav) into two files: AAS_Data.s and AAS_Data.h. AAS_Data.s contains the sound data and should be assembled and linked to your project (this will fix the errors above) and AAS_Data.h should be #included in your code.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
