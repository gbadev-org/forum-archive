<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dynamically putting tiles on map - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Dynamically putting tiles on map</h2>
<div id="posts">
<div class="post">
    <h4>#43466 - sabkaraja - Mon May 23, 2005 9:14 pm</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
I am asking this question after reading the FAQ and newbie questions in this forum. I am not sure whether its my inability to understand it.
<br/>
<br/>
Let me explain what I have done: I have an image (240*176, 256 color) where(240*160 is an image and rest are gfx of alphabets and numbers).
<br/>
I have a bgchar[...] = {................};
<br/>
I have a bgmap[32*20] = {.................};
<br/>
<br/>
What I want to acheive is:add some text on the screen which will be visible along with the background image at runtime. I dont want to create sprites. I want to have dynamically modify the bg map and add string like score or debug messages which should overlay on top of this bg layer itself.
<br/>
<br/>
As an example I created another tempmap[4] = {........}; where each element is tile on the bgchar.
<br/>
<br/>
Now when I use DmaArrayCopy(3, tempmap, BG_VRAM + 0x1000, 16);
<br/>
it replaces the whole image instead of the text at the said location.
<br/>
<br/>
<br/>
Am I doing something seriously wrong ?
<br/>
<br/>
TIA
<br/>
<br/>
Rajesh</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43544 - jenswa - Tue May 24, 2005 12:51 pm</h4>
    <div class="postbody"><span class="postbody">You can create the text with sprites on top of the bg. This way you don't need the rewrite the entire background.
<br/>
<br/>
You can put the text on the background. But then you need to render the text in the bitmap. Bitmap contains pixels and the pixels have positions.
<br/>
You need to replace several pixels in the bitmap with some colour to create a character.
<br/>
What i am actually saying is that you should try to start with rendering a square over your bitmap background.
<br/>
The square has an simple shape, which makes calculating the positions of the pixels relatively simple.
<br/>
When you've experimented with the square you can try more difficult shapes like a circle and text characters.
<br/>
<br/>
I hope this helps you a bit.
<br/>
Jenswa<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43564 - Lord Graga - Tue May 24, 2005 7:00 pm</h4>
    <div class="postbody"><span class="postbody">Jenswa is making it far too complicated :)
<br/>
<br/>
What you want to do right now is 8x8 fonts on a tilemap. To do this, create a font gfx with the text in ASCII order (i.e, space is 0x20, A is 0x21, B is 0x22, C is 0x23, etc), and then to write a piece of text to the tilemap, simply copy the string to the map one letter at the time, with the tileoffset as the first letter's tile (space) subtracted by 0x20 (32).
<br/>
<br/>
Pseudocode:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">function "print text to map" (mapbuffer, x, y, string)
<br/>
<br/>
    for i = 0 to stringlength
<br/>
<br/>
        (u16) mapbuffer[ x + y * 32 + i ] = (char) string[ i ] - 32
<br/>
<br/>
    next i
<br/>
<br/>
end function</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43671 - sabkaraja - Wed May 25, 2005 4:57 pm</h4>
    <div class="postbody"><span class="postbody">Thanks everyone.
<br/>
<br/>
I managed to put dynamic fonts on the BG.
<br/>
<br/>
Taking it up to the next level. At present the fonts are 7*7 in size and are positioned as tile. I would like to know how we can plot a font which is bigger than a tile and space it evenly , say two pixels each (not with tiles). 
<br/>
<br/>
If I am doing that, part of a letter will be lying in one tile and rest in another.
<br/>
<br/>
I am not sure whether I am clear.
<br/>
<br/>
Regards
<br/>
<br/>
Rajesh</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43689 - Miked0801 - Wed May 25, 2005 6:40 pm</h4>
    <div class="postbody"><span class="postbody">That gets much more difficult.  It's a matter of checking for char edge boundaries and handling it.  Too much code to really post here.  Basically, if you want to do this easier, use sprites.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43693 - sabkaraja - Wed May 25, 2005 7:17 pm</h4>
    <div class="postbody"><span class="postbody">Sprites are agreeable.
<br/>
<br/>
However the main idea driving me is - there's a limit of sprites you can have on screen. What if I want to have a screen where there are screen ful text plus some sprite animations to go with that.
<br/>
<br/>
I dont know if that can be achieved through sprites itself. I would choose bg to render text, if I had a way (unless there's a better way). 
<br/>
<br/>
Regards</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43695 - poslundc - Wed May 25, 2005 7:28 pm</h4>
    <div class="postbody"><span class="postbody">Unfortunately, there is always a tradeoff whichever method you go with.
<br/>
<br/>
Games that use sprites for their fonts usually multiplex the sprites to get around the OAM limitation. This means every N scanlines you change the OAM values during HBlank to point to different characters. It's an advanced technique and has some drawbacks.
<br/>
<br/>
Painting to a background across tile boundaries is always going to incurr a performance hit, but many games prefer this method regardless. This is also the reason many of them display text one character at a time, so they don't have to paint them all in one go.
<br/>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=1764" target="_blank">This thread</a> is about the definitive resource on the different strategies.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43879 - sabkaraja - Fri May 27, 2005 3:49 pm</h4>
    <div class="postbody"><span class="postbody">Sorry about this. This is regaring one problem which started off this topic.
<br/>
<br/>
I created bg map with some deafult tiles.
<br/>
<br/>
Later added/changes some tiles on that.
<br/>
<br/>
But whatever I do, the updated tile doesnt seem to get updated in the VRAM.
<br/>
<br/>
I noticed that if i add the dynamic tiles before I go into the while loop in the main function, it is visible. However if I do it within a function inside the loop, it doesnt !
<br/>
<br/>
Why does it happen? Any suggestions ?
<br/>
<br/>
I tried &amp; used
<br/>
DMAArrayCopy
<br/>
CPUFastArrayCopy
<br/>
<br/>
Regards</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44045 - sabkaraja - Sun May 29, 2005 7:43 pm</h4>
    <div class="postbody"><span class="postbody">Hey... I think that since I was defining the bg map with default tiles - it was loaded into ROM.
<br/>
<br/>
So I removed the default tiles and tried to generate them at runtime.. It displayed some thing on screen.
<br/>
<br/>
So I went back to the first step and added the 
<br/>
attribute__ ((section (".sbss"))) 
<br/>
<br/>
attribute to the map data to load it in external ram.
<br/>
<br/>
But that doesnt work.. Will anyone please give a brief or pointer to this situation.
<br/>
<br/>
Thanks in advance
<br/>
<br/>
Regards</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44051 - tepples - Sun May 29, 2005 8:32 pm</h4>
    <div class="postbody"><span class="postbody">Anything in section .sbss will be loaded as zeroes. Use section .ewram if you're loading actual data into RAM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
