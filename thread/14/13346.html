<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Solved - Including Data - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Beginners > Solved - Including Data</h2>
<div id="posts">
<div class="post">
    <h4>#130469 - Azenris - Sun Jun 03, 2007 10:32 pm</h4>
    <div class="postbody"><span class="postbody">NDS
<br/>
<br/>
Ive been trying to read through a few sites on including data but i feel as though im just confusing myself more. Hoping you can direct me to a simple explanation or point out whats exactly going on.
<br/>
<br/>
Im using the makefile included with devkitpro located in the examples\nds\templates\arm9 folder.
<br/>
<br/>
I have had my game working but I started reading including data in .h files was bad practice and this is what I was doing (had the tile data in it).
<br/>
<br/>
So now i've decided I wanna do it the proper way. Which is something I dont quite get.
<br/>
<br/>
===============================================
<br/>
<br/>
the file was originally blocks.h and included in the main.cpp.
<br/>
it included data such as 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const u8 redBlock1[64] = 
<br/>
{
<br/>
...
<br/>
}; 
<br/>
const u8 yellowBlock1[64] = 
<br/>
{
<br/>
...
<br/>
};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
so here is where I started trying things. I removed the 
<br/>
#ifndef _INCLUDE_BLOCKS_H
<br/>
#define _INCLUDE_BLOCKS_H
<br/>
#endif
<br/>
<br/>
and renamed it blocks.cpp and placed it in the source folder.
<br/>
I then made another file in the include folder, blocks.h which had
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
extern const u8 redBlock1[];
<br/>
extern const u8 yellowBlock1[];
<br/>
extern const u8 greenBlock1[];
<br/>
extern const u8 blueBlock1[];
<br/>
extern const u8 purpleBlock1[];
<br/>
extern const u8 blackBlock1[];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
etc...
<br/>
<br/>
I included the blocks.h in the main.cpp.
<br/>
<br/>
I attempted to compile assuming the blocks.cpp would be made an object file or something and linked in, but I get the error i have not declared them. redBlock1 not declared. etc
<br/>
<br/>
===============================================
<br/>
<br/>
what on earth am I doing here :)
<br/>
<br/>
P.S Not sure where to post this, I just saw beginner section and thought it was right for me!</span><span class="gensmall"><br/><br/>Last edited by Azenris on Mon Jun 04, 2007 3:39 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#130481 - tepples - Sun Jun 03, 2007 11:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Azenris wrote:</b></span></td> </tr> <tr> <td class="quote">I attempted to compile assuming the blocks.cpp would be made an object file or something and linked in, but I get the error i have not declared them. redBlock1 not declared. etc</td> </tr></table><span class="postbody">
<br/>
Please paste the <span style="font-weight: bold">exact</span> minimal source code that produces misbehavior, and please paste the <span style="font-weight: bold">exact</span> error messages, <span style="font-weight: bold">without "etc."</span>. Otherwise, we are groping in the dark.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130485 - Azenris - Mon Jun 04, 2007 12:18 am</h4>
    <div class="postbody"><span class="postbody">My main concern is whether im placing the files in the correct place. I mean should blocks.cpp be in source, with blocks.h in incluce.
<br/>
<br/>
This are the errors I get: <a class="postlink" href="http://hoholand.myby.co.uk/Error.txt" target="_blank">http://hoholand.myby.co.uk/Error.txt</a>
<br/>
<br/>
As for the Code
<br/>
<br/>
blocks.cpp located in the source folder (Full here incase  <a class="postlink" href="http://hoholand.myby.co.uk/blocks.cpp" target="_blank">http://hoholand.myby.co.uk/blocks.cpp</a>)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
unsigned short int BACKGROUND_COLOUR = BLUE;
<br/>
<br/>
const u8 redBlock1[64] = 
<br/>
{ 
<br/>
... 
<br/>
}; 
<br/>
const u8 yellowBlock1[64] = 
<br/>
{ 
<br/>
... 
<br/>
};  
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
blocks.h located in the include folder  (Full here incase  <a class="postlink" href="http://hoholand.myby.co.uk/blocks.h" target="_blank">http://hoholand.myby.co.uk/blocks.h</a>)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef _INCLUDE_BLOCKS_H
<br/>
#define _INCLUDE_BLOCKS_H
<br/>
<br/>
extern  unsigned short int BACKGROUND_COLOUR;
<br/>
extern const u8 redBlock1[];
<br/>
extern const u8 yellowBlock1[];
<br/>
// plus all the others
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The game did work oringally but I wanted to remove having data in a header by doing this. Is this what you needed ? I dont know what else to include. I don't mind showing it all, just want to understand this.<br/>_________________<br/><a class="postlink" href="http://sacredpotion.blogspot.com/" target="_blank"><span style="color: red">My Homebrew Games</span></a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130486 - keldon - Mon Jun 04, 2007 12:32 am</h4>
    <div class="postbody"><span class="postbody">I assume you are including "blocks.h" in "main.cpp" - the file that is giving the errors! And have you also performed make clean?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130487 - Azenris - Mon Jun 04, 2007 12:47 am</h4>
    <div class="postbody"><span class="postbody">yea its included, whats a make clean though. Or is do you mean by that deleting the build folder and starting fresh.<br/>_________________<br/><a class="postlink" href="http://sacredpotion.blogspot.com/" target="_blank"><span style="color: red">My Homebrew Games</span></a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130489 - tepples - Mon Jun 04, 2007 1:36 am</h4>
    <div class="postbody"><span class="postbody">'make clean' means that at the MSYS command prompt, you <span style="font-weight: bold">cd</span> to the folder containing the makefile and then <span style="font-weight: bold">make clean</span>. If you don't understand this, you can do the same thing by deleting all the .o files in the build folder.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130508 - Cearn - Mon Jun 04, 2007 9:00 am</h4>
    <div class="postbody"><span class="postbody">Note that the errors say "undefined reference", not "variable undeclared". Both blocks.cpp and main.cpp compile fine, it's at the linking stage that it goes wrong.
<br/>
<br/>
Try including blocks.h in blocks.cpp as well. If I recall, C++ will consider constant data as 'static' (i.e., local within a file) unless there's an external declaration in the file that has the definition. So
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// blocks.cpp
<br/>
<br/>
#include "blocks.h"
<br/>
<br/>
const u8 redBlock1[64] =
<br/>
{
<br/>
...
<br/>
};
<br/>
<br/>
// etc
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// main.cpp
<br/>
<br/>
#include "blocks.h"
<br/>
<br/>
// etc
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130521 - Azenris - Mon Jun 04, 2007 3:39 pm</h4>
    <div class="postbody"><span class="postbody">I did need to include blocks.h in the blocks.cpp file. After that it worked fine.
<br/>
<br/>
Thanks guys :)<br/>_________________<br/><a class="postlink" href="http://sacredpotion.blogspot.com/" target="_blank"><span style="color: red">My Homebrew Games</span></a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
