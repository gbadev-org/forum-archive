<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Setting the palette number for 16-colour backgrounds in mode - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > Setting the palette number for 16-colour backgrounds in mode</h2>
<div id="posts">
<div class="post">
    <h4>#34442 - Celeryface - Wed Jan 19, 2005 7:04 pm</h4>
    <div class="postbody"><span class="postbody">Hi there,
<br/>
<br/>
Does anyone know how to set the palette number for 16-colour backgrounds in mode 0? I see that you need to set the same bits (12-15) as OAM sprites do for palettes, but how do you set the 16-colour background to use a certain palette number entry? 
<br/>
<br/>
Is it done on a per-tile basis, or can you set the whole background to use 1 of the 16-colour palettes?
<br/>
<br/>
Thanks in advance. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34445 - DekuTree64 - Wed Jan 19, 2005 7:30 pm</h4>
    <div class="postbody"><span class="postbody">Yup, palettes are set per-tile, in the top 4 bits of the screeen data entries (except on rotation screens, which can only be 256 color and use 8-bit screen entries). Check GBATEK/CowBite for details.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34446 - Celeryface - Wed Jan 19, 2005 7:40 pm</h4>
    <div class="postbody"><span class="postbody">Do you know if there's an option in gfx2gba to store the palette number in the map data source file itself per tile?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34451 - DekuTree64 - Wed Jan 19, 2005 8:29 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, I haven't used gfx2gba, but it should have a 4-bit option of some sort that will give you the 4-bit char data, palette data, and screen data with H/V flipping and palette numbers set (usually in seperate files, called something like file.gfx, file.pal and file.map)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34454 - Celeryface - Wed Jan 19, 2005 9:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">Sorry, I haven't used gfx2gba, but it should have a 4-bit option of some sort that will give you the 4-bit char data, palette data, and screen data with H/V flipping and palette numbers set (usually in seperate files, called something like file.gfx, file.pal and file.map)</td> </tr></table><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">=======================
<br/>
gfx2gba Converter v0.13
<br/>
-----------------------
<br/>
(C) 2oo1-2oo2 [TRiNiTY]
<br/>
=======================
<br/>
<br/>
Usage: gfx2gba [options] bmp/pcx/tga/tim/spr files ...
<br/>
<br/>
Options are:
<br/>
<br/>
 -pPalettename                  -m generate map (optimized)
<br/>
 -oOutputdir                    -M generate map (not optimized)
<br/>
 -fOutput format                -mm generate metatiled map (optimized)
<br/>
 -sSection                      -MM generate metatiled map (not optimized)
<br/>
 -SpSuffix for palette          -bBank for map
<br/>
 -SmSuffix for map              -mc save map in column order
<br/>
 -StSuffix for tiledata         -F turn off check for flipped tiles
<br/>
 -TMetatilesize                 -rs output a rotate/scale BG screen map
<br/>
 -tTilesize                     -P don't save palette data
<br/>
 -tc save tiles as columns      -G don't save tile/image data
<br/>
 -cColordepth                   -D don't save map data
<br/>
 -CColor-Offset                 -X don't save anything
<br/>
 -A force color offset add      -Z compress everything
<br/>
 -aTransparent color            -zt compress tile/bitmap data
<br/>
 -vVRAM-Offset                  -zp compress palette data
<br/>
 -x don't merge palettes        -zm compress map data
<br/>
 -q quiet mode                  -ap use aPLib as compressor
<br/>
 -B only optimize blank tiles   -aps use aPLib (safe) as compressor
<br/>
                                -align add alignment info for GCC</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm not too sure which option it is. Has anyone used this to set the palette number for your background data? :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34455 - DekuTree64 - Wed Jan 19, 2005 9:35 pm</h4>
    <div class="postbody"><span class="postbody">Looks like you'd use -c4 for 4-bit, and -m to generate the map data with the palettes set (if I'm understanding his -cColordepth option right)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34456 - Celeryface - Wed Jan 19, 2005 9:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">Looks like you'd use -c4 for 4-bit, and -m to generate the map data with the palettes set (if I'm understanding his -cColordepth option right)</td> </tr></table><span class="postbody">
<br/>
<br/>
Hmm. I use -c16 for 16-colour mode, and -m to generate the map. Can you set the actual 16-colour palette number using this tool though?
<br/>
<br/>
If not, then I can just combine all the backgrounds to use the same palette and use the 256-colour mode.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34525 - Celeryface - Thu Jan 20, 2005 11:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Celeryface wrote:</b></span></td> </tr> <tr> <td class="quote">Hi there,
<br/>
<br/>
Does anyone know how to set the palette number for 16-colour backgrounds in mode 0? I see that you need to set the same bits (12-15) as OAM sprites do for palettes, but how do you set the 16-colour background to use a certain palette number entry? 
<br/>
<br/>
Is it done on a per-tile basis, or can you set the whole background to use 1 of the 16-colour palettes?
<br/>
<br/>
Thanks in advance. :)</td> </tr></table><span class="postbody">
<br/>
<br/>
I found that when loading the map data, I just set the palette number by ORing it with the palette number and a bit shift:
<br/>
<br/>
screenDest[index] = mapData[index] |  ( paletteNum &lt;&lt; 12 );
<br/>
<br/>
And it works. :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
