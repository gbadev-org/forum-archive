<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Moving Sprite in ARM - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Beginners > Moving Sprite in ARM</h2>
<div id="posts">
<div class="post">
    <h4>#28863 - ozahid - Mon Nov 08, 2004 12:04 am</h4>
    <div class="postbody"><span class="postbody">The following is the code i used to try to move the sprite to a different coording (originally 10,10) when the forward button is pressed. During VDraw it checks for a keydown, if its down it sets r6 to 1. Then in VBlank, if r6 is 1 it updates the attributes to have new X and Y values. Then resets r6 to 0. Now, when I run the file on the emulator it works when you hit forward. However, after that the sprite starts refreshing like crazy, I don't see what I did wrong =(
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   ldr r0,=0x04000006   ;VCount
<br/>
   ldr r1,=0x04000130   ;key register
<br/>
   ldr r2,=0x07000000   ;OAM Reg
<br/>
   MOV r5,#10   ;x value
<br/>
   MOV r6,#0      ;updated?
<br/>
<br/>
Inf
<br/>
VDraw   LDR   r3,[r0]
<br/>
   CMP    r3,#160
<br/>
   BGE    VBlank
<br/>
   LDR   r4,[r1]
<br/>
   ANDS   r4,r4,#16
<br/>
   ADDEQ   r5,r5,#10
<br/>
   MOVEQ   r6,#1   
<br/>
   B   VDraw
<br/>
   
<br/>
VBlank   LDR   r3,[r0]
<br/>
   CMP    r3,#160
<br/>
   BLT    Inf
<br/>
   CMP   r6,#1
<br/>
   LDREQ    R1,=(SQUARE|COLOR_16|50)|((SIZE_32|50)&lt;&lt;16)
<br/>
   STREQ    R1,[R2]+4!   ;Move to attribute 2
<br/>
   LDREQ    R1,=0        ;Tile numbeR 0
<br/>
   STREQ    R1,[R2] 
<br/>
   MOVEQ   R6,#0
<br/>
   b      VBlank</td> </tr></table><span class="postbody"><br/>_________________<br/><a href="http://people.umass.edu/ozahid" target="_blank">http://people.umass.edu/ozahid</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28864 - poslundc - Mon Nov 08, 2004 12:56 am</h4>
    <div class="postbody"><span class="postbody">Are you releasing the forward button before 1/60th of a second passes and your code executes again?
<br/>
<br/>
(HINT: You need more sophisticated code than just checking whether the button is being pushed down or not. You need to compare the current state of the button to its previous state, and take action based on that. This is usually a lot simpler from a high-level language like C.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28876 - FluBBa - Mon Nov 08, 2004 10:18 am</h4>
    <div class="postbody"><span class="postbody">R2 is screwed up after the first write.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
