<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>colors problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > colors problem</h2>
<div id="posts">
<div class="post">
    <h4>#21450 - realV - Sat May 29, 2004 2:52 pm</h4>
    <div class="postbody"><span class="postbody">Code (GNU gas)
<br/>
---------------------
<br/>
<br/>
.text
<br/>
.arm
<br/>
.global main
<br/>
<br/>
bitmap: .hword 0x1FFF,0xFFFF,0x1111,0x1232
<br/>
<br/>
main:
<br/>
      ldr r0,=0x04000000
<br/>
      ldrh r1,=0x0403
<br/>
      strh r1,[r0]
<br/>
<br/>
      ldr r0,=0x06000000
<br/>
      ldr r1,=bitmap
<br/>
      ldr r2,=4
<br/>
.load:
<br/>
      ldrh r3,[r1],#2
<br/>
      strh r3,[r0],#2
<br/>
      subs r2,r2,#1
<br/>
bne .load
<br/>
<br/>
.loop:
<br/>
b .loop
<br/>
<br/>
I tested this code on Linux VisualBoyAdvance , WindowsXp VisualBoyAdvance , Linux Boycott but all pixels that are displayed on the screen are BLUE (VBA) or WHITE (boycott). 
<br/>
When i write this programm in goldroad asm then it is ok ,  but GNU as dosn't work.
<br/>
<br/>
The next programm in gas works:
<br/>
<br/>
    ldr r0,=0x06000000
<br/>
    ldrh r1,=0x1FFF            
<br/>
    strh r1,[r0]
<br/>
<br/>
the displayed pixel color is ok 
<br/>
<br/>
I don't know where is the problem , maybe someone can help me.
<br/>
<br/>
PS: Sory for my anglish</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21472 - sajiimori - Sat May 29, 2004 7:25 pm</h4>
    <div class="postbody"><span class="postbody">You're not writing back to r0 and r1 in the loop.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21480 - realV - Sat May 29, 2004 9:46 pm</h4>
    <div class="postbody"><span class="postbody">I found some error:
<br/>
<br/>
bitmap: .word 0x1FFF1FFF
<br/>
<br/>
main:
<br/>
    ldr r0,=0x04000000
<br/>
    ldrh r1,=0x0403
<br/>
    strh r1,[r0]
<br/>
<br/>
   ldr r0,=0x06000000
<br/>
   ldr r1,=bitmap
<br/>
<br/>
   ldr r2,[r1]   
<br/>
   str r2,[r0]  --&gt; now the walue at address r0 should be 0x1FFF1FFF but 
<br/>
                   --&gt; VisualBoyAdvance (windows) disassemble tool shows
<br/>
                   --&gt; that the walue 0x06000000 = 464c457f so the first 2 pixels are not YELLOW
<br/>
<br/>
but where is the bug in my code  , please help ?
<br/>
<br/>
PS: Sorry for my anglish</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21484 - realV - Sat May 29, 2004 10:39 pm</h4>
    <div class="postbody"><span class="postbody">Low level hacking is realy cool :)
<br/>
The code should look like:
<br/>
<br/>
...
<br/>
<br/>
ldr r0,=0x06000000
<br/>
ldr r1,=bitmap
<br/>
<br/>
str r1,[r0] @now 0x06000000=0x1FFF1FFF
<br/>
<br/>
...
<br/>
<br/>
Now it works ...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
