<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>If/Else - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Beginners > If/Else</h2>
<div id="posts">
<div class="post">
    <h4>#43413 - Ultima2876 - Mon May 23, 2005 5:42 am</h4>
    <div class="postbody"><span class="postbody">How fast are these if/else conditionals? As in, anyone know how many processor cycles they use? Or do you need more information, like specifically what the if contains?
<br/>
<br/>
Something like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(temp &gt;= cold)
<br/>
{
<br/>
  //whatever
<br/>
 }
<br/>
else { //whatever }</td> </tr></table><span class="postbody">
<br/>
<br/>
or
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(temp &gt;= 75)
<br/>
{
<br/>
  //whatever
<br/>
 }
<br/>
else { //whatever }</td> </tr></table><span class="postbody">
<br/>
<br/>
If I'm doing a lot of these (a few hundred) would it be wasting a lot of cycles, or are they just single cycle or two-cycle operations?
<br/>
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43415 - poslundc - Mon May 23, 2005 6:14 am</h4>
    <div class="postbody"><span class="postbody">There is no simple answer to your question. The number of cycles depends on the processor mode, what region of memory the code is running from, etc.
<br/>
<br/>
And yes, the contents of the conditional affect execution time, because any code inside the conditional must be executed, whether it's a simple comparison of two variables (like your example), a function call, or whatever else you put in there.
<br/>
<br/>
The bigger question isn't the number you're doing, but how often you're doing them. A few hundred isn't necessarily a big deal if it's only happening once a frame. But it would still be wise to nest your if-statements so that you aren't doing comparisons when they aren't necessary, and use switch statements where they are appropriate (which can be compiled into jump tables to save on comparisons).
<br/>
<br/>
Keep in mind the Pareto rule: 80% of the processor's time is usually spent within 20% of the code - usually inside nested loops somewhere. Find that 20% of code and optimize it; don't worry so much about the general case.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43436 - jma - Mon May 23, 2005 3:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">There is no simple answer to your question. The number of cycles depends on the processor mode, what region of memory the code is running from, etc.</td> </tr></table><span class="postbody">
<br/>
<br/>
Another one most people forget about (which I think Dan was touching on with processor mode) is the size of the conditional; this is one of the greatest poster-boys for factoring. In thumb mode, the largest branch instruction (conditional) is 8-bit (signed), so ~127 bytes. So let's take a simple example:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (temp &gt;= 75) {
<br/>
  // do gobs of code that compile to &gt; 128 bytes
<br/>
} else {
<br/>
  // do gobs more code
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Now the conditional will have to compile to more than just a simple compare/branch, because a branch will be too far. Most likely it will compile to a compare/not-branch/branch-with-link (or something similar). Note that the compiler you use could impact this as well. If your <span style="font-weight: bold">else </span>section was &lt; 128 bytes, it might put that first and switch the test to &lt; instead of &gt;=.
<br/>
<br/>
Now, 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ultima2876 wrote:</b></span></td> </tr> <tr> <td class="quote">If I'm doing a lot of these (a few hundred) would it be wasting a lot of cycles, or are they just single cycle or two-cycle operations? </td> </tr></table><span class="postbody">
<br/>
<br/>
In your case, assuming everything else is good (thumb in ROM or arm in IWRAM, and the code inside the conditional is of a reasonable size), then you are talking about a couple cycles. The best way for you to improve your performance if you are doing this in a loop, and <span style="font-weight: bold">temp </span>isn't changing would be to either a) precalculate the boolean or b) mark <span style="font-weight: bold">temp </span>as going into a register (which it probably already is).
<br/>
<br/>
But, please.... profile a finished gob of code first and find out where your slow-down is. I can't count the number of programmers I've seen try and optimize (read: waste time on) a section of code that just doesn't get hit that often, and isn't really the bottleneck.
<br/>
<br/>
Best wishes,
<br/>
Jeff M.<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43444 - Ultima2876 - Mon May 23, 2005 5:05 pm</h4>
    <div class="postbody"><span class="postbody">Thanks very much, both you guys, you've helped a lot ^_^</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
