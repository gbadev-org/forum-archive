<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>diffrent sprites? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > diffrent sprites?</h2>
<div id="posts">
<div class="post">
    <h4>#20156 - CodeMasterMike - Mon May 03, 2004 10:12 am</h4>
    <div class="postbody"><span class="postbody">I'm trying to use several diffrents sprites in my GBA project.
<br/>
Meaning that I use diffrent headers, not the same.
<br/>
<br/>
<br/>
Here, for every new sprite I use, I add 1 to 'usingSprite'.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
pSpriteVar[usingSprite].attribute0 = COLOR_256 | MODE_TRANSPARENT | yOnScreen;
<br/>
pSpriteVar[usingSprite].attribute1 = SIZE_64 | xOnScreen;
<br/>
pSpriteVar[usingSprite].attribute2 = varOnScreen;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And down here are when I initialize the two objects 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Spiders = new CSpider(1, 1, (8*8), alien3Data, alien3Palette, 1);
<br/>
    
<br/>
Barney = new CMainCharacter(80, 85, numbOnScreen, tank3Data, tank3Palette, 0);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
(the last variable in the inparameter, is the 'usingSprite' value)
<br/>
<br/>
The problem is, that it draws out the same "picture" on the diffrent places, 
<br/>
I have no idea why it does this.
<br/>
[/code]<br/>_________________<br/>Eating meat is not a choise, it's a instinct</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20157 - NoMis - Mon May 03, 2004 10:31 am</h4>
    <div class="postbody"><span class="postbody">Seems your not changing the varOnScreen value which gos to attr2. Attr2 holds the character index where the actual sprite data beginns. If this value is the same on both sprites than this could be the mistake.
<br/>
<br/>
NoMis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20158 - CodeMasterMike - Mon May 03, 2004 1:13 pm</h4>
    <div class="postbody"><span class="postbody">No, I set the varOnScreen first in the function along with the x and y.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    xOnScreen = x;
<br/>
    yOnScreen = y;
<br/>
    varOnScreen = numbOnScreen;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I've tried to make a new project where I just use 2 classes and each class draws one sprite, but I still got the same problem
<br/>
<br/>
here is one of the classes called "TankClass"
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Tank::Tank(int x, int y, int numb, const unsigned short* Data, const unsigned short* Palette, int number)
<br/>
{
<br/>
    xOnScreen = x;
<br/>
    yOnScreen = y;
<br/>
    varOnScreen = numb;
<br/>
    usingSprite = number;
<br/>
    
<br/>
    //set the sprite palette
<br/>
    for(int n = 0; n &lt; 256; n++)
<br/>
        SpritePal[n] = Palette[n];
<br/>
<br/>
    //copy the sprite image into memory
<br/>
    for(int n = 0; n &lt; (256*8); n++)
<br/>
        SpriteData[n] = Data[(256*8) + n];
<br/>
<br/>
    //set the video mode--mode 2 with sprites
<br/>
    SetMode(2 | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
    // Hide the sprites
<br/>
    for(int n = 0; n &lt; 128; n++)
<br/>
    {
<br/>
        pSpriteVar[n].attribute0 = 160;
<br/>
        pSpriteVar[n].attribute1 = 240;
<br/>
    }
<br/>
    
<br/>
    UpdateTank();
<br/>
<br/>
}
<br/>
<br/>
int Tank::UpdateTank()
<br/>
{
<br/>
    
<br/>
    pSpriteVar[usingSprite].attribute0 = COLOR_256 | MODE_TRANSPARENT | yOnScreen;
<br/>
    pSpriteVar[usingSprite].attribute1 = SIZE_64 | xOnScreen;
<br/>
    pSpriteVar[usingSprite].attribute2 = varOnScreen;
<br/>
    
<br/>
    UpdateSpriteMemory();
<br/>
    return 1;
<br/>
}
<br/>
<br/>
int Tank::UpdateSpriteMemory()
<br/>
{
<br/>
    int n;
<br/>
    unsigned short* temp;
<br/>
   temp = (unsigned short*)pSpriteVar;
<br/>
<br/>
   for(n = 0; n &lt; 128*4; n++)
<br/>
        SpriteMem[n] = temp[n];
<br/>
<br/>
   return 1;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
And here is when I create the object
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    Tanken = new Tank(80, 40, 0, tank3Data, tank3Palette, 0);
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>Eating meat is not a choise, it's a instinct</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20161 - poslundc - Mon May 03, 2004 1:47 pm</h4>
    <div class="postbody"><span class="postbody">You realize that when you initialize a sprite's tile data you are copying it to the same location in VRAM every time? Thereby overwriting any old sprites each time you load a new one?
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#20162 - Cearn - Mon May 03, 2004 1:54 pm</h4>
    <div class="postbody"><span class="postbody">In Tank::Tank
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    //copy the sprite image into memory 
<br/>
    for(int n = 0; n &lt; (256*8); n++) 
<br/>
        SpriteData[n] = Data[(256*8) + n]; 
<br/>
</td> </tr></table><span class="postbody">
<br/>
I'm assuming that this is supposed to copy the tile-data of the Tank's sprite into VRAM, right? (and it does this with every tank you make, seems a bit wasteful, but that's just me). But if you use this exact code for every class you have, you'll override the tiles in VRAM with every created sprite, since the destination always starts at SpriteData. You can check in VBA's tile viewer if this is indeed the case.
<br/>
<br/>
Also, in Tank::UpdateTank, if you simply OR the xOnScreen and yOnScreen into OAM, you're gonna get into trouble if you don't clip the positions to 9 and 8 bits, respectively, somewhere else.
<br/>
<br/>
EDIT: dammit! too late again.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
