<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Large Arrays (32k) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Large Arrays (32k)</h2>
<div id="posts">
<div class="post">
    <h4>#25880 - pyros - Mon Aug 30, 2004 7:23 pm</h4>
    <div class="postbody"><span class="postbody">Today, I tried to make a big (32k) array like so:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   u8 myarray[32768];</td> </tr></table><span class="postbody">
<br/>
However, when I wrote to the array things went bad. I don't think gcc was actually giving it enough memory.
<br/>
<br/>
<br/>
When I defined the contents (i.e.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   u8 myarray[32768] = {0,0,0,0.............};</td> </tr></table><span class="postbody">
<br/>
<br/>
it didn't cause the problem.
<br/>
<br/>
<br/>
To work around this apparent compiler error I did this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   u8* myarray;
<br/>
   myarray = (u8*) malloc(32768);</td> </tr></table><span class="postbody">
<br/>
and then accessed the array as before (e.g.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   myarray[n] = x;</td> </tr></table><span class="postbody">
<br/>
<br/>
I am guessing that the problem was caused by gcc trying to put the array in IWRAM which is only 32k, thus overwriting everything in IWRAM including the program itself.
<br/>
<br/>
<br/>
Does anyone know anything else about this? And am I doing anything bad?
<br/>
<br/>
<br/>
I also thought a 'tips' forum might be nice as the coding forums are all labelled 'questions'. It would be an easy way to share short simple things, although i suspect there would be plenty of criticism for 'poor coding practice' and the like.
<br/>
<br/>
Paul.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25881 - poslundc - Mon Aug 30, 2004 7:35 pm</h4>
    <div class="postbody"><span class="postbody">Global variables are placed into IWRAM, which yes, means an array of that size would deplete all of your IWRAM and leave your program non-functional.
<br/>
<br/>
In most devkit configurations, malloc assigns memory out of EWRAM, which you have 256K of, which is why it would work in that implementation. If you don't like using dynamic memory allocation, an alternative is to just grab a u8 pointer to 0x02000000 and use it as your array. (Assuming you aren't already using EWRAM for anything; ie. your game isn't multiboot.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25891 - sajiimori - Mon Aug 30, 2004 10:05 pm</h4>
    <div class="postbody"><span class="postbody">Regarding the "tips" idea, each of the forums is sort of a database of tips in itself, because there are so many answers in each.  In other words, most of the threads start as questions, and turn into answers after a short time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25893 - dagamer34 - Tue Aug 31, 2004 12:15 am</h4>
    <div class="postbody"><span class="postbody">Maybe someone who is board could make like a "tips" compilation of previous posts that commonly keep recurring on the board. Like how many times does someone ask how to use the BIOS Vblank swi?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25894 - sajiimori - Tue Aug 31, 2004 12:25 am</h4>
    <div class="postbody"><span class="postbody">That's what the FAQ is for, but using interrupts is complicated enough that directing people to the tutorials is probably better.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25895 - dagamer34 - Tue Aug 31, 2004 12:31 am</h4>
    <div class="postbody"><span class="postbody">What ever happened to putting that FAQ on the main page somewhere, like making it a link on the side like the others? That would definitely be more effective to me that telling someone to go look at the FAQ.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25896 - tepples - Tue Aug 31, 2004 3:14 am</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Q: How do I put large (&gt; 16 KB) arrays into a program without it crashing?</span>
<br/>
<br/>
Answer now in FAQ.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
