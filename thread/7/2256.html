<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>multiboot help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > multiboot help</h2>
<div id="posts">
<div class="post">
    <h4>#11826 - Mega386 - Mon Oct 20, 2003 11:08 pm</h4>
    <div class="postbody"><span class="postbody">im making a multiboot utility but dont know how to tell where the beginning of other gba roms are located in the cart. help!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11828 - niltsair - Mon Oct 20, 2003 11:22 pm</h4>
    <div class="postbody"><span class="postbody">2 Ways :
<br/>
<br/>
1. At a fixed position, at the end of your rom, append pointers to the roms and each  rom data. Exemple :
<br/>
-Say your MB program is 50,000 Bytes long 
<br/>
-Store pointer to Roms at address 50,000 -  51,024 (256pointers,  4Bytes per pointer)
<br/>
-Append each rom, one by one. When appending 1 rom, update it's pointer value (current size of file + 0x8000000)
<br/>
-In your program, create a pointer to 0x8000000 + 50,000.
<br/>
-To access 3rd rom, byte 0 :  pointer[2][0].
<br/>
<br/>
2. At the begining of every Roms, include a sequence of bytes that will always be the same. You then look for them.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11832 - tepples - Tue Oct 21, 2003 3:23 am</h4>
    <div class="postbody"><span class="postbody">The term "multiboot" is applied both to running RAM-based (.mb) programs over a serial cable (technical term) and to running multiple ROM-based (.gba) programs on a cart with bankswitching (colloquial term).
<br/>
<br/>
You use niltsair's method 1 if you're trying to put .mb programs on a cart. My <a class="postlink" href="http://www.pineight.com/gba/#gbfs" target="_blank">GBFS tools</a> automate a lot of the pointer handling. <a class="postlink" href="http://www.pineight.com/gba/#gbfs" target="_blank">GBFS tools</a>.
<br/>
<br/>
You can use either method if you're trying to put multiple .gba programs on a cart. PogoShell uses method 1, but the Visoly "BSOD shell" uses method 2: Scan at 32 KB increments, looking for headers with a valid complement check and no bit 7 set in the name. However, the F2A does require that .gba programs be placed at even multiples of 32 KB, which speeds your search.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11880 - Mega386 - Wed Oct 22, 2003 11:58 pm</h4>
    <div class="postbody"><span class="postbody">i like the sound of method 2, how would i go about doing that?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11882 - tepples - Thu Oct 23, 2003 1:02 am</h4>
    <div class="postbody"><span class="postbody">1. Read your flash cart's technical reference to determine how it bankswitches. The flash cart manufacturers don't publish much, but you can learn a lot by reading the visoly.s source code that comes with PogoShell.
<br/>
2. Read gbatek to learn what the GBA recognizes as a valid header.
<br/>
3. Loop through the whole cart, looking for valid headers. Store their addresses.
<br/>
4. Draw the names of the valid headers to the screen.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
