<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Map coding problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Map coding problem</h2>
<div id="posts">
<div class="post">
    <h4>#35127 - interdpth - Sun Jan 30, 2005 11:52 pm</h4>
    <div class="postbody"><span class="postbody">I made a little map in PE map editor that comes with VHAM note i'm just using the map editor. Any way I exported my map to an array then included it with my source when I attempt to draw it on screen I get only one tile. That's in the upperleft corner. Yes I did Put the BG# it's on up and the graphics and it's pal is in VRAM. The array for the map is 
<br/>
<br/>
const u8 Map1_MapData[22 * 22]; Now here is the code I came up with 
<br/>
void DrawMap(void)
<br/>
{
<br/>
int i; 
<br/>
u16* BG2 = (u16*)0x6001000;	
<br/>
    for( i = 0; i &lt; 22; i++) 
<br/>
      {  
<br/>
             BG2[Map1_MapData[ i * i ]];
<br/>
      }
<br/>
<br/>
}
<br/>
<br/>
///
<br/>
So can someone help? Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35151 - Cearn - Mon Jan 31, 2005 9:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>interdpth wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
... const u8 Map1_MapData[22 * 22]; Now here is the code I came up with 
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void DrawMap(void)
<br/>
{
<br/>
int i; 
<br/>
u16* BG2 = (u16*)0x6001000;   
<br/>
    for( i = 0; i &lt; 22; i++) 
<br/>
      {  
<br/>
             BG2[Map1_MapData[ i * i ]];
<br/>
      }
<br/>
}</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
? Forgive me for asking, but what is this supposed to do? Inside the loop you're just asking for a variable in VRAM, but you're never actually filling it with anything. The tile in the top-left corner are probably the sprites all huddled up. Remember, the default position of sprites is top-left, using the first tile in OBJ-VRAM for its data. 
<br/>
This might give better results:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for ix, iy;
<br/>
u16 *dst= (u16*)0x06001000;
<br/>
for(iy=0; iy&lt;22; iy++)
<br/>
    for(ix=0; ix&lt;22; ix++)
<br/>
        dst[iy*32+ix]= Map1_MapData[iy*22+ix];
<br/>
</td> </tr></table><span class="postbody">
<br/>
The double loop is required because 22x22 isn't a proper mapsize for the GBA. There's a possible mismatch between your map data (8bit) and the screenblock (16bit). If your map really has 1 byte / screen-entry then everthing's fine, but it could be that the data itself is 16bits, but just exported as bytes. Something worth looking in to. Do <span style="font-weight: bold">not</span> change the destination pointer to u8 because VRAM can't be written to in bytes. If anything, cast the map data.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35180 - interdpth - Tue Feb 01, 2005 12:21 am</h4>
    <div class="postbody"><span class="postbody">The loop was inefficent so I just DMA copied the data over And found out I need a better map editor.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35208 - Kyoufu Kawa - Tue Feb 01, 2005 2:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>interdpth wrote:</b></span></td> </tr> <tr> <td class="quote">The loop was inefficent so I just DMA copied the data over And found out I need a better map editor.</td> </tr></table><span class="postbody">That's funny Matt. Didn't you tell me you were gonna write your own?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35262 - interdpth - Wed Feb 02, 2005 7:43 am</h4>
    <div class="postbody"><span class="postbody">Yeah well we both know I suck at graphics. So anyone know any good Map editors I can use these tiles are all over.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
