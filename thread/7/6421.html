<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>CopyScreen Function - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > CopyScreen Function</h2>
<div id="posts">
<div class="post">
    <h4>#49252 - QuantumDoja - Wed Jul 27, 2005 9:28 pm</h4>
    <div class="postbody"><span class="postbody">Hi, I have the following code, to take a palette and data, and then in mode4 plot the screen, I can get it to work by not using a function, but its these damn pointers Im stuggling with....heres where im up to:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void CopyScreen(u16 *data, u16 *palette) {
<br/>
   u16 x,y;
<br/>
   for(x = 0; x &lt; 256; x++) {
<br/>
      BGPaletteMem[x] = palette[x];
<br/>
   }
<br/>
   for(y = 0; y &lt; 160; y++) {
<br/>
      for(x = 0; x &lt; 120; x++) {
<br/>
         PlotPixel(x,y,data[y*120+x]);
<br/>
      }
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Calling the function:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
CopyScreen(&amp;logoPalette,&amp;logoData);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I keep getting the errors: 
<br/>
warning: Passing arg1 of "copyscreen" from incompatible pointer type
<br/>
warning: Passing arg2 of "copyscreen" from incompatible pointer type<br/>_________________<br/>Chris Davis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49255 - tepples - Wed Jul 27, 2005 9:40 pm</h4>
    <div class="postbody"><span class="postbody">How are logoPalette and logoData declared?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49256 - QuantumDoja - Wed Jul 27, 2005 9:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
u16 logoData[] = {
<br/>
                    0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
<br/>
                    0xFFFF, 0xFFFF, 0...........
<br/>
<br/>
<br/>
u16 logoPalette[] = {
<br/>
                    0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0021, 0x0022, 0x0022, 0x0022, 0x0022,
<br/>
                    0x0023, 0x0042, 0x0043, 0x00....
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
before I had it like this....but still didnt work
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const u16 logoData[] = {
<br/>
                    0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
<br/>
                    0xFFFF, 0xFFFF, 0...........
<br/>
<br/>
<br/>
const u16 logoPalette[] = {
<br/>
                    0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0021, 0x0022, 0x0022, 0x0022, 0x0022,
<br/>
                    0x0023, 0x0042, 0x0043, 0x00....
<br/>
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>Chris Davis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49260 - ScottLininger - Wed Jul 27, 2005 10:03 pm</h4>
    <div class="postbody"><span class="postbody">I believe that you want to change this...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">CopyScreen(&amp;logoPalette,&amp;logoData);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Into this...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">CopyScreen(logoPalette,logoData);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Array names are essentially pointers already. If I'm remembering correctly, you don't need the ampersand to pass it by reference.
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49261 - QuantumDoja - Wed Jul 27, 2005 10:04 pm</h4>
    <div class="postbody"><span class="postbody">Even tho i get the errors, a rom file is made, and the rom works...how strange.<br/>_________________<br/>Chris Davis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49301 - Cearn - Thu Jul 28, 2005 9:35 am</h4>
    <div class="postbody"><span class="postbody">If you take the address of an array with &amp; you'll still get the, well, address of the array, which is why the code still works even though the compiler doesn't like it. This is <span style="font-style: italic">not</span> true for pointers though. Arrays-variables mark a given point in memory; pointer-variables are normal variables which have an address for their values.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const u8 array[16]= { ... } 
<br/>
// array occupies, say 0800:0000 - 0800:000F
<br/>
// 'array' gives 0800:0000
<br/>
// '&amp;array' gives location of array, also 0800:0000
<br/>
<br/>
const u8 *ptr= array;
<br/>
// ptr located at, say, 0300:0000 (IWRAM, where variables go)
<br/>
// 'ptr' gives ptr's value, which is the address of array
<br/>
// '&amp;ptr' gives the address of ptr, which is 0300:0000
<br/>
</td> </tr></table><span class="postbody">
<br/>
Just FYI, you can speed up the routine by between 8 and 30 times (depending on the implementation of PlotPixel) by using DMA. At the very least *sigh*, &lt;broken record advice&gt;<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=5751" target="_blank">use ints as counters instead of u16</a>&lt;/broken record advise&gt;</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
