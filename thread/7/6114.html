<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Is it possible to embed a c source code in c++ - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>C/C++ > Is it possible to embed a c source code in c++</h2>
<div id="posts">
<div class="post">
    <h4>#46197 - bmnb1234 - Tue Jun 21, 2005 5:34 pm</h4>
    <div class="postbody"><span class="postbody">Hi I got a question I am writing a game in c++, I presently found a sound source code but it is in c.  Is it possible to embed a c source code in c++ or do I have to rewrite it in c++? 
<br/>
<br/>
Thank you for your time!
<br/>
Jason</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46200 - poslundc - Tue Jun 21, 2005 5:40 pm</h4>
    <div class="postbody"><span class="postbody">Since C++ is a superset of C, all C code runs in C++.
<br/>
<br/>
In practice, a small percentage of the code may require some tweaking. Feel free to post if you have any difficulties getting the code to work.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46201 - DekuTree64 - Tue Jun 21, 2005 5:44 pm</h4>
    <div class="postbody"><span class="postbody">You'll need to wrap any global functin prototypes in the .h like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#ifdef __cplusplus
<br/>
extern "C" {
<br/>
#endif
<br/>
<br/>
extern void DoStuff();
<br/>
extern void DoOtherStuff();
<br/>
<br/>
#ifdef __cplusplus
<br/>
}
<br/>
#endif</td> </tr></table><span class="postbody">
<br/>
<br/>
That's because the .c file will compile with the global symbols exactly as they appear. C++ uses name mangling to support argument overloading, so it will try to mangle the names according to the arguments when calling functions too. 
<br/>
extern "C" tells it to call those functions with their names as they are.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46215 - sajiimori - Tue Jun 21, 2005 7:24 pm</h4>
    <div class="postbody"><span class="postbody">Usually you don't have to declare things extern "C" unless the code was already compiled without name mangling.  If you've got the source, then you can compile it as C++ and then the names will be mangled along with everything else.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
