<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Saving Highscores!!!!???? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Saving Highscores!!!!????</h2>
<div id="posts">
<div class="post">
    <h4>#71427 - lewisrevill - Sun Feb 12, 2006 8:51 pm</h4>
    <div class="postbody"><span class="postbody">Hey people
<br/>
<br/>
Hope your all well.  Anyway I was wondering if anyone one has any advice on how to save highscores onto the cartidge?  Code would be a god send!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71431 - tepples - Sun Feb 12, 2006 9:45 pm</h4>
    <div class="postbody"><span class="postbody">Search <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=418" target="_blank">the GBA beginners' FAQ</a> for "saving".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71447 - lewisrevill - Sun Feb 12, 2006 11:38 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, I have looked at the FAQ and its about as clear as mud to me!  Can anyone explain it differently to me and maybe supply some code thats better to understand?  Thank you</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71449 - keldon - Sun Feb 12, 2006 11:46 pm</h4>
    <div class="postbody"><span class="postbody">What don't you understand?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71455 - lewisrevill - Mon Feb 13, 2006 12:14 am</h4>
    <div class="postbody"><span class="postbody">Most of it.  Im quite new to this part of the programming.  I know there is a set pointer for SRAM which I know.  But then I dont know how to write it or Read it?  Any help?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71463 - keldon - Mon Feb 13, 2006 12:45 am</h4>
    <div class="postbody"><span class="postbody">The general idea of it is that you are (a) writing to an area of memory to save, and (b) reading from an area of memory to read.
<br/>
<br/>
<span style="font-weight: bold">The Plan</span>
<br/>
I am going to assume you have a text system set up; and I want you to implement a basic saving / loading system function. The basic idea is that when the player presses "A" then the text "Bulldog" is stored; and whatever pressing "B" will display 8 whatever 8 characters at the memory in the save area.
<br/>
<br/>
<span style="font-weight: bold">Activity</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// address of SRAM
<br/>
#define SRAM ((unsigned char *)0x0e000000) </td> </tr></table><span class="postbody">
<br/>
The FAQ gives you the address of SRAM. Your job is to read and write to it. When the player presses "A", then write bulldog using bytecopy.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// using bytecopy to write
<br/>
bytecpy(SRAM + 4, &amp;text, sizeof(text)); </td> </tr></table><span class="postbody">
<br/>
<br/>
When the player presses "B", then read bulldog using bytecopy. Write 0 to byte 9 of your char* so that the string is null terminated.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// using bytecopy to read 8 bytes
<br/>
bytecpy(&amp;text, SRAM + 4, 8);  </td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
<span style="font-weight: bold">Reflection on activity</span>
<br/>
There is not that much to this activity; as you are just reading/writing a single piece of text. However the main part is covered: reading and writing to and from SRAM.
<br/>
<br/>
You use the bytecpy method as they copies bytes each time, as you can only read/write one byte at a time with SRAM.
<br/>
<br/>
You read and write to and from (SRAM+4). This is because the first and last byte of SRAM usually becomes corrupt, so we try to avoid accessing it.
<br/>
<br/>
<span style="font-weight: bold">Facts etc.</span>
<br/>
SRAM only allows byte transfers from the CPU and does not allow DMA access.
<br/>
<br/>
Your one true guide to the gba inner workings is <a class="postlink" href="http://www.work.de/nocash/gbatek.htm" target="_blank">found here</a> and in the FAQ and forum
<br/>
<br/>
<span style="font-weight: bold">Going further</span>
<br/>
Now you can experiment further by storing more important data like a room structure in a bigger environment, such as a room with a person which moves around. Sometimes you have to work with your data when the data you wish to store contains addresses, etc. as these addresses will most likely not be valid when you load. But in general you have one large array to store your data in so just think about how that is going to be done.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71570 - lewisrevill - Mon Feb 13, 2006 2:38 pm</h4>
    <div class="postbody"><span class="postbody">Thank you Keldon
<br/>
<br/>
Thats clearer now.  And forgive my nieveness but the 'text' is a variable with the data in?  And how do you create the bytecpy() command.  Again i have read the FAQ and dont understand what are variables and what is the set code.  can you help me with this?  Thank you again it is appreciated!  You da man!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71581 - keldon - Mon Feb 13, 2006 3:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// taken from method in FAQ
<br/>
void bytecpy(void *restrict in_dst, const void *restrict in_src, unsigned int length)
<br/>
{
<br/>
  unsigned char *restrict src = (unsigned char *)in_src;
<br/>
  unsigned char *restrict dst = (unsigned char *)in_dst;
<br/>
<br/>
  for(; length &gt; 0; length--)
<br/>
    *dst++ = *src++;
<br/>
} </td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">And forgive my nieveness but the 'text' is a variable with the data in?</td> </tr></table><span class="postbody">
<br/>
Yes, just a text string.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">dont understand what are variables and what is the set code</td> </tr></table><span class="postbody">
<br/>
Just look at the prototype of the bytecpy method:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void bytecpy(void *dest, const void *source, unsigned int length)</td> </tr></table><span class="postbody">
<br/>
When setting/saving data the dest is SRAM; and when loading the source is SRAM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71617 - lewisrevill - Mon Feb 13, 2006 7:38 pm</h4>
    <div class="postbody"><span class="postbody">Im still struggling im afraid, How would the code actually be written?  Exactly how it is shown?  What needs to be changed?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71632 - tepples - Mon Feb 13, 2006 8:41 pm</h4>
    <div class="postbody"><span class="postbody">Do you know what memcpy() does? The bytecpy() function does the same thing but always accesses SRAM in a safe manner.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75929 - Dilyias - Fri Mar 17, 2006 1:25 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>lewisrevill wrote:</b></span></td> </tr> <tr> <td class="quote">Im still struggling im afraid, How would the code actually be written?  Exactly how it is shown?  What needs to be changed?</td> </tr></table><span class="postbody">
<br/>
<br/>
I've been programming GBA for about a week and I checked out the FAQ. It's crystal clear to me. It has all the code you need, all you have to do is fill in the values of the example structure, <span style="font-weight: bold"><span style="font-style: italic">data</span></span>, before you call the bytecpy command to store the data.
<br/>
<br/>
It is evidence that you do not have a good working knowledge of C and you probably have not gone through any of the GBA tutorials.
<br/>
<br/>
I strongly suggest tackling these two first before moving on. You need a good foundation or you will end up wasting a lot of time.
<br/>
<br/>
Once you have a handle on C, go over this tutorial several times. Make sure you understand all of it (except maybe the Advanced section). Once you master this, stuff like saving will be a breeze. :-)
<br/>
<br/>
<a href="http://user.chem.tue.nl/jakvijn/tonc/index.htm" target="_blank">http://user.chem.tue.nl/jakvijn/tonc/index.htm</a>
<br/>
<br/>
Bookmark it! :-)
<br/>
<br/>
Eric</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
