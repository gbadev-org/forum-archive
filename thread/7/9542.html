<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>gravity/jumping physics -need heelp - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > gravity/jumping physics -need heelp</h2>
<div id="posts">
<div class="post">
    <h4>#82889 - Dan2552 - Thu May 11, 2006 1:20 am</h4>
    <div class="postbody"><span class="postbody">edit-
<br/>
see post below</span><span class="gensmall"><br/><br/>Last edited by Dan2552 on Thu May 11, 2006 1:51 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#82893 - Darkflame - Thu May 11, 2006 1:30 am</h4>
    <div class="postbody"><span class="postbody">Well, your friend is obviously very wise to pick such an equation.
<br/>
Clearly an inteligent person there.
<br/>
<br/>
Now..lets look at your code.
<br/>
hmm..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82895 - Darkflame - Thu May 11, 2006 1:37 am</h4>
    <div class="postbody"><span class="postbody">Ok, my knowledge of this code type limits me, but
<br/>
<br/>
is frodo1_y an interger?
<br/>
<br/>
Because maybe its not reaching "100" exactly, and thus it goes though the floor.
<br/>
<br/>
So maybe, rather then detecting Y=100 as the floor, you should detect 
<br/>
(y&lt;100 and y&gt;95 )
<br/>
<br/>
(or make frodo an interger)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82899 - Dan2552 - Thu May 11, 2006 1:51 am</h4>
    <div class="postbody"><span class="postbody">update, sorry - lots of problems which i probably could've solved with a bit  more thought
<br/>
<br/>
[ignore graphical scripts]
<br/>
[ignore 2nd character]
<br/>
[ignore bad scripts (unless they're to do with jumping/gravity)]
<br/>
<br/>
<a href="http://www.hingedshinobi.co.uk/axek/Divergence.rar" target="_blank">http://www.hingedshinobi.co.uk/axek/Divergence.rar</a>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
/*********************************************************************************
<br/>
 * Includes
<br/>
 ********************************************************************************/
<br/>
// Basically, first, as on top of all HAM files, the most
<br/>
// important include is the mygba.h, which contains all the
<br/>
// macro definitions, and the HAMlib function prototypes.
<br/>
#include &lt;mygba.h&gt;
<br/>
<br/>
#include "gfx/bg.pal.c"
<br/>
#include "gfx/bg.raw.c"
<br/>
#include "gfx/frodo.pal.c"
<br/>
<br/>
#include "gfx/LEFTfrodo.raw.c"
<br/>
#include "gfx/RIGHTfrodo.raw.c"
<br/>
#include "gfx/RIGHT1frodo.raw.c"
<br/>
#include "gfx/RIGHT2frodo.raw.c"
<br/>
#include "gfx/LEFT1frodo.raw.c"
<br/>
#include "gfx/LEFT2frodo.raw.c"
<br/>
<br/>
#include "gfx/LEFTfrodo2.raw.c"
<br/>
#include "gfx/RIGHTfrodo2.raw.c"
<br/>
#include "gfx/RIGHT1frodo2.raw.c"
<br/>
#include "gfx/RIGHT2frodo2.raw.c"
<br/>
#include "gfx/LEFT1frodo2.raw.c"
<br/>
#include "gfx/LEFT2frodo2.raw.c"
<br/>
<br/>
<br/>
<br/>
<br/>
MULTIBOOT
<br/>
<br/>
<br/>
<br/>
/*********************************************************************************
<br/>
 * Globals
<br/>
 ********************************************************************************/
<br/>
u8 g_NewFrame=TRUE;
<br/>
u32 frames     =   0;
<br/>
u32 frames2     =   0;
<br/>
u8 frodo1;
<br/>
u8 frodo1_x = 25;
<br/>
u8 frodo1_y = 30;
<br/>
u8 frodo1speed = 1;
<br/>
u8 frodo2;
<br/>
u8 frodo2_x = 198;
<br/>
u8 frodo2_y = 30;
<br/>
u8 frodo2speed = 1;
<br/>
u8 dir_frodo1 = 0;
<br/>
u8 leftright1 = 1;
<br/>
u8 frameslr = 0;
<br/>
u8 dir_frodo2 = 0;
<br/>
u8 leftright2 = 1;
<br/>
u8 frameslr2 = 0;
<br/>
u8 speedfall = 3;
<br/>
u8 speedfall2 = 2;
<br/>
u8 lockup = 0;
<br/>
u8 lockup2 = 0;
<br/>
<br/>
u8 jumping = 0;
<br/>
<br/>
<br/>
<br/>
/*
<br/>
s = distance  (from ground, for instance)
<br/>
u = starting speed
<br/>
t = time
<br/>
a = acceleration   (  -9.81 for gravity )
<br/>
*/
<br/>
u8 s =0;
<br/>
u8 u =9;
<br/>
u8 t =1;
<br/>
u8 a = 9.81;
<br/>
<br/>
<br/>
/*********************************************************************************
<br/>
 * Prototypes
<br/>
 ********************************************************************************/
<br/>
void vblFunc(void);
<br/>
<br/>
<br/>
/*********************************************************************************
<br/>
 * Program entry point
<br/>
 ********************************************************************************/
<br/>
int main(void)
<br/>
{
<br/>
    ham_Init();
<br/>
<br/>
    // Will, once activated, trigger the specified interrupt,
<br/>
    // and then call the function specified
<br/>
    ham_StartIntHandler(INT_TYPE_VBL,         // The Interrupts ID you want to start.
<br/>
                        (void *)&amp;vblFunc);    // The adress of a function that should be called when the interrupt is fired
<br/>
   ham_SetBgMode(4);
<br/>
   ham_LoadBGPal((void*)bg_Palette,256);
<br/>
    ham_LoadBitmap((void*)bg_Bitmap);
<br/>
   ham_FlipBGBuffer();
<br/>
   
<br/>
    ham_LoadObjPal((void*)frodo_Palette, 256);
<br/>
    frodo1 = ham_CreateObj((void*)RIGHTfrodo_Bitmap,OBJ_SIZE_32X32,
<br/>
                             OBJ_MODE_NORMAL,1,0,0,0,0,0,0,frodo1_x,frodo1_y);
<br/>
  //  ham_LoadObjPal((void*)frodo3_Palette, 256);
<br/>
    frodo2 = ham_CreateObj((void*)LEFTfrodo2_Bitmap,OBJ_SIZE_32X32,
<br/>
                             OBJ_MODE_NORMAL,1,0,0,0,0,0,0,frodo2_x,frodo2_y);
<br/>
   
<br/>
    // Loop
<br/>
    while(TRUE)
<br/>
    {
<br/>
        // It's a new frame?
<br/>
        if(g_NewFrame)
<br/>
        {
<br/>
<br/>
if (frodo1_y == 100) {
<br/>
    u= 0;
<br/>
    t=0;
<br/>
}
<br/>
if (frodo1_x &lt; 23) {
<br/>
  u=0;
<br/>
  t=1;
<br/>
}
<br/>
<br/>
<br/>
query_buttons();
<br/>
update_plane_posfrodo1();
<br/>
query_buttons2();
<br/>
update_plane_posfrodo2();
<br/>
<br/>
            // Frames isn't new anymore
<br/>
            g_NewFrame=FALSE;
<br/>
        }
<br/>
    }
<br/>
<br/>
    return 0;
<br/>
}
<br/>
<br/>
/*********************************************************************************
<br/>
 * vblFunc(void)
<br/>
 *
<br/>
 * This function is called whenever the GBA is about
<br/>
 * to draw a new picture onto the screen.
<br/>
 ********************************************************************************/
<br/>
void vblFunc(void)
<br/>
{
<br/>
    // Call this (preferably during a VBL interrupt) to commit your
<br/>
    // ham_obj information to the hardware. Only after you did this your
<br/>
    // sprite changes will appear on screen.
<br/>
    ham_CopyObjToOAM();
<br/>
++frames;
<br/>
++ frameslr;
<br/>
++frames2;
<br/>
++ frameslr2;
<br/>
    // It's a new frame yet
<br/>
    g_NewFrame=TRUE;
<br/>
}
<br/>
<br/>
<br/>
void query_buttons()
<br/>
{
<br/>
if(F_CTRLINPUT_UP_PRESSED)   {
<br/>
<br/>
if (frodo1_y == 100) {
<br/>
 u = 10;
<br/>
 t=1;
<br/>
 frodo1_y = frodo1_y -1;
<br/>
}
<br/>
return;
<br/>
}
<br/>
    
<br/>
    // LEFT
<br/>
if(F_CTRLINPUT_LEFT_PRESSED)    {
<br/>
 if (frodo1_x &gt; 1) frodo1_x = frodo1_x - frodo1speed;
<br/>
 dir_frodo1 = 1;
<br/>
 if (frameslr &gt; 20) {
<br/>
 frameslr = 0;
<br/>
 if (leftright1 == 1) {
<br/>
 ham_UpdateObjGfx(frodo1,(void*)&amp;LEFT2frodo_Bitmap);
<br/>
 leftright1 = 2;
<br/>
 goto skip2thing;
<br/>
 }
<br/>
 if (leftright1 == 2) {
<br/>
 leftright1 = 1;
<br/>
 ham_UpdateObjGfx(frodo1,(void*)&amp;LEFT1frodo_Bitmap);
<br/>
 goto skip2thing;
<br/>
 }
<br/>
 skip2thing:
<br/>
 }
<br/>
 return;
<br/>
}
<br/>
        // RIGHT 
<br/>
if(F_CTRLINPUT_RIGHT_PRESSED)   {
<br/>
 if (frodo1_x &lt; 237) frodo1_x = frodo1_x + frodo1speed;
<br/>
 dir_frodo1 = 2;
<br/>
 if (frameslr &gt; 20) {
<br/>
 frameslr = 0;
<br/>
 if (leftright1 == 1) {
<br/>
 ham_UpdateObjGfx(frodo1,(void*)&amp;RIGHT2frodo_Bitmap);
<br/>
 leftright1 = 2;
<br/>
 goto skip1thing;
<br/>
 }
<br/>
 if (leftright1 == 2) {
<br/>
 leftright1 = 1;
<br/>
 ham_UpdateObjGfx(frodo1,(void*)&amp;RIGHT1frodo_Bitmap);
<br/>
 goto skip1thing;
<br/>
 }
<br/>
 skip1thing:
<br/>
 }
<br/>
 return;
<br/>
}
<br/>
    
<br/>
<br/>
if(F_CTRLINPUT_DOWN_PRESSED)   {
<br/>
<br/>
}
<br/>
<br/>
} //end of query_buttons
<br/>
<br/>
<br/>
<br/>
void update_plane_posfrodo1() {
<br/>
    
<br/>
if (frodo1_y != 100) {
<br/>
frodo1_y = frodo1_y +  0.01 *  (   (u*t)+((1/2)*a*t*t)  );
<br/>
t=t+1;
<br/>
}
<br/>
if (frodo1_x&lt;23) {
<br/>
frodo1_y = frodo1_y +  0.01 *  (   (u*t)+((1/2)*a*t*t)  );
<br/>
t=t+1;
<br/>
}
<br/>
    ham_SetObjX(frodo1,frodo1_x);
<br/>
    ham_SetObjY(frodo1,frodo1_y);
<br/>
<br/>
    if (frames &gt; 40) {
<br/>
        // Reset the frame counter
<br/>
        frames = 0;
<br/>
        // Update it
<br/>
    if (dir_frodo1 == 1) {
<br/>
ham_UpdateObjGfx(frodo1,(void*)&amp;LEFTfrodo_Bitmap);
<br/>
}
<br/>
    if (dir_frodo1 == 2) {
<br/>
ham_UpdateObjGfx(frodo1,(void*)&amp;RIGHTfrodo_Bitmap);
<br/>
}
<br/>
}
<br/>
    return;
<br/>
} //end of update_plane_posfrodo1
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
void query_buttons2()
<br/>
{
<br/>
<br/>
if(F_CTRLINPUT_START_PRESSED)   {
<br/>
<br/>
return;
<br/>
}
<br/>
    
<br/>
    //left
<br/>
    if(F_CTRLINPUT_B_PRESSED)    {
<br/>
        if (frodo2_x &gt; 1) frodo2_x = frodo2_x - frodo2speed;
<br/>
        dir_frodo2 = 1;
<br/>
        if (frameslr2 &gt; 20) {
<br/>
    frameslr2 = 0;
<br/>
if (leftright2 == 1) {
<br/>
     ham_UpdateObjGfx(frodo2,(void*)&amp;LEFT2frodo2_Bitmap);
<br/>
     leftright2 = 2;
<br/>
    goto skip3thing;
<br/>
}
<br/>
if (leftright2 == 2) {
<br/>
     leftright2 = 1;
<br/>
     ham_UpdateObjGfx(frodo2,(void*)&amp;LEFT1frodo2_Bitmap);
<br/>
goto skip3thing;
<br/>
 }
<br/>
 skip3thing:
<br/>
 }
<br/>
        return;
<br/>
    }
<br/>
        // right
<br/>
    if(F_CTRLINPUT_A_PRESSED)   { //A
<br/>
        if (frodo2_x &lt; 237) frodo2_x = frodo2_x + frodo2speed;
<br/>
dir_frodo2 = 2;
<br/>
        if (frameslr2 &gt; 20) {
<br/>
    frameslr2 = 0;
<br/>
if (leftright2 == 1) {
<br/>
     ham_UpdateObjGfx(frodo2,(void*)&amp;RIGHT2frodo2_Bitmap);
<br/>
     leftright2 = 2;
<br/>
    goto skip4thing;
<br/>
}
<br/>
if (leftright2 == 2) {
<br/>
     leftright2 = 1;
<br/>
     ham_UpdateObjGfx(frodo2,(void*)&amp;RIGHT1frodo2_Bitmap);
<br/>
goto skip4thing;
<br/>
 }
<br/>
 skip4thing:
<br/>
 }
<br/>
        return;
<br/>
    }
<br/>
} //end of query_buttons
<br/>
<br/>
void update_plane_posfrodo2() {
<br/>
    ham_SetObjX(frodo2,frodo2_x);
<br/>
    ham_SetObjY(frodo2,frodo2_y);
<br/>
<br/>
    if (frames2 &gt; 40) {
<br/>
        // Reset the frame counter
<br/>
        frames2 = 0;
<br/>
        // Update it
<br/>
    if (dir_frodo2 == 1) {
<br/>
ham_UpdateObjGfx(frodo2,(void*)&amp;LEFTfrodo2_Bitmap);
<br/>
}
<br/>
    if (dir_frodo2 == 2) {
<br/>
ham_UpdateObjGfx(frodo2,(void*)&amp;RIGHTfrodo2_Bitmap);
<br/>
}
<br/>
}
<br/>
    return;
<br/>
} //end of update_plane_posfrodo1
<br/>
/* END OF FILE */
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82900 - Darkflame - Thu May 11, 2006 2:00 am</h4>
    <div class="postbody"><span class="postbody">It should be fairly easy to get this working...if someone knew more knowledge then me about this :p</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82903 - tepples - Thu May 11, 2006 2:33 am</h4>
    <div class="postbody"><span class="postbody">The way most 2D games seem to do platform physics is to use Euler integration. Do the following in each frame for each sprite: <ol type="1"><li>Add a constant to Y velocity. (Adjust this constant to reflect gravity and the scale of your game world.) </li><li>Add X velocity to X displacement and add Y velocity to Y displacement. </li><li>Perform collision tests and push the character away from walls, floors, and ceilings as appropriate. </li><li>Draw the sprite at position (X displacement - X camera origin, Y displacement - Y camera origin). </li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82905 - Darkflame - Thu May 11, 2006 2:39 am</h4>
    <div class="postbody"><span class="postbody">Euler is sooo outdated :-/
<br/>
<br/>
S=ut is easy and more accurate.
<br/>
I could make this work easily in a code type I know...but I dont know c++ or gba dev</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82906 - tepples - Thu May 11, 2006 2:43 am</h4>
    <div class="postbody"><span class="postbody">What is S=ut? Google doesn't help. And can it deal with things such as wind resistance (important if you're trying to do something like that level of <span style="font-style: italic">Super Mario Bros. 2 (J)</span> with the wind-assisted jumps)?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82908 - Dan2552 - Thu May 11, 2006 2:52 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">What is S=ut? </td> </tr></table><span class="postbody">
<br/>
<br/>
*points at big mass of crap code above*
<br/>
<br/>
<br/>
frodo1_y = frodo1_y +  0.01 *  (   (u*t)+((1/2)*a*t*t)  ); 
<br/>
<br/>
<br/>
I think darkflame called it S=ut himself :p
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
s = ut + (1/2)at?   ( That is,  s=(u*t)+((1/2)*a*t*t)  )
<br/>
<br/>
s = distance  (from ground, for instance)
<br/>
u = starting speed 
<br/>
t = time
<br/>
a = acceleration   (  -9.81 for gravity )
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I think the advantage in this method is the acceleration?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82909 - Darkflame - Thu May 11, 2006 3:08 am</h4>
    <div class="postbody"><span class="postbody">Yes,acceleration, and you avoid an if statement.
<br/>
<br/>
(and it also lets things fall down, and bounce easily later)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">What is S=ut? Google doesn't help. And can it deal with things such as wind resistance (important if you're trying to do something like that level of <span style="font-style: italic">Super Mario Bros. 2 (J)</span> with the wind-assisted jumps)?</td> </tr></table><span class="postbody">
<br/>
<br/>
Sorry, my fault, here look at this;
<br/>
<a href="http://www.physchem.co.za/Graphs/Equations.htm" target="_blank">http://www.physchem.co.za/Graphs/Equations.htm</a>
<br/>
<br/>
I am a physics person, so I find this stuff pretty basic.
<br/>
Most new computer games use it, as does Newton :p
<br/>
<br/>
s = ut + (1/2)at? 
<br/>
<br/>
ut = how far it goes in a given time (speed x time)
<br/>
+(1/2)at^2 =  how the acceleration effect it over time.
<br/>
<br/>
a= - 9.81 for gravity, naturely.
<br/>
<br/>
<br/>
<br/>
---
<br/>
It isnt to do with Wind...allthough...wouldnt be too hard to add (another day :p)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82912 - poslundc - Thu May 11, 2006 3:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkflame wrote:</b></span></td> </tr> <tr> <td class="quote">Euler is sooo outdated :-/
<br/>
<br/>
S=ut is easy and more accurate.</td> </tr></table><span class="postbody">
<br/>
<br/>
If it's so easy then why can't you seem to get it working? ;-)
<br/>
<br/>
In all seriousness, the Euler method is better. It is very, very difficult to design a stateless system of composite forces that is at all scalable or generic. State-tracking is far more sensible, if your intent is to make a game, anyway.
<br/>
<br/>
Accuracy is not a problem in games, either. At least, if you use the value 9.81 m/s/s in 16.16 fixed-point format, then at 60 ticks per second your error will be 0.000122 m (or about 0.1 millimetres) per second.
<br/>
<br/>
If you're satisfied with the accuracy of 9.81 m/s/s as your gravitational constant but not satisfied with an error of 0.1 mm/s, then you probably shouldn't be designing games for computer systems.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82913 - Dan2552 - Thu May 11, 2006 3:43 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"> then you probably shouldn't be designing games for computer systems.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
DF isn't designing games, atleast for GBA.
<br/>
<br/>
I just asked how to do good gravity and jumping....</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82914 - Darkflame - Thu May 11, 2006 3:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkflame wrote:</b></span></td> </tr> <tr> <td class="quote">Euler is sooo outdated :-/
<br/>
<br/>
S=ut is easy and more accurate.</td> </tr></table><span class="postbody">
<br/>
<br/>
If it's so easy then why can't you seem to get it working? ;-)
<br/>
<br/>
In all seriousness, the Euler method is better. It is very, very difficult to design a stateless system of composite forces that is at all scalable or generic. State-tracking is far more sensible, if your intent is to make a game, anyway.
<br/>
<br/>
Accuracy is not a problem in games, either. At least, if you use the value 9.81 m/s/s in 16.16 fixed-point format, then at 60 ticks per second your error will be 0.000122 m (or about 0.1 millimetres) per second.
<br/>
<br/>
If you're satisfied with the accuracy of 9.81 m/s/s as your gravitational constant but not satisfied with an error of 0.1 mm/s, then you probably shouldn't be designing games for computer systems.
<br/>
<br/>
Dan.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I dont get you here :-/
<br/>
Sorry...by "Eular" I was thinking liner. (as in the guys jumps wouldnt curve..and bounces would be impossible to do without a lot of extra code)
<br/>
<br/>
I was using that equation because it was...well..the real equation for accelerateing objects. It wasnt an accuracy issue at all.
<br/>
Its just my instict says you shouldnt have a "if ball is at top then start going down" bit...it should be a smoother,curved motion.
<br/>
<br/>
<br/>
<br/>
I still dont get whats wrong with that equation.
<br/>
It worked fine in all the other code I used.
<br/>
<br/>
I did a game with a bounceing ball using that code and it worked perfectly.
<br/>
<br/>
(you simply u=-u when it hits the ground)
<br/>
<br/>
My only problem with helping dan is I have no knowledge of gbadev.
<br/>
I dont even know what varibles of his are interger.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82916 - Dan2552 - Thu May 11, 2006 3:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I dont even know what varibles of his are interger.</td> </tr></table><span class="postbody">
<br/>
<br/>
Don't worry, neither do I :D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82932 - poslundc - Thu May 11, 2006 5:55 am</h4>
    <div class="postbody"><span class="postbody">OK, I've taken another look at your code, and it's problematic to say the least. I strongly recommend you work through some basic C programming tutorials before diving headfirst into GBA programming. Some fundamental things to be aware of:
<br/>
<br/>
- Your use of "goto" breaks the structure of your program. Goto is almost obsolete with the advent of structured programming languages, and should only be used in exceptional circumstances.
<br/>
<br/>
- ((1/2)*a*t*t) will always evaluate to 0. (Excerise: figure out why.)
<br/>
<br/>
- You are #including non-header C files in your C program. That's bad form and error prone.
<br/>
<br/>
Those are just a few of the top-level issues you need to deal with. At the very least your program flow is difficult to follow and needs to be cleaned up. There are plenty of good tutorials and demos to help you with this.
<br/>
<br/>
EDIT:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkflame wrote:</b></span></td> </tr> <tr> <td class="quote">I dont get you here :-/
<br/>
Sorry...by "Eular" I was thinking liner. (as in the guys jumps wouldnt curve..and bounces would be impossible to do without a lot of extra code)
<br/>
<br/>
I was using that equation because it was...well..the real equation for accelerateing objects. It wasnt an accuracy issue at all.
<br/>
Its just my instict says you shouldnt have a "if ball is at top then start going down" bit...it should be a smoother,curved motion.</td> </tr></table><span class="postbody">
<br/>
<br/>
Instead of trying to determine where the object should be at any given time using a general equation to describe its behaviour (sometimes known as "tweening"), try storing the following three vectors:
<br/>
<br/>
- position
<br/>
- velocity
<br/>
- acceleration
<br/>
<br/>
Then every frame, update all three of them based on their relationship to each other.
<br/>
<br/>
That's Euler integration.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82941 - Ultima2876 - Thu May 11, 2006 9:41 am</h4>
    <div class="postbody"><span class="postbody">Why do you want s = ut anyway? Acceleration due to gravity isn't 9.81, it's 9.81 m/s/s. That means that it's NOT 9.81 pixels per frame, unless a frame indicates a second of time (which it doesn't, a frame is 1/59.97 of second) and a pixel represents a metre, which it probably doesn't.
<br/>
<br/>
Anyway, nitpicking aside, s = ut won't be very good on a pixel level anyway, because you don't need that level of accuracy.
<br/>
<br/>
Also, you're doing 1/2. That evaluates to 0 because it's not fixed point, so the result of your ((1/2) * a * t * t) will always be 0. Use something like ((128 * a * t * t) &gt;&gt; 8) instead - which cancels to ((a * t * t) &gt;&gt; 1).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82952 - tepples - Thu May 11, 2006 1:33 pm</h4>
    <div class="postbody"><span class="postbody">But some games have metres as a fundamental game unit. For instance, <span style="font-style: italic">Super Mario Bros.</span> and several other platformers seem to count one metre for each 16-pixel metatile.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82973 - Dan2552 - Thu May 11, 2006 4:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">- You are #including non-header C files in your C program. That's bad form and error prone. </td> </tr></table><span class="postbody">
<br/>
<br/>
it's exactly what the HAM tutorial told me to do. (except loads and loads of them :p)
<br/>
<br/>
_
<br/>
<br/>
everyone always says try tutorials first, people told me to do that on VB, and Delphi. I ignored - I taught myself pretty well, with the exception that my code will look messy to others (believe me, others looks messy to me). For VB my 1st main project was an IRC client - that worked out pretty well, and for delphi my main project is an IM client which takes advantage of IRC server but not in the same way (anyway that doesnt matter..)
<br/>
<br/>
well what i'm trying to say, <span style="font-weight: bold">I</span> seem to learn better by diving in then reading tutorials. I'm an odd one :)
<br/>
_
<br/>
<br/>
<br/>
<br/>
and on a side note: I don't care how BAD 'goto' is, it happens to be my favourate workaround for every single language I've done (VB, Delphi, C). I LIKE IT :D although I havn't used it much in delphi recently
<br/>
<br/>
<br/>
_
<br/>
<br/>
Can someone just suggest to me a very simple BUT WELL WORKING jump method, i like the smoothness from Kirby :) I want the jump working well with moving sideways</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82979 - Ultima2876 - Thu May 11, 2006 5:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ultima2876 wrote:</b></span></td> </tr> <tr> <td class="quote">probably</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">But some games have metres as a fundamental game unit. For instance, <span style="font-style: italic">Super Mario Bros.</span> and several other platformers seem to count one metre for each 16-pixel metatile.</td> </tr></table><span class="postbody">
<br/>
<br/>
;P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82980 - poslundc - Thu May 11, 2006 5:30 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dan2552 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">- You are #including non-header C files in your C program. That's bad form and error prone. </td> </tr></table><span class="postbody">
<br/>
<br/>
it's exactly what the HAM tutorial told me to do. (except loads and loads of them :p)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Unfortunately, the majority of GBA dev tutorials are erroneous to some degree.
<br/>
<br/>
<a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/toc.htm" target="_blank">TONC</a> is the most reliable of any of them.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">well what i'm trying to say, <span style="font-weight: bold">I</span> seem to learn better by diving in then reading tutorials. I'm an odd one :)</td> </tr></table><span class="postbody">
<br/>
<br/>
Lot's of people do. It's a good way to learn. Unfortunately, you are trying to learn how to run before learning how to crawl. Take a step back and review the basics.
<br/>
<br/>
You are unlikely to find anyone in this forum with the time or energy to hold your hand through getting a physics model working when you aren't up to the basics of, say, knowing which of your variables are integers.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">and on a side note: I don't care how BAD 'goto' is, it happens to be my favourate workaround for every single language I've done (VB, Delphi, C). I LIKE IT :D although I havn't used it much in delphi recently</td> </tr></table><span class="postbody">
<br/>
<br/>
Do you like not being able to debug your code? Do you like having slow code that the compiler is unable to optimize? Do you like making your code infinitely harder to read for the people you want help from?
<br/>
<br/>
If you refuse to learn how to use the basic tools the language is providing you with, you're only screwing yourself.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Can someone just suggest to me a very simple BUT WELL WORKING jump method, i like the smoothness from Kirby :) I want the jump working well with moving sideways</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>I wrote:</b></span></td> </tr> <tr> <td class="quote">Instead of trying to determine where the object should be at any given time using a general equation to describe its behaviour (sometimes known as "tweening"), try storing the following three vectors:
<br/>
<br/>
- position
<br/>
- velocity
<br/>
- acceleration
<br/>
<br/>
Then every frame, update all three of them based on their relationship to each other.</td> </tr></table><span class="postbody">
<br/>
<br/>
And if that's not enough for you to go on, please <a class="postlink" href="http://forum.gbadev.org/search.php" target="_blank">search</a> the forums as this topic has already been discussed inside and out.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82981 - Dan2552 - Thu May 11, 2006 5:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Do you like not being able to debug your code?</td> </tr></table><span class="postbody">
<br/>
hmm? If a problem comes up when compiling, i check the debug messages and it tells me the problem, goto doesn't prevent this
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Do you like having slow code that the compiler is unable to optimize?</td> </tr></table><span class="postbody">
<br/>
the game runs fine on emulator/real hardware, why does it need to be optimized?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Do you like making your code infinitely harder to read for the people you want help from?</td> </tr></table><span class="postbody">
<br/>
OK. I <span style="font-weight: bold">never</span> planned to release the source, all i asked from Darkflame was a jumping method which actually worked with being able to jump sideways aswell.
<br/>
<br/>
I make the code readable for myself, not for others, I don't post my code very often.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If you refuse to learn how to use the basic tools the language is providing you with,</td> </tr></table><span class="postbody">
<br/>
I'm not refusing, this is my first C project, surely I can take some shortcuts on my 1st game? (except when i tested moving sprite around, pressing button and stuff happening when sprite is over a button, etc.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
 you're only screwing yourself.
<br/>
</td> </tr></table><span class="postbody">
<br/>
how is that possible :p ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82988 - keldon - Thu May 11, 2006 6:36 pm</h4>
    <div class="postbody"><span class="postbody">I wouldn't hold your hand but maybe I can give you some easy direction into getting your physics engine working.
<br/>
<br/>
Check out <a class="postlink" href="http://www.sodaplay.com/constructor/" target="_blank">sodaconstructor</a>. Their physics engine is under 30 lines of code. I had to implement a clone (minus the ability to walk and grip stuff because they semi-reflective collisions were complicated).
<br/>
<br/>
Honestly physics engines are one of them things that are simply simple once you've got it working.
<br/>
<br/>
----
<br/>
<br/>
I have to go now but there are simple steps in implementing a physics engine. Just create a simple joypad handler that will apply the force to an object; and eventually your physics engine will enable it to work.
<br/>
<br/>
When I get back I can give a shot at helping unless someone beats me to it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82999 - Dan2552 - Thu May 11, 2006 8:56 pm</h4>
    <div class="postbody"><span class="postbody">heres what I had <span style="font-weight: bold">before</span> I asked Darkflame:
<br/>
(before I look TOO much like an idiot)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
void gravity() {
<br/>
if (jumping == 1) {
<br/>
if (frodo1_y &gt; 100 - (jumpheight)) {
<br/>
  frodo1_y -= speedfall;
<br/>
  
<br/>
  }
<br/>
 if (frodo1_y &lt;= 100 - (jumpheight)) {
<br/>
jumping = 0;
<br/>
  }
<br/>
}
<br/>
if (jumping == 0) {
<br/>
  if (frodo1_y &lt; 100) {
<br/>
  frodo1_y += speedfall;
<br/>
  }
<br/>
}
<br/>
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
if(F_CTRLINPUT_UP_PRESSED)   {
<br/>
<br/>
if (frodo1_y == 100) { //ground level
<br/>
jumping = 1;
<br/>
}
<br/>
return;
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
This KIND OF works well, but it doesn't seem very smooth for me.. but then maybe it will look smoother when animation is added?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83006 - poslundc - Thu May 11, 2006 11:07 pm</h4>
    <div class="postbody"><span class="postbody">The system you've designed there works for constant velocity, where the acceleration is zero.
<br/>
<br/>
Gravity is a force of constant <span style="font-weight: bold">acceleration</span>, though, and changing velocity.
<br/>
<br/>
The next step is to change your falling speed every tick by the rate of acceleration due to gravity.
<br/>
<br/>
But for the love of pete...
<br/>
<br/>
- Don't use magic numbers in your code. Use macros or constants with meaningful names instead. The number 100 could mean <span style="font-style: italic">anything</span>, and when you have it in four places, that's just a bunch of opportunities for you to miss something and cause an error if you need to change the value.
<br/>
<br/>
- Learn to use fixed point math. Search the forum or google it.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83028 - tepples - Fri May 12, 2006 4:49 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dan2552 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">Do you like having slow code that the compiler is unable to optimize?</td> </tr></table><span class="postbody">
<br/>
the game runs fine on emulator/real hardware, why does it need to be optimized?</span></td> </tr></table><span class="postbody">
<br/>
Optimized code uses fewer CPU cycles, which means more time spent in VBlankIntrWait(), which means less current drawn from the battery. And what happens when you want to add features later on?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dan2552 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">you're only screwing yourself.</td> </tr></table><span class="postbody">
<br/>
how is that possible :p ?</span></td> </tr></table><span class="postbody">
<br/>
<a class="postlink" href="http://en.wikipedia.org/wiki/Masturbation" target="_blank">Wikipedia explains (not safe for work)</a><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83047 - Dan2552 - Fri May 12, 2006 10:29 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">The system you've designed there works for constant velocity, where the acceleration is zero.
<br/>
<br/>
Gravity is a force of constant <span style="font-weight: bold">acceleration</span>, though, and changing velocity.
<br/>
<br/>
The next step is to change your falling speed every tick by the rate of acceleration due to gravity.
<br/>
</td> </tr></table><span class="postbody">
<br/>
ok. 
<br/>
so everytime I press up, reset the speed
<br/>
when player jumps to its highest, trigger a speed increasing thingy?
<br/>
<br/>
Do I want to slow the jump aswell or wont that matter much?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
- Don't use magic numbers in your code. Use macros or constants with meaningful names instead. The number 100 could mean <span style="font-style: italic">anything</span>, and when you have it in four places, that's just a bunch of opportunities for you to miss something and cause an error if you need to change the value.
<br/>
<br/>
- Learn to use fixed point math. Search the forum or google it.
<br/>
<br/>
Dan.</td> </tr></table><span class="postbody">
<br/>
<br/>
-So I should declare a floorlevel and set it to 100, or am i missing something :(
<br/>
<br/>
-</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83048 - keldon - Fri May 12, 2006 10:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">-So I should declare a floorlevel and set it to 100, or am i missing something :( </td> </tr></table><span class="postbody">
<br/>
Yes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83055 - sgeos - Fri May 12, 2006 12:56 pm</h4>
    <div class="postbody"><span class="postbody">You should be doing something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define FLOOR_LEVEL 100
<br/>
#define TRUE 1
<br/>
#define FALSE 0
<br/>
<br/>
int hitFloor(int pY)
<br/>
{
<br/>
  if (pY &lt; FLOOR_LEVEL)
<br/>
    return TRUE;
<br/>
  return FALSE;
<br/>
}
<br/>
<br/>
void snapToFloor(dude_t *pDude)
<br/>
{
<br/>
    pDude-&gt;y = FLOOR_LEVEL;
<br/>
    pDude-&gt;jumping = FALSE;
<br/>
}
<br/>
<br/>
void floorCheck(dude_t *pDude)
<br/>
{
<br/>
  if ( hitFloor(pDude-&gt;y) )
<br/>
    snapToFloor(pDude);
<br/>
}
<br/>
<br/>
void caller(void)
<br/>
{
<br/>
  input_t input;
<br/>
  dude_t dude;
<br/>
<br/>
  initDude(&amp;dude);
<br/>
  initInput(&amp;input);
<br/>
<br/>
  while ( TRUE )
<br/>
  {
<br/>
    getInput(&amp;input);
<br/>
    updatePosition(&amp;dude, &amp;input);
<br/>
    floorCheck(&amp;dude);
<br/>
  }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
Why is that nifty?  Well... let's say that for technical reasons you have to change the floor level to 123.  I dare you find all the places where you need to change the above code to get a floor level of 123.  Assume that all of the code I failed to show you is written in a similar fashion.  =)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
