<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Definining template class in .h and implementin it in a .cpp - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Definining template class in .h and implementin it in a .cpp</h2>
<div id="posts">
<div class="post">
    <h4>#175253 - Polaris - Sat Oct 16, 2010 9:15 pm</h4>
    <div class="postbody"><span class="postbody">I have read that you can choose among different methods to have your template class divided into a .h and .cpp. I didn't quite liked any, but i chose the one below.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#ifndef MYCLASS_H
<br/>
#define MYCLASS_H 
<br/>
<br/>
template&lt;class BaseClassType&gt;
<br/>
class Factory
<br/>
{
<br/>
public:
<br/>
    Factory(void);
<br/>
    ~Factory(void);
<br/>
};
<br/>
#include "Factory.cpp"
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "Factory.h"
<br/>
<br/>
template&lt;class BaseClassType&gt;
<br/>
Factory&lt;BaseClassType&gt;::Factory(void)
<br/>
{
<br/>
<br/>
}
<br/>
template&lt;class BaseClassType&gt;
<br/>
Factory&lt;BaseClassType&gt;::~Factory(void)
<br/>
{
<br/>
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
The problem is that Visual Studio 2008 Express complains about it. Saying the following:
<br/>
<br/>
<span style="font-weight: bold">error C2995: 'Factory&lt;BaseClassType&gt;::Factory(void)' : function template has already been defined</span>
<br/>
<br/>
I really can't figure out what the problem is, I found the solution posted in several different places, so I'm guessing it is me being blind to some small syntax error.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#175254 - wintermute - Sat Oct 16, 2010 10:25 pm</h4>
    <div class="postbody"><span class="postbody">You probably want to make a note to avoid the sites or the people that gave you that "solution".
<br/>
<br/>
Factory.h includes Factory.cpp and Factory.cpp includes Factory.h - this results in the contents of Factory.cpp being placed in the translation unit twice. Obviously the compiler then chokes. The only way you're going to avoid an error with this code is never to attempt to compile the .cpp which, to my mind, makes it a no brainer to include the template body in the header rather than separating things this way.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#175255 - Polaris - Sat Oct 16, 2010 11:14 pm</h4>
    <div class="postbody"><span class="postbody">Ah, I figured that including the .cpp at the end of the header was just like copying the code in there. I never thought the compiler would attemp to compile the .cpp. Which now that I think about it, has no logical basis :P
<br/>
<br/>
Thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#175859 - tom - Sun Feb 20, 2011 11:41 am</h4>
    <div class="postbody"><span class="postbody">This is ridiculous. Just put everything into the header and rely on the compiler to eliminate duplicated template instantiations properly. Microsoft's compiler is by now pretty good at that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#175861 - Dwedit - Sun Feb 20, 2011 4:33 pm</h4>
    <div class="postbody"><span class="postbody">I thought you had to include full source code for templated classes in the header file.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#175862 - tom - Sun Feb 20, 2011 5:20 pm</h4>
    <div class="postbody"><span class="postbody">Ah, I skipped over the thread and was thinking of something slightly different. Anyway, here's my preferred way to do template classes:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef MYCLASS_H
<br/>
#define MYCLASS_H
<br/>
<br/>
template&lt;typename BaseClassType&gt;
<br/>
class Factory
<br/>
{
<br/>
public:
<br/>
    Factory(void)
<br/>
   {
<br/>
    // Function definitions right inside the class declaration.
<br/>
   }
<br/>
    ~Factory(void)
<br/>
   {
<br/>
   }
<br/>
};
<br/>
#endif 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I prefer putting the function definitions right into the class declaration. Personally I think this actually declutters the code, and I don't have to maintain function signatures in declarations AND definitions.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
