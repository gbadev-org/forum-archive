<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Random numbers? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>C/C++ > Random numbers?</h2>
<div id="posts">
<div class="post">
    <h4>#10361 - marcmccann - Wed Sep 03, 2003 1:57 pm</h4>
    <div class="postbody"><span class="postbody">Hey guys, ive really only just started with GBA development but Ive found it easy to get to grips with so i didnt post in the beginners forum coz they probably wouldnt be able to answer my question.
<br/>
<br/>
I have tried to use the normal stdlib.h way of doing random which also incorporates time.h to get a true random number eg
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
srand(time(NULL));
<br/>
int SomeRandomNumber = rand() % 255;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
however my DevKitAdv complains when I do this, is there any other way of getting random numbers into a GBA game without having to write my own macro or function to do it please?
<br/>
<br/>
In case you were wondering, I'm trying to do this to get random colours in my game menu's.
<br/>
<br/>
Any help would be appreciated on this guys, thanx! :)<br/>_________________<br/>The GBA is one Lean and Mean machine!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10363 - Mr. GBA - Wed Sep 03, 2003 2:04 pm</h4>
    <div class="postbody"><span class="postbody">Use these two functions:
<br/>
<br/>
#define RAND_MAX 32767
<br/>
volatile s32 RAND_RandomData;
<br/>
<br/>
void SeedRandom(void)
<br/>
{
<br/>
   RAND_RandomData = REG_VCOUNT;
<br/>
}
<br/>
<br/>
<br/>
s32 RAND(s32 Value)
<br/>
{
<br/>
   RAND_RandomData *= 20077;
<br/>
   RAND_RandomData += 12345;
<br/>
<br/>
   return ((((RAND_RandomData &gt;&gt; 16) &amp; RAND_MAX) * Value) &gt;&gt; 15);
<br/>
}<br/>_________________<br/>my dev/business site:
<br/>
<br/>
<a href="http://codebytesdev.afraid.org" target="_blank">http://codebytesdev.afraid.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10364 - marcmccann - Wed Sep 03, 2003 2:08 pm</h4>
    <div class="postbody"><span class="postbody">Thanx a lot Mr.Gba<br/>_________________<br/>The GBA is one Lean and Mean machine!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10366 - Lupin - Wed Sep 03, 2003 2:19 pm</h4>
    <div class="postbody"><span class="postbody">Mr GBA, why did you define the seed as volatile? Aren't variables always volatile?
<br/>
<br/>
Good idea to use the VCOUNT register to get an seed, I'd call the seedRandom function on every input interrupt, so you could be sure that the seed is really random</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10367 - Mr. GBA - Wed Sep 03, 2003 2:24 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, but I can't take credit for these functions. I got them from someone elses source code. BTW I'not sure why a volatile has been declared.<br/>_________________<br/>my dev/business site:
<br/>
<br/>
<a href="http://codebytesdev.afraid.org" target="_blank">http://codebytesdev.afraid.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10369 - marcmccann - Wed Sep 03, 2003 2:28 pm</h4>
    <div class="postbody"><span class="postbody">Thanx a lot anyway, I was about to try and write my own function which would have been messy! I dont quite understand the volatile either but as long as it works...<br/>_________________<br/>The GBA is one Lean and Mean machine!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10400 - sgeos - Thu Sep 04, 2003 5:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupin wrote:</b></span></td> </tr> <tr> <td class="quote">Aren't variables always volatile?</td> </tr></table><span class="postbody">
<br/>
<br/>
Of course not.  If all variables were always volatile, the keyword would be redundant.  Volatile means that the something other than your code can change the value.  Hardware, for example.
<br/>
<br/>
VCOUNT ought to be volatile if it is not.  I did not look at the code for very long, but I do not see any reason for the state of an RNG to be declared volatile.
<br/>
<br/>
-Brendan Sechter</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10577 - marcmccann - Tue Sep 09, 2003 1:52 pm</h4>
    <div class="postbody"><span class="postbody">From what I can gather, the variable is volatile because it is dependant on the hardware in order to get its value. If it wasnt volatile the chances of it actually working are VERY low and probably not worth trying, it works fine as it is and as long as it works i'll be using it like that...<br/>_________________<br/>The GBA is one Lean and Mean machine!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
