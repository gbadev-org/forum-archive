<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>externally setting structures - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > externally setting structures</h2>
<div id="posts">
<div class="post">
    <h4>#7577 - Psyk - Fri Jun 20, 2003 8:52 am</h4>
    <div class="postbody"><span class="postbody">This should be easy to answer if i explain it right. I have a C file that contains my map data but i also want it to contain certain attributes for that map. I have a structure for these attributes but i cant put the data into the structure outside of the code. GCC accepts the declaration of my structure instance as a const but not the rest of it. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const Bg rooma;
<br/>
<br/>
rooma.sizeX=32;
<br/>
rooma.sizeY=32;
<br/>
rooma.number = 2;</td> </tr></table><span class="postbody">
<br/>
It comes up with a parse error before '.' token. I have tried making them constants aswell but the error still comes up</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7587 - Sweex - Fri Jun 20, 2003 11:57 am</h4>
    <div class="postbody"><span class="postbody">If you want to define the data at compiletime, do it like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const Bg rooma = { 32, 32, 2 }; 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Also the code you gave should not work. You defined Bg as a const, and therefore you are not able to change it contents at runtime. 
<br/>
<br/>
That's the whole idea of "const" is that you cannot change it. Knowing that this is the case, the compiler can make certain optimizations. On the GBA for instance, it will put it in the ROM instead of working RAM.
<br/>
<br/>
Hope this helps!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7590 - Psyk - Fri Jun 20, 2003 12:11 pm</h4>
    <div class="postbody"><span class="postbody">Well i don't want to change most of the contents at run time so i tried declaring them as costants aswell but it came up with the parse error. I will try your suggestion.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7615 - MumblyJoe - Sat Jun 21, 2003 5:34 am</h4>
    <div class="postbody"><span class="postbody">If you dont mind using c++ (i know it adds overhead so you may not want to) you can make const objects that are initialised with the constructor. In fact, you dont even have to use the class keyword if it makes you uncomfortable, c++ allows structs to make member functions, the only difference is that the contents of structs are public by default while the contents of classes are private.
<br/>
<br/>
So you could make something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">struct Bg
<br/>
{
<br/>
  Bg(const int one, const int two, const int three)
<br/>
  :one(one),two(two),three(three){}
<br/>
  int one,two,three;
<br/>
};
<br/>
<br/>
const Bg a(5,6,7);</td> </tr></table><span class="postbody">
<br/>
<br/>
And then it should be unchangeable and initialised.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7616 - Psyk - Sat Jun 21, 2003 8:32 am</h4>
    <div class="postbody"><span class="postbody">That sounds good. But would that work if not all of the data is constant? would i just not declare those variables as constant?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7642 - sgeos - Sun Jun 22, 2003 4:54 am</h4>
    <div class="postbody"><span class="postbody">You might want to do something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">struct whatever
<br/>
{
<br/>
};
<br/>
<br/>
const struct whatever my_whatever1 = {...};
<br/>
<br/>
struct whatever current_whatever = {...};</td> </tr></table><span class="postbody">
<br/>
<br/>
Then you can copy everything from the const version into the non-const version.  Do whatever you want with it, including modification, and then load something else into it (or discard it) when you are done with it.  If you want me to, I'll give an example.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7645 - Psyk - Sun Jun 22, 2003 7:43 am</h4>
    <div class="postbody"><span class="postbody">yeah that should work, thanks! In fact i think that would work better than what i was planning on doing before.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7655 - sgeos - Sun Jun 22, 2003 3:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Psyk wrote:</b></span></td> </tr> <tr> <td class="quote">yeah that should work, thanks!</td> </tr></table><span class="postbody">
<br/>
<br/>
You are welcome.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
