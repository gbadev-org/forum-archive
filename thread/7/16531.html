<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Compiler optimization with useless statements - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > Compiler optimization with useless statements</h2>
<div id="posts">
<div class="post">
    <h4>#167411 - Echo49 - Wed Mar 11, 2009 4:37 am</h4>
    <div class="postbody"><span class="postbody">Not really to do with coding, but if I have a simple addition that does nothing:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (int i=0;i&lt;A_BIG_NUMBER;++i)
<br/>
    45+56;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Does the compiler exclude that line from the binary?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167415 - Ruben - Wed Mar 11, 2009 7:22 am</h4>
    <div class="postbody"><span class="postbody">Depends on the level of optimization.
<br/>
<br/>
-O0 will not. This level of optimization does absolutely no optimization and handles the code exactly as you type it.
<br/>
<br/>
-O1 may, depending on your compiler.
<br/>
<br/>
-O2 most likely will.
<br/>
<br/>
If you have -Wall or -Wextra, I can't remember, the compiler will warn you about a loop with no effect.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167418 - Dwedit - Wed Mar 11, 2009 8:38 am</h4>
    <div class="postbody"><span class="postbody">If you use -S, you can see what the compiler does.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167420 - Echo49 - Wed Mar 11, 2009 9:07 am</h4>
    <div class="postbody"><span class="postbody">I have this code, compiled with -O0 as suggested.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">      for (i=0; i&lt;LOOPS; ++i) {
<br/>
         54+56;
<br/>
      }
<br/>
      
<br/>
      //...
<br/>
      
<br/>
      for (i=0; i&lt;LOOPS; ++i) {
<br/>
         34+57;87+21;
<br/>
      }</td> </tr></table><span class="postbody">
<br/>
Why does the first loop take more time to execute (when using the clock() function from time.h) than the second loop? LOOPS is 100,000,000</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167422 - Pete_Lockwood - Wed Mar 11, 2009 1:03 pm</h4>
    <div class="postbody"><span class="postbody">What assembler does it produce?  If it's really taking more time, the answer will be there.<br/>_________________<br/>It's not an illusion, it just looks like one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167444 - Echo49 - Thu Mar 12, 2009 7:58 am</h4>
    <div class="postbody"><span class="postbody">Curiously enough,
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">MOV EAX,DWORD PTR SS:[EBP-20]
<br/>
MOV DWORD PTR SS:[EBP-20],EAX</td> </tr></table><span class="postbody">
<br/>
takes longer to execute than
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">MOV EAX,DWORD PTR SS:[EBP-20]
<br/>
ADD EAX,1
<br/>
MOV DWORD PTR SS:[EBP-20],EAX</td> </tr></table><span class="postbody">
<br/>
when both are executed one trillion times.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167445 - Ruben - Thu Mar 12, 2009 8:33 am</h4>
    <div class="postbody"><span class="postbody">I think it's got to do with the pipeline of the CPU, cos if they were constant timings, the second one should've taken longer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167456 - Miked0801 - Thu Mar 12, 2009 4:58 pm</h4>
    <div class="postbody"><span class="postbody">Man I forgot how ugly x86 assembler is to ARM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167459 - Kyoufu Kawa - Thu Mar 12, 2009 6:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">Man I forgot how ugly x86 assembler is to ARM.</td> </tr></table><span class="postbody">Amen to that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167462 - Echo49 - Thu Mar 12, 2009 8:39 pm</h4>
    <div class="postbody"><span class="postbody">=.=;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167484 - keldon - Fri Mar 13, 2009 6:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">Man I forgot how ugly x86 assembler is to ARM.</td> </tr></table><span class="postbody">
<br/>
<br/>
Beauty is in the eye of the beholder; although that is ugly syntax - RosAsm is nice to work with.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169651 - Karatorian - Mon Jul 27, 2009 11:51 pm</h4>
    <div class="postbody"><span class="postbody">While there's some truth to the statement regarding subjective beauty, x86's uglyness goes way beyond just the syntax. I've written asm for a few platforms and the x86 ISA is ugly clear to the bare metal.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
