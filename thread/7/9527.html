<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DevkitARM r8 to r18 creates an alignment problem with DMA3? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > DevkitARM r8 to r18 creates an alignment problem with DMA3?</h2>
<div id="posts">
<div class="post">
    <h4>#82809 - DiscoStew - Wed May 10, 2006 8:25 am</h4>
    <div class="postbody"><span class="postbody">This is probably a fault of my own with my programming, but here I go anyways...
<br/>
<br/>
Before, when I used an older version of devkitARM (r8 to be exact), and when I'd compile my program, everything was working as it should be. However, I switched to r18 hoping to continue with what I had with more current software, but the tilesets I was DMAing over were getting screwed up. I was using DMA_32NOW from a 16 bit array to VRAM, and the bits were off by 4 pixels. DMA_16NOW works fine though, which is why it is most likely my own fault with bad programming, but like I said, it was working before with DMA_32NOW with r8. However, does using DMA_16NOW take longer than DMA_32NOW, and if so, if I want to keep my data copying fast, I need to align my arrays to a 4 byte boundary, right? I'm kinda rusty on the alignment method though.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#82814 - wintermute - Wed May 10, 2006 9:39 am</h4>
    <div class="postbody"><span class="postbody">If you're defining your data as arrays then use code like this :-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const u8 ArrayName[] __attribute__ ((aligned (4))) = { ...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
the libgba and libnds headers define a macro
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define ALIGN(m)   __attribute__((aligned (m)))</td> </tr></table><span class="postbody">
<br/>
<br/>
so you can write
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">const u8 ArrayName[] ALIGN(4) = { ...</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
