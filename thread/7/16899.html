<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>VisualBoy Advance Blanks - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > VisualBoy Advance Blanks</h2>
<div id="posts">
<div class="post">
    <h4>#170583 - nathanpc - Sun Oct 04, 2009 2:47 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
 I'm trying to do my first test of C development for GBA, but when i put the ROM in VisualBoy i got only a white screen, remember that the code compiles perfectly. See the code that i'm using:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/* hello.c - Gameboy Advance Tutorial - Loirak Development */
<br/>
#define RGB16(r,g,b)  ((r)+(g&lt;&lt;5)+(b&lt;&lt;10)) 
<br/>
<br/>
int main()
<br/>
{
<br/>
   char x,y;  
<br/>
   unsigned short* Screen = (unsigned short*)0x6000000; 
<br/>
   *(unsigned long*)0x4000000 = 0x403; // mode3, bg2 on 
<br/>
<br/>
   // clear screen, and draw a blue back ground
<br/>
   for(x = 0; x&lt;240;x++)   //loop through all x
<br/>
   {
<br/>
      for(y = 0; y&lt;160; y++)  //loop through all y
<br/>
      {
<br/>
         Screen[x+y*240] = RGB16(0,0,31);  
<br/>
      }
<br/>
   }
<br/>
<br/>
   // draw a white HI on the background
<br/>
   for(x = 20; x&lt;=60; x+=15)
<br/>
      for(y = 30; y&lt;50; y++)  
<br/>
         Screen[x+y*240] = RGB16(31,31,31);  
<br/>
   for (x = 20; x &lt; 35; x++)
<br/>
      Screen[x+40*240] = RGB16(31,31,31);  
<br/>
<br/>
   while(1){}   //loop forever
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">I'm using DevKitPro lastest version</span>
<br/>
And here my VisualBoy:
<br/>
<a href="http://img136.imageshack.us/img136/8830/vbadv.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
Best Regards,
<br/>
 Nathan Paulino Campos</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170585 - Cearn - Sun Oct 04, 2009 4:00 pm</h4>
    <div class="postbody"><span class="postbody">You're probably not using the right linker flags. With devkitArm you need to add a <span style="font-weight: bold">-specs</span> option to indicate where the sections should be. Use <span style="font-style: italic">-specs=gba.specs</span> or <span style="font-style: italic">-specs=gba_mb.specs</span> for cart- or multiboot-builds, respectively. For more information, see <a class="postlink" href="http://www.coranac.com/tonc/text/setup.htm#sec-cli" target="_blank">tonc:setup</a>.
<br/>
<br/>
Or you could use template projects (devkitPro/examples/gba/template), which have been set-up to take of all these things automatically.
<br/>
<br/>
<br/>
Two other sidenotes:
<br/>
<br/>
The RGB16 macro is unsafe. <span style="font-style: italic">g</span> and <span style="font-style: italic">b</span> have no parentheses around them, which could produce incorrect results due to operator precedence. For example, something like `RGB16(0, 0, blue&amp;31)', where excess blue bits are cut off, would result in `blue&amp;31&lt;&lt;10' = `blue &amp; (31&lt;&lt;10)', which will usually be 0 instead of the masked blue you might have expected. As a rule, use parentheses around macro parameters.
<br/>
<br/>
Secondly, using a char-type for loop variables is a bad idea. Firstly, because they're not the standard integer type (i.e. int), they're a little slower. Secondly, they overflow faster, which can have its own set of problems. A signed char, for example, has a range of -128 to 127, so the first x-loop would never terminate. Then signedness of an unadorned char is compiler specific, so by just using `char', there may or may not be an infinite loop in this code. As it happens, devkitArm considers `char' to be `unsigned char', so you've lucked out here, but it's best to simply use int or unsigned int, or their typedef'ed shorthands, for local variables in all cases.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
