<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>seperating array data from source code? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > seperating array data from source code?</h2>
<div id="posts">
<div class="post">
    <h4>#109391 - dext3r - Fri Nov 17, 2006 11:03 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
I am working on a C program for the DS that keeps track of train station data. I will have about 40 or so stations. This is how I'm storing the data:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef struct 
<br/>
{   
<br/>
   u32    stationID;   
<br/>
   char    *name;
<br/>
   char    *color;
<br/>
   u32   coordx;
<br/>
   u32   coordy;
<br/>
   char   *outbound;
<br/>
   u32   outbound_sprite;
<br/>
   char    *inbound;
<br/>
   u32   inbound_sprite;
<br/>
   char  *outbound_wkday;
<br/>
   char    *outbound_sat;
<br/>
   char   *outbound_sun;
<br/>
   char    *inbound_wkday;
<br/>
   char   *inbound_sat;
<br/>
   char   *inbound_sun;
<br/>
   char   *comments;
<br/>
} stationData;</td> </tr></table><span class="postbody">
<br/>
<br/>
I have an array of stationDatas. In my main code I have this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
 stations[0].name = "Roosevelt";
<br/>
   stations[0].stationID = 1;
<br/>
   stations[0].color= "Red";
<br/>
   stations[0].outbound = "95/DanRyan";
<br/>
   stations[0].outbound_sprite = 1;
<br/>
   stations[0].inbound = "Howard";
<br/>
   stations[0].inbound_sprite = 4;
<br/>
   stations[0].coordx = 100;
<br/>
   stations[0].coordy = 100;
<br/>
   
<br/>
   stations[1].name = "Roosevelt";
<br/>
   stations[1].stationID = 2;
<br/>
   stations[1].color= "Green";
<br/>
   stations[1].outbound = "Ashland/63";
<br/>
   stations[1].outbound_sprite = 0;
<br/>
   stations[1].inbound = "Harlem";
<br/>
   stations[1].inbound_sprite = 3;
<br/>
   stations[1].coordx = 100;
<br/>
   stations[1].coordy = 100;
<br/>
</td> </tr></table><span class="postbody">
<br/>
and so on and so forth...
<br/>
<br/>
Is it possible to put this data into a seperate file I can include and compile and link or something? I'd rather not have it in the main source. If station info changes, I'd rather just update the external file and recompile the application. I'd also rather <span style="font-weight: bold">not</span> store the data in a textfile because then i'd have to use a filesystem and I'd want the app to be compatible with a majority of carts.
<br/>
<br/>
Thanks for any help you can provide. I've tried googling for info but I'm not sure what this technique is called. Thanks.
<br/>
dext3r</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109394 - KoshNi - Fri Nov 17, 2006 11:36 pm</h4>
    <div class="postbody"><span class="postbody">Does 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "station_data.h" ;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
mean something to you ? If not, have a look at this <a href="http://www.gamedev.net/reference/programming/features/orgfiles/page2.asp" target="_blank">http://www.gamedev.net/reference/programming/features/orgfiles/page2.asp</a> and/or google "<span style="font-style: italic">include C header file</span>"<br/>_________________<br/>Sunshine. Beauty. Love. Happiness.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109398 - dext3r - Sat Nov 18, 2006 12:16 am</h4>
    <div class="postbody"><span class="postbody">Thanks for the response. Perhaps I was overcomplicating this. I'm familiar with header files. I'll try some stuff. Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109414 - ScottLininger - Sat Nov 18, 2006 2:15 am</h4>
    <div class="postbody"><span class="postbody">Tepples also has provided a lightweight way to "append" data to a GBA binary file and then access it at run time. It might not be ideal for your structured kind of data, but take a look. 
<br/>
<br/>
If nothing else, the source code may provide you with a jumping-off point to create your own version. The nice thing about this approach is that you can truly edit your data outside of the compilation workflow, allowing changes without having to recompile anything.
<br/>
<br/>
Program available at <a href="http://www.pineight.com/gba/#gbfs" target="_blank">http://www.pineight.com/gba/#gbfs</a>
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109416 - sgeos - Sat Nov 18, 2006 2:44 am</h4>
    <div class="postbody"><span class="postbody">If you plan to have hundred of stations, you'll want to store that info in an easy to edit format (a spreadsheet).  You'll then want to write something that converts the designers data table into a code LUT.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109428 - gauauu - Sat Nov 18, 2006 7:16 am</h4>
    <div class="postbody"><span class="postbody">And if you do put it in a separate C file, do yourself a favor and don't put it in a header (*.h) file, but in an actual .c or assembly or bin file that you compile separately.  Do a search on the forums for about five hundred threads explaining why this is a better idea.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109444 - keldon - Sat Nov 18, 2006 10:27 am</h4>
    <div class="postbody"><span class="postbody">Search for what 'exact terms'?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109447 - KoshNi - Sat Nov 18, 2006 10:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauaa wrote:</b></span></td> </tr> <tr> <td class="quote">don't put it in a header (*.h) file, but in an actual .c or assembly or bin file that you compile separately</td> </tr></table><span class="postbody">
<br/>
<br/>
Why not ?<br/>_________________<br/>Sunshine. Beauty. Love. Happiness.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109452 - sgeos - Sat Nov 18, 2006 11:31 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>KoshNi wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauaa wrote:</b></span></td> </tr> <tr> <td class="quote">don't put it in a header (*.h) file, but in an actual .c or assembly or bin file that you compile separately</td> </tr></table><span class="postbody">
<br/>
Why not ?</span></td> </tr></table><span class="postbody">
<br/>
Because data and code do not belong in header files.  mydata.h should look something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// mydata.h - autogenerated on 2006/11/18
<br/>
#ifndef MYDATA_H
<br/>
#define MYDATA_H
<br/>
#include "whatever_you_need.h"
<br/>
<br/>
#define MYDATA_SIZE  1234
<br/>
extern const type_t mydata[MYDATA_SIZE];
<br/>
<br/>
#endif // MYDATA_H</td> </tr></table><span class="postbody">
<br/>
<br/>
mydata.c should contain the actual data:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// mydata.c - autogenerated on 2006/11/18
<br/>
#include "mydata.h"
<br/>
<br/>
const type_t mydata[MYDATA_SIZE] =
<br/>
{
<br/>
    {"String00", 0x0000, 0x00, 0x00},
<br/>
    {"String01", 0x0001, 0x01, 0x01},
<br/>
    {"String02", 0x0002, 0x02, 0x02},
<br/>
// ...
<br/>
    END_OF_TABLE_MARKER
<br/>
};
<br/>
<br/>
#endif // MYDATA_H</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">NOTE:</span> This code is untested.
<br/>
<br/>
You can either have multiple data tables for different kinds of data (my_palette_data.*, my_tile_data.*), or throw everything into one big data object.  If you don't know which stragegy is better (separate fies), the stragegy you use probably doesn't matter yet.
<br/>
<br/>
I don't like to have to edit .c and .h files, so I'd be apt to autogenerate them from something more designer friendly.  Clearly you don't need to do that if you don't want to.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109495 - Peter - Sat Nov 18, 2006 8:37 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>KoshNi wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauaa wrote:</b></span></td> </tr> <tr> <td class="quote">don't put it in a header (*.h) file, but in an actual .c or assembly or bin file that you compile separately</td> </tr></table><span class="postbody">
<br/>
Why not ?</span></td> </tr></table><span class="postbody">
<br/>
Cearn wrote some words about it. It's part of his TONC series, see <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/bitmaps.htm#ssec-data-hdr" target="_blank">here</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">I don't like to have to edit .c and .h files, so I'd be apt to autogenerate them from something more designer friendly.</td> </tr></table><span class="postbody">
<br/>
[advertising]
<br/>
I don't like it either, so I wrote a simple program for it. The program is called <span style="font-style: italic">Katie</span>. 
<br/>
<br/>
Katie concatenates binary data into one data-object and converts it into sourcecode (.c/.s) or binary again. The files inside get padded to n bytes and a header file with offsets to each file inside the data-object can be automatically generated as well. You can dowload the program <a class="postlink" href="http://www.console-dev.de/index.php?content=katie" target="_blank">here</a> if you are interested.
<br/>
[/advertising]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109807 - dext3r - Tue Nov 21, 2006 10:36 am</h4>
    <div class="postbody"><span class="postbody">Wow, I'm retarded. I totally forgot you can initialize arrays with values.
<br/>
<br/>
Good. I suck. Thanks to all who pointed this out. :p</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109819 - sgeos - Tue Nov 21, 2006 1:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dext3r wrote:</b></span></td> </tr> <tr> <td class="quote">Wow, I'm retarded. I totally forgot you can initialize arrays with values.</td> </tr></table><span class="postbody">
<br/>
Now you remember.  =)
<br/>
<br/>
Good luck!
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
