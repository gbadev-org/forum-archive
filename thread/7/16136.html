<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>undefined Reference - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > undefined Reference</h2>
<div id="posts">
<div class="post">
    <h4>#163917 - Bong - Wed Oct 15, 2008 2:16 am</h4>
    <div class="postbody"><span class="postbody">I am trying to compile my game with the irq functions and am getting the error undefined reference to irq_init(), irq_add(), and VBlankIntrWait() which is part of the tonc.h header(tonc library). Here is my code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;tonc.h&gt;
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Prototypes
<br/>
//---------------------------------------------------------------------------------
<br/>
void ballMove();
<br/>
void getInput();
<br/>
bool hasWon( u8 score );
<br/>
bool intersectsBottomBoundry( u16 y );
<br/>
bool intersectsLeftBoundry( u16 x );
<br/>
bool intersectsRighttBoundry( u16 x );
<br/>
bool intersectsTopBoundry( u16 y );
<br/>
void paddleMoveDown( u8 paddleid );
<br/>
void paddleMoveUP( u8 paddleid );
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Inlines
<br/>
//---------------------------------------------------------------------------------
<br/>
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Structures
<br/>
//---------------------------------------------------------------------------------
<br/>
<br/>
// Player Structure
<br/>
struct Player {
<br/>
   u16 y;
<br/>
   u8 score;
<br/>
}player[2];
<br/>
<br/>
// Ball Structure
<br/>
struct Ball {
<br/>
   u16 x;
<br/>
   u16 y;
<br/>
   s8 vx;
<br/>
   s8 vy;
<br/>
}ball;
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Enumuationss
<br/>
//---------------------------------------------------------------------------------
<br/>
enum paddle{ left, right };
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Program entry point
<br/>
//---------------------------------------------------------------------------------
<br/>
int main() {
<br/>
//---------------------------------------------------------------------------------
<br/>
<br/>
   //set the display mode to Mode 3 and background to 2
<br/>
   REG_DISPCNT = DCNT_MODE3 | DCNT_BG2;
<br/>
<br/>
   // enable isr switchboard and VBlank interrupt
<br/>
   //irq_init(NULL);
<br/>
   //irq_add(II_VBLANK, NULL);
<br/>
<br/>
   // start of main game loop
<br/>
   while(1)
<br/>
   {
<br/>
   
<br/>
   
<br/>
   // Wait for VSync
<br/>
   //VBlankIntrWait();
<br/>
   }
<br/>
}
<br/>
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: ballMove()
<br/>
// Purpose: Moves the ball based on it velocities
<br/>
//---------------------------------------------------------------------------------
<br/>
void ballMove()
<br/>
{
<br/>
   ball.x += ball.vx;
<br/>
   ball.y += ball.vy;
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: getInput()
<br/>
// Purpose: performs actions based on the users input
<br/>
//---------------------------------------------------------------------------------
<br/>
void getInput()
<br/>
{
<br/>
   if(key_is_down(KEY_UP))
<br/>
   {
<br/>
   }
<br/>
   else if(key_is_down(KEY_DOWN))
<br/>
   {
<br/>
<br/>
   }
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: hasWon()
<br/>
// Purpose: Returns if a player has won
<br/>
//---------------------------------------------------------------------------------
<br/>
bool hasWon( u8 score )
<br/>
{
<br/>
 if( score &gt; 11)
<br/>
 {
<br/>
 return true;
<br/>
 }
<br/>
 else
<br/>
 {
<br/>
 return false;
<br/>
 }
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: intersectsBottomBoundry()
<br/>
// Purpose: Returns if an object has intersected the bottom boundry
<br/>
//---------------------------------------------------------------------------------
<br/>
bool intersectsBottomBoundry( u16 y )
<br/>
{
<br/>
   if( y &gt; 160)
<br/>
   {
<br/>
   return true;
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
   return false;
<br/>
   }
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: intersectsLeftBoundry()
<br/>
// Purpose: Returns if an object has intersected the left boundry
<br/>
//---------------------------------------------------------------------------------
<br/>
bool intersectsLeftBoundry( u16 x )
<br/>
{
<br/>
   if( x &lt; 0)
<br/>
   {
<br/>
   return true;
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
   return false;
<br/>
   }
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: intersectsRightBoundry()
<br/>
// Purpose: Returns if an object has intersected the right boundry
<br/>
//---------------------------------------------------------------------------------
<br/>
bool intersectsRightBoundry( u16 x )
<br/>
{
<br/>
   if( x &gt; 240)
<br/>
   {
<br/>
   return true;
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
   return false;
<br/>
   }
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: intersectsTopBoundry()
<br/>
// Purpose: Returns if an object has intersected the top boundry
<br/>
//---------------------------------------------------------------------------------
<br/>
bool intersectsTopBoundry( u16 y )
<br/>
{
<br/>
   if( y &gt; 0)
<br/>
   {
<br/>
   return true;
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
   return false;
<br/>
   }
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: paddleMoveDown()
<br/>
// Purpose: Move the paddle down the screen on its y position
<br/>
//---------------------------------------------------------------------------------
<br/>
void paddleMoveDown( u8 paddleid )
<br/>
{
<br/>
   player[paddleid].y++;
<br/>
}
<br/>
<br/>
//---------------------------------------------------------------------------------
<br/>
// Function: paddleMoveUp()
<br/>
// Purpose: Move the paddle up the screen on its y position
<br/>
//---------------------------------------------------------------------------------
<br/>
void paddleMoveUp( u8 paddleid )
<br/>
{
<br/>
   player[paddleid].y--;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Just uncomment the irq functions and you'll see what i mean. Any ideas?
<br/>
<br/>
Sincerely,
<br/>
<br/>
Bong</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163922 - no2pencil - Wed Oct 15, 2008 6:25 am</h4>
    <div class="postbody"><span class="postbody">Rather than
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;tonc.h&gt; 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Try 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "tonc.h"
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The file tonc.h would need to be in your include path for the 1st instance to be correct.  Otherwise you will need to provide the absolute path for the file.  As long as it's in the current directory, the 2nd example should work fine for you.<br/>_________________<br/>-#2pencil</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163925 - Cearn - Wed Oct 15, 2008 7:36 am</h4>
    <div class="postbody"><span class="postbody">It's not a header problem (that's the "undeclared identifier" error); it's a linker problem. The actual code for tonc's functions is in libtonc.a, and this file should be linked to the project. Assuming you're using one of the template makefiles, add "-ltonc" to LIBS and "<span style="font-style: italic">path_to_tonc</span>/tonclib" to LIBDIRS.
<br/>
<br/>
Sidenotes: get into the habit of <span style="font-style: italic">not</span> using smaller datatypes (s8/u8 and s16/u16) for local variables and function arguments. In this case it won't really matter, but in calculation-heavy routines it can increase their runtimes by 10% to 100% (<a class="postlink" href="http://www.coranac.com/tonc/text/first.htm#ssec-bad-example" target="_blank">example</a>). Prefer 32-bit types (int s32/u32) over the smaller ones. 
<br/>
<br/>
The left and top collision functions will always return true because the datatype of u16 is unsigned and therefore &gt;=0 by definition. The routines can also be reduced to something like
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">bool intersectLeftBoundary(int x)
<br/>
{
<br/>
    return (x&lt;0);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
as the result of a comparison is a bool anyway. That said, the longer version is probably clearer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
