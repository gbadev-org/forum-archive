<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Can someone help me (DMA/VSYNC slowdown) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Can someone help me (DMA/VSYNC slowdown)</h2>
<div id="posts">
<div class="post">
    <h4>#14467 - LOst? - Wed Jan 07, 2004 5:03 am</h4>
    <div class="postbody"><span class="postbody">I've tried most things but I can't get this to work. Please someone tell me what I'm doing wrong.
<br/>
<br/>
This is what I want to do: Copy a palette array every frame with DMA, and then sync the frame. Here is my code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
while (1)
<br/>
{
<br/>
// REG_BG0HOFS = (bg0_x++) &gt;&gt; 2;
<br/>
// REG_BG3HOFS = (bg0_x++) &gt;&gt; 4;
<br/>
<br/>
 DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
<br/>
 while ((volatile u16) REG_VCOUNT != 160);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
Now this code is so damn slow, I can't do anything else :(
<br/>
<br/>
I can make it go 100 times faster just by taking out the Vsync:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
while (1)
<br/>
{
<br/>
// REG_BG0HOFS = (bg0_x++) &gt;&gt; 2;
<br/>
// REG_BG3HOFS = (bg0_x++) &gt;&gt; 4;
<br/>
<br/>
 DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
<br/>
/////////// while ((volatile u16) REG_VCOUNT != 160);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
What am I doing wrong here?
<br/>
<br/>
Here is my bat file that builds the game:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
path=c:\devkitadv\bin
<br/>
gcc -o z.elf main.cpp
<br/>
objcopy -O binary z.elf z.bin
<br/>
pause
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Please help!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14469 - Miked0801 - Wed Jan 07, 2004 5:18 am</h4>
    <div class="postbody"><span class="postbody">put the load in the vblank interrupt.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14470 - LOst? - Wed Jan 07, 2004 5:21 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">put the load in the vblank interrupt.</td> </tr></table><span class="postbody">
<br/>
<br/>
And how can I do that out from my code and compilator settings above?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14474 - yaustar - Wed Jan 07, 2004 5:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while (1)
<br/>
{
<br/>
// REG_BG0HOFS = (bg0_x++) &gt;&gt; 2;
<br/>
// REG_BG3HOFS = (bg0_x++) &gt;&gt; 4;
<br/>
while ((volatile u16) REG_VCOUNT != 160);
<br/>
DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
why you want to copy the palette every cycle is beyond me though....
<br/>
<br/>
quick explaination of the code. there are 228 v lines drawn per frame,(only 160 are viewable) so we take advantage of the time lapse to draw the reminder 68 lines and do a dma.
<br/>
[/code]<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14475 - tepples - Wed Jan 07, 2004 5:43 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">why you want to copy the palette every cycle is beyond me though....</td> </tr></table><span class="postbody">
<br/>
<a class="postlink" href="http://www.google.com/search?q=palette%20animation" target="_blank">But not beyond Google</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14480 - LOst? - Wed Jan 07, 2004 7:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while (1)
<br/>
{
<br/>
// REG_BG0HOFS = (bg0_x++) &gt;&gt; 2;
<br/>
// REG_BG3HOFS = (bg0_x++) &gt;&gt; 4;
<br/>
while ((volatile u16) REG_VCOUNT != 160);
<br/>
DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
why you want to copy the palette every cycle is beyond me though....
<br/>
<br/>
quick explaination of the code. there are 228 v lines drawn per frame,(only 160 are viewable) so we take advantage of the time lapse to draw the reminder 68 lines and do a dma.
<br/>
[/code]</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I've already tried this. It doesn't matter where I put the DMA call in the game loop. It's too slow :(
<br/>
<br/>
Something must be wrong with the Vsync</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14483 - yaustar - Wed Jan 07, 2004 8:44 am</h4>
    <div class="postbody"><span class="postbody">tepples: ahh....interesting. I stand corrected.
<br/>
<br/>
edit:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while (1)
<br/>
{
<br/>
   while ((volatile u16) REG_VCOUNT != 160){}
<br/>
   REG_DM3SAD = (u32)palette;//source of data
<br/>
   REG_DM3DAD = (u32)BGPaletteMem;//target for data
<br/>
   REG_DM3CNT = (128 | DMA_16NOW);//start copying NOW, in 16bit values
<br/>
} </td> </tr></table><span class="postbody">
<br/>
<br/>
try this. if this works then there is something wrong with the function or the variables passed to it...<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14496 - poslundc - Wed Jan 07, 2004 4:57 pm</h4>
    <div class="postbody"><span class="postbody">If yaustar's version doesn't work, try modifying it with the following:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">while (1)
<br/>
{
<br/>
   while ((volatile u16) REG_VCOUNT != 160){}
<br/>
   REG_DM3SAD = (u32)palette;//source of data
<br/>
   REG_DM3DAD = (u32)BGPaletteMem;//target for data
<br/>
   REG_DM3CNT = (128 | DMA_16NOW);//start copying NOW, in 16bit values
<br/>
   while ((volatile u16) REG_VCOUNT == 160);
<br/>
} </td> </tr></table><span class="postbody">
<br/>
<br/>
You could be running the DMA multiple times if it is completing before you advance to the next scanline.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14500 - LOst? - Wed Jan 07, 2004 5:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">If yaustar's version doesn't work, try modifying it with the following:
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">while (1)
<br/>
{
<br/>
   while ((volatile u16) REG_VCOUNT != 160){}
<br/>
   REG_DM3SAD = (u32)palette;//source of data
<br/>
   REG_DM3DAD = (u32)BGPaletteMem;//target for data
<br/>
   REG_DM3CNT = (128 | DMA_16NOW);//start copying NOW, in 16bit values
<br/>
   while ((volatile u16) REG_VCOUNT == 160);
<br/>
} </td> </tr></table><span class="postbody">
<br/>
<br/>
You could be running the DMA multiple times if it is completing before you advance to the next scanline.
<br/>
<br/>
Dan.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Both your and yaustar code don't work. It never copies the palette at all :(
<br/>
<br/>
This isn't just a problem for me when it comes to copying a palette array. I got the same problem with copying the OAM.
<br/>
<br/>
The DMA is not slow here, the Vsync is slowing the game loop down. If I take it out, the game will speed too fast.
<br/>
<br/>
Can it be something wrong with my GCC compiler?
<br/>
<br/>
Also I've tried to replace the DMA with memcpy, but it goes slower.
<br/>
<br/>
Is there anyone that got the same problem? I know you people are DMAing sprites all the time. Give me your source and I can try it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14514 - jma - Wed Jan 07, 2004 9:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">put the load in the vblank interrupt.</td> </tr></table><span class="postbody">
<br/>
<br/>
You would only do this if it happens every frame. Otherwise, you could use the flag in bits 12-13 of DMA3CNT_H to make the transfer wait until the next VBLANK to begin the transfer.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14519 - sajiimori - Wed Jan 07, 2004 11:17 pm</h4>
    <div class="postbody"><span class="postbody">Just a second...
<br/>
<br/>
It cannot possibly matter which order the DMA and vsync are in, when they are the only 2 things in a while(1) loop.
<br/>
<br/>
It also doesn't matter if the DMA is in the vblank interrupt, because doing the DMA right after the vsync is the same thing in almost all circumstances (except if the main loop takes longer than 1/60s).
<br/>
<br/>
If the DMA is running more than once per vblank, who cares?  If it's so fast that it finishes in less than an hline, it won't be slowing the program down so horribly.  (Of course you'd fix it in production code.)
<br/>
<br/>
Yaustar's code copied only 128 16-bit words, which is half as much as desired.  Did it even copy that?  If not, it's time to start asking about how things are #defined.
<br/>
<br/>
But perhaps the most important question is:  Just how fast were you expecting it to go?  Yes, if you remove the vsync it will run much faster.  With the vsync it should run at 60Hz.
<br/>
<br/>
How fast is it running?  If it runs at 60Hz, how much extra work can you do before it runs slower than 60Hz?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14528 - jma - Thu Jan 08, 2004 1:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">It cannot possibly matter which order the DMA and vsync are in, when they are the only 2 things in a while(1) loop.</td> </tr></table><span class="postbody">
<br/>
<br/>
It does, if the DMA is affecting VRAM.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">It also doesn't matter if the DMA is in the vblank interrupt, because doing the DMA right after the vsync is the same thing in almost all circumstances (except if the main loop takes longer than 1/60s).</td> </tr></table><span class="postbody">
<br/>
<br/>
If the DMA is in the vblank interrupt, then every time the interrupt fires the transfer will occur. What if you only want the DMA to transfer one time? for a splash screen for example...
<br/>
<br/>
However, as I re-read the OP, he did want it to occur every frame, so no harm done - my bad. ;)
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14531 - yaustar - Thu Jan 08, 2004 1:52 am</h4>
    <div class="postbody"><span class="postbody">Can yuo post the source for us to download because I want to why it doesnt seem to work.....it is driving me a little nutty here......<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14533 - sajiimori - Thu Jan 08, 2004 1:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jma wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">It cannot possibly matter which order the DMA and vsync are in, when they are the only 2 things in a while(1) loop.</td> </tr></table><span class="postbody">
<br/>
<br/>
It does, if the DMA is affecting VRAM.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Hmm...I'm having trouble thinking of how that can be.  If the DMA occurs during vblank either way, what does it matter?
<br/>
<br/>
Even if the work takes longer than vblank (i.e. if the transfer is many times larger than a palette), that would cause the same problems whether its done in the interrupt handler or not.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14540 - LOst? - Thu Jan 08, 2004 4:26 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">Just a second...
<br/>
<br/>
It cannot possibly matter which order the DMA and vsync are in, when they are the only 2 things in a while(1) loop.
<br/>
<br/>
It also doesn't matter if the DMA is in the vblank interrupt, because doing the DMA right after the vsync is the same thing in almost all circumstances (except if the main loop takes longer than 1/60s).
<br/>
<br/>
If the DMA is running more than once per vblank, who cares?  If it's so fast that it finishes in less than an hline, it won't be slowing the program down so horribly.  (Of course you'd fix it in production code.)
<br/>
<br/>
Yaustar's code copied only 128 16-bit words, which is half as much as desired.  Did it even copy that?  If not, it's time to start asking about how things are #defined.
<br/>
<br/>
But perhaps the most important question is:  Just how fast were you expecting it to go?  Yes, if you remove the vsync it will run much faster.  With the vsync it should run at 60Hz.
<br/>
<br/>
How fast is it running?  If it runs at 60Hz, how much extra work can you do before it runs slower than 60Hz?</td> </tr></table><span class="postbody">
<br/>
<br/>
You will probably go WTF now :P
<br/>
<br/>
This is the exact same code, the difference is just that I took out the vsync from dma_slow.bin and renamed it dma_fast.bin
<br/>
<br/>
<a href="http://logotypes.se/tmp/dma_slow.bin" target="_blank">http://logotypes.se/tmp/dma_slow.bin</a>
<br/>
<br/>
<a href="http://logotypes.se/tmp/dma_fast.bin" target="_blank">http://logotypes.se/tmp/dma_fast.bin</a>
<br/>
<br/>
I just want to make it work. It's just a DMA in the main loop for god's sake ;_;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14542 - LOst? - Thu Jan 08, 2004 4:35 am</h4>
    <div class="postbody"><span class="postbody">Sorry for double posting, but here's the source:
<br/>
<br/>
<a href="http://logotypes.se/tmp/dma_slow_source.zip" target="_blank">http://logotypes.se/tmp/dma_slow_source.zip</a>
<br/>
<br/>
Please help me to find the problem. You will be my hero then ;_;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14545 - johnny_north - Thu Jan 08, 2004 5:01 am</h4>
    <div class="postbody"><span class="postbody">I agree with yaustar. Post the whole loop. I've been assuming that the code you've posted it the code you're compiling - is it? Or are you presenting pruned code? Other code there could be causing the problem. If there are a lot of cycles being used, it's possible to consistantly miss REG_VCOUNT == 160. This will cause the problems you were originally experiencing. In this case, removing the test will result in the palette transfers ripping away as you describe. If you can't get all of other cycles processed in a frame, maybe the following test might bring at least immediate relief:
<br/>
<br/>
while(REG_VCOUNT &lt; 160){}
<br/>
//do the DMA here
<br/>
<br/>
Just some perspective - I personally have blamed DKA for dozens of problems over a several year period. Without fail I have found that each problem was a bug in my own code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14546 - johnny_north - Thu Jan 08, 2004 5:17 am</h4>
    <div class="postbody"><span class="postbody">while ((volatile u16) REG_VCOUNT &lt; 160){} 
<br/>
<br/>
After compiling your project with this change, I believe this is the effect you are looking for.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14549 - yaustar - Thu Jan 08, 2004 8:11 am</h4>
    <div class="postbody"><span class="postbody">I dont 'quite' how it would miss 160 but doing &gt; 160 is a lot better. Surprised that I missed that myself. I can Conifirm that this does work :)<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14554 - johnny_north - Thu Jan 08, 2004 3:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">I dont 'quite' how it would miss 160 but doing &gt; 160 is a lot better.</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm not certain myself. The DMA call is going to intermitantly happen right when hitting the 160th scan line (or rather right before) causing it to miss. Using !=160 jacked me up until I decided to instate the vbl irq instead. I only recently figured out that this approach would have worked fine for me as well.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14559 - jma - Thu Jan 08, 2004 5:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jma wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">It cannot possibly matter which order the DMA and vsync are in, when they are the only 2 things in a while(1) loop.</td> </tr></table><span class="postbody">
<br/>
<br/>
It does, if the DMA is affecting VRAM.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Hmm...I'm having trouble thinking of how that can be.  If the DMA occurs during vblank either way, what does it matter?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Because the DMA transfer returns immediately, it doesn't wait for it to complete before continuing the program. Of course, this is assuming assembly code -- I don't use HAM, so perhaps the HAM function does wait...
<br/>
<br/>
Think of this situation:
<br/>
<br/>
o Using a bitmapped mode, use DMA to copy a background each frame.
<br/>
o At the bottom of the screen you will have a rectangle (health bar).
<br/>
<br/>
If you do this, most of the time the health bar will never be displayed (or be partially obscured), because the DMA starts, you draw the rectangle and then the DMA finishes (covering it up).
<br/>
<br/>
Of course, you can write a routine to wait for the DMA to complete, by constantly checking the DMA_ENABLE bit in the proper CNT register and wait for it to be reset.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14562 - LOst? - Thu Jan 08, 2004 7:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">I dont 'quite' how it would miss 160 but doing &gt; 160 is a lot better. Surprised that I missed that myself. I can Conifirm that this does work :)</td> </tr></table><span class="postbody">
<br/>
<br/>
But I don't want it to look like this:
<br/>
<a href="http://logotypes.se/tmp/z.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
Is there just me who get this vierd effect while using this code in the main game loop?:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
	while (1)
<br/>
	{
<br/>
		REG_BG0HOFS = (bg0_x++) &gt;&gt; 1;
<br/>
		REG_BG3HOFS = (bg0_x++) &gt;&gt; 2;
<br/>
<br/>
		DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
<br/>
		// Just comment this line out to make it 1000 times faster:
<br/>
		while ((volatile u16) REG_VCOUNT &gt; 160){} 
<br/>
	}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14565 - sajiimori - Thu Jan 08, 2004 8:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Because the DMA transfer returns immediately, it doesn't wait for it to complete before continuing the program.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Actually, I don't think that's true.
<br/>
<br/>
GBATEK:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
The CPU is paused when DMA transfers are active, however, the CPU is operating during the periods when Sound/Blanking DMA transfers are paused.
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14567 - sajiimori - Thu Jan 08, 2004 8:20 pm</h4>
    <div class="postbody"><span class="postbody">Hey, what do ya know.  He wasn't posting the code he was actually using after all.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_BG0HOFS = (bg0_x++) &gt;&gt; 6;
<br/>
REG_BG3HOFS = (bg0_x++) &gt;&gt; 8;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Do you realize that this will only move the foreground one pixel every 64 frames (x &gt;&gt; 6 == x / 64), which is less than a pixel a second?
<br/>
<br/>
BTW, you should be using while(REG_VCOUNT!=160).  That is, until you get the hang of interrupts and you start using swi 5.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14569 - jma - Thu Jan 08, 2004 8:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Because the DMA transfer returns immediately, it doesn't wait for it to complete before continuing the program.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Actually, I don't think that's true.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Try it.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14571 - LOst? - Thu Jan 08, 2004 8:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">Hey, what do ya know.  He wasn't posting the code he was actually using after all.
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_BG0HOFS = (bg0_x++) &gt;&gt; 6;
<br/>
REG_BG3HOFS = (bg0_x++) &gt;&gt; 8;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Do you realize that this will only move the foreground one pixel every 64 frames (x &gt;&gt; 6 == x / 64), which is less than a pixel a second?
<br/>
<br/>
BTW, you should be using while(REG_VCOUNT!=160).  That is, until you get the hang of interrupts and you start using swi 5.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I don't care what I'm doing right now. I want to fix the vsync/DMA problem.
<br/>
<br/>
Here is the source code:
<br/>
<br/>
<a href="http://logotypes.se/tmp/dma_slow_source.zip" target="_blank">http://logotypes.se/tmp/dma_slow_source.zip</a>
<br/>
<br/>
Someone, do whatever you like, just fix the problem please.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14574 - yaustar - Thu Jan 08, 2004 8:43 pm</h4>
    <div class="postbody"><span class="postbody">you should, since it is slowing the entire thing down....
<br/>
edit: incorrect wording, It is running at the right speed which is very very slowly....
<br/>
<br/>
try this for example
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while (1)
<br/>
   {
<br/>
      REG_BG0HOFS = (bg0_x++);// &gt;&gt; 6;
<br/>
      //REG_BG3HOFS = (bg0_x++) &gt;&gt; 8;
<br/>
<br/>
      // Just comment this line out to make it 1000 times faster:
<br/>
      while ((volatile u16) REG_VCOUNT != 160){} 
<br/>
<br/>
      DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
   }
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"><br/><br/>Last edited by yaustar on Thu Jan 08, 2004 8:47 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#14575 - sajiimori - Thu Jan 08, 2004 8:45 pm</h4>
    <div class="postbody"><span class="postbody">LOst?,
<br/>
<br/>
Oh sorry, I thought the problem was the speed.  It works fine for me when I change it to move the background faster.  What is the problem again?
<br/>
<br/>
jma,
<br/>
<br/>
Is this an adequate test?  The screen gets filled very very slowly, presumably because the DMA is blocking the CPU.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "gba.h"
<br/>
<br/>
#define DMACPY32(dst,src,len) \
<br/>
  REG_DM3SAD = (int)(src); \
<br/>
  REG_DM3DAD = (int)(dst); \
<br/>
  REG_DM3CNT = (len) | DMA_ENABLE | DMA_TIMING_IMMEDIATE | DMA_32
<br/>
<br/>
main()
<br/>
{
<br/>
    u16* p = VIDEO_MEMORY;
<br/>
    REG_DISPCNT = MODE_3 | BG2_ENABLE;
<br/>
<br/>
    while(1)
<br/>
    {
<br/>
        DMACPY32((u8*)EXTERNAL_RAM+1,
<br/>
                 EXTERNAL_RAM,
<br/>
                256000);
<br/>
<br/>
        *p++ = 0x1f;
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14576 - LOst? - Thu Jan 08, 2004 9:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">you should, since it is slowing the entire thing down....
<br/>
edit: incorrect wording, It is running at the right speed which is very very slowly....
<br/>
<br/>
try this for example
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while (1)
<br/>
   {
<br/>
      REG_BG0HOFS = (bg0_x++);// &gt;&gt; 6;
<br/>
      //REG_BG3HOFS = (bg0_x++) &gt;&gt; 8;
<br/>
<br/>
      // Just comment this line out to make it 1000 times faster:
<br/>
      while ((volatile u16) REG_VCOUNT != 160){} 
<br/>
<br/>
      DMA_Copy (3, (void*) BGPaletteMem, (void*) palette, 256/2, DMA_32NOW);
<br/>
   }
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
So what you're saying is that I should live with the slowdown. It's part of GBA, right? The Gameboy Advance is too slow to copy a 256 word array, so better start programming for the PC instead, or maybe N-gage can copy 512 bytes faster?
<br/>
<br/>
What if I want to copy a sprite into the OAM? No, that's inpossible for the Gameboy Advance to do, because a sprite is bigger than the palette.
<br/>
<br/>
I will not stay much longer here if this is the answer. I want to program games, and if Gameboy Advance is so slow, than I will head back to the old consoles from 1990, they can copy a little palette aray faster.
<br/>
<br/>
Thank you :\</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14577 - yaustar - Thu Jan 08, 2004 9:39 pm</h4>
    <div class="postbody"><span class="postbody">no, I am telling you that the code says to go that fast. The GBA is fine with doing a lot more then this (as I found out when doing a radar). The scrolling speed of the background is going as fast as you set it to go.... I told it to go one pixel per frame and it did that at the right speed.
<br/>
<br/>
you are telling to go 1 pixel every 2(power of 6) or 2(power of 8) frames which is 64 and 256 frames respectively (1 sec and 4 sec) which is very slow.
<br/>
<br/>
[quote="sajiimori"]
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_BG0HOFS = (bg0_x++) &gt;&gt; 6;
<br/>
REG_BG3HOFS = (bg0_x++) &gt;&gt; 8;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Do you realize that this will only move the foreground one pixel every 64 frames (x &gt;&gt; 6 == x / 64), which is less than a pixel a second?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"><br/><br/>Last edited by yaustar on Thu Jan 08, 2004 9:47 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#14578 - LOst? - Thu Jan 08, 2004 9:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">no, I am telling you that the code says to go that fast. The GBA is fine with doing a lot more then this (as I found out when doing a radar). The scrolling speed of the background is going as fast as you set it to go.... I told it to go one pixel per frame and it did that at the right speed.
<br/>
<br/>
you are telling to go 1 pixel every 2(power of 6) or 2(power of 8) frames which is 64 and 256 frames respectively (1 sec and 4 sec) which is very slow.</td> </tr></table><span class="postbody">
<br/>
<br/>
Upload the ROM and let me see O.o;;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14580 - LOst? - Thu Jan 08, 2004 9:51 pm</h4>
    <div class="postbody"><span class="postbody">[quote="yaustar"]</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">no, I am telling you that the code says to go that fast. The GBA is fine with doing a lot more then this (as I found out when doing a radar). The scrolling speed of the background is going as fast as you set it to go.... I told it to go one pixel per frame and it did that at the right speed.
<br/>
<br/>
you are telling to go 1 pixel every 2(power of 6) or 2(power of 8) frames which is 64 and 256 frames respectively (1 sec and 4 sec) which is very slow.
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_BG0HOFS = (bg0_x++) &gt;&gt; 6;
<br/>
REG_BG3HOFS = (bg0_x++) &gt;&gt; 8;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Do you realize that this will only move the foreground one pixel every 64 frames (x &gt;&gt; 6 == x / 64), which is less than a pixel a second?
<br/>
</span></td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
I can't do anything more bacause of the slowdown. Therefore I start to think that something is wrong with my compiler. The only way to see if my compiler is wrong, is to see your compiled ROM
<br/>
<br/>
Please upload</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14581 - yaustar - Thu Jan 08, 2004 9:52 pm</h4>
    <div class="postbody"><span class="postbody">Copy and paste that code that I wrote and you should see for yourself the difference..
<br/>
<br/>
edit: this it running at 1 pixel per frame
<br/>
<a href="http://madsims.net/~yaustarc/misc/z.zip" target="_blank">http://madsims.net/~yaustarc/misc/z.zip</a><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14582 - LOst? - Thu Jan 08, 2004 10:08 pm</h4>
    <div class="postbody"><span class="postbody">So, if that's the correct way of doing the palette DMA copy and moving the background, then this is the final result:
<br/>
<br/>
<a href="http://logotypes.se/tmp/fade.bin" target="_blank">http://logotypes.se/tmp/fade.bin</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14583 - yaustar - Thu Jan 08, 2004 10:11 pm</h4>
    <div class="postbody"><span class="postbody">I still dont understand why you are coping the palette every loop though.....I look at in a sec after I stop rendering my animation
<br/>
<br/>
edit: now i see..it may be easier to use the register REG_BLD_MOD to do fade to black and white though<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14584 - jma - Thu Jan 08, 2004 10:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
jma,
<br/>
<br/>
Is this an adequate test? 
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">        DMACPY32((u8*)EXTERNAL_RAM+1,
<br/>
                 EXTERNAL_RAM,
<br/>
                256000);
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
Sajiimori,
<br/>
<br/>
Yes and no :) -- Yes, because this is much like what the OP had in mind. No for me, because your destination address is not VRAM.
<br/>
<br/>
Both will show 2 things: the DMA is blocking the CPU and that it runs asyncronously. Meaning that you either want to wait for the DMA to finish or at the very least not write to the same location. 
<br/>
<br/>
<span style="font-style: italic">Edit: that may sound contradictory... what I mean by 'blocking' is that the DMA is slowing down the CPU, not halting it.</span>
<br/>
<br/>
To the OP (Lost?):
<br/>
<br/>
Do not use the DMA to transfer sprite data to OAM or palette data. It is a small amount of data and is faster to code a very tight loop (IMHO) if your source data is in IWRAM. Sample using THUMB:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  mov R0,#0x20 ; 512 bytes
<br/>
  mov R1,#5
<br/>
  lsl R1,R1,#24 ; R1 = bg palette dest  
<br/>
  ldr R2,=source_address
<br/>
copy_sprite_data:
<br/>
  ldmia R2!,{r3-r6}
<br/>
  stmia R1!,{r3-r6}
<br/>
  sub r0,#1 ; 16 bytes per iteration
<br/>
  bgt copy_sprite_data</td> </tr></table><span class="postbody">
<br/>
<br/>
Using a C loop should be almost as fast. In Dragon BASIC, this is what I do and it is very quick.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14586 - yaustar - Thu Jan 08, 2004 10:53 pm</h4>
    <div class="postbody"><span class="postbody">jma: you say that palette/sprite data is too small amount of data to be used by DMA (effectively). What would you considered a reasonable/large amount of data?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14587 - tepples - Thu Jan 08, 2004 10:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jma wrote:</b></span></td> </tr> <tr> <td class="quote">Do not use the DMA to transfer sprite data to OAM or palette data. It is a small amount of data and is faster to code a very tight loop (IMHO) if your source data is in IWRAM.</td> </tr></table><span class="postbody">
<br/>
The ldmia/stmia copy does not run faster than DMA because unlike DMA, a CPU copy still needs to repeatedly read the instructions in the loop. The only time a 'stmia' loop runs faster than DMA is in an unrolled memset() type loop because DMA needs to reread the source location.
<br/>
<br/>
Setup time on DMA isn't so bad either: three 32-bit loads (src, dst, count/control) and a 'stmia' to the DMA3 register base.
<br/>
<br/>
Bottom line: DMA is faster for copying. 'Stmia' is faster for clearing.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14590 - LOst? - Fri Jan 09, 2004 1:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">jma: you say that palette/sprite data is too small amount of data to be used by DMA (effectively). What would you considered a reasonable/large amount of data?</td> </tr></table><span class="postbody">
<br/>
<br/>
256 words of data isn't much. Even Microsoft Windows' GDI can handle more palette entries faster than GBA's DMA</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14593 - yaustar - Fri Jan 09, 2004 1:45 am</h4>
    <div class="postbody"><span class="postbody">huh?
<br/>
<br/>
Jma was soaying that small chunks of data shouldnt be used be dma but normal c loops. I was asking what 'would' be a large chunk of data to say 'oh this should use the DMA insted.'<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14603 - Miked0801 - Fri Jan 09, 2004 3:38 am</h4>
    <div class="postbody"><span class="postbody">My cut-off (in C Code) is around 32 bytes - though that probably is a bit high.  I just do an assign of a structure to get the compiler to use ldmia/stdmia correctly:
<br/>
<br/>
typedef struct _FOO32
<br/>
{
<br/>
     u32 word1;
<br/>
     u32 word2;
<br/>
     u32 word3;
<br/>
     u32 word4;
<br/>
} FOO32;
<br/>
<br/>
FOO32 first, second;
<br/>
<br/>
first = second;
<br/>
<br/>
and that will do a 16-byte copy for you in C code as efficiently as the thumb system will allow.
<br/>
<br/>
Mike</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14606 - sajiimori - Fri Jan 09, 2004 7:05 am</h4>
    <div class="postbody"><span class="postbody">jma,
<br/>
<br/>
Why does this code draw zero pixels, regardless of the source/destination/size?  If the transfer merely slows the processor, shouldn't at least a few pixels get drawn?
<br/>
<br/>
Maybe it's time you present some evidence for your argument that DMA transfers do not fully block the CPU -- especially considering that you are contradicting conventional GBA wisdom (i.e. GBATEK).  =)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
main()
<br/>
{
<br/>
    u16* p = VIDEO_MEMORY;
<br/>
    REG_DISPCNT = MODE_3 | BG2_ENABLE;
<br/>
<br/>
    DMACPY32((u8*)EXTERNAL_RAM+1,
<br/>
             EXTERNAL_RAM,
<br/>
             256000/4);
<br/>
<br/>
    while(REG_DM3CNT &amp; DMA_ENABLE)
<br/>
        *p++ = 0x1f;
<br/>
<br/>
    while(1);
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14617 - jma - Fri Jan 09, 2004 6:57 pm</h4>
    <div class="postbody"><span class="postbody">This was just my experience when coding a ROM. At the time I was only using an emulator and not actual hardware, though, so perhaps the emulator (VBA) was wrong.
<br/>
<br/>
When I get home I'll try making something to test it and see what happens... If I am wrong, I'll be first in line to admit it, though :)
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
