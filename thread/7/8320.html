<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Array of pointers - how? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Array of pointers - how?</h2>
<div id="posts">
<div class="post">
    <h4>#69178 - Janekxx - Sun Jan 29, 2006 12:38 am</h4>
    <div class="postbody"><span class="postbody">Hi, I'm coding my 3D game for ARM platform (not GBA, but old Sony Jxx phones) and I ecountered first problem I can't solve :)
<br/>
<br/>
I have few 3D models to use in scene.
<br/>
To transform them (rotate, etc.) I pass pointer to array in every function.
<br/>
Here is the problem:
<br/>
<br/>
Can I create array that contain pointers and how?
<br/>
<br/>
It's needed because I don't want to write:
<br/>
do_sth(int *adr_of_model);
<br/>
<br/>
... for every model, but I want to use loop like this:
<br/>
for (a=5; a&gt;0; a--){
<br/>
    tmp = array_of_pointers[a];
<br/>
    do_sth(int *tmp);
<br/>
}
<br/>
<br/>
<br/>
Is that possible? What are the mistakes in my example?
<br/>
<br/>
I'm new in C, sorry for lame question ;)<br/>_________________<br/><a class="postlink" href="http://sony.int.pl" target="_blank">sony.int.pl</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69189 - keldon - Sun Jan 29, 2006 2:14 am</h4>
    <div class="postbody"><span class="postbody">You would normally do the following:
<br/>
<br/>
(1) Declare a large set of memory for data as allocation takes time
<br/>
(2) Manage your own data in a layer on top of the available allocation routines
<br/>
<br/>
One thing to remember is that when you tranform you usually do not want to keep these transformations for the next frame so they are usually temporary. However there are some global transfomorations that must be applied to the global T matrix for the object.
<br/>
<br/>
I am not sure how you have worked with 3d graphics before but remember the memory management issues with C/C++/asm.
<br/>
<br/>
One way to create array of 'pointers':
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   void **ptrArray = malloc (sizeof(void *) * ARRAYLEN);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Just remember that pointers only point to addresses. They are 4 bytes long since the only data they store is the address of where the data is stored. You are likely to allocate an array of structs with empty data and later assign and set data to the elements in that array.
<br/>
<br/>
I would suggest having a think about memory management and how that effects your current routine and way of working. Figure out where memory would leak without garbage collection, and know what garbage collection is and how it generally works.
<br/>
<br/>
Actually what is your current knowledge of 3d graphics - and how did you learn and use it. That may direct the information to you better.
<br/>
<br/>
EDIT: changed * to **</span><span class="gensmall"><br/><br/>Last edited by keldon on Sun Jan 29, 2006 9:22 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#69194 - poslundc - Sun Jan 29, 2006 4:08 am</h4>
    <div class="postbody"><span class="postbody">Array of integers:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int     a = 5;
<br/>
int     b = 6;
<br/>
int     c;
<br/>
<br/>
int     array[2];
<br/>
<br/>
array[0] = a;
<br/>
array[1] = b;
<br/>
<br/>
c = array[0] + array[1];</td> </tr></table><span class="postbody">
<br/>
<br/>
Array of pointers to integers:
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int     a = 5;
<br/>
int     b = 6;
<br/>
int     c;
<br/>
<br/>
int     *array[2];
<br/>
<br/>
array[0] = &amp;a;
<br/>
array[1] = &amp;b;
<br/>
<br/>
c = *array[0] + *array[1];</td> </tr></table><span class="postbody">
<br/>
<br/>
Note that when you are using pointers there are many more opportunities for silent errors to manifest themselves. Such as, if in the above example a and b had been declared inside a function, and array was used after the completion of that function, then the pointers stored in array would no longer be valid, although you could still dereference them with undefined results.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69215 - keldon - Sun Jan 29, 2006 10:06 am</h4>
    <div class="postbody"><span class="postbody">Note the difference between mine and postlundc's (Dan) example. In Dan's example the array is declared in a static way (if that is the correct term). With my example your array is allocated after compilation and on the fly - although an array declared in a function is done on the fly it is removed when the function returns.
<br/>
<br/>
You will need a temporary array of vertices when you perform your transformations. You can have an array declared in a function - which may be better. However your data structure may not make it easy to just allocate an array of vertices in a function - especially if you store them in a struct/class allowing different sizes for your vertex array, which you probably will.
<br/>
<br/>
code to create an array of vertices using malloc and new
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   Vertex *vertexArray = malloc (sizeof(Vertex) * ARRAYLEN);
<br/>
   // or 
<br/>
   Vertex *vertexArray = new Vertex[ARRAYLEN];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
code to create an array of pointers without using void, like I showed you before using malloc and new
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   Vertex **vertexArrayPtr = malloc (sizeof(Vertex*) * ARRAYLEN); 
<br/>
   // or
<br/>
   Vertex **vertexArrayPtr = new Vertex*[ARRAYLEN];
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69263 - Janekxx - Sun Jan 29, 2006 6:14 pm</h4>
    <div class="postbody"><span class="postbody">Thanks a lot! 
<br/>
Now I understand how simply it can be done. :)<br/>_________________<br/><a class="postlink" href="http://sony.int.pl" target="_blank">sony.int.pl</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
