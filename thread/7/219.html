<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Using assert()s - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>C/C++ > Using assert()s</h2>
<div id="posts">
<div class="post">
    <h4>#1340 - Vortex - Thu Jan 16, 2003 9:08 pm</h4>
    <div class="postbody"><span class="postbody">Is there any way to use assert() statements in GBA programs ?
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1360 - tepples - Fri Jan 17, 2003 12:09 am</h4>
    <div class="postbody"><span class="postbody">On the GBA, you need a special assert library because the standard C assert() writes to stdout, but the GBA doesn't have a stdout unless you've linked in a serial library.
<br/>
<br/>
That said, there do exist some assert libraries for GBA.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1376 - Touchstone - Fri Jan 17, 2003 11:00 am</h4>
    <div class="postbody"><span class="postbody">You could easily write your own assert macro. For instance an assert that change the color of the screen by disabling all rendering to screen and setting background palette 0 to a specific color. Something like this maybe:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#ifdef _RELEASE
<br/>
   #define assert(_exp, _col)
<br/>
#else
<br/>
   #define assert(_exp, _col) if(!(_exp)) {disable rendering; set background to _col; while(1);}
<br/>
#endif</td> </tr></table><span class="postbody">
<br/>
And use like this:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">assert(Character.pos.x &gt; 0, 0x7fff); // Halt game and set screen to white if character is out of bounds</td> </tr></table><span class="postbody">
<br/>
If you have some sort of text print you could ofcourse use that together with the macros __FILE__ and __LINE__ (and __FUNCTION__ if using gcc). I never use asserts myself though.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1384 - col - Fri Jan 17, 2003 2:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Touchstone wrote:</b></span></td> </tr> <tr> <td class="quote">I never use asserts myself though.</td> </tr></table><span class="postbody">
<br/>
<br/>
Wow, what technique have you found thats better for putting a 'free' safety net into your code?
<br/>
<br/>
Assertions save me loads of time that would otherwise be spent wrestling with gdb or filling my code with ugly print statements and #ifdef/#endif pairs
<br/>
<br/>
I guess you never make design or coding errors ;-) 
<br/>
<br/>
cheers
<br/>
<br/>
col</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1391 - Touchstone - Sat Jan 18, 2003 3:06 am</h4>
    <div class="postbody"><span class="postbody">I usually go a round against the debugger. In combination with printf's if needed. :)<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1647 - Paul Shirley - Tue Jan 21, 2003 12:41 am</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:42 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#1649 - Touchstone - Tue Jan 21, 2003 1:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Paul Shirley wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>col wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Touchstone wrote:</b></span></td> </tr> <tr> <td class="quote">I never use asserts myself though.</td> </tr></table><span class="postbody">
<br/>
<br/>
Wow, what technique have you found thats better for putting a 'free' safety net into your code?
<br/>
<br/>
Assertions save me loads of time that would otherwise be spent wrestling with gdb or filling my code with ugly print statements and #ifdef/#endif pairs
<br/>
<br/>
I guess you never make design or coding errors ;-) 
<br/>
<br/>
col</span></td> </tr></table><span class="postbody">
<br/>
<br/>
When employers ask for a code sample this is one of the things they're looking for. Claiming to never use them is like saying 'I'm a cowboy, don't employ me'.
<br/>
<br/>
I code mine to dump messages to the emulator print hook. I then repeat the message to a dedicated text driver reserved for debug info. Saved my bacon repeatedly.</span></td> </tr></table><span class="postbody">
<br/>
Claiming assert macros is the only way to find bugs is like saying 'I'm incompetent, don't employ me'.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1653 - Paul Shirley - Tue Jan 21, 2003 2:44 am</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:42 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#1657 - Paul Shirley - Tue Jan 21, 2003 3:56 am</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:43 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#1667 - Touchstone - Tue Jan 21, 2003 9:57 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Paul Shirley wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Touchstone wrote:</b></span></td> </tr> <tr> <td class="quote">Claiming assert macros is the only way to find bugs is like saying 'I'm incompetent, don't employ me'.</td> </tr></table><span class="postbody">
<br/>
<br/>
Only one person suggested that - you. Please carry on and bury yourself further.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Mr. Shirley,
<br/>
<br/>
I don't agree with you. I said I had never used assert macros but I have absolutely never ever suggested that using them is the only way to find bugs, like you are stating in the quote above. I fail to see where you got that from, could you please tell me. You also imply that it's only programmers who think they never make mistakes that doesn't use assert macros. This is not true either. Just because I don't use assert macros doesn't mean I'm not checking for bad parameters, I just don't do it with the assert macro. If using other techniques than the assert macro make me a 'cowboy' then fine but seriously, if a company only look for the usage of assert when reviewing work-samples I wouldn't want to work for that company anyways.
<br/>
<br/>
This reminds me of the poster with the quote "Arguing on the internet is like competing in the special olympics. Even if you win you are still a retard." Thanks for making it so obvious and for making me look like a fool.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1691 - col - Tue Jan 21, 2003 5:02 pm</h4>
    <div class="postbody"><span class="postbody">One thing is that when there are multiple programmers working on the same code, printf's could start to cause problems - eg. finding them all to comment them out etc...
<br/>
<br/>
with asserts you just turn them off!
<br/>
<br/>
If i was choosing between two candidates for a job and the only difference in their code was that one used assertions and the other used printf instead, I know which candidate i would choose...
<br/>
<br/>
cheers
<br/>
<br/>
col.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1692 - Touchstone - Tue Jan 21, 2003 5:52 pm</h4>
    <div class="postbody"><span class="postbody">I think that most often you'd want a more graceful solution to a erroneous parameter than what the assert macro has to offer.
<br/>
<br/>
If you turn asserts off you'd still need to verify that your parameter is valid before using it so I figure, why not extend that verification to include whatever assert does. I think that's the reason why I've never used asserts.
<br/>
<br/>
If I was choosing between two candidates for a job, one of them used asserts while the other had code that could recover from errors I think I'd go for the error recoverable code-applicant.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1695 - Sweex - Tue Jan 21, 2003 6:21 pm</h4>
    <div class="postbody"><span class="postbody">Hehe! Let's join this discussion!
<br/>
<br/>
I don't agree with "If you turn asserts off you'd still need to verify that your parameter is valid before using it so I figure, why not extend that verification to include whatever assert does".
<br/>
<br/>
No offense, but if you still verify parameters when you turn off asserts, you've missed the point of assertions IMHO. 
<br/>
<br/>
You turn off assertions when you are doing a "release build", when you are sure your code is working correctly (and thus the parameters passed to functions are always correct)!
<br/>
<br/>
(btw., I'm using my own assert which outputs a nice textscreen when one fails.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1703 - grumpycat - Tue Jan 21, 2003 8:13 pm</h4>
    <div class="postbody"><span class="postbody">I use asserts, but in my career I have seen lots of software failures due to bad asserts.  Some asserts are born bad - generally when an engineer misunderstands the data structures or the API... and sometimes they're in codepaths that end up slipping through the unit testing and SQA process.  The most common case I have found is that as a body of code evolves and different engineers add to it, some asserts stop being valid - an invariant becomes variable.  A "this pointer will never be NULL" evolves into, "sure it can...", but the assert is dug deep in a module that has not kept pace with the progress of the rest of the system, and sooner or later it trips.
<br/>
<br/>
I've also seen asserts used by lazy programmers trying to seem not lazy:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">p = malloc(sizeof(foo_t));
<br/>
assert(p != NULL);</td> </tr></table><span class="postbody">
<br/>
Awful.
<br/>
<br/>
I don't belive the "asserts are good and you suck if you don't use them" argument.  That's pretty arrogant.  I also wouldn't choose an engineer based on whether they used assert or not.
<br/>
<br/>
I would certainly never hire an engineer based on a code fragment.  Sit them down and ask them to solve some problems, don't measure a candidate based on how neat and tidy and prettily indented their code is.  Talk to them.  How do they design?  How do they debug?  Do they use source control?  How well do they argue a position?  Are they a team player?  But, "Do they use 8-space tabs and asserts?"  Give me a break.
<br/>
<br/>
Maybe this is a contractor thing?  I've never been on that side, so maybe contracting is all about code samples...  but for full-time engineers, I'd walk away if I was asked for actual code.
<br/>
<br/>
We can get very personal about what software engineering tools and processes are best (vi vs. emacs, perl vs. python, Coke vs. Pepsi), but this isn't football, and there's more to it than "my team rules and your team sucks".
<br/>
<br/>
Q. Who is the better engineer: Touchstone or Paul Shirley?
<br/>
<br/>
I can't answer that.  I won't even try.
<br/>
<br/>
Grumpy.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1723 - Touchstone - Tue Jan 21, 2003 11:47 pm</h4>
    <div class="postbody"><span class="postbody">Thank you Grumpy for giving your opinions on this matter. But what's more important, thank you for not taking any side but rather expressing an independent view the way you did.
<br/>
<br/>
I feel that what you've written is basically what I've been trying to say with my last two posts but I couldn't make myself understood correctly. I'm sure asserts are very useful but I don't think it's fair to assume that someone who doesn't use asserts is a bad programmer, there's much more to it.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1730 - Splam - Wed Jan 22, 2003 3:49 am</h4>
    <div class="postbody"><span class="postbody">No asserts for me either ;)
<br/>
<br/>
I'm not going to waffle about why because it's just personal choice and coding style.  I could say I know enough about what I'm doing before I start coding not to need them but then someone would tell me I was stupid :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3532 - mantrid - Wed Feb 26, 2003 7:13 pm</h4>
    <div class="postbody"><span class="postbody">Asserts have been very useful for me when porting MME. Mine look like this:
<br/>
<br/>
#define UB_ASSERT(exp) (void)( (exp) || (dprintf("ASSERTION: (" #exp ") @ " __FILE__ ":%d\n", __LINE__), 0) )
<br/>
<br/>
#define LOG_BUFF_SIZE 2000
<br/>
<br/>
char log_buff[LOG_BUFF_SIZE];
<br/>
<br/>
<br/>
static void dprint(const char *sz) {
<br/>
	asm volatile
<br/>
		(
<br/>
			"mov r2, %0\n"
<br/>
			"ldr r0, =0xc0ded00d	\n"
<br/>
			"mov r1, #0\n"
<br/>
			"and r0, r0, r0\n"
<br/>
			: /* No output */ 
<br/>
			: "r" (sz) 
<br/>
			: "r0", "r1", "r2"
<br/>
		); 
<br/>
}
<br/>
<br/>
Copied that dprint off the visualboy advance site.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
