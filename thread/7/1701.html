<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Please Help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > Please Help</h2>
<div id="posts">
<div class="post">
    <h4>#8631 - sho - Wed Jul 16, 2003 11:28 pm</h4>
    <div class="postbody"><span class="postbody">I have small problem. Im trying compile this code in devkitadv
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
cpixel.h:
<br/>
#include &lt;gba/gba.h&gt;
<br/>
#include &lt;gba/screenmode.h&gt;
<br/>
#ifndef CPIXEL_H
<br/>
#define CPIXEL_H
<br/>
class cpixel
<br/>
{
<br/>
protected:
<br/>
   int x, y;
<br/>
<br/>
public:
<br/>
   cpixel(int ax = 0, int ay = 0) : x(ax), y(ay) {}
<br/>
<br/>
   void draw();
<br/>
};
<br/>
#endif
<br/>
/***********************************************************/
<br/>
<br/>
cpixel.cpp:
<br/>
#include "cpixel.h"
<br/>
void cpixel::draw()
<br/>
{
<br/>
   ::theBackBuffer[x + y * 240] = RGB(0, 31, 0);
<br/>
}
<br/>
/***********************************************************/
<br/>
<br/>
main.cpp:
<br/>
#include "cpixel.h"
<br/>
int main()
<br/>
{
<br/>
   SetMode(MODE_3 | BG2_ENABLE);
<br/>
<br/>
   cpixel pixel(10, 100);
<br/>
<br/>
   pixel.draw();
<br/>
<br/>
   return 0;
<br/>
}
<br/>
/***********************************************************/
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
When im compile this code i recive this erors:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccHgD0P5.o(.data+0x0): multiple definition of `theVideoBuffer'
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccCR5EUV.o(.data+0x0): first defined here
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccHgD0P5.o(.data+0x4): multiple definition of `theBackBuffer'
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccCR5EUV.o(.data+0x4): first defined here
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccHgD0P5.o(.data+0x8): multiple definition of `theScreenPalette'
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccCR5EUV.o(.data+0x8): first defined here
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccHgD0P5.o: In function `PlotPixel(int, int, int, unsigned short)':
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccHgD0P5.o(.text+0x0): multiple definition of `PlotPixel(int, int, int, unsigned short)'
<br/>
/cygdrive/c/DOCUME~1/sho/USTAWI~1/Temp/ccCR5EUV.o(.text+0x0): first defined here
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Im using devkitadv latest version. 
<br/>
What im doing wrong ?
<br/>
Thx for help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8634 - Lord Graga - Thu Jul 17, 2003 12:06 am</h4>
    <div class="postbody"><span class="postbody">Try to find two places in your code that defines/declares stuff like "theVideoBuffer"/etc.
<br/>
Else, try to check if you included &lt;gba/gba.h&gt; and/or &lt;gba/screenmode.h&gt;  twice or more ;)
<br/>
<br/>
Best regards, the sleepy nurgling</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8637 - sho - Thu Jul 17, 2003 12:23 am</h4>
    <div class="postbody"><span class="postbody">Im only one time include gba.h and screenmode.h files. Im cheked this files and SetMode and theBackbufer, theVideoBuffer are declared in screenmode.h. No other declaration or definition.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8641 - night_ - Thu Jul 17, 2003 2:37 am</h4>
    <div class="postbody"><span class="postbody">where do you define "theVideoBuffer", "theBackbuffer"...
<br/>
Where do you define the Plotpixel function?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8643 - Nessie - Thu Jul 17, 2003 3:31 am</h4>
    <div class="postbody"><span class="postbody">I wouldn't declare variables and assign them values in your .h file, you can use a #define though.  Or you can declare your variable in the .h ( try using the extern keyword), but do the actual assignment in a .cpp file...
<br/>
<br/>
Something like:
<br/>
<br/>
(my.h)
<br/>
extern u16 *theBackBuffer;
<br/>
<br/>
(some.cpp)
<br/>
#include "my.h"
<br/>
theBackbuffer = 0xblahblah;
<br/>
<br/>
Now, anywhere you include (my.h), you can have access to theBackBuffer.  I probably wouldn't structure it this way, but if you just want to fix your problem and not get any coding style points, I guess do something like this. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8647 - Quirky - Thu Jul 17, 2003 8:45 am</h4>
    <div class="postbody"><span class="postbody">You shouldn't add unecessary #includes to a .h file - includes should really only go in the .c or .cpp that needs them. In your code, you include cpixel.h in 2 places, and this file itself includes gba.h and screenmode.h.
<br/>
<br/>
You don't need to include gba.h in the cpixel header as you are not using anything gba specific in that particular file, similarly you should not be including screenmode.h in there either. 
<br/>
<br/>
These should be included in the cpixel implementation (.cpp) file - but only those headers that define theBackBuffer and the RGB() macro, which may be both gba and screenmode header files or one or the other (though I guess theBackBuffer is defined in gba.h and screenmode has RGB()?). Then in main.cpp, you should include cpixel.h and the header that defines SetMode().
<br/>
<br/>
I would recommend getting out of the habit of #include-ing in header files as much as possible. And only include the headers that you actually need in the implementation files.
<br/>
<br/>
Having said that, there are times when you will need to #include in a header file. In this case, you should make use of the "#ifndef _whatever_h #define _whatever_h" trick, but don't rely on that so you can include everything everywhere.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8649 - sho - Thu Jul 17, 2003 10:24 am</h4>
    <div class="postbody"><span class="postbody">Thx for help. Im now include screenmode.h and gba.h in csprite.cpp and include screenmode.h int main.cpp becouse im use in this file SetMode.
<br/>
Im checked gba.h and screenmode.h and both have prepocesor commands
<br/>
#ifndef blabla_h 
<br/>
#define blabla_h
<br/>
 code
<br/>
#endif
<br/>
<br/>
but i have stil this same errors.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8660 - Nessie - Thu Jul 17, 2003 1:42 pm</h4>
    <div class="postbody"><span class="postbody">I used to have the same problems...I figured that the preprocessor command setup you are using would save me from this kind of multiple defintion type bug, but it doesn't really work that way with any of the compilers I've used.  Still, using #ifndef guards around your #include's is a good idea for helping compile speed, and as someone already mentioned, not #including files you don't even need is just generally a good idea.
<br/>
<br/>
Seriously, if you have variable declarations and assigments in you .h file, you are likely going to have problems.  The simplest way to fix this based on what I think you are currently doing is to either use a #define (which is safe in the .h file) or do your assignment in a .cpp file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9755 - sajiimori - Sat Aug 16, 2003 5:58 am</h4>
    <div class="postbody"><span class="postbody">When I say:
<br/>
<br/>
int x;
<br/>
<br/>
I'm saying "create an int right here, right now, called x".
<br/>
<br/>
When I say:
<br/>
<br/>
extern int x;
<br/>
<br/>
I'm saying "there is an int somewhere out there called x".
<br/>
<br/>
So, if you put "int x;" in a header file, and include the header file in more than one place, you're creating two ints called x.  Some linkers automatically merge them together and only create one int, but that is a deprecated feature of C and should not be used.
<br/>
<br/>
In short: headers should never create variables.  Declare your variables "extern" in headers, and create the actual variable in a .c or .cpp file.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
