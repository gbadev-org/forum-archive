<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>C++ compiler for mac? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > C++ compiler for mac?</h2>
<div id="posts">
<div class="post">
    <h4>#16526 - shaktool - Wed Feb 18, 2004 10:18 pm</h4>
    <div class="postbody"><span class="postbody">I'm currently using <a class="postlink" href="http://gnufoo.org/gbasdk/gbasdk.html" target="_blank">http://gnufoo.org/gbasdk/gbasdk.html</a> (minus the whole SGADE thing) to compile my games written in C, but I've decided I want to use C++ for my next game, which will have a variable number of many different kinds of entities that all need to interact with each other and stuff like that...
<br/>
<br/>
However, the gcc that comes with that GBASDK will not compile C++.  Does anybody know of a cross-compiler for Mac (or, you know, Unix) that will compile C++ for GBA?  Or if not, does anybody have any idea how I could compile one, based on DevKit Advance or something?
<br/>
<br/>
Do not assume that I know what I'm doing :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16527 - poslundc - Wed Feb 18, 2004 11:27 pm</h4>
    <div class="postbody"><span class="postbody">Use g++ instead of gcc to compile C++ code.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16528 - shaktool - Wed Feb 18, 2004 11:50 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, that's the thing.  I don't have g++.  I've got: 
<br/>
addr2line
<br/>
ar
<br/>
as
<br/>
c++filt
<br/>
cpp
<br/>
gasp
<br/>
gcc
<br/>
gccbug
<br/>
gcov
<br/>
ld
<br/>
nm
<br/>
etc...
<br/>
<br/>
All that is in /usr/local/gbasdk/arm-agb-elf/bin/
<br/>
<br/>
Is there a version of g++ for Unix out there that I'm missing?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16533 - tepples - Thu Feb 19, 2004 12:27 am</h4>
    <div class="postbody"><span class="postbody">Because of the size of the C++ compiler and its standard library, some GCC distributions put C++ support in a separate library. Go back to the site where you downloaded the cross-GCC distribution and see if it offers a C++ package. Or find another cross-GCC distribution. Or roll your own based on the GCC source code from GNU.org.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16534 - poslundc - Thu Feb 19, 2004 12:28 am</h4>
    <div class="postbody"><span class="postbody">Hm, yeah, this isn't the only area I've noticed where the GBASDK seems to be incomplete. :P
<br/>
<br/>
I think you may be in luck; there's another OS X distribution of gcc available from velvetfr (<a class="postlink" href="http://velvetfr.ath.cx/tools/gba.html" target="_blank">http://velvetfr.ath.cx/tools/gba.html</a> at the bottom of the page), and it's even a newer version.
<br/>
<br/>
If that doesn't work for you, if you want g++ I suppose you could always try recompiling gcc from the sources, but that's not exactly a fun way to spend an afternoon.
<br/>
<br/>
Me, I'm still using GBASDK. Talk about lazy!
<br/>
<br/>
Good luck,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16546 - shaktool - Thu Feb 19, 2004 6:09 am</h4>
    <div class="postbody"><span class="postbody">Well, yeah, it looked good, until I tried to run it... Even compiling my old C code (which worked fine before) in the new gcc didn't work, let alone compiling it as C++ with g++.  I got a few hundred errors like this.  
<br/>
<br/>
foo.c:2:Unknown pseudo-op: .global
<br/>
foo.c:2:Rest of line ignored. 1st junk character valued 66 (B).
<br/>
foo.c:3:Expected comma after segment-name
<br/>
foo.c:3:Rest of line ignored. 1st junk character valued 32 ( ).
<br/>
foo.c:4:Unknown pseudo-op: .type
<br/>
foo.c:4:Rest of line ignored. 1st junk character valued 66 (B).
<br/>
foo.c:5:Unknown pseudo-op: .size
<br/>
<br/>
At least it tried to compile the C++ way, which is better than the errors I was getting before (No C++ compiler installed on this system!)  It even got far enough to include some files that were #included in the code...
<br/>
<br/>
I noticed that the filename of this new gcc is arm-thumb-elf-gcc, which isn't quite the same as the old arm-agb-elf-gcc, which may or may not be significant... the new distribution also seems to be lacking an assembler and linker, or something... perhaps combining the assembler and linker from one package with the compiler from the other was a bad idea... man, I wish I knew what I was doing... It wasn't too long ago that I had no idea what the makefile did...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16547 - poslundc - Thu Feb 19, 2004 6:19 am</h4>
    <div class="postbody"><span class="postbody">Phroo, that seems weird... it almost looks as if it is generating the proper assembly code, but then calling the incorrect version of GAS or something.
<br/>
<br/>
In any case, this is out of my league. I'm going to suggest that you do a clean install of gcc (the newer version I suppose, since you want to use g++) and see if you can get it just compiling simple programs without using the compilcated makefile (I know the one with GBASDK, while very well-written, can complicate things more than it helps when you're trying to debug your compile process).
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16590 - shaktool - Fri Feb 20, 2004 1:41 am</h4>
    <div class="postbody"><span class="postbody">No luck yet, although I've tried a bunch of things.  Some of things I tried ALMOST worked... like trying to compile the Linux version of the DevKit Advance source code with Make, or Babelfishing this page:
<br/>
<a class="postlink" href="http://home.r00.itscom.net/top/gbcube/buildtools.html" target="_blank">http://home.r00.itscom.net/top/gbcube/buildtools.html</a>
<br/>
But I always got to some sort of error that I didn't know what to do about.  It's really too bad that it's so hard to find a C++ GBA compiler for Mac... 
<br/>
P.S. running the new gcc without a makefile causes the same errors... so I don't think it's assembling anything incorrectly, because it doesn't even get far enough to have anything to assemble.  Those ARE suspicious error messages, though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16612 - Touchstone - Sat Feb 21, 2004 12:05 am</h4>
    <div class="postbody"><span class="postbody">Check out this page, <a class="postlink" href="http://www.deadcoderssociety.tk/" target="_blank">http://www.deadcoderssociety.tk/</a>, in the GP32 section you can find an ARM gcc crosscompiler, I think it has C++ support.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16642 - shaktool - Sat Feb 21, 2004 8:53 pm</h4>
    <div class="postbody"><span class="postbody">Whee!  Thanks, Touchstone!
<br/>
<br/>
I'm still getting errors when I try to run g++, but they sound like errors I might be able to deal with, and the gcc that came with it works like a charm, which is promising.  I think I'm okay now.
<br/>
<br/>
:)
<br/>
<br/>
-Shaktool</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16680 - shaktool - Sun Feb 22, 2004 6:40 pm</h4>
    <div class="postbody"><span class="postbody">On second thought....
<br/>
<br/>
Alright, so I was able to get the version of g++ Touchstone suggested to compile my old C program as a .cpp file, and the resulting ROM ran perfectly.  Then I started to use some C++ features... you know, classes and virtual functions... and I got these errors at the linking stage:
<br/>
<br/>
./build/foo.o(.gnu.linkonce.d._ZTI5Grace+0x0): undefined reference to `vtable for __cxxabiv1::__si_class_type_info'
<br/>
./build/foo.o(.gnu.linkonce.d._ZTI6entity+0x0): undefined reference to `vtable for __cxxabiv1::__class_type_info'
<br/>
<br/>
Hmm, sounds to me like I need to be adding some C++ support libraries? Well, I made sure that, in my makefile,  I passed to the linker the paths to the lib directories that came with my newest version of gcc, like this:
<br/>
<br/>
STD_LIB_DIR2 = /usr/share/gp32/arm-elf/lib
<br/>
STD_LIB_DIR3 = /usr/share/gp32/lib/gcc-lib/arm-elf/3.0.4
<br/>
./build/foo.elf : ./build/crt0.o ./build/foo.o
<br/>
	/usr/share/gp32/arm-elf/bin/ld  ./build/crt0.o ./build/foo.o -o$@ -L$(STD_LIB_DIR2) -L$(STD_LIB_DIR3) -T ./lnkscript -lgcc
<br/>
<br/>
That didn't solve the problem.  Hmmm....! Hey, I remembered seeing something in the crt0.s file that said you should uncomment something to enable C++ support... like this:
<br/>
<br/>
@ Uncomment the following line to support C++ development.
<br/>
@ You also need to name your main C function the following:
<br/>
@    int main (void)  ...instead of... int AgbMain (void)
<br/>
@ Doing so will cause ~5500 bytes of c++ support code to be
<br/>
@ linked in with your project so do not enable c++ support
<br/>
@ unless you plan to use it.
<br/>
@ .equ __CPPSupport, 1
<br/>
<br/>
So I did, and I renamed my AgbMain to main.... Err... not only did that fail to solve my problem, it created tons of new errors... like this:
<br/>
<br/>
./build/NinjaParty.o(.gnu.linkonce.d._ZTI5Grace+0x0): undefined reference to `vtable for __cxxabiv1::__si_class_type_info'
<br/>
./build/NinjaParty.o(.gnu.linkonce.d._ZTI6entity+0x0): undefined reference to `vtable for __cxxabiv1::__class_type_info'
<br/>
/usr/share/gp32/lib/gcc-lib/arm-elf/3.0.4/libgcc.a(__main.o): In function `__do_global_dtors':
<br/>
__main.o(.text+0x74): undefined reference to `__EH_FRAME_BEGIN__'
<br/>
/usr/share/gp32/lib/gcc-lib/arm-elf/3.0.4/libgcc.a(__main.o): In function `__do_global_ctors':
<br/>
__main.o(.text+0xc4): undefined reference to `atexit'
<br/>
__main.o(.text+0x100): undefined reference to `__EH_FRAME_BEGIN__'
<br/>
/usr/share/gp32/lib/gcc-lib/arm-elf/3.0.4/libgcc.a(unwind-dw2-fde.o): In function `size_of_encoded_value':
<br/>
unwind-dw2-fde.o(.text+0x5c): undefined reference to `abort'
<br/>
/usr/share/gp32/lib/gcc-lib/arm-elf/3.0.4/libgcc.a(unwind-dw2-fde.o): In function `read_encoded_value_with_base':
<br/>
unwind-dw2-fde.o(.text+0x1d8): undefined reference to `abort'
<br/>
/usr/share/gp32/lib/gcc-lib/arm-elf/3.0.4/libgcc.a(unwind-dw2-fde.o): In function `__register_frame':
<br/>
unwind-dw2-fde.o(.text+0x274): undefined reference to `malloc'
<br/>
(snip)
<br/>
<br/>
Anyone got any ideas?
<br/>
<br/>
p.s. Is anyone interested in how my last game turned out? Perhaps I should donate it as a demo to gbadev...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
