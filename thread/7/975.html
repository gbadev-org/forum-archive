<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Size of a rom ? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Size of a rom ?</h2>
<div id="posts">
<div class="post">
    <h4>#4811 - ragefan - Thu Apr 10, 2003 2:59 pm</h4>
    <div class="postbody"><span class="postbody">Is there any way to read into the rom his real size without his dummy blocks (FF &amp; 00 bytes) at the end ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4825 - tepples - Fri Apr 11, 2003 2:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ragefan wrote:</b></span></td> </tr> <tr> <td class="quote">Is there any way to read into the rom his real size without his dummy blocks (FF &amp; 00 bytes) at the end ?</td> </tr></table><span class="postbody">
<br/>
<br/>
You mean from the PC or from the GBA?
<br/>
<br/>
If you're writing your own program and trying to append your assets to the end of the program, you'll have to scan ROM address space for a "signature" that marks the beginning of your data. This is faster if you make sure the size of the program is a multiple of 256 bytes.  You may want to take a look at <a class="postlink" href="http://www.pineight.com/gba/#gbfs" target="_blank">GBFS</a>.
<br/>
<br/>
If you're trying to shrink an existing binary, you'll just have to find how much dummy data is at the end, and then round the real ROM size up to a 32 KB boundary.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4831 - ampz - Fri Apr 11, 2003 8:13 am</h4>
    <div class="postbody"><span class="postbody">If you let the linker automatically include the data you wount get that kind of problems.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4832 - ragefan - Fri Apr 11, 2003 9:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ragefan wrote:</b></span></td> </tr> <tr> <td class="quote">Is there any way to read into the rom his real size without his dummy blocks (FF &amp; 00 bytes) at the end ?</td> </tr></table><span class="postbody">
<br/>
<br/>
You mean from the PC or from the GBA?
<br/>
<br/>
If you're writing your own program and trying to append your assets to the end of the program, you'll have to scan ROM address space for a "signature" that marks the beginning of your data. This is faster if you make sure the size of the program is a multiple of 256 bytes.  You may want to take a look at <a class="postlink" href="http://www.pineight.com/gba/#gbfs" target="_blank">GBFS</a>.
<br/>
<br/>
If you're trying to shrink an existing binary, you'll just have to find how much dummy data is at the end, and then round the real ROM size up to a 32 KB boundary.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
How to find that ? simply by deleting the FF or 00 at the end ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4847 - MrMr[iCE] - Sat Apr 12, 2003 6:53 am</h4>
    <div class="postbody"><span class="postbody">are you talking of the address in cart memory where the rom ends?<br/>_________________<br/>Does the corpse have a familiar face?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5130 - ragefan - Mon Apr 21, 2003 6:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MrMr[iCE] wrote:</b></span></td> </tr> <tr> <td class="quote">are you talking of the address in cart memory where the rom ends?</td> </tr></table><span class="postbody">
<br/>
yes ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5898 - Jason Wilkins - Mon May 12, 2003 3:47 pm</h4>
    <div class="postbody"><span class="postbody">If you are using that latest DevKit Advance R5, then the last address in the program image is stored in the variable 'extern char *__load_break_appended_ptr'
<br/>
<br/>
This value is NOT automatically updated if you add stuff at the end of the file, but that is easy enough to do.  I explain how to do that in another post, and will provide a tool soon.
<br/>
<br/>
One thing I forgot to mention in that post is that this value HAS to be updated for multiboot programs loaded into a cartridge because the variable is used to determine how much ROM is copied to EWRAM.<br/>_________________<br/><a href="http://devkitadv.sourceforge.net" target="_blank">http://devkitadv.sourceforge.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5905 - Sweex - Mon May 12, 2003 5:25 pm</h4>
    <div class="postbody"><span class="postbody">I'm quite curious now. Why do you want to append data at the end of a rom? Is it so that you won't have to recompile/link it all?
<br/>
<br/>
(Currently working on a imho nifty tool to get data into a ROM, including conversion. If it's finished (and reasonably) bugfree I'll release it...)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5906 - Jason Wilkins - Mon May 12, 2003 5:43 pm</h4>
    <div class="postbody"><span class="postbody">The possibilities are endless, and that is why I felt is was important enough to add support at a low level directly into the devkit.
<br/>
<br/>
The programming team could provide a bare ROM image to the artists, and a tool which appends artwork and other assets.  The artists then do not have to have a tool chain installed to test their work, they just run the appending program and get a usable ROM image.
<br/>
<br/>
A hobby developer would develop a game with a level editor, or some kind of random dungeon generator.  The custom appender program could then add the levels to the end of the ROM and the user could use their MBV2 cable or flash cart to get the game into their GBA.
<br/>
<br/>
The main purpose of appending assets instead of linking them is that it can be done dynamically and simply without providing object files and without requiring a toolchain.  These are the requirements when dealing with end users or members of a team that do not need a full compiler installed.  Even though an artists box could easily have a toolchain and a few scripts to make it easy, I think they would appreciate the speed.
<br/>
<br/>
For the hobby game developer, making games for people with Flashcarts and MVB2 cables, being able to do this without the 4MB download of agb-win-binutils-r5.zip is a huge win.
<br/>
<br/>
I guess you could just supply ld.exe, objcopy.exe, and a few scripts, but then, to follow the GPL, you would have to provide the source code as well.  Just use appended assets and all those considerations go away (did I mention it is faster as well).<br/>_________________<br/><a href="http://devkitadv.sourceforge.net" target="_blank">http://devkitadv.sourceforge.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5925 - Sweex - Tue May 13, 2003 12:14 am</h4>
    <div class="postbody"><span class="postbody">As I thought, mainly for appending data to it. Maybe I'll add that option to my tool as well then!:)
<br/>
<br/>
(As for those curious why I'm working on "another data tool"; It will automate all the conversions! Give it a directory, a conversion script (ini file) and a target and it will convert and add all files (that are newer than the ones in the archive))</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
