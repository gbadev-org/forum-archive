<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Relocatable code - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Relocatable code</h2>
<div id="posts">
<div class="post">
    <h4>#69696 - HyperHacker - Wed Feb 01, 2006 8:48 am</h4>
    <div class="postbody"><span class="postbody">I want to write a 'modular' program for DS. The idea is to be able to just load up a program into any random place in memory, and run it. This means the programs have to be relocatable, and not depend on being placed in a specific part of memory. How can I make such programs using DevkitPro?
<br/>
<br/>
Also is there a way to define a specific memory range for certain variables? Normally when you create variables, the compiler starts with the beginning of unused memory and puts them there. (Say your program takes up 0x02000000-0x020000FF, then if you define a byte variable it goes at 0x02000100, then a word variable will go at 0x02000102, etc.) How can I tell it to start putting them in a different part of memory? (Eg create some variables there, then add some statement that says to put the next one at 0x03000000, then 0x03000002, etc.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69716 - tepples - Wed Feb 01, 2006 2:47 pm</h4>
    <div class="postbody"><span class="postbody">Use section attributes. To learn how, see "Q: How do I put large (&gt; 16 KB) arrays into a program without it crashing?" in the <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=418" target="_blank">beginners' FAQ</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69755 - HyperHacker - Wed Feb 01, 2006 6:17 pm</h4>
    <div class="postbody"><span class="postbody">Ah, thanks. Will that make functions relocatable too, or do I have to play with linker settings or change the code?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69770 - sajiimori - Wed Feb 01, 2006 7:08 pm</h4>
    <div class="postbody"><span class="postbody">I haven't done it yet myself, but the topic was being discussed here:
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=8051" target="_blank">http://forum.gbadev.org/viewtopic.php?t=8051</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69811 - HyperHacker - Thu Feb 02, 2006 3:42 am</h4>
    <div class="postbody"><span class="postbody">Yes, that's exactly what I want to do. Sounds complicated though. :-( There's no way to just tell the compiler/linker/whichever that I just want raw code (no headers or whatnot, I can make my own) that only uses relative addressing?
<br/>
<br/>
What I'm trying to do is make a simple multi-tasking OS for the DS. I can work out how to do the actual task switching, it's loading the programs into memory that's a problem, since they'll always expect to be placed at a specific address.
<br/>
<br/>
[edit] arm-elf-as has an option to generate PIC code... whatever that means. &lt;_&lt;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69819 - sajiimori - Thu Feb 02, 2006 5:05 am</h4>
    <div class="postbody"><span class="postbody">Yeah, I mentioned the PIC option in the other thread.  I reckon that's what restricts the code to only use relative addressing.  Get a raw binary the usual way, with objcopy or whatever else.
<br/>
<br/>
Most of the work is setting up an interface between a module and outside code.
<br/>
<br/>
I'd be curious about your results.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69869 - Sausage Boy - Thu Feb 02, 2006 4:51 pm</h4>
    <div class="postbody"><span class="postbody">I've been thinking about doing something like that for a while, a dynamic os thing would be so much cooler than statically compiled like WinDS etc... I didn't have much success, and then my ds broke, but I'm glad I'm not the only one who thought of this.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
