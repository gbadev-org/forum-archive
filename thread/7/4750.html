<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Archives with devkitARM - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Archives with devkitARM</h2>
<div id="posts">
<div class="post">
    <h4>#33365 - rmy - Sun Jan 02, 2005 2:37 pm</h4>
    <div class="postbody"><span class="postbody">Hi!
<br/>
<br/>
Has anyone had success using static libraries with devkitARM?
<br/>
<br/>
I'm doing something similar to:
<br/>
<br/>
rm -f libSagaEngine.a
<br/>
arm-elf-ar -qsvP libSageEngine.a obj1.o obj2.o etc.o
<br/>
arm-elf-g++ -v -O2 -g -specs=gba.specs -mthumb-interwork -o run.elf GbaStart.o libSagaEngine.a
<br/>
<br/>
But it seems like I get some trouble with segments. objdump from the standard linking of .o's differ from the linking from the library. 
<br/>
<br/>
Adding my file data with:
<br/>
arm-elf-objcopy --add-section .gfx=res.gfs --set-section-flags .gfx=contents,alloc,load,readonly,data,contents --adjust-section-vma .gfx=0x08280000 run.elf merged.elf
<br/>
<br/>
Renders the warnings:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: run.elf: warning: Empty loadable segment detected, is this intentional ?
<br/>
<br/>
BFD: merged.elf: warning: allocated section `.gfx' not in segment
<br/>
arm-elf-objcopy -O binary merged.elf merged.gba
<br/>
</td> </tr></table><span class="postbody">
<br/>
(The last line is normal, but has never mattered before).
<br/>
<br/>
I do have global variables and object instances in the .a, and also mix ARM and THUMB code in it... Don't know if that is important.
<br/>
<br/>
Grateful for any feedback.
<br/>
<br/>
-Rune-</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
