<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Open file, expand macros, save, lather, rinse, repeat...? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Open file, expand macros, save, lather, rinse, repeat...?</h2>
<div id="posts">
<div class="post">
    <h4>#163620 - Izhido - Mon Oct 06, 2008 6:39 pm</h4>
    <div class="postbody"><span class="postbody">Guys: 
<br/>
<br/>
Do you know of any applications that can do the above on a group of C/C++ files?
<br/>
<br/>
I'm having a hard time trying to navigate my way into a project that seems to be conceived before templates existed (or were known by the team who built it).  
<br/>
<br/>
You can see entire classes bulk-defined with macros like:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
FOR_EACH_CLASS(DECLARE_PROXY_CLASS)
<br/>
<br/>
FOR_EACH_CLASS(DECLARE_ALIAS_CLASS)
<br/>
<br/>
FOR_EACH_CLASS(DEFINE_PROXY_CLASS)
<br/>
<br/>
FOR_EACH_CLASS(DEFINE_ALIAS_CLASS)
<br/>
</td> </tr></table><span class="postbody">
<br/>
where FOR_EACH_CLASS is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define FOR_EACH_CLASS(x) FOR_EACH_PACK_1(x) FOR_EACH_PACK_2(x) FOR_EACH_PACK_3(x) FOR_EACH_PACK_4(x)
<br/>
</td> </tr></table><span class="postbody">
<br/>
where FOR_EACH_PACK_*(x) is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define   FOR_EACH_PACK_*(x) X(UInt8) X(UInt16) X(UInt32) X(Boolean) yada yada ...
<br/>
</td> </tr></table><span class="postbody">
<br/>
and where DECLARE_PROXY_CLASS(x) is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define DECLARE_PROXY_CLASS(x) DECLARE_PROXY_HEADER_FOR(x) DECLARE_PROXY_MEMBERS_FOR(x) DECLARE_PROXY_METHODS_FOR(x)
<br/>
</td> </tr></table><span class="postbody">
<br/>
where DECLARE_PROXY_HEADER_FOR(x) is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define DECLARE_PROXY_HEADER_FOR(x) \
<br/>
class Proxy##x \
<br/>
{ \
<br/>
public: 
<br/>
</td> </tr></table><span class="postbody">
<br/>
and...
<br/>
<br/>
<br/>
<br/>
well, do you get the idea? No? Good, I didn't either.
<br/>
<br/>
<br/>
<br/>
However, since the project is already closed (abandonware?), *and* GPL, that means I can scourge through the sources as I please. And that means, first and foremost, that I really need to understand what the $%&amp;$@ is going on under these $%&amp;$@ macros.
<br/>
<br/>
So, a tool that can expand only certain carefully selected macros &amp; then write back the files to disk would be really useful in this case.
<br/>
<br/>
To be honest, I have no idea how to google for such a thing, so I'm asking you, the crew who actually know about C/C++. Do you know if there's such a tool? And where to get it?
<br/>
<br/>
- Izhido</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163622 - Cearn - Mon Oct 06, 2008 7:18 pm</h4>
    <div class="postbody"><span class="postbody">Have you tried looking at the preprocessor output? That would show you what the end-result of all those macros would be. Granted, it would also expand all the other macros, possibly resulting in a very large mess of prototypes and code, but it could be a useful start. Temporarily commenting out other includes may help to keep the rest of the code relatively intact.
<br/>
<br/>
The -save-temps flag should dump the CPP output in .i files.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163644 - sgeos - Tue Oct 07, 2008 3:50 pm</h4>
    <div class="postbody"><span class="postbody">You could write some regular expressions to expand those macros if you don't want to run anything else through the preprocessor.  Regular expressions can have bugs, so you would need to be careful if you go that route.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
