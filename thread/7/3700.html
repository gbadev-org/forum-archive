<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>working code for sending multiboot over link cable? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > working code for sending multiboot over link cable?</h2>
<div id="posts">
<div class="post">
    <h4>#23375 - stuartp - Sun Jul 11, 2004 7:13 am</h4>
    <div class="postbody"><span class="postbody">i am looking for a working example that sends some multiboot code over a link cable.
<br/>
i have found one example that works but when i use my code with it gameboy #2 freezes after the nintendo logo appears.
<br/>
also if you think this could be caused by a buggy crt0.s please tell me where to find one that will work (im compiling with crt0.S v1.28 by Jeff Frohwein)
<br/>
<br/>
thanks in advance</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23383 - Cearn - Sun Jul 11, 2004 3:12 pm</h4>
    <div class="postbody"><span class="postbody">Are you sure you have a valid header? A real GBA needs a 156 byte Magic Cookie for the code to work. If "GameBoy" shows up but the "nintendo" at the bottom is screwed up, you might have a bad header. 
<br/>
Something like the Xboo communicator even tells you whether the header might be bad.
<br/>
You can use a program like gbafix to add a valid header. This tool is already included in <a class="postlink" href="http://www.devkit.tk" target="_blank">devkitARM</a>, but for devkit Advance you'll have to get is separately. (see the tools section on the main page). 
<br/>
<br/>
All my <a class="postlink" href="http://user.chem.tue.nl/jakvijn/files/tonc_bins.zip" target="_blank">demos</a> should run over a multiboot cable. For some more info on running on hardware, try <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=2885" target="_blank">this thread</a>.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23388 - dagamer34 - Sun Jul 11, 2004 6:08 pm</h4>
    <div class="postbody"><span class="postbody">This is what you are looking for:
<br/>
<br/>
<a class="postlink" href="http://www.devrs.com/gba/files/mbclient.txt" target="_blank">http://www.devrs.com/gba/files/mbclient.txt</a>[/url]
<br/>
<br/>
I've tested it, and it has worked for me before. Are you sure you defined the ROM you are sending over the link cable as multiboot? That might be the problem. Also, waiting for a VSync may make a difference.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23400 - stuartp - Sun Jul 11, 2004 10:47 pm</h4>
    <div class="postbody"><span class="postbody">i tried using the mbclient.txt program but gba #2 wouldnt even display the nintendo logo.  do i have to change it at all to make it work (besides adding an AgbMain)?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23405 - tepples - Mon Jul 12, 2004 3:43 am</h4>
    <div class="postbody"><span class="postbody">Did you remember to properly align the arrays to a 4-byte boundary using an <a class="postlink" href="http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Variable-Attributes.html" target="_blank">attribute</a>? For example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">const u8 Header[] __attribute__ ((aligned (4))) = {
<br/>
/* mucha data */
<br/>
};</td> </tr></table><span class="postbody">
<br/>
A comparison of the code's hardcoded 0x7202 reply, compared with <a class="postlink" href="http://www.work.de/nocash/gbatek.htm#biosmultibootsinglegamepak" target="_blank">GBATEK's 0x720x</a> where x is a bitfield representing the connected machines, suggests that it works only for 2 players, not for 3 or 4.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23426 - dagamer34 - Mon Jul 12, 2004 4:59 pm</h4>
    <div class="postbody"><span class="postbody">Are you using an official Nintendo link cable? Because that is what I tested it with. And make sure that the purple end is in the master GBA, and the grey end in the slave GBA.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23453 - FluBBa - Tue Jul 13, 2004 9:18 am</h4>
    <div class="postbody"><span class="postbody">I just found out that EZFA flashcards are <span style="text-decoration: underline">bad</span> for development purposes...
<br/>
All my emulators send the original header (at 0x08000000) to the slaves but the EZFA bootloader/flashsoftware changes the header of the GBA rom, so I had to add a seperate copy of the header for it to work on EZFA cards (when bootmanager is enabled).<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23465 - dagamer34 - Tue Jul 13, 2004 4:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">I just found out that EZFA flashcards are <span style="text-decoration: underline">bad</span> for development purposes...
<br/>
All my emulators send the original header (at 0x08000000) to the slaves but the EZFA bootloader/flashsoftware changes the header of the GBA rom, so I had to add a seperate copy of the header for it to work on EZFA cards (when bootmanager is enabled).</td> </tr></table><span class="postbody">
<br/>
<br/>
Umm... no. I have an EZFA and have sent a multiboot program WITH the boot menu. Did you actually make a valid multiboot header?
<br/>
<br/>
And are you self-replicating your program (sending it from EWRAM)? I was talking about building the slave rom, then using bin2h to get it in a header format, and then include it in another program.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23502 - FluBBa - Wed Jul 14, 2004 9:28 am</h4>
    <div class="postbody"><span class="postbody">Yes they are self replicating and I use the normal GBA header for booting the client, that didn't work on EZFA cards but on other cards (or EZFA with no bootmenu).
<br/>
Just thought that might be good to know.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23529 - dagamer34 - Wed Jul 14, 2004 6:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote">Yes they are self replicating and I use the normal GBA header for booting the client, that didn't work on EZFA cards but on other cards (or EZFA with no bootmenu).
<br/>
Just thought that might be good to know.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah, I assumed as much.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
