<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>having trouble including files [solved] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > having trouble including files [solved]</h2>
<div id="posts">
<div class="post">
    <h4>#172047 - zelbo - Mon Jan 11, 2010 9:31 pm</h4>
    <div class="postbody"><span class="postbody">When i try to put the mtrandom stuff into mtrandom.h and mtrandom.c, i get the following error:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">c:/devkitPro/projects/Quest_yarlds0.0.0c/source/mtrandom.c:23: error: conflicting types for 'init_by_array'
<br/>
c:/devkitPro/projects/Quest_yarlds0.0.0c/include/mtrandom.h:62: note: previous declaration of 'init_by_array' was here</td> </tr></table><span class="postbody">
<br/>
What the crap? how do i fix this? what else am i doing wrong here?
<br/>
Is it superfluous to include mtrandom.h in mtrandom.c, or required?
<br/>
including in my main.cpp with 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "mtrandom.h"</td> </tr></table><span class="postbody">
<br/>
include folder: mtrandom.h
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/* 
<br/>
   A C-program for MT19937, with initialization improved 2002/1/26.
<br/>
   Coded by Takuji Nishimura and Makoto Matsumoto.
<br/>
<br/>
   Before using, initialize the state by using init_genrand(seed)  
<br/>
   or init_by_array(init_key, key_length).
<br/>
<br/>
   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
<br/>
   All rights reserved.                          
<br/>
<br/>
   Redistribution and use in source and binary forms, with or without
<br/>
   modification, are permitted provided that the following conditions
<br/>
   are met:
<br/>
<br/>
     1. Redistributions of source code must retain the above copyright
<br/>
        notice, this list of conditions and the following disclaimer.
<br/>
<br/>
     2. Redistributions in binary form must reproduce the above copyright
<br/>
        notice, this list of conditions and the following disclaimer in the
<br/>
        documentation and/or other materials provided with the distribution.
<br/>
<br/>
     3. The names of its contributors may not be used to endorse or promote 
<br/>
        products derived from this software without specific prior written 
<br/>
        permission.
<br/>
<br/>
   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
<br/>
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
<br/>
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
<br/>
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
<br/>
   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
<br/>
   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
<br/>
   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
<br/>
   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
<br/>
   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
<br/>
   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
<br/>
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
<br/>
<br/>
<br/>
   Any feedback is very welcome.
<br/>
   http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html
<br/>
   email: m-mat @ math.sci.hiroshima-u.ac.jp (remove space)
<br/>
*/
<br/>
<br/>
/* Period parameters */  
<br/>
#define N 624
<br/>
#define M 397
<br/>
#define MATRIX_A 0x9908b0dfUL   /* constant vector a */
<br/>
#define UPPER_MASK 0x80000000UL /* most significant w-r bits */
<br/>
#define LOWER_MASK 0x7fffffffUL /* least significant r bits */
<br/>
<br/>
static unsigned long mt[N]; /* the array for the state vector  */
<br/>
static int mti=N+1; /* mti==N+1 means mt[N] is not initialized */
<br/>
<br/>
<br/>
/* initializes mt[N] with a seed */
<br/>
void init_genrand(unsigned long);
<br/>
<br/>
/* initialize by an array with array-length */
<br/>
/* init_key is the array for initializing keys */
<br/>
/* key_length is its length */
<br/>
/* slight change for C++, 2004/2/26 */
<br/>
void init_by_array(unsigned long, int);
<br/>
<br/>
/* generates a random number on [0,0xffffffff]-interval */
<br/>
unsigned long genrand_int32(void);
<br/>
<br/>
<br/>
/* generates a random number on [0,0x7fffffff]-interval */
<br/>
long genrand_int31(void);
<br/>
<br/>
/* generates a random number on [0,1]-real-interval */
<br/>
double genrand_real1(void);
<br/>
<br/>
/* generates a random number on [0,1)-real-interval */
<br/>
double genrand_real2(void);
<br/>
<br/>
/* generates a random number on (0,1)-real-interval */
<br/>
double genrand_real3(void);
<br/>
<br/>
/* generates a random number on [0,1) with 53-bit resolution*/
<br/>
double genrand_res53(void);
<br/>
/* These real versions are due to Isaku Wada, 2002/01/09 added */
<br/>
</td> </tr></table><span class="postbody">
<br/>
source folder: mtrandom.c
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "mtrandom.h"
<br/>
<br/>
/* initializes mt[N] with a seed */
<br/>
void init_genrand(unsigned long s)
<br/>
{
<br/>
    mt[0]= s &amp; 0xffffffffUL;
<br/>
    for (mti=1; mti&lt;N; mti++) {
<br/>
        mt[mti] = 
<br/>
       (1812433253UL * (mt[mti-1] ^ (mt[mti-1] &gt;&gt; 30)) + mti); 
<br/>
        /* See Knuth TAOCP Vol2. 3rd Ed. P.106 for multiplier. */
<br/>
        /* In the previous versions, MSBs of the seed affect   */
<br/>
        /* only MSBs of the array mt[].                        */
<br/>
        /* 2002/01/09 modified by Makoto Matsumoto             */
<br/>
        mt[mti] &amp;= 0xffffffffUL;
<br/>
        /* for &gt;32 bit machines */
<br/>
    }
<br/>
}
<br/>
<br/>
/* initialize by an array with array-length */
<br/>
/* init_key is the array for initializing keys */
<br/>
/* key_length is its length */
<br/>
/* slight change for C++, 2004/2/26 */
<br/>
void init_by_array(unsigned long init_key[], int key_length)
<br/>
{
<br/>
    int i, j, k;
<br/>
    init_genrand(19650218UL);
<br/>
    i=1; j=0;
<br/>
    k = (N&gt;key_length ? N : key_length);
<br/>
    for (; k; k--) {
<br/>
        mt[i] = (mt[i] ^ ((mt[i-1] ^ (mt[i-1] &gt;&gt; 30)) * 1664525UL))
<br/>
          + init_key[j] + j; /* non linear */
<br/>
        mt[i] &amp;= 0xffffffffUL; /* for WORDSIZE &gt; 32 machines */
<br/>
        i++; j++;
<br/>
        if (i&gt;=N) { mt[0] = mt[N-1]; i=1; }
<br/>
        if (j&gt;=key_length) j=0;
<br/>
    }
<br/>
    for (k=N-1; k; k--) {
<br/>
        mt[i] = (mt[i] ^ ((mt[i-1] ^ (mt[i-1] &gt;&gt; 30)) * 1566083941UL))
<br/>
          - i; /* non linear */
<br/>
        mt[i] &amp;= 0xffffffffUL; /* for WORDSIZE &gt; 32 machines */
<br/>
        i++;
<br/>
        if (i&gt;=N) { mt[0] = mt[N-1]; i=1; }
<br/>
    }
<br/>
<br/>
    mt[0] = 0x80000000UL; /* MSB is 1; assuring non-zero initial array */ 
<br/>
}
<br/>
<br/>
/* generates a random number on [0,0xffffffff]-interval */
<br/>
unsigned long genrand_int32(void)
<br/>
{
<br/>
    unsigned long y;
<br/>
    static unsigned long mag01[2]={0x0UL, MATRIX_A};
<br/>
    /* mag01[x] = x * MATRIX_A  for x=0,1 */
<br/>
<br/>
    if (mti &gt;= N) { /* generate N words at one time */
<br/>
        int kk;
<br/>
<br/>
        if (mti == N+1)   /* if init_genrand() has not been called, */
<br/>
            init_genrand(5489UL); /* a default initial seed is used */
<br/>
<br/>
        for (kk=0;kk&lt;N-M;kk++) {
<br/>
            y = (mt[kk]&amp;UPPER_MASK)|(mt[kk+1]&amp;LOWER_MASK);
<br/>
            mt[kk] = mt[kk+M] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1UL];
<br/>
        }
<br/>
        for (;kk&lt;N-1;kk++) {
<br/>
            y = (mt[kk]&amp;UPPER_MASK)|(mt[kk+1]&amp;LOWER_MASK);
<br/>
            mt[kk] = mt[kk+(M-N)] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1UL];
<br/>
        }
<br/>
        y = (mt[N-1]&amp;UPPER_MASK)|(mt[0]&amp;LOWER_MASK);
<br/>
        mt[N-1] = mt[M-1] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1UL];
<br/>
<br/>
        mti = 0;
<br/>
    }
<br/>
  
<br/>
    y = mt[mti++];
<br/>
<br/>
    /* Tempering */
<br/>
    y ^= (y &gt;&gt; 11);
<br/>
    y ^= (y &lt;&lt; 7) &amp; 0x9d2c5680UL;
<br/>
    y ^= (y &lt;&lt; 15) &amp; 0xefc60000UL;
<br/>
    y ^= (y &gt;&gt; 18);
<br/>
<br/>
    return y;
<br/>
}
<br/>
<br/>
/* generates a random number on [0,0x7fffffff]-interval */
<br/>
long genrand_int31(void)
<br/>
{
<br/>
    return (long)(genrand_int32()&gt;&gt;1);
<br/>
}
<br/>
<br/>
/* generates a random number on [0,1]-real-interval */
<br/>
double genrand_real1(void)
<br/>
{
<br/>
    return genrand_int32()*(1.0/4294967295.0); 
<br/>
    /* divided by 2^32-1 */ 
<br/>
}
<br/>
<br/>
/* generates a random number on [0,1)-real-interval */
<br/>
double genrand_real2(void)
<br/>
{
<br/>
    return genrand_int32()*(1.0/4294967296.0); 
<br/>
    /* divided by 2^32 */
<br/>
}
<br/>
<br/>
/* generates a random number on (0,1)-real-interval */
<br/>
double genrand_real3(void)
<br/>
{
<br/>
    return (((double)genrand_int32()) + 0.5)*(1.0/4294967296.0); 
<br/>
    /* divided by 2^32 */
<br/>
}
<br/>
<br/>
/* generates a random number on [0,1) with 53-bit resolution*/
<br/>
double genrand_res53(void) 
<br/>
{ 
<br/>
    unsigned long a=genrand_int32()&gt;&gt;5, b=genrand_int32()&gt;&gt;6; 
<br/>
    return(a*67108864.0+b)*(1.0/9007199254740992.0); 
<br/>
} 
<br/>
/* These real versions are due to Isaku Wada, 2002/01/09 added */
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"><br/><br/>Last edited by zelbo on Tue Jan 12, 2010 2:57 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#172049 - gauauu - Mon Jan 11, 2010 9:44 pm</h4>
    <div class="postbody"><span class="postbody">The signatures for init_by_array are different...in the header file, you specify the first parameter as an unsigned long, but the c source file, you specify it as an array of unsigned longs.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172050 - zelbo - Mon Jan 11, 2010 9:48 pm</h4>
    <div class="postbody"><span class="postbody">any suggestions on how to fix it? It's not my code, i'm just stealing it. I wrote the header prototypes though, so i guess i need to change that. How should i write it so it knows it's an array?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172053 - gauauu - Mon Jan 11, 2010 10:47 pm</h4>
    <div class="postbody"><span class="postbody">Just make the header prototype match the one in the c source, and you should be fine.  (It won't hurt anything to put the parameter names in the headers, and might actually make it easier to use the header for your reference)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void init_by_array(unsigned long init_key[], int key_length);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Myself, I tend to avoid using the [] notation when passing parameters (not because you necessarily shouldn't, but I always end up confusing myself)  
<br/>
<br/>
If it were me, I'd do:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void init_by_array(unsigned long * init_key, int key_length) 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
int both places. 
<br/>
<br/>
In C, a pointer and an array can often be used interchangeably (for your purposes, they are almost the same thing, although saying they are truly the same would get me into trouble for telling lies)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172058 - zelbo - Tue Jan 12, 2010 2:57 am</h4>
    <div class="postbody"><span class="postbody">Spectacular! Thank you!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172061 - Ruben - Tue Jan 12, 2010 11:25 am</h4>
    <div class="postbody"><span class="postbody">Oh and one small thing.
<br/>
I noticed this code...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">mt[i-1] ^ (mt[i-1] &gt;&gt; 30</td> </tr></table><span class="postbody">
<br/>
Unless I'm incredibly mistaken, x^x = 0, in C/C++ as ^ is in fact XOR, not pow(x, y)
<br/>
<br/>
EDIT: Nevermind, didn't see the ()<br/>_________________<br/>I'm 18 and have Asperger's, so if I don't get something at first, just bear with me. *nod*</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172069 - zelbo - Tue Jan 12, 2010 9:34 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, so i got it to compile and all. Except now i realized something. Most of this 'pseudo random number generator' stuff is going to be using floating point math at some point, right?
<br/>
I don't know for sure, but it just seems like it would. So, if that's the case, is it the sort of thing i would be able to use a LUT for?
<br/>
I guess it's not a big deal yet, since i'm nowhere near using it yet, but i would like it to work. And unlike most of the rest of it, this is one i'm willing to say "i don't need to understand it, i just need it to work". Because the math for this sort of thing is <span style="text-decoration: underline">way</span> over my head.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172070 - gauauu - Tue Jan 12, 2010 10:38 pm</h4>
    <div class="postbody"><span class="postbody">It shouldn't do any floating point as long as you only ask it for random ints instead of calling the genrand_real functions.
<br/>
<br/>
If you are asking for random floating point values, then it doesn't look much like a LUT will help, unless you are planning on always using the same seed each time (at which point you could just precalculate all your random numbers instead). (disclaimer:  I'm bad at the math behind this stuff, so I could be wrong).
<br/>
<br/>
Assuming you are just going to use it for random ints (which is probably what you should do, depending on your requirements), you could just ignore (or even remove) the genrand_real functions and you'll be fine.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
