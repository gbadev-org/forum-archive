<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>random numbers - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > random numbers</h2>
<div id="posts">
<div class="post">
    <h4>#12135 - ken2 - Fri Oct 31, 2003 7:43 am</h4>
    <div class="postbody"><span class="postbody">I seem to have forgotten how to code random numbers between 0 and 20. Like how to pick a random # from between those two and set it to a variable.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12136 - Datch - Fri Oct 31, 2003 2:35 pm</h4>
    <div class="postbody"><span class="postbody">From the FAQ :
<br/>
<br/>
<span style="font-weight: bold">Q: How do I generate pseudo-random numbers?</span>
<br/>
See the topics linked from <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=1431" target="_blank">here</a>.<br/>_________________<br/>Visit SR-388 now and get a 40% discount!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12156 - ken2 - Sat Nov 01, 2003 2:41 am</h4>
    <div class="postbody"><span class="postbody">hmmm, my code doesnt seem to be working, any suggestions?
<br/>
<br/>
unsigned long seed; 
<br/>
<br/>
signed long dice(signed long min, signed long max) 
<br/>
{ 
<br/>
seed *= 69069; 
<br/>
return min + ((max - min + 1) * (seed &gt;&gt; 16)) / 0x10000; 
<br/>
} 
<br/>
<br/>
<br/>
void Xyset()
<br/>
{
<br/>
	xpos2 = dice(5,100);
<br/>
<br/>
	if (ypos2&lt;115){
<br/>
	ypos2++;
<br/>
	}
<br/>
	else
<br/>
	{
<br/>
		ypos2 = 10;	
<br/>
	}
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12157 - Burton Radons - Sat Nov 01, 2003 3:37 am</h4>
    <div class="postbody"><span class="postbody">That'll never return anything but zero.  Try:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
unsigned long seed = 289301;
<br/>
<br/>
signed long dice(signed long min, signed long max)
<br/>
{
<br/>
   seed = seed * 69069 + 1;
<br/>
   return min + ((max - min + 1) * (seed &gt;&gt; 16)) / 0x10000;
<br/>
} 
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12607 - sgeos - Wed Nov 19, 2003 9:02 am</h4>
    <div class="postbody"><span class="postbody">That RNG looks like something I could have written. =P  Did you remember to seed the RNG?  You could set it to any non zero value...
<br/>
<br/>
seed = 0x12459FE8;
<br/>
<br/>
Or, if you want to make things really fancy, start up a timer and seed the RNG using the value in the timer.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">start_timer();
<br/>
wait_for_input();
<br/>
seed = get_timer_state();</td> </tr></table><span class="postbody">
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12615 - dagamer34 - Wed Nov 19, 2003 5:52 pm</h4>
    <div class="postbody"><span class="postbody">There is always the rand () function. That has always worked for me.
<br/>
num = rand () % 20;<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12618 - Touchstone - Wed Nov 19, 2003 6:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">There is always the rand () function. That has always worked for me.
<br/>
num = rand () % 20;</td> </tr></table><span class="postbody">
<br/>
Actually, there's not always the rand() function since it's a part of stdlib and you don't always have that. Beware, if you pay attention to me I might have to zap your brain!<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12619 - tom - Wed Nov 19, 2003 6:39 pm</h4>
    <div class="postbody"><span class="postbody">sure rand() works fine, is useful and all, it's just awfully slow =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12630 - sgeos - Thu Nov 20, 2003 12:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">There is always the rand () function. That has always worked for me.
<br/>
num = rand () % 20;</td> </tr></table><span class="postbody">
<br/>
<br/>
Have you read the man page for rand?  Using mod is a bad way of doing things.  It uses the low order bits of the RNG.  rand() is is a LCG in many implementations.  Depending on the LCG, bit zero of the RNG state may always be the same!
<br/>
<br/>
The code posted above:
<br/>
state *= 69069;
<br/>
Or
<br/>
state = state * 69069 + 1;
<br/>
Are both LCGs.
<br/>
<br/>
BTW, does adding one affect the period of the generator?  If so, is it affected in a positive or negative way?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12642 - tom - Thu Nov 20, 2003 8:23 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">The code posted above:
<br/>
state *= 69069;
<br/>
Or
<br/>
state = state * 69069 + 1;
<br/>
Are both LCGs.
<br/>
<br/>
BTW, does adding one affect the period of the generator?  If so, is it affected in a positive or negative way?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
i think the +1 is to keep the generator from returning only 0, should state become 0. so if you look at it this way, it does affect the period of the rng in a positive way, yes =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12643 - sgeos - Thu Nov 20, 2003 9:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tom wrote:</b></span></td> </tr> <tr> <td class="quote">i think the +1 is to keep the generator from returning only 0, should state become 0. so if you look at it this way, it does affect the period of the rng in a positive way, yes =)</td> </tr></table><span class="postbody">
<br/>
<br/>
Clearly the intent is to keep the generator from returning zero.  If that is the goal, I'd advise ORing the state with 0x1 or seeding the RNG with an odd number.  I can state with 100% certainty that the state will never be zero if the current state is odd, and the LCG's multiplier (69069 in this case) is odd.
<br/>
<br/>
Adding 1 wastes a cycle (probably not important) and it may destroy the mathematic properties of this particular generator.  I highly doubt that it does, even if the period (number of calls to the RNG until you get back to where you started) were cut by a factor of ten it would still probably be long enough.
<br/>
<br/>
My point is, be careful.  RNGs are hard to write and easy to break if you don't know what you are doing.  The state *= 69069 deal was adapted from an older version of the mersenne twister source code.  That code mentioned Knuth, and it may have originated from somewhere in Volume II of the Art of Computer Programming.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
