<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Maps - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Maps</h2>
<div id="posts">
<div class="post">
    <h4>#5639 - twillinx - Sun May 04, 2003 4:17 pm</h4>
    <div class="postbody"><span class="postbody">My question regards the maps for GBA, I'm currently using a 512x512 size map. 
<br/>
<br/>
If I look at a game like SM World for example the maps in that game is ALOT bigger than 512x512.
<br/>
<br/>
Is it possible to load a lot of maps at startup and then shift maps at a certain X-value? How many maps would fit in to the GBA-RAM if possible?
<br/>
<br/>
Right now it takes about 5 seconds after startup before I see any graphic (it's doing a loop to get all the mapdata into memory), and if it takes 5 seconds every time it would take quite some time to start the game, if I look at Metroid or Castlevania they don't seem to have that problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5642 - darkcloud - Sun May 04, 2003 4:56 pm</h4>
    <div class="postbody"><span class="postbody">SM World probably uses a dynamic tile system so new tiles are constantly being loaded in and updating, that way, you can have a basically 'infinite' map size.  
<br/>
<br/>
If you use DMA to copy your map data in, it will be much, much, faster and you probably won't see any delay at all.<br/>_________________<br/>Maybe in order to understand mankind, we have to look at the word itself: "Mankind". Basically, it's made up of two separate words - "mank" and "ind". What do these words mean ? It's a mystery, and that's why so is mankind.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5643 - twillinx - Sun May 04, 2003 5:34 pm</h4>
    <div class="postbody"><span class="postbody">After looking around a little more in the forum I found another topic discussing the maps, sorry.  Ok, if the maploading would be faster I don't think there would be any problem loading new "maps" into my already existing 512x512 map, would there?
<br/>
<br/>
My idea is as follows, making alot of smaller maps (using a mapeditor, having them at the getgo once the games compiled) always writing over the old array of mapdata when the gamecharacter reaches a certain x-value.
<br/>
<br/>
What about the DMA? Never heard of it. :P But I wouldn't mind using it though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5644 - darkcloud - Sun May 04, 2003 5:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>twillinx wrote:</b></span></td> </tr> <tr> <td class="quote">What about the DMA? Never heard of it. :P But I wouldn't mind using it though.</td> </tr></table><span class="postbody">
<br/>
<br/>
DMA (direct-memory access) is a very fast way of moving data around in the gba, because the hardware does it for you. 
<br/>
<br/>
It's very easy to use DMA and you'll definitely want to learn how to use it.  
<br/>
<br/>
Check out the <a class="postlink" href="http://www.thepernproject.com" target="_blank">The Pern Project</a> which has one tutorial about how to use DMA.<br/>_________________<br/>Maybe in order to understand mankind, we have to look at the word itself: "Mankind". Basically, it's made up of two separate words - "mank" and "ind". What do these words mean ? It's a mystery, and that's why so is mankind.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5660 - twillinx - Mon May 05, 2003 11:58 am</h4>
    <div class="postbody"><span class="postbody">Thanks alot, just what I needed, I will look in to DMA as soon as this problems solved.
<br/>
<br/>
One final (I hope) question about maps.
<br/>
<br/>
I'm using an array of 4095 to cover all the tilepositions for a 512x512 map, this doesn't work correctly though.
<br/>
<br/>
I've tried out to "lit" [0], [1] and [2] in my array mapData. What I thought was going to happen was that 3 tiles in a row would be "lit" and I was going to go on coding. The thing that happened was that there was a tilespace (8 pixels) between everyone of the "lit" tiles. "liting" [64],[65] and [66] of course gives me the same tilespace.
<br/>
<br/>
It looks like this:
<br/>
<br/>
XOXOX
<br/>
OOOOO
<br/>
XOXOX
<br/>
<br/>
when it should look like this:
<br/>
<br/>
XXX
<br/>
XXX
<br/>
<br/>
I'm using rotationbackground, and thought the GBA could only handle 8x8 pixel tiles.
<br/>
<br/>
[2047] is the last tile I can "lit", although my Array should be up to 4095. 
<br/>
<br/>
I've gone over the code over and over again, but I really need help (again) with this one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5661 - Quirky - Mon May 05, 2003 1:37 pm</h4>
    <div class="postbody"><span class="postbody">VRAM (where the map is stored) can only be accessed as if it were an array of 16 bit values. So when you place your 8-bit map variables in there you need to do it 2 at a time. One way of going about this is:
<br/>
<br/>
bg.mapData[0] = mymap[0] | (mymap[1]&lt;&lt;8);</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5662 - niltsair - Mon May 05, 2003 2:16 pm</h4>
    <div class="postbody"><span class="postbody">Another thing, you might want to use 256x256 background if you're implementing dynamic backgrounds (loading tiles as you need to show them). Because for each maps you're not using (in this case 3) you're freeing another 32tiles to use (64 Tiles in 16colors).</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
