<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>array pointer confusion - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > array pointer confusion</h2>
<div id="posts">
<div class="post">
    <h4>#167619 - intel3 - Fri Mar 20, 2009 4:54 pm</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
I am getting confused with the way how array  is being used in c++ as a returned variable 
<br/>
<br/>
Here is how I declared it:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Ship::Ship() {
<br/>
        Laser * beam[10];
<br/>
   for(int i = 0; i &lt; 10; i++)
<br/>
      beam[i] = new Laser();
<br/>
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I want to return the array and here is the function call:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Laser * Ship::getlasers(){
<br/>
   //what should it be?
<br/>
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I tried returning beam and it didn't work. So I returned beam[0] and it worked. Is it suppose to be returning beam[0] and why.
<br/>
<br/>
Afterward returning the pointer how do I reference other index (for example) like so?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
Laser * las = ship-&gt;getLasers();
<br/>
las[5] = 3;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Here are some of the other question I have in mind about pointer and array,
<br/>
what is the concept behind this and how to use it properly?
<br/>
In this case why can't I just use char pointer instead seems like it is just pointing to a memory location?
<br/>
When I declare
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Laser * beam[10];
<br/>
or 
<br/>
Laser *beam[] = new Laser[10];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Does a pointer to the array also means the pointer starting at index 0? And since it is a pointer does it mean that for example beam[3] is also an pointer and I can declare a new pointer like so:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
laser * one = beam[3];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks for your explaination</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167621 - elhobbs - Fri Mar 20, 2009 5:59 pm</h4>
    <div class="postbody"><span class="postbody">an array of Laser pointers
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Laser *beam[10];
<br/>
for(i=0;i&lt;10;i++) {
<br/>
 beam[i] = new Laser();
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
an array of Lasers
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Laser *beam = new Laser[10];</td> </tr></table><span class="postbody">
<br/>
<br/>
in the first case beam is a Laser**
<br/>
in the second case beam is a Laser*
<br/>
<br/>
in the first case beam[i] is a Laser*. In the second case beam[i] is a Laser. so the first case uses beam[i]-&gt;x the send case would use [beam[i].x
<br/>
<br/>
the second case guarentees that the Laser objects are contiguous in memory. the first case does not.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167623 - sajiimori - Fri Mar 20, 2009 6:55 pm</h4>
    <div class="postbody"><span class="postbody">And best of all:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Laser beam[10];</td> </tr></table><span class="postbody">Dynamic allocation is a solution to a problem; if you don't have a problem, don't use it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167636 - brave_orakio - Sat Mar 21, 2009 3:01 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
Laser * Ship::getlasers(){ 
<br/>
   //what should it be? 
<br/>
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If you return beam, you're returning a double pointer I think that's why it doesn't work. when you return beam[0], you only returning a pointer.<br/>_________________<br/>help me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167639 - sgeos - Sat Mar 21, 2009 3:53 am</h4>
    <div class="postbody"><span class="postbody">If I understand your problem, it should be "return beam;".
<br/>
This is the test setup I used...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;iostream&gt;
<br/>
using namespace std;
<br/>
<br/>
typedef int Laser;
<br/>
<br/>
class Ship
<br/>
{
<br/>
        Laser beam[10];
<br/>
<br/>
public:
<br/>
        Ship()
<br/>
        {
<br/>
                int i;
<br/>
                for (i = 0; i &lt; 10; i++)
<br/>
                        beam[i] = i;
<br/>
        }
<br/>
<br/>
        Laser *getlasers()
<br/>
        {
<br/>
                return beam;
<br/>
        }
<br/>
};
<br/>
<br/>
void printLaser(Laser *pLaser, int pSize)
<br/>
{
<br/>
        int i;
<br/>
        for (i = 0; i &lt; pSize; i++)
<br/>
                cout &lt;&lt; pLaser[i] &lt;&lt; endl;
<br/>
}
<br/>
<br/>
int main(int argc, char **argv)
<br/>
{
<br/>
        Ship myShip;
<br/>
        printLaser(myShip.getlasers(),10);
<br/>
        return 0;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167645 - intel3 - Sat Mar 21, 2009 7:02 am</h4>
    <div class="postbody"><span class="postbody">Thanks for the reply
<br/>
<br/>
The reason I am confused is because I came from Java background. The way how array is return from a function seems unclear to me.
<br/>
<br/>
In Java
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
Laser beam[] = new Laser[10];
<br/>
beam[1] = new Laser();
<br/>
</td> </tr></table><span class="postbody">
<br/>
And then I can return a beam[] object.
<br/>
<br/>
In c++, how to code it properly?
<br/>
from what segeos suggestion, what I return is  a pointer to the array.
<br/>
The way how I would use this pointer to reference objects in array and its members are like,
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Laser * las = beam[4];
<br/>
las-&gt; radius = 6;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Is this correct?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167656 - sgeos - Sat Mar 21, 2009 1:02 pm</h4>
    <div class="postbody"><span class="postbody">Specifically, what do you want to do?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">// allocate your lasers somewhere
<br/>
Laser beam[10];
<br/>
<br/>
// somehow get ahold of your list of lasers
<br/>
// This is the same as:
<br/>
// Laser *las = &amp;(beam[0]);
<br/>
Laser *las = beam;
<br/>
<br/>
// you probably want to explicit set one laser from the list
<br/>
// instead of letting it default the the first one in the array,
<br/>
// unless I misunderstand your intentions
<br/>
las[0].radius = 6;</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167726 - intel3 - Mon Mar 23, 2009 10:21 pm</h4>
    <div class="postbody"><span class="postbody">Basically I want to get an array of laser object.
<br/>
<br/>
After doing some research I realize that a pointer can work like an array
<br/>
so basically
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Laser * myLaser(){
<br/>
Laser list[30];
<br/>
<br/>
return list;
<br/>
}
<br/>
<br/>
Laser newlist = myLaser();
<br/>
</td> </tr></table><span class="postbody">
<br/>
It works fine
<br/>
<br/>
What I don't understand is once I create a list like so why won't the following code work?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
Laser list[30];
<br/>
list[0] = new Laser();
<br/>
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167727 - Miked0801 - Mon Mar 23, 2009 10:47 pm</h4>
    <div class="postbody"><span class="postbody">Because
<br/>
<br/>
Laser list[30]; 
<br/>
<br/>
Immediately creates 30 lasers on the stack using Laser's default constructor.
<br/>
<br/>
List[0] = new Laser() is attempting to assign a laser pointer (new() returns a pointer) over an existing laser object (non pointer).
<br/>
<br/>
If you want to use new, then use 
<br/>
<br/>
Laser *list[30];  // Create 30 laser object pointers
<br/>
list[0] = new Laser();  // Create a laser at the first element.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167730 - sajiimori - Tue Mar 24, 2009 12:20 am</h4>
    <div class="postbody"><span class="postbody">Right, C++ is not Java.  If you say:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Laser beam;</td> </tr></table><span class="postbody">you're creating a real Laser object right there, not a reference to a Laser object.
<br/>
<br/>
Java doesn't have the concept of by-value objects; the above declaration would only create a null reference in Java.
<br/>
<br/>
By-value objects are destroyed immediately when they goes out of scope, unlike Java which garbage collects objects at some unspecified time in the future.
<br/>
<br/>
Hold objects by value whenever possible.  Using 'new' is much slower, and the semantics are more complicated because you have to think a lot more about object lifetimes, which are not automatically managed for you in C++.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167794 - intel3 - Fri Mar 27, 2009 7:45 pm</h4>
    <div class="postbody"><span class="postbody">Thx for the reply
<br/>
Now I totally understand the problem was
<br/>
<br/>
Thanks again!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
