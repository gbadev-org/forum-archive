<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Interrupts - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>C/C++ > Interrupts</h2>
<div id="posts">
<div class="post">
    <h4>#69035 - n0va - Sat Jan 28, 2006 2:10 am</h4>
    <div class="postbody"><span class="postbody">I'm having problems compiling my code. Whenever I assign something to REG_IRQ_HANDER, like this </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">REG_IRQ_HANDLER = IrqHandler</td> </tr></table><span class="postbody"> the compiler gives me this </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">main.cpp:22: error: assignment of read-only location
<br/>
main.cpp:22: error: cannot convert 'void ()()' to 'void ()()' in assignment</td> </tr></table><span class="postbody">
<br/>
<br/>
Can somebody tell me what's going on?
<br/>
<br/>
The command I ran is </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-elf-g++ main.cpp -o main.o -c -g -Wall -mthumb-interwork</td> </tr></table><span class="postbody"> and I'm using DevKitARM. It doesn't seem to work with DevKitAdv anyway.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69052 - tepples - Sat Jan 28, 2006 4:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>n0va wrote:</b></span></td> </tr> <tr> <td class="quote">Whenever I assign something to REG_IRQ_HANDER, like this <table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">REG_IRQ_HANDLER = IrqHandler</td> </tr></table><span class="postbody"> the compiler gives me this </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">main.cpp:22: error: assignment of read-only location
<br/>
main.cpp:22: error: cannot convert 'void ()()' to 'void ()()' in assignment</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Hmm, interesting. Are you making sure to use extern "C" on your IRQ handler's prototype?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69065 - sajiimori - Sat Jan 28, 2006 6:33 am</h4>
    <div class="postbody"><span class="postbody">It seems to suggest that REG_IRQ_HANDER is defined as pointer-to-const.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69317 - nmain - Mon Jan 30, 2006 12:27 am</h4>
    <div class="postbody"><span class="postbody">I'm not familiar with that symbol, but if it's meant to be defined as the interrupt vector that is at the end of iwram, and trying to assign something to it gives a const error, then it sounds to me like the definition or define is wrong.  Track down whatever header that symbol / define is in; and if you can't make sense of it post it here.  This is what it should be like, courtesy TONC:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef void (*fnptr)(void);
<br/>
#define REG_INTMAIN (*(fnptr*) (0x03fffffc))
<br/>
<br/>
void my_int_fn (void)
<br/>
{
<br/>
  // Col Sandurz:  "Do something!"
<br/>
}
<br/>
<br/>
// in the initialization code
<br/>
REG_INTMAIN = my_int_fn;
<br/>
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
