<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Linked List Weirdness - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Linked List Weirdness</h2>
<div id="posts">
<div class="post">
    <h4>#12389 - frag - Mon Nov 10, 2003 2:56 pm</h4>
    <div class="postbody"><span class="postbody">Okay I'm going slightly insane here.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct linkedList {
<br/>
    linkedList *Next;
<br/>
} linkedList;</td> </tr></table><span class="postbody">
<br/>
<br/>
Pretty standard linked list code.  I'm using GCC and it spits out the following:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">state.h:8: parse error before "linkedList"
<br/>
state.h:8: warning: no semicolon at end of struct or union
<br/>
state.h:9: warning: type defaults to `int' in declaration of `linkedList'
<br/>
state.h:9: warning: data definition has no type or storage class</td> </tr></table><span class="postbody">
<br/>
<br/>
Thinking maybe it was some weirdness with both the type and struct being the same name I tried the following:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct linkedListStruct {
<br/>
    linkedListStruct *Next;
<br/>
} linkedList;</td> </tr></table><span class="postbody">
<br/>
<br/>
And this gave me the same errors  as before.
<br/>
<br/>
Maybe its just late or something, but this is driving me crazy. I can't figure out what I'm doing wrong.
<br/>
<br/>
Any help would be great.
<br/>
<br/>
Frag
<br/>
<br/>
ADDENDUM:
<br/>
If I try to compile without the self-referential bit its fine.  but that sort of defeats the purpose of the linked list to begin with ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12390 - tepples - Mon Nov 10, 2003 4:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>frag wrote:</b></span></td> </tr> <tr> <td class="quote">Okay I'm going slightly insane here.
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct linkedList {
<br/>
    linkedList *Next;
<br/>
} linkedList;</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
If you're making a self-referential struct (list, tree, etc) in C, try using the struct tag instead of the typename within the struct definition:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct linkedList {
<br/>
    struct linkedList *Next;
<br/>
} linkedList;</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12391 - frag - Mon Nov 10, 2003 4:50 pm</h4>
    <div class="postbody"><span class="postbody">Christ it really is too late to be coding. heh.
<br/>
<br/>
Thanks tepples.  It would have bit me in the nose if it had teeth.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12395 - dagamer34 - Tue Nov 11, 2003 12:54 am</h4>
    <div class="postbody"><span class="postbody">You cannot typedef something and call it the same thing!!!!! (This is like a basic C error, so excuse me for my rudeness)
<br/>
<br/>
There i am calm now.
<br/>
<br/>
Here is what you should do:
<br/>
<br/>
typedef struct LinkedList { 
<br/>
    linkedList *Next; 
<br/>
} linkedList;
<br/>
<br/>
Notice the capitalization of the first letter. Your problems should disappear.
<br/>
<br/>
Your welcome.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12397 - tepples - Tue Nov 11, 2003 1:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">You cannot typedef something and call it the same thing!!!!!</td> </tr></table><span class="postbody">
<br/>
Really? What part of the C language specification prevents a module from having a typename and a struct with the same name? For example, do you claim that the following, which I claim is valid C, would be invalid?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
struct LIST {
<br/>
  int car;
<br/>
  struct LIST *cdr;
<br/>
};
<br/>
typedef  struct LIST  LIST;
<br/>
</td> </tr></table><span class="postbody">
<br/>
The following should be equivalent:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef struct LIST {
<br/>
  int car;
<br/>
  struct LIST *cdr;
<br/>
} LIST;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Just make sure that when recursively defining structs, define them in terms of their struct names rather than their typenames.
<br/>
<br/>
It is only in C++ that struct names and typenames share a namespace, and even there, C++ has an exception that allows for this idiom.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12606 - sgeos - Wed Nov 19, 2003 8:54 am</h4>
    <div class="postbody"><span class="postbody">The compiler needs to know what a type is before it can deal with it.  It can deal with struct tags even before you declare the struct.  It can not deal with anything typedef'ed until the type has been defined, that is after the semicolon.  This code compiles:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;stdio.h&gt;
<br/>
<br/>
struct a {
<br/>
        int data;
<br/>
        struct b *b;
<br/>
};
<br/>
<br/>
struct b {
<br/>
        char *data;
<br/>
        struct a *a;
<br/>
};
<br/>
<br/>
int main(void)
<br/>
{
<br/>
        struct a a = {1234, 0};
<br/>
        struct b b = {"asdf", &amp;a};
<br/>
<br/>
        printf("%s%d\n", b.data, b.a-&gt;data);
<br/>
        return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
struct a contains a pointer to type struct b.  struct b is defined later.  If you wanted to typedef all of that, you could do something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct a {
<br/>
        int data;
<br/>
        struct b *b;
<br/>
} a;
<br/>
<br/>
typedef struct b {
<br/>
        char *data;
<br/>
        a *a;
<br/>
} b;</td> </tr></table><span class="postbody">
<br/>
<br/>
Although I'd advise using the struct tags (look at the definition of struct b).  I used to typedef all of my structs, but years ago somebody pointed out that that can make one's code more difficult to read.  If we see something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int n;
<br/>
fp d;</td> </tr></table><span class="postbody">
<br/>
<br/>
We have no idea what fp is.  It could either of these, or something else altogether:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">tpyedef unsigned long fp;  /* Fixed point */
<br/>
typedef struct fp {
<br/>
   FILE *f;   /* File */
<br/>
   int c;      /* Made changes since last save? */
<br/>
} fp;</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm done being "helpful".  (Read: I'm done ranting.)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12621 - Touchstone - Wed Nov 19, 2003 6:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">You cannot typedef something and call it the same thing!!!!!</td> </tr></table><span class="postbody">
<br/>
Really? What part of the C language specification prevents a module from having a typename and a struct with the same name?</span></td> </tr></table><span class="postbody">
<br/>
But tepples, DaGamer34 is using five (5!) exclamation-marks, he must be knowing what he's talking about.
<br/>
<br/>
<br/>
Zap!<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12631 - sgeos - Thu Nov 20, 2003 12:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Touchstone wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dagamer34 wrote:</b></span></td> </tr> <tr> <td class="quote">You cannot typedef something and call it the same thing!!!!!</td> </tr></table><span class="postbody">
<br/>
Really? What part of the C language specification prevents a module from having a typename and a struct with the same name?</span></td> </tr></table><span class="postbody">
<br/>
But tepples, DaGamer34 is using five (5!) exclamation-marks, he must be knowing what he's talking about.
<br/>
<br/>
<br/>
Zap!</span></td> </tr></table><span class="postbody">
<br/>
<br/>
meaning = !!!!!("You cannot typedef something and call it the same thing");
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12640 - poslundc - Thu Nov 20, 2003 3:03 am</h4>
    <div class="postbody"><span class="postbody">Now that's bad. I don't know if I'm more ashamed of you for making the joke or myself for getting it.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12641 - sgeos - Thu Nov 20, 2003 3:37 am</h4>
    <div class="postbody"><span class="postbody">Glad I could be of service.  (Or !, whatever the case may be.)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
