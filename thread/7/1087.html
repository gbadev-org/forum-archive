<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Tool code question. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Tool code question.</h2>
<div id="posts">
<div class="post">
    <h4>#5296 - Saj - Thu Apr 24, 2003 7:27 pm</h4>
    <div class="postbody"><span class="postbody">Hey,
<br/>
This may seem off-topic but it's not because I'm going to use it in a GBA Dev Tool. 
<br/>
(It's a Win32 App and I'm using VC++ to create it.)
<br/>
<br/>
Anyways, I'm trying to get this code to work. It's from a tutorial 
<br/>
(http://winprog.org/tutorial/)(App part 1 and part 2)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Â Edited: A big slab of code was here but I removed it for the sake of not wasting forum space. </td> </tr></table><span class="postbody">
<br/>
<br/>
To simplify, These are the lines I'm having problems with :-
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pszFileText = GlobalAlloc(GPTR, dwFileSize + 1); // line 29 - Error here!</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pszText = GlobalAlloc(GPTR, dwBufferSize); // line 67 - Error here!</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(WriteFile(hFile, pszText, dwTextLength, &amp;dwWritten, NULL)) // line 74 - Error here!</td> </tr></table><span class="postbody">
<br/>
<br/>
The errors I get are :-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
C:\Projects\Win\win3\win3.cpp(29) : error C2440: '=' : cannot convert from 'void *' to 'char *'
<br/>
Conversion from 'void*' to pointer to non-'void' requires an explicit cast
<br/>
C:\Projects\Win\win3\win3.cpp(67) : error C2440: '=' : cannot convert from 'void *' to 'char *'
<br/>
Conversion from 'void*' to pointer to non-'void' requires an explicit cast
<br/>
C:\Projects\Win\win3\win3.cpp(74) : error C2664: 'WriteFile' : cannot convert parameter 4 from 'unsigned short *' to 'unsigned long *'
<br/>
Types pointed to are unrelated; conversion requires reinterpret_cast, C-style cast or function-style cast
<br/>
Error executing cl.exe.</td> </tr></table><span class="postbody">
<br/>
I've tried to do the first 2 casts explicitly :-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pszText = (LPSTR)GlobalAlloc(GPTR, dwBufferSize);</td> </tr></table><span class="postbody">
<br/>
Will this work? I can't test it because of the (line 74) 'WriteFile' Error. :(
<br/>
<br/>
Please hep me to do the casts or whatever else that may fix it...
<br/>
Thanks.<br/>_________________<br/>---------------------------------------------------
<br/>
<a class="postlink" href="http://www.theanimalrescuesite.com/cgi-bin/WebObjects/CTDSites.woa" target="_blank">Click here to give free food to starving animals.</a>
<br/>
--------------------------------------------------</span><span class="gensmall"><br/><br/>Last edited by Saj on Mon Apr 28, 2003 9:32 am; edited 3 times in total</span></div>    
</div>
<div class="post">
    <h4>#5297 - Saj - Thu Apr 24, 2003 7:35 pm</h4>
    <div class="postbody"><span class="postbody">Never mind. I fixed it by using a Double Word instead of a Word.
<br/>
Thanks anyways....<br/>_________________<br/>---------------------------------------------------
<br/>
<a class="postlink" href="http://www.theanimalrescuesite.com/cgi-bin/WebObjects/CTDSites.woa" target="_blank">Click here to give free food to starving animals.</a>
<br/>
--------------------------------------------------</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5333 - Sweex - Fri Apr 25, 2003 1:14 pm</h4>
    <div class="postbody"><span class="postbody">No offense (really), but think about your code real hard before posting complete slabs of code on a forum. Makes you a better programmer IMHO...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5448 - Saj - Mon Apr 28, 2003 9:33 am</h4>
    <div class="postbody"><span class="postbody">point taken sweex.
<br/>
<br/>
I've removed the slab of code from the original message.<br/>_________________<br/>---------------------------------------------------
<br/>
<a class="postlink" href="http://www.theanimalrescuesite.com/cgi-bin/WebObjects/CTDSites.woa" target="_blank">Click here to give free food to starving animals.</a>
<br/>
--------------------------------------------------</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
