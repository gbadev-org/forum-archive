<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Wierd Array Error - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Wierd Array Error</h2>
<div id="posts">
<div class="post">
    <h4>#2493 - GbaGuy - Tue Feb 04, 2003 11:40 pm</h4>
    <div class="postbody"><span class="postbody">When I go like this:
<br/>
<br/>
VRAM[0x560] = 0xFF00;
<br/>
<br/>
The compiler goes like this:
<br/>
<br/>
6: invalid types `int[int]' for array subscript
<br/>
<br/>
Why?
<br/>
<br/>
VRAM is defined as:
<br/>
<br/>
#define VRAM (u16*)0x6000000
<br/>
<br/>
Any help would be extremely appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2501 - tepples - Wed Feb 05, 2003 1:16 am</h4>
    <div class="postbody"><span class="postbody">What's happening is operator precedence interacting in initially unexpected way with your macro.
<br/>
<br/>
Your code:
<br/>
#define VRAM (u16*)0x6000000 
<br/>
VRAM[0x560] = 0xFF00; 
<br/>
<br/>
Expands inside the preprocessor to this:
<br/>
(u16*)0x6000000[0x560] = 0xFF00; 
<br/>
<br/>
Which the expression parser turns into this:
<br/>
(u16 *)(0x6000000[0x560]) = 0xff00;
<br/>
<br/>
In an a[b] expression, one of a or b must be a pointer, and the other must be an integer.  (Trivia: a[b] means the same as b[a].)  But in your expression, a and b are both integers, hence the error about invalid int[int].
<br/>
<br/>
To fix this, put parentheses around your macro:
<br/>
#define VRAM ((u16*)0x6000000)<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2504 - GbaGuy - Wed Feb 05, 2003 2:05 am</h4>
    <div class="postbody"><span class="postbody">Wow, thanks a lot!
<br/>
<br/>
I would have never (well, maybe eventually) figured 
<br/>
that out myself.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
