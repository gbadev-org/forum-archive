<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>C++ file organization - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>C/C++ > C++ file organization</h2>
<div id="posts">
<div class="post">
    <h4>#18347 - poslundc - Wed Mar 24, 2004 6:30 pm</h4>
    <div class="postbody"><span class="postbody">I've used C++ for a number of projects but never for anything requiring more than a few files. I was wondering what the pitfalls of file organization in C++ are as opposed to C.
<br/>
<br/>
In C I would never put any executable code in a header file, but class definitions seem a bit more ambiguous from the C++ point of view.
<br/>
<br/>
What I want to do is similar to what I would do in C or Objective C, but I don't know if it's correct. That is:
<br/>
<br/>
- I would put the class <span style="font-weight: bold">structure</span> - including its members and method <span style="font-style: italic">prototypes</span> (and code for inline methods as well, I suppose) - in a header file which could then be #included by any other C or C++ file that accesses the object.
<br/>
<br/>
- I would then put the actual method routines in a separate .cpp file devoted specifically for that class, which could then be linked to.
<br/>
<br/>
Is this the correct way to do things in practice? On the Internet, many of the examples I see place code directly in the class definition, especially in the case of things like constructors and operators. Is this kosher, or is it considered bad programming? What is the structured way to do this stuff in C++?
<br/>
<br/>
Thanks,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18348 - yaustar - Wed Mar 24, 2004 6:42 pm</h4>
    <div class="postbody"><span class="postbody">The way I have been taught is to do put structs, function prototypes in te header file and variables into private...but thinking about it, is this correct. It is against the what I learnt here about data into headers...ah well....here is an example
<br/>
<br/>
header
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//----------------------------------//
<br/>
//Author: Steven Yau            //
<br/>
//Updated: 03/03/2003            //
<br/>
//Reference: <a href="http://www.gametutorials.com " target="_blank">www.gametutorials.com </a>  //
<br/>
//----------------------------------//
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
struct NODE
<br/>
{
<br/>
   int data;                  //This is our data
<br/>
<br/>
   NODE *next;                  //This is a pointer to "our next node" in our linked list
<br/>
   NODE *prev;                  //This is a pointer to "our previous node" in the linked list
<br/>
};
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
class lList  
<br/>
{
<br/>
public:
<br/>
   lList(void);               //Constructor set pointers to NULL
<br/>
   virtual ~lList(void);         //Destructor, frees all memory
<br/>
   void insert(int newData);      //Inesrts a node into into list before current NODE
<br/>
   void deltree(void);            //Deletes a node
<br/>
   int get(void);               //Returns data from NODE 'nodeNO'
<br/>
   void up(void);               //Goes up a node
<br/>
   void down(void);            //Goes down a node
<br/>
   int size(void);               //Returns the size of the list
<br/>
<br/>
   //Functions that were used in this development
<br/>
   int whatNode(void);            //Returns currentNode
<br/>
   void pointers(void);         //Returns the memory address of 'prev' and 'next'
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
private:
<br/>
   NODE *begin;               //The first node
<br/>
   NODE *end;                  //The last of the list *will always be empty?*
<br/>
   NODE *currentNode;            //What NODE are we at. Points to current NODE
<br/>
<br/>
   //Variables used for developing for this program
<br/>
   int currentNodeNo;
<br/>
};
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
//end code</td> </tr></table><span class="postbody">
<br/>
cpp
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//----------------------------------//
<br/>
//Author: Steven Yau            //
<br/>
//Updated: 03/03/2003            //
<br/>
//Reference: <a href="http://www.gametutorials.com " target="_blank">www.gametutorials.com </a>  //
<br/>
//----------------------------------//
<br/>
<br/>
#include &lt;stdlib.h&gt;
<br/>
#include &lt;iostream.h&gt;
<br/>
#include "lList.h"
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
lList::lList(void){ 
<br/>
   begin = NULL;               //Linked list must have a beginning, this is a 
<br/>
                           //simple way of declearing it is empty ('NULL' 
<br/>
                           //needs the "#include &lt;stdlib.h&gt;"
<br/>
   end = NULL;               
<br/>
   currentNode = begin;         //Shows us what node we are currently at
<br/>
<br/>
   currentNodeNo = 1;
<br/>
}
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
lList::~lList(void){
<br/>
   NODE *walker = begin;         //Set a "walker node" to the front of the list
<br/>
<br/>
   while(walker != NULL)
<br/>
   {
<br/>
      NODE *temp = walker;      //Create a temp node 
<br/>
      walker = walker-&gt;next;      //Move the walker to the prevoius node on the list
<br/>
      delete temp;            //Free the memory (note the keyword 'delete', this 
<br/>
                           //deallocate memory
<br/>
   }
<br/>
<br/>
   begin = end = NULL;            //Resets begin and end to NULL
<br/>
}
<br/>
<br/>
//----------------------------------//
<br/>
<br/>
void lList::insert(int newData){   //Arraghh! Cannot insert before 'begin' yet...
<br/>
   if(begin == NULL){            //If the list NODE is empty
<br/>
      //All this is basically initialisation for when data is inserted
<br/>
      //This will be changed in a later version
<br/>
      begin = new NODE;         //Allocate memory to 'begin'
<br/>
      begin-&gt;data = newData;
<br/>
      begin-&gt;prev = NULL;
<br/>
<br/>
      end = new NODE;            //Allocate memory to 'end'
<br/>
      end-&gt;data = 20;
<br/>
      end-&gt;next = NULL;         
<br/>
      end-&gt;prev = begin;         //Prev points to prevoius NODE
<br/>
<br/>
      begin-&gt;next = end;
<br/>
<br/>
      currentNode = begin;
<br/>
   }
<br/>
<br/>
   //Too many flipping pointers!!!
<br/>
<br/>
   else{if(currentNode != begin){
<br/>
   NODE *node = new NODE;         //Allocate memory for an empty node
<br/>
   
<br/>
   //Making sure all the pointers are pointers are pointing to the right place.
<br/>
   //This is very hard to follow, best use a piece of papar and pen to keep track
<br/>
   //of this (I had to :p).
<br/>
   node-&gt;data = newData;
<br/>
   node-&gt;next = currentNode;
<br/>
   node-&gt;prev = currentNode-&gt;prev;
<br/>
<br/>
   currentNode-&gt;prev = node;
<br/>
   currentNode = node-&gt;prev;
<br/>
<br/>
   currentNode-&gt;next = node;
<br/>
   currentNode = node;
<br/>
<br/>
   begin-&gt;prev = NULL;
<br/>
   end-&gt;next = NULL;
<br/>
      }   
<br/>
   }      
<br/>
}
<br/>
<br/>
etc
<br/>
<br/>
//end code
<br/>
<br/>
//functions coded:   insert()
<br/>
//               get()
<br/>
//               deltree()
<br/>
//               size()
<br/>
//can insert and delete data BETWEEN the 'begin' and the 'end' at present</td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18352 - sajiimori - Wed Mar 24, 2004 7:35 pm</h4>
    <div class="postbody"><span class="postbody">The method you were describing is pretty standard.
<br/>
<br/>
If the internet examples you were mentioning have some inlined methods, it's normal to put those in the header.  If they were putting non-inlined methods in headers, that's a bad thing as usual.
<br/>
<br/>
Another guideline I've heard is to never include headers from headers, but instead force the user to include the headers that are required beforehand.  I'm not sure I agree with that one.  Maybe one benefit is that you don't have to put #ifdef/#endif in every header.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18355 - poslundc - Wed Mar 24, 2004 9:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">Another guideline I've heard is to never include headers from headers, but instead force the user to include the headers that are required beforehand.  I'm not sure I agree with that one.  Maybe one benefit is that you don't have to put #ifdef/#endif in every header.</td> </tr></table><span class="postbody">
<br/>
<br/>
That seems impractical. What if you are subclassing another class or (to reduce it to a more generic C case) you are building a module that uses another module and the data structures from that module?
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18359 - sajiimori - Wed Mar 24, 2004 10:47 pm</h4>
    <div class="postbody"><span class="postbody">I guess the idea is to document the requirement and make people include the base class header first.  But I agree that this is annoying.
<br/>
<br/>
One habit I did get into was forward-declaring classes instead of including their headers, when possible.  This reduces compile times without messing with pimpl.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
class Widget;
<br/>
<br/>
class Blah
<br/>
{
<br/>
 public:
<br/>
  void FrobWidget(Widget* w);
<br/>
};
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18362 - bomberman - Wed Mar 24, 2004 11:53 pm</h4>
    <div class="postbody"><span class="postbody">200% agree with sajimori...
<br/>
<br/>
People tend to #include whenever they need a class or struct. Very bad habit ! On big projects, it kills your compile time. So always try to use pointers or references, this way you can use the forward declaration feature. Otherwise, you need to #include.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18367 - LOst? - Thu Mar 25, 2004 12:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>bomberman wrote:</b></span></td> </tr> <tr> <td class="quote">200% agree with sajimori...
<br/>
<br/>
People tend to #include whenever they need a class or struct. Very bad habit ! On big projects, it kills your compile time. So always try to use pointers or references, this way you can use the forward declaration feature. Otherwise, you need to #include.</td> </tr></table><span class="postbody">
<br/>
<br/>
I have never forward-declarated any classes before. Even though it takes less time to compile, I think it's wrong because you have no idea where the class is declared if you can't search inside files for it.
<br/>
<br/>
As long as you arrange the classes the basic style, I think it's pretty much okay coded. Though I think it's a pain in the ass to create classes inside header files and then have a CPP version where you put all it's methods, but it's the right way because then you can use a library, which I never do anyway.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18375 - Andy Friesen - Thu Mar 25, 2004 6:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Another guideline I've heard is to never include headers from headers, but instead force the user to include the headers that are required beforehand.</td> </tr></table><span class="postbody">
<br/>
<br/>
ew.  NO.
<br/>
<br/>
if X.cpp needs class Y, it should include Y.h.  It should <span style="font-style: italic">not</span> care one whit about what Y depends on.  This violates the underlying idea of what exactly encapsulation means, not to mention the simple fact that it quickly becomes an irritation.
<br/>
<br/>
In general, you want to prototype instead of #including everywhere you can, but if #include is necessary, so be it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Maybe one benefit is that you don't have to put #ifdef/#endif in every header.</td> </tr></table><span class="postbody">
<br/>
<br/>
Maybe, but I hardly think it's a worthwhile tradeoff to have to include umpteen headers just to use one class.  Further, when you have a sea of includes at the top of a source file like that, you're more likely to redundantly include some header or other than ever.
<br/>
<br/>
Back to the initial topic of the post, the general rule is that declarations go in the header and definitions go in the source file.  There are two exceptions to this: things you want (need) to be inlined and templates must both be declared in the header.<br/>_________________<br/><span style="font-style: italic">"Tell a man there are 300 billion stars in the universe and he'll believe you. Tell him a bench has wet paint on it and he'll have to touch it to be sure."</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18376 - sajiimori - Thu Mar 25, 2004 7:22 am</h4>
    <div class="postbody"><span class="postbody">You're preaching to the choir, fella. ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18378 - OptiRoc - Thu Mar 25, 2004 8:23 am</h4>
    <div class="postbody"><span class="postbody">poslundc got it all right from the start -- per usual it seems. :)
<br/>
<br/>
The main (only?) difference from C would be that actual code can, and should be, written in header files for inlines and templates.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18386 - bomberman - Thu Mar 25, 2004 11:55 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I have never forward-declarated any classes before. Even though it takes less time to compile, I think it's wrong because you have no idea where the class is declared if you can't search inside files for it. 
<br/>
<br/>
As long as you arrange the classes the basic style, I think it's pretty much okay coded. Though I think it's a pain in the ass to create classes inside header files and then have a CPP version where you put all it's methods, but it's the right way because then you can use a library, which I never do anyway.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
As long as your project consists in one file, yes you do not need headers :O) But let's be serious, you won't go very far like this !
<br/>
Why is it a pain in the ass ? This is clean. In headers you expose everything you provide to other projects. You HAVE to separate the interface and the implementation.
<br/>
<br/>
Reasons for forward declaration:
<br/>
- knowing where the class is declared is not essential.You do not want to know where the class is declared, you want to use it ! You must think in terms of concepts, not in terms of implementation. If you move your file (which can happen often during the life of your project), then you have to modify all the headers depending on it.
<br/>
- if you really want to know where the class is declared, all decent compilers or IDEs give you a browser. You right click on your class and then you are transported to declaration/implementation/use case, which is even better. Personnally,  I do not use browsers, I use my memory :)
<br/>
- If your files are organized in an intelligent way, (nice file hierarchy, namespaces), even without a browser or without memory, it should be easy to find your class. If it is not the case, maybe it's time to rethink it.
<br/>
- when using things like STL or CORBA, which are heavily templated, if you #include everything, your time compile will be 200% or 300% longer. This IS a fact we have experienced !</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18400 - torne - Thu Mar 25, 2004 3:25 pm</h4>
    <div class="postbody"><span class="postbody">Surely the easiest way to find your classes while forward-declaring them is to name your files after the classes they contain? =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18405 - Sweex - Thu Mar 25, 2004 4:52 pm</h4>
    <div class="postbody"><span class="postbody">Indeed, and unless classes are really closely related, put each class in a seperate .h + .cpp!
<br/>
<br/>
Also, try to keep the number of lines limited, let's say no more than 2000 lines.
<br/>
<br/>
(Currently I'm browsing through files of up to 13000 lines and it's HORRIBLE! Find in Files is my main "tool" nowadays!:-( )<br/>_________________<br/>If everything fails, read the manual: If even that fails, post on forum!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18414 - sajiimori - Thu Mar 25, 2004 8:09 pm</h4>
    <div class="postbody"><span class="postbody">That's one thing I noticed when switching to Lisp -- big files are much more practical, given a good editor.
<br/>
<br/>
Just looking at my old C++ project folders gives me a headache.  Giving each class it's own pair of .cpp/.h files is probably the right thing to do, but it only makes the best of a bad situation.
<br/>
<br/>
I always found that I was discouraged from making new abstractions (even when I thought it would lead to superior design) because the costs were too great -- 2 more project files, and a bunch of useless "ifdef endif include class public virtual void const" scaffolding that has nothing to do with the task at hand.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18423 - poslundc - Thu Mar 25, 2004 8:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">I always found that I was discouraged from making new abstractions (even when I thought it would lead to superior design) because the costs were too great -- 2 more project files, and a bunch of useless "ifdef endif include class public virtual void const" scaffolding that has nothing to do with the task at hand.</td> </tr></table><span class="postbody">
<br/>
<br/>
I suppose one solution would be an IDE that can template/automate most of this stuff for you.
<br/>
<br/>
Personally, I <span style="font-style: italic">like</span> having to do all that stuff. I find it gives me a chance to think through my implementation while I'm actually doing it, but before I start doing any hardcore coding. Inflicting a little busywork on yourself can do wonders for the quality of the code you write. YMMV, naturally.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
