<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Using recursion - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Using recursion</h2>
<div id="posts">
<div class="post">
    <h4>#3068 - Vortex - Mon Feb 17, 2003 5:07 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
I am using a FloodFill like algorithm, which is recursive. I am wondering how deep the GBA stack is, or in other words, how deep the recursion could be. I tried to convert the algorithm to a non-recursive one, but it is not very efficient.
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3073 - col - Mon Feb 17, 2003 7:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Vortex wrote:</b></span></td> </tr> <tr> <td class="quote">Hello,
<br/>
<br/>
I am using a FloodFill like algorithm, which is recursive. I am wondering how deep the GBA stack is, or in other words, how deep the recursion could be. I tried to convert the algorithm to a non-recursive one, but it is not very efficient.
<br/>
<br/>
Thanks</td> </tr></table><span class="postbody">
<br/>
<br/>
The available stack space depends on how much of the iwram you are using for other things - code, data...
<br/>
<br/>
The amount of stack space used by each recursion depends on how complicated the algorithm is - how many variables need to be pushed on to the stack.
<br/>
If you use the --save-temps(i think?) switch, you can check the asm output to see how much stack each recursion is using.
<br/>
<br/>
you can use gcc to create a map file,  then check this to see how much iwram is left for the stack, you can then edit your linkscript to give the stack more iwram:
<br/>
if you're using Jeffs linkscript and crt0, look in the linkscript for the line
<br/>
__iheap_end       = 0x3008000 - 0x400;
<br/>
increase the 0x400 to give yours stack more space and the iwram heap less.
<br/>
(my stack can use as much as 10k of iwram sometimes :))
<br/>
<br/>
Recursive algorithms are great on gba - they can be very much faster than non-recursive alternatives. All the data is accessed from zero waitstate
<br/>
And there is no cache so, no worries about cache misses. 
<br/>
<br/>
cheers
<br/>
<br/>
Col</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3109 - Paul Shirley - Tue Feb 18, 2003 2:33 pm</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:40 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#3115 - tepples - Tue Feb 18, 2003 4:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Paul Shirley wrote:</b></span></td> </tr> <tr> <td class="quote">Recursive floodfill algorithms are notoriously inefficient and wasteful of stack. Researching the alternatives would do more good...</td> </tr></table><span class="postbody">
<br/>
The completely non-recursive flood fill algorithms that were once used for vector graphics in 8-bit adventure games can't handle upward or downward convex edges.  You'll still have to maintain some sort of stack of edges to check.
<br/>
<br/>
However, the searches for similar-colored pixels to the left and to the right can be done correctly without recursion, which saves a ton of space and time.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
