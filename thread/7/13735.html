<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Template class member prototype help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Template class member prototype help</h2>
<div id="posts">
<div class="post">
    <h4>#135260 - LOst? - Sat Jul 21, 2007 3:38 pm</h4>
    <div class="postbody"><span class="postbody">Hello, some trouble in template land.
<br/>
<br/>
I need to make a prototype of "int TestB::j" and void "TestB::g (void)" for use with TestA. Help! And I can't reverse TestA's and TestB's order. Note that both TestA and TestB are derived from TestBase, and are templates!
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// So far I know how to make a prototype of the class... But
<br/>
// I need prototypes for some members too. What to do?
<br/>
template &lt;typename T, typename I&gt;
<br/>
class TestB;
<br/>
<br/>
template &lt;typename T, typename I&gt;
<br/>
class TestA
<br/>
:    public TestBase &lt;T, I&gt;
<br/>
{
<br/>
public:
<br/>
    int i;
<br/>
<br/>
    void f (TestBase* pTest)
<br/>
    {
<br/>
        ((TestB &lt;T, I&gt;*) pTest)-&gt;g ();    // g function member is not defined in class TestB
<br/>
        ((TestB &lt;T, I&gt;*) pTest)-&gt;j = 2;    // j member is not defined in class TestB
<br/>
    }
<br/>
};
<br/>
<br/>
template &lt;typename T, typename I&gt;
<br/>
class TestB
<br/>
:    public TestBase &lt;T, I&gt;
<br/>
{
<br/>
public:
<br/>
    int j;
<br/>
<br/>
    void g (void)
<br/>
    {
<br/>
    }
<br/>
};
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><span style="font-style: italic">Exceptions are fun</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135314 - sajiimori - Sun Jul 22, 2007 3:58 am</h4>
    <div class="postbody"><span class="postbody">Reversing the order of the definitions is the obvious and simple solution, and if you think you can't do it, I'd consider rethinking your design.
<br/>
<br/>
But if you really want to leave the definitions backwards, you can define the body of TestA::f after TestB is defined, or have TestA::f do its work indirectly via some other function that's defined after TestB.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135325 - sgeos - Sun Jul 22, 2007 9:22 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">and if you think you can't do it, I'd consider rethinking your design.</td> </tr></table><span class="postbody">
<br/>
I suspect the old A needs B and B needs A applies to templates.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">template &lt;class Type&gt; class B;
<br/>
<br/>
template &lt;class Type&gt;
<br/>
class A
<br/>
{
<br/>
   B&lt;Type&gt; *list;
<br/>
   // other members
<br/>
};
<br/>
<br/>
template &lt;class Type&gt;
<br/>
class B
<br/>
{
<br/>
   A&lt;Type&gt; data;
<br/>
   // other members
<br/>
};</td> </tr></table><span class="postbody">
<br/>
Upon thinking about it, I don't know what you would be doing though...  Generalized lists?  I'm interested if anybody knows.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135326 - keldon - Sun Jul 22, 2007 9:38 am</h4>
    <div class="postbody"><span class="postbody">Well I tried this and it compiled perfectly fine (in Visual C++). Also if TestA depends on TestB then why must TestA be defined first? And what happens when pTest is not a TestB?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135327 - wintermute - Sun Jul 22, 2007 10:37 am</h4>
    <div class="postbody"><span class="postbody">Why don't we all pitch in and do people's homework for them? :P
<br/>
<br/>
Or is it just me that thinks this looks like a test question?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135334 - keldon - Sun Jul 22, 2007 1:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Why don't we all pitch in and do people's homework for them? :P
<br/>
<br/>
Or is it just me that thinks this looks like a test question?</td> </tr></table><span class="postbody">
<br/>
lol; puns are Evil ^_^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135343 - LOst? - Sun Jul 22, 2007 3:44 pm</h4>
    <div class="postbody"><span class="postbody">Well, redesigning is in order. The example is just an example, because I wanted to know the forward declaration syntax.<br/>_________________<br/><span style="font-style: italic">Exceptions are fun</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135344 - keldon - Sun Jul 22, 2007 3:50 pm</h4>
    <div class="postbody"><span class="postbody">Are you sure there's not something else wrong in your code, such as a class without a semi-colon? The reason I ask is because the code worked fine for me!!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135368 - sajiimori - Sun Jul 22, 2007 8:35 pm</h4>
    <div class="postbody"><span class="postbody">The code highights a subtlety about how and when symbols are looked up for templatized code.  I wouldn't be surprised if the behavior was different across compilers -- it's just one of those dark corners that should be avoided.
<br/>
<br/>
For more history on name lookups in templatized code, check out "The Design and Evolution of C++".
<br/>
<br/>
Oh, and don't blame templates for the problem (in case you were going to): if the code wasn't templatized, it would fail to compile on <span style="font-style: italic">all</span> compilers, rather than working on some of them.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
