<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>vectors - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > vectors</h2>
<div id="posts">
<div class="post">
    <h4>#7664 - hnager - Sun Jun 22, 2003 7:06 pm</h4>
    <div class="postbody"><span class="postbody">I have a project in mind which will work best with the vector template, but I'm having trouble compiling with g++.
<br/>
<br/>
This is the error I get:
<br/>
<br/>
main.cpp:3: syntax error before `;' token
<br/>
main.cpp: In function `int main()':
<br/>
main.cpp:7: `EmptyVector' undeclared (first use this function)
<br/>
main.cpp:7: (Each undeclared identifier is reported only once for each function 
<br/>
   it appears in.)
<br/>
main.cpp:7: parse error before `;' token
<br/>
<br/>
<br/>
when trying to compile this tiny test to see if I can use vectors:
<br/>
<br/>
<br/>
#include &lt;vector&gt;
<br/>
<br/>
typedef vector&lt;int&gt;	EmptyVector;
<br/>
<br/>
int main(){
<br/>
<br/>
	EmptyVector testVector;
<br/>
<br/>
	while(1){}
<br/>
	return 0;
<br/>
}
<br/>
<br/>
<br/>
Are vectors not supported? If not (or frowned upon) how else would I have an array of sprites(for example) where only active sprites are in the list. If I have 10 onscreen enemies and 2 are eliminated then I want to remove them from the list. This is just a basic example of what I'm thinking of doing...can that be done (efficiently) with a normal array? pushing and removing elements at runtime.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7688 - tepples - Sun Jun 22, 2003 11:57 pm</h4>
    <div class="postbody"><span class="postbody">If you're not experienced with the STL, try writing your own vector class or bringing up your issues on [url=news:comp.lang.c++]comp.lang.c++[/url].
<br/>
<br/>
If you want to allocate efficiently from a pool of up to 32 elements, store a 32-bit "bitmap" of which registers are free and then do a search for a free element. The following untested code should find the first set bit in a 32-bit integer:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int bitfield_find_first_one(u32 free_map)
<br/>
{
<br/>
  int free_idx = 0;
<br/>
<br/>
  if(!free_map)  /* if there are no set bits, fail */
<br/>
    return -1;
<br/>
  if(!(free_map &amp; 0x0000ffff))  /* if there are no set bits in lower 16, then shift */
<br/>
  {
<br/>
    free_idx += 16;
<br/>
    free_map &gt;&gt;= 16;
<br/>
  }
<br/>
  if(!(free_map &amp; 0x000000ff))  /* if there are no set bits in lower 8, then shift */
<br/>
  {
<br/>
    free_idx += 8;
<br/>
    free_map &gt;&gt;= 8;
<br/>
  }
<br/>
  if(!(free_map &amp; 0x0000000f))  /* you get the idea */
<br/>
  {
<br/>
    free_idx += 4;
<br/>
    free_map &gt;&gt;= 4;
<br/>
  }
<br/>
  if(!(free_map &amp; 0x00000003))
<br/>
  {
<br/>
    free_idx += 2;
<br/>
    free_map &gt;&gt;= 2;
<br/>
  }
<br/>
  if(!(free_map &amp; 0x00000001))
<br/>
  {
<br/>
    free_idx += 1;
<br/>
    free_map &gt;&gt;= 1;
<br/>
  }
<br/>
  return free_idx;
<br/>
}</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7691 - hnager - Mon Jun 23, 2003 12:31 am</h4>
    <div class="postbody"><span class="postbody">Are we talking about the same thing? Im looking for a vector template as an alternative to using the standard array because of the fact that I may not know how many elements I need until ruintime aswell as the neccesity to remove() elements at runtime.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7692 - hnager - Mon Jun 23, 2003 12:40 am</h4>
    <div class="postbody"><span class="postbody">Ah - found the answer - looks as if  vector is defined in the 'std'
<br/>
namespace (not global). So :
<br/>
<br/>
typedef std::vector&lt;int&gt; EmptyVector;
<br/>
<br/>
Thanks again - does anybody use vectors in their gba dev?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7693 - hnager - Mon Jun 23, 2003 1:04 am</h4>
    <div class="postbody"><span class="postbody">not so fast...I'm getting all kinds of errors :
<br/>
<br/>
unsupported relocation error
<br/>
undefined reference to `write'
<br/>
<br/>
and that's when trying to simply push_back() !!
<br/>
<br/>
If anybody has working examples of vectors in gba development, let me know (especially if you are willing to let me have a peek at working source).
<br/>
<br/>
thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7695 - tepples - Mon Jun 23, 2003 2:18 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hnager wrote:</b></span></td> </tr> <tr> <td class="quote">not so fast...I'm getting all kinds of errors :
<br/>
<br/>
unsupported relocation error
<br/>
undefined reference to `write'</td> </tr></table><span class="postbody">
<br/>
The 'undefined reference to write' is discussed in the "C and C++" section of this board's FAQ.  The 'unsupported relocation error' is a <a class="postlink" href="http://sources.redhat.com/ml/crossgcc/2002-01/msg00045.html" target="_blank">linker bug</a> that may have been fixed in the version of Binutils used in DKA R5b3.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7697 - hnager - Mon Jun 23, 2003 3:51 am</h4>
    <div class="postbody"><span class="postbody">Thanks and thanks ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7710 - Sweex - Mon Jun 23, 2003 11:37 am</h4>
    <div class="postbody"><span class="postbody">I did get STLPort working for the GBA, however, I decided to write my own vector class to have a bit more control over it than using STL.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7914 - hnager - Sat Jun 28, 2003 1:38 pm</h4>
    <div class="postbody"><span class="postbody">I got vectors included without compile errors - however, push_back() causes an unexpected result - the screen (in visualboy advance) turns all white...without that line the screen displays what it's supposed to - in this case I'm using Lupin's DMA Text to just display text. Below is the relevant snippet. thanks again.
<br/>
<br/>
#include &lt;vector&gt;
<br/>
#include "gba.h"
<br/>
<br/>
typedef std::vector&lt;int&gt; INTVECTOR;
<br/>
<br/>
int main(){
<br/>
<br/>
...
<br/>
<br/>
 INTVECTOR theVector;
<br/>
<br/>
theVector.push_back(5);
<br/>
<br/>
...
<br/>
<br/>
while(1){}
<br/>
return 0;
<br/>
}</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
