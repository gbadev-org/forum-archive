<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Newest devkitadv has a problem? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > Newest devkitadv has a problem?</h2>
<div id="posts">
<div class="post">
    <h4>#12952 - MumblyJoe - Tue Dec 02, 2003 6:17 am</h4>
    <div class="postbody"><span class="postbody">Hey, i recently started using the latest devkitadv (used to use a version i cant remember) and now my make.bat file (yeah i know makefiles are better, gimme the source for one if you want) wont work anymore:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">c:\devkitadv\bin\as -o crt0.o crt0.s
<br/>
<br/>
c:\devkitadv\bin\g++ -c -O3 -mthumb -mthumb-interwork -fno-rtti -fno-exceptions Frogger.cpp
<br/>
c:\devkitadv\bin\g++ -mthumb -mthumb-interwork -nostartfiles -T lnkscript -o Frogger.elf crt0.o crtbegin.o crtend.o Frogger.o
<br/>
<br/>
c:\devkitadv\bin\objcopy -O binary Frogger.elf Frogger.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
See, very simple thing, but when I try to compile with the new version I get the following errors:
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">C:\Programming\GBA Projects\TileFrogger&gt;c:\devkitadv\bin\as -o crt0.o crt0.s 
<br/>
<br/>
C:\Programming\GBA Projects\TileFrogger&gt;c:\devkitadv\bin\g++ -c -O3 -mthumb -mthumb-interwork -fno-rtti -fno-exceptions Frogger.cpp 
<br/>
<br/>
C:\Programming\GBA Projects\TileFrogger&gt;c:\devkitadv\bin\g++ -mthumb -mthumb-interwork -nostartfiles -T lnkscript -o Frogger.elf crt0.o crtbegin.o crtend.o Frogger.o 
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: crt0.o(_start): warning: interworking not enabled.
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe:   first occurrence: c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-exit.o): thumb call to arm
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-exit.o): In function `_exit':
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-exit.c:5: internal error: dangerous error
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-sbrk.o): In function `_sbrk':
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-sbrk.c:28: undefined reference to `__appended_end'
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-sbrk.c:28: undefined reference to `__heap_limit'
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-sbrk.c:28: undefined reference to `__appended_start'
<br/>
collect2: ld returned 1 exit status
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: crt0.o(_start): warning: interworking not enabled.
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe:   first occurrence: c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-exit.o): thumb call to arm
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-exit.o): In function `_exit':
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-exit.c:5: internal error: dangerous error
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-sbrk.o): In function `_sbrk':
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-sbrk.c:28: undefined reference to `__appended_end'
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-sbrk.c:28: undefined reference to `__heap_limit'
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-sbrk.c:28: undefined reference to `__appended_start'
<br/>
<br/>
C:\Programming\GBA Projects\TileFrogger&gt;c:\devkitadv\bin\objcopy -O binary Frogger.elf Frogger.gba 
<br/>
c:\devkitadv\bin\objcopy: Frogger.elf: No such file or directory
<br/>
<br/>
Tool completed with exit code 1</td> </tr></table><span class="postbody">
<br/>
<br/>
Any ideas? some changes I cant find out about anywhere?<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12959 - tepples - Tue Dec 02, 2003 6:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MumblyJoe wrote:</b></span></td> </tr> <tr> <td class="quote">Hey, i recently started using the latest devkitadv (used to use a version i cant remember) and now my make.bat file (yeah i know makefiles are better, gimme the source for one if you want) wont work anymore</td> </tr></table><span class="postbody">
<br/>
I looked through your error messages. It appears that DevKit Advance R5's new support for appended data means that you have to use its crt0 and lnkscript. If you must use a modplayer that requires its own lnkscript, try merging its changes into a copy of DKA5's lnkscript.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12965 - Quirky - Tue Dec 02, 2003 8:44 pm</h4>
    <div class="postbody"><span class="postbody">There was a post on the AAS dev list with the same problem (and later a work around in this case - see <a href="http://groups.yahoo.com/group/aas-dev/message/47" target="_blank">http://groups.yahoo.com/group/aas-dev/message/47</a> )
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>James Daniels wrote:</b></span></td> </tr> <tr> <td class="quote">The libraries that come with r5b3 expect a different lnkscript.Specifically, they need different names for the the memory addresses than were used in earlier versions of devkitadv. I'm not sure why they were changed in r5b3 as doing so just introduces incompatibilities between libraries written for different versions of devkitadv. </td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12974 - jd - Tue Dec 02, 2003 10:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quirky wrote:</b></span></td> </tr> <tr> <td class="quote">There was a post on the AAS dev list with the same problem (and later a work around in this case - see <a href="http://groups.yahoo.com/group/aas-dev/message/47" target="_blank">http://groups.yahoo.com/group/aas-dev/message/47</a> )
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I should point out that that work around was to allow non-r5b3 libraries to work with r5b3 - there's nothing specific to AAS about the problem or the solution.
<br/>
<br/>
However, judging from the make.bat above, the original poster isn't using any non-r5b3 libraries, so just using r5b3's lnkscript should fix the problem.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>James Daniels wrote:</b></span></td> </tr> <tr> <td class="quote">The libraries that come with r5b3 expect a different lnkscript. Specifically, they need different names for the the memory addresses than were used in earlier versions of devkitadv. I'm not sure why they were changed in r5b3 as doing so just introduces incompatibilities between libraries written for different versions of devkitadv. </td> </tr></table><span class="postbody">
<br/>
<br/>
I've since spoken to Jason Wilkins about this and apparently this incompatibility will be fixed in future versions of devkitadv. (After all, r5b3 is only a beta.)
<br/>
<br/>
By the way, if anyone knows how to make a library that will work with all versions of devkitadv in the mean time then please let me know.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12980 - MumblyJoe - Tue Dec 02, 2003 11:13 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the info, I will try playing around with my lnkscript. As a side note, I cant get into the yahoo group you listed, could you post any of the relevant info here or can someone get <a href="mailto:dirkownsyou@yahoo.com.au">dirkownsyou@yahoo.com.au</a> into the group (I have no idea how yahoo groups work, I only got the login just for this).
<br/>
<br/>
<br/>
<span style="font-style: italic"><span style="font-weight: bold">Edit:</span></span><span style="font-weight: bold">Never mind, I just managed to join the group, I hate yahoo.</span>
<br/>
<br/>
Using the lnkscript they provide I get this error:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">C:\Programming\GBA Projects\TileFrogger&gt;as -o crt0.o crt0.s 
<br/>
<br/>
C:\Programming\GBA Projects\TileFrogger&gt;g++ -c -O3 -mthumb -mthumb-interwork -fno-rtti -fno-exceptions Frogger.cpp 
<br/>
<br/>
C:\Programming\GBA Projects\TileFrogger&gt;g++ -mthumb -mthumb-interwork -nostartfiles -T lnkscript -o Frogger.elf crt0.o crtbegin.o crtend.o Frogger.o 
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe: crt0.o(_start): warning: interworking not enabled.
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\bin\ld.exe:   first occurrence: c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-exit.o): thumb call to arm
<br/>
c:\devkitadv\bin\..\lib\gcc-lib\arm-agb-elf\3.2.2\..\..\..\..\arm-agb-elf\lib\thumb/interwork\libc.a(agb-exit.o): In function `_exit':
<br/>
../../../../../../../../gcc-3.2.2/newlib/libc/sys/agb/agb-exit.c:5: internal error: dangerous error
<br/>
<br/>
C:\Programming\GBA Projects\TileFrogger&gt;objcopy -O binary Frogger.elf Frogger.gba 
<br/>
<br/>
Tool completed successfully</td> </tr></table><span class="postbody">
<br/>
<br/>
Any ideas?<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12984 - jd - Tue Dec 02, 2003 11:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MumblyJoe wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Using the lnkscript they provide I get this error:
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
From the .bat file you provided, it doesn't look like you need this lnkscript since you're not trying to use libraries from different versions of devkitadv. I'd recommend using r5b3's default crt0.s and lnkscript instead. I've never done this myself but I believe you can do this by changing this line:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
c:\devkitadv\bin\g++ -mthumb -mthumb-interwork -nostartfiles -T lnkscript -o Frogger.elf crt0.o crtbegin.o crtend.o Frogger.o
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
To this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
c:\devkitadv\bin\g++ -mthumb -mthumb-interwork Frogger.elf Frogger.o
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
(You can also skip the bit that assembles crt0.s)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12985 - MumblyJoe - Wed Dec 03, 2003 12:07 am</h4>
    <div class="postbody"><span class="postbody">OK, the line you suggested I edit in my batch file works to a degree, I dont get the same errors :)
<br/>
<br/>
Now I get lots of errors about multiple definitions (impossible, I'm very stringent with inclusion guards).
<br/>
<br/>
Maybe I should finally get off my ass and write a damn makefile, although of course this wouldnt fix my problem it would keep me busy...
<br/>
<br/>
Anyone wanna post what they use to compile nowadays?<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12986 - jd - Wed Dec 03, 2003 12:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MumblyJoe wrote:</b></span></td> </tr> <tr> <td class="quote">OK, the line you suggested I edit in my batch file works to a degree, I dont get the same errors :)
<br/>
<br/>
Now I get lots of errors about multiple definitions (impossible, I'm very stringent with inclusion guards).
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If you're comfortable emailing me your project then I'll have a go at tracking down the problem for you. My address is: <a href="mailto:james.daniels@apex-designs.net">james.daniels@apex-designs.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12996 - evil saltine - Wed Dec 03, 2003 6:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jd wrote:</b></span></td> </tr> <tr> <td class="quote">To this:
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
c:\devkitadv\bin\g++ -mthumb -mthumb-interwork Frogger.elf Frogger.o
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
(You can also skip the bit that assembles crt0.s)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Er... wouldn't it be
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
c:\devkitadv\bin\g++ -mthumb -mthumb-interwork -o Frogger.elf Frogger.o
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I was missing the -o before and it gave tons of multiple definition errors, so that may be MumblyJoe's problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#12997 - MumblyJoe - Wed Dec 03, 2003 7:19 am</h4>
    <div class="postbody"><span class="postbody">Thanks everyone, the missing -o was the cause of the problem. I'm up and running again, I cant thank you all enough.<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
