<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Adding to arrays? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Adding to arrays?</h2>
<div id="posts">
<div class="post">
    <h4>#96477 - Nave Adair - Thu Aug 03, 2006 3:21 pm</h4>
    <div class="postbody"><span class="postbody">I have an array of enemies, like:
<br/>
u8 enemy1[5];
<br/>
<br/>
So that gives me enemy1[0] through enemy1[4]. Say I wanted to extend it to six places, giving me enemy1[5], how would I do that, if possible?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96498 - racarate - Thu Aug 03, 2006 4:33 pm</h4>
    <div class="postbody"><span class="postbody">In C, use a linked list.
<br/>
<br/>
In C++, use a std::vector.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="font-weight: bold">Neko: I love meow-tain climbing! 
<br/>
Need anything? I'll even save your game!</span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96508 - Nave Adair - Thu Aug 03, 2006 5:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>racarate wrote:</b></span></td> </tr> <tr> <td class="quote">In C, use a linked list.
<br/>
<br/>
In C++, use a std::vector.</td> </tr></table><span class="postbody">
<br/>
Okay? Do you have an example or know of any decent tutorials on vectors?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96520 - naleksiev - Thu Aug 03, 2006 6:03 pm</h4>
    <div class="postbody"><span class="postbody">Linked list is something you defenetly need to learn.
<br/>
Just look in google about "C++ linked list" and you will find a lot of information. 
<br/>
<br/>
But depending from the game sometimes is better to add an array with the enemies even a little bigger that you will need most of the time. So you can have a flag is this enemy exist or it's just a part of the array that you still not using. The pluses in this case are that you do not need to allocate/dealocate memory all the time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96528 - sgeos - Thu Aug 03, 2006 6:12 pm</h4>
    <div class="postbody"><span class="postbody">The alternative is to cap the size of the array instead of growing it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int itemCount;
<br/>
struct item item[ITEM_MAX];
<br/>
<br/>
for (i = 0; i &lt; itemCount; i++)
<br/>
Â  doSomething( &amp;(item[i]) );</td> </tr></table><span class="postbody">
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96532 - Optihut - Thu Aug 03, 2006 6:31 pm</h4>
    <div class="postbody"><span class="postbody">Or how about using new and delete depending on how many items in the array you need?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96535 - tepples - Thu Aug 03, 2006 6:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Optihut wrote:</b></span></td> </tr> <tr> <td class="quote">Or how about using new and delete depending on how many items in the array you need?</td> </tr></table><span class="postbody">
<br/>
Because 'new' throws exceptions, and exception handling brings in a whole lot of the C++ standard library, bloating the executable. Developers who have 256 KB of EWRAM to work with have to watch each kilobyte.
<br/>
<br/>
There is new(nothrow), but <a class="postlink" href="http://www.gotw.ca/publications/mill16.htm" target="_blank">that's deprecated</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96564 - sajiimori - Thu Aug 03, 2006 9:35 pm</h4>
    <div class="postbody"><span class="postbody">Disabling exceptions is a reasonable thing to do.  In fact, I'd strongly recommend it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96567 - tepples - Thu Aug 03, 2006 9:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">Disabling exceptions is a reasonable thing to do.  In fact, I'd strongly recommend it.</td> </tr></table><span class="postbody">
<br/>
Can you link to a guide to disabling exceptions that results in zero (or negligible) exception-handling code ending up in the binary and applies to devkitARM?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96570 - sajiimori - Thu Aug 03, 2006 10:32 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, I don't use devkitARM.  The usual GCC argument is -fno-exceptions.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96581 - tepples - Thu Aug 03, 2006 11:47 pm</h4>
    <div class="postbody"><span class="postbody">But does that disable exceptions in the standard library, or just exceptions in your own code? If a standard library component throws an exception, won't that bloat the binary in the same way? Is there a way to produce a linker warning if a library throws an exception?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96605 - sajiimori - Fri Aug 04, 2006 3:39 am</h4>
    <div class="postbody"><span class="postbody">I can't think of any component of the standard library that throws, off the top of my head.
<br/>
<br/>
In fact, I vaguely recall something about it being undefined if you throw an exception that unwinds through standard library code, which most often happens when you instantiate an STL container with your own type, and a contained object throws during the execution of a container method.
<br/>
<br/>
At any rate, when you choose to link in a library, you'd better know what you're taking on.  Using ld directly is a good way to avoid accidentally linking in something you don't want.
<br/>
<br/>
Also, much of the standard library is composed of templates.  Since these templates are compiled during your own build process, and using your own compiler flags, the build will fail if you set options that are incompatible with them.  Setting -fno-exceptions means it's an error to use the 'throw' or 'catch' keywords, so you can rest assured that the templates aren't using them.
<br/>
<br/>
Edit: Not using exceptions has made me forget the cases when the standard library throws.  The most common examples are out-of-memory errors, bad dynamic_casts, and various IO failures (which escape me entirely).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96608 - sajiimori - Fri Aug 04, 2006 3:54 am</h4>
    <div class="postbody"><span class="postbody">BTW, disabling exceptions should cause your compiler suite to react appropriately.  For example, my compiler at work handles bad dynamic_casts by calling abort().</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96609 - tepples - Fri Aug 04, 2006 3:54 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">I can't think of any component of the standard library that throws, off the top of my head.</td> </tr></table><span class="postbody">
<br/>
Don't std::ostream and std::string both call new, which throws? And isn't use of C equivalents in &lt;cstdio&gt; and &lt;cstring&gt; deprecated in C++ code?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96618 - sajiimori - Fri Aug 04, 2006 4:37 am</h4>
    <div class="postbody"><span class="postbody">As I understand it, according to ISO C++, there is no such thing as "disabling exceptions."  Exceptions are part of the language, and that's that.
<br/>
<br/>
In practice, every compiler I know of provides the ability to disable exceptions, and lots of developers do it (especially on embedded platforms).
<br/>
<br/>
So yes, operator new can throw... according to ISO C++.  <span style="font-style: italic">My</span> operator new does not throw, ever.
<br/>
<br/>
I haven't heard of cstdio and cstring being deprecated.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
