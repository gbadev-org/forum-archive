<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems compiling GBA C++ code with MSVC++ GBA app wizard - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > Problems compiling GBA C++ code with MSVC++ GBA app wizard</h2>
<div id="posts">
<div class="post">
    <h4>#18426 - [Titan] - Thu Mar 25, 2004 10:03 pm</h4>
    <div class="postbody"><span class="postbody">I've been trying to get devkitadv to compile my small c++ program for a couple of hours now, using MSVC++ 6. I'm using the app wizard (which works just fine for C programs) but I can't get one damn linking error fixed properly.
<br/>
<br/>
when I try to compile the following:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int main()
<br/>
{
<br/>
     while(1);
<br/>
     return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
I get the error: <span style="font-weight: bold">undefined reference to '__gccmain'</span>
<br/>
this error is thrown by ld (the linker). I use the linkscript generated by the wizard, and already came to the conclusion that _gccmain is nowhere to be found.
<br/>
If I put the line __gccmain = 0x8000000; in the linkscript, then the whole thing will compile without any errors (duh) but it doesn't seem to work properly. Then again, I don't know the actual address of __gccmain.
<br/>
<br/>
Does anyone know how to solve this problem? I can upload a rar file with the cpp, mak, linkscript, dsw, dsp and crt0.s file if that helps ^_^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18434 - Lupin - Thu Mar 25, 2004 11:16 pm</h4>
    <div class="postbody"><span class="postbody">I am not sure, but why don't you try this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int __gccmain() 
<br/>
{ 
<br/>
     while(1); 
<br/>
     return 0; 
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
But well, don't expect too much from that code :P
<br/>
<br/>
Btw, you can also define the main function as void and save the return (i think you know that, but you waste 2/4 bytes with your return :P)<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18436 - [Titan] - Thu Mar 25, 2004 11:20 pm</h4>
    <div class="postbody"><span class="postbody">that won't work, since I then get an error "undefined reference to main". I actually just solved it, and your suggestion was very close. Adding the line "__gccmain = main;" to the linkscript file was the solution ^_^ Everything seems to work fine now, but thanks for the kick in the right direction anyway :P</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
