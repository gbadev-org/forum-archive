<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>"undefined reference to `displaySphere_001()'" - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>C/C++ > "undefined reference to `displaySphere_001()'"</h2>
<div id="posts">
<div class="post">
    <h4>#130893 - The_Perfection - Sat Jun 09, 2007 1:49 am</h4>
    <div class="postbody"><span class="postbody">I've stubled across a problem while trying to make a function to display 3D objects.  While I think that the context of the function has nothing to do with the problem, I am still having difficulties getting it to work.  I'll try to post the minimal code.
<br/>
In main.cpp:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;nds.h&gt;
<br/>
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
#include "Sphere_001.h"
<br/>
<br/>
// The rest of setting up the hardware
<br/>
// The main game loop
<br/>
<br/>
int DrawGLScene()
<br/>
{
<br/>
   glColor(RGB5(25, 25, 25));
<br/>
<br/>
// Problematic line of code   
<br/>
   displaySphere_001();
<br/>
   
<br/>
   glEnd();
<br/>
   
<br/>
   return TRUE;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
In Sphere_001.h:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern const float Sphere_001Points[12][3];
<br/>
<br/>
extern const unsigned short Sphere_001Triangles[20][3];
<br/>
<br/>
extern void displaySphere_001(void);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
In Sphere_001.c:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;nds.h&gt;
<br/>
#include "Sphere_001.h"
<br/>
<br/>
const float Sphere_001Points[12][3] =
<br/>
{
<br/>
    // Point Data
<br/>
};
<br/>
<br/>
const unsigned short Sphere_001Triangles[20][3] =
<br/>
{
<br/>
    // Triangle Data
<br/>
};
<br/>
<br/>
void displaySphere_001(void)
<br/>
{
<br/>
    // Function Internals
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The code compiles, it's at the linking step that things get messed up.  I don't understand why; the proper files are included and I've tried everything I could think of to make the function visible and it <span style="font-style: italic">still</span> wont show up.  If I brute force display the triangles it works fine meaning the symbols in the file are recognized by the main file, but not the function.  Why?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130898 - wintermute - Sat Jun 09, 2007 2:37 am</h4>
    <div class="postbody"><span class="postbody">the C++ compiler mangles names to include information about the data types being referenced. This mangling won't take place in C files, you need to either compile everything as C++ or tell the compiler which functions and data are compiled as C.
<br/>
<br/>
Using extern "C" in In Sphere_001.h, like this is one method.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
#ifdef __cplusplus
<br/>
extern "C" {
<br/>
#endif
<br/>
<br/>
extern const float Sphere_001Points[12][3];
<br/>
<br/>
extern const unsigned short Sphere_001Triangles[20][3];
<br/>
<br/>
extern void displaySphere_001(void);
<br/>
<br/>
#ifdef __cplusplus
<br/>
}
<br/>
#endif
<br/>
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130959 - The_Perfection - Sat Jun 09, 2007 5:50 pm</h4>
    <div class="postbody"><span class="postbody">That would explain it.  Tested using extern "C", didn't work.  Tested changing the file type, didn't work.
<br/>
<br/>
Then I ran make clean.  Both techniques worked perfectly.  Thank you for your help.
<br/>
<br/>
As a secondary question, are there any advantages of using .cpp files over .c files or vise versa?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130972 - tepples - Sat Jun 09, 2007 8:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>The_Perfection wrote:</b></span></td> </tr> <tr> <td class="quote">As a secondary question, are there any advantages of using .cpp files over .c files or vise versa?</td> </tr></table><span class="postbody">
<br/>
.cpp files let you use C++ constructs that aren't in C, such as inheritance, methods, and templates, while .c files let you use C99 constructs that aren't in C++, such as designated initializers. The rule for casting (void *) types between the two languages also differs.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
