<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Compiler error: no reference to '__umodsi3'??? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>C/C++ > Compiler error: no reference to '__umodsi3'???</h2>
<div id="posts">
<div class="post">
    <h4>#3352 - ZhouChang - Sun Feb 23, 2003 11:44 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
D:\cygwin\home\gba\switch&gt;make
<br/>
arm-agb-elf-gcc -Wall   -c -o startup.o startup.c
<br/>
arm-agb-elf-ld -T lnkscript  -o main.elf crt0.o startup.o arm.o util.o zxfont.o
<br/>
-Map System.map
<br/>
startup.o: In function `schedule':
<br/>
startup.o(.text+0x2ac): undefined reference to `__umodsi3'
<br/>
startup.o(.text+0x310): undefined reference to `__umodsi3'
<br/>
make: *** [main.elf] Error 1
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I use DevKitAdv tool chain in windows,here is error code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   if ( ( ((time_ticks - ptask-&gt;itime) % ptask-&gt;period == 0 ) 
<br/>
            || ptask-&gt;pexecute &lt; ptask-&gt;execute ) &amp;&amp; 
<br/>
         (time_ticks &gt; ptask-&gt;itime))
<br/>
   {
<br/>
      if ( (time_ticks - ptask-&gt;itime) % ptask-&gt;period == 0 )
<br/>
         ptask-&gt;pexecute = 0;
<br/>
      ptask-&gt;ready = 1;
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
      ptask-&gt;ready = 0;   
<br/>
   }
<br/>
</td> </tr></table><span class="postbody">
<br/>
when remove these codes then there is no error.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3354 - ZhouChang - Sun Feb 23, 2003 1:04 pm</h4>
    <div class="postbody"><span class="postbody">Now, I have change Makefile , it works
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">AS = arm-agb-elf-as
<br/>
LD = arm-agb-elf-ld
<br/>
CC = arm-agb-elf-gcc
<br/>
OBJDUMP = arm-agb-elf-objdump
<br/>
CFLAGS = -Wall
<br/>
ASFLAGS =
<br/>
LDFLAGS = -nostartfiles -nostdlib -T lnkscript
<br/>
<br/>
OBJECTS = crt0.o startup.o arm.o util.o zxfont.o
<br/>
<br/>
all: t.gba
<br/>
<br/>
clean:
<br/>
    rm -f *.o main.elf t.gba
<br/>
<br/>
t.gba: main.elf
<br/>
    arm-agb-elf-objcopy -O binary main.elf t.gba
<br/>
<br/>
main.elf: ${OBJECTS}
<br/>
    $(CC) $(LDFLAGS) -o main.elf ${OBJECTS} -lgcc
<br/>
    $(OBJDUMP) -x main.elf &gt; System.map
<br/>
<br/>
.c.o: $&lt;
<br/>
    $(CC) $(CFLAGS) -c -o $@ $&lt;
<br/>
<br/>
.s.o: $&lt;
<br/>
    $(AS) $(ASFLAGS) -o $@ $&lt;
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
