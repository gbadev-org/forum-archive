<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>First Option Pak revealed: WarioWare Twisted! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > First Option Pak revealed: WarioWare Twisted!</h2>
<div id="posts">
<div class="post">
    <h4>#43609 - jgkspsx - Wed May 25, 2005 3:07 am</h4>
    <div class="postbody"><span class="postbody">Very sorry if this has been posted, but I found nothing in two searches.
<br/>
<br/>
I just tried out the Table Hockey demo (thanks so much to everyone involved in ripping the E3 demos, especially FireFly) and found that it used the WarioWare Twisted! cart in my GBA slot to provide force feedback.  Perhaps it's just an accident and the rumble pak's motor-control register happens to be addressed the same as WarioWare's motor, but I think Nintendo is giving us a really cool alternative for buying single-function option paks.
<br/>
<br/>
So, have any DS programmers interested in using the Twisted! position sensor yet?  Until we have working programmable DS cards, this is obviously not an option for most, but it would be very cool to experiment with.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43610 - Darkain - Wed May 25, 2005 3:17 am</h4>
    <div class="postbody"><span class="postbody">can you test this out by seeing if you can enable the rumble feature on the alarm in the system menu?  /me is highly curious now<br/>_________________<br/>-=- Darkain Dragoon -=-
<br/>
<a class="postlink" href="http://www.darkain.com" target="_blank">http://www.darkain.com</a>
<br/>
<a class="postlink" href="http://ds.darkain.com/hack" target="_blank">DarkStar</a> for <a class="postlink" href="http://ds.darkain.com" target="_blank">Nintendo DS</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43611 - jgkspsx - Wed May 25, 2005 3:32 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkain wrote:</b></span></td> </tr> <tr> <td class="quote">can you test this out by seeing if you can enable the rumble feature on the alarm in the system menu?  /me is highly curious now</td> </tr></table><span class="postbody">
<br/>
It doesn't seem so :(
<br/>
I don't see the option and it doesn't rumble when the alarm goes off.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43617 - EaDS Milliways - Wed May 25, 2005 4:22 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jgkspsx wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkain wrote:</b></span></td> </tr> <tr> <td class="quote">can you test this out by seeing if you can enable the rumble feature on the alarm in the system menu?  /me is highly curious now</td> </tr></table><span class="postbody">
<br/>
It doesn't seem so :(
<br/>
I don't see the option and it doesn't rumble when the alarm goes off.</span></td> </tr></table><span class="postbody">
<br/>
Maybe it's based on the Wario Table Hockey code. Does anyone have pictures of what the game looks like?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43618 - Joat - Wed May 25, 2005 4:34 am</h4>
    <div class="postbody"><span class="postbody">The Metroid: Pinball demo at E3 (on the girl with 3x DSen tied to her waist) included a rumble option pack.  The girl was going to let me look at the cart, but when she tried to pull it out (so I could see at least if it's a braindead device on the PHI pin or something, with only a few silvered contacts, or a full cart with e.g. extra sram or something), we noticed nintendo had screwed the effing things into the DS, and she wouldn't let me unscrew it.
<br/>
<br/>
Also, the DS used a standard sized DS card (also screwed in), rather than a DS flash cart (which are about 2.5x longer than a normal card), so either Nintendo has a newer revision flash cart than other developers, has OTP carts (i.e. the matrix semi they keep saying they'll move to) or Metroid: Pinball is already complete, and they're not releasing it yet for some strange reason.<br/>_________________<br/>Joat
<br/>
<a href="http://www.bottledlight.com" target="_blank">http://www.bottledlight.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43620 - krunkster - Wed May 25, 2005 4:39 am</h4>
    <div class="postbody"><span class="postbody">I can confirm that Hockey demo rumbles with pak but alarm does not.
<br/>
<br/>
I'll try more demos later.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43621 - jgkspsx - Wed May 25, 2005 4:54 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>EaDS Milliways wrote:</b></span></td> </tr> <tr> <td class="quote">Maybe it's based on the Wario Table Hockey code. Does anyone have pictures of what the game looks like?</td> </tr></table><span class="postbody">
<br/>
Here are some screenshots:
<br/>
<a href="http://media.ds.ign.com/media/682/682848/imgs_1.html" target="_blank">http://media.ds.ign.com/media/682/682848/imgs_1.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43622 - tepples - Wed May 25, 2005 4:56 am</h4>
    <div class="postbody"><span class="postbody">Turn it sideways, and reveal the true nature of table hockey: it's just a good-looking Pong clone.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43623 - Joat - Wed May 25, 2005 4:58 am</h4>
    <div class="postbody"><span class="postbody">Oh yeah, on the subject of being based on wario code, it's my impression that the table hockey demo is over a year old (was shown at last E3 iirc).<br/>_________________<br/>Joat
<br/>
<a href="http://www.bottledlight.com" target="_blank">http://www.bottledlight.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43625 - jgkspsx - Wed May 25, 2005 5:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Turn it sideways, and reveal the true nature of table hockey: it's just a good-looking Pong clone.</td> </tr></table><span class="postbody">
<br/>
I like Pong :P
<br/>
<br/>
But I like Air Hockey more :)
<br/>
<br/>
The point of the thread was the force feedback, though, not either game.  Heh.  I do believe it's nearly identical to the demo shown last year at E3, though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43629 - doublec - Wed May 25, 2005 6:28 am</h4>
    <div class="postbody"><span class="postbody">Is there documentation anywhere on how to use the warioware twisted rumble option or position sensor? Programatically I'm talking about.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43645 - netdroid9 - Wed May 25, 2005 9:46 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doublec wrote:</b></span></td> </tr> <tr> <td class="quote">Is there documentation anywhere on how to use the warioware twisted rumble option or position sensor? Programatically I'm talking about.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah, the games source code. It's legal to dissasemble for compatability reasons.
<br/>
<br/>
I think I finally found a thread to use as an example :).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43664 - jgkspsx - Wed May 25, 2005 2:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>netdroid9 wrote:</b></span></td> </tr> <tr> <td class="quote">Yeah, the games source code. It's legal to dissasemble for compatability reasons.</td> </tr></table><span class="postbody">
<br/>
I hear that there's an emulator patch out there that programmatically implements the twist sensor.  Looking at that code might be easier and more "directly" legal than disassembling ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43668 - Kyoufu Kawa - Wed May 25, 2005 3:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jgkspsx wrote:</b></span></td> </tr> <tr> <td class="quote">I hear that there's an emulator patch out there that programmatically implements the twist sensor.  Looking at that code might be easier and more "directly" legal than disassembling ;)</td> </tr></table><span class="postbody">SlimeSmile has the game with that patch. Too bad you can't get any further than Dribble and Spitz. Apparently, the game switches to digital-style measurement in their boss stage, or so he said.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43696 - Quirky - Wed May 25, 2005 7:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kyoufu Kawa wrote:</b></span></td> </tr> <tr> <td class="quote">Apparently, the game switches to digital-style measurement in their boss stage, or so he said.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yoshi's Universal Gravitation [E] / Topsy Turvy [U] uses digital measurement too, judging by its somewhat clunky feel :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43725 - jgkspsx - Thu May 26, 2005 12:02 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kyoufu Kawa wrote:</b></span></td> </tr> <tr> <td class="quote">SlimeSmile has the game with that patch. Too bad you can't get any further than Dribble and Spitz. Apparently, the game switches to digital-style measurement in their boss stage, or so he said.</td> </tr></table><span class="postbody">
<br/>
Wait... they patched the game r0m so it takes input from D-pad and B button?  Crap, I thought they wrote an add-on for an emulator.  Anyway, knowing where they patched will make finding the sensor-reading code in the real game easier.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43776 - Kyoufu Kawa - Thu May 26, 2005 5:42 pm</h4>
    <div class="postbody"><span class="postbody">I do think I remember VBA having motion-control keybindings... can't be very sure having never used them.
<br/>
<br/>
A patch like that would only make sense for flash carts anyway. They don't have the motion stuff.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43787 - tepples - Thu May 26, 2005 8:20 pm</h4>
    <div class="postbody"><span class="postbody">Don't VBA's motion-control keybindings refer to Kirby Tilt n Tumble for GBC?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43856 - Kyoufu Kawa - Fri May 27, 2005 10:48 am</h4>
    <div class="postbody"><span class="postbody">Like I said, never used 'em, so how would I know?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43860 - MrD - Fri May 27, 2005 11:04 am</h4>
    <div class="postbody"><span class="postbody">Tepples is right, really screws ya up when you wanna play it on DCgnuboy. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56673 - wwcube - Mon Oct 10, 2005 4:00 pm</h4>
    <div class="postbody"><span class="postbody">I made simple demo how to use rumble pak.
<br/>
<a class="postlink" href="http://cube.txt-nifty.com/blog/2005/10/gba_nintendo_ds_c44b.html" target="_blank">http://cube.txt-nifty.com/blog/2005/10/gba_nintendo_ds_c44b.html</a>
<br/>
<br/>
direct link:
<br/>
for NDS (<a class="postlink" href="http://cube.txt-nifty.com/blog/files/rumblepak_nds.zip" target="_blank">http://cube.txt-nifty.com/blog/files/rumblepak_nds.zip</a>)
<br/>
for GBA (<a class="postlink" href="http://cube.txt-nifty.com/blog/files/rumblepak_mb.zip" target="_blank">http://cube.txt-nifty.com/blog/files/rumblepak_mb.zip</a>)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56705 - IxthusTiger - Mon Oct 10, 2005 6:25 pm</h4>
    <div class="postbody"><span class="postbody">If you put in a GBAMP incorrectly, the DS will read it as an option pack. Then when you set the alarm, it will ask you if you would like to use rumble.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56714 - funkaster - Mon Oct 10, 2005 7:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>IxthusTiger wrote:</b></span></td> </tr> <tr> <td class="quote">If you put in a GBAMP incorrectly, the DS will read it as an option pack. Then when you set the alarm, it will ask you if you would like to use rumble.</td> </tr></table><span class="postbody">
<br/>
Something similar happens if you put an EFA (256 or 512, not the EFA-II) in the GBA slot. When you set the alarm, the DS asks you if you want to set the rumble option.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#56806 - pixie - Tue Oct 11, 2005 6:51 pm</h4>
    <div class="postbody"><span class="postbody">The bandbrothers addon cart shows as a option pak</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57498 - wwcube - Sun Oct 16, 2005 3:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wwcube wrote:</b></span></td> </tr> <tr> <td class="quote">I made simple demo how to use rumble pak.
<br/>
<a class="postlink" href="http://cube.txt-nifty.com/blog/2005/10/gba_nintendo_ds_c44b.html" target="_blank">http://cube.txt-nifty.com/blog/2005/10/gba_nintendo_ds_c44b.html</a>
<br/>
<br/>
direct link:
<br/>
for NDS (<a class="postlink" href="http://cube.txt-nifty.com/blog/files/rumblepak_nds.zip" target="_blank">http://cube.txt-nifty.com/blog/files/rumblepak_nds.zip</a>)
<br/>
for GBA (<a class="postlink" href="http://cube.txt-nifty.com/blog/files/rumblepak_mb.zip" target="_blank">http://cube.txt-nifty.com/blog/files/rumblepak_mb.zip</a>)</td> </tr></table><span class="postbody">
<br/>
And now, there are demos how to read data from gyro sensor.
<br/>
<br/>
direct link:
<br/>
for NDS (<a class="postlink" href="http://cube.txt-nifty.com/blog/files/gyrotest_nds.zip" target="_blank">http://cube.txt-nifty.com/blog/files/gyrotest_nds.zip</a>)
<br/>
for GBA (<a class="postlink" href="http://cube.txt-nifty.com/blog/files/gyrotest_mb.zip" target="_blank">http://cube.txt-nifty.com/blog/files/gyrotest_mb.zip</a>)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57514 - mastertop101 - Sun Oct 16, 2005 5:53 pm</h4>
    <div class="postbody"><span class="postbody">Hum, I don't understand where will be the gba/ds homebrew if there is the wario ware cart in the gba port ??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57518 - Dark Knight ez - Sun Oct 16, 2005 6:11 pm</h4>
    <div class="postbody"><span class="postbody">The homebrew could be loaded entirely into RAM (as is done with WiFi download at the moment), and after that, it can be executed without having a homebrew device (e.g. flashcard) in the gba port. A gyro sensor cart could be inserted then.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57522 - tepples - Sun Oct 16, 2005 6:28 pm</h4>
    <div class="postbody"><span class="postbody">I've tried pak-swapping on my GBA and Nintendo DS, but a lot of times, pak-swapping (at least in GBA mode) only makes the system reset, even for a pure multiboot program.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57525 - Dark Knight ez - Sun Oct 16, 2005 7:38 pm</h4>
    <div class="postbody"><span class="postbody">I doubt that would happen in NDS mode, although I haven't tried that, to be honest. (Swapping a GBA cart when running the NDS game from the NDS cart that is.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57589 - The 9th Sage - Mon Oct 17, 2005 5:02 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dark Knight ez wrote:</b></span></td> </tr> <tr> <td class="quote">I doubt that would happen in NDS mode, although I haven't tried that, to be honest. (Swapping a GBA cart when running the NDS game from the NDS cart that is.)</td> </tr></table><span class="postbody">
<br/>
<br/>
Usually it works fine, unless you're running homebrew that NEEDS to access data from whatever is in the GBA slot.<br/>_________________<br/>Now with 20% More Old Man from Zelda 1 than ever before!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162891 - cualquiercosa327 - Mon Sep 15, 2008 8:11 pm</h4>
    <div class="postbody"><span class="postbody">hello i tried the binary and it works fine,but i was unable to compile.
<br/>
Some functions has older.here i post an review version which compiles.
<br/>
thanks wwcube
<br/>
<br/>
/*
<br/>
 * Gyro test for Nintendo DS
<br/>
 *
<br/>
 * by wwcube
<br/>
 */
<br/>
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
#include &lt;stdlib.h&gt;
<br/>
#include &lt;unistd.h&gt;
<br/>
<br/>
#include &lt;nds/arm9/input.h&gt;
<br/>
#include &lt;nds/arm9/console.h&gt;
<br/>
<br/>
#include "gyro.h"
<br/>
#include "sincos.h"
<br/>
<br/>
extern const unsigned char bmp_Bitmap[];
<br/>
extern const unsigned short bmp_Palette[];
<br/>
<br/>
/*
<br/>
 * Rotate function from
<br/>
 *   <a href="http://j-gbadev.hp.infoseek.co.jp/kiso/step18.htm" target="_blank">http://j-gbadev.hp.infoseek.co.jp/kiso/step18.htm</a>
<br/>
 */
<br/>
void RotateBG3(int angle)
<br/>
{
<br/>
	s16 s = FixedSin(angle);
<br/>
	s16 c = FixedCos(angle);
<br/>
<br/>
	BG3_XDX =  c;
<br/>
	BG3_XDY =  s;
<br/>
	BG3_YDX = -s;
<br/>
	BG3_YDY =  c;
<br/>
<br/>
	int bg3x = (120&lt;&lt;8) - 144 * FixedCos(angle-33);
<br/>
	int bg3y = ( 80&lt;&lt;8) - 144 *-FixedSin(angle-33);
<br/>
<br/>
	BG3_CX = bg3x;
<br/>
	BG3_CY = bg3y;
<br/>
}
<br/>
<br/>
void init_irq()
<br/>
{
<br/>
	irqInit();
<br/>
	irqSet(IRQ_VBLANK, NULL);
<br/>
	irqEnable(IRQ_VBLANK);
<br/>
}
<br/>
<br/>
void init_video()
<br/>
{
<br/>
	videoSetMode(MODE_5_2D | DISPLAY_BG3_ACTIVE);
<br/>
	videoSetModeSub(MODE_0_2D | DISPLAY_BG0_ACTIVE);
<br/>
	vramSetMainBanks(
<br/>
		VRAM_A_MAIN_BG_0x06000000,
<br/>
		VRAM_B_LCD,
<br/>
		VRAM_C_SUB_BG,
<br/>
		VRAM_D_LCD
<br/>
	);
<br/>
<br/>
	SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
<br/>
	BG_PALETTE_SUB[255] = RGB15(31,31,31);
<br/>
<br/>
	consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(31), (u16*)CHAR_BASE_BLOCK_SUB(0), 16);
<br/>
<br/>
	BG3_CR = BG_BMP8_128x128;
<br/>
	dmaCopy(bmp_Bitmap, BG_GFX, 128*128);
<br/>
	dmaCopy(bmp_Palette, BG_PALETTE, 256*2);
<br/>
}
<br/>
<br/>
int main(void)
<br/>
{
<br/>
	int newtral;
<br/>
	int gyromax;
<br/>
	int gyromin;
<br/>
	int angle;
<br/>
	int adjustflag;
<br/>
	int adjustdata[60];
<br/>
	int adjustdatanum;
<br/>
<br/>
	 REG_EXMEMCNT &amp;= 0xFF7F;	/* It allow ARM9 accessing to CART */
<br/>
<br/>
<br/>
	 REG_EXMEMCNT &amp;= 0xFFE0;	/* Wait for ROM2nd,ROM1st,RAM is 6,10,10 */
<br/>
	 REG_EXMEMCNT |= 0x000A;	/* Wait for ROM2nd,ROM1st,RAM is 6, 6, 6 */
<br/>
<br/>
	init_irq();
<br/>
	init_video();
<br/>
<br/>
	gyroInit();
<br/>
<br/>
	newtral = 0x0650;
<br/>
	gyromax = newtral;
<br/>
	gyromin = newtral;
<br/>
<br/>
	angle = 0;
<br/>
	adjustdatanum = 0;
<br/>
	adjustflag = 1;
<br/>
<br/>
	for (;;) {
<br/>
		int gyrodata;
<br/>
<br/>
		swiWaitForVBlank();
<br/>
<br/>
		scanKeys();
<br/>
		if (keysDown() &amp; KEY_START) {
<br/>
			adjustflag = 1;
<br/>
		}
<br/>
<br/>
		gyrodata = gyroRead();
<br/>
		if (adjustflag) {
<br/>
			adjustdata[adjustdatanum] = gyrodata;
<br/>
			adjustdatanum++;
<br/>
			if ((keysUp() &amp; KEY_START)
<br/>
				|| (adjustdatanum &gt; sizeof(adjustdata)/sizeof(adjustdata[0]))) {
<br/>
				int i;
<br/>
				int n = 0;
<br/>
				newtral = 0;
<br/>
				for (i = 0; i &lt; adjustdatanum; i++) {
<br/>
					if (adjustdata[i] != 0 &amp;&amp; adjustdata[i] != -1) {
<br/>
						newtral += adjustdata[i];
<br/>
						n++;
<br/>
					}
<br/>
				}
<br/>
				newtral = (newtral + n/2) / n;
<br/>
				gyromax = newtral;
<br/>
				gyromin = newtral;
<br/>
				adjustdatanum = 0;
<br/>
				adjustflag = 0;
<br/>
				angle = 0;
<br/>
			}
<br/>
			continue;
<br/>
		}
<br/>
<br/>
		if (gyrodata &gt; gyromax) {
<br/>
			gyromax = gyrodata;
<br/>
		}
<br/>
		if (gyrodata &lt; gyromin) {
<br/>
			gyromin = gyrodata;
<br/>
		}
<br/>
		int diff = (newtral - gyrodata);
<br/>
		angle += diff;
<br/>
		if (angle &gt;= 360*32) {
<br/>
			angle -= 360*32;
<br/>
		} else if (angle &lt; 0) {
<br/>
			angle += 360*32;
<br/>
		}
<br/>
		if ((diff &gt; 64) || (diff &lt; -64)) {
<br/>
			gyroVibration(1);
<br/>
		} else {
<br/>
			gyroVibration(0);
<br/>
		}
<br/>
<br/>
		RotateBG3(angle/32);
<br/>
<br/>
#if 1
<br/>
		iprintf("\x1b[13;0HGyrodat: %04x", gyrodata &amp; 0xffff);
<br/>
		iprintf("\x1b[15;0HNewtral: %04x", newtral);
<br/>
		iprintf("\x1b[16;0HGyromax: %04x", gyromax);
<br/>
		iprintf("\x1b[17;0HGyromin: %04x", gyromin);
<br/>
		iprintf("\x1b[19;0HAngle  : %4d", angle/32);
<br/>
#endif
<br/>
	}
<br/>
<br/>
	return 0;
<br/>
}
<br/>
<br/>
<br/>
//they are only two changes on older waitcr and in a mem direction</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
