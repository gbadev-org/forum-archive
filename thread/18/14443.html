<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Memory problems in my current project - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Memory problems in my current project</h2>
<div id="posts">
<div class="post">
    <h4>#144346 - load*,8,1 - Wed Oct 31, 2007 9:17 pm</h4>
    <div class="postbody"><span class="postbody">Hi everyone!
<br/>
<br/>
I'm currently working on porting a SDL-based game to the Nintendo DS. After a couple of days of happy porting I'm now running into some serious memory problems. Under Linux the game uses about 4,5 MB of memory so I think porting should be possible.
<br/>
<br/>
1.) It seems like I can only malloc about 2 MB of RAM. I read somewhere that malloc in libnds does not use the whole main memory. How much does it actually use? And is there a way to use all of it?
<br/>
<br/>
2.) Could I use VRAM for some data as well? The game does use a great amount of sprites (maybe 1 MB), but they are not the standard console shaped type of sprite. So I'd rather just use VRAM as an extended memory.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144349 - melw - Wed Oct 31, 2007 9:48 pm</h4>
    <div class="postbody"><span class="postbody">4.5MB sounds like a problem as the console has only 4MB of memory. Rather than using all the memory you can squeeze out, think about loading assets from the flash adapter when needed or using smaller sized/quality graphics/sounds or wherever the most memory is spent. After all the screen resolution isn't huge so people won't notice e.g. smaller sized textures in 3d objects. Same for sounds - the speaker quality is far from perfect and using mono 16khz sounds is still acceptable. Using ADPCM/MP3/OGG may be helpful too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144352 - NeX - Wed Oct 31, 2007 10:22 pm</h4>
    <div class="postbody"><span class="postbody">What game are you trying to port?<br/>_________________<br/><a class="postlink" href="http://www.mediafire.com/?cuyb10fzdz2" target="_blank">Strummer</a> or <a class="postlink" href="http://www.mediafire.com/?71zxcztscix" target="_blank">Drummer?</a>.  
<br/>
Or maybe you would rather play with sand? <a class="postlink" href="http://www.mediafire.com/?a05z5wmdvxm" target="_blank">Sandscape is for you in that case.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144383 - Mighty Max - Thu Nov 01, 2007 10:34 am</h4>
    <div class="postbody"><span class="postbody">The last 0x1000 Bytes of wram can not be alloced. They are reserved for other purpose (IPC Struct, Slot-1 Header, ExeptionHandler-Pointer)
<br/>
<br/>
The most memory that is alloced and not available for your malloc is probably your code. Code and Data share the 4MiB<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
