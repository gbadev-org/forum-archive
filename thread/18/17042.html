<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>want to use slot 2 GPIO - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > want to use slot 2 GPIO</h2>
<div id="posts">
<div class="post">
    <h4>#171972 - hounjini - Tue Jan 05, 2010 3:46 pm</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
I'm trying to make slot2 digital input / ouput.
<br/>
I read this page(<a class="postlink" href="http://nocash.emubase.de/gbatek.htm#gbacartioportgpio" target="_blank">http://nocash.emubase.de/gbatek.htm#gbacartioportgpio</a>)
<br/>
,and trying to make it working.
<br/>
<br/>
Here is my code.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
#define REG_DIRECTION (*(vuint16*)0x080000C6)
<br/>
#define REG_DATA (*(vuint16*)0x080000C4)
<br/>
#define REG_CONTROL (*(uint16*)0x80000C8)
<br/>
<br/>
volatile int frame = 0;
<br/>
void Vblank() {
<br/>
    frame++;
<br/>
}
<br/>
<br/>
bool output(void) {
<br/>
    sysSetCartOwner(true);
<br/>
    REG_CONTROL = REG_CONTROL &amp; 0x0000;
<br/>
    REG_CONTROL = REG_CONTROL | 0x0001;
<br/>
    REG_DIRECTION = REG_DIRECTION &amp; 0x0000;
<br/>
    REG_DIRECTION = REG_DIRECTION | 0x000F;
<br/>
    REG_DATA = REG_DATA &amp; 0x0000;
<br/>
    REG_DATA = REG_DATA | 0x000C;
<br/>
}
<br/>
<br/>
<br/>
int main(void) {
<br/>
   touchPosition touchXY;
<br/>
   irqSet(IRQ_VBLANK, Vblank);
<br/>
   consoleDemoInit();
<br/>
   iprintf("      Hello DS dev'rs\n");
<br/>
   iprintf("     \x1b[32mwww.devkitpro.org\n");
<br/>
   iprintf("   \x1b[32;1mwww.drunkencoders.com\x1b[39m");
<br/>
    output();
<br/>
   while(1) {
<br/>
      swiWaitForVBlank();
<br/>
      touchRead(&amp;touchXY);
<br/>
      iprintf("\x1b[10;0HFrame = %d",frame);
<br/>
      iprintf("\x1b[16;0HTouch x = %04X, %04X\n", touchXY.rawx, touchXY.px);
<br/>
      iprintf("Touch y = %04X, %04X\n", touchXY.rawy, touchXY.py);
<br/>
   }
<br/>
   return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
simple hello world code with output(void) function for setting register.
<br/>
hardware : attached data lines to all slot2 pins and test with led.
<br/>
<br/>
thank you for reading my post.
<br/>
Happy new year!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172077 - Diddl - Wed Jan 13, 2010 11:04 am</h4>
    <div class="postbody"><span class="postbody">I want do same and look with interest to your project.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
