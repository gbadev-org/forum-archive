<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Questions - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Questions</h2>
<div id="posts">
<div class="post">
    <h4>#38150 - Loner - Wed Mar 23, 2005 1:49 am</h4>
    <div class="postbody"><span class="postbody">Hi, i'm new to DS development and i've already developed some demo on the GBA.
<br/>
<br/>
here's my questions.
<br/>
1. In the begining i was thinking that the main screen was the top one on the DS but after some test using ndslib on dualis and i've see that it was the opposite, Is this a problem a problem of ndslib or the emulator? or this is the normal behavior on the DS?
<br/>
<br/>
2. Look at this code
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   // Set the main screen to mode 2d with bg 0 and 1 active
<br/>
   DISPLAY_CR = MODE_0_2D |  DISPLAY_BG0_ACTIVE | DISPLAY_BG1_ACTIVE;
<br/>
<br/>
   // Set the sub screen to mode 2d with bg 0 active
<br/>
   SUB_DISPLAY_CR = MODE_0_2D | DISPLAY_BG0_ACTIVE;
<br/>
<br/>
   // Set VRAM BANK
<br/>
   VRAM_A_CR = VRAM_ENABLE | VRAM_A_MAIN_BG;
<br/>
   VRAM_B_CR = VRAM_ENABLE | VRAM_B_MAIN_SPRITE;
<br/>
   VRAM_C_CR = VRAM_ENABLE | VRAM_C_SUB_BG;
<br/>
   VRAM_D_CR = VRAM_ENABLE | VRAM_D_SUB_SPRITE;
<br/>
<br/>
   BG0_CR = BG_COLOR_256 | (31&lt;&lt; SCREEN_SHIFT) | (0 &lt;&lt; CHAR_SHIFT)  | BG_PRIORITY_1;
<br/>
   BG1_CR = BG_COLOR_256 | (30 &lt;&lt; SCREEN_SHIFT) | (0 &lt;&lt; CHAR_SHIFT) | BG_PRIORITY_0;
<br/>
<br/>
    SUB_BG0_CR = BG_COLOR_256 | (31 &lt;&lt; SCREEN_SHIFT) | (0 &lt;&lt; CHAR_SHIFT);
<br/>
   
<br/>
   // top screen Layer 0
<br/>
    COPY16((uint16*)splash_pal, (uint16 *)BG_PALETTE_SUB, 256);
<br/>
    COPY16((uint16*)splash_map, (uint16* )SCREEN_BASE_BLOCK_SUB(31), 32*24);
<br/>
   COPY16((uint16*)splash_raw, (uint16* )CHAR_BASE_BLOCK_SUB(0),372*32);
<br/>
<br/>
   // bottom screen Layer 0
<br/>
   COPY16((uint16*)splash2_pal, (uint16 *)BG_PALETTE, 256);
<br/>
    COPY16((uint16*)splash2_map, (uint16* )SCREEN_BASE_BLOCK(31), 32*24);
<br/>
   COPY16((uint16*)splash2_raw, (uint16* )CHAR_BASE_BLOCK(0), 503*32);
<br/>
<br/>
   // bottom screen Layer 1
<br/>
    COPY16((uint16*)spl_layer1_map, (uint16* )SCREEN_BASE_BLOCK(30), 32*14);
<br/>
   COPY16((uint16*)spl_layer1_raw, (uint16* )CHAR_BASE_BLOCK(0), 192*32);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The only thing that it do is displaying a tile image on the top screen and 2 diferents one on the layer 0 and 1 on the bottom screen. It work perfectly.
<br/>
<br/>
now look at those 2 lines
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">COPY16((uint16*)splash2_raw, (uint16* )CHAR_BASE_BLOCK(0), 503*32); 
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> COPY16((uint16*)spl_layer1_raw, (uint16* )CHAR_BASE_BLOCK(0), 192*32); </td> </tr></table><span class="postbody">
<br/>
<br/>
i'm copying both map data in the same CHAR_BASE_BLOCK so normally it would override some tiles at this location the second time i copy but like i've said it's working perfectly. So i'm wondering if is there something i don't understand with CHAR_BASE_BLOCK. The same thing happen when i   set the SCREEN_BASE_BLOCK to 31 for both layer on bottom screen.
<br/>
<br/>
3.</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   // Set VRAM BANK
<br/>
   VRAM_A_CR = VRAM_ENABLE | VRAM_A_MAIN_BG;
<br/>
   VRAM_B_CR = VRAM_ENABLE | VRAM_B_MAIN_SPRITE;
<br/>
   VRAM_C_CR = VRAM_ENABLE | VRAM_C_SUB_BG;
<br/>
   VRAM_D_CR = VRAM_ENABLE | VRAM_D_SUB_SPRITE; </td> </tr></table><span class="postbody">
<br/>
<br/>
I don't really understand those new VRAM bank, my code is working fine even is i put garbage like "2342" in those register, i've even try to put all 4 banks to VRAM_D_SUB_SPRITE and my code was still working normally?
<br/>
Is there a bug with dualis about those or again i'm not understanding what they do?
<br/>
<br/>
Thank you
<br/>
Long live to the DS community :D
<br/>
<br/>
Loner</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
