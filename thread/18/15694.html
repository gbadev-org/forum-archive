<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Multiple textures tutorial? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Multiple textures tutorial?</h2>
<div id="posts">
<div class="post">
    <h4>#158785 - ragefury32 - Tue Jun 17, 2008 10:37 pm</h4>
    <div class="postbody"><span class="postbody">Hi - newbie here trying to get into NDS programming.  
<br/>
<br/>
Trying to modify the NeHe OpenGL/DS demos for figuring out the system, and ran into some issues with Demo #8 - I am trying to modify it so it will accept 6 textures instead of 1, hosted in 6 files tat
<br/>
<br/>
Anyways, I figure that the first thing that I'll need to do is to do:
<br/>
<br/>
int textures[6];
<br/>
glGenTextures(6, &amp;textures[0]);
<br/>
glBindTexture(0, texture[0]);
<br/>
glTexImage2D(0,0, GL)RGBA, TEXTURE_SIZE_128, TEXTURE_SIZE_128, 0, TEXGEN_TEXCOORD, (u8*)texture_A_dta);
<br/>
<br/>
And so on...
<br/>
<br/>
But here is the question:
<br/>
a) Do I need to do multiple iterations of glBindTexture() for each of the face that I am loading, for example:
<br/>
<br/>
glBindTexture(0, texture[0]);
<br/>
glTexImage2D(0,0, GL)RGBA, TEXTURE_SIZE_128, TEXTURE_SIZE_128, 0, TEXGEN_TEXCOORD, (u8*)texture_A_dta);
<br/>
<br/>
glBindTexture(0, texture[1]);
<br/>
glTexImage2D(0,0, GL)RGBA, TEXTURE_SIZE_128, TEXTURE_SIZE_128, 0, TEXGEN_TEXCOORD, (u8*)texture_B_dta);
<br/>
<br/>
glBindTexture(0, texture[2]);
<br/>
glTexImage2D(0,0, GL)RGBA, TEXTURE_SIZE_128, TEXTURE_SIZE_128, 0, TEXGEN_TEXCOORD, (u8*)texture_C_dta);
<br/>
<br/>
And etc...to load all 6 faces?
<br/>
<br/>
b) In my DrawGLScene() function, would I need to do a GLBindTexture(GL_Texture_2D, texture[i]) for each faces i, before I call the drawing functions for it, so it'll bind the correct texture map to each face?
<br/>
<br/>
Thanks for the quick response...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158789 - yellowstar - Tue Jun 17, 2008 11:22 pm</h4>
    <div class="postbody"><span class="postbody">Yes, both a &amp; b are correct.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158790 - silent_code - Tue Jun 17, 2008 11:23 pm</h4>
    <div class="postbody"><span class="postbody">Welcome to the scene! :^)
<br/>
<br/>
I don't know what you mean by "faces" (maybe surfaces of a cube?), but yes, you need to generate, bind and fill "texture objects" for all textures you want to use.
<br/>
<br/>
Later, when you want to use a certain texture, you just bind the texture (object) and the next geometry that will be rendered, will use the currently bound texture.
<br/>
<br/>
That's it. I hope it helped. :^)
<br/>
<br/>
PS: There are ")" instead of "_" in some places of your post. ;^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158801 - ragefury32 - Wed Jun 18, 2008 7:09 am</h4>
    <div class="postbody"><span class="postbody">Thanks for the quick replies, folks.  Yep, just ran the code and it worked...
<br/>
<br/>
Do I need to flip the textures vertically prior to using them in the correct orientation?  I was looking at the original NeHe demo with the DrunkCoders logo, and there are upside down.  Does NDS have a hardware call to flip textures like glPixelZoom(1,-1), or should I do this on the texture prior to import?
<br/>
<br/>
Also, are there demo code available somewhere on loading, say, MilkShape/Quake2 MD2 and rendering them in the NDS?  I am trying to figure out how to load more complex meshes and doing OpenGL calls on them.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158806 - silent_code - Wed Jun 18, 2008 11:56 am</h4>
    <div class="postbody"><span class="postbody">Just search the forum and look at the examples provided with libnds and devkitARM.
<br/>
You could use the texture matrix to flip textures, but you could also flip them manually in your program. Writing a routine to do that isn't hard to do. :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159153 - ragefury32 - Thu Jun 26, 2008 9:19 am</h4>
    <div class="postbody"><span class="postbody">Okay, stupid question - but one that I searched the forums front to back and can't find an answer for...
<br/>
<br/>
How do you mix flat shaded and texture mapped polygons?
<br/>
<br/>
Right now I have a texture map on the "floor", and I am inlaying a series of flat shaded polygons on top as a region of interest to be detected using a gluPicker-like function.  For some reason I cannot seem to be able to have the flat shaded polygons and the texture mapped polygon on the bottom "play nice" with each other.
<br/>
<br/>
Either the flat shaded polygons disappears right after the first rendering pass, (it shows up and then disappears) or it does not display unless I comment the texture mapped polygons out.  
<br/>
<br/>
Right now the code looks something like this:
<br/>
<br/>
glInit();
<br/>
glEnable(GL_OUTLINE | GL_TEXTURE_2D);
<br/>
glSetOutlineColor(0,RGB15(31,31,31));
<br/>
glClearPolyID(0); 
<br/>
glClearDepth(0x7FFF);
<br/>
<br/>
glPolyFmt(POLY_ALPHA(31) | POLY_CULL_BACK | POLY_FORMAT_LIGHT0 | POLY_ID(0));
<br/>
glColor3f(1.0f,0.0f,0.0f);
<br/>
glBegin(GL_QUAD);	
<br/>
glVertex3f(-1.7f, 0.01f, 0.6f); 	
<br/>
glVertex3f(-1.7f, 0.01f, 1.1f);
<br/>
glVertex3f(-1.0f, 0.01f, 1.1f);
<br/>
glVertex3f(-1.0f, 0.01f, 0.6f);	
<br/>
glEnd();
<br/>
<br/>
glPolyFmt(POLY_ALPHA(31) | POLY_CULL_BACK  | POLY_FORMAT_LIGHT0);	
<br/>
glBindTexture(GL_TEXTURE_2D, texture[1]); 
<br/>
glBegin(GL_QUAD);
<br/>
glTexCoord2f(0.0f, 1.0f); glVertex3f(-2.0f, 0.0f, -2.0f);
<br/>
glTexCoord2f(0.0f, 0.0f); glVertex3f(-2.0f, 0.0f,  2.0f);
<br/>
glTexCoord2f(1.0f, 0.0f); glVertex3f( 2.0f, 0.0f,  2.0f);
<br/>
glTexCoord2f(1.0f, 1.0f); glVertex3f( 2.0f, 0.0f, -2.0f);
<br/>
glEnd();
<br/>
<br/>
In iDeaS the code renders fine as a red box sitting on top of a texture mapped polygon.  In an actual Nintendo DS it renders as just the texture map, but during the very first time the app is run I was able to see a red box at the very beginning before it was replaced by the texture map. 
<br/>
<br/>
Any ideas?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159159 - silent_code - Thu Jun 26, 2008 11:09 am</h4>
    <div class="postbody"><span class="postbody">Any pics? ;^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159185 - ragefury32 - Thu Jun 26, 2008 4:52 pm</h4>
    <div class="postbody"><span class="postbody">Oh, I'll go one step better...I'll provide the source AND the screenshots.
<br/>
<br/>
Anyways.  Here's what I wanted to see:
<br/>
<br/>
<a href="http://aculei.net/~ragefury/Files/Hope-AMD/LeicaDS%200.3.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
As you can see, iDeaS on my machine seems to have drawn the flat shaded polygons and then the texture below.
<br/>
<br/>
Here's what is actually shown:
<br/>
<br/>
<a href="http://aculei.net/~ragefury/Files/Hope-AMD/actual-screenshot.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
I posted my entire sourcebase here:
<br/>
<br/>
<a href="http://aculei.net/~ragefury/Files/Hope-AMD/Leica2DS-B/" target="_blank">http://aculei.net/~ragefury/Files/Hope-AMD/Leica2DS-B/</a>
<br/>
<br/>
I tried every combination of GLEnable to try to see if I can get flatshaded and texture mapped polygons working.   Hell, I am even looking at NeHe Lesson 8 again to see if I can mix flat shaded and texture mapped polygons to work.  Do I need to assign a vertex color to each vertex in each flat shaded polygon to get this working properly?
<br/>
<br/>
(Yes, the idea is to eventually draw the polygons invisible and only render an outline if/when the region is selected - but this is initial debugging)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159187 - zeruda - Thu Jun 26, 2008 5:08 pm</h4>
    <div class="postbody"><span class="postbody">You need to glBindTexture(GL_TEXTURE_2D, 0); just before you draw your flat shaded polygon.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159188 - elhobbs - Thu Jun 26, 2008 5:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glBindTexture(0, 0); </td> </tr></table><span class="postbody">
<br/>
this will disable texturing until glBindTexture is called again with a valid texture id.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159190 - ragefury32 - Thu Jun 26, 2008 5:39 pm</h4>
    <div class="postbody"><span class="postbody">Hm.  Wow, thanks - that was quick and easy...
<br/>
<br/>
Just another quick one, guys...
<br/>
<br/>
If I want to draw the flat shaded polygons invisible but retain the outline when it was selected, which Polygon Attribute would I set?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159204 - silent_code - Thu Jun 26, 2008 9:47 pm</h4>
    <div class="postbody"><span class="postbody">I would try to set it to fully transparent with outlining, but I don't know if it works.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159207 - ragefury32 - Thu Jun 26, 2008 11:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">I would try to set it to fully transparent with outlining, but I don't know if it works.</td> </tr></table><span class="postbody">
<br/>
<br/>
How would I set transparency on a flat shaded polygon?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159220 - silent_code - Fri Jun 27, 2008 12:55 pm</h4>
    <div class="postbody"><span class="postbody">Do you know how to set transparency in general?
<br/>
It's in the polygon attribute.
<br/>
There's only one problem... you can't make it fully transparent (I forgot that) - that would switch to wireframe mode.
<br/>
<br/>
Btw: When it comes to polygon attributes, it doesn't matter how many normals  you supply for a poly (flat / smooth shaded). All you need to know, that transparency is per primitive, in contrast to per vertex.
<br/>
<br/>
Anyways, read it here: <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#ds3dpolygonattributes" target="_blank">http://nocash.emubase.de/gbatek.htm#ds3dpolygonattributes</a><br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159224 - ragefury32 - Fri Jun 27, 2008 2:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">Do you know how to set transparency in general?
<br/>
It's in the polygon attribute.
<br/>
There's only one problem... you can't make it fully transparent (I forgot that) - that would switch to wireframe mode.
<br/>
<br/>
Btw: When it comes to polygon attributes, it doesn't matter how many normals  you supply for a poly (flat / smooth shaded). All you need to know, that transparency is per primitive, in contrast to per vertex.
<br/>
<br/>
Anyways, read it here: <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#ds3dpolygonattributes" target="_blank">http://nocash.emubase.de/gbatek.htm#ds3dpolygonattributes</a></td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks...The wireframe mode is actually what I wanted.  The idea is really to draw nothing unless a region is picked, and when it is, draw it as a white wireframe polygon.  I actually did this:
<br/>
<br/>
if(clicked == DESIRED_REGION_A) {
<br/>
				glPolyFmt(POLY_ALPHA(0) | POLY_CULL_BACK | POLY_FORMAT_LIGHT0 | POLY_ID(0));
<br/>
				iprintf("\x1b[16;0HCurrently at Region A  \n");
<br/>
...	
<br/>
				glEnd();
<br/>
	                                     }
<br/>
<br/>
if(clicked == DESIRED_REGION_B) {
<br/>
				glPolyFmt(POLY_ALPHA(0) | POLY_CULL_BACK | POLY_FORMAT_LIGHT0 | POLY_ID(0));
<br/>
				iprintf("\x1b[16;0HCurrently at Region A  \n");
<br/>
...
<br/>
<br/>
(And etc)
<br/>
<br/>
And it worked beautifully.  
<br/>
<br/>
Thanks for the quick heads-up, guys...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159226 - silent_code - Fri Jun 27, 2008 4:39 pm</h4>
    <div class="postbody"><span class="postbody">I'm glad to be of any help. :^)
<br/>
<br/>
A short sidenote: I suggest using "switch / case" or at least "if" + "else if"s instead of the "if"s. :^)
<br/>
Or even better (if possible) using an array of premade polyformats that can be indexed with those region ids... there are many possible ways to solve that "problem." :^)
<br/>
<br/>
Happy programming!<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
