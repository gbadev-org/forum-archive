<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Is Pixel Opacity Possible? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Is Pixel Opacity Possible?</h2>
<div id="posts">
<div class="post">
    <h4>#89876 - Onions - Tue Jun 27, 2006 3:23 am</h4>
    <div class="postbody"><span class="postbody">I'm wanting some of my images to have varying levels of opacity, yet, I do not know how to do this and after searching the forums only 1 other post seemed vaguely useful to my situation, although I could not get anything to work based on it.
<br/>
<br/>
So, anyway, I'm using images converted from PCX to Binary using a converter called "pcx2tex". I'm also using the following for my video setup, which uses uint16 for my color values...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   videoSetMode(MODE_5_2D | DISPLAY_BG3_ACTIVE); 
<br/>
   vramSetBankA(VRAM_A_MAIN_BG_0x6000000);
<br/>
   BG3_CR = BG_BMP16_256x256; 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
  I'd like a function where I give it two colors which it can blend based on a 3rd value which represents the 2nd color's opacity. I also wouldn't mind the 3rd value using int as it's type, so that 1 to "whatever" value could represent it's opacity, or another uint16 that takes grayscale as it's opacity value (where white is visable, gray is inbetween, and black means completely transparent).
<br/>
<br/>
It's kind of similar to what was said in the already mentioned post I came across, which can be found here...
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=5917&amp;highlight=opacity" target="_blank">http://forum.gbadev.org/viewtopic.php?t=5917&amp;highlight=opacity</a>
<br/>
<br/>
Any help is appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89877 - tepples - Tue Jun 27, 2006 3:43 am</h4>
    <div class="postbody"><span class="postbody">You can write this function yourself: <ol type="1"><li>Separate the source and destination pixels into red, green, and blue components. </li><li>Multiply one pixel's components by gamma and the other's by 16 - gamma, and add them. That is:
<br/>
dstRed = aRed * gamma + bRed * (16 - gamma); </li><li>Divide all components by 16. </li><li>Reassemble the pixel. </li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89886 - Onions - Tue Jun 27, 2006 5:01 am</h4>
    <div class="postbody"><span class="postbody">I think my main problem is not knowing how to seperate the color value I get from my image arrays (by using pcx2tex) into seperate color channels.
<br/>
<br/>
Also, I don't know the opacity range that can be given to colors, or exactly how that's set up. I believe it was you that showed me the break down in binary of where the opacity bit is located, but I do not understand how you derived a hex based value for it (based on the question I had asked). Yet, something tells me since it was one bit and in binary, that it wasn't the opacity I'm wanting but a simple "is transparent" or "is not transparent" switch. So what I'm talking about here probably is irrelevant... but to continue on this subject (if it matters)... I think the whole bit shifting and working at such a level is beyond me. I probably need to look into this, though, as handheld development seems to use a lot of it.
<br/>
<br/>
I will say the most problematic thing I'm running into with developing on DS or GBA (DS mostly) is how to deal with color. I'm currently working on building everything myself based around the simple use of plotting pixels to the screen, so I'm sure other things would be confusing me aswell, but I'm simply not dealing with them (yet atleast).
<br/>
<br/>
So anyway, any help is appreciated in telling me how to split my color value found in my image arrays - or where I can go to best learn this - aswell as how to derive an opacity level.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89889 - tepples - Tue Jun 27, 2006 5:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Onions wrote:</b></span></td> </tr> <tr> <td class="quote">I think my main problem is not knowing how to seperate the color value I get from my image arrays (by using pcx2tex) into seperate color channels.</td> </tr></table><span class="postbody">
<br/>
From libnds:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define RGB15(r,g,b)  ((r)|((g)&lt;&lt;5)|((b)&lt;&lt;10))</td> </tr></table><span class="postbody">
<br/>
So let's reverse that:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define RGB15R(rgb)  (((rgb)      ) &amp; 0x1F)
<br/>
#define RGB15G(rgb)  (((rgb) &gt;&gt;  5) &amp; 0x1F)
<br/>
#define RGB15B(rgb)  (((rgb) &gt;&gt; 10) &amp; 0x1F)</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89935 - Onions - Tue Jun 27, 2006 3:20 pm</h4>
    <div class="postbody"><span class="postbody">What you said seems like it would work, yet I get a blank screen when I do the following test...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   uint16 red = RGB15R(color);
<br/>
   uint16 green = RGB15G(color);
<br/>
   uint16 blue = RGB15B(color);
<br/>
   
<br/>
   color = RGB15(red, green, blue);
<br/>
<br/>
   *Camera_01[y * 40 + x] = color;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It seems the problem lies in the splitting of the colors as I put other values into RGB15 and atleast something came out of it. Any insight into what I may be doing wrong is appreciated.
<br/>
<br/>
EDIT: I just tried putting 1 to 2 of the seperate colors into RGB15() and some distorted colors showed up, however, adding a 3rd gives a blank screen. This might help in deducing what's going on perhaps.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89936 - Mighty Max - Tue Jun 27, 2006 3:25 pm</h4>
    <div class="postbody"><span class="postbody">You are losing bit 15. Which decides about the general visibility on backgrounds which can have transparent pixels.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89940 - Onions - Tue Jun 27, 2006 3:40 pm</h4>
    <div class="postbody"><span class="postbody">I got the colors to seperate I think, by changing your defines to...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define RGB15R(rgb)  (((rgb)      ) ) 
<br/>
#define RGB15G(rgb)  (((rgb) &gt;&gt;  5) ) 
<br/>
#define RGB15B(rgb)  (((rgb) &gt;&gt; 10) )
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Doing the following does change the color, although currently it's messed up. I'll keep looking into it though...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   int gamma = 50;
<br/>
<br/>
   uint16 aRed = RGB15R(color);
<br/>
   uint16 aGreen = RGB15G(color);
<br/>
   uint16 aBlue = RGB15B(color);
<br/>
<br/>
   uint16 bRed = RGB15R(color);
<br/>
   uint16 bGreen = RGB15G(color);
<br/>
   uint16 bBlue = RGB15B(color);
<br/>
   
<br/>
   uint16 dstRed = aRed * gamma + bRed * (16 - gamma); 
<br/>
   uint16 dstGreen = aBlue * gamma + bBlue * (16 - gamma); 
<br/>
   uint16 dstBlue = aGreen * gamma + bGreen * (16 - gamma); 
<br/>
<br/>
   dstRed = dstRed / 16;
<br/>
   dstGreen = dstGreen / 16;
<br/>
   dstBlue = dstBlue / 16;
<br/>
<br/>
   color = RGB15(dstRed, dstGreen, dstBlue);
<br/>
<br/>
   *Camera_01[y * 40 + x] = color;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
What value should gamma be giving? I think that's what's messing things up perhaps. Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89945 - Mighty Max - Tue Jun 27, 2006 4:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Onions wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   int gamma = 50;
<br/>
(...)
<br/>
   uint16 dstRed = aRed * gamma + bRed * (16 - gamma); 
<br/>
   uint16 dstGreen = aBlue * gamma + bBlue * (16 - gamma); 
<br/>
   uint16 dstBlue = aGreen * gamma + bGreen * (16 - gamma); 
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Gamma should be between 0 and 16.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89961 - tepples - Tue Jun 27, 2006 5:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Onions wrote:</b></span></td> </tr> <tr> <td class="quote">I got the colors to seperate I think, by changing your defines to...
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define RGB15R(rgb)  (((rgb)      ) ) 
<br/>
#define RGB15G(rgb)  (((rgb) &gt;&gt;  5) ) 
<br/>
#define RGB15B(rgb)  (((rgb) &gt;&gt; 10) )
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
No, that returns the RGBA, GBA[1], and BA values, not the R, G, and B values. What you need is to define another macro RGBA15() and then use that instead of RGB15():
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define RGBA15(r, g, b) ((RGB15(r, g, b)) | 0x8000)</td> </tr></table><span class="postbody">
<br/>
<br/>
[1] Green, blue, alpha, not another handheld game system.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"><br/><br/>Last edited by tepples on Wed Jun 28, 2006 1:47 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#89982 - Onions - Tue Jun 27, 2006 7:35 pm</h4>
    <div class="postbody"><span class="postbody">Thanks Tepples, for sticking with me through what is probably a simple matter. I think I'm starting to understand it better now, though. The opacity seems to be working correctly, yet I'm currently having to manually type in the opacity value as an int type.
<br/>
<br/>
Since the opacity range is 0 - 16, I assume that's why it takes a u8 type as seen in the other poster's function. Can I use a grayscale image converted with pcx2tex as I've been doing and type cast it to u8 instead of u16 (or uint16) and it work correctly? Or is there something else I should do?
<br/>
<br/>
Also (out of curiosity), since each color had 5 bits to represent a color channel's range, and each bit can either be a 1 or 0 (since it's binary) what is the amount of possibilities for those 5 bits, or color channel? 
<br/>
And I'm sure there's a formula for reaching such odds or possibilties for values, so if you could tell me that too I'd appreciate it.
<br/>
<br/>
By the way, just so you'll know (if you don't already), I suck at math. I'm more of an artist than a programmer, but over the years I've learnt I've got to do it myself if I ever want to make a game.
<br/>
So I appreciate you (and any others) trying to help me with even the simplest of things.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89995 - tepples - Tue Jun 27, 2006 8:55 pm</h4>
    <div class="postbody"><span class="postbody">A single bit can be either on (1) or off (0).
<br/>
<br/>
An <span style="font-style: italic">n</span>-bit field can represent any number from 0 to (1 &lt;&lt; <span style="font-style: italic">n</span>)-1. In the case of a 5-bit field, this is 0 to (1 &lt;&lt; 5)-1 = 0 to 32-1 = 0 to 31.
<br/>
<br/>
<span style="font-weight: bold">What's &lt;&lt; ?</span> It stands for shifting the number to the left. In general, <span style="font-style: italic">a</span> &lt;&lt; <span style="font-style: italic">b</span> equals <span style="font-style: italic">a</span> times 2 to the <span style="font-style: italic">n</span>th power.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90014 - Onions - Tue Jun 27, 2006 9:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
In the case of a 5-bit field, this is 0 to (1 &lt;&lt; 5)-1 = 0 to 32-1 = 0 to 31
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Given your explanation of the procedure of what &lt;&lt; does to the left and right values, I don't see how (1 &lt;&lt; 5) can equel 32... can you break this down even further with an equation using these numbers as examples?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90017 - dXtr - Tue Jun 27, 2006 10:08 pm</h4>
    <div class="postbody"><span class="postbody">here we go:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">    decimal | binary
<br/>
          1 | 00000001
<br/>
now we shift left 5 times:
<br/>
1 &lt;&lt; 1 =  2 | 00000010
<br/>
1 &lt;&lt; 2 =  4 | 00000100
<br/>
1 &lt;&lt; 3 =  8 | 00001000
<br/>
1 &lt;&lt; 4 = 16 | 00010000
<br/>
1 &lt;&lt; 5 = 32 | 00100000</td> </tr></table><span class="postbody"><br/>_________________<br/>go back to coding and stop screaming wolf :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90128 - Onions - Wed Jun 28, 2006 3:20 pm</h4>
    <div class="postbody"><span class="postbody">So then, it's not an actual mathematical method that determines this number, it's more of a set incremental process. One where each right value to the &lt;&lt; operator means double the left that many times.
<br/>
<br/>
Why I didn't get how the value was determined is because I was taking both numbers and trying to get some sort of value from it based on an equation. Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90138 - Dark Knight ez - Wed Jun 28, 2006 4:10 pm</h4>
    <div class="postbody"><span class="postbody">Not mathematical? The implementation might not be according to you, but shifting to the left n times, would be the same as multiplying by (2 to the power n).
<br/>
1 &lt;&lt; 5 == 1 * (2^5) == 1 * 32 == 32</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90150 - Onions - Wed Jun 28, 2006 5:18 pm</h4>
    <div class="postbody"><span class="postbody">Why it didn't seem mathematical to me is because I didn't see how 32 would come about from 1&lt;&lt;5.
<br/>
<br/>
When you say 2^5 (I assume 2 to the 5th power) I would think it equels 50, like so... 5x5 = 25, then 25 x 2 = 50. I couldn't figure out in any mathematical way (that I knew of) of how 32 was the answer.
<br/>
<br/>
Was I "squaring" and not putting it to the power of "nth"?
<br/>
<br/>
EDIT: Now I'm starting to remember what the "nth" power is...
<br/>
<br/>
lets say 3 to the 7th power, that would equel...
<br/>
<br/>
1. 3 + 3 = 6
<br/>
2. 6 + 6 = 12
<br/>
3. 12 + 12 = 24
<br/>
4. 24 + 24 = 48
<br/>
5. 48 + 48 = 96
<br/>
6. 96 + 96 = 192
<br/>
7. 192 + 192 = 384
<br/>
<br/>
... so 3^7 = 384, correct? (and of course, the above could have used x2, instead of n + n, which is how it's probably meant to be done)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90152 - Dark Knight ez - Wed Jun 28, 2006 5:30 pm</h4>
    <div class="postbody"><span class="postbody">2 the power of 5 == 2^5
<br/>
which can be rewritten as: 1 * 2*2*2*2*2
<br/>
note that 1 is multiplied 5 times by 2.
<br/>
so 2^0 == 1
<br/>
and 2^1 == 2
<br/>
and 2^2 == 2*2 == 4
<br/>
and 2^3 == 2*2*2 == 8
<br/>
and 2^4 == 2*2*2*2 == 16
<br/>
and 2^5 == 2*2*2*2*2 == 32
<br/>
<br/>
Basic math.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90217 - tepples - Wed Jun 28, 2006 10:54 pm</h4>
    <div class="postbody"><span class="postbody">(C) 1 &lt;&lt; 5
<br/>
= (BASIC) 2 ^ 5
<br/>
= (English) 2 to the 5th power
<br/>
= 2*2*2*2*2
<br/>
= 32
<br/>
<br/>
(BASIC) 5 ^ 2
<br/>
= (English) 5 to the 2nd power (or) 5 squared
<br/>
= 5*5
<br/>
= 25
<br/>
<br/>
(BASIC) 3 ^ 7
<br/>
= (English) 3 to the 7th power
<br/>
= 3*3*3*3*3*3*3
<br/>
= 2187
<br/>
<br/>
(C) 3 &lt;&lt; 7
<br/>
= (BASIC) 3 * (2^7)
<br/>
= (English) 3 times 2 to the 7th power
<br/>
= 3 * (2*2*2*2*2*2*2)
<br/>
= 384<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90246 - Onions - Thu Jun 29, 2006 2:04 am</h4>
    <div class="postbody"><span class="postbody">Alright, now I see. I was wondering what the use of &lt;&lt; would be if ^ already does the same.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90250 - tepples - Thu Jun 29, 2006 2:11 am</h4>
    <div class="postbody"><span class="postbody">In C, in C++, and in Java, the ^ operator performs exclusive or, not exponentiation.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
