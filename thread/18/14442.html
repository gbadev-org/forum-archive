<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Disco Lights... not really wanted [solved] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Disco Lights... not really wanted [solved]</h2>
<div id="posts">
<div class="post">
    <h4>#144336 - Noda - Wed Oct 31, 2007 7:22 pm</h4>
    <div class="postbody"><span class="postbody">Hello, I have (again) another strange problem with lights: on the DS I'm having the effect of a disco light (going in all direction with shutting on/off all the time, like if the light was moving), but I don't get why??
<br/>
<br/>
I'm using 1 static light:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
glLight(0, RGB15(31, 31, 31) , 0, 0, floattov10(-1));</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm using 3D on both screens, and apply the light to my 2 objects with the attributes:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
glPolyFmt(POLY_ID(1) | POLY_ALPHA(31) | POLY_CULL_BACK | POLY_FORMAT_LIGHT0);</td> </tr></table><span class="postbody">
<br/>
<br/>
and I set up the material before each object:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    glMaterialf(GL_AMBIENT, RGB15(0, 0, 0));
<br/>
    glMaterialf(GL_DIFFUSE, RGB15(16, 16, 16));
<br/>
    glMaterialf(GL_SPECULAR, BIT(15) | RGB15(31,31,31));
<br/>
    glMaterialf(GL_EMISSION, RGB15(0, 0, 0));</td> </tr></table><span class="postbody">
<br/>
<br/>
Is there something wrong with that? Does anyone had this problem?
<br/>
<br/>
Thanks.</span><span class="gensmall"><br/><br/>Last edited by Noda on Tue Nov 06, 2007 5:39 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#144545 - Noda - Sat Nov 03, 2007 6:09 pm</h4>
    <div class="postbody"><span class="postbody">Nobody with an idea?
<br/>
<br/>
I've made some tests: if I move the glLight() definition in the main render loop (and not leave it only at init), I have  about 2 seconds where the light is correct but I see it slowly moving (whereas it sould not!!) and then, goes disco! :(
<br/>
<br/>
Maybe this is a problem with my projection/view setup, is there any restrictions (apart from the reflection) about lights or things that I may have forgot to set up?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144742 - thegamefreak0134 - Tue Nov 06, 2007 11:30 am</h4>
    <div class="postbody"><span class="postbody">Hmm... I see standard language issues popping up all over the place, but I've been in Standard C mode for two months in school (no C++, we're forbidden for the first semester) so this may be fine in C++ and I may be full of beans. When you're using floating point functions, it's best to make sure to pass the arguments as 1.0 vs 1. For some reason, a lot of compilers won't do the cast like you would expect, and you get strange errors like this that make no sense at all. Try that.
<br/>
<br/>
If that doesn't do it (I don't have very high hopes, it's a nit-picky thing) then you might want to post your whole code. I think I know what it might be, but I can't tell what order you are doing your drawing in.
<br/>
<br/>
-gamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144743 - PypeBros - Tue Nov 06, 2007 11:44 am</h4>
    <div class="postbody"><span class="postbody">something wrong with your normals could do something like that ?<br/>_________________<br/><a class="postlink" href="http://sylvainhb.blogspot.com/p/sprite-editor.html" target="_blank"> SEDS: Sprite Edition on DS</a> :: <a class="postlink" href="http://sylvainhb.blogspot.com/search/label/modplayer" target="_blank">modplayer</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144752 - Noda - Tue Nov 06, 2007 5:38 pm</h4>
    <div class="postbody"><span class="postbody">Found the problem!
<br/>
<br/>
A simple glLoadIdentity() after the initial glMatrixMode(GL_MODEL_VIEW) fixed the problem ;)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
