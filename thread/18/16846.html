<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprites on both screens - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Sprites on both screens</h2>
<div id="posts">
<div class="post">
    <h4>#170160 - headspin - Fri Sep 04, 2009 7:37 pm</h4>
    <div class="postbody"><span class="postbody">I got sprites on both screens working in a game previously but this is my first time using the latest libnds so I am trying to use the helper functions as much as possible.
<br/>
<br/>
Anyway I can't seem to get sprites to display on both screens using libnds and the bank layout I'm currently using. I decided to open up the bitmap_sprites demo and add display to the secondary screen. This works fine.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
//a simple sprite structure 
<br/>
//it is generally preferred to separate your game object
<br/>
//from OAM
<br/>
typedef struct  
<br/>
{
<br/>
   u16* gfx;
<br/>
   SpriteSize size;
<br/>
   SpriteColorFormat format;
<br/>
   int rotationIndex;
<br/>
   int paletteAlpha;
<br/>
   int x;
<br/>
   int y;
<br/>
} MySprite;
<br/>
<br/>
int main(int argc, char** argv) {
<br/>
<br/>
   //three sprites of differing color format
<br/>
   MySprite spritesMain[] = {
<br/>
      {0, SpriteSize_32x32, SpriteColorFormat_Bmp, 0, 15, 20, 15},
<br/>
      {0, SpriteSize_32x32, SpriteColorFormat_256Color, -1, 0, 20, 80},
<br/>
      {0, SpriteSize_32x32, SpriteColorFormat_16Color, -1, 1, 20, 136}
<br/>
   };
<br/>
   
<br/>
   MySprite spritesSub[] = {
<br/>
      {0, SpriteSize_32x32, SpriteColorFormat_Bmp, 0, 15, 20, 15},
<br/>
      {0, SpriteSize_32x32, SpriteColorFormat_256Color, -1, 0, 20, 80},
<br/>
      {0, SpriteSize_32x32, SpriteColorFormat_16Color, -1, 1, 20, 136}
<br/>
   };
<br/>
<br/>
   videoSetMode(MODE_0_2D);
<br/>
   videoSetModeSub(MODE_0_2D);
<br/>
<br/>
   consoleDemoInit();
<br/>
<br/>
   //initialize the sub sprite engine with 1D mapping 128 byte boundary
<br/>
   //and no external palette support
<br/>
   oamInit(&amp;oamMain, SpriteMapping_Bmp_1D_128, false);
<br/>
   oamInit(&amp;oamSub, SpriteMapping_Bmp_1D_128, false);
<br/>
<br/>
   vramSetBankA(VRAM_A_MAIN_SPRITE);
<br/>
   vramSetBankD(VRAM_D_SUB_SPRITE);
<br/>
<br/>
   //allocate some space for the sprite graphics
<br/>
   for(int i = 0; i &lt; 3; i++)
<br/>
   {
<br/>
      spritesMain[i].gfx = oamAllocateGfx(&amp;oamMain, spritesMain[i].size, spritesMain[i].format);
<br/>
      spritesSub[i].gfx = oamAllocateGfx(&amp;oamSub, spritesSub[i].size, spritesSub[i].format);
<br/>
   }
<br/>
<br/>
   //ugly positional printf
<br/>
   iprintf("\x1b[1;1HDirect Bitmap:");
<br/>
   iprintf("\x1b[9;1H256 color:");
<br/>
   iprintf("\x1b[16;1H16 color:");
<br/>
<br/>
   //fill bmp sprite with the color red
<br/>
   dmaFillHalfWords(ARGB16(1,31,0,0), spritesMain[0].gfx, 32*32*2);
<br/>
   dmaFillHalfWords(ARGB16(1,31,0,0), spritesSub[0].gfx, 32*32*2);
<br/>
   
<br/>
   //fill the 256 color sprite with index 1 (2 pixels at a time)
<br/>
   dmaFillHalfWords((1&lt;&lt;8)|1, spritesMain[1].gfx, 32*32);
<br/>
   dmaFillHalfWords((1&lt;&lt;8)|1, spritesSub[1].gfx, 32*32);
<br/>
   
<br/>
   //fill the 16 color sprite with index 1 (4 pixels at a time)
<br/>
   dmaFillHalfWords((1&lt;&lt;12)|(1&lt;&lt;8)|(1&lt;&lt;4)|1, spritesMain[2].gfx, 32*32 / 2);
<br/>
   dmaFillHalfWords((1&lt;&lt;12)|(1&lt;&lt;8)|(1&lt;&lt;4)|1, spritesSub[2].gfx, 32*32 / 2);
<br/>
   
<br/>
   //set index 1 to blue...this will be the 256 color sprite
<br/>
   SPRITE_PALETTE[1] = RGB15(0,31,0);
<br/>
   //set index 17 to green...this will be the 16 color sprite
<br/>
   SPRITE_PALETTE[16 + 1] = RGB15(0,0,31);
<br/>
<br/>
   //set index 1 to blue...this will be the 256 color sprite
<br/>
   SPRITE_PALETTE_SUB[1] = RGB15(0,31,0);
<br/>
   //set index 17 to green...this will be the 16 color sprite
<br/>
   SPRITE_PALETTE_SUB[16 + 1] = RGB15(0,0,31);
<br/>
<br/>
   int angle = 0;
<br/>
<br/>
   while(1) {
<br/>
      for(int i = 0; i &lt; 3; i++) {
<br/>
         oamSet(
<br/>
         &amp;oamMain, //sub display 
<br/>
         i,       //oam entry to set
<br/>
         spritesMain[i].x, spritesMain[i].y, //position 
<br/>
         0, //priority
<br/>
         spritesMain[i].paletteAlpha, //palette for 16 color sprite or alpha for bmp sprite
<br/>
         spritesMain[i].size, 
<br/>
         spritesMain[i].format, 
<br/>
         spritesMain[i].gfx, 
<br/>
         spritesMain[i].rotationIndex, 
<br/>
         true, //double the size of rotated sprites
<br/>
         false, //don't hide the sprite
<br/>
         false, false, //vflip, hflip
<br/>
         false //apply mosaic
<br/>
         );
<br/>
         
<br/>
         oamSet(
<br/>
         &amp;oamSub, //sub display 
<br/>
         i,       //oam entry to set
<br/>
         spritesSub[i].x, spritesSub[i].y, //position 
<br/>
         0, //priority
<br/>
         spritesSub[i].paletteAlpha, //palette for 16 color sprite or alpha for bmp sprite
<br/>
         spritesSub[i].size, 
<br/>
         spritesSub[i].format, 
<br/>
         spritesSub[i].gfx, 
<br/>
         spritesSub[i].rotationIndex, 
<br/>
         true, //double the size of rotated sprites
<br/>
         false, //don't hide the sprite
<br/>
         false, false, //vflip, hflip
<br/>
         false //apply mosaic
<br/>
         );
<br/>
      }
<br/>
<br/>
      oamRotateScale(&amp;oamMain, 0, angle, (1 &lt;&lt; 8), (1&lt;&lt;8));
<br/>
      oamRotateScale(&amp;oamSub, 0, angle, (1 &lt;&lt; 8), (1&lt;&lt;8));
<br/>
<br/>
      angle += 64;
<br/>
<br/>
      swiWaitForVBlank();
<br/>
<br/>
      //send the updates to the hardware
<br/>
      oamUpdate(&amp;oamMain);
<br/>
      oamUpdate(&amp;oamSub);
<br/>
   }
<br/>
   return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
The problem is when I change the graphics layout to add support for bg tiles the sprites don't appear on the main screen.
<br/>
<br/>
ie.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">vramSetMainBanks(VRAM_A_MAIN_BG, VRAM_B_MAIN_SPRITE, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE);</td> </tr></table><span class="postbody">
<br/>
<br/>
When I change the bank layout to the following I get sprites displaying on both screens again but in my game my main screen disappears (I get the sprite on both screens but none of the backgrounds appear on main screen!).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">vramSetMainBanks(VRAM_A_MAIN_SPRITE, VRAM_B_MAIN_BG, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE);</td> </tr></table><span class="postbody">
<br/>
<br/>
So my question is why can't I get sprites displaying on both screens using the following memory layout:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">vramSetMainBanks(VRAM_A_MAIN_BG, VRAM_B_MAIN_SPRITE, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE);</td> </tr></table><span class="postbody">
<br/>
<br/>
I thought that perhaps it was an issue caused by using bitmap sprites but I changed them all to 256 color sprites and still the same issue.
<br/>
<br/>
Here is my video setup code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define BG0_MAP_BASE            26
<br/>
#define BG0_MAP_BASE_SUB         26
<br/>
<br/>
#define BG1_MAP_BASE            27
<br/>
#define BG1_MAP_BASE_SUB         27
<br/>
<br/>
#define BG2_MAP_BASE            28
<br/>
#define BG2_MAP_BASE_SUB         28
<br/>
<br/>
#define BG3_MAP_BASE            30
<br/>
#define BG3_MAP_BASE_SUB         30
<br/>
<br/>
#define BG0_TILE_BASE            7
<br/>
#define BG0_TILE_BASE_SUB         7
<br/>
<br/>
#define BG1_TILE_BASE            5
<br/>
#define BG1_TILE_BASE_SUB         5
<br/>
<br/>
#define BG2_TILE_BASE            6
<br/>
#define BG2_TILE_BASE_SUB         6
<br/>
<br/>
#define BG3_TILE_BASE            0
<br/>
#define BG3_TILE_BASE_SUB         0
<br/>
<br/>
videoSetMode(MODE_0_2D | DISPLAY_SPR_ACTIVE | DISPLAY_SPR_1D_LAYOUT | DISPLAY_BG0_ACTIVE | DISPLAY_BG1_ACTIVE | DISPLAY_BG2_ACTIVE | DISPLAY_BG3_ACTIVE);
<br/>
videoSetModeSub(MODE_0_2D | DISPLAY_SPR_ACTIVE | DISPLAY_SPR_1D_LAYOUT | DISPLAY_BG1_ACTIVE | DISPLAY_BG2_ACTIVE | DISPLAY_BG3_ACTIVE);
<br/>
<br/>
vramSetMainBanks(VRAM_A_MAIN_BG, VRAM_B_MAIN_SPRITE, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE);
<br/>
<br/>
bgInit(0, BgType_Text4bpp, BgSize_T_256x256, BG0_MAP_BASE, BG0_TILE_BASE);
<br/>
bgInit(1, BgType_Text8bpp, BgSize_T_256x256, BG1_MAP_BASE, BG1_TILE_BASE);
<br/>
bgInit(2, BgType_Text8bpp, BgSize_T_256x256, BG2_MAP_BASE, BG2_TILE_BASE);
<br/>
bgInit(3, BgType_Text8bpp, BgSize_T_256x256, BG3_MAP_BASE, BG3_TILE_BASE);
<br/>
<br/>
bgInitSub(1, BgType_Text8bpp, BgSize_T_256x256, BG1_MAP_BASE_SUB, BG1_TILE_BASE_SUB);
<br/>
int bg2Sub = bgInitSub(2, BgType_Text8bpp, BgSize_T_512x256, BG2_MAP_BASE_SUB, BG2_TILE_BASE_SUB);
<br/>
int bg3Sub = bgInitSub(3, BgType_Text8bpp, BgSize_T_512x256, BG3_MAP_BASE_SUB, BG3_TILE_BASE_SUB);
<br/>
<br/>
bgSetControlBits(bg2Sub, BG_PRIORITY_0);
<br/>
bgSetControlBits(bg3Sub, BG_PRIORITY_2);
<br/>
<br/>
lcdMainOnBottom();
<br/>
<br/>
// Some dma'ing of tiles and stuff here
<br/>
<br/>
oamInit(&amp;oamMain, SpriteMapping_Bmp_1D_128, false);
<br/>
oamInit(&amp;oamSub, SpriteMapping_Bmp_1D_128, false);</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170183 - headspin - Sun Sep 06, 2009 6:16 pm</h4>
    <div class="postbody"><span class="postbody">I'm still having trouble with this. I thought I would attach the bitmap example that uses my memory layout and has been modified to show sprites on both screens. Can anyone explain why the sprites don't display on both screens?
<br/>
<br/>
<a class="postlink" href="http://headsoft.com.au/download/nds/bitmap_sprites.zip" target="_blank">bitmap_sprites.zip</a><br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170185 - vuurrobin - Sun Sep 06, 2009 6:45 pm</h4>
    <div class="postbody"><span class="postbody">it seems to be exactly like this problem:
<br/>
<a href="http://forums.devkitpro.org/viewtopic.php?f=6&amp;t=1432" target="_blank">http://forums.devkitpro.org/viewtopic.php?f=6&amp;t=1432</a>
<br/>
<br/>
unfortunately, I don't know how to fix this.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170186 - DiscoStew - Sun Sep 06, 2009 7:55 pm</h4>
    <div class="postbody"><span class="postbody">This is just a guess in the dark, but are the background/Sprite functions taking into consideration the OFFSET value when using the banks a certain way? What I mean is this...
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Taken from video.h
<br/>
<br/>
(this is what the sprite demo uses)
<br/>
VRAM_A_MAIN_SPRITE = 2
<br/>
VRAM_D_SUB_SPRITE = 4
<br/>
<br/>
(this is what you are trying to use)
<br/>
VRAM_A_MAIN_BG = 1
<br/>
VRAM_B_MAIN_SPRITE = 2 | VRAM_OFFSET(1)
<br/>
VRAM_C_SUB_BG = 4
<br/>
VRAM_D_SUB_SPRITE = 4</td> </tr></table><span class="postbody">
<br/>
<br/>
Notice that with the set up you had, the only one with an offset value is for your sprites on your main screen, of which they aren't appearing?
<br/>
<br/>
Also...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">VRAM_A_MAIN_SPRITE = 2
<br/>
VRAM_B_MAIN_BG = 1 | VRAM_OFFSET(1),
<br/>
VRAM_C_SUB_BG = 4
<br/>
VRAM_D_SUB_SPRITE = 4</td> </tr></table><span class="postbody">
<br/>
<br/>
Now there is an offset for the backgrounds on the main screen instead of the sprite, and as you said, the backgrounds won't show up?
<br/>
<br/>
Again, this is purely speculation, as I have never touched these recently added functions (yet), but it seems to me that thre must be something involving them.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170187 - headspin - Sun Sep 06, 2009 9:06 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for putting me on the right track DiscoStew! I noticed the following define's in video.h
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">VRAM_B_MAIN_SPRITE   = 2 | VRAM_OFFSET(1),
<br/>
VRAM_B_MAIN_SPRITE_0x06400000   = 2,</td> </tr></table><span class="postbody">
<br/>
<br/>
So I tried changing to use the following banks
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">vramSetMainBanks(VRAM_A_MAIN_BG, VRAM_B_MAIN_SPRITE_0x06400000, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE);</td> </tr></table><span class="postbody">
<br/>
<br/>
Yay! Sprites working on both screens :)<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170188 - DiscoStew - Sun Sep 06, 2009 9:43 pm</h4>
    <div class="postbody"><span class="postbody">I'm glad that your problem got fixed, but it also shows a limitation to the background/sprite functions in it's current form. I'll make a suggestion on the devkitPro forums about it.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170192 - sverx - Mon Sep 07, 2009 10:25 am</h4>
    <div class="postbody"><span class="postbody">I think the problem is about the definitions. I mean, if you define
<br/>
<br/>
VRAM_x_MAIN_SPRITE
<br/>
<br/>
you will be thinking that you're using that x bank 'left aligned' in the memory space (and if you don't need another bank you won't even worry about how to declare a 'second' bank...)
<br/>
<br/>
So actually I think there should be another set of defines, leaving those already defined for backward compatibilty. Something like
<br/>
<br/>
VRAM_x_MAIN_SPRITE_1ST_BANK
<br/>
VRAM_x_MAIN_SPRITE_2ND_BANK
<br/>
<br/>
for instance (or something that sounds better but has the same meaning). The same with backgrounds and textures (if you check, there's the same problem...)
<br/>
<br/>
My 2 cents.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170193 - vuurrobin - Mon Sep 07, 2009 1:39 pm</h4>
    <div class="postbody"><span class="postbody">those defines are already there in the vram enum. from libnds's video.h:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/** \brief  Allowed VRAM bank A modes */
<br/>
typedef enum {
<br/>
   VRAM_A_LCD   =   0,
<br/>
   VRAM_A_MAIN_BG  = 1,
<br/>
   VRAM_A_MAIN_BG_0x06000000   = 1 | VRAM_OFFSET(0),
<br/>
   VRAM_A_MAIN_BG_0x06020000   = 1 | VRAM_OFFSET(1),
<br/>
   VRAM_A_MAIN_BG_0x06040000   = 1 | VRAM_OFFSET(2),
<br/>
   VRAM_A_MAIN_BG_0x06060000   = 1 | VRAM_OFFSET(3),
<br/>
   VRAM_A_MAIN_SPRITE = 2,
<br/>
   VRAM_A_MAIN_SPRITE_0x06400000   = 2,
<br/>
   VRAM_A_MAIN_SPRITE_0x06420000   = 2 | VRAM_OFFSET(1),
<br/>
   VRAM_A_TEXTURE = 3,
<br/>
   VRAM_A_TEXTURE_SLOT0   = 3 | VRAM_OFFSET(0),
<br/>
   VRAM_A_TEXTURE_SLOT1   = 3 | VRAM_OFFSET(1),
<br/>
   VRAM_A_TEXTURE_SLOT2   = 3 | VRAM_OFFSET(2),
<br/>
   VRAM_A_TEXTURE_SLOT3   = 3 | VRAM_OFFSET(3)
<br/>
} VRAM_A_TYPE;</td> </tr></table><span class="postbody">
<br/>
<br/>
see that VRAM_A_MAIN_SPRITE and VRAM_A_MAIN_SPRITE_0x06400000 have the same value, and that VRAM_A_MAIN_SPRITE_0x06420000 would represent VRAM_x_MAIN_SPRITE_2ND_BANK.
<br/>
<br/>
I think that VRAM_A_MAIN_SPRITE is only ment be used when you have 1 bank, and the other enum values when you have multiple banks.<br/>_________________<br/>my blog:
<br/>
<a href="http://vuurrobin.100webcustomers.com/" target="_blank">http://vuurrobin.100webcustomers.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170194 - sverx - Mon Sep 07, 2009 1:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>vuurrobin wrote:</b></span></td> </tr> <tr> <td class="quote">see that VRAM_A_MAIN_SPRITE and VRAM_A_MAIN_SPRITE_0x06400000 have the same value, and that VRAM_A_MAIN_SPRITE_0x06420000 would represent VRAM_x_MAIN_SPRITE_2ND_BANK.
<br/>
<br/>
I think that VRAM_A_MAIN_SPRITE is only ment be used when you have 1 bank, and the other enum values when you have multiple banks.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, it works with VRAM_A, it's different with VRAM_B, for instance...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef enum {
<br/>
   VRAM_B_LCD = 0,
<br/>
   VRAM_B_MAIN_BG   = 1 | VRAM_OFFSET(1),
<br/>
   VRAM_B_MAIN_BG_0x06000000   = 1 | VRAM_OFFSET(0),
<br/>
   VRAM_B_MAIN_BG_0x06020000   = 1 | VRAM_OFFSET(1),
<br/>
   VRAM_B_MAIN_BG_0x06040000   = 1 | VRAM_OFFSET(2),
<br/>
   VRAM_B_MAIN_BG_0x06060000   = 1 | VRAM_OFFSET(3),
<br/>
   VRAM_B_MAIN_SPRITE   = 2 | VRAM_OFFSET(1),
<br/>
   VRAM_B_MAIN_SPRITE_0x06400000   = 2,
<br/>
   VRAM_B_MAIN_SPRITE_0x06420000   = 2 | VRAM_OFFSET(1),
<br/>
   VRAM_B_TEXTURE   = 3 | VRAM_OFFSET(1),
<br/>
   VRAM_B_TEXTURE_SLOT0   = 3 | VRAM_OFFSET(0),
<br/>
   VRAM_B_TEXTURE_SLOT1   = 3 | VRAM_OFFSET(1),
<br/>
   VRAM_B_TEXTURE_SLOT2   = 3 | VRAM_OFFSET(2),
<br/>
   VRAM_B_TEXTURE_SLOT3   = 3 | VRAM_OFFSET(3)
<br/>
} VRAM_B_TYPE;</td> </tr></table><span class="postbody">
<br/>
<br/>
in this case, if you use VRAM_B_MAIN_SPRITE and you're using only 1 bank, it's "wrong" (it's not allocated where GFX[] points...)
<br/>
<br/>
So my 2 cents were about defining <span style="font-weight: bold">also</span> something like this, or similar... (ex: for bank B)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   VRAM_B_MAIN_BG_1ST_BANK   = 1 | VRAM_OFFSET(0),
<br/>
   VRAM_B_MAIN_BG_2ND_BANK   = 1 | VRAM_OFFSET(1),
<br/>
   VRAM_B_MAIN_BG_3RD_BANK   = 1 | VRAM_OFFSET(2),
<br/>
   VRAM_B_MAIN_BG_4TH_BANK   = 1 | VRAM_OFFSET(3),
<br/>
   VRAM_B_MAIN_SPRITE_1ST_BANK   = 2 | VRAM_OFFSET(0),
<br/>
   VRAM_B_MAIN_SPRITE_1ND_BANK   = 2 | VRAM_OFFSET(1)</td> </tr></table><span class="postbody">
<br/>
<br/>
which would be easier. IMHO of course.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170202 - Echo49 - Mon Sep 07, 2009 11:50 pm</h4>
    <div class="postbody"><span class="postbody">I would prefer VRAM_B_MAIN_BG_BANK_n rather than mixing up ST, ND, RD and TH, which might be unintuitive to some people.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170208 - sverx - Tue Sep 08, 2009 1:28 pm</h4>
    <div class="postbody"><span class="postbody">Yep, that's true... maybe then from BANK0 to BANK3?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170209 - Cearn - Tue Sep 08, 2009 3:31 pm</h4>
    <div class="postbody"><span class="postbody">Or _SLOT0-3, then it's consistent with the texture constants as well. 
<br/>
<br/>
I'm not sure that adding an additional set to the already long list of VRAM bank constants is a good idea though. It may simplify the definitions themselves, but because the addresses that some of the configurations attach to is sometimes non-intuitive (for example, sub-BG can only use bank I at 0600:8000), removing the addresses from the names hides which address ranges are accessible, which can be problematic.
<br/>
<br/>
<span style="font-size: 8px; line-height: normal">Also, +1 to VRAM_B_MAIN_SPRITE's current definition being somewhat awkward.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170210 - sverx - Tue Sep 08, 2009 3:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">Or _SLOT0-3, then it's consistent with the texture constants as well.</td> </tr></table><span class="postbody">
<br/>
<br/>
... right :)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not sure that adding an additional set to the already long list of VRAM bank constants is a good idea though. It may simplify the definitions themselves, but because the addresses that some of the configurations attach to is sometimes non-intuitive (for example, sub-BG can only use bank I at 0600:8000), removing the addresses from the names hides which address ranges are accessible, which can be problematic.</td> </tr></table><span class="postbody">
<br/>
<br/>
we could define these:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">VRAM_C_SUB_BG_SLOT01 = VRAM_C_SUB_BG
<br/>
VRAM_H_SUB_BG_SLOT0  = VRAM_H_SUB_BG
<br/>
VRAM_I_SUB_BG_SLOT1  = VRAM_I_SUB_BG_0x06208000</td> </tr></table><span class="postbody">
<br/>
<br/>
so that it will be clear that you can use VRAM bank C o_OR_ VRAM bank (H and/or I)...
<br/>
<br/>
(well, it's not that this way it becomes really simple...)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
