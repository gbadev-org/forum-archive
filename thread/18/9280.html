<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>libmad compilation problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > libmad compilation problem</h2>
<div id="posts">
<div class="post">
    <h4>#79972 - Freixa - Mon Apr 17, 2006 9:21 pm</h4>
    <div class="postbody"><span class="postbody">Hi!
<br/>
<br/>
I need a mp3 lib for nds and I think libmad will be good for it, it can be compiled to ARM and some people in this forum spoke well about it. But I can't install the lib, I try to compile it but i can't. I run the configuration script a few times with a few diferent arguments, like ./configure --host=arm, ./configure --enable-fpm=arm, etc... The configure script goes ok, but when I try to execute the Makefile I recived this errors:
<br/>
<br/>
synth.c: In function `dct32':
<br/>
synth.c:218: warning: asm operand 5 probably doesn't match constraints
<br/>
synth.c:218: warning: asm operand 6 probably doesn't match constraints
<br/>
(...)
<br/>
synth.c:218: inconsistent operand constraints in an `asm'
<br/>
synth.c:219: inconsistent operand constraints in an `asm'
<br/>
(...)
<br/>
synth.c: In function `synth_full':
<br/>
synth.c:611: warning: asm operand 3 probably doesn't match constraints
<br/>
synth.c:611: warning: asm operand 4 probably doesn't match constraints
<br/>
(...)
<br/>
synth.c: In function `synth_half':
<br/>
synth.c:748: warning: asm operand 3 probably doesn't match constraints
<br/>
synth.c:748: warning: asm operand 4 probably doesn't match constraints
<br/>
<br/>
Anyone knows what I'm doing wrong?
<br/>
<br/>
Thnxs a lot and sorry for my bad english.
<br/>
freixa</span><span class="gensmall"><br/><br/>Last edited by Freixa on Mon Apr 17, 2006 10:12 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#79979 - tepples - Mon Apr 17, 2006 10:07 pm</h4>
    <div class="postbody"><span class="postbody">It may have something to do with subtle changes in inline assembly language syntax between GCC versions.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81056 - FluBBa - Wed Apr 26, 2006 10:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Freixa wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
synth.c: In function `dct32':
<br/>
synth.c:218: warning: asm operand 5 probably doesn't match constraints
<br/>
synth.c:218: warning: asm operand 6 probably doesn't match constraints
<br/>
</td> </tr></table><span class="postbody">
<br/>
Not sure but it sounds like it's for a little more advanced ARM than the one in the DS?<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81084 - josath - Thu Apr 27, 2006 1:09 am</h4>
    <div class="postbody"><span class="postbody">Try compiling it and disabling the optimized ASM. I'm pretty sure it includes C code for all the algorithms, which should work, but possibly be a bit slower.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81751 - Freixa - Mon May 01, 2006 9:15 pm</h4>
    <div class="postbody"><span class="postbody">Thnxs to all! 
<br/>
<br/>
Well, I think the problem was in the version of GCC like tepples said, I tried other versions and it compiles ok, but when I try to call any function of the library the program hang. The program hangs with any function of the lib, I tried to compile with other flags and with no optimization but it hangs again. It hangs in Dualis and in the DS too.
<br/>
<br/>
Any suggestions???
<br/>
<br/>
Thnxs in advance
<br/>
freixa</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#81757 - dovoto - Mon May 01, 2006 10:05 pm</h4>
    <div class="postbody"><span class="postbody">Well, i never had a configurable make file work out well for me on consoles...when i ported libmad a long while back the the DS i just stole the makefile out of libnds and modified it a bit.
<br/>
<br/>
I was able to get non-realtime playback of mp3's going with only a couple of hours of work (ie i decompressed to a buffer then played the buffer although it seemed to decompress slightly faster than it took to play back the sample which bodes well for implementing some sort of cyclic buffer).  
<br/>
<br/>
I still have the package at home (i think) but it was several versions of devkitarm ago...may even have been before ndslib was libnds and before devkitarm had any ds support...i will look though and post it if i find it...may even try to fix it first.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83327 - wintermute - Mon May 15, 2006 4:37 pm</h4>
    <div class="postbody"><span class="postbody">I had a look at this earlier, it configured and built just fine. The configure command was as follows, run from an msys shell with devkitarm in the path.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
CFLAGS=-mthumb-interwork LDFLAGS=-specs=ds_arm9.specs ../../libmad-0.15.1b/configure --host=arm-elf --enable-speed --enable-fpm=arm
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
