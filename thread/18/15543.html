<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Connecting IO's to DS GBA Slot - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Connecting IO's to DS GBA Slot</h2>
<div id="posts">
<div class="post">
    <h4>#156929 - Key_46 - Fri May 16, 2008 10:37 am</h4>
    <div class="postbody"><span class="postbody">hi, i am trying to connect a small DC motor(not like Rumble Pack) and a small switch and i don't know what pins should i use and how to access the via code... i am thinking to use /WR for out and /RD for in. will this work?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156931 - Maxxie - Fri May 16, 2008 11:03 am</h4>
    <div class="postbody"><span class="postbody">/RD and /WR are not data, they control the dataflow on the Adr/Data Lines</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156933 - tepples - Fri May 16, 2008 12:27 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.reinerziegler.de/GBA/gba.htm#How%20does%20the" target="_blank">Everything You Always Wanted To Know About SLOT-2</a>*
<br/>
<br/>
<br/>
<span style="font-size: 9px; line-height: normal">*but were afraid to ask</span><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156949 - Key_46 - Fri May 16, 2008 7:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><a class="postlink" href="http://www.reinerziegler.de/GBA/gba.htm#How%20does%20the" target="_blank">Everything You Always Wanted To Know About SLOT-2</a>*
<br/>
<br/>
<br/>
<span style="font-size: 9px; line-height: normal">*but were afraid to ask</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I Still can't unsderstand how to change and get the ports state via Code... now i am using the pins 22 ~ 29 as my IO's, to pull them low can i just leave them open or i need to ground them?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#156954 - Maxxie - Fri May 16, 2008 8:29 pm</h4>
    <div class="postbody"><span class="postbody">You can't as it is NOT a single address IO Port.
<br/>
<br/>
For a simple IO that runs on every address on that bus (you can access it by reading or writing any address from 0x08000000 to 0x09FFFFFF) you need to apply two latches.
<br/>
<br/>
The input should only be passed to the bus (on the AD lines), when /CS = 0 and /RD = 0.
<br/>
The output is only valid to read when /CS = 0 and /WR = 0. You need to buffer the output if you want to work with it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157139 - griff - Mon May 19, 2008 7:29 pm</h4>
    <div class="postbody"><span class="postbody">Do you think it's possible to make a serial communication using the GBA port, to communicate with a PC or something like that?!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157141 - Key_46 - Mon May 19, 2008 7:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>griff wrote:</b></span></td> </tr> <tr> <td class="quote">Do you think it's possible to make a serial communication using the GBA port, to communicate with a PC or something like that?!</td> </tr></table><span class="postbody">
<br/>
<br/>
In theory it's not that hard. My idea at this moment is to make a little AM Radio Transmitter for DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157144 - Maxxie - Mon May 19, 2008 7:45 pm</h4>
    <div class="postbody"><span class="postbody">Uhm, actually there are plenty available already.
<br/>
<br/>
<a class="postlink" href="http://www.cs.ucr.edu/%7Eamitra/sdcard/ProdManualSDCardv1.9.pdf" target="_blank">SPI in SD Cards/Interfaces (chapter 5)</a>
<br/>
<a class="postlink" href="http://de.wikipedia.org/wiki/Serial_Peripheral_Interface" target="_blank">SPI is a serial interface</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157204 - Key_46 - Tue May 20, 2008 10:18 am</h4>
    <div class="postbody"><span class="postbody">Again, a new solution, this time a little bit more complicated: A Little Microcontroller connected to /WR, /RD, AD1, AD2, my actuator (via transistor ) and my switch. When i press the switch the PIC forces /WR to high and /RD to low, AD1 to high. When i release it, the PIC forces /RD to high and /WR to low and controls the motor using AD2.
<br/>
*i will try do something more simple using just logical ports...
<br/>
<br/>
And, for the code, how can i know if the DS is in read or write mode?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157205 - Maxxie - Tue May 20, 2008 10:55 am</h4>
    <div class="postbody"><span class="postbody">The control lines are output only.
<br/>
<br/>
They are driven by the DS on read/writes on the named memory regions.
<br/>
So that the software on the DS needs to poll data from the bus, and the cartridge needs to wait until an operation is requested. (possibly because there was)
<br/>
<br/>
The only pure input signal is /REQ as a special purpose signal.
<br/>
<br/>
<a href="http://nocash.emubase.de/gbatek.htm#auxgbagamepakbus" target="_blank">http://nocash.emubase.de/gbatek.htm#auxgbagamepakbus</a>
<br/>
<br/>
You can not inject any data into the system or set it into an hw write mode from peripherival. You need always software to actively read/write data.
<br/>
<br/>
<br/>
If you drive the signals too by the logic you described, all you will achive is shortages on the control line, which - dependind on the safetly measures in the DS itself - will shut the DS down, suck on the battery, burn a fuse or damage your DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157223 - Key_46 - Tue May 20, 2008 5:31 pm</h4>
    <div class="postbody"><span class="postbody">Ok, i will use Clock Output pin to sync my chip with the DS and program the Chip to detect /WR and /RD state changes and send/read information.
<br/>
<br/>
I read in <a class="postlink" href="http://www.bottledlight.com/ds/index.php/Hardware/GBACartridgePort" target="_blank">http://www.bottledlight.com/ds/index.php/Hardware/GBACartridgePort</a>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Sequential reads are done by strobing /RD low: data will be output on AD0..AD15 and should be valid on the rising edge of /RD. </td> </tr></table><span class="postbody">
<br/>
<br/>
So, i need to wait /RD to be low, set AD data, then the DS will pull up /RD to confirm the reading end?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157224 - Maxxie - Tue May 20, 2008 6:31 pm</h4>
    <div class="postbody"><span class="postbody">Yes</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
