<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Text texture - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Text texture</h2>
<div id="posts">
<div class="post">
    <h4>#159216 - sUPREz - Fri Jun 27, 2008 11:31 am</h4>
    <div class="postbody"><span class="postbody">Hi, 
<br/>
I'm currently working om my game's 3d interface. 
<br/>
<br/>
I have lots of button with the same background but the text is each time different. If I add one pcx per button, the memory isn't large enough. So I'm trying to "write" some text on generated texture I can render on additional quads.
<br/>
<br/>
A friend tell me this advice but I really don't know how to get started with this. 
<br/>
<br/>
Where can I find tutorials or examples talking about that ?
<br/>
<br/>
thanks !</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159218 - silent_code - Fri Jun 27, 2008 12:03 pm</h4>
    <div class="postbody"><span class="postbody">Some example images would help - I don't get the idea and I also don't think there's some info about it out there...<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159221 - sUPREz - Fri Jun 27, 2008 1:14 pm</h4>
    <div class="postbody"><span class="postbody">I have something like 30 buttons like that :
<br/>
<a href="http://srcproject.free.fr/_temp/newgame.gif">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
I'm looking for a code that write text in a small graphic buffer I can use as a texture. So that I only load my button once and I can wrote the text I want on it.
<br/>
<br/>
Maybe it's more clear now ? :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159225 - elwing - Fri Jun 27, 2008 2:50 pm</h4>
    <div class="postbody"><span class="postbody">you might want to check Cearn marvelous work:
<br/>
<a class="postlink" href="http://www.coranac.com/" target="_blank">http://www.coranac.com/</a>
<br/>
specialy what's related to TTE. it is written for the GBA, but most of the NDS 2D hardware is the same...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159765 - Fury - Sun Jul 06, 2008 12:26 pm</h4>
    <div class="postbody"><span class="postbody">If you pre-generate a character set, say 8-bit and choose one colour for transparency (say palette entry 0) then it shouldn't be too hard to blit the chars over the button texture, skipping any 0's
<br/>
<br/>
If memory is _really_ tight, you can use a 4 or 1-bit character set, but your algorithm gets more complicated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159786 - dovoto - Sun Jul 06, 2008 7:42 pm</h4>
    <div class="postbody"><span class="postbody">The simple way is to put your font in a single large texture.  You could then composite the background button graphics with a series of foreground quads mapped such that their textures have the appropriate letter on them.  However, the DS is very limited in its quads per frame so this may not be a viable approach.
<br/>
<br/>
Pre-rendered buttons will generally look better than rendering text onto a button without advanced techniques so another thing to consider is compressing the button textures by reducing their size, their color depth, or using the compressed texture format on the DS. 
<br/>
<br/>
Also you could do a more traditional compression such as one supported by the DS bios or a more standard png or jpg format.  You would have to decompress them into vram as you need them of course.
<br/>
<br/>
Keep in mind that if you render the texture bitmaps you will not save any vram used only save the size of your rom unless you use the first approach above which composites the button and the text.
<br/>
<br/>
One final method which might result in the best trade off is to use a single texture for the button background and a single texture for each string.  You could build the texture for the text in main memory from a font stored in main memory using standard bit blitting techniques (do a google on software bit blitting and rendering fonts).  Once the texture is complete you can load it into vram (you could also also build it directly in vram however the 16 bit bus is sort of a pain to blit low color depth stuff to).
<br/>
<br/>
What you gain by doing the above is a much more dynamic way of storing your buttons in memory (you can create new buttons on the fly by assigning them a size, a background, and a string).  You also can use a very low color count on the text textures and only one background per button type which may result in a bit of vram savings.
<br/>
<br/>
What you lose is quality (a pre-rendered button is going to have smoother more readable text),  a bit of speed (it takes time to render and load textures),  and a quad per button (each button will take two quads to render it, a limiting factor in a system that only gives you 1500 or so quads to play with).
<br/>
<br/>
One final note is that you can use a 2D background layer for your buttons.  If you are currently not using the 2D hardware in your engine this might be a good approach as the process is the similar to that above and you save a few precious quads for your 3D scene.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159793 - ZeroSum - Sun Jul 06, 2008 9:03 pm</h4>
    <div class="postbody"><span class="postbody">I use the method dovoto described above, having a font texture and rendering a quad per letter. As he said though it depends on how many quads you have spare and how many strings you want to draw.
<br/>
<br/>
In case it's useful heres the relevant images/code:
<br/>
<br/>
My font texture: <a href="http://img301.imageshack.us/img301/3121/dsfontku6.png">[Images not permitted - Click here to view it]</a>
<br/>
How it looks: <a href="http://img382.imageshack.us/img382/3543/fontcq1.png">[Images not permitted - Click here to view it]</a>
<br/>
The code: <a class="postlink" href="http://rafb.net/p/MePCWi15.html" target="_blank">http://rafb.net/p/MePCWi15.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159796 - silent_code - Sun Jul 06, 2008 10:33 pm</h4>
    <div class="postbody"><span class="postbody">You could also use (Sprite) Objects. That method (like any other) has its limitations, but it might be worth experimenting with. ;^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159802 - DensitY - Mon Jul 07, 2008 1:28 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">You could also use (Sprite) Objects. That method (like any other) has its limitations, but it might be worth experimenting with. ;^)</td> </tr></table><span class="postbody">
<br/>
<br/>
^^ works reasonably well if you want mostly single words.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159804 - silent_code - Mon Jul 07, 2008 1:36 am</h4>
    <div class="postbody"><span class="postbody">Well, you could use up to 128 8 pixel wide, unrotated objects per scanline, so I guess it would be more than enough, right? ;^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159806 - DensitY - Mon Jul 07, 2008 1:43 am</h4>
    <div class="postbody"><span class="postbody">what i do is actually make a 32x16 sprite and draw a 4x8 font into it. that gives me about 8 characters over 2 lines.. just join a few together to get a sentance. to make things fast I store the font in a special 4x8 tile format so I can do :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while(heightofletter--) // ie 8 pixels
<br/>
{
<br/>
   int words = 2; //(4 bytes basically)
<br/>
   while(words--)
<br/>
   {
<br/>
    //  you can do color replacement here as well if need be.
<br/>
       *dest++ = *src++; 
<br/>
   } 
<br/>
//   skip the next 4 bytes, as its the second half of the 8x8 tile, and our 
<br/>
  // font is 4x8
<br/>
   dest+=2;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and just write it directly into the sprites vram address. its pretty quick.
<br/>
<br/>
(Warning: at work, just wrote in what I remembered off the top of my head lol).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159824 - elwing - Mon Jul 07, 2008 6:48 am</h4>
    <div class="postbody"><span class="postbody">don't want to sound rash, but tonc's text engine on the website I mentionned contain link to a tonclib (and it's source) and it is able to render fixed, variable width font to tiled, afine and bitmap bg... that seems to contain all what you need. and if you want to make the text renderer by yourself looking at tte would be a great idea...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
