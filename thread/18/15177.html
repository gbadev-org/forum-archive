<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>sprite  subscreen do not show  up [SOLVED] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > sprite  subscreen do not show  up [SOLVED]</h2>
<div id="posts">
<div class="post">
    <h4>#152306 - a128 - Thu Mar 13, 2008 4:17 pm</h4>
    <div class="postbody"><span class="postbody">yet another sprite problem
<br/>
<br/>
Main screen is 3D  
<br/>
Sub screen a layer of backgrounds where also some sprites should appear.
<br/>
<br/>
it's ok BUT no sprite appears on subscreen
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
  // Setup the Main screen for 3D
<br/>
                videoSetMode(MODE_0_3D );
<br/>
<br/>
                vramSetBankA(VRAM_A_TEXTURE); //128Kbyte
<br/>
      vramSetBankB(VRAM_B_TEXTURE); // 128Kbyte
<br/>
      
<br/>
      //SUB SCREEN
<br/>
      vramSetBankC(VRAM_C_SUB_BG);
<br/>
      vramSetBankD(VRAM_D_SUB_SPRITE); 
<br/>
      vramSetBankH(VRAM_H_SUB_BG);
<br/>
   // sub screen
<br/>
         videoSetModeSub(MODE_5_2D |
<br/>
               DISPLAY_SPR_ACTIVE |    //turn on sprites
<br/>
               DISPLAY_SPR_1D_BMP  |    //and this in bitmap mode
<br/>
               DISPLAY_BG3_ACTIVE  | // race track as ROT backgound 
<br/>
               DISPLAY_BG0_ACTIVE /*console*/);
<br/>
<br/>
<br/>
               // text
<br/>
         SUB_BG0_CR =
<br/>
            BG_MAP_BASE(15) |
<br/>
            BG_PRIORITY(0) |
<br/>
            BG_256_COLOR;
<br/>
<br/>
         BG_PALETTE_SUB[0] =RGB15(10,23,31);
<br/>
         BG_PALETTE_SUB[255] = RGB15(31,0,0);
<br/>
<br/>
         consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(15), (u16*)CHAR_BASE_BLOCK_SUB(0), 8);
<br/>
<br/>
         video_buffer =  (u16*)BG_BMP_RAM_SUB(2);
<br/>
<br/>
         // create background image
<br/>
         SUB_BG3_CR = BG_BMP16_256x256 | BG_BMP_BASE(2) | BG_PRIORITY(1) ;
<br/>
<br/>
         SUB_BG3_XDX = 1 &lt;&lt; 8;
<br/>
         SUB_BG3_XDY = 0;
<br/>
         SUB_BG3_YDX = 0;
<br/>
         SUB_BG3_YDY = 1 &lt;&lt; 8;
<br/>
         SUB_BG3_CX = 0;
<br/>
         SUB_BG3_CY = 0;
<br/>
  
<br/>
<br/>
//SPRITE TEST SETUP
<br/>
<br/>
//turn off all the sprites
<br/>
                      InitSprites();  
<br/>
<br/>
         sprites[0].attribute[0] = ATTR0_BMP | ATTR0_ROTSCALE_DOUBLE | 30; 
<br/>
         sprites[0].attribute[1] = ATTR1_SIZE_32 | 40;
<br/>
         sprites[0].attribute[2] = ATTR2_ALPHA(1)| 0;
<br/>
<br/>
         // red 32*32 square for 1d bitmap mode
<br/>
      for(int i=0;i&lt;32*32;i++)
<br/>
         SPRITE_GFX[i]=RGB15(31,0,0)|(1&lt;&lt;15); //dont forget alpha bit
<br/>
<br/>
         
<br/>
//OAM update
<br/>
         DC_FlushRange(sprites,128*sizeof(SpriteEntry));
<br/>
     dmaCopy(sprites, OAM_SUB, 128 * sizeof(SpriteEntry));
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"><br/><br/>Last edited by a128 on Thu Mar 13, 2008 4:43 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#152307 - eKid - Thu Mar 13, 2008 4:36 pm</h4>
    <div class="postbody"><span class="postbody">One thing to note is that ATTR2_ALPHA ranges from 0-&gt;15, it should be 15 for full opacity. And I guess "SPRITE_GFX" should be changed to "SPRITE_GFX_SUB".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#152308 - a128 - Thu Mar 13, 2008 4:43 pm</h4>
    <div class="postbody"><span class="postbody">done. it works! thanks</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
