<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Turning off screens - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Turning off screens</h2>
<div id="posts">
<div class="post">
    <h4>#70873 - HyperHacker - Thu Feb 09, 2006 6:07 am</h4>
    <div class="postbody"><span class="postbody">How exactly do you turn off one of the LCD screens entirely? I can turn the backlight off, but things still display on the screen.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70877 - LiraNuna - Thu Feb 09, 2006 6:31 am</h4>
    <div class="postbody"><span class="postbody">videoSetMode(DISPLAY_SCREEN_OFF);
<br/>
<br/>
or
<br/>
<br/>
videoSetModeSub(DISPLAY_SCREEN_OFF);</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70885 - HyperHacker - Thu Feb 09, 2006 8:06 am</h4>
    <div class="postbody"><span class="postbody">Thanks. Is there a way to get rid of the flicker though? What I mean is when I have one screen (and its backlight) on, and the other off, and I swap the screens, they both flash white for a second.
<br/>
<br/>
ARM9 code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">lcdSwap();
<br/>
TopScreen = !TopScreen;
<br/>
if(EnableBacklight)
<br/>
{
<br/>
   IPC-&gt;arm7data = PM_BACKLIGHT_TOP | PM_BACKLIGHT_BOTTOM; //Swap backlights
<br/>
   IPC-&gt;arm7desc = A7_POWERTOGGLE;
<br/>
   while(IPC-&gt;arm9desc != A9_ACK); //Wait for ARM7 to respond
<br/>
   IPC-&gt;arm9desc = 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
ARM7 code, in vblank handler:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">TransferRegion T;
<br/>
memcpy((uint8*)&amp;T,(uint8*)IPC,sizeof(T));
<br/>
if(T.arm7desc) IPC-&gt;arm7desc = 0;
<br/>
<br/>
switch(T.arm7desc)
<br/>
{
<br/>
   [...]
<br/>
<br/>
   case A7_POWERTOGGLE: //Toggle device power
<br/>
   SerialWaitBusy();
<br/>
   REG_SPICNT = SPI_ENABLE | SPI_DEVICE_POWER | SPI_BAUD_1MHz | SPI_CONTINUOUS;
<br/>
   REG_SPIDATA = 0x80;
<br/>
   SerialWaitBusy();
<br/>
   REG_SPICNT = SPI_ENABLE | SPI_DEVICE_POWER | SPI_BAUD_1MHz;
<br/>
   REG_SPIDATA = 0;
<br/>
   SerialWaitBusy();
<br/>
   B = REG_SPIDATA &amp; 0xFF;
<br/>
<br/>
   SerialWaitBusy();
<br/>
   REG_SPICNT = SPI_ENABLE | SPI_DEVICE_POWER | SPI_BAUD_1MHz | SPI_CONTINUOUS;
<br/>
   REG_SPIDATA = 0;
<br/>
   SerialWaitBusy();
<br/>
   REG_SPICNT = SPI_ENABLE | SPI_DEVICE_POWER | SPI_BAUD_1MHz;
<br/>
   REG_SPIDATA = B ^ T.arm7data;
<br/>
   T.arm9desc = A9_ACK;
<br/>
   break;
<br/>
   [...]
<br/>
}
<br/>
[...]
<br/>
IPC-&gt;arm9desc = T.arm9desc;
<br/>
IPC-&gt;arm9data = T.arm9data;</td> </tr></table><span class="postbody">
<br/>
(Using a customized IPC struct. armXdata = data sent to ARMX, armXdesc = description of data.)
<br/>
<br/>
The flicker is even worse if I call lcdSwap() after swapping the backlights. :-/</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#70931 - CubeGuy - Thu Feb 09, 2006 4:22 pm</h4>
    <div class="postbody"><span class="postbody">The commercial games all flash white as well.<br/>_________________<br/>It's 'CubeGuy.' One word. No space.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#71049 - HyperHacker - Fri Feb 10, 2006 3:27 am</h4>
    <div class="postbody"><span class="postbody">Ah, guess it can't be avoided then. No big deal.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#146178 - tepples - Fri Nov 30, 2007 2:44 am</h4>
    <div class="postbody"><span class="postbody">You could always make sure to change the lighting state only on a screen that's set to black. For example, when turning off a screen, put it in these states in this order: <ol type="1"><li>Picture + light </li><li>Black screen + light </li><li>Black screen + no light </li><li>No picture + no light </li><li>Core turned off + no light (if necessary)</li></ol>
<br/>
And reverse the steps to turn on a screen.
<br/>
<br/>
<br/>
(This bump brought to you by the Search button.)<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
