<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Is keysSetRepeat() and keysDownRepeat() working? [nvm] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Is keysSetRepeat() and keysDownRepeat() working? [nvm]</h2>
<div id="posts">
<div class="post">
    <h4>#167287 - DiscoStew - Sun Mar 08, 2009 7:57 am</h4>
    <div class="postbody"><span class="postbody">I don't know if I'm doing this the wrong way, but I have my code similar to this...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">...
<br/>
...
<br/>
keysSetRepeat( 20, 10 );
<br/>
...
<br/>
while( 1 )
<br/>
{
<br/>
   scanKeys();
<br/>
   ...
<br/>
   ...
<br/>
   if( keysDownRepeat() &amp; KEY_UP )
<br/>
      ...
<br/>
   else if( keysDownRepeat() &amp; KEY_DOWN )
<br/>
      ...
<br/>
   ...
<br/>
   ...
<br/>
   swiWaitForVBlank();
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
What I believe I should be expecting is that at the moment I hold down either Up or Down, it triggers once, then wait for 20 scanKeys() cycles before it starts repeating, and it repeats once every 10 scanKeys() cycles, correct?
<br/>
<br/>
Well, with trying to use it, I get nothing. No activity from keysDownRepeat(). Anyone else tried using them?
<br/>
<br/>
<br/>
EDIT:
<br/>
<br/>
Please delete......it seemed that doing direct ANDing didn't work, but storing the result, and ANDing that does work.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167334 - albinofrenchy - Mon Mar 09, 2009 11:11 am</h4>
    <div class="postbody"><span class="postbody">Don't delete, its informative if someone else has the same issue :)
<br/>
<br/>
Here is why btw, check out libnds source file keys.c:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//------------------------------------------------------------------------------
<br/>
uint32 keysDownRepeat(void) {
<br/>
//------------------------------------------------------------------------------
<br/>
   uint32 tmp = keysrepeat;
<br/>
<br/>
    keysrepeat = 0;
<br/>
<br/>
    return tmp;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You could probably make the case that this is a bug; that keysrepeat shouldn't be zeroed out until scanKeys is called again.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
