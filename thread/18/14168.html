<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>It is impossible to synchronize it!!! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > It is impossible to synchronize it!!!</h2>
<div id="posts">
<div class="post">
    <h4>#140568 - Blue Frenzy - Mon Sep 17, 2007 5:59 pm</h4>
    <div class="postbody"><span class="postbody">I surrender. I tryed docens of ways to synchronize the song with a simple value. The variable is always under the song time because, when i get 59 or less fps, the counter grows slower. When that is made 20 times, i have a huge delay very noticeable on a game like ouendan.
<br/>
<br/>
I tryed using ticks, but the value randomly increases much more so i can't get an exact value in miliseconds.
<br/>
<br/>
There is no way to know the playing time of the raw, so I cannot retrieve that value and operate with it.
<br/>
<br/>
I also tryed to, if fps is 59, add 1 to counter. It failed because, the real framerate is not an exact number, so if game runs at 59.2 or 59.6 it finishes delaying again, but this time with unpredictalbe results.
<br/>
<br/>
please, any help here?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140569 - Mighty Max - Mon Sep 17, 2007 6:38 pm</h4>
    <div class="postbody"><span class="postbody">First thing:
<br/>
Do not use VBLANK for arm9/arm7 communication when you need exact timings, as doing so will often mean that your arm7 receives the commands a frame later then the arm9 sends it. (Setting the data might not be finished when it is checked for read). Use the IPC-FIFO. 
<br/>
<br/>
Then, use the counters. Set one to reach 0 after 1ms and increase the ms counter on timerirc. However if you have the cpu longer times in IRQ state, the irq might delay. If you have such an design (like doing many things in vblank) use another timer that gets increased once the first hits 0 again.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
