<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Setting the Alpha bit of 16bit color to 0 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Setting the Alpha bit of 16bit color to 0</h2>
<div id="posts">
<div class="post">
    <h4>#93385 - TheRain - Tue Jul 18, 2006 10:15 pm</h4>
    <div class="postbody"><span class="postbody">I am trying to set the alpha bit in a 16 bit color to 0 and I cannot think of the solution to this.   
<br/>
<br/>
I have seen a lot of examples for setting it to 1 but I want to set it to 0.  
<br/>
<br/>
people do things like u16 col=RGB15(12,34,25)|BIT(15);
<br/>
<br/>
but you cannot OR a zero on there if there is a one.  Any idears??
<br/>
<br/>
I tried making a bit pointer to it, but could figure out how to do it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93386 - Mighty Max - Tue Jul 18, 2006 10:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>TheRain wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I have seen a lot of examples for setting it to 1 but I want to set it to 0.  
<br/>
<br/>
people do things like u16 col=RGB15(12,34,25)|BIT(15);
<br/>
<br/>
but you cannot OR a zero on there if there is a one.  Any idears??
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Just don't or and it won't be set:
<br/>
<br/>
u16 col = RGB15(31,31,31) ;
<br/>
=&gt; col = 0111 1111 1111 1111
<br/>
<br/>
u16 col = RGB15(31,31,31) | BIT(15) ;
<br/>
=&gt; col = 1111 1111 1111 1111
<br/>
<br/>
However, keep in mind that a pixel can only be transparent if there is something below this pixel to get drawn (another BG, sprites, whatever)<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93387 - TheRain - Tue Jul 18, 2006 10:33 pm</h4>
    <div class="postbody"><span class="postbody">Thanks,   but let's say the alpha bit is 1 and I want to set it to 0.       If you need to know why... I'm writting a subroutine that will read the RGB, match it up with an RGB that will represent alpha... then set alpha to zero if it matches that RGB... I want the function to accept 16 bit values and perform this function under the conditions that the alpha bit is set or not set both.    
<br/>
<br/>
I just tried to do this ~(~colorRGB15|1&lt;&lt;15)   and that didn't seem to work either... though I would think it would because this would invert the bits, then make bit 15 1 no matter what it is now, then invert it again which would make it the original number and 0 at bit 15??
<br/>
<br/>
<br/>
like  NOT 1111 1111 1111 1111 will equal 0000 0000 0000 0000  
<br/>
OR it with 1000 0000 0000 0000     will equal that 
<br/>
then NOT it again will equal 0111 1111 1111 1111</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93392 - Valmond - Tue Jul 18, 2006 10:41 pm</h4>
    <div class="postbody"><span class="postbody">If you know the bithddepth (8,16,32 etc) you can just
<br/>
do a 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">x&amp;=$FFFF-(1&lt;&lt;bit); //16bits value
<br/>
x&amp;=$FF-(1&lt;&lt;bit); //8bits value
<br/>
</td> </tr></table><span class="postbody">
<br/>
sort of thing, where 'bit' is the bitnumber to put out.
<br/>
<br/>
/Valmond</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93394 - Mighty Max - Tue Jul 18, 2006 10:58 pm</h4>
    <div class="postbody"><span class="postbody">correct. 
<br/>
<br/>
more easy readable:
<br/>
<br/>
u16 col=sourcecolor &amp; ~BIT(15); 
<br/>
<br/>
will create a copy of sourcecolor with the opacity bit cleared.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93398 - TheRain - Tue Jul 18, 2006 11:31 pm</h4>
    <div class="postbody"><span class="postbody">BHahaha! 
<br/>
<br/>
I can't believe that... that's the function I had to begin with then I got very confused because it wasn't working... when all I had to do was put it in parenthesis to make the order of operations right!   
<br/>
<br/>
Might Max... that's the right solution.   Or, the same thing as 
<br/>
<br/>
u16 col=(sourcecolor&amp;0x7FFF) ;
<br/>
<br/>
so here is my final, working routine:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
static inline u16 set_Alpha(u16 buffer, u16 alphaCol)
<br/>
{    
<br/>
   if(buffer==(alphaCol|1&lt;&lt;15)||buffer==(alphaCol&amp;0x7FFF))
<br/>
      {
<br/>
      return (alphaCol&amp;0x7FFF);
<br/>
      }
<br/>
      else
<br/>
      {
<br/>
       return (buffer|BIT(15));
<br/>
      }
<br/>
} 
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So with this function, you can draw up a 16 bit bitmap in like photoshop, make the background color a color you want to represent alpha.... say RGB(31,0,31) since that's an ugly ass color anyhow 
<br/>
<br/>
alphaCol=RGB(31,0,31);
<br/>
<br/>
for(int i=0;i&lt;32*32;i++)
<br/>
{
<br/>
SPRITE_GFX[i]=set_Alpha(((u16*)sprite1_bin)[i],alphaCol);
<br/>
}
<br/>
<br/>
<br/>
<br/>
But apparently that is not all that necessary to write it to set bit 15 to 0 since most of the converters will have already set it to 0... so it would be a matter of setting the non-alpha ones to 1.
<br/>
<br/>
But I wanted to figure it out both out of curiosity and to have a flexible function.
<br/>
<br/>
Thanks guys for working through this with me!!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
