<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Updated devkitARM (and libnds), and now objects are inverted - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Updated devkitARM (and libnds), and now objects are inverted</h2>
<div id="posts">
<div class="post">
    <h4>#130993 - DiscoStew - Sat Jun 09, 2007 11:12 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I recently updated to the newest version of DevKitARM (I can't remember which version I previously had, but I suppose a lot of changes took place in between), and now, all the models and manual drawing of faces look to be inverted vertically, as if the axis of positive Y got inverted, insomuch that instead of +Y going up, it is going down. Sorry if this is hard to explain.
<br/>
<br/>
Say I am looking straight down the Z axis, with -Z being forward of the camera, with +X going to the right, and +Y going up. When placing a vertex with a positive Y value, it would to be above the horizon, but after updating my stuff, the same code is now placing that vertex under the horizon. Was this an intentional change?
<br/>
<br/>
<br/>
Also something I assume is related, but in both the old version and new version, when I'd rotate an object on the Z axis positively, both would rotate in the same direction, clockwise.
<br/>
<br/>
EDIT:
<br/>
Changed title from ndslib to libnds).<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"><br/><br/>Last edited by DiscoStew on Sun Jun 10, 2007 12:30 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#130998 - tondopie - Sun Jun 10, 2007 12:13 am</h4>
    <div class="postbody"><span class="postbody">if you updated ndslib, then thats your problem! the newest DKA is for <span style="text-decoration: underline"><span style="font-weight: bold"><span style="font-style: italic">libnds</span></span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131002 - DiscoStew - Sun Jun 10, 2007 12:29 am</h4>
    <div class="postbody"><span class="postbody">Oops, my mistake. It is libnds.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131026 - DiscoStew - Sun Jun 10, 2007 8:26 am</h4>
    <div class="postbody"><span class="postbody">For another perspective of what I'm describing..
<br/>
<br/>
<a class="postlink" href="http://imageshack.us" target="_blank"></a><a href="http://img299.imageshack.us/img299/4315/neheeh5.jpg">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
The left image is the actual NeHe Lesson 4 in OpenGL.
<br/>
The right image is the DS equivalent of NeHe Lesson 4 running on No$GBA 2.3
<br/>
<br/>
Though I am using an emulator rather than hardware (hope to change that soon), I can tell you that it is not an emulator problem, as I have been using the same emulator before I updated my DevKitARM, and my compiled projects were not flipped vertically as shown on the right.
<br/>
<br/>
Has no one encountered this kind of problem, or was it meant to be this way? I just don't like the idea about having to alter all my stuff to accommodate this change, especially since it seemed ok before.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131063 - Sausage Boy - Sun Jun 10, 2007 7:56 pm</h4>
    <div class="postbody"><span class="postbody">Try playing with some minus signs in the initialization code. I think there is some way to change it in some function call there.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131072 - DiscoStew - Sun Jun 10, 2007 9:25 pm</h4>
    <div class="postbody"><span class="postbody">Sausage Boy,
<br/>
<br/>
Thanks for your suggestion. From what I can tell, the only part where I can change any initialization code that affect the matrix would be through gluPerspective, plus also glFrustumf32 (because gluPerspective uses it). Everything else seems to either not be affiliated with changing the current matrix, or I just cannot get to, as it is most likely compiled into the libnds library.
<br/>
<br/>
I've tinkered with those 2 functions, and have changed it to where I can get them to not be inverted anymore, but now I have the problem of rotation. I can get the pyramid to rotate correctly, as it rotating on only 1 axis, but the cube is on all 3, and I just can't seem to change the code to the point where I am mimicking what OpenGL does.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131087 - DiscoStew - Sun Jun 10, 2007 11:45 pm</h4>
    <div class="postbody"><span class="postbody">Well, I'd like to apologize, as I found the main problem of why everything was inverted.
<br/>
<br/>
It was the emulator. I updated that to the newest version, and now everything is as it should be, minus the rotation problem which I've had since I started. The only thing I can think of that would result in this odd behavior is that both the tool kit and the emulator were going off incorrect data, and when the toolkit got updated correctly, the emulator must have got updated shortly after so it would go with the correct changes, and I had only updated the toolkit, resulting in the problem until the emulator was updated.
<br/>
<br/>
I had even gone to the lengths to find out just how gluPerspective and glFrustum worked, and comparing to the current code, only the glFrustum had a single switch-a-roo of 2 lines, but after switching them, I got nothing on the screen. Looking at it, I could only conclude that the reason why the switch was made was because of where the Position elements were, and it made sense.
<br/>
<br/>
So now, everything works, except for the rotation problem I've had for a while. The pyramid still turns to the left, but now the cube is rotating down and to the right. After just examining how they are rotating, to me, it looks like a possible inverted axis problem, where instead of rotating in one direction, it is going into the opposite. So I went to the rotation functions being used, and negated the unit vector axis of all 3, and now, it is rotating just how it does with the NeHe OpenGL example. For fun, I instead negated the rotation value, and got the same result.
<br/>
<br/>
I'm glad that is the only change I would need to make. Thank for your help.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131109 - Dark Knight ez - Mon Jun 11, 2007 7:51 am</h4>
    <div class="postbody"><span class="postbody">Yeah, it's known that the rotation in libnds is exactly the opposite of the rotation on the PC.
<br/>
Good job on figuring that out yourself. :)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
