<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>[Fixored] GBFS -> Works in Dualis, but not on Hardware... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > [Fixored] GBFS -> Works in Dualis, but not on Hardware...</h2>
<div id="posts">
<div class="post">
    <h4>#76944 - JessTicular - Sun Mar 26, 2006 5:46 pm</h4>
    <div class="postbody"><span class="postbody">Hey guy's and gals,
<br/>
<br/>
I've spent the better part of a day trying to get the GBFS to work, but finally got it running nice and smooth on the latest version of Dualis.
<br/>
<br/>
After a small dance and clap, I figured I'd give it a shot on hardware.
<br/>
Unfortunatly... It doesn't work! :(
<br/>
<br/>
<br/>
All I'm trying to do is print out how many files are stored in the system, which is pretty straight forward in the code as:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  GBFS_FILE const* gbfs_file = find_first_gbfs_file((void*)0x08000000);
<br/>
  iprintf("\x1b[1;1HTotal GBFS Files: %i\n", (*gbfs_file).dir_nmemb);</td> </tr></table><span class="postbody">
<br/>
<br/>
Dualis reports the correct number (1), but the hardware reports a silly number of 58771.
<br/>
<br/>
<br/>
The basic run down of what I'm doing is:
<br/>
<br/>
Create normal .ds.gba &amp; .nds files,
<br/>
create a gbfs file system,
<br/>
pad out to 256,
<br/>
append system to .ds.gba &amp; .nds files
<br/>
<br/>
<br/>
( I figured out what to do from Chris's tutorials ( double.co.nz/nintendo_ds ), the example with DevKit, and various Forum Posts + Readme files )
<br/>
<br/>
<br/>
Here's my workspace for everyone to gawk at and possibly laugh at me (hey, I'm new to the DS, cut me a break :P);
<br/>
<a class="postlink" href="http://jt0.org/dl/ds/gbfs.rar" target="_blank">http://jt0.org/dl/ds/gbfs.rar</a>
<br/>
<br/>
To get it going, simply run the makeall.bat file ( Does a clean, builds the app, then appends the gbfs ).
<br/>
<br/>
<br/>
Thanks for any and all help as to why it's being silly!
<br/>
<br/>
<br/>
Cheers,
<br/>
Jess.</span><span class="gensmall"><br/><br/>Last edited by JessTicular on Mon Mar 27, 2006 5:45 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#76945 - tepples - Sun Mar 26, 2006 6:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JessTicular wrote:</b></span></td> </tr> <tr> <td class="quote">I've spent the better part of a day trying to get the GBFS to work, but finally got it running nice and smooth on the latest version of Dualis.
<br/>
<br/>
After a small dance and clap, I figured I'd give it a shot on hardware.
<br/>
Unfortunatly... It doesn't work! :(</td> </tr></table><span class="postbody">
<br/>
What kind of hardware? The find_first_gbfs_file() function does not work with FlashMe+WMB or with GBAMP. In those environments, you'll have to create the GBFS file, bin2s it, add it to your project, and then use that instead of find_first_gbfs_file().<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76962 - genfish - Sun Mar 26, 2006 11:06 pm</h4>
    <div class="postbody"><span class="postbody">Check out this thread of mine, i had the same issue. LAst post is of me solving it :)
<br/>
<br/>
Im using a neoflash magickey 3, so ya know :)
<br/>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=8610&amp;highlight=" target="_blank">Linky</a><br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76969 - JessTicular - Mon Mar 27, 2006 12:50 am</h4>
    <div class="postbody"><span class="postbody">genfish,
<br/>
Yeah, already checked that out during my countless forum searches; It helped, but since I'm running a normal makefile, THEN appending the data to both the .nds and .ds.gba files, it doesn't apply.
<br/>
Thanks anyway, mate.
<br/>
<br/>
Tepples,
<br/>
An EFAII (1Gb) - I have used FlashMe, so would reverting to the old firmware fix it?
<br/>
At any rate, I assume bin2s makes a header file, giving me the pointer to the appended data, and from there, I can still use the functions for getting file objects? or is there another way to determine where files begin and end?
<br/>
<br/>
Cheers for the help guys,
<br/>
Jess.
<br/>
<br/>
[EDIT]
<br/>
As an aditional: Wouldn't using the bin2s mean that it is compiled as part of the source, and thus I cannot exceed the 4MB memory limit of the DS?
<br/>
That could be a real bummer in time to come when I add sound + 3D models and textures.
<br/>
Is there any other File System alternative ( or a personal implimentation of find_first_gbfs_file() ) That could be used?
<br/>
[/EDIT]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76983 - tepples - Mon Mar 27, 2006 3:57 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JessTicular wrote:</b></span></td> </tr> <tr> <td class="quote">An EFAII (1Gb) - I have used FlashMe, so would reverting to the old firmware fix it?</td> </tr></table><span class="postbody">
<br/>
FlashMe has nothing to do with it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">At any rate, I assume bin2s makes a header file, giving me the pointer to the appended data, and from there, I can still use the functions for getting file objects? or is there another way to determine where files begin and end?</td> </tr></table><span class="postbody">
<br/>
bin2s makes an assembly language file to be added to your project. A file named "data.gbfs" becomes an object called data_gbfs.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">As an aditional: Wouldn't using the bin2s mean that it is compiled as part of the source, and thus I cannot exceed the 4MB memory limit of the DS?</td> </tr></table><span class="postbody">
<br/>
Correct. If your storage device cannot use ds.gba files, then it is limited to 4 MB unless file I/O is possible.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">That could be a real bummer in time to come when I add sound + 3D models and textures.</td> </tr></table><span class="postbody">
<br/>
The Windows game ".kkrieger" is 96 KB.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Is there any other File System alternative ( or a personal implimentation of find_first_gbfs_file() ) That could be used?</td> </tr></table><span class="postbody">
<br/>
There may be a library that you can use to read and write files on the MK2, MK3, NinjaDS, or similar SLOT-1 SD adapters. These libraries generally implement an interface similar to that of the standard C library's fopen() and friends.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76991 - JessTicular - Mon Mar 27, 2006 5:35 am</h4>
    <div class="postbody"><span class="postbody">Alrighty, sweet.
<br/>
<br/>
Thanks for the helpful info!
<br/>
<br/>
My cart runs .ds.gba fine, so I should be right with the size limit :)
<br/>
<br/>
And, .kkreiger? Haha, I wish I was good a procedural generation! Those guy's are working on Spore now - Talent that has anything but gone to waste :)
<br/>
<br/>
At any rate, thanks for the help, mate.
<br/>
<br/>
Jess.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
