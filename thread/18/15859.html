<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Can't get tiled backgrounds working right.  Please Help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Can't get tiled backgrounds working right.  Please Help</h2>
<div id="posts">
<div class="post">
    <h4>#160820 - BigKevSexyMan - Wed Jul 23, 2008 1:06 am</h4>
    <div class="postbody"><span class="postbody">First off, I'll start with what I currently have.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">    
<br/>
    powerON(POWER_ALL_2D);
<br/>
<br/>
    irqInit();
<br/>
    irqEnable(IRQ_VBLANK);
<br/>
<br/>
    lcdMainOnBottom();
<br/>
<br/>
    vramSetMainBanks(VRAM_A_MAIN_BG_0x06000000,
<br/>
                     VRAM_B_MAIN_BG_0x06020000,
<br/>
                     VRAM_C_MAIN_BG_0x06040000,
<br/>
                     VRAM_D_LCD);
<br/>
<br/>
    vramSetBankE(VRAM_E_MAIN_SPRITE);
<br/>
<br/>
    videoSetMode(MODE_5_2D | 
<br/>
                 DISPLAY_BG3_ACTIVE |
<br/>
                 DISPLAY_SPR_ACTIVE | 
<br/>
                 DISPLAY_SPR_1D 
<br/>
                 );
<br/>
<br/>
    videoSetModeSub(MODE_4_2D |
<br/>
                    DISPLAY_BG3_ACTIVE);
<br/>
<br/>
<br/>
    BG3_CR = BG_BMP8_512x256;
<br/>
    BG3_XDX = 1 &lt;&lt; 8;
<br/>
    BG3_XDY = 0;
<br/>
    BG3_YDX = 0;
<br/>
    BG3_YDY = 1 &lt;&lt; 8;
<br/>
    BG3_CX = 0;
<br/>
    BG3_CY = 0;
<br/>
    BG3_X0 = 0;
<br/>
    BG3_Y0 = 0;
<br/>
<br/>
    dmaCopyHalfWords(DMA_CHANNEL,
<br/>
         scrollingbackgroundTiles,
<br/>
         &amp;BG_GFX[0],
<br/>
         128000);
<br/>
<br/>
    dmaCopyHalfWords(DMA_CHANNEL,
<br/>
         scrollingbackgroundPal,
<br/>
         &amp;BG_PALETTE[0],
<br/>
         256*2);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Now, I'm using a file that I converted using grit and I'm not using any form of compression.  I converted using 256 color tiled 8bpp, and I'm not using any metamap features or tile reduction.
<br/>
<br/>
Now, after I load all that and run the program I get a semi-jumbled mess on my screen.  What am I doing wrong?  Any help would be appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160821 - eKid - Wed Jul 23, 2008 1:16 am</h4>
    <div class="postbody"><span class="postbody">You're setting up a bitmap-mode BG instead of a tile-display [text] BG.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160827 - BigKevSexyMan - Wed Jul 23, 2008 2:50 am</h4>
    <div class="postbody"><span class="postbody">Are you refering to me doing something like this?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    BG3_CR = BG_BMP8_512x256 | BG_TILE_BASE(0);
<br/>
<br/>
    dmaCopyHalfWords(DMA_CHANNEL,
<br/>
         scrollingbackgroundTiles,
<br/>
         BG_TILE_RAM(0),
<br/>
         128000);
<br/>
<br/>
    dmaCopyHalfWords(DMA_CHANNEL,
<br/>
         scrollingbackgroundPal,
<br/>
         &amp;BG_PALETTE[0],
<br/>
         256*2); 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Because I get the same result.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160833 - DensitY - Wed Jul 23, 2008 5:51 am</h4>
    <div class="postbody"><span class="postbody">no he means the BG_BMP8_512x256
<br/>
<br/>
you use that if you are doing a 8bit Linear bitmap back ground
<br/>
<br/>
for tiled backgrounds you use one of the following
<br/>
<br/>
BG_32x32
<br/>
BG_64x32
<br/>
BG_32x64
<br/>
BG_64x64
<br/>
<br/>
thats 64x64 tiles or 512x512 pixels.
<br/>
<br/>
in yoru case you'd want
<br/>
<br/>
BG_64x32, if you want 512x256 pixel resolution for the background.
<br/>
<br/>
From there you'll need to populate both Tile ram and Map ram (tile being the tile map, and Map ram being where the tile graphical data is stored).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160895 - BigKevSexyMan - Thu Jul 24, 2008 4:14 am</h4>
    <div class="postbody"><span class="postbody">That worked.  Thanks.  Now it's on to my next problem. :D</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
