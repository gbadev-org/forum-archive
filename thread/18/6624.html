<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Drawing a line - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Drawing a line</h2>
<div id="posts">
<div class="post">
    <h4>#51438 - iainprice - Fri Aug 19, 2005 4:14 pm</h4>
    <div class="postbody"><span class="postbody">Yes I know this sounds like a silly question... but is there a nice simple way to draw a line when using Mode5? Or do I have to make a long thin sprite?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51441 - natrium42 - Fri Aug 19, 2005 4:51 pm</h4>
    <div class="postbody"><span class="postbody">You could plot pixels to the background using some line drawing algorithm like the ones given here: <a href="http://www.cs.unc.edu/~mcmillan/comp136/Lecture6/Lines.html" target="_blank">http://www.cs.unc.edu/~mcmillan/comp136/Lecture6/Lines.html</a>
<br/>
<br/>
Darkain's Painter from DarkStar should have some line algorithm implemented for Mode5. Check his source code.<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51459 - iainprice - Fri Aug 19, 2005 9:32 pm</h4>
    <div class="postbody"><span class="postbody">I'm having some problems putting a pixel on the bottom screen. I am doing the following:
<br/>
<br/>
videoSetMode(MODE_0_3D);
<br/>
videoSetModeSub(MODE_5_2D | DISPLAY_BG3_ACTIVE | DISPLAY_SPR_ACTIVE);
<br/>
vramSetMainBanks(VRAM_A_TEXTURE, VRAM_B_LCD, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE); 
<br/>
<br/>
and then:
<br/>
VRAM_B[(10*SCREEN_WIDTH)+21] = 0x7FFF;
<br/>
<br/>
or:
<br/>
VRAM_C[(10*SCREEN_WIDTH)+21] = 0x7FFF;
<br/>
<br/>
but neither work... am I missing something somewhere?
<br/>
<br/>
any ideas?
<br/>
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51465 - natrium42 - Sat Aug 20, 2005 12:22 am</h4>
    <div class="postbody"><span class="postbody">This looks wrong. Check the Mode5 example in ndslib.
<br/>
You need to write pixels to BG_GFX and not directly to the banks, for one thing.<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51468 - iainprice - Sat Aug 20, 2005 12:47 am</h4>
    <div class="postbody"><span class="postbody">even if I try setting BG3 for BMP image:
<br/>
<br/>
BG3_CR = BG_BMP8_256x256;
<br/>
<br/>
and then address the BG_GFX:
<br/>
<br/>
BG_GFX[(10*SCREEN_WIDTH)+20] = 0x7FFF;
<br/>
<br/>
still nothing...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51477 - natrium42 - Sat Aug 20, 2005 3:36 am</h4>
    <div class="postbody"><span class="postbody">Yes, you are using a paletted BG mode without setting the palette colors.
<br/>
<br/>
If you want 16-bit colors as you imply by "0x7FFF;" do the following:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
powerON(POWER_ALL_2D);
<br/>
<br/>
videoSetMode(MODE_5_2D | DISPLAY_BG3_ACTIVE); 
<br/>
vramSetMainBanks(VRAM_A_MAIN_BG_0x6000000, VRAM_B_LCD, VRAM_C_SUB_BG , VRAM_D_LCD); 
<br/>
<br/>
BG3_CR = BG_BMP16_256x256;
<br/>
<br/>
BG3_XDX = 1 &lt;&lt; 8;
<br/>
BG3_XDY = 0;
<br/>
BG3_YDX = 0;
<br/>
BG3_YDY = 1 &lt;&lt; 8;
<br/>
<br/>
BG3_CX = 0;
<br/>
BG3_CY = 0;
<br/>
<br/>
// to plot a pixel to position (x,y) with color values (R,G,B) do this:
<br/>
BG_GFX[256*y + x] = RGB15(R, G, B) | (1 &lt;&lt; 15);
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51662 - iainprice - Mon Aug 22, 2005 8:30 pm</h4>
    <div class="postbody"><span class="postbody">I am now trying:
<br/>
<br/>
[/code]
<br/>
	powerON(POWER_3D_CORE|POWER_2D_SUB); 
<br/>
	videoSetMode(MODE_5_3D);
<br/>
	videoSetModeSub(MODE_5_2D | DISPLAY_BG3_ACTIVE | DISPLAY_SPR_ACTIVE);
<br/>
	vramSetMainBanks(VRAM_A_TEXTURE, VRAM_B_LCD, VRAM_C_SUB_BG, VRAM_D_SUB_SPRITE); 
<br/>
	BG_PALETTE_SUB[255] = RGB15(31,31,31);
<br/>
<br/>
	irqInitHandler(irqDefaultHandler);
<br/>
	irqSet(IRQ_VBLANK, 0);
<br/>
<br/>
	glViewPort(0,0,255,191);
<br/>
	glClearColor(0,0,0);
<br/>
	glClearDepth(0x7FFF);
<br/>
<br/>
	SUB_BG3_CR = BG_BMP8_256x256;
<br/>
 	SUB_BG3_XDX = 1&lt;&lt;8;
<br/>
	SUB_BG3_XDY = 0;
<br/>
	SUB_BG3_YDX = 0;
<br/>
	SUB_BG3_YDY = 1&lt;&lt;8;
<br/>
	SUB_BG3_CX = 0; 
<br/>
	SUB_BG3_CY = 0; 
<br/>
<br/>
<br/>
BG_GFX[256*50 + 50] = 100; 
<br/>
<br/>
<br/>
[/code]
<br/>
<br/>
but still no pixels... where am I going wrong????</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51666 - dovoto - Mon Aug 22, 2005 8:56 pm</h4>
    <div class="postbody"><span class="postbody">If you want a pixel on the sub screen it is recomended that you address sub screen graphics memory via BG_GFX_SUB[] as apposed to BG_GFX<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51667 - natrium42 - Mon Aug 22, 2005 9:01 pm</h4>
    <div class="postbody"><span class="postbody">Again, you are using a paletted mode without setting palette colors.
<br/>
<br/>
BG_GFX_SUB[256*50 + 50] is actually 2 color indexes for two pixels in the mode you are using. Since 100 = 0x0064, one index is 0x00 and the second is 0x64. So if you set  BG_PALETTE_SUB[0x64] = RGB15(31,0,0); you should see a red pixel. Index 0x00 is transparency.
<br/>
<br/>
If you don't want to use a palette and use 15-bit color instead, use code similar to the one I posted and/or follow the tutorial here: <a href="http://www.double.co.nz/nintendo_ds/nds_develop10.html" target="_blank">http://www.double.co.nz/nintendo_ds/nds_develop10.html</a>
<br/>
<br/>
Also, BG_GFX should be BG_GFX_SUB or whatever the name is :)<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#51669 - iainprice - Mon Aug 22, 2005 9:04 pm</h4>
    <div class="postbody"><span class="postbody">Doh!
<br/>
<br/>
Cheers.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
