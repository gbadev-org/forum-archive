<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Including data into projects - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Including data into projects</h2>
<div id="posts">
<div class="post">
    <h4>#89485 - spencer723 - Sun Jun 25, 2006 3:08 am</h4>
    <div class="postbody"><span class="postbody">Hi, I'm sort of new to using tile maps and I was trying to compile and got errors saying the #includes didn't exist. I haven't exactly figured out how to include my .bin files into my project. I have myBG.bin, myBGpal.bin and myBGmap.bin and I was wondering how to include these into my project...does it have to do with the Makefile? This is my Makefile as of now:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
# Makefile for framebuffer_demo1.nds
<br/>
# <a href="mailto:chris.double@double.co.nz">chris.double@double.co.nz</a>
<br/>
NDSLIB_INCLUDE=$(DEVKITPRO)/libnds/include
<br/>
NDSLIB_LIB=$(DEVKITPRO)/libnds/lib
<br/>
<br/>
all: drds_BETA.nds.gba
<br/>
<br/>
arm7_main.o: arm7_main.cpp
<br/>
   arm-elf-g++ -g -Wall -O2 -mcpu=arm7tdmi -mtune=arm7tdmi -fomit-frame-pointer -ffast-math -mthumb-interwork -I$(NDSLIB_INCLUDE) -DARM7 -c arm7_main.cpp -oarm7_main.o
<br/>
<br/>
arm7.elf: arm7_main.o
<br/>
   arm-elf-g++ -g -mthumb-interwork -mno-fpu -specs=ds_arm7.specs arm7_main.o -L$(NDSLIB_LIB) -lnds7 -oarm7.elf
<br/>
<br/>
arm7.bin: arm7.elf
<br/>
   arm-elf-objcopy -O binary arm7.elf arm7.bin
<br/>
<br/>
arm9_main.o: arm9_main.cpp
<br/>
   arm-elf-g++ -g -Wall -O2 -mcpu=arm9tdmi -mtune=arm9tdmi -fomit-frame-pointer -ffast-math -mthumb-interwork -I$(NDSLIB_INCLUDE) -DARM9 -c arm9_main.cpp -oarm9_main.o
<br/>
<br/>
arm9.elf: arm9_main.o
<br/>
   arm-elf-g++ -g -mthumb-interwork -mno-fpu -specs=ds_arm9.specs arm9_main.o -L$(NDSLIB_LIB) -lnds9 -o arm9.elf
<br/>
<br/>
arm9.bin: arm9.elf
<br/>
   arm-elf-objcopy -O binary arm9.elf arm9.bin
<br/>
<br/>
drds_BETA.nds: arm7.bin arm9.bin 
<br/>
   ndstool -c drds_BETA.nds -9 arm9.bin -7 arm7.bin
<br/>
<br/>
drds_BETA.nds.gba: drds_BETA.nds
<br/>
   dsbuild drds_BETA.nds -o drds_BETA.nds.gba
<br/>
<br/>
clean:
<br/>
   rm -f *.bin
<br/>
   rm -f *.elf
<br/>
   rm -f *.o
<br/>
   rm -f *~
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'll appreciate any help :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89514 - parrot_ - Sun Jun 25, 2006 9:08 am</h4>
    <div class="postbody"><span class="postbody">If your includes are in a directory you have to add an -I[PATHTOINCLUDES], also if you are using r19a, change arm-elf-g++ to arm-eabi-g++ (only do that if you are using r19a)<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89556 - spencer723 - Sun Jun 25, 2006 1:54 pm</h4>
    <div class="postbody"><span class="postbody">Right now my 3 files are still .bin's. Should they be .h files? Also, what line would I add the '-I' to in the Makefile?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89561 - psycorpse - Sun Jun 25, 2006 3:14 pm</h4>
    <div class="postbody"><span class="postbody">You should have your .bin files in a folder called data. In your makefile you should add something like the following: 
<br/>
<br/>
DATA		:=	data
<br/>
<br/>
BINFILES	:=	$(foreach dir,$(DATA),$(notdir $(wildcard $(dir)/*.*)))
<br/>
<br/>
export OFILES	:=	$(addsuffix .o,$(BINFILES)) \
<br/>
					$(CPPFILES:.cpp=.o) $(CFILES:.c=.o) $(SFILES:.s=.o)
<br/>
<br/>
#---------------------------------------------------------------------------------
<br/>
# you need a rule like this for each extension you use as binary data 
<br/>
#---------------------------------------------------------------------------------
<br/>
%.bin.o	:	%.bin
<br/>
#---------------------------------------------------------------------------------
<br/>
	@echo $(notdir $&lt;)
<br/>
	@$(bin2o)
<br/>
<br/>
<br/>
<br/>
I am not 100% sure this will work as you are using chris's makefile. You could move to using the makefile in the libnds examples. Anyways you will also need to a #include "filename_bin.h" (myBGmap_bin.h)
<br/>
<br/>
hope this helps.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89570 - spencer723 - Sun Jun 25, 2006 4:05 pm</h4>
    <div class="postbody"><span class="postbody">I tried using the libnds example and the compiler gave me an error about a CIDLoop.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89707 - spencer723 - Mon Jun 26, 2006 1:03 pm</h4>
    <div class="postbody"><span class="postbody">I got it to work, but instead of using the Makfile I made a batch file that will convert it with gfx2gba then it runs bin2h. The only problem there is I actually have to go into the .h files and change everything myself and add how long each one is.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89740 - wintermute - Mon Jun 26, 2006 3:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>spencer723 wrote:</b></span></td> </tr> <tr> <td class="quote">I tried using the libnds example and the compiler gave me an error about a CIDLoop.</td> </tr></table><span class="postbody">
<br/>
<br/>
The precise error message would help in diagnosing your problem.
<br/>
<br/>
You should also update to r19a and stop using examples which don't use a variant of the standard devkitPro makefiles.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#89834 - spencer723 - Mon Jun 26, 2006 9:28 pm</h4>
    <div class="postbody"><span class="postbody">I've already updated to r19a. The specific error I'm getting is below:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
ds_arm9_crt0.o: In function 'CIDLoop':
<br/>
ds_arm9_crt0.s:(.init+0x218): undefined reference to 'main'
<br/>
collect2: ld returned 1 exit status
<br/>
make[1]: *** [/c/DSDev/Examples/Examples.elf] Error 1
<br/>
make: *** [build] Error 2
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This is coming from the Makfile that comes with the examples in devkitARM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93217 - spencer723 - Mon Jul 17, 2006 9:14 pm</h4>
    <div class="postbody"><span class="postbody">bump</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93252 - josath - Tue Jul 18, 2006 2:15 am</h4>
    <div class="postbody"><span class="postbody">dumb question: Do you have main defined in one of the .c or .cpp files in your source directory?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93265 - wintermute - Tue Jul 18, 2006 3:28 am</h4>
    <div class="postbody"><span class="postbody">oops, totally forgot about this.
<br/>
<br/>
The template makefiles expect to find the source code in a directory called 'source'. The error you get is usually due to the makefile being unable to find any source files at all.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93271 - tepples - Tue Jul 18, 2006 5:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>psycorpse wrote:</b></span></td> </tr> <tr> <td class="quote">You should have your .bin files in a folder called data. In your makefile you should add something like the following:</td> </tr></table><span class="postbody">
<br/>
Does this work if my binary files are generated from other binary files, which in turn are generated from still other binary files? Test case: a .gbfs made of multiple .todbg files, each converted from one .bmp file. Test case 2: a .gbfs made of multiple .gsm files, each converted from one .wav file.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93477 - spencer723 - Wed Jul 19, 2006 12:54 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the help wintermute</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
