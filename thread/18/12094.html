<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>nesDS source - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > nesDS source</h2>
<div id="posts">
<div class="post">
    <h4>#114336 - chuckstudios - Sat Jan 06, 2007 8:21 pm</h4>
    <div class="postbody"><span class="postbody">If anybody has this, try and get it to Moonlight (Infantile Paralysiser) His blog says that he was trying to make a MSE (MoonShell Executable) to launch .nes files! But he couldn't find the nesDS source...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114379 - Dwedit - Sun Jan 07, 2007 10:55 am</h4>
    <div class="postbody"><span class="postbody">NesDS is based on pocketnes, and shares a lot of code.  PocketNES doesn't compile on a GCC toolchain because the GNU assembler doesn't support register-relative equates, or the associated MAP directive.  The MAP directive allows a bunch of equates to be defined relative to a base address, or relative to a register.  When the equates are relative to a register, you can do LDR, STR, LDRB, STRB, ADR, or ADRL instructions on them.
<br/>
From what I've seen, GCC's arm assembler only supports ADR when used with pc-relative equates.
<br/>
<br/>
Here's a snippet of code from nesds which makes use of the map directive to define a bunch of symbols ("globalptr" was defined as register r10 using the RN directive)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
 MAP 0,globalptr   ;6502.s
<br/>
opz # 256*4
<br/>
readmem_tbl # 8*4
<br/>
writemem_tbl # 8*4
<br/>
memmap_tbl # 8*4
<br/>
cpuregs # 7*4
<br/>
m6502_s # 4
<br/>
lastbank # 4
<br/>
...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So either someone needs to make a code preprocessor to turn ARM SDT asm code into GNU Assembler compatible code, or the gnu assembler needs to add support for register-reletive equates.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114398 - Dark Knight ez - Sun Jan 07, 2007 1:59 pm</h4>
    <div class="postbody"><span class="postbody">Besides of course loopy, also someone named emu_kidid (who hangs around on Maxconsole forums apparently) has the source to NesDS. Hope that helps.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114402 - Dwedit - Sun Jan 07, 2007 3:59 pm</h4>
    <div class="postbody"><span class="postbody">Actually I also have it.  Still haven't tried to compile it though, since it needs codewarrior and arm sdt.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
