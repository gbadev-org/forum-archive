<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Anyone want to share their MD2 loader? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Anyone want to share their MD2 loader?</h2>
<div id="posts">
<div class="post">
    <h4>#127299 - FireSlash - Tue May 01, 2007 1:56 pm</h4>
    <div class="postbody"><span class="postbody">I spent the better part of last night hacking away into code that, at no turn, has worked.
<br/>
<br/>
I've written loaders before, but I'm having trouble grasping a <span style="font-weight: bold">fast</span> way to do it with the limited subset of commands libnds provides.
<br/>
<br/>
If anyone would like to float me a copy of a working one for the DS, It'd really speed things up on this project.<br/>_________________<br/><a class="postlink" href="http://www.fireslash.net" target="_blank">FireSlash.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127309 - Lord Graga - Tue May 01, 2007 4:37 pm</h4>
    <div class="postbody"><span class="postbody">If you want single-frame stuff I can upload you a MD2-&gt;DisplayList converter.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127345 - FireSlash - Tue May 01, 2007 8:41 pm</h4>
    <div class="postbody"><span class="postbody">That'd be perfect. I can handle the animation, I just can't seem to get the data into an easily called structure. :)<br/>_________________<br/><a class="postlink" href="http://www.fireslash.net" target="_blank">FireSlash.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127349 - kusma - Tue May 01, 2007 9:59 pm</h4>
    <div class="postbody"><span class="postbody">if you control your dataset, there's no big point in actually loading md2 on the ds. a pc-side converter would be my preferred choice.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127362 - FireSlash - Tue May 01, 2007 11:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">if you control your dataset, there's no big point in actually loading md2 on the ds. a pc-side converter would be my preferred choice.</td> </tr></table><span class="postbody">
<br/>
Control?
<br/>
<br/>
Who said ANYTHING about control?<br/>_________________<br/><a class="postlink" href="http://www.fireslash.net" target="_blank">FireSlash.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127369 - Lick - Tue May 01, 2007 11:27 pm</h4>
    <div class="postbody"><span class="postbody">I think he means,  "Avoid loading MD2s on the DS if possible, but pre-convert them to something else."
<br/>
<br/>
FireSlash probably meant something like, "Hmm, I'm not sure what you mean by 'control', could you please repeat and rephrase?"<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127372 - FireSlash - Tue May 01, 2007 11:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">I think he means,  "Avoid loading MD2s on the DS if possible, but pre-convert them to something else."
<br/>
<br/>
FireSlash probably meant something like, "Hmm, I'm not sure what you mean by 'control', could you please repeat and rephrase?"</td> </tr></table><span class="postbody">
<br/>
<br/>
No, I meant "Why convert to something else when a cheap, easy to decode and well supported format already exists with everything I need?" if that's what he meant.<br/>_________________<br/><a class="postlink" href="http://www.fireslash.net" target="_blank">FireSlash.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127375 - tepples - Wed May 02, 2007 12:46 am</h4>
    <div class="postbody"><span class="postbody">If you are making all your work's models, then you control your dataset. If you allow users to import models, then others control your dataset.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127377 - HyperHacker - Wed May 02, 2007 12:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FireSlash wrote:</b></span></td> </tr> <tr> <td class="quote">Why convert to something else when a cheap, easy to decode and well supported format already exists with everything I need?</td> </tr></table><span class="postbody">Because you can convert to a cheaper, easier to decode format, and your converter would still provide support for those well-supported formats. (Assuming the user runs a compatible OS...)<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127393 - FireSlash - Wed May 02, 2007 5:06 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">If you are making all your work's models, then you control your dataset. If you allow users to import models, then others control your dataset.</td> </tr></table><span class="postbody">
<br/>
Idea is for others to control it.
<br/>
<br/>
Yes, other formats might be cheaper, but MD2 is a very easy format to deal with. Since the loader is only used during the loading phase, it doesn't matter if MD2 might take a bit longer to load, but the cost is worth it for using a format that most mainstream modelers can directly export to.
<br/>
<br/>
Plus, a lot of my assets are currently in md2 :)
<br/>
<br/>
I love the input, but I'd just like someone's MD2 loader. if that's a problem, I'll write my own; I just didn't want to waste time trying to figure out a new way to do it when someone else had probably already done it.<br/>_________________<br/><a class="postlink" href="http://www.fireslash.net" target="_blank">FireSlash.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127409 - simonjhall - Wed May 02, 2007 8:04 am</h4>
    <div class="postbody"><span class="postbody">Hang on, I just thought - Quake's models are in md2, right? Or is that a different md2?
<br/>
If so, check out WinQuake/model.c in <a href="http://quake.drunkencoders.com/downloads/quakeds_source_290407_pre2.zip" target="_blank">http://quake.drunkencoders.com/downloads/quakeds_source_290407_pre2.zip</a>
<br/>
<br/>
The function you'll want is called Mod_AliasLoadModel. There's two versions of it in the file, the one I did (by tearing apart the existing code) which uses the bare minimum of memory (#ifdef LOWMEM_LOADER) and the one that Krazy Carmack wrote (that uses loads of memory). His is much easier to follow, but it's still a pretty tricky piece of code.
<br/>
You ought to be able to just rip either one out and replace all the wrapped file calls with stdio...
<br/>
<br/>
Or is Q2 in md2...?<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127412 - kusma - Wed May 02, 2007 8:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Or is Q2 in md2...?</td> </tr></table><span class="postbody">
<br/>
Yup. Quake 1 is mdl iirc. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Idea is for others to control it.</td> </tr></table><span class="postbody">
<br/>
That doesn't necessarily matter. Just supply them with your converter ;). I was more thinking if you had a strict spec saying "this dataset should be in format XXX" you had to conform to.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Plus, a lot of my assets are currently in md2 :)</td> </tr></table><span class="postbody">
<br/>
Again, this shouldn't matter much. Make a loader, but don't put it on the DS. Less file-format parsing code on the target platform means less memory required.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127416 - simonjhall - Wed May 02, 2007 9:11 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">Again, this shouldn't matter much. Make a loader, but don't put it on the DS. Less file-format parsing code on the target platform means less memory required.</td> </tr></table><span class="postbody">And it makes it much easier to debug!<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127458 - FireSlash - Wed May 02, 2007 5:57 pm</h4>
    <div class="postbody"><span class="postbody">The thing is, I don't want to have to supply a converter.
<br/>
<br/>
1) I use three different OSs, windows OSX and Linux. I don't feel like writing three converters or porting one to all three systems.
<br/>
2) I don't feel the need to re-invent the wheel. MD2 does EXACTLY what I need it to. Sure, a loader requires more code (hence more memory) but my own loader will require code as well. Since I'm confident that I can't write a format and loader that would, in the end, achieve the same goal without either bloating the model files or bloating the loader, I don't see why spending the time to write an entirely new system is such a great idea.
<br/>
<br/>
Yes, It does open the chance for a more efficient method, but this game isn't going to be pushing the limits of the DS in any respect. I could probably write the same thing under the GBA's specs, so I don't feel guilty wasting a bit of ram and CPU here and there to get a result that can be developed in less time and is a bit easier to deal with.<br/>_________________<br/><a class="postlink" href="http://www.fireslash.net" target="_blank">FireSlash.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127461 - tepples - Wed May 02, 2007 6:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FireSlash wrote:</b></span></td> </tr> <tr> <td class="quote">1) I use three different OSs, windows OSX and Linux. I don't feel like writing three converters or porting one to all three systems.</td> </tr></table><span class="postbody">
<br/>
Java: Write once, run anywhere, in theory.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127466 - Dark Knight ez - Wed May 02, 2007 6:58 pm</h4>
    <div class="postbody"><span class="postbody">Or you can let the converter run on your DS as seperate program. How's that for portability?<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127651 - Sausage Boy - Thu May 03, 2007 8:31 pm</h4>
    <div class="postbody"><span class="postbody">Making a portable command line program is simple as pie. Just avoid compiler or OS specific commands. When GUI's are involved, things get more interesting :D.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127656 - M3d10n - Thu May 03, 2007 9:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FireSlash wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
2) I don't feel the need to re-invent the wheel. MD2 does EXACTLY what I need it to. Sure, a loader requires more code (hence more memory) but my own loader will require code as well. Since I'm confident that I can't write a format and loader that would, in the end, achieve the same goal without either bloating the model files or bloating the loader, I don't see why spending the time to write an entirely new system is such a great idea.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Oh, but you <span style="font-weight: bold">will</span> have to re-invent the wheel regardless. You'll <span style="font-weight: bold">need</span> to load the MD2 into a more DS-friendly structure even when loading directly on the DS, since you'll not be able to render the MD2 structure directly to the screen.
<br/>
<br/>
What everyone is suggesting, is that you perform that conversion <span style="font-weight: bold">offline</span> (aka: using a tool outside the DS) and dump the output on a binary file. Then all you need is to directly load that output into the DS RAM and render it right away.
<br/>
<br/>
This will make your life much, much easier, even if you need to port the tool for different OS'es, since debugging a PC program is much easier than debugging DS ones. You also can be very lazy on your conversion code, since it won't be done in real-time anyway, and you may even write it in a different language other than C/C++. As example, you could code your converter in Python and it would become cross platform from the get go.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127659 - simonjhall - Thu May 03, 2007 10:48 pm</h4>
    <div class="postbody"><span class="postbody">I say roll with loading the md2 directly on the DS. The file format isn't too hard to load - it's easy code, and there aren't too many sections in the file which need loading. It's not slow to load either.
<br/>
<br/>
Just make sure that you have a PC version first which just dumps all the vertex positions and face ids to stdout (to ensure you've got it working). Then rebuild for the DS, and render.
<br/>
<br/>
It's not like he's trying to parse a model in XML! Now that I wouldn't risk doing on a DS ;-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127661 - Lick - Thu May 03, 2007 11:00 pm</h4>
    <div class="postbody"><span class="postbody">XML for 3D data? COLLADA! Seriously, I'd not even use XML on the PC, ever. Piece of rubbish.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127676 - Dood77 - Fri May 04, 2007 12:43 am</h4>
    <div class="postbody"><span class="postbody">&lt;br /&gt;
<br/>
Oh GREAT! Now to please the W3C I gotta add two more keystrokes to like half of the html tags!<br/>_________________<br/>If I use a term wrong or something then feel free to correct, I?m not much of a programmer.
<br/>
<span style="font-size: 9px; line-height: normal">
<br/>
Original DS Phat obtained on day of release + flashme v7
<br/>
Supercard: miniSD, Kingston 1GB, Kingston 2GB
<br/>
Ralink chipset PCI NIC
<br/>
</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127701 - HyperHacker - Fri May 04, 2007 5:03 am</h4>
    <div class="postbody"><span class="postbody">I'm pretty sure &lt;br/&gt; is acceptable. ;-)<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127741 - Lick - Fri May 04, 2007 12:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">I'm pretty sure &lt;br/&gt; is acceptable. ;-)</td> </tr></table><span class="postbody">
<br/>
The XHTML 1.0 document tells you to leave a space between the tagname and the slash, so older browsers don't flip out. [<a class="postlink" href="http://www.w3.org/TR/xhtml1/#C_2" target="_blank">Appendix C.2</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#128038 - syncope - Mon May 07, 2007 11:45 pm</h4>
    <div class="postbody"><span class="postbody">Voil? here's someone's md2 loader 
<br/>
<br/>
<a href="http://www.box.net/shared/zkaffvemdz" target="_blank">http://www.box.net/shared/zkaffvemdz</a>
<br/>
[Possibly using an outdated version of PAlib]
<br/>
<br/>
// PA_md2 Loader by jandujar
<br/>
// Based on Webez md2 loader
<br/>
<br/>
<br/>
Aditional/Way too many details follow:
<br/>
<br/>
Stumbled upon it a year ago on this Spanisch DS Forum, couldn't find the  exact post again though &gt;&gt;
<br/>
<a href="http://www.elotrolado.net/forumdisplay.php?s=6b3f39cf7f6176c4fa0f4415e105cb92&amp;forumid=125" target="_blank">http://www.elotrolado.net/forumdisplay.php?s=6b3f39cf7f6176c4fa0f4415e105cb92&amp;forumid=125</a>
<br/>
<br/>
Author Homepage:
<br/>
<a href="http://jandujar.homelinux.com/antigua/index.php?option=com_content&amp;task=blogcategory&amp;id=23&amp;Itemid=38" target="_blank">http://jandujar.homelinux.com/antigua/index.php?option=com_content&amp;task=blogcategory&amp;id=23&amp;Itemid=38</a>
<br/>
<br/>
relevant threads
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=10248" target="_blank">http://forum.gbadev.org/viewtopic.php?t=10248</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#128076 - Daniel[Nordigic] - Tue May 08, 2007 11:15 am</h4>
    <div class="postbody"><span class="postbody">This page might also be of interest, it contains all kind of stuff...
<br/>
<br/>
<a href="http://tfc.duke.free.fr/" target="_blank">http://tfc.duke.free.fr/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
