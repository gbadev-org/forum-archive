<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Rom dump and cartridge cryptography - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Rom dump and cartridge cryptography</h2>
<div id="posts">
<div class="post">
    <h4>#31063 - leonard_ - Tue Dec 07, 2004 2:36 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
Maybe I'm wrong but here is what I know from the forum: DS game roms can't be read directly using a ROM reader coz there is encryption (exept in the header).
<br/>
<br/>
Do you think this is "encryption" (I mean data must be decoded with a key) or simply "random shuffling" ?
<br/>
<br/>
In any case, many people can help here, but few can dump ROM. So my guess: could someone post a "raw" image of a DS rom, even if it's encrypted, shuffled, etc... Maybe someone could have nice ideas if he gets the file. ( including me ! :-))</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31077 - tepples - Tue Dec 07, 2004 5:18 pm</h4>
    <div class="postbody"><span class="postbody">The problems here are that 1. the encryption uses a different key every time, and 2. the commands themselves are scrambled. It's not like Capcom CPS-2 where you can release an encrypted ROM and use various methods to get the XOR of the encrypted ROM with the decrypted ROM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31087 - EaDS Milliways - Tue Dec 07, 2004 6:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">The problems here are that 1. the encryption uses a different key every time,</td> </tr></table><span class="postbody">
<br/>
I have an RSA Keyfob that my company uses for network security. Every six seconds, the number on it changes (it has to be entered into the password field before you log on). If this is in any way related to the RSA logo on the back of the DS, then it's already accepted as a fairly strong level (enterprise ready) of secured encryption.
<br/>
<br/>
You can pore through the info at <a href="http://www.rsasecurity.com/" target="_blank">http://www.rsasecurity.com/</a> but if there are any specific questions about using it that I can answer, I try to!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31090 - SimonB - Tue Dec 07, 2004 7:40 pm</h4>
    <div class="postbody"><span class="postbody">Interesting to note is that RSAsecurity.com shows up in the forum logs reading all the DS encryption related topics :=)
<br/>
<br/>
Simon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31092 - keldon - Tue Dec 07, 2004 8:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SimonB wrote:</b></span></td> </tr> <tr> <td class="quote">Interesting to note is that RSAsecurity.com shows up in the forum logs reading all the DS encryption related topics :=)
<br/>
<br/>
Simon</td> </tr></table><span class="postbody">
<br/>
You'd have thought they invented asymetric cryptography</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31108 - willgonz - Tue Dec 07, 2004 11:40 pm</h4>
    <div class="postbody"><span class="postbody">Look up the patent for the DS.  I am sure it is (Patent Number) in the manual somewhere.
<br/>
United States Patent Numbers:
<br/>
5,207,426
<br/>
5,291,189 
<br/>
5,327,158 
<br/>
5,337,069 
<br/>
5,371,512 
<br/>
5,400,052 
<br/>
5,483,257
<br/>
5,495,266 
<br/>
5,509,663 
<br/>
5,608,424 
<br/>
5,708,457 
<br/>
D478,866 
<br/>
D468,743.
<br/>
Canadian Patent Numbers:
<br/>
2,037,909 
<br/>
2,048,167 
<br/>
2,049,899 
<br/>
2,049,900 
<br/>
2,049,914 
<br/>
2,051,655 
<br/>
2,055,718
<br/>
2,055,724 
<br/>
96,338.
<br/>
<br/>
Start searching. <a href="http://www.uspto.gov/" target="_blank">http://www.uspto.gov/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31115 - leonard_ - Wed Dec 08, 2004 12:21 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The problems here are that 1. the encryption uses a different key every time, and 2. the commands themselves are scrambled.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ok so each time you get a dump you get a different file. And ? it makes things a lot harder, but it's better to have files to study than nothing, no ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31117 - MR.MOD - Wed Dec 08, 2004 12:59 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.rsasecurity.com/press_release.asp?doc_id=160&amp;id=1034url" target="_blank">Here</a> It talks about the RSA BSAFE? encryption software and that some of the early investors and one is nintendo. <a class="postlink" href="http://www.rsasecurity.com/node.asp?id=2427url" target="_blank">Here</a> it talks about the BSAFE Standards and Compliance. I don't know If it has anything to do with the carts encryption but it looks like it might.
<br/>
<a href="http://www.rsasecurity.com/node.asp?id=1211" target="_blank">http://www.rsasecurity.com/node.asp?id=1211</a> talks about encryption for video game systems and ARM processers.</span><span class="gensmall"><br/><br/>Last edited by MR.MOD on Wed Dec 08, 2004 11:24 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#31119 - keldon - Wed Dec 08, 2004 1:22 am</h4>
    <div class="postbody"><span class="postbody">Having different results from the same data is a good thing; you never know what maths may reveal in the future.
<br/>
<br/>
What are the chances of the end bytes of each cartridge being 0 (before encryption of course)? What does encryption do if you attempt to read an address that can be addressed, but the cartridge simply does not have it? E.g. reading byte 1048578 on a 1MB cart (apart from an ACCESS_VIOLATION interrupt)
<br/>
<br/>
Like I said before aswell, what if you consecutively read the same byte? What is the distribution of returned results, even for the entire dump? <span style="text-decoration: underline">May</span> reveal something about their encryption technique, never know.
<br/>
<br/>
---
<br/>
<br/>
One question. Are the people who are getting the dumps heavy with cryptography?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31251 - tonofsteel - Thu Dec 09, 2004 5:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MR.MOD wrote:</b></span></td> </tr> <tr> <td class="quote"><a class="postlink" href="http://www.rsasecurity.com/press_release.asp?doc_id=160&amp;id=1034url" target="_blank">Here</a> It talks about the RSA BSAFE? encryption software and that some of the early investors and one is nintendo. <a class="postlink" href="http://www.rsasecurity.com/node.asp?id=2427url" target="_blank">Here</a> it talks about the BSAFE Standards and Compliance. I don't know If it has anything to do with the carts encryption but it looks like it might.
<br/>
<a href="http://www.rsasecurity.com/node.asp?id=1211" target="_blank">http://www.rsasecurity.com/node.asp?id=1211</a> talks about encryption for video game systems and ARM processers.</td> </tr></table><span class="postbody">
<br/>
<br/>
Every suggestion that encryption is done using RSA has turned up speculation that it can not be done with a stream etc.  And it makes perfect sense. 
<br/>
<br/>
However, since nintend0 was an investor to the "RSA BSAFE Cert-C ME" and it supports a multitude of encryption algorithms, AND is optimized for wireless and embedded devices, I say uh oh.  There is RSA on the thing for a reason....  
<br/>
<br/>
Reading some of the information available, there are some algorithms that can be streamed, and some that look suspiciously viable in the DS cart application. 
<br/>
<br/>
As well it is optimised for... surprise! wireless applications.  Someone was saying earlier that wireless is most likely not encrypted, but reading some info on the other side of those links makes me feel there is something ominous that is going to be discovered soon.  Mabye not, I am not sure how far people are into understanding the data being sent....  I am mostly messing around with getting something running through the DS cart slot....
<br/>
<br/>
It almost appears at first glance that nintend0 has been sleeping with RSA to get rid of us pesky homebrewers.  Just speculation.... but something seems very odd with this picture.
<br/>
<br/>
When reading through some PDF's there is even reference to using this encryption for memory applications....
<br/>
<br/>
Anyways if people are looking for information on encryption algorithms that are possible, i think this would be a very good place to start....</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31254 - keldon - Thu Dec 09, 2004 6:08 am</h4>
    <div class="postbody"><span class="postbody">Even if they streamed the data; there is no way to stream different outputs. Basically you have very large prime numbers generated, which is a(the) task in itself, some multiplication and modulo maths and you have RSA encrypted data. With a matching prime number and modulo number I think, you can decode it.
<br/>
<br/>
Because the key is different each time it is read from it means it is generated on the fly. So to be able to encode it you need an on board multiplication and modulus circuit in each cartridge.
<br/>
<br/>
Well with electronics these days I guess you never know what's possible from not.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31255 - tonofsteel - Thu Dec 09, 2004 6:12 am</h4>
    <div class="postbody"><span class="postbody">Apparantly it can do:
<br/>
<br/>
Algorithms
<br/>
<br/>
Public Key Algorithms
<br/>
<br/>
RSA?, RSA with MultiPrimeTM technology 
<br/>
<br/>
Symmetric Ciphers (Secret Key)
<br/>
<br/>
AES, RC5?, RC4?, RC2?, DES and 3DES 
<br/>
<br/>
Message Digests
<br/>
<br/>
MD2, MD5, HMAC, SHA-1, SHA-2 and HMAC 
<br/>
Standards
<br/>
Certificate format ? X.509 v3, WTLS 
<br/>
Public Key Cryptography Standards (PKCS) - #7, #10 
<br/>
<br/>
<br/>
Which all of are apparantly involved with the RSA BSAFE Cert-C ME system.  So even if the cart is using DES, it will still have RSA on the bottom since RSA came up with some fancy algorithms to make them like 10 times faster or something along those lines.......  
<br/>
<br/>
So the ITS NOT RSA encryption can still hold true, its just a encryption device or algorithm from RSA the company....</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31266 - ampz - Thu Dec 09, 2004 12:42 pm</h4>
    <div class="postbody"><span class="postbody">Someone suggested reading data from the end of the card: Try reading a few topics here... The commands are encrypted, we don't have the capability to send read commands to the card (the read header command is the notable exception).
<br/>
<br/>
As for some of the encryption algorithms.. This is done in hardware, that means no multiplications, no divisions, and no modulus operations.
<br/>
What ever encryption algorithm they use, it will only use additions/subtractions, logic, and shifts. It will also not use more than perhaps a hundred bits or so of RAM.
<br/>
Rules out many encryption algorithms.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31279 - leonard_ - Thu Dec 09, 2004 2:25 pm</h4>
    <div class="postbody"><span class="postbody">my own opinion about DS crypto:
<br/>
<br/>
RSA-Bsafe program is a general crypto library for C/C++. some of the algorithm described can be fast on ARM ( especially symetric block cypher such as RC2 or AES).
<br/>
<br/>
I'm sure all these algos are NOT used in hardware for game ROM reading. If there is encryption in ROM cartridge, it's a basic system (such as XOR or pseudo random)
<br/>
<br/>
For wireless, the only fast stream-cypher in the list is RC4. But, we know data is not encrypted because some people saw ascci string in data packets.
<br/>
<br/>
To me, the big problem people working on wi-fi hacking will face is digital signature. It's possible that RSA is used to sign a large binary block. Data are not crypted, just signed.  If you don't know the nintendo private key, you simply can't sign your own code , so you can't run your own code. Think about it, Microsoft Xbox signature private key has never been hacked !! ( people simply replace the BIOS to avoid the signature check).
<br/>
<br/>
So RSA-BSafe is only marketing words. All theses cyphers are only a list for journalist. BUT, it could be possible that an assymetric cypher ( such as RSA) is used to sign code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31286 - tonofsteel - Thu Dec 09, 2004 4:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>leonard_ wrote:</b></span></td> </tr> <tr> <td class="quote">my own opinion about DS crypto:
<br/>
<br/>
RSA-Bsafe program is a general crypto library for C/C++. some of the algorithm described can be fast on ARM ( especially symetric block cypher such as RC2 or AES).
<br/>
<br/>
I'm sure all these algos are NOT used in hardware for game ROM reading. If there is encryption in ROM cartridge, it's a basic system (such as XOR or pseudo random)
<br/>
<br/>
For wireless, the only fast stream-cypher in the list is RC4. But, we know data is not encrypted because some people saw ascci string in data packets.
<br/>
<br/>
To me, the big problem people working on wi-fi hacking will face is digital signature. It's possible that RSA is used to sign a large binary block. Data are not crypted, just signed.  If you don't know the nintendo private key, you simply can't sign your own code , so you can't run your own code. Think about it, Microsoft Xbox signature private key has never been hacked !! ( people simply replace the BIOS to avoid the signature check).
<br/>
<br/>
So RSA-BSafe is only marketing words. All theses cyphers are only a list for journalist. BUT, it could be possible that an assymetric cypher ( such as RSA) is used to sign code.</td> </tr></table><span class="postbody">
<br/>
<br/>
Um, yea, and if you read about some of those algorithms they use a simple XOR in their implementation.  And that was the whole point of quoting that page, is because of implementation issues it narrows down the field.  
<br/>
<br/>
But nintendo invested in RSA-Bsafe for EMBEDDED and WIRELESS devices, in case you missed that.  And algorithms that can be made in software can be made in hardware as well.  For all we know the DS decrypts the stuff using software.
<br/>
<br/>
And i doubt that RSA-Bsafe is for the next gamecube since it was made for embedded and wireless devices.  And RSA is on the bottom of the DS.... hmmmm mabye a connection there?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31287 - tepples - Thu Dec 09, 2004 5:40 pm</h4>
    <div class="postbody"><span class="postbody">Game consoles are considered "embedded devices".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31288 - EaDS Milliways - Thu Dec 09, 2004 5:44 pm</h4>
    <div class="postbody"><span class="postbody">Here's a page that describes how one of the technologies work
<br/>
<br/>
<a href="http://www.myfuturecom.com/Products/rsasecurity/securid_hardware.asp" target="_blank">http://www.myfuturecom.com/Products/rsasecurity/securid_hardware.asp</a>
<br/>
<br/>
Since this is a "once every 60 seconds" thing, it wouldn't really be the case with the DS since each reading is yielding different results (for embedded devices, maybe it changes on each reading instead of every 60 seconds).
<br/>
<br/>
I think I may have seen a picture somewhere of the PSP where it also was using RSA, however I can't find it now. Has anyone else seen this?
<br/>
<br/>
EDIT: As another thought, perhaps the clock/alarm function is only there because they have something recording "beats" while it's "asleep" anyway, why not tie it to a clock? :)</span><span class="gensmall"><br/><br/>Last edited by EaDS Milliways on Thu Dec 09, 2004 5:53 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#31289 - EaDS Milliways - Thu Dec 09, 2004 5:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Game consoles are considered "embedded devices".</td> </tr></table><span class="postbody">
<br/>
<br/>
I think it's embedded in that the required hardware has been integrated into the system instead of being something separate.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31387 - XSF04 - Fri Dec 10, 2004 7:27 pm</h4>
    <div class="postbody"><span class="postbody">In any cases guys the DS will be able to run homebrews someday.
<br/>
<br/>
My 2cents theory: This is applicable in any domain. Everything that is constructed/build by human kind can be also dismantled/reversed by human kind.
<br/>
<br/>
One day your DS will run homebrews!
<br/>
<br/>
<br/>
:)<br/>_________________<br/>-XSF04- 
<br/>
<br/>
Excess for the way it meant to be.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31391 - siul1979 - Fri Dec 10, 2004 7:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>XSF04 wrote:</b></span></td> </tr> <tr> <td class="quote">In any cases guys the DS will be able to run homebrews someday.
<br/>
<br/>
My 2cents theory: This is applicable in any domain. Everything that is constructed/build by human kind can be also dismantled/reversed by human kind.
<br/>
<br/>
One day your DS will run homebrews!
<br/>
<br/>
<br/>
:)</td> </tr></table><span class="postbody">
<br/>
We all know the answer to the question, "Will we be able to run homebrews?"
<br/>
, but the question should be "When?" =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31421 - tepples - Fri Dec 10, 2004 10:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>XSF04 wrote:</b></span></td> </tr> <tr> <td class="quote">Everything that is constructed/build by human kind can be also dismantled/reversed by human kind.</td> </tr></table><span class="postbody">
<br/>
It'll be hacked, but how do you know this will happen before you're dead? For example, the community still hasn't managed to come up with source code for a functional equivalent to the frontloading NES's lockout chip. Homebrew NES developers either have to steal a lockout chip off an existing NES game's board or open the NES and snap a pin.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31428 - Abscissa - Fri Dec 10, 2004 10:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Homebrew NES developers either have to steal a lockout chip off an existing NES game's board or open the NES and snap a pin.</td> </tr></table><span class="postbody">
<br/>
<br/>
Or beat it into submission with voltage spikes ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31433 - tepples - Fri Dec 10, 2004 11:30 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Abscissa wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Homebrew NES developers either have to steal a lockout chip off an existing NES game's board or open the NES and snap a pin.</td> </tr></table><span class="postbody">
<br/>
Or beat it into submission with voltage spikes ;)</span></td> </tr></table><span class="postbody">
<br/>
Not on later frontloaders that put decent ESD protection circuitry in front of the lockout chips so that the Macronix -5V trick used by Color Dreams, Camerica, and AVE games doesn't work.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31478 - netdroid9 - Sat Dec 11, 2004 5:30 am</h4>
    <div class="postbody"><span class="postbody">It'll happen this lifetime, as long as someone can be bothered to dump the NDS BIOS, WIFI (If it has it's own rom/ram), Several Encrypted Game ROMS, and everything else. Then you need to create an actual digital DS (Well, not really, but it'd make the job a heck of a lot easier) by finding out every piece of hardware it uses and puting it into a physics simulator, and then loading all the rom data into it.
<br/>
<br/>
Use the simulator to find out how the NDS interacts with the game cartridge. More importantly, record the commands the NDS uses to extract a key from the cartridge. If it uses different keys that is.
<br/>
<br/>
If someone does this, post the full simulation and all the interactions you got. Why? because the simulation doubles as an emulator :D
<br/>
<br/>
(I'm not sure there is a physics simulation capable of this, but there should be)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31750 - FriedChickenAndOrangeSoda - Tue Dec 14, 2004 7:58 am</h4>
    <div class="postbody"><span class="postbody">This thread made me flip my DS over, and actually check out the serial number sticker.  Yup, there's an "RSA Secured" logo.
<br/>
<br/>
What's really secured though?  The BIOS image?  The DS carts themselves?  The wireless traffic we know isn't encrypted, at least on the WiFi part.  Maybe the NiFi stuff is?  Interesting stuff up ahead, that's for sure...<br/>_________________<br/>Fried Chicken and Orange Soda</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31781 - EaDS Milliways - Tue Dec 14, 2004 3:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FriedChickenAndOrangeSoda wrote:</b></span></td> </tr> <tr> <td class="quote">What's really secured though?  The BIOS image?  The DS carts themselves?</td> </tr></table><span class="postbody">
<br/>
IMHO, if it works like their other products then the first connect between the cart and the DS is something to determine how the code will be encrypted and then the traffic is encrypted this way.
<br/>
<br/>
If there's no "clock" on the cart, that would mean that the randomness has to be based wholly on the DS, right? Actually, the more I think about the logic of that, the more my brain cooks. I'll need some coffee to cool it down...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31948 - mike260 - Thu Dec 16, 2004 3:58 am</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
I've been following this board with great interest, but I've got to inject a note of pessimism here: Doesn't it seem likely that Nintendo has signed their carts and netboot packets with public key crypto? It wouldn't stop people making identical copies of legit games, but it would make it impossible to create valid homebrew carts. Thus, the only use for flash carts would be piracy, which would presumably make it easier for Nintendo to pursue them legally.
<br/>
<br/>
Is anyone looking into alternative attack vectors? Eg:
<br/>
<br/>
 - Modifying/replacing the BIOS
<br/>
 - Finding a wifi exploit
<br/>
 - Getting control of the system from a GBA cart
<br/>
<br/>
I'm planning to start poking around the DS from within a GBA cart as soon as I get a DS anyway...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31949 - AdamW - Thu Dec 16, 2004 5:15 am</h4>
    <div class="postbody"><span class="postbody">Well, if you read the forum, you'll see that's exactly what people are investigating :). Don't think there's a solid conclusion as of yet. Booting a GBA cartridge switches the system to an entirely different mode in which only the ARM7 CPU that is used to run GBA games is accessible, only one screen is accessible and none of the DS-specific stuff is turned on, so gaining control of the whole system through that vector seems unlikely. Wi-fi boot is being actively worked on as you can read in other threads.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31951 - mike260 - Thu Dec 16, 2004 6:11 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>AdamW wrote:</b></span></td> </tr> <tr> <td class="quote">Well, if you read the forum, you'll see that's exactly what people are investigating :). Don't think there's a solid conclusion as of yet. Booting a GBA cartridge switches the system to an entirely different mode in which only the ARM7 CPU that is used to run GBA games is accessible, only one screen is accessible and none of the DS-specific stuff is turned on, so gaining control of the whole system through that vector seems unlikely. Wi-fi boot is being actively worked on as you can read in other threads.</td> </tr></table><span class="postbody">
<br/>
<br/>
Regarding wifi, I meant an exploit along the lines of a buffer overflow or similar - IMHO wifo boot will prove impossible
<br/>
<br/>
Regarding GBA mode, it could be possible to use it to take a look at the DS BIOS, if nothing else. There's a loophole that lets you get the CPU into supervisor mode, right?
<br/>
It's damn frustrating not having a DS to experiment with and having to live vicariously through you guys :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31959 - tepples - Thu Dec 16, 2004 7:35 am</h4>
    <div class="postbody"><span class="postbody">You can get the GBA CPU into a mode where you can look at the BIOS, but then you can only look at the same BIOS that you've been seeing since 2001. There's only one <a class="postlink" href="http://en.wikipedia.org/wiki/Hamming_distance" target="_blank">bit of difference</a> between the GBA and DS BIOS, and it's in an unused section, likely placed there so that GBA programs running on a Nintendo DS can detect its brighter screen and use the full 0-31 range of RGB color components rather than 8-31.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31960 - mymateo - Thu Dec 16, 2004 7:43 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">and use the full 0-31 range of RGB color components rather than 8-31.</td> </tr></table><span class="postbody">
<br/>
<br/>
Quick questions:
<br/>
<br/>
The GBA can use the full range anyways, can't it?
<br/>
<br/>
If so, are you just saying that with the GBA (SP) screen, you can't actually make out colors using 0-7 in the RGB components, thus a good programmer just wouldn't use them?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31961 - kerrle - Thu Dec 16, 2004 7:44 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mike260 wrote:</b></span></td> </tr> <tr> <td class="quote">I've been following this board with great interest, but I've got to inject a note of pessimism here: Doesn't it seem likely that Nintendo has signed their carts and netboot packets with public key crypto? It wouldn't stop people making identical copies of legit games, but it would make it impossible to create valid homebrew carts. </td> </tr></table><span class="postbody">
<br/>
<br/>
But this is exactly the oposite of what Nintendo would be interested in - they could care less if a few hobbyist get a web browser running on their device - where's the loss to them?.
<br/>
<br/>
If a pirate organization in China, however, can figure out how to mass produce copies of legit games, Nintendo is out a ton of money.
<br/>
<br/>
If anything, I'd expect a protection scheme which makes it nearly impossible to copy an existing game, but doesn't care about homebrew code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31963 - tepples - Thu Dec 16, 2004 7:49 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mymateo wrote:</b></span></td> </tr> <tr> <td class="quote">The GBA can use the full range anyways, can't it?</td> </tr></table><span class="postbody">
<br/>
Yes, but if you try, you get Castlevania: Circle of the Moon. It appears Konami got the retail units too late to make any changes to the palettes.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">If so, are you just saying that with the GBA (SP) screen, you can't actually make out colors using 0-7 in the RGB components, thus a good programmer just wouldn't use them?</td> </tr></table><span class="postbody">
<br/>
That's exactly what I meant. A game would detect the Game Boy Player using the splash screen method and the DS using a BIOS checksum, and then it'd adjust the brightness accordingly.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#31989 - mike260 - Thu Dec 16, 2004 6:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">You can get the GBA CPU into a mode where you can look at the BIOS, but then you can only look at the same BIOS that you've been seeing since 2001.</td> </tr></table><span class="postbody">
<br/>
<br/>
Now I'm confused. I thought that there wasn't an MMU, just a protection unit. How is the system hiding the 'real' BIOS from GBA-mode code?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32012 - netdroid9 - Fri Dec 17, 2004 2:58 am</h4>
    <div class="postbody"><span class="postbody">Easy, the DS BIOS loads, sees the GBA Cartridge, loads the GBA BIOS and unloads itself.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32013 - SmileyDude - Fri Dec 17, 2004 3:32 am</h4>
    <div class="postbody"><span class="postbody">the GBA didn't have a MMU either, but it wasn't possible to read the BIOS directly.  The only reason we have a dump of the BIOS is because of a bug in one of the functions in the BIOS that allowed extraction of the BIOS data.
<br/>
<br/>
I'm assuming that there is some basic functionality to turn on/off areas of the address space on the DS, just like there was on the GBA.  Something fairly simple that just looks at the current mode of the CPU and adjusts the memory map as necessary.  If the DS had a real MMU, that functionality would be handled there.  But, since the DS doesn't, it's probably some custom logic that Nintendo put in place to protect the BIOS.  
<br/>
<br/>
I would be interested in seeing if using the GBA BIOS might yield a way into the DS BIOS.  But, my bet is that the DS BIOS runs on the ARM 9 CPU, and it's protection is tied to the state of the ARM 9.  I would assume that the ARM 9 is in user mode and asleep while GBA games are running, so there probably isn't much possibility of getting to the DS BIOS that way.<br/>_________________<br/>dennis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32014 - AdamW - Fri Dec 17, 2004 5:28 am</h4>
    <div class="postbody"><span class="postbody">tepples: that's what a SMART game does, yes. a DUMB game like Final Fantasy Tactics Advance gives you a manual choice of display modes, explains vaguely that one might be better for GBA SP, one for GBA and one for Game Boy Player, and leaves you to figure out which one to use by yourself. sigh.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32015 - ravuya - Fri Dec 17, 2004 5:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>AdamW wrote:</b></span></td> </tr> <tr> <td class="quote">tepples: that's what a SMART game does, yes. a DUMB game like Final Fantasy Tactics Advance gives you a manual choice of display modes, explains vaguely that one might be better for GBA SP, one for GBA and one for Game Boy Player, and leaves you to figure out which one to use by yourself. sigh.</td> </tr></table><span class="postbody">
<br/>
<br/>
FFTA made a lot of really dumb decisions (although it's not the only game to have the LCD A/LCD B/TV crap -- I think Metroid Fusion did too, although I can't recall exactly). I don't know why some of the cinema scenes are unskippable for the first couple of seconds -- a friend of mine wondered out loud if it might be decompressing data then -- and if you look at the credits it was put together by five coders, but over 60 QA and art people.<br/>_________________<br/><a class="postlink" href="http://rav.realitybytes.tk" target="_blank">Rav</a> (Win/Mac/Linux games for free)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32016 - mike260 - Fri Dec 17, 2004 5:46 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote">the GBA didn't have a MMU either, but it wasn't possible to read the BIOS directly.  The only reason we have a dump of the BIOS is because of a bug in one of the functions in the BIOS that allowed extraction of the BIOS data.</td> </tr></table><span class="postbody">
<br/>
<br/>
That's the out-of-range SWI thingy, right? That's what I was suggesting could be used to get into supervisor mode, from whence the protection unit might be disabled.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote">I'm assuming that there is some basic functionality to turn on/off areas of the address space on the DS, just like there was on the GBA.  Something fairly simple that just looks at the current mode of the CPU and adjusts the memory map as necessary.  If the DS had a real MMU, that functionality would be handled there.  But, since the DS doesn't, it's probably some custom logic that Nintendo put in place to protect the BIOS. </td> </tr></table><span class="postbody">
<br/>
<br/>
If it is the same protection-unit as the GBA had (it's a standard ARM component BTW) then it's circumventable using the BIOS bug. But I guess it'd be pretty negligent of Nintendo not to close that loophole. It's got to be worth a try though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32017 - SmileyDude - Fri Dec 17, 2004 7:02 am</h4>
    <div class="postbody"><span class="postbody">well, i'm going under the assumption that either it's a different protection unit, or there is one for both the ARM 7 and the ARM 9, and the DS BIOS is only accessable to the ARM 9. 
<br/>
<br/>
Now, other parts of the system might be accessable via GBA BIOS bugs... but, I can't really even speculate on this.
<br/>
<br/>
BTW -- wasn't there code someplace that would put the GBA into supervisor mode?  Or was that a complete figment of my imagination?  If that code does exist, does it allow read access to the BIOS?<br/>_________________<br/>dennis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32021 - tepples - Fri Dec 17, 2004 8:47 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mike260 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote">The only reason we have a dump of the BIOS is because of a bug in one of the functions in the BIOS that allowed extraction of the BIOS data.</td> </tr></table><span class="postbody">
<br/>
That's the out-of-range SWI thingy, right?</span></td> </tr></table><span class="postbody">
<br/>
Apparently, the check allowing reading the GBA BIOS involves both the CPU mode and the high order bits of the program counter. The buggy BIOS function was MidiKey2Freq(), which didn't check if one of the parameters was within the BIOS area. Other BIOS functions, such as CpuFastSet(), don't do anything if the source range includes any of BIOS.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32027 - Sebbo - Fri Dec 17, 2004 10:37 am</h4>
    <div class="postbody"><span class="postbody">i know its not a good idea to bring up old stuff in a forum, but...
<br/>
keldon said 
<br/>
"Having different results from the same data is a good thing; you never know what maths may reveal in the future. "
<br/>
<br/>
how about some dumps of the same game on this forum (or even links to the dumps) so that us who know some advanced maths can try and work something out? i said this in another topic, but matrix encryption would be a smart idea for this sort of thing, and the DS can do it (a XOR is a matrix, but only really simple).
<br/>
does any one know what the largest array for a matrix is that the DS can handle? if it does use matrices, the encryption matrix won't be too small, or too big either
<br/>
<br/>
again, can we have some dumps posted on the site? i wanna see if i wasted 2 years of schooling on advanced maths or not :-P
<br/>
 [/quote]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32037 - netdroid9 - Fri Dec 17, 2004 1:05 pm</h4>
    <div class="postbody"><span class="postbody">I'd like a look as well, but I don't have a DS :(.
<br/>
<br/>
April 2005 date set for the DS in Australia... WHY NINTENDO WHY?!?!?!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32041 - mike260 - Fri Dec 17, 2004 1:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Apparently, the check allowing reading the GBA BIOS involves both the CPU mode and the high order bits of the program counter. The buggy BIOS function was MidiKey2Freq(), which didn't check if one of the parameters was within the BIOS area. Other BIOS functions, such as CpuFastSet(), don't do anything if the source range includes any of BIOS.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ah, I was referring to a different bug. Look at 'BIOS System Call Handling' in this doc: <a href="http://wwwhsse.fh-hagenberg.at/Studierende/hse02006/uclgba/gba-howto/ar01s03.html" target="_blank">http://wwwhsse.fh-hagenberg.at/Studierende/hse02006/uclgba/gba-howto/ar01s03.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32066 - darkfader - Fri Dec 17, 2004 7:25 pm</h4>
    <div class="postbody"><span class="postbody">&lt;deleted&gt;</span><span class="gensmall"><br/><br/>Last edited by darkfader on Tue Mar 01, 2005 8:40 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#32069 - mymateo - Fri Dec 17, 2004 9:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>netdroid9 wrote:</b></span></td> </tr> <tr> <td class="quote">I'd like a look as well, but I don't have a DS :(.
<br/>
<br/>
April 2005 date set for the DS in Australia... WHY NINTENDO WHY?!?!?!</td> </tr></table><span class="postbody">
<br/>
<br/>
There are plenty of ways to get your hands on a DS right now.  eBay has lot of 'em, and a good number go for barely over the retail price.  Add shipping, and I think you may end up having to pay 15 to 25% more than when they come in stores, but if it's worth it to get a DS now instead of later...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32089 - netdroid9 - Sat Dec 18, 2004 2:30 am</h4>
    <div class="postbody"><span class="postbody">I don't have a credit card though :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32090 - AdamW - Sat Dec 18, 2004 2:42 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://www.bidpay.com" target="_blank">www.bidpay.com</a> - international money orders, paying eBay sellers for the purpose of, $5 a pop.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32096 - mike260 - Sat Dec 18, 2004 3:47 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">BTW -- wasn't there code someplace that would put the GBA into supervisor mode? Or was that a complete figment of my imagination? If that code does exist, does it allow read access to the BIOS?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Oops, looks like I was talking out my arse - I just tried this out on a GBA, and getting into supervisor  mode *doesn't* let you see the BIOS. Doesn't let you do anything out-of-the-ordinary as far as I can see. The protection unit I assumed was controlling BIOS access doesn't appear to exist either - looks like the BIOS is only readable when the PC's inside it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32098 - DekuTree64 - Sat Dec 18, 2004 3:52 am</h4>
    <div class="postbody"><span class="postbody">How did you get into supervisor mode? I've never heard of any way to do it, and if I remember right, even the PC gets garbage from the BIOS if you bx into it. Try branching to the BIOS in supervisor mode and see what happens.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32110 - sgeos - Sat Dec 18, 2004 5:20 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>AdamW wrote:</b></span></td> </tr> <tr> <td class="quote">www.bidpay.com - international money orders, paying eBay sellers for the purpose of, $5 a pop.</td> </tr></table><span class="postbody">
<br/>
Before I had a credit card, I bought a whole bunch of stuff off ebay using money orders.  IIRC, I used Canadian postal money orders.  (I don't recall money orders from the bank working.)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32116 - mike260 - Sat Dec 18, 2004 5:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">How did you get into supervisor mode? I've never heard of any way to do it, and if I remember right, even the PC gets garbage from the BIOS if you bx into it. Try branching to the BIOS in supervisor mode and see what happens.</td> </tr></table><span class="postbody">
<br/>
<br/>
Basically, the BIOS handles SWI nn by looking up entry nn in a jump-table and jumping to that address. But the jump table only covers 42 entries, and the BIOS doesn't check for out-of-range SWIs. Specify an out-of-range SWI, and the BIOS will happily fetch garbage off the end of the jump-table, interpret it as an address and jump to it.
<br/>
Luckily, shortly after the jump-table in the BIOS is the number 0x02002040, which is an address in WRAM. So calling SWI D4 will effectively get the BIOS to jump to 0x02002040, still in supervisor mode.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void supervisor( void(*func)() )
<br/>
{
<br/>
   u32 *trap = (u32 *)0x02002040;
<br/>
<br/>
   trap[-1] = (u32)func;
<br/>
<br/>
   //LDR PC,(PC-4)
<br/>
   trap[0] =
<br/>
      (12&lt;&lt;0) |
<br/>
      (15&lt;&lt;12) |
<br/>
      (15&lt;&lt;16) |
<br/>
      (1&lt;&lt;20) |
<br/>
      (1&lt;&lt;24) |
<br/>
      (1&lt;&lt;26) |
<br/>
      (14&lt;&lt;28);
<br/>
<br/>
   __asm("swi 0xD40000;");
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32268 - FluBBa - Mon Dec 20, 2004 9:56 am</h4>
    <div class="postbody"><span class="postbody">The GBA starts in System mode, you only have to change the CPSR mode bits to enter Supervisor mode.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32279 - Mr. Ploppy - Mon Dec 20, 2004 2:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">Before I had a credit card, I bought a whole bunch of stuff off ebay using money orders.  IIRC, I used Canadian postal money orders.  (I don't recall money orders from the bank working.)
<br/>
<br/>
-Brendan</td> </tr></table><span class="postbody">
<br/>
Do you know if Canadian Tire money works?<br/>_________________<br/>I'm just off to Hartleypool to buy some exploding trousers. Cluck, cluck, gibber, gibber, "my old man's a mushroom", et cetera.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32331 - mymateo - Tue Dec 21, 2004 4:05 am</h4>
    <div class="postbody"><span class="postbody">Lol, Mr. Ploppy.  But if you're serious, then "no" unless you plan to buy your DS from Canadian Tire.  Canadian Tire Money can only be used at Canadian Tire.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#32334 - sgeos - Tue Dec 21, 2004 4:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mr. Ploppy wrote:</b></span></td> </tr> <tr> <td class="quote">Do you know if Canadian Tire money works?</td> </tr></table><span class="postbody">
<br/>
Have a friend or relative buy your Canadian Tire money on a $1 for $1 exchange.  Use your new (and ever so strong) Canadian dollars to buy your money order.
<br/>
<br/>
I offered to buy a gift card from my sister at face value.  It didn't work out because I've returned to Canada briefly... *I should stop rambling*
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
