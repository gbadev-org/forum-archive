<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>2D over 3D with glOrtho - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > 2D over 3D with glOrtho</h2>
<div id="posts">
<div class="post">
    <h4>#114454 - Vich - Mon Jan 08, 2007 1:47 am</h4>
    <div class="postbody"><span class="postbody">I'm having a problem with overlaying 2D over 3D in my application. I've tried to use my regular Windows/Linux OpenGL approach first, but that didn't work.  I used Google and this forum's search but I couldn't really find NDS-OpenGL-related solutions, so this is what I do:
<br/>
<br/>
First I start a scene:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void GraphicsBridgeOglNds::BeginScene(bool clearBackBuffer)
<br/>
{
<br/>
   glReset();
<br/>
   gluPerspective(35.0f, 256.0f / 192.0f, 0.1f, 100.0f);
<br/>
   glColor3f(1, 1, 1);
<br/>
<br/>
   glLight(0, RGB15(31,31,31) , 0, floattov10(-1.0f), 0);
<br/>
<br/>
   glMatrixMode(GL_TEXTURE);
<br/>
   glIdentity();
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glIdentity();
<br/>
<br/>
   glMaterialf(GL_AMBIENT, RGB15(16,16,16));
<br/>
   glMaterialf(GL_DIFFUSE, RGB15(16,16,16));
<br/>
   glMaterialf(GL_SPECULAR, BIT(15) | RGB15(8,8,8));
<br/>
   glMaterialf(GL_EMISSION, RGB15(16,16,16));
<br/>
<br/>
   glMaterialShinyness();
<br/>
   
<br/>
   glPolyFmt(POLY_ALPHA(31) | POLY_CULL_NONE | POLY_FORMAT_LIGHT0);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Then I push some triangles(a piramid) in 3D:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
glPushMatrix();
<br/>
   glTranslate3f32(0, 0, floattof32(-4.0f));
<br/>
   glBegin(GL_TRIANGLES);
<br/>
      // Push some vertices...
<br/>
   glEnd();
<br/>
glPopMatrix(1);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Then I init 2D mode:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void GraphicsOglNds::StartGuiViewMatrix()
<br/>
{
<br/>
   glLoadIdentity();
<br/>
   ClearDepthBuffer();
<br/>
<br/>
   glMatrixMode(GL_PROJECTION);
<br/>
      glLoadIdentity();
<br/>
<br/>
   glOrtho(0, 256, 192, 0, 0, 1);
<br/>
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glLoadIdentity();
<br/>
<br/>
   glColor3f(1, 1, 1);
<br/>
   glPolyFmt(POLY_ALPHA(31) | POLY_CULL_NONE); 
<br/>
   
<br/>
   SetOptionDepthTesting(false);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Then I draw some 2D stuff:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   glPushMatrix();
<br/>
   glTranslatef(0.0, 0.0, 0.0);
<br/>
   glBegin(GL_QUADS);
<br/>
      glVertex3f(-10.0, -10.0, 0.0);
<br/>
      glVertex3f(10.0, -10.0, 0.0);
<br/>
      glVertex3f(10.0, 10.0, 0.0);
<br/>
      glVertex3f(-10.0, 10.0, 0.0);
<br/>
   glEnd();
<br/>
   glPopMatrix(1);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Then I finish the 2D mode:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void GraphicsOglNds::EndGuiViewMatrix()
<br/>
{
<br/>
   glMatrixMode(GL_PROJECTION);   
<br/>
   glLoadIdentity();
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glLoadIdentity();
<br/>
<br/>
   SetOptionDepthTesting(true);
<br/>
    SetOptionLighting(bPrevLightingState);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And finally I finish rendering:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void GraphicsBridgeOglNds::EndScene()
<br/>
{
<br/>
   glFlush();
<br/>
   swiWaitForVBlank();
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Does anyone have an idea what I do wrong?
<br/>
Is it correct to draw a 2D vertex by using glVertex3f(x, y, 0) or must it be glVertex3f(x, 0, z)? (by trying the second one, the application still gives me a wrong result.
<br/>
<br/>
Here's a screenshot of what is shown(updated!):
<br/>
<a class="postlink" href="http://warehouse.lifeisdigital.net/pictures/other/dsguiproblem.png" target="_blank">http://warehouse.lifeisdigital.net/pictures/other/dsguiproblem.png</a>
<br/>
<br/>
I understand that there are other ways of overlaying 2D, but I only want to work with the OpenGL implementation that is provided through libnds.</span><span class="gensmall"><br/><br/>Last edited by Vich on Mon Jan 08, 2007 11:14 am; edited 3 times in total</span></div>    
</div>
<div class="post">
    <h4>#114458 - strager - Mon Jan 08, 2007 2:32 am</h4>
    <div class="postbody"><span class="postbody">I hardly know much about 3D programming, much less on the DS, but I think your problem lies with the Z value of the vertices while in ortho-mode...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrtho(0, 256, 192, 0, 0, 1);</td> </tr></table><span class="postbody">
<br/>
I'm not sure, but I think the last two values, 0 and 1, are the near and far Z values.  Try placing your polygons with a Z value somewhere between these two values.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114483 - Vich - Mon Jan 08, 2007 8:44 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>strager wrote:</b></span></td> </tr> <tr> <td class="quote">I hardly know much about 3D programming, much less on the DS, but I think your problem lies with the Z value of the vertices while in ortho-mode...
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrtho(0, 256, 192, 0, 0, 1);</td> </tr></table><span class="postbody">
<br/>
I'm not sure, but I think the last two values, 0 and 1, are the near and far Z values.  Try placing your polygons with a Z value somewhere between these two values.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I changed it to:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrtho(0, 256, 192, 0, -1, 1);</td> </tr></table><span class="postbody">
<br/>
but that doesn't make any difference, because a Z value of 0 is still between 0 and 1, while now it is between -1 and 1.
<br/>
<br/>
I've also uploaded a new picture to show what happens if I try to draw a bigger quad: it gets displayed smaller.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114528 - themadcelt - Mon Jan 08, 2007 8:20 pm</h4>
    <div class="postbody"><span class="postbody">Goosey and I ran into similar issues when we were working with glOrtho. I've asked him to post his solution.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114551 - Vich - Mon Jan 08, 2007 11:00 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>themadcelt wrote:</b></span></td> </tr> <tr> <td class="quote">Goosey and I ran into similar issues when we were working with glOrtho. I've asked him to post his solution.</td> </tr></table><span class="postbody">
<br/>
Thanks a billion!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114558 - simonjhall - Mon Jan 08, 2007 11:56 pm</h4>
    <div class="postbody"><span class="postbody">I too had problems when using ortho - though I don't know if they're the same thing. In the end I just decided to use perspective with a really small fov - then everything started working as expected!<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114563 - Vich - Tue Jan 09, 2007 12:05 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>simonjhall wrote:</b></span></td> </tr> <tr> <td class="quote">I too had problems when using ortho - though I don't know if they're the same thing. In the end I just decided to use perspective with a really small fov - then everything started working as expected!</td> </tr></table><span class="postbody">
<br/>
That's a nice alternative solution!
<br/>
<br/>
Another solution a colleague came up with was saving the matrices on a Windows/Linux OpenGL implementation and loading it up into the DS system.
<br/>
<br/>
I'd still like to hear Goosey's method though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114565 - simonjhall - Tue Jan 09, 2007 12:10 am</h4>
    <div class="postbody"><span class="postbody">The thing that I had was that the was no z-testing for me in ortho mode. Even doing the stuff detailed on nocash, I still couldn't get the z working properly. In fact it mentions that when you use orthographic mode w-buffering doesn't work properly.
<br/>
<br/>
I too thought about generating my own matrices or loading them from a PC :-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114601 - memoni - Tue Jan 09, 2007 10:42 am</h4>
    <div class="postbody"><span class="postbody">I had problem with glOrtho too when I was making my flower thing. The solution was to use something like glOrtho(-1,1,0.75,-0.75,-1,1). That is, small range and zero at the center. I did not bother back then figure out what was the real problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114603 - Vich - Tue Jan 09, 2007 11:43 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>memoni wrote:</b></span></td> </tr> <tr> <td class="quote">I had problem with glOrtho too when I was making my flower thing. The solution was to use something like glOrtho(-1,1,0.75,-0.75,-1,1). That is, small range and zero at the center. I did not bother back then figure out what was the real problem.</td> </tr></table><span class="postbody">
<br/>
That's a good hint, but I'm affraid that I can't use that, because the cross-platform engine I'm creating must work in a uniform way(2D coordinates in pixels, with (0,0) in the upper left corner of the screen).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114624 - themadcelt - Tue Jan 09, 2007 4:28 pm</h4>
    <div class="postbody"><span class="postbody">Since Goosey is far to busy with ... well... DS stuff, I'll post his solution.
<br/>
<br/>
1.  Use glOrthof32(...) rather than glOrtho.  </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrthof32(0, 256, 192, 0,0, 1);</td> </tr></table><span class="postbody">
<br/>
2.  Use glVertex3v16(x, y, z) to push verts. Ensure you're using normal ints, rather than any fancy-pants fixed point numbers.  
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glVertex3v16(10, 10, 0);</td> </tr></table><span class="postbody">
<br/>
3.  Celebrate your new Orthographic projection.
<br/>
<br/>
&lt;edit&gt;removed the fancy-pants floating point numbers I left in the code sample.  d'oh!&lt;/edit&gt;</span><span class="gensmall"><br/><br/>Last edited by themadcelt on Tue Jan 09, 2007 4:40 pm; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#114626 - Vich - Tue Jan 09, 2007 4:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>themadcelt wrote:</b></span></td> </tr> <tr> <td class="quote">Since Goosey is far to busy with ... well... DS stuff, I'll post his solution.
<br/>
<br/>
1.  Use glOrthof32(...) rather than glOrtho.  <table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrthof32(0, 256, 192, 0,0, 1);</td> </tr></table><span class="postbody">
<br/>
2.  Use glVertex3v16(x, y, z) to push verts. Ensure you're using normal ints, rather than any fancy-pants fixed point numbers.  
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glVertex3v16(10.0, 10.0, 0.0);</td> </tr></table><span class="postbody">
<br/>
3.  Celebrate your new Orthographic projection.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
4. Drink some beer with themadcelt and Goosey.
<br/>
<br/>
Thanks a lot :D I'll be testing that tonight ^^
<br/>
<br/>
[edit] I wonder why there are no 2D vertex calls in the DS OpenGL function set. I can see how passing one argument less might give a bit more performance(when calling it more often for let's say a GUI implementation).
<br/>
(although I know that I should use display lists when I call glVertex often)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114648 - memoni - Tue Jan 09, 2007 7:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I wonder why there are no 2D vertex calls in the DS OpenGL function set</td> </tr></table><span class="postbody">
<br/>
<br/>
If my memory serves me right... just look how the vertex calls are implemented :) Not sure if the HW requires both the registers to be set, though. You probably should at least initialize z before the first register.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114655 - Vich - Tue Jan 09, 2007 8:51 pm</h4>
    <div class="postbody"><span class="postbody">I think I'll make something like this:
<br/>
#define glVertex2(x, y) glVertex3(x, y, 0)
<br/>
Because that's how it should be and I won't have to reimplement it again if a real 2D call would ever be created.
<br/>
<br/>
glOrtho32f works fine by the way!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115579 - Mr Snowflake - Wed Jan 17, 2007 11:22 am</h4>
    <div class="postbody"><span class="postbody">Why don't you use the bitmap background of the DS. I do understand the engine is a port/should be platform independant, but using this bitmap background on the DS leaves you more vertices for the scene and should be quicker. Also, you don't have to worry about rotating the gui against the scene rotation.<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115580 - Vich - Wed Jan 17, 2007 11:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mr Snowflake wrote:</b></span></td> </tr> <tr> <td class="quote">Why don't you use the bitmap background of the DS. I do understand the engine is a port/should be platform independant, but using this bitmap background on the DS leaves you more vertices for the scene and should be quicker. Also, you don't have to worry about rotating the gui against the scene rotation.</td> </tr></table><span class="postbody">
<br/>
<br/>
How would I manage to draw this over the 3D rendered scene? (let's say: drawing a white 2D quad over a white 3D triangle)
<br/>
Could you provide me a minimalist code sample that does this? I would <span style="font-style: italic">really</span> appreciate that.
<br/>
<br/>
I can easily change my rendering engine for doing different rendering modes(I was planning that anyway) and the 2D drawing calls are put in the base class of the 3D system, so I could separate them also(and implement them differently, like you described).<br/>_________________<br/>[<a class="postlink" href="http://www.lifeisdigital.net" target="_blank">project website</a>] [<a class="postlink" href="http://www.kenvanhoeylandt.net" target="_blank">personal website</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115590 - Mr Snowflake - Wed Jan 17, 2007 5:00 pm</h4>
    <div class="postbody"><span class="postbody">Hehe, I would love to help you, but I don't know how to do this myself :). But according to <a class="postlink" href="http://tobw.net/dswiki/index.php?title=Graphic_modes" target="_blank">DS Wiki</a> every mode on the main screen has 3D with 3 background for different purposes.<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115594 - Vich - Wed Jan 17, 2007 6:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mr Snowflake wrote:</b></span></td> </tr> <tr> <td class="quote">Hehe, I would love to help you, but I don't know how to do this myself :). But according to <a class="postlink" href="http://tobw.net/dswiki/index.php?title=Graphic_modes" target="_blank">DS Wiki</a> every mode on the main screen has 3D with 3 background for different purposes.</td> </tr></table><span class="postbody">
<br/>
<br/>
The problem is that my 2D stuff needs to be on the foreground. But I'll investigate it later, thanks!<br/>_________________<br/>[<a class="postlink" href="http://www.lifeisdigital.net" target="_blank">project website</a>] [<a class="postlink" href="http://www.kenvanhoeylandt.net" target="_blank">personal website</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115596 - Sausage Boy - Wed Jan 17, 2007 6:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The problem is that my 2D stuff needs to be on the foreground.</td> </tr></table><span class="postbody">
<br/>
It's just a matter of changing the priorities. I am pretty sure I did this some time ago and I've seen it in other programs, it's definitely possible.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115679 - Mr Snowflake - Thu Jan 18, 2007 11:04 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The problem is that my 2D stuff needs to be on the foreground. But I'll investigate it later, thanks!</td> </tr></table><span class="postbody">It would be kinda strange to only use the 3 other BG's for skyboxing :).
<br/>
<br/>
Edit: Some strange thingy happened witht the [ quote] opening tag...<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#146541 - a128 - Wed Dec 05, 2007 4:01 pm</h4>
    <div class="postbody"><span class="postbody">This work like expected X=0,Y=0 top left X=255,Y=192 down right
<br/>
<br/>
Edit: currently has a bug, works only for Box(0,0,.......) and the layer seems not to work
<br/>
<br/>
based on code from lumiDS
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">static void perspective2D()
<br/>
{
<br/>
        glMatrixMode(GL_PROJECTION);
<br/>
        glLoadIdentity();
<br/>
<br/>
   glOrtho(0,1,1,0,0,12); //12 layers using int more using float
<br/>
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glLoadIdentity();
<br/>
}
<br/>
<br/>
void Box(int X, int Y, int XMAX,int YMAX,int32 color,int layer)
<br/>
{
<br/>
   glLoadIdentity();
<br/>
   MATRIX_TRANSLATE=inttof32(X);
<br/>
   MATRIX_TRANSLATE=inttof32(Y);
<br/>
   MATRIX_TRANSLATE=inttof32(layer);
<br/>
<br/>
   glScalef((float)XMAX/256,(float)YMAX/192,1);
<br/>
         
<br/>
   glBindTexture(GL_TEXTURE_2D, 0);//no texture
<br/>
<br/>
   glColor(color);
<br/>
<br/>
//translucent
<br/>
   glPolyFmt(POLY_ALPHA(15)  | POLY_CULL_NONE  );
<br/>
<br/>
   glBegin(GL_QUADS);
<br/>
   glVertex3v16(0,0,0);
<br/>
   glVertex3v16(inttof32(1),0,0);
<br/>
   glVertex3v16(inttof32(1),inttof32(1),0);
<br/>
   glVertex3v16(0,inttof32(1),0);
<br/>
   glEnd();
<br/>
<br/>
}    
<br/>
static void draw_box(){
<br/>
<br/>
   Box(0,0,255,10,RGB15(31,0,0),0);
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148866 - a128 - Fri Jan 11, 2008 3:57 pm</h4>
    <div class="postbody"><span class="postbody">Forget the code above...this work like expected 
<br/>
<br/>
use screen coords from 0...255 , 0...191 
<br/>
<br/>
Note: Y ist the depth not Z
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void Box(int X, int Y, int XMAX,int YMAX,int32 color,float layer)
<br/>
{
<br/>
        glLoadIdentity();
<br/>
<br/>
//find the max coord
<br/>
   int32 scale=XMAX&gt;YMAX?inttof32(XMAX):inttof32(YMAX);
<br/>
   scale =divf32(scale,floattof32(7.99f));
<br/>
<br/>
   MATRIX_SCALE=scale;
<br/>
   MATRIX_SCALE=scale;
<br/>
   MATRIX_SCALE=scale;
<br/>
<br/>
   int32 x0=divf32(inttof32(X),scale);
<br/>
   int32 y0=divf32(inttof32(Y),scale);
<br/>
   int32 x1=divf32(inttof32(XMAX),scale);
<br/>
   int32 y1=divf32(inttof32(YMAX),scale);
<br/>
<br/>
       glBindTexture(GL_TEXTURE_2D, 0);//no texture
<br/>
        glColor(color);
<br/>
       glPolyFmt(POLY_ALPHA(31)  | POLY_CULL_NONE  );
<br/>
<br/>
        int32 z=layer; 
<br/>
<br/>
        glBegin(GL_QUADS);
<br/>
        glVertex3v16(x0,y0,z);
<br/>
        glVertex3v16(x1,y0,z);
<br/>
        glVertex3v16(x1,y1,z);
<br/>
        glVertex3v16(x0,y1,z);
<br/>
        glEnd();
<br/>
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
To draw a box in with 2D screen coords
<br/>
<br/>
1) glOrtho(0,256,192,0,-1,1);
<br/>
2) Box(....)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148939 - zefrench - Sat Jan 12, 2008 6:59 am</h4>
    <div class="postbody"><span class="postbody">Perhapse the following librairy does what you are looking for?
<br/>
<br/>
?Library <a class="postlink" href="http://brunni.dev-fr.org/index.php?page=ndssoft_ulib" target="_blank">http://brunni.dev-fr.org/index.php?page=ndssoft_ulib</a>
<br/>
<br/>
Seems like it is along the same area:
<br/>
<br/>
he 3D GPU provides additional effects over the 2D GPU, like full transparency with alpha channel (objects can blend amongst them), a larger number of sprites (up to 1536 instead of 128), no zoom or rotation limit (2x with the 2D GPU), a larger limit for the sprite size (2048x2048 instead of 64x64). It is also possible to draw primitives like lines, rectangles, etc. allowing nice effects like in Yoshi's island for example :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
