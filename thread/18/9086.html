<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Question concerning dmaCopy. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Question concerning dmaCopy.</h2>
<div id="posts">
<div class="post">
    <h4>#77685 - Dark Knight ez - Sun Apr 02, 2006 12:23 pm</h4>
    <div class="postbody"><span class="postbody">Hey all,
<br/>
<br/>
I'm currently using a memcpy to copy a specified amount of bytes to another location. In some topics I noticed that dmaCopy would be a faster way to do the exact same thing, so I tried using that.
<br/>
The memcpy way worked flawlessly (music played), but using dmaCopy instead (and changing nothing else) did not work. Are there some restrictions concerning dmaCopy (for instance, it only working for some memory regions)?
<br/>
<br/>
This was my memcpy code:
<br/>
 memcpy(ptr, music_it + file_pos, items * size);
<br/>
And this what I tried to replace it with:
<br/>
 dmaCopy(music_it + file_pos, ptr, items * size);
<br/>
<br/>
(where size is of type size_t, if that makes any difference)
<br/>
<br/>
Thanks in advance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77748 - waruwaru - Sun Apr 02, 2006 9:46 pm</h4>
    <div class="postbody"><span class="postbody">I think the memory space needs to be aligned on 32 bit boundaries.  There are also some functions to let you check to see if the dma channel is busy or not before you re-use the channel.<br/>_________________<br/><a class="postlink" href="http://www.DSLua.com" target="_blank">DSLua - a scripting language for your DS!</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77757 - HyperHacker - Sun Apr 02, 2006 10:19 pm</h4>
    <div class="postbody"><span class="postbody">FYI, I haven't done any speed tests, but a ldmia/stmia loop should blow even DMA out of the water. These instructions load and store multiple registers at a time. You need one for source, one for destination, and one for count (you can save the stack pointer and return address to RAM), so that leaves 11 registers - 44 bytes copied on each iteration of the loop! (You have to do it in ASM, though.)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
