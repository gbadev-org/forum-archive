<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Corrupted flash cards - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Corrupted flash cards</h2>
<div id="posts">
<div class="post">
    <h4>#155539 - ingramb - Wed Apr 30, 2008 7:55 pm</h4>
    <div class="postbody"><span class="postbody">I'm getting reports that NeoDS has corrupted a few people's flash cards.
<br/>
<br/>
I have modified libfat slightly.  Basically, I keep lookup table that maps file offsets to sectors.  This allows faster seeking without having to walk along all the sectors in the file.  All the changes should be in fatfile.c, and there aren't many.
<br/>
<br/>
Does anyone have any idea of what could be corrupting cards?  Do my modifications sound (or look) dangerous?  Maybe just a buggy dldi driver?  What about if NeoDS crashes with an open file?  Could that cause corruption?
<br/>
<br/>
Any help is appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155541 - Dwedit - Wed Apr 30, 2008 8:43 pm</h4>
    <div class="postbody"><span class="postbody">As long as this is for reads only, it should be okay.  But once the lookup tables no longer match the FAT, you got problems.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155544 - ingramb - Wed Apr 30, 2008 9:06 pm</h4>
    <div class="postbody"><span class="postbody">Yah.  Currently, I never open files for writing.
<br/>
<br/>
In theory, it should be simple to invalidate and recreate the table whenever a file is written to.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155547 - Dwedit - Wed Apr 30, 2008 9:14 pm</h4>
    <div class="postbody"><span class="postbody">Does libfat change file's "last accessed" times?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
