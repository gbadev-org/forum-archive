<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>how to create an archive and get it working with devkitARM.. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > how to create an archive and get it working with devkitARM..</h2>
<div id="posts">
<div class="post">
    <h4>#136221 - troymclure - Mon Jul 30, 2007 8:25 am</h4>
    <div class="postbody"><span class="postbody">i am trying to create a static library for NDS with devkitARM with no success. For instance let's suppose i want an archive with the C function "int increment (int)"
<br/>
then i create the file archive.c like this:
<br/>
<br/>
int increment (int a) {
<br/>
<br/>
return a + 1;
<br/>
}
<br/>
<br/>
so i compile it like this: /home/troymclure/devkitPRO/devkitARM/bin/arm-eabi-gcc 
<br/>
-c archive.c -o archive.o
<br/>
<br/>
then i create the archive like this: /home/troymclure/devkitPRO/devkitARM/bin/arm-eabi-ar  -r archive.a archive.o
<br/>
<br/>
and i got the file archive.a and no errors or warning mesages are issued by arm-eabi-ar and everything looks ok.
<br/>
<br/>
then the problem is to tell to the linker to link my library. under linux i just do something like this: gcc my_main_code.o archive.a -o my_program.out 
<br/>
with devkitARM i have to use a makefile and currently i don't uderstand all the sintax of the makefiles under the libnds examples. i just use the makefile of the example ../Graphics/2D/16bit_color_bmp and i just edit it at my purpose, u know, as a template. could please anyone let me know how to edit this template to make the linker link my archive?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136226 - Ant6n - Mon Jul 30, 2007 9:42 am</h4>
    <div class="postbody"><span class="postbody">where it says,
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
# any extra libraries we wish to link with the project
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBS   := -lnds9 </td> </tr></table><span class="postbody">
<br/>
you could try to add your library there "-archive". lnds9 is actually a file called lnds9.a that's somewhere in devkitarm's directories. so if you add yours there, it should work. You have to put your archive somewhere the linker can find it though (i.e. same directory as makefile or path or something)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136233 - jackman - Mon Jul 30, 2007 11:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">where it says,
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
# any extra libraries we wish to link with the project
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBS   := -lnds9 </td> </tr></table><span class="postbody">
<br/>
you could try to add your library there "-archive". lnds9 is actually a file called lnds9.a that's somewhere in devkitarm's directories. so if you add yours there, it should work. You have to put your archive somewhere the linker can find it though (i.e. same directory as makefile or path or something)</span></td> </tr></table><span class="postbody">
<br/>
thats not right at all, the file ist called <span style="font-weight: bold">libnds9.a</span>, the linker will replace <span style="font-weight: bold">-lnds9</span> with <span style="font-weight: bold">-l libnds9.a</span>, so to include the <span style="font-weight: bold">archive.a</span>, use this command line: <span style="font-weight: bold">-l archive.a</span>
<br/>
complete:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
# any extra libraries we wish to link with the project
<br/>
#---------------------------------------------------------------------------------
<br/>
LIBS   := -lnds9 -l archive.a</td> </tr></table><span class="postbody">
<br/>
you have to copy the archive.a into the /lib directory (not /arm-eabi/lib) of devKitARM<br/>_________________<br/>Equipment:
<br/>
Nintendo DS, GBAMP v2, SuperCard SD, SuperKey, Acekard 2i</span><span class="gensmall"><br/><br/>Last edited by jackman on Mon Jul 30, 2007 11:32 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#136234 - simonjhall - Mon Jul 30, 2007 11:32 am</h4>
    <div class="postbody"><span class="postbody">Don't forget to put the archive in a place searched by the linker (eg the libnds libs directory) or add an extra search directory with -L your_directory_here<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136274 - troymclure - Mon Jul 30, 2007 9:52 pm</h4>
    <div class="postbody"><span class="postbody">ok ... thanks for the help, now i can get the linker to find my library. but the problem is that the linker give me the error: "untefined reference to...". i guess i am doing something wrong on creating the archive, under linux i just compile c code into object file. and then i create the archive like this: ar -r archive.a object.o ... do i have to do anything different here ?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
