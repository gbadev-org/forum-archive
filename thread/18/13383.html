<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How big can my level be? Maximum number of vertices? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > How big can my level be? Maximum number of vertices?</h2>
<div id="posts">
<div class="post">
    <h4>#130819 - Mifheu - Fri Jun 08, 2007 1:55 pm</h4>
    <div class="postbody"><span class="postbody">Hi there. I've just another question about how many polys/vertices can be drawn by the DS:
<br/>
So, I've created al level for a strategy RPG. The stage has around 10000 to 15000 polys and is very big. It's not like a level in Final Fantasy Tactics where the level is only around one screen in size. It's more like in Fire Emblem, where a stage can be several screens in size. Mine is about 6x6 screens. But as the camera is fixed above the level in a quite near distance, there will be only around 500 or 600 polys seen on screen and the player can scroll around with the stylus.
<br/>
My question is, if anybody has tried to do such a big level and if the data for such a big level can be handled by the DS in a was, that works for a game. I know a little bit about the displaylists, but as I'am no programer, I do not know, if there is a easy way to "stream" the leveldata to a displaylist, when the player scrolls through the level and if this could be done fast enough. One solution would be to cut the level in smaller chunks and load them, when the player scrolls near them. But of course it would be easier for the leveldesigners to only create the entire level without the restrictions that may come with these chunks.
<br/>
So, has anybody tried to do a rather complex 3D-Level, which gets "streamed" when the player scrolls around?
<br/>
I would be happy if anybody could help me with some hints, because a the design of the game depends on the bigger size of the stages. Feel free to PM me or whatever. Thanx.<br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130829 - NeX - Fri Jun 08, 2007 4:18 pm</h4>
    <div class="postbody"><span class="postbody">Split it up in whatever you are using, and optimize it as much as possible.  IRRC, the DS has a limit of 6144 vertexes.<br/>_________________<br/><a class="postlink" href="http://www.mediafire.com/?cuyb10fzdz2" target="_blank">Strummer</a> or <a class="postlink" href="http://www.mediafire.com/?71zxcztscix" target="_blank">Drummer?</a>.  
<br/>
Or maybe you would rather play with sand? <a class="postlink" href="http://www.mediafire.com/?a05z5wmdvxm" target="_blank">Sandscape is for you in that case.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130832 - Mifheu - Fri Jun 08, 2007 4:27 pm</h4>
    <div class="postbody"><span class="postbody">Yes, that's right, but as far as I understand, the 6144 vertext limit is the maximum number of vertices, that can be drawn AT ONCE on the screen. I think (or at least I hope), that it is possible to have a level that consists of much more vertices. The question is how to "stream" the data to the display, when the player scrolls to another part of the level. That's what I want to know.<br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130833 - NeX - Fri Jun 08, 2007 4:46 pm</h4>
    <div class="postbody"><span class="postbody">Yes, it is, but it involves drawing the screen multiple times;
<br/>
For double vertex count, you would have a limit of 30fps.
<br/>
For quadruple vertex count, you would have a limit of 15fps.
<br/>
I can imagine how to stream a 2d level, but not 3d.  Maybe a distance check on every polygon in the level?  (WILL BE EXCEEDINGLY SLOW)<br/>_________________<br/><a class="postlink" href="http://www.mediafire.com/?cuyb10fzdz2" target="_blank">Strummer</a> or <a class="postlink" href="http://www.mediafire.com/?71zxcztscix" target="_blank">Drummer?</a>.  
<br/>
Or maybe you would rather play with sand? <a class="postlink" href="http://www.mediafire.com/?a05z5wmdvxm" target="_blank">Sandscape is for you in that case.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130835 - Kamu - Fri Jun 08, 2007 5:04 pm</h4>
    <div class="postbody"><span class="postbody">How about just rendering a certain radius from the character?
<br/>
<br/>
Or perhaps I am an idiot.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130838 - Lick - Fri Jun 08, 2007 5:15 pm</h4>
    <div class="postbody"><span class="postbody">You mean with <span style="font-weight: bold">Occlusion Culling</span> with the <span style="font-weight: bold">Viewing Frustum</span> and an Octree/Quadtree of the 3D map?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130839 - Kamu - Fri Jun 08, 2007 5:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">You mean with <span style="font-weight: bold">Occlusion Culling</span> with the <span style="font-weight: bold">Viewing Frustum</span> and an Octree/Quadtree of the 3D map?</td> </tr></table><span class="postbody">
<br/>
<br/>
Did a quick read up of them and it seems like it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130841 - Mifheu - Fri Jun 08, 2007 5:43 pm</h4>
    <div class="postbody"><span class="postbody">@ Kamu: Yes, there will be only a small part of the level drawn on screen (only around 600 polys will be in the view, but the level is about 10000 to 15000 polys). But you can scroll around.
<br/>
<br/>
@ Lick: As the camera is quite near the level in a isometric view only what is in the view fustrum has to be drawn. Maybe an octree or quadtree would help. But as it is rather 2D (as you can not change the height or the tilt of the camera) I think it could be split up in 2D-Arrays. I'am just wondering, if I can have a big level (with several thousand polygons) in the memory and only draw a small part of it.
<br/>
<br/>
@ NeX: No, I do not want to draw more than 2048 polys in one frame (which would lead to a drop in the fps). I want to have a big level in memory and to be able to scroll around. There would be only 500 to 600 poly on display.
<br/>
<br/>
I try to add two pics:
<br/>
<br/>
<a href="http://www.thepong.net/Stage_Far.jpg" target="_blank">http://www.thepong.net/Stage_Far.jpg</a>
<br/>
<br/>
This is the entire stage (around 10000 to 15000 polys when it's done).
<br/>
<br/>
<a href="http://www.thepong.net/Stage_Near.jpg" target="_blank">http://www.thepong.net/Stage_Near.jpg</a>
<br/>
<br/>
This is, what the player will see. The camera is very near to the level and only a few polygons will be displayed of the entire level.
<br/>
All I want to know, if it is possible to have such a big level in the memory of the DS and if I could still scroll around in this big level with a near camea without any problems. Or if there is not enough memory available or if there are technical limitations which will make it impossible to use such a big level in a game.<br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"><br/><br/>Last edited by Mifheu on Fri Jun 08, 2007 5:47 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#130842 - dannyboy - Fri Jun 08, 2007 5:46 pm</h4>
    <div class="postbody"><span class="postbody">You don't really need to do anything. You can make a level of millions of polygons if you like as long as it fits in memory. When you set things up for drawing using libnds it should only try to draw what's on the screen. If it doesn't work, then what you will have to do is look at the boxtest example.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130843 - Lick - Fri Jun 08, 2007 5:53 pm</h4>
    <div class="postbody"><span class="postbody">The artwork looks promising! ;)
<br/>
<br/>
I would suggest implementing a Quad Tree and render only the quadrants that are visible through the camera.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130844 - Mifheu - Fri Jun 08, 2007 5:53 pm</h4>
    <div class="postbody"><span class="postbody">Ahhhh! Finally! I really started to think my english is to bad to descibe what I need to know. Thanx dannyboy. Is there a rough number, how much memory I can use? I have the feeling that my testlevel really starts to get too big. I'am in the planning stage of this game and I need to know, if the levels can be that detailed. Otherwiese the entire planning of the game will be based on wrong assumptions, which would lead to problems in the production.
<br/>
(Hey, funny thing btw: my (real) name is danny). :)
<br/>
<br/>
@ LicK: Jep, that's the final solution, if anything else fails. BTW, the pics are from a early test, how the stages could be build in a short time. No textures yet. I don't wanna show too much of it, because it's in some sort of preproduction, but here are two early characters (which will not be used in their current form). They are around 1000 Polys (too much) and the textures are too big (256x256). They are for a special fight-screen, not for the normal game. :) Enjoy.
<br/>
<br/>
<a href="http://www.thepong.net/Pose_Screen.jpg" target="_blank">http://www.thepong.net/Pose_Screen.jpg</a><br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130850 - Ant6n - Fri Jun 08, 2007 6:39 pm</h4>
    <div class="postbody"><span class="postbody">Well, memory on the DS is 4 mb. if you want a huge continuous map like yours, you can split up your level into small sectors and display only the ones that are visible. Then you could also take a bunch of sectors and put them in a file each, call it region or so. Then only have a couple of regions sorrounding the player be in memory, and as you move around, you can slowly load the adjacent regions from ROM or flashcard storage.
<br/>
I think San Andreas might have done something like that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130864 - dannyboy - Fri Jun 08, 2007 8:29 pm</h4>
    <div class="postbody"><span class="postbody">There are two issues getting a bit mixed up here. I'm a bit of a hack, but here's my explanation.
<br/>
<br/>
Let's start by defining a polygon. Let's assume it is a triangle, so it consists of 3 vertices(corners). Each vertex consists of a position, normal and texture coordinate. Position and normal are defined with an x,y,z coordinate and texture consists of u,v. Let's be wasteful and use 4 byte integers to define the x,y,z,u,v.
<br/>
<br/>
A vertex thus has 8 integers, and a triangle will thus have 24 integers, or 96 bytes per polygon. 15,000 polygons will thus take 144,0000 bytes or 1.373 Megabytes out of the 4 Megabytes of VRAM available.
<br/>
<br/>
So let's assume you have one 15,000 polygon model for your level.  You pass it to your DS to draw. There's two possibilities:
<br/>
1) The DS only has enough memory to draw 2000 polygons but more than that are on screen. Basically, it won't work.
<br/>
2) Only 500 polygons are actually on the screen(this is your case). In this case your DS will go through your 15,000 model and draw the 500 that should be visible, the other 14,500 it will skip. Result being it works.
<br/>
<br/>
However, there is a problem. You are asking your DS to go through 15,000 polygons and work out which to draw and which to skip. So although it will work, it will be very slow. So what you have to do is break your single model of the level into many parts. Say you make 150 parts of 100 polygons each. You can then check which parts are to try and draw.
<br/>
<br/>
So what happens is you do 150 checks yourself in software, for the parts. You end up with say 20 parts that are partly visible. You then check these parts and draw the polygons.
<br/>
<br/>
So what you end up with is:
<br/>
150 software checks for which parts are visible.
<br/>
20 * 100 = 2000 hardware checks for which polygons are visible.
<br/>
Total 2150 checks. That compares with 15,000 checks in the case of a single 15,000 polygon model.
<br/>
<br/>
As for how much memory to use. That's up to you. You can use the entire 4 Megs for polygons if you want, but that would of course not leave space for anything else. But the thing is, you can load and delete things as you move around the level although that does that up processor time and also depends on the cartridge speed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130865 - Rajveer - Fri Jun 08, 2007 8:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dannyboy wrote:</b></span></td> </tr> <tr> <td class="quote">So what you have to do is break your single model of the level into many parts. Say you make 150 parts of 100 polygons each. You can then check which parts are to try and draw.
<br/>
<br/>
So what happens is you do 150 checks yourself in software, for the parts. You end up with say 20 parts that are partly visible. You then check these parts and draw the polygons.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Why can he not keep his level as a whole model, keeping the list of all of his polygons as it is now, and then create a separate data structure (quadtree) which points to relevant polygons? The quadtree will be built during the load process and will split the relevant level and store a pointer to each relevant polygon for each node, and will work for all level models, so you can have as many polygons as you want. This way level building will be easier as the split will occur automatically during the load process, and will work for any number of polygons.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130867 - dannyboy - Fri Jun 08, 2007 8:49 pm</h4>
    <div class="postbody"><span class="postbody">What you are describing is just one of the ways to implement what I have said.
<br/>
<br/>
But to get more specific. There's many ways to approach this. The simplest way(from a programmers view) is for the artists to make their 3D models. After they have made their models, they can then manually go through the models and detach them into smaller parts. The artists can then give these parts along with a postion for each part to the programmer. The programmer can then implement a simple distance check for each part.
<br/>
<br/>
I don't really see why this approach would limit the artists in any way, it would simple ask a bit more of their time. And of course, you can experiment with the size of the chunks. If you start with 10,000 polys for the stage and just break it into 10 parts you get 1,000 polygons for each part. If you have 100 parts you get 100 polygons per part. Detaching even 100 parts wouldn't be that much work in the context of 10,000 polygons having been created.
<br/>
<br/>
Alternatively, if you want to leave it to the programmer, they can instead implement a octree or some other form of culling.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130880 - Ant6n - Fri Jun 08, 2007 11:31 pm</h4>
    <div class="postbody"><span class="postbody">yeah, why shouldn't the artist build structures like BSP trees himself? i mean, he's getting paid for it, better use the time to do something a computer could do in a couple of minutes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130882 - Lick - Fri Jun 08, 2007 11:46 pm</h4>
    <div class="postbody"><span class="postbody">dannyboy, 'breaking' the 15000 polygons into smaller groups is EXACTLY what an quadtree is for. And beyond that, there is absolutely no need to even store such a ridiculously detailed resolution in the final build.
<br/>
<br/>
My advice: reduce the polycount to one that suits the screens resolution (more detailed will go unnoticed), then let the quadtree handle the rest.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130892 - dannyboy - Sat Jun 09, 2007 1:27 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">dannyboy, 'breaking' the 15000 polygons into smaller groups is EXACTLY what an quadtree is for. </td> </tr></table><span class="postbody">
<br/>
I already said that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">And beyond that, there is absolutely no need to even store such a ridiculously detailed resolution in the final build. </td> </tr></table><span class="postbody">
<br/>
What? He said 15K polys total, with around 500 viewable at a time. That's hardly ridiculous.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">yeah, why shouldn't the artist build structures like BSP trees himself? i mean, he's getting paid for it, better use the time to do something a computer could do in a couple of minutes.</td> </tr></table><span class="postbody">
<br/>
Yes, because computers can write code for themselves and then execute it.
<br/>
<br/>
What you fail to take into account is that coding an octree or other such structure takes time and a programmer that can do the job. Assuming he's got the programmer that can make an octree, if it takes a couple of hours to code the octree and debug it, but only takes 20 minutes for an artist to break up a level into 10 pieces say, then maybe for this particular project that would be better to let the artists handle it. Sure he doesn't have reusable code for future projects, but I'm just giving him some options.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130895 - Rajveer - Sat Jun 09, 2007 2:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dannyboy wrote:</b></span></td> </tr> <tr> <td class="quote">What you fail to take into account is that coding an octree or other such structure takes time and a programmer that can do the job. Assuming he's got the programmer that can make an octree, if it takes a couple of hours to code the octree and debug it, but only takes 20 minutes for an artist to break up a level into 10 pieces say, then maybe for this particular project that would be better to let the artists handle it. Sure he doesn't have reusable code for future projects, but I'm just giving him some options.</td> </tr></table><span class="postbody">
<br/>
<br/>
The problem with your method is that for each and every map, each modification to maps during testing, each new map to be added e.t.c. the artist will have to break up the level into smaller pieces which may accumulate to alot of time and effort in the long run. By programming a tree structure, the process will be programmed once, debugged (if necessary), and that will be the end of it. A tree structure isn't very hard to program, and if the OP has a programmer for the project who can't even program such a structure then this isn't the biggest problem he will have.
<br/>
<br/>
Of course, if the OP wants to only have a few maps, say 1-3, then your method will be more beneficial to them, for any more levels I believe it's worth programming a quadtree for future maps and renditions of maps, as it will make including more levels extremely simple, just plug it in and let the DS sort it out during level loading (and it shouldn't take more than a few seconds MAX).
<br/>
<br/>
All in all there is no "right" way to do it and the OP should choose whichever method is best suited to them. Dannyboy's suggestion is great if you're only using a few maps as it cuts out alot of programming time. Good luck!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130900 - Ant6n - Sat Jun 09, 2007 2:45 am</h4>
    <div class="postbody"><span class="postbody">if there are no programming resources to get some quadtree working, a 2d array of sectors as suggested earlier should be pretty simple to implement, and would do the job very nicely for a top down view on landscape kinda game.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130920 - tepples - Sat Jun 09, 2007 5:37 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Rajveer wrote:</b></span></td> </tr> <tr> <td class="quote">The problem with your method is that for each and every map, each modification to maps during testing, each new map to be added e.t.c. the artist will have to break up the level into smaller pieces which may accumulate to alot of time and effort in the long run.</td> </tr></table><span class="postbody">
<br/>
If the "pieces" can have a meaning connected to the semantics, such as a piece called "courtyard", a piece called "mezzanine", etc., then splitting a level might not be so hard for an artist.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">a 2d array of sectors as suggested earlier should be pretty simple to implement, and would do the job very nicely for a top down view on landscape kinda game.</td> </tr></table><span class="postbody">
<br/>
At least it worked for <span style="font-style: italic">Animal Crossing: Wild World</span>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131112 - Jhiant - Mon Jun 11, 2007 8:50 am</h4>
    <div class="postbody"><span class="postbody">Hi gang. Just joining this discussion and asking some similar questions for my own projects. I am a programmer who has a decent amount of experience with some of this stuff, so hope this is helpful.
<br/>
<br/>
I have two major comments. First, dannyboy has missed his calculations slightly and this is good news for us all. He's got the correct mindset though for approaching this kind of problem, so others should emulate him there. Second, regarding occlusion algorithms, the best fit for this problem is likely a simple tile approach as suggested by Ant6n and others (a 2d array of sectors.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dannyboy wrote:</b></span></td> </tr> <tr> <td class="quote">Let's start by defining a polygon. Let's assume it is a triangle, so it consists of 3 vertices(corners). Each vertex consists of a position, normal and texture coordinate. Position and normal are defined with an x,y,z coordinate and texture consists of u,v. Let's be wasteful and use 4 byte integers to define the x,y,z,u,v.
<br/>
<br/>
A vertex thus has 8 integers, and a triangle will thus have 24 integers, or 96 bytes per polygon. 15,000 polygons will thus take 144,0000 bytes or 1.373 Megabytes out of the 4 Megabytes of VRAM available.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ok, here is the good news. You don't have to replicate vertices three times for each triangle. This is exactly what a tristrip (GL_TRIANGLE_STRIP) is for. There is a little overhead for degenerate triangles, but essentially, the number of triangles and number of vertices is about the same.
<br/>
<br/>
So for the wasteful approach suggested, each vertex is 32 bytes: 3 values for position, 2 for uv's, and 3 more for normal. That is 8 values which are each 4 bytes which is 32 bytes. This can be "packed" and lots of tricks can be done here to reduce memory, but that is not necessary because first just make sure you use a tristrip.
<br/>
<br/>
So for 15,000 poly's (is that tri's or quads, since many modelling programs put this out as quads) at 32 bytes each, that is only 480,000 bytes. So that fits in memory fine.
<br/>
<br/>
For splitting it up, you probably want a 2d array of sectors, or tiles, if you're looking from the top down. In order to get the tristrips to work, these need to be broken up ahead of time. You should do this via a tool if possible. Then it is a simple process of finding a set of tiles that are near your camera position and rendering those based on what is visible.
<br/>
<br/>
Because your camera is top down and fixed size, you can probably tune your tile size to be about the size of one screen. Then you can load just a section of 9 tiles (the one the character is in, and the 8 surrounding tiles) and do it this way. This is much simpler than per poly occlusion.
<br/>
<br/>
If your world gets much bigger than the initial 15k polys, you may have to come up with a streaming solution, but that is just another level of the tile idea loading from ROM.
<br/>
<br/>
Again, it is going to be key that you have those tiles broken up before they are tristripped. It looks to me almost like you are modelling the world with a height map, though, since all the poly's are even. So this looks like it could be straightforward.
<br/>
<br/>
Good luck.<br/>_________________<br/>Occam's Razor: All things being equal, the simplest solution tends to be the best one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131118 - Mifheu - Mon Jun 11, 2007 9:38 am</h4>
    <div class="postbody"><span class="postbody">Whoa! Just two days off and then there's lots and lots of interesting replies! Thanx alot guys! That's even more than I wanted to know.
<br/>
I already thought about splitting up my levels to have a 2D array check, what is visible and then render only that stuff. Of course this should be done by a tool (on load) or a plug in (after the level is build). As there are about 30+ stages planned for the game it is not possible to let the artists do that. It would be a pain in the a** when the artists have to rework some parts of the level, and they would need to split the level up again and again. That would take too much time.<br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162726 - mreaves - Thu Sep 11, 2008 6:48 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dannyboy wrote:</b></span></td> </tr> <tr> <td class="quote">There are two issues getting a bit mixed up here. I'm a bit of a hack, but here's my explanation.
<br/>
<br/>
Let's start by defining a polygon. Let's assume it is a triangle, so it consists of 3 vertices(corners). Each vertex consists of a position, normal and texture coordinate. Position and normal are defined with an x,y,z coordinate and texture consists of u,v. Let's be wasteful and use 4 byte integers to define the x,y,z,u,v.
<br/>
<br/>
A vertex thus has 8 integers, and a triangle will thus have 24 integers, or 96 bytes per polygon. 15,000 polygons will thus take 144,0000 bytes or 1.373 Megabytes out of the 4 Megabytes of VRAM available.
<br/>
<br/>
So let's assume you have one 15,000 polygon model for your level.  You pass it to your DS to draw. There's two possibilities:
<br/>
1) The DS only has enough memory to draw 2000 polygons but more than that are on screen. Basically, it won't work.
<br/>
2) Only 500 polygons are actually on the screen(this is your case). In this case your DS will go through your 15,000 model and draw the 500 that should be visible, the other 14,500 it will skip. Result being it works.
<br/>
<br/>
However, there is a problem. You are asking your DS to go through 15,000 polygons and work out which to draw and which to skip. So although it will work, it will be very slow. So what you have to do is break your single model of the level into many parts. Say you make 150 parts of 100 polygons each. You can then check which parts are to try and draw.
<br/>
<br/>
So what happens is you do 150 checks yourself in software, for the parts. You end up with say 20 parts that are partly visible. You then check these parts and draw the polygons.
<br/>
<br/>
So what you end up with is:
<br/>
150 software checks for which parts are visible.
<br/>
20 * 100 = 2000 hardware checks for which polygons are visible.
<br/>
Total 2150 checks. That compares with 15,000 checks in the case of a single 15,000 polygon model.
<br/>
<br/>
As for how much memory to use. That's up to you. You can use the entire 4 Megs for polygons if you want, but that would of course not leave space for anything else. But the thing is, you can load and delete things as you move around the level although that does that up processor time and also depends on the cartridge speed.</td> </tr></table><span class="postbody">
<br/>
<br/>
I do think your math is a little off there RE level size in K's. You are looking at around 20 bytes per vertex, and only the polys have a normal, not each vertex, so that gets a triangle down to around 72 bytes (66 if the normal is an fx16 type). You then assume that 15,000 triangles equals 45,000 verts. With stripping that should be far, far less. Add in some quads and your level size (for geometry) is nowhere near 1.3meg.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162731 - tepples - Thu Sep 11, 2008 1:04 pm</h4>
    <div class="postbody"><span class="postbody">In fact, I've seen Quake 1 compress each normal to 1 byte by rounding it to one of about 220 points on the surface of an icosahedron. Look up "anorms.h".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162732 - TwentySeven - Thu Sep 11, 2008 1:06 pm</h4>
    <div class="postbody"><span class="postbody">Plus the DS can stream about 4k a frame (240k a sec) off a average sort of flash cart.
<br/>
<br/>
So in theory, as long as you don't let the camera move too fast your level sizes could be much much larger then 4mb.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162735 - sgeos - Thu Sep 11, 2008 3:04 pm</h4>
    <div class="postbody"><span class="postbody">You could pack level size with an object oriented level design, although that would require custom encoding tools, and would not work for every kind of game.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162741 - Miked0801 - Thu Sep 11, 2008 6:25 pm</h4>
    <div class="postbody"><span class="postbody">Make your tiles slightly larger than 1 screen size and you only need to hold 4.  Make them much smaller than screen size and you will save memory, but will load more often.  Making the tiles exactly the screen size is probably about as wasteful a size as could be picked. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162782 - Synthetic - Fri Sep 12, 2008 8:36 pm</h4>
    <div class="postbody"><span class="postbody">Could you repost the screenshots?  I'm interested in seeing what you have but thepong.net is down =P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163008 - Mifheu - Thu Sep 18, 2008 2:30 pm</h4>
    <div class="postbody"><span class="postbody">@ synthetic: Ah, now I know, what you meant with your message, about the site being down. Yes, thepong.net is down, but I started another site with some concepts, artworks, gamedesigns and other infos. I also reposted the sceenshots from the strategy RPG I'am doing concepts for. You can find all informations under Projects/Eternal Circle.
<br/>
Under Stages you'll find the two old screenshots and a new one with the final mesh for the teststage.
<br/>
I hope I will be able to do some updates, as soon as the project I'am working on in "real life" is finished.
<br/>
<br/>
Just visit: <a href="http://www.aemuse.com" target="_blank">www.aemuse.com</a><br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
