<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Getting code onto the ds via wifi (and some debug DS info) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Getting code onto the ds via wifi (and some debug DS info)</h2>
<div id="posts">
<div class="post">
    <h4>#26060 - monkeywit - Mon Sep 06, 2004 1:28 am</h4>
    <div class="postbody"><span class="postbody">I remember someone posting information on a debug DS (the took one home from motorola), it had the option to recieve a binary via wifi. I know the GBA had 256k of memory, how much does the DS have? I think that this is the only way we will be able to run code  for a while...
<br/>
<br/>
    I also remember it had AGB mode (where you could pick what screen you wanted it to show on). It also had a touch screen configuration utility. It had owner information that you could input with the stylus. The kid had pictures but he had to take them down after someone pointed out his dad could get in a ton of trouble.
<br/>
<br/>
    The debug menu just a black background with white text. He said that when the system turned on little japanese kids  laughed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26061 - tepples - Mon Sep 06, 2004 3:26 am</h4>
    <div class="postbody"><span class="postbody">In GBA mode, the DS will probably have 256 KB of RAM. In DS mode, I'll conjecture that Nintendo learned from the MBV2 and F2A linkers, both of which can dump a commercial GBA Game Pak through the link port. Watch Nintendo put stronger challenge-response authentication into the DS multiboot protocol.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26069 - ampz - Mon Sep 06, 2004 6:22 pm</h4>
    <div class="postbody"><span class="postbody">They also probably learned from the GC to not leave any holes in their encryption.
<br/>
So, the carts will most likely be encrypted (and hard to break).
<br/>
The wifi multiboot will definitely be encrypted.
<br/>
The BIOS will be either internal to the DS ASIC like in the GBA, or external and encrypted like the GC (but with no holes).
<br/>
<br/>
The only thing that cannot be encrypted is the main memory bus. However, the main memory bus operates at very high speeds, and is about 100 lines wide.
<br/>
<br/>
Unless N choose not to encrypt one of the three things above, or they leave some hole in the encryption, getting code to run on the DS will be very hard.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26093 - SmileyDude - Tue Sep 07, 2004 7:05 pm</h4>
    <div class="postbody"><span class="postbody">well, Nintendo hasn't really had much of a good track record with protecting it's handheld devices from "unauthorised" code.  Take the protection scheme of the GBA -- checking for the presence of the Nintendo logo in the cart header.  It is almost exactly the same as the protection scheme for the orginal GB.  The only difference is that the logo was changed.
<br/>
<br/>
I can see where Nintendo might keep the protection scheme for the GB unchanged through the years -- you have backwards compatibility to worry about.  But, not changing it on the GBA implies to me that there was another reason as to why it didn't change.
<br/>
<br/>
Of course, the long time Nintendo watchers will remember that the original NES had the lockout chip.  Why Nintendo didn't do something similar with the GB is another mystery.  Maybe they didn't want any more legal headaches at the time the GB was coming out.
<br/>
<br/>
My personal theory is that with the GB/GBC/GBA line, Nintendo actually wanted some level of homebrew activity.  Otherwise, they simply would've done something like Atari did with the 7800.  It took a damn long time for that scheme to be broken, and if I recall correctly, it was aided by someone finding original development kit floppies with the encryption program on it.
<br/>
<br/>
So, why would Nintendo want homebrew on the handhelds but not the consoles?  Maybe in part because the handhelds are already a generation or two behind, or maybe because they don't feel threatened on the handheld side of things.  Who knows?  Maybe it was simply a mistake that they regret now.
<br/>
<br/>
Anyway, back to the DS -- if they do happen to implement encryption as a way to authenticate the game, that will only affect homebrew and un-authorised 3rd-party games.  The pirates will simply copy the whole game, encryption and all.  Here's hoping that Nintendo will stick with what's worked in the past for them, and we won't have any trouble getting code onto the DS.<br/>_________________<br/>dennis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26094 - tepples - Tue Sep 07, 2004 7:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote">The pirates will simply copy the whole game, encryption and all.</td> </tr></table><span class="postbody">
<br/>
Not if the encryption involves a challenge and response.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26096 - ampz - Tue Sep 07, 2004 8:09 pm</h4>
    <div class="postbody"><span class="postbody">Well, it is not possible to enrypt the linearly adressed GBA carts without adding rather complicated hardware to both the GBA and the carts, and Nintendo are smart enough not to try something like that.
<br/>
<br/>
The DS carts however are block adressed. It is straightforward to encrypt thoose.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26111 - SmileyDude - Wed Sep 08, 2004 1:47 am</h4>
    <div class="postbody"><span class="postbody">It depends on what the encryption is used for -- if it's used for authentication of the code, then encrypting the header with a private key and using a public key for the authentication would be suitable enough.
<br/>
<br/>
If the goal is to protect the game from copying, that you are correct with a linear addressing scheme, the encryption would require hardware on both ends.  With a block model, you wouldn't need for the data to be encrypted -- just some sort of secret handshake between the storage media and the system before the media would give up it's secrets.  I suppose for extra security the data could be encrypted, and the key could be stored in ROM on the custom chip for the DS.  This would be hard to near impossible to break currently since there would be no decrypted data to sniff.
<br/>
<br/>
If there is a secret handshake and the data isn't encrpyted coming out of the media, it stands to reason that at some point somebody will snoop the bus between the DS and the media to figure out what the handshake is.  It might be impractical right now, but it's certainly not in the realm of impossibility.
<br/>
<br/>
I think the more promising possibility is the WiFI component of the DS -- which is what the original post was alluding to.  Much easier to sniff that data.  If it's compressed, there will still be the issue of trying to figure out what the public/private key pair is, but considering that we have a fairly good idea of what the data should look like (ARM instruction codes), it may be crackable.
<br/>
<br/>
Anyway, this is all speculation at this point.  We'll see in a few months when the thing actually comes out :)<br/>_________________<br/>dennis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26113 - SmileyDude - Wed Sep 08, 2004 1:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">The BIOS will be either internal to the DS ASIC like in the GBA, or external and encrypted like the GC (but with no holes).</td> </tr></table><span class="postbody">
<br/>
<br/>
Hasn't the BIOS for the GC been dumped?  And of course, the GBA's BIOS has been dumped as well.  About the only BIOS in a Nintendo product that hasn't been dumped is the original GB/GBC BIOS.
<br/>
<br/>
If the BIOS provides routines to the programmer, there is most likely going to be some way of exploiting bugs in that BIOS to dump it.  Unless Nintendo has somehow mastered the art of writing bug free software.<br/>_________________<br/>dennis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26122 - ampz - Wed Sep 08, 2004 11:13 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote">I think the more promising possibility is the WiFI component of the DS -- which is what the original post was alluding to.  Much easier to sniff that data.  If it's compressed, there will still be the issue of trying to figure out what the public/private key pair is, but considering that we have a fairly good idea of what the data should look like (ARM instruction codes), it may be crackable.</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't think sniffing wifi data will be very easy. Remember: Proprietary Nintendo protocol. Not 802.11.
<br/>
I think the wifi is also the interface likely to have the strongest encryption.
<br/>
Why would it be easier to sniff wifi data than the cart bus? Sniffing the cart bus is pretty easy.
<br/>
Oh, and ARM instruction codes will only be transmitted over wifi in case of a multiboot type of game. I have not yet seen such a game.
<br/>
And even in the case of a multiboot, the bulk of the data will be graphics and audio. Not ARM instructions. Not that knowing that ARM instruction are transmitted would help very much... There are alot of valid ARM instructions.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">The BIOS will be either internal to the DS ASIC like in the GBA, or external and encrypted like the GC (but with no holes).</td> </tr></table><span class="postbody">
<br/>
<br/>
Hasn't the BIOS for the GC been dumped?  And of course, the GBA's BIOS has been dumped as well.  About the only BIOS in a Nintendo product that hasn't been dumped is the original GB/GBC BIOS.
<br/>
<br/>
If the BIOS provides routines to the programmer, there is most likely going to be some way of exploiting bugs in that BIOS to dump it.  Unless Nintendo has somehow mastered the art of writing bug free software.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, the GC BIOS was dumped, due to a security hole found in the hardware/encryption.
<br/>
<br/>
In order to dump the GBA BIOS you must first be able to run code on the GBA, and that's kind of the reason why we want BIOS-access on the DS in the first place. We don't primarily want to dump the DS BIOS. We want to replace it with our own code, as a way in into the system. Of course, dumping the BIOS might help crack any wifi or cart encryption unless it is in hardware.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26130 - NoMis - Wed Sep 08, 2004 1:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SmileyDude wrote:</b></span></td> </tr> <tr> <td class="quote">I think the more promising possibility is the WiFI component of the DS -- which is what the original post was alluding to.  Much easier to sniff that data.  If it's compressed, there will still be the issue of trying to figure out what the public/private key pair is, but considering that we have a fairly good idea of what the data should look like (ARM instruction codes), it may be crackable.</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't think sniffing wifi data will be very easy. Remember: Proprietary Nintendo protocol. Not 802.11.
<br/>
I think the wifi is also the interface likely to have the strongest encryption.
<br/>
Why would it be easier to sniff wifi data than the cart bus? Sniffing the cart bus is pretty easy.
<br/>
Oh, and ARM instruction codes will only be transmitted over wifi in case of a multiboot type of game. I have not yet seen such a game.
<br/>
And even in the case of a multiboot, the bulk of the data will be graphics and audio. Not ARM instructions. Not that knowing that ARM instruction are transmitted would help very much... There are alot of valid ARM instructions.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
The thing that makes it easier is the way wifi works. It's all send out into the air and you can easily recive the signals. 
<br/>
WLAN's for example are pretty easy to hack. You just have to "listen" long enough to collect enought data to hack it. 
<br/>
<br/>
NoMis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26146 - keldon - Wed Sep 08, 2004 2:51 pm</h4>
    <div class="postbody"><span class="postbody">In regards to Nintendo placing their graphic on each cartridge - I think it has little to do with STOPPING people from being able to produce a cart. It would have more to do with being able to take mass copyright infringers to court as the law still has not caught up with computer related crime.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26150 - tepples - Wed Sep 08, 2004 4:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">In regards to Nintendo placing their graphic on each cartridge - I think it has little to do with STOPPING people from being able to produce a cart.</td> </tr></table><span class="postbody">
<br/>
In that case, it's pointless. <span style="font-style: italic">Sega v. Accolade</span>.
<br/>
<br/>
The only thing the header check is good for is verifying lack of dirt on the data bus.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26151 - keldon - Wed Sep 08, 2004 4:54 pm</h4>
    <div class="postbody"><span class="postbody">I meant if someone's mass producing pirate games then Nintendo can take them to court rather than the manufacturers who made them.
<br/>
<br/>
It also means that Nintendo do not have to buy the copyright, they already have it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26154 - ampz - Wed Sep 08, 2004 5:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>NoMis wrote:</b></span></td> </tr> <tr> <td class="quote">The thing that makes it easier is the way wifi works. It's all send out into the air and you can easily recive the signals. 
<br/>
WLAN's for example are pretty easy to hack. You just have to "listen" long enough to collect enought data to hack it. 
<br/>
<br/>
NoMis</td> </tr></table><span class="postbody">
<br/>
As I said: Proprietary Nintendo protocol. Not 802.11 (WLAN).
<br/>
Since we don't know the protocol, it will take some work to figure it out. There is a chance a standard WLAN adapter might not even pick up the transmissions.
<br/>
<br/>
In order to tap data from the cart bus you simply open up the DS and solder 16 wires to the cart connector. Hook up theese wires to a decent logic analyzer, or if you are on a budget: a PC connected FPGA, and dump the data to a file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26155 - ampz - Wed Sep 08, 2004 5:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">It also means that Nintendo do not have to buy the copyright, they already have it.</td> </tr></table><span class="postbody">
<br/>
Buy the copyright? From who?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26161 - dagamer34 - Wed Sep 08, 2004 6:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">It also means that Nintendo do not have to buy the copyright, they already have it.</td> </tr></table><span class="postbody">
<br/>
Buy the copyright? From who?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Pay the U.S. Patent Office to reserve the copyright for Nintendo as a company so that they can sue any violators (or so I think...)<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26162 - ampz - Wed Sep 08, 2004 7:08 pm</h4>
    <div class="postbody"><span class="postbody">You don't pay anyone for the copyright on your own material.
<br/>
(There might be some exceptions I don't know in some countries)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26164 - tepples - Wed Sep 08, 2004 7:33 pm</h4>
    <div class="postbody"><span class="postbody">Patents are not copyrights. Patents cost money to get, as the patent office has to review your claims to make sure they don't read on prior art before issuing the patent. Copyrights cost money to <span style="font-style: italic">register</span> in some countries; registration prior to an alleged infringement typically buys the copyright owner additional rights in court.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26179 - Abscissa - Wed Sep 08, 2004 10:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">as the patent office has to review your claims to make sure they don't read on prior art before issuing the patent.</td> </tr></table><span class="postbody">
<br/>
<br/>
Not that they usually do that anyway ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26624 - logotomie - Tue Sep 21, 2004 1:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">In regards to Nintendo placing their graphic on each cartridge - I think it has little to do with STOPPING people from being able to produce a cart.</td> </tr></table><span class="postbody">
<br/>
<br/>
In that case, it's pointless. <span style="font-style: italic">Sega v. Accolade</span>.
<br/>
<br/>
The only thing the header check is good for is verifying lack of dirt on the data bus.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
No, you are wrong. Sega vs. Accolade is exactly what they try to avoid by using the logo.  For Sega vs. Accolade the court decided that reverse engineering code and using functionality is legal. But in order to create a working GBA cart you have to copy a work of art/copy a protected logo. This is definitely illegal.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26636 - tepples - Tue Sep 21, 2004 6:17 pm</h4>
    <div class="postbody"><span class="postbody">Part of <span style="font-style: italic">Sega v. Accolade</span> is that it's considered fair use to copy that magic cookie. One of the <a class="postlink" href="http://www4.law.cornell.edu/uscode/17/107.html" target="_blank">four main factors</a> that a judge will use when distinguishing infringement from fair use is "the amount and substantiality of the portion used in relation to the copyrighted work as a whole." Given that the 156-byte magic cookie data makes up only about 0.004 percent of the first work that contained it (that is, Super Mario Advance), I can see how the question of fair use would swing strongly in the unlicensed game maker's favor.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26643 - SmileyDude - Tue Sep 21, 2004 9:49 pm</h4>
    <div class="postbody"><span class="postbody">Not only is the logo data a insignificant portion of the original work,  I believe there is a provision in US Trademark law that states that if a trademark is used as a barrier to competition that the trademark can be revoked from the owner.
<br/>
<br/>
So, in this case, Nintendo is using their trademark to prevent others from competing in the market of making GameBoy Advance games.  The only way, in Nintendo's view, to sell games for the GameBoy is to license their trademark from them.
<br/>
<br/>
This is different from the issue of using Nintendo's trademark in association with your own game.  You can't run code on the GBA without using their trademark.
<br/>
<br/>
I wish I could find the specific reference in the law, but I really suck at looking at things like this :(<br/>_________________<br/>dennis</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26652 - ampz - Tue Sep 21, 2004 11:48 pm</h4>
    <div class="postbody"><span class="postbody">In the Sega v. Accolade case, there were no copied logotype or anything.
<br/>
The magic cookie consisted of only 4 bytes: "SEGA" encoded as a 32bit number. This does not constitute a "work of art", and it can even be easily argued that the 32bit number have nothing to do with the word SEGA since it is never displayed.
<br/>
So the Sega v. Accolade case have little impact on the Nintendo header problem.
<br/>
I think the main thing in the Sega v. Accolade case were that when you booted the game, it says something like "Developed with a licence from SEGA". This text was displayed by the BIOS.
<br/>
<br/>
I think we all know the situation perfectly.
<br/>
Nintendo are on shaky legal grounds if they try to protect their platform against 3rd party developers using the header. But so are we if we try to release a game on our own.
<br/>
But even if Nintendo are proven wrong in the end, they can still give you hell with several years in court, preventing you from selling your game(s) during the process, and causing you to go bankrupt.
<br/>
<br/>
The law is different in different countries. Perhaps nintendo loose in one country, there is nothing preventing them from trying again in another country.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
