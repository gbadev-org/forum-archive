<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems playing .raw - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Problems playing .raw</h2>
<div id="posts">
<div class="post">
    <h4>#58187 - inferno - Fri Oct 21, 2005 3:51 pm</h4>
    <div class="postbody"><span class="postbody">Hi all!
<br/>
<br/>
I suppose this question must have been asked several times before but searching this forum didn't really help me, so:
<br/>
<br/>
While converting my .wav to .raw and playing it on my DS (using the GBFS) the only thing I hear is white noise :O. The file itself is a 44100hz mono 16bit pcm file (from the top of my head)... Why is it screwed up once I play it?
<br/>
What programs do you use for saving and editing .wav? Audacity is a great program, but if it continues giving these errors once converted to raw, I really must look at using another program.
<br/>
<br/>
Thanks in advance!<br/>_________________<br/>The absurdest thing I've ever heard is that this world is not absurd.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58190 - Onori - Fri Oct 21, 2005 3:54 pm</h4>
    <div class="postbody"><span class="postbody">the file must be in signed form, wav file are unsigned :/
<br/>
<br/>
I use this function to convert on the DS:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void  ConvertUnsignedToSigned(u8 *buf, u16 taille)
<br/>
{
<br/>
  while (taille--)
<br/>
  {
<br/>
    *buf = (*buf) - 128;
<br/>
    buf++;
<br/>
  }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
and to play file I use:
<br/>
#define PLAY_SOUND(_A_)	playGenericSound(_A_, sizeof(_A_))
<br/>
<br/>
but it must be in 8bits mono 11025Hz</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58195 - inferno - Fri Oct 21, 2005 4:03 pm</h4>
    <div class="postbody"><span class="postbody">I use sox to convert it, but it still doesn't work. I've seen demos running 44100hz, though.<br/>_________________<br/>The absurdest thing I've ever heard is that this world is not absurd.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58197 - inferno - Fri Oct 21, 2005 4:09 pm</h4>
    <div class="postbody"><span class="postbody">I'm referring to the Tickle Girl demo btw.. I'll post some code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">static SoundFile soundFiles[] = {
<br/>
{ "bgm.raw", "BGM", 22050, 0, 0 }
<br/>
   { 0,0,0,0,0 }
<br/>
};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
To declare the background music and other sfx
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
static uint8* sound_buffer = 0;
<br/>
static uint8* bgm_buffer = 0;
<br/>
static SoundFile* current_sound_file = 0;
<br/>
static unsigned int current_sound_channel = 0;</td> </tr></table><span class="postbody">
<br/>
<br/>
buffers etc. and more code not relevant atm
<br/>
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  current_sound_file = &amp;soundFiles[SFX_BGM];
<br/>
  dmaCopy(current_sound_file-&gt;data, bgm_buffer, current_sound_file-&gt;length);
<br/>
  CommandPlaySampleLoop(current_sound_channel, current_sound_file-&gt;frequency, bgm_buffer, current_sound_file-&gt;length, 0x7F);
<br/>
  // switch to next channel to allow SFX to play over BGM
<br/>
  ++current_sound_channel;</td> </tr></table><span class="postbody">
<br/>
<br/>
to play the music.
<br/>
<br/>
Works fine in the .raw of the bgm music in tickle girl. But my converted file with the same settings doesn't work =(.<br/>_________________<br/>The absurdest thing I've ever heard is that this world is not absurd.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58200 - tepples - Fri Oct 21, 2005 4:19 pm</h4>
    <div class="postbody"><span class="postbody">16-bit PCM is little-endian and signed, even in .wav format. Only 8-bit PCM is unsigned in .wav format.
<br/>
<br/>
Have you tried 8-bit sound first? You can use .wav files directly if you flip the sign bit of each sample (*dst ^= 0x80;) after loading them into RAM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"><br/><br/>Last edited by tepples on Fri Oct 21, 2005 8:20 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#58208 - inferno - Fri Oct 21, 2005 4:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">16-bit PCM is little-endian and signed, even in .wav format. Only 8-bit PCM is unsigned in .wav format.
<br/>
<br/>
Have you tried 8-bit sound first? You can use .wav files directly if you flip the sign bit (*dst ^= 0x80;) after loading them into RAM.</td> </tr></table><span class="postbody">
<br/>
Great... I'll try it!<br/>_________________<br/>The absurdest thing I've ever heard is that this world is not absurd.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58410 - inferno - Sun Oct 23, 2005 10:48 am</h4>
    <div class="postbody"><span class="postbody">Hmm.. Audacity isn't able to fully save in 8-bit format. Only 16-bit is supported. Any programs you use to do this?<br/>_________________<br/>The absurdest thing I've ever heard is that this world is not absurd.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58429 - tepples - Sun Oct 23, 2005 3:46 pm</h4>
    <div class="postbody"><span class="postbody">I've been using Cool Edit Pro, but if you want a program that will take a 16-bit PCM file and convert it to 8-bit, I could probably whip one up.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58452 - inferno - Sun Oct 23, 2005 7:30 pm</h4>
    <div class="postbody"><span class="postbody">Okay guys, it worked!
<br/>
So for future questions concerning this: this was my solution:
<br/>
<br/>
<br/>
Audacity is one of the best free editors around. It usually works with 16-bit+ files, but the internal codecs provide a solution for this problem.
<br/>
<br/>
First of all if you have a clip in stereo, put it in mono
<br/>
(open the menu of the audio clip and select "Split stereo track", now close the left or right channel (check which one sounds best) open the menu of this channel and click on "mono")
<br/>
<br/>
Edit the file to your needs. After that, open file&gt;preferences. Go to file formats and in the drop-down menu choose as "Uncompressed Export Format": AIFF (Apple/Sgi), signed 8 bit PCM. Jup I know about signed or unsigned file formats, but just use that one... It is the only one compatible with the Nintendo DS. 
<br/>
<br/>
Export the file. You can choose the sample rate yourself... I usually go with 44100hz.
<br/>
<br/>
<br/>
This might sound like a n00bish tutorial. Jup, it is, but figuring this out helped me a lot so for those struggling with Audacity: here you go.<br/>_________________<br/>The absurdest thing I've ever heard is that this world is not absurd.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149373 - mud2005 - Sat Jan 19, 2008 10:26 am</h4>
    <div class="postbody"><span class="postbody">I got audacity to finally work also , except when saving I chose
<br/>
Format: other
<br/>
Header: RAW(header-less)
<br/>
Encoding: signed 8 bit PCM
<br/>
this way I was able to save as a raw file. seems to work ok so far :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149376 - Cid2Mizard - Sat Jan 19, 2008 11:49 am</h4>
    <div class="postbody"><span class="postbody">i used Switch :
<br/>
-Format : 8 bit signed
<br/>
-Sample Rate : 11025
<br/>
-Channels : mono
<br/>
<br/>
The sound is perfect on DS<br/>_________________<br/><a href="http://www.nintendomax.com" target="_blank">www.nintendomax.com</a> 100% Hack 0% Warez</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
