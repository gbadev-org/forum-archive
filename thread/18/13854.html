<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem sending data over DSWifi - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Problem sending data over DSWifi</h2>
<div id="posts">
<div class="post">
    <h4>#136706 - c99koder - Fri Aug 03, 2007 11:45 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
I am using DSWifi w/ the sgIP stack to send/receive files on the DS.  Receiving is fine, but I'm having problem sending.  It seems like when I call send() it interrupts the previous send() if it hadn't finished transmitting, and I end up losing data.
<br/>
<br/>
I've tried reducing the size of the chunks I pass to send() and adding a few swiWaitForVBlank() calls in between and it seems to help a little, but I do still occasionally lose data.
<br/>
<br/>
Is there a reliable way to know when sgIP has finished sending the previous chunk so I can send the next?  I haven't put the socket into non-blocking mode, so send() is supposed to be block until it's finished anyway.
<br/>
<br/>
Thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136742 - simonjhall - Sat Aug 04, 2007 11:55 am</h4>
    <div class="postbody"><span class="postbody">I originally had problems like this when I started using wifi (over a year ago - things may have changed). I was losing data sometimes if the data I wanted to send was over the size of the payload of an IP packet. Normally when this happens the packet should get broken up into pieces and sent separately (called fragmentation), but it didn't always work.
<br/>
Ok, it doesn't sound too related to your problem but I'm sure it happened the more frequently I sent data!
<br/>
Also in more recent projects if I send data too fast (ie too often) I seem to overflow the buffers and my packets take longer and longer to get out of the machine, until eventually they get dropped...
<br/>
<br/>
So - I'd have a go at reducing the data size per packet (&lt; 1kb) and reducing the frequency of the sending of the data.<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
