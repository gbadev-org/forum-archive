<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Screenshot converter?(Sub screen capture?)(DISPCAP FIFO?) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Screenshot converter?(Sub screen capture?)(DISPCAP FIFO?)</h2>
<div id="posts">
<div class="post">
    <h4>#144076 - yellowstar - Sun Oct 28, 2007 11:33 pm</h4>
    <div class="postbody"><span class="postbody">Does anybody know of any screenshot converters
<br/>
to BMP?(bin-to-bmp)
<br/>
<br/>
I tried to google,
<br/>
but I couldn't find anything.
<br/>
<br/>
<span style="font-weight: bold">Click <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=144260#144260" target="_blank">here</a> for my sub screen capturing question.</span></span><span class="gensmall"><br/><br/>Last edited by yellowstar on Tue Nov 20, 2007 3:59 am; edited 5 times in total</span></div>    
</div>
<div class="post">
    <h4>#144081 - tepples - Sun Oct 28, 2007 11:50 pm</h4>
    <div class="postbody"><span class="postbody">Which .bin are you talking about? A raw 15-bit format?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144082 - yellowstar - Sun Oct 28, 2007 11:52 pm</h4>
    <div class="postbody"><span class="postbody">Yes, 15-bit.
<br/>
<br/>
The same kind display capture outputs.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144085 - Lick - Sun Oct 28, 2007 11:54 pm</h4>
    <div class="postbody"><span class="postbody">I find TGA to be a simpler format. You can even add compression (RLE = simple) so it sure beats BMP.
<br/>
<br/>
It's basically 18 bytes of header + RGB(A) data after the header.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144086 - Mighty Max - Sun Oct 28, 2007 11:59 pm</h4>
    <div class="postbody"><span class="postbody">So does BMP, except it's header is 54 Bytes for non-palletted.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144088 - yellowstar - Mon Oct 29, 2007 12:06 am</h4>
    <div class="postbody"><span class="postbody">My screenshot function calls another function
<br/>
which saves a TGA.(broken)(It's good enough
<br/>
for screenshots in which you know what the colors
<br/>
are for all/most of the pixels.)
<br/>
(Like black-and-white)
<br/>
(maybe other kinds of simple screenshots)
<br/>
<br/>
The only computer I have
<br/>
which has an app to access TGA
<br/>
is my old computer.(obviously I'm
<br/>
not on it all the time.)
<br/>
<br/>
I want a BMP converter so both computers
<br/>
can convert screenshots.(It's slow
<br/>
to load-up the GIMP on my old PC.)
<br/>
(I import the screenshot TGA,
<br/>
then export BMP)
<br/>
<br/>
(On my newer PC,
<br/>
I use a NDS which copys in
<br/>
the screenshot on my card,
<br/>
to the data dir,
<br/>
and display it.
<br/>
Then, in a Emu,
<br/>
I take a screenshot.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144170 - yellowstar - Mon Oct 29, 2007 9:49 pm</h4>
    <div class="postbody"><span class="postbody">If anybody would like to help
<br/>
fix my broken TGA saver,
<br/>
read the following:
<br/>
<br/>
The part that is the problem
<br/>
is probably the code
<br/>
which converts a 16-bit color
<br/>
into 8-bit.(converts all colors,
<br/>
and puts them in seperate bytes.)
<br/>
<br/>
Does anybody know of code
<br/>
to do this correctly?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144171 - Lick - Mon Oct 29, 2007 10:02 pm</h4>
    <div class="postbody"><span class="postbody">If by 16-bit you mean R5G5B5A1 to R8G8B8A8 (TGA32):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// color is a 16-bit value
<br/>
u8 color32r = ((color &amp; 0x001F) &lt;&lt; (16+3));
<br/>
u8 color32g = ((color &amp; 0x03E0) &lt;&lt; ( 8+3));
<br/>
u8 color32b = ((color &amp; 0x7C00) &lt;&lt; ( 0+3));
<br/>
u8 color32a = ((color &amp; 0x8000)? 0xFF000000 : 0);</td> </tr></table><span class="postbody"> <span style="font-weight: bold">-edit- explanation of the above crap</span>: I originally copypasted my u16 to u32 routine, but then decided to split the 32-bit value into 8-bit color components on-the-fly. Obviously, that wasn't such a smart idea, since I now see that I screwed up the shifts.
<br/>
<br/>
If you want to convert to R8G8B8 (TGA24):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// color is a 16-bit value
<br/>
u8 color24r = ((color &amp; 0x001F) &lt;&lt; (16+3));
<br/>
u8 color24g = ((color &amp; 0x03E0) &lt;&lt; ( 8+3));
<br/>
u8 color24b = ((color &amp; 0x7C00) &lt;&lt; ( 0+3));</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">-edit- same as above</span>
<br/>
<br/>
Those are the conversions.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"><br/><br/>Last edited by Lick on Tue Oct 30, 2007 2:22 am; edited 3 times in total</span></div>    
</div>
<div class="post">
    <h4>#144172 - wintermute - Mon Oct 29, 2007 10:15 pm</h4>
    <div class="postbody"><span class="postbody">You might be a bit better off with
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// color is a 16-bit value
<br/>
u8 red = (color &amp; 0x001F) ;
<br/>
u8 green = ((color &amp; 0x03E0) &gt;&gt; 5 );
<br/>
u8 blue = ((color &amp; 0x7C00) &gt;&gt; 10 );
<br/>
u8 alpha = ((color &amp; 0x8000) ? 0xFF : 0);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
then write the bytes in whatever order you need.
<br/>
<br/>
The entirely black image you'll get with Lick's code might confuse you a little.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144173 - kusma - Mon Oct 29, 2007 10:20 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, that's the best way of ensuring that white does not stay white...
<br/>
To combat that problem, you'd do something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">x = (float(x) / ((1 &lt;&lt; 5) - 1)) * ((1 &lt;&lt; 8) - 1)</td> </tr></table><span class="postbody">
<br/>
or
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">x = (x &lt;&lt; (8 - 5)) | (x &gt;&gt; (5 - (8 - 5)))</td> </tr></table><span class="postbody">
<br/>
<br/>
...if you want to avoid those floats. It gives a slightly different result for some of the values, but it's still much better than just shifting up.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144179 - yellowstar - Mon Oct 29, 2007 11:36 pm</h4>
    <div class="postbody"><span class="postbody">Thanks!
<br/>
<br/>
The code with no alpha is the
<br/>
one I need for this.(I could add code
<br/>
to handle alpha also)
<br/>
<br/>
I can't test it right now,
<br/>
as I'm not on my computer with my TGA software on it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144184 - Cearn - Tue Oct 30, 2007 12:05 am</h4>
    <div class="postbody"><span class="postbody">Alternatively, use a 16-bit TGA, in which case you'd only have to swap red and blue:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u32 color, rb;
<br/>
...
<br/>
rb= color &amp; 0x7C1F;
<br/>
rb |= rb&lt;&lt;20;
<br/>
color= (color &amp;~ 0x7C1F) | (rb&gt;&gt;10);
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144197 - yellowstar - Tue Oct 30, 2007 3:04 am</h4>
    <div class="postbody"><span class="postbody">I tried wintermute's code,
<br/>
but I got the same <a class="postlink" href="http://members.iglide.net/ticeandsons/yellowstar/screenshotTGASaver.bmp" target="_blank">result</a> as my
<br/>
original code.(screenshot)
<br/>
(Screenshot is of my Pong game)
<br/>
(No gameplay yet, the sprites are
<br/>
just in the correct places)
<br/>
<br/>
The background is black,(or something similar)
<br/>
and the pixels that are supposed to be white
<br/>
are a lighter color than black.
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span>
<br/>
I could write a BMP saver,
<br/>
but, untill this problem is solved,
<br/>
I would get the same output as above.(same colors and ect.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144201 - ecurtz - Tue Oct 30, 2007 3:29 am</h4>
    <div class="postbody"><span class="postbody">Wintermute's code is right, it's just leaving them as 5 bit values.
<br/>
<br/>
Try
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define R_FROM_RGB15(rgb)  ((rgb &amp; 0x001F) &lt;&lt; 3)
<br/>
#define G_FROM_RGB15(rgb)  ((rgb &amp; 0x03E0) &gt;&gt; 2)
<br/>
#define B_FROM_RGB15(rgb)  ((rgb &amp; 0x7C00) &gt;&gt; 7)
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144205 - yellowstar - Tue Oct 30, 2007 3:49 am</h4>
    <div class="postbody"><span class="postbody">Thanks,
<br/>
it works now!
<br/>
<br/>
I guess I'll need to investigate
<br/>
BMP again later.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144260 - yellowstar - Tue Oct 30, 2007 11:06 pm</h4>
    <div class="postbody"><span class="postbody">I have another question.
<br/>
<br/>
Does anybody know of
<br/>
code to copy the data from
<br/>
the sub engine to the main one?
<br/>
<br/>
So,
<br/>
this would enable me to take screenshots
<br/>
of the sub screen.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144275 - tepples - Wed Oct 31, 2007 2:00 am</h4>
    <div class="postbody"><span class="postbody">Which mode and which VRAM banks are you using for the sub screen?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144280 - yellowstar - Wed Oct 31, 2007 2:48 am</h4>
    <div class="postbody"><span class="postbody">Sub screen is console.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
videoSetModeSub(MODE_0_2D | DISPLAY_BG0_ACTIVE);
<br/>
<br/>
vramSetBankC(VRAM_C_SUB_BG);
<br/>
</td> </tr></table><span class="postbody">
<br/>
(I want code to handle
<br/>
backgrounds, sprites, 3D, ect.)
<br/>
(Also for use in other HB)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144771 - yellowstar - Wed Nov 07, 2007 2:06 am</h4>
    <div class="postbody"><span class="postbody">Anybody?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145475 - yellowstar - Fri Nov 16, 2007 3:41 am</h4>
    <div class="postbody"><span class="postbody">How do I use the display capture FIFO?
<br/>
<br/>
Also,
<br/>
what are the advantages/disadvantages and such,
<br/>
between FIFO and VRAM?
<br/>
<br/>
Is there a way to capture videos?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145664 - yellowstar - Tue Nov 20, 2007 4:01 am</h4>
    <div class="postbody"><span class="postbody">Anybody?
<br/>
<br/>
How much faster/slower is DISPCAP FIFO, compared to VRAM?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
