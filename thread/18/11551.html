<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Making a beam of light in 3D - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Making a beam of light in 3D</h2>
<div id="posts">
<div class="post">
    <h4>#107186 - Tassu - Fri Oct 27, 2006 2:22 pm</h4>
    <div class="postbody"><span class="postbody">What would be the best way to make a 3D quad fade from solid to transparent so that one end would be solid and the other transparent? I'm trying to make a beam of light.
<br/>
<br/>
With PC it would be as easy as this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glBegin(GL_QUADS);
<br/>
<br/>
    glColor4f(1,1,1,1);
<br/>
    glVertex3f(0,0,0);
<br/>
    glVertex3f(1,0,0);
<br/>
<br/>
    glColor4f(1,1,1,0);
<br/>
    glVertex3f(1,1,0);
<br/>
    glVertex3f(0,1,0);
<br/>
<br/>
glEnd();</td> </tr></table><span class="postbody">
<br/>
<br/>
How could I do this on the DS? Should I use a texture or something?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107214 - Goosey - Fri Oct 27, 2006 6:57 pm</h4>
    <div class="postbody"><span class="postbody">A alpha transition exactly like your looking for cant be done on the DS with a single quad. Two options spring to mind:
<br/>
<br/>
- Use multiple quads in different ID groups with progressively less poly alpha.
<br/>
- Use a alpha texture that progressivly has more alpha-rejected pixels.
<br/>
<br/>
<br/>
To clarify the 2nd option, since alpha textures in the DS are single bit rejection (drawn or not) you would do something like this (X = no alpha, A = alpha)
<br/>
<br/>
XXXXX
<br/>
XXAXX
<br/>
XAXAX
<br/>
AXAXA
<br/>
AAXAA
<br/>
<br/>
Not sure if it will look great!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107221 - Rockard - Fri Oct 27, 2006 7:43 pm</h4>
    <div class="postbody"><span class="postbody">easiest would be to use a texture. there is a recent thread started by me that clearifies how to make such a texture.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107222 - M3d10n - Fri Oct 27, 2006 7:44 pm</h4>
    <div class="postbody"><span class="postbody">"Alpha reject"? As in fully transparent? That would look horrible, no? 
<br/>
<br/>
Using textures with alpha channels is the way to go for alpha gradients. Search for "texture formats" and you might find a thread which talks about them.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107264 - Tassu - Sat Oct 28, 2006 3:25 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>M3d10n wrote:</b></span></td> </tr> <tr> <td class="quote">Using textures with alpha channels is the way to go for alpha gradients. Search for "texture formats" and you might find a thread which talks about them.</td> </tr></table><span class="postbody">
<br/>
<br/>
I found this: <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=11494" target="_blank">http://forum.gbadev.org/viewtopic.php?t=11494</a> Thanks very much!
<br/>
<br/>
My quad now fades nicely but it shows completely black. Only the alpha works, not the color. I think the palette doesn't get loaded.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107277 - Goosey - Sat Oct 28, 2006 4:35 am</h4>
    <div class="postbody"><span class="postbody">*blush* 
<br/>
<br/>
Oh yes, you can do that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107319 - Sausage Boy - Sat Oct 28, 2006 1:57 pm</h4>
    <div class="postbody"><span class="postbody">Mind sharing the source Tassu? I'll try to help you.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107320 - Tassu - Sat Oct 28, 2006 2:17 pm</h4>
    <div class="postbody"><span class="postbody">Rendering:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glEnable(GL_BLEND);glAlphaFunc(BLEND_ALPHA);
<br/>
glBindTexture(GL_TEXTURE_2D,fade_tex);
<br/>
glColorTable(GL_RGB32_A3, fadetex_pal_addr);
<br/>
            
<br/>
glBegin(GL_TRIANGLES);
<br/>
glTexCoord2f(0,0.125);glVertex3f(x1,y1+hadd,0);
<br/>
glTexCoord2f(0.25,0);glVertex3f(x1-1,y1,0);
<br/>
glTexCoord2f(0.25,0.25);glVertex3f(x1+1,y1,0);
<br/>
glEnd();</td> </tr></table><span class="postbody">
<br/>
<br/>
Loading:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glGenTextures(1, &amp;fade_tex);
<br/>
glBindTexture(GL_TEXTURE_2D, fade_tex);
<br/>
<br/>
glTexImage2D(0, 0,  GL_RGB32_A3, TEXTURE_SIZE_32 , TEXTURE_SIZE_32, 0, TEXGEN_TEXCOORD | GL_TEXTURE_WRAP_S | GL_TEXTURE_WRAP_T, (u8*)fadetex);
<br/>
fadetex_pal_addr=gluTexLoadPal( (u16*)fadetexpal, 32, GL_RGB32_A3 );</td> </tr></table><span class="postbody">
<br/>
<br/>
fadetex_pal_addr always remains zero. Is that the problem?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107321 - Sausage Boy - Sat Oct 28, 2006 2:24 pm</h4>
    <div class="postbody"><span class="postbody">If fadetex_pal_addr really is 0 all the time, it is certainly a problem. Where does it come from? Which command line did you use for conversion? How do you include your files?<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107323 - Tassu - Sat Oct 28, 2006 2:53 pm</h4>
    <div class="postbody"><span class="postbody">I convert with TexMex with command: <span style="font-style: italic">TexMex fadetex.png -o fadetex -1</span>
<br/>
I rename the files to fadetex.bin and fadetexpal.bin and put them in data folder.
<br/>
Then:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "fadetex.h"
<br/>
#include "fadetexpal.h"
<br/>
int fade_tex;
<br/>
int fadetex_pal_addr;</td> </tr></table><span class="postbody">
<br/>
<br/>
I noticed that in the paletted cube example the generated .h files are different from mine.
<br/>
<br/>
It looks like this in the example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern const u8 texture8_RGB32_A3_pal_bin_end[];
<br/>
extern const u8 texture8_RGB32_A3_pal_bin[];
<br/>
extern const u32 texture8_RGB32_A3_pal_bin_size;</td> </tr></table><span class="postbody">
<br/>
And this in my project:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern const u8 fadetexpal[];
<br/>
extern const u32 fadetexpal_size[];</td> </tr></table><span class="postbody">
<br/>
Does this have something to do with the makefiles? I use the one that came with palib...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107324 - Sausage Boy - Sat Oct 28, 2006 2:57 pm</h4>
    <div class="postbody"><span class="postbody">Remove the fadetex_pal_addr, and replace every reference to it with fadetexpal.
<br/>
<br/>
Edit:
<br/>
Scratch that, I don't know what I'm thinking today.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107361 - omaremad - Sun Oct 29, 2006 12:32 am</h4>
    <div class="postbody"><span class="postbody">Why not just use standard textures and polyalpha 15 or something i think the ds` default transparency mode is addition alpha, so a normal texture with a white to black gradient should do the trick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107404 - Tassu - Sun Oct 29, 2006 12:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>omaremad wrote:</b></span></td> </tr> <tr> <td class="quote">Why not just use standard textures and polyalpha 15 or something i think the ds` default transparency mode is addition alpha, so a normal texture with a white to black gradient should do the trick.</td> </tr></table><span class="postbody">
<br/>
That wouldn't look right. The whole quad would be visible from every place, even the darker parts.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107427 - omaremad - Sun Oct 29, 2006 4:33 pm</h4>
    <div class="postbody"><span class="postbody">since its additive blending the black parts would still be invisible</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107428 - Tassu - Sun Oct 29, 2006 4:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>omaremad wrote:</b></span></td> </tr> <tr> <td class="quote">since its additive blending the black parts would still be invisible</td> </tr></table><span class="postbody">
<br/>
DS doesn't have additive blending. I'm not sure what's the correct word for the kind of transparency mode the DS has, but it's not additive. Just normal basic transparency. The dark parts would show.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107468 - omaremad - Sun Oct 29, 2006 10:36 pm</h4>
    <div class="postbody"><span class="postbody">Hmmm i had toon shading turned on(+smoothing) with transparency and the darker parts of the toon table had been more transparent than the lighter ones.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107508 - Payk - Mon Oct 30, 2006 10:28 am</h4>
    <div class="postbody"><span class="postbody">^^Yep...exactly
<br/>
in a blended image, dark parts are much more transparancy then white or something...
<br/>
Also if u get a blended pic in front of a black bg, it has no effect...but when you got white as bg it mixes up.
<br/>
i am just thinking about to make a loading routine for textures...u can give it 2 bmps (a texture and a alphamap) and it convertes it to that format with 32 colors and some alphabits... will post that here when finished</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
