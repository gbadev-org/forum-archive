<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem with BMP sprites... [solved] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Problem with BMP sprites... [solved]</h2>
<div id="posts">
<div class="post">
    <h4>#118090 - Key_46 - Sat Feb 10, 2007 1:20 am</h4>
    <div class="postbody"><span class="postbody">Hi, i am using sprites to render buttons in my ds app. , or, at least, trying... i write the icon in the SPRITE_GFX...in my case, the icon is a 64x64 media player like wmp11 play button, he is the code:
<br/>
<br/>
initialization:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
vramSetMainBanks(   VRAM_A_MAIN_SPRITE,
<br/>
                        VRAM_B_MAIN_SPRITE,
<br/>
                        VRAM_C_SUB_BG_0x6200000,
<br/>
                        VRAM_D_MAIN_BG_0x6000000
<br/>
                        ); 
<br/>
    videoSetMode(  MODE_5_2D | 
<br/>
                   DISPLAY_SPR_ACTIVE |
<br/>
                   DISPLAY_BG0_ACTIVE |
<br/>
               DISPLAY_SPR_2D_BMP_256
<br/>
                    );
<br/>
<br/>
   videoSetModeSub( MODE_0_2D | DISPLAY_BG0_ACTIVE );
<br/>
<br/>
   BG_PALETTE_SUB[0] = RGB15(0,0,0);
<br/>
   SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
   BG_PALETTE_SUB[255] = RGB15(31,31,31);
<br/>
   consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(31), (u16*)CHAR_BASE_BLOCK_SUB(0), 16);
<br/>
<br/>
irqInit();
<br/>
   irqSet(IRQ_VBLANK, 0); 
<br/>
   irqEnable(IRQ_VBLANK);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
fill SPRITE_GFX:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
for(y=0;y&lt;64;y++)
<br/>
      for(x=0;x&lt;64;x++)
<br/>
      {
<br/>
         SPRITE_GFX[P(x,y,256)]=RGB15(
<br/>
         COLOR2DSCOLOR(mPlayer_64_data[i + 1]),
<br/>
         COLOR2DSCOLOR(mPlayer_64_data[i + 2]),
<br/>
         COLOR2DSCOLOR(mPlayer_64_data[i + 3]))|(1&lt;&lt;15);
<br/>
<br/>
                        /*
<br/>
                          -mPlayer_64_data is a ushort array in a .h file(bitmap).
<br/>
                          -color2dscolor converts 8bit color to 5bit color.
<br/>
                        */
<br/>
<br/>
         i+=4;
<br/>
      }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and the sprite itself:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Sprites[0]-&gt;attribute[0] = ATTR0_BMP | ATTR0_ROTSCALE_DOUBLE | sprite_y; 
<br/>
   Sprites[0]-&gt;attribute[1] = ATTR1_SIZE_64 | sprite_x; 
<br/>
   Sprites[0]-&gt;attribute[2] = ATTR2_ALPHA(1)| 0; 
<br/>
   Sprites[0]-&gt;attribute[3] = 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
*all the OAM functions are copied from DevKit Sprite_Bitmap Example.
<br/>
<br/>
the problem is that the sprite's image isn't my bitmap, it is just a light-blue square, i checked the VRAM in Dualis emulator and the image is OK, the OAM viewer in DS says that the sprite 0 's PLAIN is my image, but the FINAL is the blue square...what is the problem?</span><span class="gensmall"><br/><br/>Last edited by Key_46 on Sat Feb 10, 2007 10:06 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#118096 - tepples - Sat Feb 10, 2007 3:21 am</h4>
    <div class="postbody"><span class="postbody">If you use ROTSCALE but do not load in a transformation matrix, all you will see is the pixel at the center of the sprite cel. Either load in a matrix or don't use ROTSCALE.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118131 - Key_46 - Sat Feb 10, 2007 10:02 am</h4>
    <div class="postbody"><span class="postbody">It worked! Tanks</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
