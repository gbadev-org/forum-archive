<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DS linker DLDI - EABI version 0, version 4 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > DS linker DLDI - EABI version 0, version 4</h2>
<div id="posts">
<div class="post">
    <h4>#119724 - Diddl - Sun Feb 25, 2007 4:16 pm</h4>
    <div class="postbody"><span class="postbody">The DLDI file for DSlinker only supports read access. 
<br/>
<br/>
The DS Linker card is exaktly same hardware as N-Card, MK5 and <span style="font-weight: bold">[a card whose manufacturer's web site distributes pirated DS games -- MOD]</span>. For N-Card exists a library file which can also supports write access. You can download the code at: <a href="http://www.dsgba.com/download.htm" target="_blank">http://www.dsgba.com/download.htm</a>
<br/>
<br/>
The file is called
<br/>
<br/>
<br/>
I wanted to implement this code in Libfat but at link time an error message occurs: object file has old EABI version 0, current linker uses version 4.
<br/>
<br/>
Is there a chance to use this old lib file in current projects? Or is it possible to disassemble the code (reverse engineering)?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119747 - Puyo - Sun Feb 25, 2007 8:42 pm</h4>
    <div class="postbody"><span class="postbody">I would guess that version 0 is not even a version, but just a not defined value. It seems like some compilers don`t add those values. There must be a compiler option to turn this check off, which i haven`t found yet. 
<br/>
Sooo, you have a library file, which consists of a few compiled files, and they all have wrong eabi versions. The easiest way would be to edit them manually. In hex editor search for "ELF" header. And edit 36th byte from that offset (0x717 would be first occurrence) with 4. You can also extract them and edit by one: first file dscard.o would be a file from offset 0x6F0 to (0x6F0 + 32760). 
<br/>
Disassembling is a option too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119802 - wintermute - Mon Feb 26, 2007 2:40 pm</h4>
    <div class="postbody"><span class="postbody">This might help a bit
<br/>
<br/>
<a href="http://www.devkitpro.org/downloads.shtml#change-eabi" target="_blank">http://www.devkitpro.org/downloads.shtml#change-eabi</a>
<br/>
<br/>
Given that the code is provided as a library file it's pretty easy to disassemble. arm-eabi-objdump -d libncardio.a &gt; libncardio.s should get you started.
<br/>
<br/>
It might be a bit easier to extract the object files &amp; disassemble them individually. arm-eabi-ar -x libncardio.a
<br/>
<br/>
The disassembly won't quite match up to the hex dump in the files this way because the object files haven't been fully linked. Some addresses are determined and fixed up at link time.
<br/>
<br/>
You can use objdump on a fully linked .elf file as well, this will give you the absolute addresses used in the final nds but will also have all the extra cruft from the crt0, libc &amp; libnds.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119839 - Diddl - Mon Feb 26, 2007 8:50 pm</h4>
    <div class="postbody"><span class="postbody">thank you for your help! I'm impressed how competent and qualified user are on this board!
<br/>
<br/>
<br/>
ingeniously!
<br/>
<br/>
works perfect with
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-eabi-ar -x libncardio.a
<br/>
arm-eabi-objdump -d dscard.o &gt; dscard.s
<br/>
     :                                        :
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119893 - Diddl - Tue Feb 27, 2007 9:37 am</h4>
    <div class="postbody"><span class="postbody">is there also a easy way to get the disassem dump in a form usable for compilation (assemble).
<br/>
<br/>
I know, I only have to delete this leading hex numbers and reformat the labels. But there are hundreds of KB and  if there is a easy way it would be nice.
<br/>
<br/>
could you suggest a book for learning ARM assembler? does it makes sense to learn ARM assembler?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119938 - Puyo - Tue Feb 27, 2007 6:33 pm</h4>
    <div class="postbody"><span class="postbody">Try changing eabi version first. There`s a good chance that it will work this way. 
<br/>
<br/>
If you wish to understand assembly listings you should first of all learn some basic info about processor, then go on for instruction set. GBATek &amp; <a class="postlink" href="http://www.heyrick.co.uk/assembler/" target="_blank">Richard Murray`s ARM ASSEMBLER</a> should give you all info you need.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119943 - Diddl - Tue Feb 27, 2007 8:28 pm</h4>
    <div class="postbody"><span class="postbody">Thank you, it a good idea. Will first try to change EABI version.
<br/>
<br/>
I see, in all cases it is necessary to learn ARM assembler (for me).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120067 - Diddl - Wed Feb 28, 2007 7:42 pm</h4>
    <div class="postbody"><span class="postbody">shortly report (if anyone is interested??):
<br/>
<br/>
<br/>
<span style="font-weight: bold">thanks for your help! </span>changing eabi was succesful. after changing this object files and adding to a new library it compiles fine. 
<br/>
<br/>
<br/>
but at the end it is only partially successful ...
<br/>
<br/>
I have a 16GBit and a 4GBit card. this lib can write now, but only on the old 4GB card. the new 16GB card gives an error: unknown NAND
<br/>
<br/>
<br/>
maybe the 8GB DS Linker card will run. I have none, so I cann't test this. but now it should be possible to make a DLDI for this 4GB, 2GB and 1 GB card.
<br/>
<br/>
hier is <span style="font-weight: bold">the binary, the source and the lib</span>: <a class="postlink" href="http://web3.vs2066076.netfabrik.de/nds/test_nrio.zip" target="_blank">click me</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120077 - Puyo - Wed Feb 28, 2007 9:52 pm</h4>
    <div class="postbody"><span class="postbody">Nice to hear that. The problem with 16 GBit is probaly because the lib is outdated. Now if you !really interested!  in making it work, than you should learn something on how NAND works. For that you should disassemble your card &amp; get all the possible info about the chip inside. Than you should go to the manufacturers site and download the datasheet. That`s the least you can do now. 
<br/>
<br/>
P.S. Nothing holds you from downloading other manufacturers datasheets like Intel`s (they all work basically equally).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120665 - Diddl - Mon Mar 05, 2007 10:39 am</h4>
    <div class="postbody"><span class="postbody">good news! DLDI with write support will come next week: <a class="postlink" href="http://www.neoflash.com/forum/index.php/topic,3784.0.html" target="_blank">Neo</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
