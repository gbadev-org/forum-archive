<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>N00b needs help with accessing assets - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > N00b needs help with accessing assets</h2>
<div id="posts">
<div class="post">
    <h4>#67194 - HyperHacker - Mon Jan 16, 2006 4:30 am</h4>
    <div class="postbody"><span class="postbody">Next question... with ndstool I can include binary files in the .nds, but how do I access them from code? I can see them in the .nds in a hex editor, but I scanned the main RAM for the file's content and didn't find anything, and fopen() doesn't do it. GBFS functions don't find it either.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67219 - tepples - Mon Jan 16, 2006 7:09 am</h4>
    <div class="postbody"><span class="postbody">Binary files in the .nds are mainly intended for use with DS Game Cards by licensed developers (or for Pocket Heaven purposes), not for use in GBA ROM. To use GBFS in GBA ROM in a ds.gba program, use 'padbin 256 rom.nds' followed by 'copy /b ndsloader.bin+rom.nds+data.gbfs rom.ds.gba'.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67222 - HyperHacker - Mon Jan 16, 2006 7:29 am</h4>
    <div class="postbody"><span class="postbody">Does it have to be .ds.gba? I'm using WMB to run it, which has worked fine with .nds and no loader so far.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67226 - crossraleigh - Mon Jan 16, 2006 7:41 am</h4>
    <div class="postbody"><span class="postbody">Then use the bin2o makefile macro. If you insist on using GBFS, you can bin2o the .gbfs file: there is a libnds example that demonstrates this technique.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67308 - HyperHacker - Mon Jan 16, 2006 10:18 pm</h4>
    <div class="postbody"><span class="postbody">Eh, I don't use makefiles. I use a batch file.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">@echo off
<br/>
<br/>
IF NOT DEFINED devkitarm_path GOTO noenv
<br/>
IF NOT DEFINED ndslib_path GOTO noenv
<br/>
IF NOT DEFINED nds_wmb_path GOTO noenv
<br/>
goto start
<br/>
<br/>
:noenv
<br/>
echo The required environment variables have not been defined.
<br/>
goto end
<br/>
<br/>
:start
<br/>
echo Compiling ARM7...
<br/>
%devkitarm_path%\arm-elf-g++ -g -mcpu=arm7tdmi -mtune=arm7tdmi -mthumb-interwork -I%ndslib_path%\include -DARM7 -fomit-frame-pointer -ffast-math -o%devkitarm_path%\arm7.o -c arm7.c
<br/>
IF NOT EXIST %devkitarm_path%\arm7.o GOTO done
<br/>
%devkitarm_path%\arm-elf-g++ -g -mthumb-interwork -mno-fpu -specs=ds_arm7.specs %devkitarm_path%\arm7.o -L%ndslib_path%\lib -lnds7 -o%devkitarm_path%\arm7.elf 
<br/>
IF NOT EXIST %devkitarm_path%\arm7.elf GOTO done
<br/>
%devkitarm_path%\arm-elf-objcopy -O binary %devkitarm_path%\arm7.elf %devkitarm_path%\arm7.bin
<br/>
IF NOT EXIST %devkitarm_path%\arm7.bin GOTO done
<br/>
<br/>
echo Compiling ARM9...
<br/>
%devkitarm_path%\arm-elf-g++ -g -mcpu=arm9tdmi -mtune=arm9tdmi -mthumb-interwork -I%ndslib_path%\include -DARM9 -fomit-frame-pointer -ffast-math -o%devkitarm_path%\arm9.o -c arm9.c
<br/>
IF NOT EXIST %devkitarm_path%\arm9.o GOTO done
<br/>
%devkitarm_path%\arm-elf-g++ -g -mthumb-interwork -mno-fpu -specs=ds_arm9.specs %devkitarm_path%\arm9.o -L%ndslib_path%\lib -lnds9 -o%devkitarm_path%\arm9.elf 
<br/>
IF NOT EXIST %devkitarm_path%\arm9.elf GOTO done
<br/>
%devkitarm_path%\arm-elf-objcopy -O binary %devkitarm_path%\arm9.elf %devkitarm_path%\arm9.bin
<br/>
IF NOT EXIST %devkitarm_path%\arm9.bin GOTO done
<br/>
<br/>
:link
<br/>
echo Linking...
<br/>
%devkitarm_path%\ndstool -c %devkitarm_path%\test3.nds -7 %devkitarm_path%\arm7.bin -9 %devkitarm_path%\arm9.bin -o %devkitarm_path%\logos\nds.bmp -d data
<br/>
<br/>
:run
<br/>
echo Running...
<br/>
%nds_wmb_path%\wmb -data %devkitarm_path%\test3.nds -player Banana
<br/>
<br/>
:done
<br/>
echo Cleaning...
<br/>
del %devkitarm_path%\arm7.o &gt; NUL
<br/>
del %devkitarm_path%\arm9.o &gt; NUL
<br/>
del %devkitarm_path%\arm7.elf &gt; NUL
<br/>
del %devkitarm_path%\arm9.elf &gt; NUL
<br/>
del %devkitarm_path%\arm7.bin &gt; NUL
<br/>
del %devkitarm_path%\arm9.bin &gt; NUL
<br/>
echo Done.
<br/>
echo ????????????????????????????????????????????????????????????????????????????????
<br/>
popd
<br/>
:end
<br/>
</td> </tr></table><span class="postbody">
<br/>
It compiles ARM7 and ARM9 sources separately, merges them with ndstool, starts a WMB broadcast if the compile succeeded, and deletes the temporary files. :-)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
