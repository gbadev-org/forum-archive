<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Question about touch pixel position - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Question about touch pixel position</h2>
<div id="posts">
<div class="post">
    <h4>#74872 - patroclus02 - Wed Mar 08, 2006 11:58 am</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
I'm going through <a href="http://www.double.co.nz/nintendo_ds/index.html" target="_blank">http://www.double.co.nz/nintendo_ds/index.html</a> tutorial
<br/>
I'm trying to understand how the demos work, though it is quite difficult to figure out everything, as there're lots of defines, procedure, and so on.
<br/>
<br/>
So far, I wonder how does first demo calculate pixel position touched.
<br/>
<br/>
It defines 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define TOUCH_CAL_X1 (*(vs16*)0x027FFCD8)
<br/>
#define TOUCH_CAL_Y1 (*(vs16*)0x027FFCDA)
<br/>
#define TOUCH_CAL_X2 (*(vs16*)0x027FFCDE)
<br/>
#define TOUCH_CAL_Y2 (*(vs16*)0x027FFCE0)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and the calculates
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
s32 TOUCH_WIDTH  = TOUCH_CAL_X2 - TOUCH_CAL_X1;
<br/>
s32 TOUCH_HEIGHT = TOUCH_CAL_Y2 - TOUCH_CAL_Y1;
<br/>
s32 TOUCH_OFFSET_X = ( ((SCREEN_WIDTH -60) * TOUCH_CAL_X1) / TOUCH_WIDTH  ) - 28;
<br/>
s32 TOUCH_OFFSET_Y = ( ((SCREEN_HEIGHT-60) * TOUCH_CAL_Y1) / TOUCH_HEIGHT ) - 28;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
so when you retrieve x and y positions (not given in pixels when calling touchRead), it computes the real pixel data doing:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
xpx = ( ((SCREEN_WIDTH -60) * x) / TOUCH_WIDTH  ) - TOUCH_OFFSET_X;
<br/>
      ypx = ( ((SCREEN_HEIGHT-60) * y) / TOUCH_HEIGHT ) - TOUCH_OFFSET_Y;
<br/>
      
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't understand how this is done. why - 60?  why - 28?...
<br/>
As I read it is a calibrating routine or something like that.
<br/>
<br/>
But, if you use your own IRQ handler, you need to do this? or in latest NDSLIB you can just use IPC-&gt;touchXpx or touchRead without including the above code in the handler??
<br/>
<br/>
Thank you</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74873 - natrium42 - Wed Mar 08, 2006 1:11 pm</h4>
    <div class="postbody"><span class="postbody">This is very old code. That tutorial is outdated... You should look at the examples from LibNDS (not NDSLIB).<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74881 - patroclus02 - Wed Mar 08, 2006 1:56 pm</h4>
    <div class="postbody"><span class="postbody">Thank you, I'm working with demo shipped with LibNDS.
<br/>
<br/>
But I see no code for ARM7 and code for ARM9. I just see all code in the same c++ source file. So, there's no need to write code separately, or tell the compiler which is which?
<br/>
<br/>
And last thing, makefile confuses me. It is different from the one used in the tutorial. Is there any place I can read about how does this makefile work? I see some comments in it, but I don't see where the compiler and linker are called.
<br/>
I see editing makefile is necessary for somethings like to make a header file for access to binary data. 
<br/>
<br/>
Thank you!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75105 - HyperHacker - Fri Mar 10, 2006 3:38 am</h4>
    <div class="postbody"><span class="postbody">I think it uses default ARM7 code if you don't give it any.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75128 - patroclus02 - Fri Mar 10, 2006 9:43 am</h4>
    <div class="postbody"><span class="postbody">Thanks.
<br/>
Yes, it seems it that tasks such as get screen touch position or X/Y buttons are done by default ARM7 code, so you automatically can use them in ARM9.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
