<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Strange touch problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Strange touch problem</h2>
<div id="posts">
<div class="post">
    <h4>#166514 - ChronoDK - Mon Feb 09, 2009 10:31 am</h4>
    <div class="postbody"><span class="postbody">Touch input has stopped working here. I'm porting some code I had to the latest devkitpro, and now this wont work:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//Scan key states
<br/>
   scanKeys();
<br/>
<br/>
   //Current touch position
<br/>
   touchPosition touch;
<br/>
   touchRead(&amp;touch);
<br/>
<br/>
   if ( keysHeld() &amp; KEY_TOUCH ) {
<br/>
   //do something
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
touch.px and touch.py is always zero :(
<br/>
<br/>
Is there something wrong in the above code, or should I look elsewhere for a solution?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166525 - Pete_Lockwood - Mon Feb 09, 2009 11:49 am</h4>
    <div class="postbody"><span class="postbody">On hardware?  Or which emu?<br/>_________________<br/>It's not an illusion, it just looks like one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166527 - ChronoDK - Mon Feb 09, 2009 12:42 pm</h4>
    <div class="postbody"><span class="postbody">Both hardware, no$gba and NDeSmuME. The TouchTest example from devkitpro works on both  and hardware and no$gba, but not in NDeSmuME).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166560 - ChronoDK - Mon Feb 09, 2009 8:24 pm</h4>
    <div class="postbody"><span class="postbody">Did nobody experience something like this? I must be forgetting to do something somewhere - I just don't know what :(
<br/>
<br/>
Perhaps something makefile related?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166561 - elhobbs - Mon Feb 09, 2009 8:31 pm</h4>
    <div class="postbody"><span class="postbody">make sure you are not using irqInit() on the arm9 side - it gets called before main now. if you call it in your code it breaks the default FIFO implementation. are you using the default arm7 or are you using custom code? the touch info is sent to the arm9 using FIFO in the latest libnds so it requires the newer arm7 code.
<br/>
<br/>
also, what is Ndesmume? how old is it and does it support FIFO? the current version is called desmume at <a class="postlink" href="http://desmume.org" target="_blank">http://desmume.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166562 - ChronoDK - Mon Feb 09, 2009 8:41 pm</h4>
    <div class="postbody"><span class="postbody">Thanks - that did it! irqInit() was the culprit. 
<br/>
<br/>
Hmm, that new emulator wont work with my game - maybe I'm doing something else wrong as well?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166563 - elhobbs - Mon Feb 09, 2009 8:54 pm</h4>
    <div class="postbody"><span class="postbody">what is the problem? if you are using libfat then you need to make sure you are using the dlditool to add the "GBA Movie Player (Compact Flash)" dldi driver. the new libfat does not have any drivers builtin any longer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166572 - ChronoDK - Mon Feb 09, 2009 10:56 pm</h4>
    <div class="postbody"><span class="postbody">I'm using EFS when running on emulators and libfat when running on hardware. Works fine on hardware and no$gba, so I'm okay for now. Just curious why it wont work in that new emulator as well.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
