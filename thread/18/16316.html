<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Drawing Buttons - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Drawing Buttons</h2>
<div id="posts">
<div class="post">
    <h4>#165646 - Doogle - Thu Jan 01, 2009 10:02 am</h4>
    <div class="postbody"><span class="postbody">Major DS newbie here (although many years programming experience in languages other than C and platforms other than DS.) 
<br/>
<br/>
I've been playing with WiFi and have managed to connect to an AP and buffer and receive data. I'm now getting into the part where I want to send some data via touching a 'button' on the bottom screen and / or one of the physical buttons. 
<br/>
<br/>
I've been looking at various example code but just can't get my head round the 'simple' problem of drawing a rectangle at a given location and size and putting some text into it. I can draw a rectangle, using videoSetMode(MODE_FB0) but I can't see how to get the text into it. Is there a simple example somewhere or can someone perhaps provide a snippet of code I could work with please.
<br/>
<br/>
Thansk and Happy New Year etc..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165790 - Doogle - Tue Jan 06, 2009 9:42 pm</h4>
    <div class="postbody"><span class="postbody">Well, I think I learnt quite a lot, "simple" was a bit of an understatement!
<br/>
<br/>
Having looked through the various tutorials and example code I've managed to achieve the desired results. However, whether it's a 'good' solution (in terms of coding and platform) or not......
<br/>
<br/>
The approach I took was to generate an 8 X 8 Font and insert my own graphic characters (representing horizontal and vertical lines, top left and right, bottom left and right corners) at arbitrary locations in the font strip(I used 0x01 through 0x08), and then drew them. Then I used the Custom Font example as a base to draw rectangles and buttons. (Constructive) comments would be appreciated.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//---------------------------------------------------------------------------------
<br/>
// Doogle's attempt at drawing 'buttons'
<br/>
// Based on various nds examples supplied with devkit
<br/>
// (with apologies to proper C Programmers)
<br/>
//---------------------------------------------------------------------------------
<br/>
<br/>
#include &lt;nds.h&gt;
<br/>
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
//Include the font header generated by grit
<br/>
<br/>
#include "font1.h"
<br/>
<br/>
PrintConsole * console;
<br/>
<br/>
void PrintChar(y,x,st){
<br/>
   /*
<br/>
   Print a Character at x,y)
<br/>
   */   
<br/>
   iprintf("\x1b[%i;%iH",x,y);
<br/>
   iprintf("%c",st);
<br/>
}
<br/>
<br/>
void DrawRect(x0,y0,x1,y1) {
<br/>
/*
<br/>
Draw a rectangle at (x0,y0),(x1,y1)
<br/>
*/
<br/>
   int i;
<br/>
   for (i=x0;i&lt;x1;i++)
<br/>
   {
<br/>
      PrintChar(i,y0,(char) 0x08); // Horizontal line (Top)
<br/>
      PrintChar(i,y1,(char) 0x01); // Horizontal line (Bottom)
<br/>
   }
<br/>
   for (i = y0;i&lt;y1;i++)
<br/>
   {
<br/>
      PrintChar(x0,i,(char) 0x02); // Vertical line (Left)
<br/>
      PrintChar(x1,i,(char) 0x03); // Vertical line (Right)
<br/>
   }
<br/>
   PrintChar(x0,y0, (char) 0x05); // Top LH Corner
<br/>
   PrintChar(x0,y1, (char) 0x06); // Bottom LH Corner
<br/>
   PrintChar(x1,y0, (char) 0x04); // Top RH Corner
<br/>
   PrintChar(x1,y1, (char) 0x07); // Bottom RH Corner
<br/>
}
<br/>
<br/>
void DrawButton(int x0,int y0,int x1,int y1, char *st){
<br/>
/*
<br/>
Draw a Button at (x0,y0), (x1,y1)
<br/>
*/
<br/>
   int i=0;
<br/>
   DrawRect(x0,y0,x1,y1);
<br/>
   while (*st){
<br/>
   /*
<br/>
   This sort of centers the text within the rectangle
<br/>
   It's missing loads of tests to make sure it fits etc
<br/>
   but that can come later
<br/>
   */
<br/>
      PrintChar(x0 + sizeof(st)/2 + i,((y1-y0)/2)+y0,*st);
<br/>
      st++;
<br/>
      i++;
<br/>
   }
<br/>
}
<br/>
   
<br/>
int main(void) {
<br/>
/*
<br/>
Most of this code was lifted from the 'Custom Font' example
<br/>
*/
<br/>
   const int tile_base = 0;
<br/>
   const int map_base = 20;
<br/>
<br/>
   videoSetModeSub(MODE_0_2D);   
<br/>
   vramSetBankC(VRAM_C_SUB_BG); 
<br/>
<br/>
   console = consoleInit(0,0, BgType_Text4bpp, BgSize_T_256x256, map_base, tile_base, false);
<br/>
   ConsoleFont font;
<br/>
<br/>
   font.gfx = (u16*)font1Tiles;
<br/>
   font.pal = (u16*)font1Pal;
<br/>
   font.numChars = 128;
<br/>
   font.numColors =  font1PalLen / 2;
<br/>
   font.bpp = 8;
<br/>
   font.asciiOffset = 0;
<br/>
   font.convertSingleColor = false;
<br/>
   consoleSetFont(console, &amp;font);
<br/>
   
<br/>
   DrawButton(6,0,16,4,"Option 1");
<br/>
   DrawButton(12,6,22,8,"Option 2");
<br/>
   DrawButton(1,10,12,14,"Option 3");
<br/>
   
<br/>
   while(1) {
<br/>
      swiWaitForVBlank();
<br/>
   }
<br/>
<br/>
   return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
This really is good fun !!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
