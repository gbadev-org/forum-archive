<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Old project doesn't build on newer devkit - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Old project doesn't build on newer devkit</h2>
<div id="posts">
<div class="post">
    <h4>#177561 - strat - Thu Aug 30, 2012 10:53 am</h4>
    <div class="postbody"><span class="postbody">I've been thinking about adding an image loader to Animanatee but it doesn't build correctly on release 41; the binary just crashes when trying to run on the hardware without showing anything.  It does build correctly on an older devkit release that by chance I had installed on another computer, but since older releases aren't readily available the mystery needs to be solved.
<br/>
<br/>
There are two changes to the source that are needed so 41 builds anything at all: removing -fno-fpu (linker option) from the makefile and changing 'diropen', 'dirclose' in Game.c to 'opendir', 'closedir'.  I'm assuming that option just told the linker not to include an fpu library and the latter change shouldn't affect the application starting up in any case.  One poster on the Devkitpro forum suggested removing irqInit call from the Arm9 Main and any custom FIFO code, but neither is in the source.
<br/>
<br/>
Also I tried dldi patching it even though the binary released by DekuTree didn't need to be patched.  I've been looking at the devkit examples for clues but nothing stands out.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177562 - sverx - Thu Aug 30, 2012 2:17 pm</h4>
    <div class="postbody"><span class="postbody">Are you using arm7 custom code, by chance?
<br/>
You should remove both irqInit() and irqEnable(IRQ_VBLANK) or something similar from your source AFAIR...<br/>_________________<br/><a class="postlink" href="http://bit.ly/yiQrz9" target="_blank">libXM7</a>|<a class="postlink" href="http://bit.ly/yJwcOo" target="_blank">NDS programming tutorial (Italiano)</a>|<a class="postlink" href="http://disjointedstudio.blogspot.com/" target="_blank">Waimanu DS / GBA</a>|<a class="postlink" href="http://adshomebrewersdiary.blogspot.com" target="_blank">A DS Homebrewer's Diary</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177563 - strat - Thu Aug 30, 2012 7:09 pm</h4>
    <div class="postbody"><span class="postbody">I think irqInit still has to be called from Arm7, but not Arm9 (Because it was added to the start-up code).  Also, Animanatee doesn't have any Arm7 code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177564 - sverx - Fri Aug 31, 2012 8:01 am</h4>
    <div class="postbody"><span class="postbody">If you're not using any custom arm7 code then don't worry about it :) In the arm9 code though you have to remove both irqInit() and irqEnable(IRQ_VBLANK), I've been comparing an old version of one of my sources against a newer one and I confirm those should go away.
<br/>
<br/>
Are you using the old IPC struct for interprocessor communications? Those should go away too, and should be replaced with the various FIFO library functions.<br/>_________________<br/><a class="postlink" href="http://bit.ly/yiQrz9" target="_blank">libXM7</a>|<a class="postlink" href="http://bit.ly/yJwcOo" target="_blank">NDS programming tutorial (Italiano)</a>|<a class="postlink" href="http://disjointedstudio.blogspot.com/" target="_blank">Waimanu DS / GBA</a>|<a class="postlink" href="http://adshomebrewersdiary.blogspot.com" target="_blank">A DS Homebrewer's Diary</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
