<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Alpha blending questioning - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Alpha blending questioning</h2>
<div id="posts">
<div class="post">
    <h4>#154127 - abszero - Fri Apr 11, 2008 7:32 pm</h4>
    <div class="postbody"><span class="postbody">Sorry to bring up alpha blending again - I know it's been overdone but I've been beating my head against it for a couple days now and something must be wrong.
<br/>
<br/>
The setup is that I've got two layers I've been working with and now I want to add a third layer, filled with a flat color, that is blended and windowed above the other two.  The effect should be that the entire original display (bottom two layers) is shaded except for the portion inside a window.  
<br/>
<br/>
I sorta have windowing working in general, but the blending is not going well.  So for now I will focus on JUST THE BLENDING, WITHOUT WINDOWING &lt;/clarity&gt;.
<br/>
<br/>
The three layers are configured as below under Mode 5:
<br/>
<br/>
Top layer, with the blending and windowing
<br/>
BG0: BG_COLOR_256, BG_PRIORITY(1);
<br/>
<br/>
Middle layer, binary mode for text
<br/>
BG3: BG_BMP8_256x256, BG_PRIORITY(2);
<br/>
<br/>
Bottom layer, tile mode for backgrounds (all pixels are opaque so the backdrop isn't seen)
<br/>
BG1: BG_COLOR_256, BG_PRIORITY(3);
<br/>
<br/>
There are additionally sprites that exist at priorities 2 and 3 which should also appear shaded by the transparent layer.  
<br/>
<br/>
My blending register is configured thusly:
<br/>
<br/>
#define WINDOW_BLEND_AMOUNT 8
<br/>
#define BLEND_VALUE(x) (x) | ((0x10 - (x)) &lt;&lt; 8)
<br/>
<br/>
BLEND_CR     = BLEND_ALPHA | BLEND_SRC_BG0 | BLEND_DST_BG1 | BLEND_DST_BG3 | BLEND_DST_SPRITE;
<br/>
BLEND_AB     = BLEND_VALUE(WINDOW_BLEND_AMOUNT);
<br/>
<br/>
Though I have also written some code that runs through all the possible BLEND_DST combinations and none of them work the way I want. 
<br/>
<br/>
Any thoughts?  I read something somewhere that sounded like the blend destination might have to be exactly one priority level greater than the source.  Is that the case / my problem?  Thanks for any suggestions.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
