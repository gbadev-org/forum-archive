<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>3D rendering on top of 2D backgrounds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > 3D rendering on top of 2D backgrounds</h2>
<div id="posts">
<div class="post">
    <h4>#98330 - Lick - Mon Aug 14, 2006 6:49 pm</h4>
    <div class="postbody"><span class="postbody">Hey guys,
<br/>
<br/>
I'm trying to  draw 3D objects (actually, they're textured quads) on top of the 2D drawn backgrounds and unsurprisingly, it does not work.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">        powerON(POWER_ALL);
<br/>
<br/>
       videoSetMode(
<br/>
            MODE_5_3D |
<br/>
            DISPLAY_BG0_ACTIVE |
<br/>
            DISPLAY_BG1_ACTIVE |
<br/>
            DISPLAY_SPR_ACTIVE |
<br/>
            DISPLAY_SPR_1D |
<br/>
            DISPLAY_SPR_1D_BMP);
<br/>
<br/>
       videoSetModeSub(MODE_0_2D 
<br/>
            | DISPLAY_BG0_ACTIVE | DISPLAY_BG1_ACTIVE);
<br/>
<br/>
        vramSetMainBanks(VRAM_A_MAIN_BG, VRAM_B_MAIN_BG, 
<br/>
            VRAM_C_SUB_BG, VRAM_D_TEXTURE);
<br/>
        vramSetBankF(VRAM_F_MAIN_SPRITE);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I have set BG0's (3D) priority to 0 and BG1's (2D) priority to 1 (tested 2, 3 also). However it seems like the 3D rendering is working correctly, but it overrides my 2D memory, as I get garbage image data but my map data still creates the 'shapes' of my tiled background.
<br/>
So It's probably something with the VRAM, but what..
<br/>
<br/>
Has anyone successfully done this yet, by the way?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98331 - MaHe - Mon Aug 14, 2006 7:07 pm</h4>
    <div class="postbody"><span class="postbody">It's definitely possible (Submarine Tech Demo, New Super Mario Bros), however, I can't seem to work it out either ...<br/>_________________<br/><span style="font-size: 9px; line-height: normal">[ Crimson and Black Nintendo DS Lite | CycloDS Evolution | EZ-Flash 3-in-1 | 1 GB Transcend microSD ]</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98336 - Lick - Mon Aug 14, 2006 7:16 pm</h4>
    <div class="postbody"><span class="postbody">Would involving the screen capturer make it slower or is that the correct way of doing it? I've no idea.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98342 - omaremad - Mon Aug 14, 2006 8:09 pm</h4>
    <div class="postbody"><span class="postbody">i have done it in my waves demo, its pretty easy make sure the clear depth for 3d is black and use this code
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
BG2_CR = BG_BMP16_256x256 | BLEND_ALPHA | BG_PRIORITY(0)|BG_WRAP_ON;
<br/>
   BG0_CR =BG_PRIORITY(3)|BLEND_ALPHA;
<br/>
   SUB_BG2_CR = BG_BMP16_256x256|BLEND_NONE;
<br/>
<br/>
   BLEND_CR = (2&lt;&lt;6) | BLEND_DST_BG2 | BLEND_SRC_BG0;
<br/>
   BLEND_AB = 15 | (15&lt;&lt;8);
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
