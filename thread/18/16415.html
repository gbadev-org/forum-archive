<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>[Help wanted] Font on 8-bit bitmap background - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > [Help wanted] Font on 8-bit bitmap background</h2>
<div id="posts">
<div class="post">
    <h4>#166425 - ChronoDK - Sat Feb 07, 2009 11:06 pm</h4>
    <div class="postbody"><span class="postbody">I'm copying font graphics to an off-screen part of a 256x256 sized bitmap background, and then writing them to the screen by copying from the off-screen to the on-screen part.
<br/>
<br/>
I had this working in 16-bit mode, but I'm trying to change it to work with a paletted bitmap instead. Can someone spot any mistakes below? I'm guessing the problem lies in the inner most loop, but I can't think of what it would be.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   std::string s = "TESTtest!";
<br/>
<br/>
   u16* screen = (u16*)bgGetGfxPtr(bg3);
<br/>
   u16* font = (u16*)bgGetGfxPtr(bg3) + (256*192);
<br/>
<br/>
   for ( int k = 0; k &lt; s.size(); k++ ) {
<br/>
      
<br/>
      //Glyph char code
<br/>
      int num = (int)s.at(k) - 32;
<br/>
      
<br/>
      //Screen coordinates
<br/>
      int sx = 0; int sy = 0; 
<br/>
<br/>
      //Glyph size
<br/>
      int w = 8; int h = 8;
<br/>
<br/>
      //Glyph coordinates
<br/>
      int fx = (num * w) - ( (num / (256/w)) * (256/w) * w ); 
<br/>
      int fy = (num / (256/h)) * h;
<br/>
      
<br/>
      //Copy font pixels from off-screen buffer to on-screen buffer
<br/>
      for ( int i = 0; i &lt; h; i++ ) {
<br/>
         for ( int j = 0; j &lt; w; j++ ) {
<br/>
            screen[((sx + j + (k * w)) + (256 * (sy + i)))/2] = font[(fx + j) + (256 * (fy + i))/2];
<br/>
         }
<br/>
      }
<br/>
   }
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166428 - Dwedit - Sun Feb 08, 2009 12:25 am</h4>
    <div class="postbody"><span class="postbody">Division by two?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166429 - ChronoDK - Sun Feb 08, 2009 12:34 am</h4>
    <div class="postbody"><span class="postbody">Yeah, that is new compared to my 16-bit bitmap code. Call it a failed attempt to fix things - :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166473 - dovoto - Sun Feb 08, 2009 6:33 pm</h4>
    <div class="postbody"><span class="postbody">You can not write to vram in 8 bits.  You have to do at least 2 bytes at a time.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
