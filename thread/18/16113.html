<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Display lists and textures - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Display lists and textures</h2>
<div id="posts">
<div class="post">
    <h4>#163651 - sarachiel - Tue Oct 07, 2008 9:00 pm</h4>
    <div class="postbody"><span class="postbody">Hi people,
<br/>
<br/>
I'm trying to have a nice 3d 'engine' on my ds. I read, understood (I hope so), and practiced every single tutorial and example I could find in the libnds examples. 
<br/>
I managed to draw some nice stuff using classical glBegin() glNormal() glVertex() glTexcoord() glEnd() routines. I am now using 3d models drawn with Blender and exported to a format supported by the 'NDSMeshConverter' provided by PadrinatoR. I fix the model using Antonio's work (every tool provided by his NitroEngine actually). This worked perfectly well for my models (I drew and animated some nice characters etc...), until I tried to apply textures on it.
<br/>
I don't use any kind of filesystem library, every item is a .bin file compiled with the rest of my NDS file.
<br/>
<br/>
My problem is - yeah noobish - that textures don't get drawn when I use display lists :/ 
<br/>
My guess is that it is my list that is flawed, since it works just fine with glBegin() etc... But how can I be sure of that ? Is there a tool or method that you suggest me to adopt to continue my work or check that my models are correctly built? My hair will all be gone soon :(
<br/>
This is the last step for me before I begin the real work on my homebrew !
<br/>
<br/>
By the way, a friend of mine asked what was better using display lists instead of simple glVertex sequences. I once saw detailed informations about this that I can't find anymore, any clue ?
<br/>
<br/>
Regards</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163655 - silent_code - Tue Oct 07, 2008 9:33 pm</h4>
    <div class="postbody"><span class="postbody">Using displaylists are the way to go, if you get serious.
<br/>
<br/>
I managed to half the framerate because of too many "immediate mode" commands in the graphics command fifo, despite the fact, that I didn't even get close to the vertex and primitive limits... which wouldn't cause a frame drop anyway. ;^)
<br/>
There's a thread about it somewhere on this forum. Please search.
<br/>
<br/>
Btw: You don't "draw" meshes and models (at least not in the context you used it), but you "model" them. :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163666 - sarachiel - Wed Oct 08, 2008 12:08 pm</h4>
    <div class="postbody"><span class="postbody">Yeah I don't have any vocabulary about this. I try to learn by myself, which is driving me mad these days. I found what I wanted to know about display lists, but not about textures.
<br/>
How the hell am I supposed to understand every specificity of the textures and how they work ? I understand 1 word on 2 in other threads. Libnds examples just work fine, but I found that, for example, glInit() has some weird behaviour when global variables aren't in the same file or something. My textures that I used in 'immediate mode' were drawn awkwardly if my texture-loading function was in another .c file (despite the global array being in the .h).
<br/>
<br/>
I even can't see what steps I should follow. I just don't get it. I mean, I do the exact same way to load textures as in 'immediate mode' and it stops working when I use my display list instead. I don't even know how I can check if the problem comes from my .bin file or my code ... doh nvm.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163667 - Dwedit - Wed Oct 08, 2008 1:04 pm</h4>
    <div class="postbody"><span class="postbody">Wait, are you declaring global variables in .h files and not making them extern?
<br/>
The rule is declare them once in any .c file, then anything else that refers to the same variable should be declared as 'extern'.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163669 - elhobbs - Wed Oct 08, 2008 1:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">Wait, are you declaring global variables in .h files and not making them extern?
<br/>
The rule is declare them once in any .c file, then anything else that refers to the same variable should be declared as 'extern'.</td> </tr></table><span class="postbody">I think he is referring to the definition of glGlob in videoGL.h which is declared as static.</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Pointer to global data for videoGL
<br/>
static gl_hidden_globals* glGlob = 0;
<br/>
</td> </tr></table><span class="postbody">so it makes a new instance in each file it is included in - this breaks some of the defines which reference this variable. glClearColor,glClearPolyID,glGetInt, and glTexCoord2f.
<br/>
<br/>
sarachiel - if you were using glTexCoord2f or glTexCoord2f32 then keep in mind that these functions are converting your values into ds texture coordinate format for you based on the selected texture. For display lists you will need to convert the coordinates yourself.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163671 - sarachiel - Wed Oct 08, 2008 1:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">if you were using glTexCoord2f or glTexCoord2f32 then keep in mind that these functions are converting your values into ds texture coordinate format for you based on the selected texture. For display lists you will need to convert the coordinates yourself.</td> </tr></table><span class="postbody">
<br/>
<br/>
I was indeed referring to glGlob. I had the problem when using glTexCoord2f yes, but not display list at that time.
<br/>
I don't understand what  you mean by "converting the coordinates myself" when using Display lists. What do you call "ds texture coordinate format" ? With fixed points coordinates ?
<br/>
<br/>
By the way, about glGlob, what should I do to avoid what I described? More important, what can I do to take advantage of it ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163674 - elhobbs - Wed Oct 08, 2008 4:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sarachiel wrote:</b></span></td> </tr> <tr> <td class="quote">I was indeed referring to glGlob. I had the problem when using glTexCoord2f yes, but not display list at that time.
<br/>
I don't understand what  you mean by "converting the coordinates myself" when using Display lists. What do you call "ds texture coordinate format" ? With fixed points coordinates ?
<br/>
<br/>
By the way, about glGlob, what should I do to avoid what I described? More important, what can I do to take advantage of it ?</td> </tr></table><span class="postbody">
<br/>
yes, it is a fixed point value. however, unlike opengl the value does not use 0.0 to 1.0 it uses 0 to texture width (in 12.4 fixed point). if you look at the definition of glTexCoord2f in videoGL.h you will see that it extracts the texture dimensions from the texture object and multiplies.
<br/>
<br/>
I am not sure what you mean by take advantage, but you either rewrite the macros that need glGlob (the ones I listed previously) or you can initialize glGlob in all of the files that reference it</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   glGlob = glGetGlobals();
<br/>
</td> </tr></table><span class="postbody">however, this must be done after glInit has been called at least once.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
