<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>fgetc ideas - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > fgetc ideas</h2>
<div id="posts">
<div class="post">
    <h4>#138170 - ghuldan - Mon Aug 20, 2007 4:45 pm</h4>
    <div class="postbody"><span class="postbody">Hello there,
<br/>
Recently i started to use fatlib and i got stuck with my poor knowledge I/O and emulator :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">FILE *pFile;
<br/>
char c;
<br/>
pFile = fopen("/Decor.tileset", "r");
<br/>
   
<br/>
if (pFile == NULL)
<br/>
   PA_OutputText("Error loading file");
<br/>
else {
<br/>
   PA_OutputText("file opened");
<br/>
   fseek(pFile , 0 , SEEK_SET);
<br/>
   c = fgetc(pFile);
<br/>
   if (ferror (pFile))
<br/>
      PA_OutputText("Error reading from file");
<br/>
   PA_OutputText("c = %d", c);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
then ideas display :
<br/>
<span style="font-weight: bold">file opened</span>
<br/>
and
<br/>
<span style="font-weight: bold">Error reading from file</span>
<br/>
<span style="font-weight: bold">c = 255</span>
<br/>
<br/>
<span style="font-style: italic">Decor.tileset</span> starts with "12096{0,0,0,0,0,0,0,0,..."
<br/>
<br/>
I Dldied my ds.gba with R4 driver, set ideas to use R4 driver ... i can open a file but can't read into it ...
<br/>
<br/>
Does anyone have any clue please ?
<br/>
<br/>
EDIT : after more tests it seems fseek return -1 too</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138171 - Lino - Mon Aug 20, 2007 5:52 pm</h4>
    <div class="postbody"><span class="postbody">You can give me yours .ds.gba? If you use the email make me know.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138183 - tepples - Mon Aug 20, 2007 8:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ghuldan wrote:</b></span></td> </tr> <tr> <td class="quote">ds.gba with R4</td> </tr></table><span class="postbody">
<br/>
ds.gba does not work on R4; it only works on SLOT-2 cards (and emulators that emulate SLOT-2 cards). Have you tried using FCSR?
<br/>
<br/>
And does your code call fatInitDefault?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138215 - NorQue - Tue Aug 21, 2007 7:46 am</h4>
    <div class="postbody"><span class="postbody">One rather obvious error is the space between ferror and (pfile) in this line: </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   if (ferror (pFile))</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138223 - ghuldan - Tue Aug 21, 2007 11:19 am</h4>
    <div class="postbody"><span class="postbody">I finally managed to get it to work.
<br/>
It was te fault of my slightly modified PA_loadsimpleBG, where i do multiples DMA calls instead of one : I saw somewhere DLDI drivers don't like too much you tickle the DMA thing ... In fact when i used MY_loadsimpleBG, backgrounds would not appear ... and files would be read ... I didnot see the connection ^^ , was first time on Ideas, which i never got to display anything by the past ...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">ds.gba does not work on R4; it only works on SLOT-2 cards (and emulators that emulate SLOT-2 cards). Have you tried using FCSR?</td> </tr></table><span class="postbody">
<br/>
I use Ideas now ;)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">One rather obvious error is the space between ferror and (pfile) in this line:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (ferror (pFile))</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Ah that was it ! thanks
<br/>
<br/>
Thanks to all, this forum is pretty much cool ...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138228 - chishm - Tue Aug 21, 2007 12:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>NorQue wrote:</b></span></td> </tr> <tr> <td class="quote">One rather obvious error is the space between ferror and (pfile) in this line: <table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   if (ferror (pFile))</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Uh, what? White space should have no effect in this case. You could even write it </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> if             ( 
<br/>
ferror
<br/>
                             (
<br/>
pFile)
<br/>
<br/>
<br/>
)</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138250 - NorQue - Tue Aug 21, 2007 8:18 pm</h4>
    <div class="postbody"><span class="postbody">Really? I thought spaces weren't allowed in function calls? Looks like it's not when the space is in the end of a call... quick skimming through Schildt and K&amp;R showed nothing in this direction, guess you're right. You should know of all people. ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138252 - tondopie - Tue Aug 21, 2007 8:37 pm</h4>
    <div class="postbody"><span class="postbody">putting a space between 'if' and '(' or 'void function' and '(void);' never hurt anyone did it? ;)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
