<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>My 3dmax/gmax model exporter - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > My 3dmax/gmax model exporter</h2>
<div id="posts">
<div class="post">
    <h4>#108195 - chrissieboy - Mon Nov 06, 2006 4:31 pm</h4>
    <div class="postbody"><span class="postbody">Hi guys, im busy with building a script for 3dmax/gmax to export the models to header files, just like the maya exporter.
<br/>
<br/>
But i tried to analyse the ouput from the maya exporter, but it not realy make any sense to me?
<br/>
<br/>
I'll try to explain my problem, with this code : 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
FIFO_COMMAND_PACK(FIFO_BEGIN, FIFO_TEX_COORD, FIFO_COLOR, FIFO_VERTEX16),
<br/>
GL_TRIANGLE,
<br/>
TEXTURE_PACK(inttot16(0),inttot16(117)),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2619139552),floattov16(0.125)), VERTEX_PACK(floattov16(-0.1084881499),0),
<br/>
<br/>
FIFO_COMMAND_PACK(FIFO_TEX_COORD, FIFO_COLOR, FIFO_VERTEX16, FIFO_TEX_COORD),
<br/>
TEXTURE_PACK(inttot16(8),inttot16(117)),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.9004603148),floattov16(0.125)), VERTEX_PACK(floattov16(-0.200460121),0),
<br/>
TEXTURE_PACK(inttot16(0),inttot16(128)),
<br/>
<br/>
FIFO_COMMAND_PACK(FIFO_COLOR, FIFO_VERTEX16, FIFO_TEX_COORD, FIFO_COLOR),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2309698611),floattov16(0)), VERTEX_PACK(floattov16(-0.09567070752),0),
<br/>
TEXTURE_PACK(inttot16(8),inttot16(128)),
<br/>
RGB15(31,31,31),
<br/>
<br/>
<br/>
<br/>
FIFO_COMMAND_PACK(FIFO_VERTEX16, FIFO_TEX_COORD, FIFO_COLOR, FIFO_VERTEX16),
<br/>
VERTEX_PACK(floattov16(0.176776737),floattov16(0)), VERTEX_PACK(floattov16(-0.1767765582),0),
<br/>
TEXTURE_PACK(inttot16(0),inttot16(128)),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2309698611),floattov16(0)), VERTEX_PACK(floattov16(-0.09567070752),0),
<br/>
<br/>
FIFO_COMMAND_PACK(FIFO_TEX_COORD, FIFO_COLOR, FIFO_VERTEX16, FIFO_TEX_COORD),
<br/>
TEXTURE_PACK(inttot16(8),inttot16(117)),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2004603148),floattov16(0.125)), VERTEX_PACK(floattov16(-0.200460121),0),
<br/>
TEXTURE_PACK(inttot16(8),inttot16(117)),
<br/>
<br/>
FIFO_COMMAND_PACK(FIFO_COLOR, FIFO_VERTEX16, FIFO_TEX_COORD, FIFO_COLOR),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2004603148),floattov16(0.125)), VERTEX_PACK(floattov16(-0.200460121),0),
<br/>
TEXTURE_PACK(inttot16(16),inttot16(117)),
<br/>
RGB15(31,31,31),
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
the first problem is in here : 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
FIFO_COMMAND_PACK(FIFO_COLOR, FIFO_VERTEX16, FIFO_TEX_COORD, FIFO_COLOR),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2309698611),floattov16(0)), VERTEX_PACK(floattov16(-0.09567070752),0),
<br/>
TEXTURE_PACK(inttot16(8),inttot16(128)),
<br/>
RGB15(31,31,31),
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
it send 2 times the FIFO_COLOR with the same value RGB15(31,31,31).
<br/>
when i change the color of it in the first part is works, but the second part doesn't do anything?
<br/>
<br/>
But i was thinking that this is just garbage to fill the chunks to make it 4 bytes??
<br/>
<br/>
Because later in the output i saw this :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
FIFO_COMMAND_PACK(FIFO_COLOR, FIFO_VERTEX16, FIFO_TEX_COORD, FIFO_COLOR),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2309698611),floattov16(0)), VERTEX_PACK(floattov16(-0.09567070752),0),
<br/>
TEXTURE_PACK(inttot16(8),inttot16(128)),
<br/>
RGB15(31,31,31),
<br/>
<br/>
<br/>
<br/>
FIFO_COMMAND_PACK(FIFO_VERTEX16, FIFO_TEX_COORD, FIFO_COLOR, FIFO_VERTEX16),
<br/>
VERTEX_PACK(floattov16(0.176776737),floattov16(0)), VERTEX_PACK(floattov16(-0.1767765582),0),
<br/>
TEXTURE_PACK(inttot16(0),inttot16(128)),
<br/>
RGB15(31,31,31),
<br/>
VERTEX_PACK(floattov16(0.2309698611),floattov16(0)), VERTEX_PACK(floattov16(-0.09567070752),0),
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
in the second part 2 times the FIFO_VERTEX16 was send, but in the last part of the second part there's this code :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
VERTEX_PACK(floattov16(0.2309698611),floattov16(0)), VERTEX_PACK(floattov16(-0.09567070752),0),
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
its exactly the same as in the first part!
<br/>
<br/>
So i was really thinking that this is just to fill the fifo or something?
<br/>
<br/>
Am i right??
<br/>
<br/>
<br/>
<br/>
(sorry for my bad english, im dutch)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108200 - Sausage Boy - Mon Nov 06, 2006 5:16 pm</h4>
    <div class="postbody"><span class="postbody">Sounds like you're thinking of the display lists in chunks. Don't do that. Remove all the FIFO_COMMAND_PACK's in your brain, and think of it as a continuous stream of commands.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108205 - sajiimori - Mon Nov 06, 2006 6:55 pm</h4>
    <div class="postbody"><span class="postbody">Right.  Also, the exporter is setting the color several times, but since it's always white it could be set once at the beginning.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108217 - chrissieboy - Mon Nov 06, 2006 8:26 pm</h4>
    <div class="postbody"><span class="postbody">ok sausage boy! But i thought maybe the maya exporter fills the chunks with double data to fill 4 bytes? but that isn't the reason??
<br/>
<br/>
sajiimori this i why i thought the exporter fills the holes with double data??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108218 - Sausage Boy - Mon Nov 06, 2006 8:28 pm</h4>
    <div class="postbody"><span class="postbody">There are no holes, the "fill data" is just the data for the next verticles.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108223 - sajiimori - Mon Nov 06, 2006 9:33 pm</h4>
    <div class="postbody"><span class="postbody">The extra color commands are just because the exporter doesn't optimize out color commands when they're the same as the previous one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108505 - ikaris - Thu Nov 09, 2006 6:15 pm</h4>
    <div class="postbody"><span class="postbody">Hi chrissieboy,
<br/>
<br/>
I wrote the Maya exporter, and I'd be more than happy to answer any of your questions.
<br/>
<br/>
If you look at the source code of my exporter, you will find I added A LOT of comments... amongst them:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
// To find size of the u32, calculate how many commands (i.e. VERTEX_PACK, FIFO_COMMAND_PACK, etc...)
<br/>
// will be used.Â  This is calculated as follows:
<br/>
// - Vertex positions are worth 2 (they use 2 VERTEX_PACK commands)
<br/>
// - Vertex normals are worth 1 (they use one NORMAL_PACK command)
<br/>
// - Vertex color are worth 1 (they use the single RGB15)
<br/>
// - Texture coordinates are worth 1 (they use one TEXTURE_PACK), since we hold U and V data, divide by 2
<br/>
// - The rendering style is worth 1 (such as GL_TRIANGLE)
<br/>
// - The number of times FIFO_COMMAND_PACK is called, rounded up
<br/>
//</td> </tr></table><span class="postbody">
<br/>
<br/>
If you look around that part of the file, you'll see the loop that builds the data... it might help you.
<br/>
<br/>
Hope this helps !</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
