<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Wifiloader BETA 1.2 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Wifiloader BETA 1.2</h2>
<div id="posts">
<div class="post">
    <h4>#108532 - Hermes - Thu Nov 09, 2006 10:51 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
for a few days, i have been released a little utility for the DS developers.
<br/>
<br/>
This utility is thinking to load an application via WIFI directly in the RAM, without access to the SD or CF.
<br/>
<br/>
The utility have the abilty to do a softreset using the key combination L+R+START+SELECT to return again to the Wifiloader application.
<br/>
<br/>
Of course, it is not compatible with a filsystem in ROM, because you only have the appllication in RAM. It is capable to load an application of 3MB.
<br/>
<br/>
It is very easy to use and connect to your PC using the WFC datas and the port 9999.
<br/>
<br/>
This port can be changed using a little tool to add a txt file with the configuration datas (for example, the new port to access)
<br/>
<br/>
I have compiled the server under MinGW enviroment and i include the source code of this server too. To change the port  here, use the line command:  wifiloader 5555  and it  change the port to 5555
<br/>
<br/>
<br/>
The last release have support for 128 bit WEP. I have finded and resolved  a little bug on the WIFI Lib  and now, it work fine with mi AP  :)
<br/>
<br/>
I hope you undestand to me (i am spanish and  i have problems to speak in english ;) )
<br/>
<br/>
Download here:
<br/>
<br/>
<a href="http://mods.elotrolado.net/~hermes/wifiloader_beta1.2.rar" target="_blank">http://mods.elotrolado.net/~hermes/wifiloader_beta1.2.rar</a>
<br/>
<br/>
<br/>
I am working to release the new version of my eSound  and Multithread library's with some news thinks and WIFI integrated. The source code of Wifiloader  is part of this release,  patience ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108537 - Lick - Thu Nov 09, 2006 11:27 pm</h4>
    <div class="postbody"><span class="postbody">Nice! I will try it out tomorrow!<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108549 - Izhido - Fri Nov 10, 2006 12:30 am</h4>
    <div class="postbody"><span class="postbody">Wow! Fantastic! If this really works, it might become a major step for the homebrewing scene. No need for a intermediate "flashcarting" step to test apps anymore! At least, for us owners of a WiFi card on our PC... 
<br/>
<br/>
This is gonna be huge... congratulations, Hermes!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108564 - tepples - Fri Nov 10, 2006 2:24 am</h4>
    <div class="postbody"><span class="postbody">Good idea.
<br/>
<br/>
Feature request: Would it be hard to make the program use the industry-standard HTTP wire protocol to fetch the .nds file from the PC? This would let any computer with an operating system capable of running <a class="postlink" href="http://httpd.apache.org/" target="_blank">Apache HTTP Server</a> (i.e. Windows, Mac OS, and Linux, on any CPU) act as a server.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108582 - scanlime - Fri Nov 10, 2006 6:53 am</h4>
    <div class="postbody"><span class="postbody">Wow, quite a coincidence... I wrote a very similar program last week.
<br/>
<br/>
Mine uses a very slightly different approach:
<br/>
<br/>
1. It stores the downloaded image in the GBAROM area. It is written for the EZFlash IV, which has 32MB of RAM mapped here. If you have another GBA flash card which uses RAM, you may be able to trivially modify my loader to work with it.
<br/>
<br/>
2. Instead of connecting back to a server running on your PC, my loader listens for incoming TCP connections. You can dump a raw .gba, .ds.gba, or .nds file to TCP port 6502 on your DS, it stores that image in GBAROM, then bootstraps it.
<br/>
<br/>
3. It knows how to bootstrap .ds.gba-style images off the GBAROM, and how to run GBA games in compatibility mode. It will automatically detect .nds files and prepend the ndsmall.bin loader.
<br/>
<br/>
4. It does support returning back to the bootloader, but not via patching the ROM. I include a small header file that you can use in your homebrew games to jump back to the loader at any time. This is implemented by having the bootloader relocate a copy of itself to the very top of GBAROM, then store an entry point address in an unused portion of the NDS header at the top of main RAM.
<br/>
<br/>
The source code is BSD-licensed, and it's up on a public <a class="postlink" href="http://subversion.org" target="_blank">Subversion</a> server:
<br/>
<a class="postlink" href="http://svn.navi.cx/misc/trunk/nds/wifi-ez4-loader/" target="_blank">http://svn.navi.cx/misc/trunk/nds/wifi-ez4-loader/</a>
<br/>
<br/>
And here's the example project that shows you how to return to the bootloader from your own homebrew code:
<br/>
<a class="postlink" href="http://svn.navi.cx/misc/trunk/nds/loader-template/" target="_blank">http://svn.navi.cx/misc/trunk/nds/loader-template/</a>
<br/>
<br/>
Here's a snapshot release, including source and binaries:
<br/>
<a class="postlink" href="http://releases.navi.cx/nds/wifi-ez4-loader-20061109.zip" target="_blank">http://releases.navi.cx/nds/wifi-ez4-loader-20061109.zip</a>
<br/>
<br/>
Remember, my loader is only known to work with the EZFlash IV Lite Deluxe! It may work with other flash cards, but try it at your own risk. It will probably require at least a little modification to un-writeprotect the RAM on your card.
<br/>
<br/>
If you want to run games directly out of RAM, it sounds like Hermes' loader is exaclty what you need. If you want to run large images out of GBAROM and you have an EZ4, this might work better.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108603 - EyeballKid - Fri Nov 10, 2006 11:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Good idea.
<br/>
<br/>
Feature request: Would it be hard to make the program use the industry-standard HTTP wire protocol to fetch the .nds file from the PC? This would let any computer with an operating system capable of running <a class="postlink" href="http://httpd.apache.org/" target="_blank">Apache HTTP Server</a> (i.e. Windows, Mac OS, and Linux, on any CPU) act as a server.</td> </tr></table><span class="postbody">
<br/>
<br/>
Just thought I should plug my HTTP library: <a class="postlink" href="http://www.scumways.com/happyhttp/happyhttp.html" target="_blank">HappyHTTP</a>.
<br/>
There are better HTTP libs out there (eg libcurl), but HappyHTTP is easy to get running on the DS, is easy to use, and simple to integrate (one header file and one .cpp file).
<br/>
(My <a class="postlink" href="http://www.scumways.com/dslurper" target="_blank">DSlurper</a> tool uses it)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108657 - diggla - Sat Nov 11, 2006 12:41 am</h4>
    <div class="postbody"><span class="postbody">where can i set the ip of the pc so my nds connects to the correct ip? the wfc data uses my dsl router as gateway and not my pc.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#111872 - falco216 - Mon Dec 11, 2006 7:22 am</h4>
    <div class="postbody"><span class="postbody">i dont understand how to work this, step by step instructions please.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#112472 - pas - Sat Dec 16, 2006 6:03 pm</h4>
    <div class="postbody"><span class="postbody">Strange... If I start the PC Application, then start the DS Application, both on the defaultport 9999, and: Nothing happens... No Window pops up that let's me choos a .nds data. What Am I doing wrong ? My Wifisettings are configured properly and work with every Homebrew out there (I use a Router). Any Ideas ?
<br/>
<br/>
Greets:
<br/>
<br/>
Pas</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#112479 - Dark Knight ez - Sat Dec 16, 2006 7:15 pm</h4>
    <div class="postbody"><span class="postbody">Try the newer wifiloader (beta) update. That one lets you specify what computer is running the server program (which is probably what you need).
<br/>
I'd link you to it, but I forgot the link. He only posted it on some Spanish website. Search for it.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#112536 - pas - Sun Dec 17, 2006 7:29 pm</h4>
    <div class="postbody"><span class="postbody">Isn't the Downloadlink he postet her the Beta ???</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#112539 - Dark Knight ez - Sun Dec 17, 2006 7:36 pm</h4>
    <div class="postbody"><span class="postbody">A newer version, I said.
<br/>
<br/>
In <a class="postlink" href="http://www.elotrolado.net/showthread.php?s=28352dea39bcea16b073cb9cde21d612&amp;threadid=638767&amp;perpage=10&amp;pagenumber=8" target="_blank">this topic</a> I found <a class="postlink" href="http://mods.elotrolado.net/~hermes/wifiloader.1.5_release_candidate.rar" target="_blank">this link</a>.
<br/>
<br/>
It's beta 1.5. Unofficial release.
<br/>
<br/>
You'll need to first unpack beta 1.2 and then overwrite some of those files with files in this 1.5 zip. Only the .nds file and the textfile are new, I think. The server executable remains the same. Read the instructions on how to use this properly.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113158 - pas - Sat Dec 23, 2006 8:25 pm</h4>
    <div class="postbody"><span class="postbody">@Dark Knight ez: Could you please explain me how to get this to work ? I don't get it, even with version 1,5...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113164 - Dark Knight ez - Sat Dec 23, 2006 9:42 pm</h4>
    <div class="postbody"><span class="postbody">========= Installing =========
<br/>
1) Set your Wifi Connection with an official Wifi Connection game such as Mario Kart DS. Make sure you can play internet matches, which means you can succesfully connect to your router (and the internet).
<br/>
<br/>
2) Download and unpack beta 1.2 zipfile.
<br/>
3) Download and unpack beta 1.5 zipfile at the same place, overwriting some of the files from beta 1.2.
<br/>
4) Edit the textfile wificfg.txt (NDS folder of the unpacked files) to this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">&lt;WIFICFG&gt;
<br/>
PCIP= 192.168.0.1
<br/>
AUTO= 1
<br/>
&lt;/WIFICFG&gt;</td> </tr></table><span class="postbody">
<br/>
<br/>
Where 192.168.0.1 is your own PC's IP address in your local area network. (The IP address which your router sees your PC as.)
<br/>
<br/>
5) Run wifiloader_cfg_changer.bat (same folder as wificfg.txt)
<br/>
6) Put the .nds or .ds.gba file in that folder on your NDS.
<br/>
<br/>
Note that if you did these steps and later realise that you put in the wrong IP address, you will have to do all these steps over again (except for step 1), including steps 2 and 3.
<br/>
<br/>
========= Running =========
<br/>
1) Run wifiloader.exe on your computer (PC folder of the unpacked files)
<br/>
2) Run the .nds or .ds.gba file on your NDS.
<br/>
3) You'll be able to select what .nds or .ds.gba file you wish to load by wifiloader.exe when the NDS has succesfully connected to your PC.
<br/>
<br/>
<br/>
That's it. If you're not able to get it to work, don't bother.
<br/>
It seems that due to this wifiloader rewriting some code of the .nds or .ds.gba file you "download" to your NDS (in order to be able to soft reset itself), a lot of games and applications don't work properly. (Unfortunately. It's the only real downside to this program.)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113182 - dantheman - Sun Dec 24, 2006 3:15 am</h4>
    <div class="postbody"><span class="postbody">Thank you for the mini guide.  It works well on a few games (DELite and the WMB version of DSLinux for instance)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113285 - devine - Tue Dec 26, 2006 1:27 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>scanlime wrote:</b></span></td> </tr> <tr> <td class="quote">1. It stores the downloaded image in the GBAROM area. It is written for the EZFlash IV, which has 32MB of RAM mapped here. If you have another GBA flash card which uses RAM, you may be able to trivially modify my loader to work with it.</td> </tr></table><span class="postbody">
<br/>
<br/>
This is seriously awesome! With a couple of minor modifications I was able to make wifiloader run on my SD Mini &amp; M3 Lite. Your program is 10x better than wmbhost, restarting a program is almost instant! It's just like a dream come true :)
<br/>
<br/>
Here is <a class="postlink" href="http://www.cr0.net/code/wifiloader.zip" target="_blank">a version of wifiloader with support for SC/M3</a>, let me know if it works well. Included is also nc.exe and the Hello, world program (which  demonstrates the restart feature). (Note: WFC must be configured before running wifiloader.nds)
<br/>
<br/>
Again, great work! ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113297 - dantheman - Tue Dec 26, 2006 8:23 am</h4>
    <div class="postbody"><span class="postbody">devine, I can't seem to get it to work.  I've got a Supercard miniSD and I copied the file onto my miniSD card and ran it.  It connected to my network fine and started listening on 192.168.1.125:6502.  I then opened a command window, navigated to the wifiloader directory, and typed
<br/>
nc 192.168.1.125 6502 &lt; hello.nds
<br/>
and although the DS says "accepted 192.168.1.123:4567" it doesn't appear to be transmitting anything.  Am I doing something wrong?  Typing the wrong command?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113310 - devine - Tue Dec 26, 2006 12:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dantheman wrote:</b></span></td> </tr> <tr> <td class="quote">although the DS says "accepted 192.168.1.123:4567" it doesn't appear to be transmitting anything.  Am I doing something wrong?  Typing the wrong command?</td> </tr></table><span class="postbody">
<br/>
<br/>
Nope, had the same problem. You have to kill netcat with Ctrl-C so that wifiloader detects that the connection is closed.
<br/>
<br/>
EDIT: found an option to make nc exit after sending the nds:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">nc.exe -w 1 192.168.1.60 6502 &lt; hello.nds</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113345 - devine - Tue Dec 26, 2006 10:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>devine wrote:</b></span></td> </tr> <tr> <td class="quote">Here is <a class="postlink" href="http://www.cr0.net/code/wifiloader.zip" target="_blank">a version of wifiloader with support for SC/M3</a>, let me know if it works well. Included is also nc.exe and the Hello, world program (which  demonstrates the restart feature). (Note: WFC must be configured before running wifiloader.nds)</td> </tr></table><span class="postbody">
<br/>
I updated the version above with the unlock code for the G6, if anyone wants to give it a try ;-)
<br/>
<br/>
EDIT: although wifiloader can be streamed over wmbhost, after uploading a nds the program fails to start. Probably some kind of bad interaction with WMB.
<br/>
.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114098 - Hermes - Wed Jan 03, 2007 11:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dark Knight ez wrote:</b></span></td> </tr> <tr> <td class="quote">A newer version, I said.
<br/>
<br/>
In <a class="postlink" href="http://www.elotrolado.net/showthread.php?s=28352dea39bcea16b073cb9cde21d612&amp;threadid=638767&amp;perpage=10&amp;pagenumber=8" target="_blank">this topic</a> I found <a class="postlink" href="http://mods.elotrolado.net/~hermes/wifiloader.1.5_release_candidate.rar" target="_blank">this link</a>.
<br/>
<br/>
It's beta 1.5. Unofficial release.
<br/>
<br/>
You'll need to first unpack beta 1.2 and then overwrite some of those files with files in this 1.5 zip. Only the .nds file and the textfile are new, I think. The server executable remains the same. Read the instructions on how to use this properly.</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
The official release of WIFILOADER 1.5 is part of  the examples of "eLIBS".
<br/>
<br/>
You can download from here:
<br/>
<br/>
<a href="http://mods.elotrolado.net/~hermes/eLIBS_release_2.rar" target="_blank">http://mods.elotrolado.net/~hermes/eLIBS_release_2.rar</a>
<br/>
<br/>
<br/>
It include the libraries with all the source code and some docs.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114151 - laichung - Thu Jan 04, 2007 5:42 pm</h4>
    <div class="postbody"><span class="postbody">Thx for the libraries~
<br/>
<br/>
I tested it with the lastest slot 1 card R4, it load homebrew fine.
<br/>
But the restart patch is not work, do I need to write some code to make it work in my program? thanks ~~</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114488 - Hermes - Mon Jan 08, 2007 10:56 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>laichung wrote:</b></span></td> </tr> <tr> <td class="quote">Thx for the libraries~
<br/>
<br/>
I tested it with the lastest slot 1 card R4, it load homebrew fine.
<br/>
But the restart patch is not work, do I need to write some code to make it work in my program? thanks ~~</td> </tr></table><span class="postbody">
<br/>
<br/>
I cannot test it with one slot 1 card, because i only have M3 Perfect SD.
<br/>
<br/>
To restart a program is a good idea to read a key in your homebrew program and jump to a routine to "do nothing" (to avoid your program read datas from your card  or process 3D polygons at same time you apply the soft reset).
<br/>
<br/>
But, it is necessary the ROM file is mapped from 0x08000000 address.
<br/>
<br/>
In my code (in asm.s) you can find  two littles routines:
<br/>
<br/>
@ shutdown SC-EFA2
<br/>
@ shutdown M3
<br/>
<br/>
This code is provide  to change from the FAT mode access (to the CF/SD), to the ROM mode access of this cards, if you are using a FAT file system.
<br/>
<br/>
Maybe, it is necessary a similar code to detect your card and change the mode.
<br/>
<br/>
In this  forum there are people who have better knowledge than I about this question (i only can test with my M3 card :/ )</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
