<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Calling a function on the ARM7 when a button is pressed. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Calling a function on the ARM7 when a button is pressed.</h2>
<div id="posts">
<div class="post">
    <h4>#128619 - tondopie - Sun May 13, 2007 2:57 pm</h4>
    <div class="postbody"><span class="postbody">SO I finally was able to get a GBA booting code running on DKA r20 working thanks to wintermute telling me that the 'S' in 'gbaScreen' was supposed to be capitolized... (There's my cluelessness again). After a long confusing discussion with strager on #tod2 , i was wondering if there was a reletivly easy way to call the arm7 side of the booting code when the arm9 says its ok (When a button (Start) is pressed). Help is very much apperciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#128620 - simonjhall - Sun May 13, 2007 3:17 pm</h4>
    <div class="postbody"><span class="postbody">If you want the arm7 to do something when the arm9 wants it to, the normal way is to have some kind of inter-processor communication going on.
<br/>
You'd have a shared piece of memory which they can both read/write data from/into and both processors need to be checking this data structure frequently to see if a message is pending, which they will need to act upon.
<br/>
<br/>
For instace, if you '9 wants '7 to do something, it'll go like this:
<br/>
<br/>
9:
<br/>
check to see if the data structure is empty
<br/>
if so, write in a code corresponding to the job you want the '7 to do
<br/>
block until this message has been 'consumed'
<br/>
<br/>
7: &lt;this function needs to run constantly, so but it on a timer or something&gt;
<br/>
check to see if the data structure is not empty
<br/>
if so, read the code out of the structure
<br/>
act on this message
<br/>
clear the data structure (ie it has been consumed)
<br/>
<br/>
And the really important bits:
<br/>
- as this is effectively makes your program multi-threaded you'll need to ensure that all your use of this data structure is thread-safe, which is normally a pain in the ass.
<br/>
<br/>
- also don't forget that there is no cache coherency between the two processors, so if you want data to be accessed by the '7 that the '9 has recently used you'll need to flush your data cache (or the relavent parts). Or alternatively use an uncached mirror of the memory space.
<br/>
<br/>
Read this:
<br/>
<a href="http://en.wikipedia.org/wiki/Producers-consumers" target="_blank">http://en.wikipedia.org/wiki/Producers-consumers</a>
<br/>
<a href="http://en.wikipedia.org/wiki/Concurrent_programming" target="_blank">http://en.wikipedia.org/wiki/Concurrent_programming</a><br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#128667 - tondopie - Sun May 13, 2007 11:47 pm</h4>
    <div class="postbody"><span class="postbody">I learn better from example so I'm just going to look around some code.
<br/>
<br/>
EDIT: FIFO CODE NEEDED.... done!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
