<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>3D questions part III? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > 3D questions part III?</h2>
<div id="posts">
<div class="post">
    <h4>#72122 - Webez - Thu Feb 16, 2006 3:48 pm</h4>
    <div class="postbody"><span class="postbody">Hi.
<br/>
<br/>
Here I am again. Let's see how many of my questions can be answered.
<br/>
<br/>
A) Display list have a size limit if am not wrong . What is this limit?
<br/>
<br/>
B) Is there a way so when drawing a model, colors and texture don't mix together (like glTexEnvf in OpenGL)?
<br/>
<br/>
C) The console doesn't draw polys wich are out of the screen. But wich thing would be faster, let the hardware do it or implement frustum culling in software?
<br/>
<br/>
D) Is there a function to free textures?
<br/>
<br/>
E) There is something I don't understand in the examples when loading textures. First thing is to call loadPCX so it loads data in image-&gt;data8. But then imge8to16 is called. And in this function data8 is freed wich is then used as a parameter in glTexImage2D. I don't understand why image-&gt;data8 can be used if it has been freed.
<br/>
<br/>
F) How many bytes per pixel are used when loading textures as in question E?
<br/>
<br/>
Thanks!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72323 - dovoto - Fri Feb 17, 2006 5:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Webez wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
E) There is something I don't understand in the examples when loading textures. First thing is to call loadPCX so it loads data in image-&gt;data8. But then imge8to16 is called. And in this function data8 is freed wich is then used as a parameter in glTexImage2D. I don't understand why image-&gt;data8 can be used if it has been freed.
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
On my way out so i will answer this one and get the rest when i have a bit more time:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
free (img-&gt;data8);
<br/>
free (img-&gt;palette);
<br/>
<br/>
img-&gt;bpp = 16;
<br/>
img-&gt;data16 = temp;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Allthough data8 is freed, data16 is assigned the new buffer.  If you look in the definition for the image struct you will see the data pointers are unioned and so are the same pointer.  They are defined with multiple widths to make accessing them simpler from c code.  Changing data8 will change data16.
<br/>
<br/>
It would definatly be more clear to pass data16 to the texture loader although it makes no practical difference.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72331 - dovoto - Fri Feb 17, 2006 7:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Webez wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
A) Display list have a size limit if am not wrong . What is this limit?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
As far as I am aware there is no limit on display list size itself other than that impossed by the dma hardware (I do not believe that limit is of concern)
<br/>
<br/>
However, there is a limit on the number of vertecies the DS can hold in memory for any given frame which is 6144.  This amounts to 2K triangles or about 1500 quads.  
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Webez wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
B) Is there a way so when drawing a model, colors and texture don't mix together (like glTexEnvf in OpenGL)?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I have not found a way to change texture modulation.  As far as I can tell it allways blends the texture with the current color.  I may have just not found it yet i have not had the time to fully explore the texture format register.  Anyone else know how to disable the color blend?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Webez wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
C) The console doesn't draw polys wich are out of the screen. But wich thing would be faster, let the hardware do it or implement frustum culling in software?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
From what minimal testing i have done the culling performed by the DS is basicaly free.  You only pay the penility of actualy sending the vertex data to the pipeline.  
<br/>
<br/>
This penility adds up with scene complexity so you will probably get the most performance from an algorothym that quickly rejects the sections of the scene that are definatly not visiable and let the DS handle the situations where part of a screen element is on screen and part off.  You will have to play with how much data is in each screen element to see where the best trade off is.  
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Webez wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
D) Is there a function to free textures?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
void glResetTextures(void)
<br/>
This releases all textures.  You can still reuse textures by loading different texture data but the texture size must be the same size as the original(smaller would probably also work).
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Webez wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
F) How many bytes per pixel are used when loading textures as in question E?
<br/>
</td> </tr></table><span class="postbody">
<br/>
8 or 16 with the currently support image functions, although there are texture formats which have 4 bit pixels.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72342 - Webez - Fri Feb 17, 2006 8:17 pm</h4>
    <div class="postbody"><span class="postbody">If display list don't have size limit then I will be doing something bad .
<br/>
I save them in a u8 vector and then call it like this
<br/>
 	std::vector&lt;u32&gt;::iterator list;
<br/>
	for (list=displayList.begin(); list!=displayList.end(); list++)
<br/>
			GFX_FIFO= *list;
<br/>
and I think there is nothing wrong with it.
<br/>
<br/>
<br/>
And thanks a lot for your answers and time!!!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
