<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Display Problems (possibly with subpixel font) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Display Problems (possibly with subpixel font)</h2>
<div id="posts">
<div class="post">
    <h4>#55865 - GrenadeJumper - Mon Oct 03, 2005 3:48 pm</h4>
    <div class="postbody"><span class="postbody">Hi All,
<br/>
<br/>
I'm using the framebuffer mode to create a simple interface on the touchscreen (Img 1: <a href="http://bash.digibase.ca/int1.gif">[Images not permitted - Click here to view it]</a>). This is done by creating shapes and layering them (e.g. make big blue shape, then make smaller black shape on-top of that, then smaller blue shape on top of that).
<br/>
<br/>
Then i use the subpixel font over everything to add text. But it just won't work! (Img 2: <a href="http://bash.digibase.ca/int2.gif">[Images not permitted - Click here to view it]</a> (Mockup)).
<br/>
<br/>
Here's an extract from my code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void drawText()
<br/>
{
<br/>
    touchPosition touchXY = touchReadXY();
<br/>
<br/>
    char text1[14] = "Touch x =    "; // touchXY.px
<br/>
    char text2[14] = "Touch y =    "; // touchXY.py
<br/>
<br/>
    int num1 = touchXY.px;
<br/>
    char buf1[10];
<br/>
    int num2 = touchXY.px;
<br/>
    char buf2[10];
<br/>
<br/>
    itoa(num1, buf1, 20);
<br/>
    itoa(num2, buf2, 20);
<br/>
<br/>
    subPixelPutString(0, 0, text1);
<br/>
    subPixelPutString(0, 9, text2);
<br/>
    subPixelPutString(30, 0, buf1);
<br/>
    subPixelPutString(30, 9, buf2);
<br/>
    subPixelPutString(116, 16, "1.");
<br/>
    subPixelPutString(116, 46, "2.");
<br/>
    subPixelPutString(116, 76, "3.");
<br/>
    subPixelPutString(116, 106, "4.");
<br/>
    subPixelPutString(116, 136, "5.");
<br/>
    subPixelPutString(116, 166, "6.");
<br/>
}
<br/>
<br/>
void draw_buttons(int sel)
<br/>
{
<br/>
  uint16 newy = 10;
<br/>
  int counter = 1;
<br/>
  char buf2[4];
<br/>
<br/>
  itoa(sel, buf2, 20);
<br/>
<br/>
  subPixelPutString(0, 18, buf2);
<br/>
<br/>
  while(newy &lt; 170)
<br/>
  {
<br/>
    draw_customshape(110, newy, 90, 20, VRAM_A, RGB15(3,3,15));
<br/>
    draw_customshape(113, newy+3, 84, 14, VRAM_A, RGB15(0,0,0));
<br/>
    draw_customshape(114, newy+4, 10, 12, VRAM_A, RGB15(3,3,15));
<br/>
    draw_customshape(125, newy+4, 71, 12, VRAM_A, RGB15(3,3,15));
<br/>
    if(counter == sel)
<br/>
    {
<br/>
      draw_customshape(210, newy, 30, 20, VRAM_A, RGB15(1,1,8));
<br/>
      draw_customshape(211, newy+1, 29, 19, VRAM_A, RGB15(6,6,25));
<br/>
      draw_customshape(211, newy+1, 28, 18, VRAM_A, RGB15(3,3,15));
<br/>
      draw_customshape(213, newy+3, 24, 14, VRAM_A, RGB15(31,31,31));
<br/>
    }
<br/>
    else
<br/>
    {
<br/>
      draw_customshape(210, newy, 30, 20, VRAM_A, RGB15(6,6,25));
<br/>
      draw_customshape(211, newy+1, 29, 19, VRAM_A, RGB15(1,1,8));
<br/>
      draw_customshape(211, newy+1, 28, 18, VRAM_A, RGB15(3,3,15));
<br/>
      draw_customshape(213, newy+3, 24, 14, VRAM_A, RGB15(0,0,0));
<br/>
    }
<br/>
    draw_customshape(214, newy+4, 22, 12, VRAM_A, RGB15(3,3,15));
<br/>
<br/>
    newy += 30;
<br/>
    counter++;
<br/>
  }
<br/>
  drawText();
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The really annoying thing is, it doesn't matter where the "1." print line goes! It can be first, last, or in the middle, and it won't show up!
<br/>
<br/>
Once again, I hope it's something rediculously silly...<br/>_________________<br/>H/W: European NTR-001 - natrium42 PassMe v1.4 - Extreme Flash Advance 256Mb
<br/>
S/W: EFA-Linker 2.5 - PA_Lib - Programmer's Notepad 2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#55952 - GrenadeJumper - Tue Oct 04, 2005 9:02 pm</h4>
    <div class="postbody"><span class="postbody">shameless bump
<br/>
please help!<br/>_________________<br/>H/W: European NTR-001 - natrium42 PassMe v1.4 - Extreme Flash Advance 256Mb
<br/>
S/W: EFA-Linker 2.5 - PA_Lib - Programmer's Notepad 2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57709 - GrenadeJumper - Mon Oct 17, 2005 9:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>GrenadeJumper wrote:</b></span></td> </tr> <tr> <td class="quote">shameless bump
<br/>
please help!</td> </tr></table><span class="postbody">
<br/>
ditto<br/>_________________<br/>H/W: European NTR-001 - natrium42 PassMe v1.4 - Extreme Flash Advance 256Mb
<br/>
S/W: EFA-Linker 2.5 - PA_Lib - Programmer's Notepad 2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#57910 - LOst? - Wed Oct 19, 2005 5:53 am</h4>
    <div class="postbody"><span class="postbody">We can't help you when you leave parts of the source code out... like the function call subPixelPutString.
<br/>
<br/>
I guess the problem is within this function.<br/>_________________<br/><span style="font-style: italic">Exceptions are fun</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#58049 - GrenadeJumper - Thu Oct 20, 2005 1:41 pm</h4>
    <div class="postbody"><span class="postbody">I didnt include that function because its not my code... It's part of the SubPixelFont project found <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=5911&amp;highlight=sub+pixel" target="_blank">in this thread.</a>
<br/>
<br/>
But here you go:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// This PrintChar function is specific to the FrameBuffer mode
<br/>
void subPixelPrintChar(char c)
<br/>
{
<br/>
  if (subPixelCury&lt;187)
<br/>
    {
<br/>
      uint8 y = c&gt;&gt;4;
<br/>
      for (uint8 i = 0; i&lt;8; i++)
<br/>
   for (uint8 j = 0; j&lt;3; j++)
<br/>
     {
<br/>
       // indexes for the vram and the font table
<br/>
       uint16 vramPosition = (subPixelCurx+j)+(subPixelCury+i)*256;
<br/>
       uint16 fontTablePosition = 48*(i+(y&lt;&lt;3))+j+(c-(y&lt;&lt;4))*3;
<br/>
<br/>
       // curPal is not required for a Bitmap mode
<br/>
           VRAM_A[vramPosition]=listPal[mode][listFont[curFont][fontTablePosition]];
<br/>
     }
<br/>
<br/>
      subPixelCurx+=3;
<br/>
      if (subPixelCurx&gt;253) {subPixelCurx=0; subPixelCury+=8;}
<br/>
    }
<br/>
}
<br/>
<br/>
void subPixelPrintf(const char* s)
<br/>
{
<br/>
  uint16 i = 0;
<br/>
  while (s[i]!=0) {subPixelPrintChar(s[i]);i++;}
<br/>
}
<br/>
<br/>
void subPixelPutString(int x, int y, char* s)
<br/>
{
<br/>
  subPixelCurx = x; subPixelCury = y;
<br/>
  subPixelPrintf(s);
<br/>
}</td> </tr></table><span class="postbody"><br/>_________________<br/>H/W: European NTR-001 - natrium42 PassMe v1.4 - Extreme Flash Advance 256Mb
<br/>
S/W: EFA-Linker 2.5 - PA_Lib - Programmer's Notepad 2</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
