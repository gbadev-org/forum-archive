<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DevkitARM r20 and new libnds? old code still compatible? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > DevkitARM r20 and new libnds? old code still compatible?</h2>
<div id="posts">
<div class="post">
    <h4>#127198 - patroclus02 - Mon Apr 30, 2007 9:09 pm</h4>
    <div class="postbody"><span class="postbody">I've written some simple demos for GBA and NDS, now I want to go further, and I wonder if upgrading to new version will give me trouble, since I read some people talking about things that work before, not working anymore!
<br/>
<br/>
I don't want to upgrade if this is the case... I have version r17 and libnds that came with it....
<br/>
<br/>
I tried to compile my NDS demo and it does not work fine now. Screens are swaped in emulator (dualis) and on real system, touch coordinates don't work anymore in emulator, and sprites don't show up!
<br/>
<br/>
I managed to fix the screen thing.. this version requires a lcdOnBottom() call to set the main screen on bottom (r17 did this by default)... the invisible sprites might be caused by any define that changed... but I don't understand why touch coordinates don't work on Dualis emulator anymore when they worked GREAT in previous versions! 
<br/>
<br/>
anyone knows?
<br/>
<br/>
thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127414 - josath - Wed May 02, 2007 8:58 am</h4>
    <div class="postbody"><span class="postbody">touchscreen code has been updated to be more accurate on a real DS. if it doesn't work right in the emulator, probably it's the fault of the emulator itself.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127462 - tepples - Wed May 02, 2007 6:37 pm</h4>
    <div class="postbody"><span class="postbody">If the screens are swapped, then make sure to call lcdMainOnTop() or lcdMainOnBottom() first. Don't rely on what the boot code designates as the main or sub screen.
<br/>
<br/>
If IPC touch coordinates work on the DS but not on emulators, then this may be a bug in the high-level emulation that some emulators use for the touch screen. Use DSFTP instead of emulators.
<br/>
<br/>
If sprites aren't showing up on the DS, then you have the same problem I had when making LOCKJAW 0.34 for DS. The behavior of the constants controlling the main sprite bank in .../libnds/include/nds/arm9/video.h has changed:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// libnds of devkitARM R19 behaved like this
<br/>
VRAM_B_MAIN_SPRITE_0x06400000 = 2,
<br/>
VRAM_B_MAIN_SPRITE_0x06420000 = 2 | VRAM_OFFSET(1),
<br/>
VRAM_B_MAIN_SPRITE = VRAM_B_MAIN_SPRITE_0x06400000,
<br/>
<br/>
// libnds of devkitARM R20 behaves like this
<br/>
VRAM_B_MAIN_SPRITE_0x06400000 = 2,
<br/>
VRAM_B_MAIN_SPRITE_0x06420000 = 2 | VRAM_OFFSET(1),
<br/>
VRAM_B_MAIN_SPRITE = VRAM_B_MAIN_SPRITE_0x06420000,
<br/>
</td> </tr></table><span class="postbody">
<br/>
Notice the change in the value of VRAM_B_MAIN_SPRITE.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
