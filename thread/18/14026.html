<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>16 bits sprite - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > 16 bits sprite</h2>
<div id="posts">
<div class="post">
    <h4>#138866 - ghuldan - Thu Aug 30, 2007 1:05 am</h4>
    <div class="postbody"><span class="postbody">hi
<br/>
<br/>
What's the format of 16 bits sprite colors ?
<br/>
<br/>
I try to convert my 256 colors palette sprite to 16 bits sprite using the same ressources (i.e indexed gfx with a palette), but when i try to fill my gfx with my old color palette, it does not seem to work (sprite is transparent).
<br/>
But if i fill it with a color i pick from PAGfx it works.
<br/>
<br/>
by now i use this to create a color :
<br/>
#define RGB(r, g, b)  ( ( (b) &lt;&lt; 10 ) + ( (g) &lt;&lt; 5 ) + (r) )
<br/>
ex : color = RGB(31,31,31); (for white color)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">unsigned short *gfx = malloc(sizeof(unsigned short) * 32 * 32);
<br/>
for (i = 0; i &lt; 32 * 32; i++)
<br/>
   gfx[i] = RGB(31,31,31);
<br/>
PA_Create16bitSprite (..., ..., (void*)gfx, OBJ_SIZE_32X32, ..., ...);</td> </tr></table><span class="postbody">
<br/>
<span style="font-style: italic">it does</span> <span style="font-weight: bold">not</span> <span style="font-style: italic">work</span>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">unsigned short *gfx = malloc(sizeof(unsigned short) * 32 * 32);
<br/>
for (i = 0; i &lt; 32 * 32; i++)
<br/>
   gfx[i] = 33791; /*picked from a 16 bits sprite created by PAGfx*/
<br/>
PA_Create16bitSprite (..., ..., (void*)gfx, OBJ_SIZE_32X32, ..., ...);</td> </tr></table><span class="postbody">
<br/>
<span style="font-style: italic">it does work</span>
<br/>
<br/>
Can someone help plz ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138868 - Cydrak - Thu Aug 30, 2007 1:32 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gfx[i] = 33791;   // 0x83ff</td> </tr></table><span class="postbody">
<br/>
Notice the high bit.. 16 bit objects use it for transparency (whereas the palettes use index 0, ignoring it). So try something like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define ALPHA_BIT 0x8000
<br/>
<br/>
for(each u16 spritePixel, u8 srcPixel) {
<br/>
    if(srcPixel != 0) spritePixel = ALPHA_BIT | srcPalette[srcPixel];
<br/>
    else              spritePixel = 0;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138890 - ghuldan - Thu Aug 30, 2007 8:27 am</h4>
    <div class="postbody"><span class="postbody">yooohoo ! thanks ^^</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
