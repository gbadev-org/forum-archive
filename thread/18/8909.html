<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to load an NDS icon? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > How to load an NDS icon?</h2>
<div id="posts">
<div class="post">
    <h4>#75584 - jandujar - Tue Mar 14, 2006 11:42 am</h4>
    <div class="postbody"><span class="postbody">Hello people,
<br/>
<br/>
I hope somebody can help me with this.
<br/>
<br/>
I have created a function that opens a nds file and then shows it's icon.
<br/>
<br/>
But I have a problem, the function works con Desmume, but does not work on others emus or hardware.
<br/>
<br/>
I think, it's a palette error.
<br/>
<br/>
Can somebody help me?   (I use PAlib)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void nds_icon_create_sprite(u8 screen,u8 sprite,u8 palette,u8* nds_file,u8 x, u8 y){
<br/>
   u8 puntero[4];
<br/>
   puntero[0]=nds_file[104];
<br/>
   puntero[1]=nds_file[105];
<br/>
   puntero[2]=nds_file[106];
<br/>
   puntero[3]=nds_file[107];
<br/>
<br/>
   u32 mipuntero;
<br/>
   mipuntero=puntero[3]&lt;&lt;24 | puntero[2]&lt;&lt;16 | puntero[1]&lt;&lt;8 | puntero[0];
<br/>
<br/>
   u8 tile[512];
<br/>
   u8 paleta[32];
<br/>
   mipuntero+=32;   
<br/>
   int i;
<br/>
   
<br/>
   for(i=0;i&lt;512;i++){
<br/>
      tile[i]=nds_file[mipuntero+i];
<br/>
   }
<br/>
   mipuntero+=512;
<br/>
   
<br/>
   for(i=0;i&lt;32;i++){
<br/>
      paleta[i]=nds_file[mipuntero+i];   
<br/>
   }
<br/>
   if(screen==0){
<br/>
      PA_LoadPal16(PAL_SPRITE0, palette,(void*)paleta);
<br/>
      PA_CreateSprite (0, sprite, (void*)tile, OBJ_SIZE_32X32,0,0,x,y);      
<br/>
   }else{ //screen==1
<br/>
      PA_LoadPal16(PAL_SPRITE1, palette,(void*)paleta);
<br/>
      PA_CreateSprite (1, sprite, (void*)tile, OBJ_SIZE_32X32,0,0,x,y);      
<br/>
   }
<br/>
   
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I call the function with:
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "ejemplo_nds.h"   // -&gt;bin2o
<br/>
<br/>
int main(){
<br/>
        PA_Init();    // Initializes PA_Lib
<br/>
   PA_InitVBL(); // Initializes a standard VBL
<br/>
<br/>
        nds_icon_create_sprite(1,0,0,(u8*)ejemplo_nds,0,0);
<br/>
<br/>
        while(1){
<br/>
           PA_WaitForVBL();
<br/>
        }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://jandujar.homelinux.com" target="_blank">http://jandujar.homelinux.com</a>
<br/>
<a class="postlink" href="http://www.dsrobot.com" target="_blank">http://www.dsrobot.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76681 - Payk - Thu Mar 23, 2006 2:42 pm</h4>
    <div class="postbody"><span class="postbody">sorry i have no idea but nice work anyway. eres de espana? hehe </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">,(u8*)ejemplo_nds,0,0); </td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76682 - Payk - Thu Mar 23, 2006 2:44 pm</h4>
    <div class="postbody"><span class="postbody">hmhmh but u need to inluclude nds file before compiling?!?! mhmhm what du u think would that be possible when reading the header of the game using chishms fat lib? sure must be possible but its ur aim?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76683 - Payk - Thu Mar 23, 2006 2:48 pm</h4>
    <div class="postbody"><span class="postbody">dont know if that info is a help for u but i read something like that the icon has fixed size(sure 32x32 but i mean data size) i had problems when i wanted to insert a foto to the icon..it had to much colors but it was less then 256.... so perhaps there is a special way they compressed that icon?!?!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76692 - tepples - Thu Mar 23, 2006 4:38 pm</h4>
    <div class="postbody"><span class="postbody">You need a 16-color icon.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76694 - jandujar - Thu Mar 23, 2006 5:16 pm</h4>
    <div class="postbody"><span class="postbody">thx.
<br/>
I haved resolved the problem one week ago.<br/>_________________<br/><a class="postlink" href="http://jandujar.homelinux.com" target="_blank">http://jandujar.homelinux.com</a>
<br/>
<a class="postlink" href="http://www.dsrobot.com" target="_blank">http://www.dsrobot.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76701 - Payk - Thu Mar 23, 2006 7:20 pm</h4>
    <div class="postbody"><span class="postbody">haha ok.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
