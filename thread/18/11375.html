<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Stylus Input issue - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Stylus Input issue</h2>
<div id="posts">
<div class="post">
    <h4>#105269 - damaged1130 - Sat Oct 07, 2006 5:14 am</h4>
    <div class="postbody"><span class="postbody">I'm trying to play around with the stylus and just to make sure I understood what I was doing I wrote a quick program that should move a box around the screen at the touch of the stylus. The box moves fine when the stylus is down, but i can't seem to get it to stick when I pick up the pen. The particular problem I am having is that the box is being cleared by the background when the pen is up, even though I have the background clear routine only happening when the pen is down?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> 
<br/>
while(1) {
<br/>
        //store the previous coord's to clear them upon change
<br/>
        old_x = shape_x;
<br/>
        old_y = shape_y;
<br/>
<br/>
        // Test if pen is down. If down then update x,y coord's and clear out
<br/>
        // Original area where block rect was with background color
<br/>
        uint16 specialKeysPressed = ~IPC-&gt;buttons;
<br/>
        if(specialKeysPressed &amp; (1 &lt;&lt; 6))
<br/>
        {
<br/>
                touchPosition touchXY = touchReadXY();
<br/>
                shape_x = touchXY.px;
<br/>
                shape_y = touchXY.py;
<br/>
                // This should only erase the the previous square when the pen is down but it is seems to be erasing the screen even when the pen is up.
<br/>
                drawRect(old_x, old_y, 10, 10, VRAM_A, bgcolor);
<br/>
        }
<br/>
        //This should execute EVERYTIME but it only seems to draw when the pen is down instead?
<br/>
        drawRect(shape_x, shape_y, 10, 10, VRAM_A, color);
<br/>
 }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm sure its some simple logic issue I'm having here but I just want to make sure this code "Should" work[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#105271 - damaged1130 - Sat Oct 07, 2006 5:32 am</h4>
    <div class="postbody"><span class="postbody">fixed...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
 while(1) {
<br/>
        old_x = shape_x;
<br/>
        old_y = shape_y;
<br/>
<br/>
        uint16 specialKeysPressed = ~IPC-&gt;buttons;
<br/>
        if(specialKeysPressed &amp; (1 &lt;&lt; 6))
<br/>
        {
<br/>
                touchPosition touchXY = touchReadXY();
<br/>
                shape_x = touchXY.px;
<br/>
                shape_y = touchXY.py;
<br/>
                drawRect(old_x, old_y, 10, 10, VRAM_A, bgcolor);
<br/>
        }
<br/>
        drawRect(shape_x, shape_y, 10, 10, VRAM_A, color);
<br/>
        swiWaitForVBlank();
<br/>
 }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I hate to point out my mistake above... but just needed the swiWaitForVBlank()[/code]</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
