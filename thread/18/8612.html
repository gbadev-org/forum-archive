<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Class Float instead of typedef f32 ?? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Class Float instead of typedef f32 ??</h2>
<div id="posts">
<div class="post">
    <h4>#72251 - ishraam - Fri Feb 17, 2006 5:58 am</h4>
    <div class="postbody"><span class="postbody">Yo,
<br/>
<br/>
I'd like your opinion. And forgive me if that's somewhere stupid (it's 5.55 am I haven't had much sleep recently :p).
<br/>
<br/>
I was telling to myself, after reading many different threads, that working with f32 could quicly become a pain in the ass. Even writing the Vector3 class for f32 is boring (especially when it's not your first nor second nor third....time). Obviously, struggling with f32 helps a lot to get a better understanding of how things work, but once you got it...well you got it :).
<br/>
<br/>
When you try to keep a clean and readable code, and moreover when you want (easily) portable code , or to port some to the DS (cf. all the "doomDS", "QuakeDS",...), having to deal with "f32" and "mulf32" instead of "float" and " * " is "not friendly" (read: a little pain in the ass).
<br/>
<br/>
So an idea poped out of my mind : why not create a "Float" class around the f32, which redefines every operators (even the bit shifting), and has everything inlined?? Porting your C++ well written classes would then (almost) be nothing but a matter of find &amp; replace "float" by "Float" (anyway, that's the idea behind it)
<br/>
<br/>
Basically:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
struct Float
<br/>
{
<br/>
   f32 val;
<br/>
   
<br/>
   //::::CONSTRUCTORS
<br/>
   
<br/>
   Float():val(inttof32(0)){}
<br/>
   Float(float parVal):val((parVal)){}
<br/>
   Float(f32 parVal):val(parVal){}
<br/>
   Float(const Float &amp; parVal):val(parVal.val){}
<br/>
<br/>
<br/>
   //:::OPERATORS REDEFINED
<br/>
   
<br/>
   Float operator + (const Float &amp; parF)
<br/>
   {
<br/>
      return Float(val+parF.val);
<br/>
   }
<br/>
<br/>
   Float operator * (const Float &amp; parF)
<br/>
   {
<br/>
      return Float(mulf32(val,parF.val));
<br/>
   }
<br/>
<br/>
};</td> </tr></table><span class="postbody">
<br/>
<br/>
Having everthing inlined, it should not be slower that f32, and might be worth the writing, IMHO.
<br/>
I have been in DS dev only for 1 week, so I might be totally wrong.
<br/>
<br/>
Anyway, what's your opinion ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72262 - DekuTree64 - Fri Feb 17, 2006 6:50 am</h4>
    <div class="postbody"><span class="postbody">Yeah, that's what we do where I work, and it does make the code much more readable. 
<br/>
<br/>
Just don't go encapsulation-crazy on it and try to hide the raw value entirely. Sometimes it can save a lot of headache having it public, so you can shift around manually during a sequence of operations to maintain as much accuracy as possible. Looks like you've already figured that out, seeing as it's a struct, but I figure I'll throw it out there for the benefit of others reading :)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72266 - ishraam - Fri Feb 17, 2006 7:25 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Yeah, that's what we do where I work[...]</td> </tr></table><span class="postbody">
<br/>
Nice to hear it ^_^.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I figure I'll throw it out there for the benefit of others reading :)</td> </tr></table><span class="postbody">
<br/>
That would be nice too. 
<br/>
<br/>
If you (or anyone else) have other little "tricks" like this one up in your sleeve, I'd be glad to hear them! 
<br/>
<br/>
(I am sure everyone has his little tricks, that helps in a way or another; maybe enough to create a useful "sticky" like post, who knows ^_^.)
<br/>
<br/>
[EDIT]
<br/>
<br/>
For example, I am not sure wheter wifi libs are available yet (I think they are), but through wifi, you could do pretty useful things. 
<br/>
Ever thought of a Log class that would log everything on a sever (your pc), through wifi ? Being able to search through compete logs could really save some precious time (and energy), especially on massive projects.
<br/>
<br/>
(BTW, there is a really great article on Gamedev about XML &amp; logs - and pretty useful javascript-xsl tools)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72308 - genfish - Fri Feb 17, 2006 3:40 pm</h4>
    <div class="postbody"><span class="postbody">would ya give an example of it being used?
<br/>
<br/>
also should it be class, not struct?
<br/>
<br/>
im not the sharpest tool in the box so i might be wrong :)<br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72316 - acox - Fri Feb 17, 2006 4:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>genfish wrote:</b></span></td> </tr> <tr> <td class="quote">would ya give an example of it being used?:)</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Float a = Float(1.1f); // Explicit
<br/>
Float b = 1.2f;
<br/>
Float c = 0;
<br/>
<br/>
c += a * b;
<br/>
<br/>
a = (a * 21 + b * 45 + c * 1.1f) / a;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I think the <span style="font-weight: bold">float</span> mixed in there will be ok: '*' expects 2 Floats but Float has a constructor that takes a <span style="font-weight: bold">float</span> which will be invoked behind the scenes. As the <span style="font-weight: bold">float</span> is a compile-time constant, all <span style="font-weight: bold">float</span>s will compile out.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>genfish wrote:</b></span></td> </tr> <tr> <td class="quote">also should it be class, not struct?</td> </tr></table><span class="postbody">
<br/>
<br/>
"struct" in C++ is just the same as "class { public:".
<br/>
<br/>
<br/>
Cool. I never did Fixed-point except in straight C/Assembly, but it looks like it will all inline and compile down to the same thing in C++ anyway :).<br/>_________________<br/><a class="postlink" href="http://www.btinternet.com/~ahcox/GBA/" target="_blank">3D on GBA</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72373 - tepples - Sat Feb 18, 2006 12:58 am</h4>
    <div class="postbody"><span class="postbody">The name Float for a fixed-point class is confusing. Use Fix or Fixed instead.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72388 - ishraam - Sat Feb 18, 2006 4:48 am</h4>
    <div class="postbody"><span class="postbody">Yep, you're right Float might be confusing. 
<br/>
...I'll stick to it anyway :p</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72393 - LOst? - Sat Feb 18, 2006 6:55 am</h4>
    <div class="postbody"><span class="postbody">I know what I would like to have: A Fixed float class, and a sting manipulation class.
<br/>
<br/>
I would love to make them myself, but I have never made classes that handles overloaded operators. I am about to learn it.<br/>_________________<br/><span style="font-style: italic">Exceptions are fun</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72484 - sajiimori - Sat Feb 18, 2006 10:15 pm</h4>
    <div class="postbody"><span class="postbody">What the hell is a Fixed float class??  heheh</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
