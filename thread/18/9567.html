<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DS emulator development - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > DS emulator development</h2>
<div id="posts">
<div class="post">
    <h4>#83220 - thegamefreak0134 - Sun May 14, 2006 7:24 am</h4>
    <div class="postbody"><span class="postbody">You may have heard me talking about creating a GBA emulator,just for debug purposes? Well, I do indeed want to create an emulator as a life-long programming goal, but seeing as how the DS is the new handheld of choice, I would like to start there. Now, I understand that this is no easy task, so don't go reminding me of that. I want to do it very badly, and want no discouragement. (cause that will probably work, and we don't want that.)
<br/>
<br/>
I would like to know three things:
<br/>
<br/>
(1) Where can I find general info about emulating a processor on a PC in general? I reckon I will need to start here so I can get the general gist of things before working on whatever one the DS uses.
<br/>
<br/>
(2) Where can I find the most current info we have about the DS? Where specifically can I find info that would be useful for creating demos and such?
<br/>
<br/>
(3) What information will I need to know by way of actually reading the ROM files for the commercial games I will need to test? (I have them already, not asking for that.)
<br/>
<br/>
I realise my new-ness on this whole thing, but this is something that I would really like to do. Besides, I figure that by having the DS development community helping me out on it, I would be able to do a good job of emulating it accurately. 
<br/>
<br/>
I am of course very new to emulation, never having taken on the idea before. I have a lot of logic floating around in my head about how it would need to be done, from an outside point of view, but I know little about actually implementing processor commands, or reading ROM files. If anyone here can help me take this on, I would greatly appreciate it. I may not be the best in the world, but I do want to give this a good effort, if nothing else. Thank you.
<br/>
<br/>
-thegamefreak0134<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83233 - waruwaru - Sun May 14, 2006 8:38 am</h4>
    <div class="postbody"><span class="postbody">You might want to take a look at <a class="postlink" href="http://sourceforge.net/projects/desmume" target="_blank">DeSmuME</a>.
<br/>
<br/>
Probably want to memorize <a class="postlink" href="http://www.bottledlight.com/ds/" target="_blank">NDSTech wiki</a> too.<br/>_________________<br/><a class="postlink" href="http://www.DSLua.com" target="_blank">DSLua - a scripting language for your DS!</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83252 - agentq - Sun May 14, 2006 2:49 pm</h4>
    <div class="postbody"><span class="postbody">You could always take a look at my Gameboy emulator source code for some help on general emulation techniques.  I also have the project writeup somewhere on my hard disk which describes a little on how I wrote it.  It's in Java, but it's still going to be fairly familiary if you know C++.
<br/>
<br/>
<a href="http://www.millstone.demon.co.uk/download/javaboy" target="_blank">http://www.millstone.demon.co.uk/download/javaboy</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83274 - HyperHacker - Sun May 14, 2006 11:24 pm</h4>
    <div class="postbody"><span class="postbody">I suggest you start by emulating something simpler like the NES or Game Boy, then move on to more complex systems. Also, you'd probably be best making a GBA emulator, and once that works, add the DS features.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83282 - agentq - Mon May 15, 2006 12:11 am</h4>
    <div class="postbody"><span class="postbody">You might want to try a CHIP-8 emulator first.  It's something you should be able to complete in a week, and would give you a taste for emulator development before you dive in.
<br/>
<br/>
<a href="http://en.wikipedia.org/wiki/CHIP-8" target="_blank">http://en.wikipedia.org/wiki/CHIP-8</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83449 - thegamefreak0134 - Tue May 16, 2006 1:53 pm</h4>
    <div class="postbody"><span class="postbody">Alright, to make y'all happy, I am currently working on the CHIP-8 emulator. I already have it showing screens after a considerable number of commands were handled, and I should have the thing finished by tommorrow. A week? I should have this finished within 2 days.
<br/>
<br/>
Interestingly enough, I'm doing this in visual basic. It's rather difficult, as it took me a very long time to realise that VB reads variables from files backwards, inverting the order of the bytes. Once I got that worked out, it got through the first couple of lines with no prob. I'm going to do this right and give it a proper memory viewer and probably a disassembler of some sort as well.
<br/>
<br/>
Once I have this finished (soon) I'l come back to my original question. I'll probably take on a graphics only emulation project of one of the older GBs to get started, but I really want my main focus to be on the DS. I'm suprised, as this is turning out to be a lot easier than I thought! Yay!
<br/>
<br/>
-gamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83455 - SteveH - Tue May 16, 2006 2:15 pm</h4>
    <div class="postbody"><span class="postbody">If you think that's easy - and emulating a processor is easy I had to do it for a uni course, and learn asm at the same time.. - then you will have a lot of fun getting everything else working.
<br/>
<br/>
Oh the good old day's of uni, having to design a new CPU, then emulate it on a 68000, as well as in hardware... Gah the nightmares are returning :D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83683 - thegamefreak0134 - Wed May 17, 2006 8:54 pm</h4>
    <div class="postbody"><span class="postbody">Well, (as a quick report) I've got the stupid thing actually running some games. Whoopie. Unfortunately, getting to play pong over and over again isn't too impressive. It's nowhere near perfect, doesn't play many games due to lack of supported opcodes, has no sound, and has this minor issue of not recognizing a single key, but overall I've got the general idea down. I could of course fix it up by using directX for graphics, sound, and actual input, but that comes later. Getting VB to do binary operations is a pain in the (obscene word) let me tell you. I think I'll stick to visual C++ from now on, thanks.
<br/>
<br/>
I've seen how it's possible to go off and update stuff by the instruction, but everyone knows that's no fun. I'd like to tackle something a little more advanced than an old computer. Can someone point me toward the old GB specs? (Black and white will do for now.) I think if I can get that up and running (taking the time to actually allow input and sound) I will have an accomplishment worthy of starting my orignal quest. Thanks!
<br/>
<br/>
-gamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83691 - SteveH - Wed May 17, 2006 9:56 pm</h4>
    <div class="postbody"><span class="postbody">Check out <a href="http://www.devrs.com" target="_blank">www.devrs.com</a> for al your GB info including:
<br/>
<br/>
02/06 - GameBoy based CD Player v1.0 - Posted by: Jordi
<br/>
    A GameBoy based CD Player with a CD-ROM ATAPI unit. Plug your GameBoy and your old CD ATAPI drive to the interface board and you will have a nice CD Player. Information page is in spanish.
<br/>
<br/>
<br/>
WHA?!?!?!?!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83718 - HyperHacker - Thu May 18, 2006 1:19 am</h4>
    <div class="postbody"><span class="postbody">You are NOT going to write a reasonably fast DS, or even Game Boy emulator in VB. Believe me, I tried.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83725 - tepples - Thu May 18, 2006 1:46 am</h4>
    <div class="postbody"><span class="postbody">Is this VB6, or is it one of the .NET versions? If the latter, then VB.NET is as powerful as C#, which in turn is as powerful as Java, which was used to make <a class="postlink" href="http://baonline.emuunlim.com/" target="_blank">BoycottAdvance Online</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83740 - gladius - Thu May 18, 2006 3:19 am</h4>
    <div class="postbody"><span class="postbody">VB.Net is plenty powerful.  I dislike the syntax, but the underlying architecture is .NET, not the old VB interpreter.  Check out <a class="postlink" href="http://forwardcoding.com/projects/gbaemu.html" target="_blank">http://forwardcoding.com/projects/gbaemu.html</a> for my GBA emulator in .NET (C# though) with source.  Another piece of source to look at never hurts :).
<br/>
<br/>
That being said, emulation is still a task where bit twiddling and pointer math can make a big difference.  But having been on both ends of the spectrum, doing an all assembler emulator and a C# one, I must say I prefer the development experience in C# ;).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83749 - PhoenixSoft - Thu May 18, 2006 7:39 am</h4>
    <div class="postbody"><span class="postbody">You will probably be able to get it running at a decent speed, the main problem I see would be that it may use up a lot more RAM than a C++ version would, due to the low amount of control over memory management.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83805 - thegamefreak0134 - Thu May 18, 2006 5:36 pm</h4>
    <div class="postbody"><span class="postbody">The site given is cool, and would be a great resource if I were coding in asm for the GB. Unfortunately, I need to do just the opposite. Nintendo has already done the coding part, I need to know what the asm part actually does. Something to the effect of this instruction (in hex) does these things to this memory using these registers. Thus, I will also need the basic memory info and such, but I can probably find that myself.
<br/>
<br/>
I do not intend to code the thing in VB.NET. I will use that for primary testing, but I intend to do the main program in C++ .NET. This will give me much greater controll and flexibility over my memory. Course, I have to figure out how to do file handling in C++, but that couldn't possibly be any harder than VB. (maybe even easier.) Thus, the speed should improve. I also don't intend to do the implementation the same as the CHIP-8 thing. I had it literally checking every instruction for every single command possible, which was slow as heck mind you. I was also using the VB graphics routines, which are even _slower_ than heck. Needless to say, I know where the improvements need to be made.
<br/>
<br/>
I will do some searches and try to get this running. Can someone who's done this let me know what games are going to be the easiest and most difficult to get running? (on the GB, that is) Thanks!
<br/>
<br/>
-thegamefreak0134<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83845 - SteveH - Thu May 18, 2006 10:58 pm</h4>
    <div class="postbody"><span class="postbody">The actual part of that site I provided that you need to look at is:http://www.devrs.com/gb/docs.php#docsmisc
<br/>
<br/>
and in that section:
<br/>
<br/>
2000/02/29 - GB Cribsheet - Posted by: Jeff Frohwein
<br/>
    Now a full-color version of Otaku's cribsheet for GB/GBC programming is available. The cribsheet is basically a few sheets of paper that when printed out contain a massive amount of information in a very area.
<br/>
<br/>
2000/02/29 - GB Cribsheet in HTML - Posted by: Jeff Frohwein
<br/>
    An HTML version of Otaku's cribsheet can be found here.
<br/>
<br/>
2000/05/01 - GB/GBC Opcode Summary - Posted by: Jeff Frohwein
<br/>
    Details the opcodes, the flags affected, and the clock cycle timing of each code.
<br/>
<br/>
    Here is a more detailed Text and HTML version.
<br/>
<br/>
<br/>
Or even the following docs:
<br/>
<br/>
2000/04/04 - Thomas Scherrer's Z80 Support Page - Posted by: Jeff Frohwein
<br/>
    Quite a bit of information on the Z80 processor can be found here. The Z80 is very similar to the processor used in the GameBoy.
<br/>
<br/>
2004/10/25 - Z80 User Manual - Posted by: Vegard
<br/>
    Complete instruction set reference for the Z80 processor (similar to the one used in DMG/GBC)
<br/>
<br/>
<br/>
All you need to do is look around that site and you will find what you need...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83920 - thegamefreak0134 - Fri May 19, 2006 5:33 pm</h4>
    <div class="postbody"><span class="postbody">I see. So THIS is the one that has the z80 processor. This should be a lot simpler now, as I already know pretty well how to code in z80 asm. I would just need to adapt to the bios calls and memory on the GB. OK, I will take a look at the docs there, they should help out a lot.
<br/>
<br/>
Is there info somewhere on how all of this compiles down to hex? And possibly how the file will look on a low level? This is going to be possible, I'm so excited!
<br/>
<br/>
-thegamefreak0134<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83994 - agentq - Sat May 20, 2006 1:55 am</h4>
    <div class="postbody"><span class="postbody">A reference I used extensively when writing my GB emulator was the Pan docs:
<br/>
<a href="http://www.work.de/nocash/pandocs.htm" target="_blank">http://www.work.de/nocash/pandocs.htm</a>
<br/>
<br/>
I wouldn't expect writing a GB emulator to be as easy as CHIP-8.  The CPU is a lot more complex, then you've got to look at the graphcis, sound, interrupt handling, cartridge mappers and a whole lot of other stuff.  Although I found it great fun to write.
<br/>
<br/>
Tetris is probably the simplest game to start with.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84025 - HyperHacker - Sat May 20, 2006 5:55 am</h4>
    <div class="postbody"><span class="postbody">Tetris actually has the worst code I've ever seen. That may be good, though; if it runs that it's doing pretty well. ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84033 - tepples - Sat May 20, 2006 6:31 am</h4>
    <div class="postbody"><span class="postbody">Does Tetris DX in monochrome mode have better code?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84157 - HyperHacker - Sat May 20, 2006 8:33 pm</h4>
    <div class="postbody"><span class="postbody">Probably, I never looked at it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84452 - thegamefreak0134 - Mon May 22, 2006 5:37 pm</h4>
    <div class="postbody"><span class="postbody">Yay! this looks like what I need. Thanks a bunch. OK, so that means that my small time goal is to get tetris up and running. Awesome.
<br/>
<br/>
Last question I promise. Is the ROM file for any given game basically an exact copy of the cartridge memory? Or is there some other junk I will have to read from it (or skip) to get to the stuff the emulator will need to use? I think the docs you provided tell me about the ROM header and all, I just need to know if reading the file will be the equivilent of looking at the cartridge directly. Also, there are files with different extensions. Will this have any effect on their contents? (I haven't looked at any docs in detail, so if this is already covered then sue me.)
<br/>
<br/>
Thanks again sooo much. I realize that this is kindof a dissapointing title, since I haven't even gotten to the DS part yet, but I promise I will. If the mods feel the need to move the file, so be it. Just let me know where it ends up.
<br/>
<br/>
-thegamefreak0134
<br/>
<br/>
PS: Thanks again!<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84469 - tepples - Mon May 22, 2006 7:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>thegamefreak0134 wrote:</b></span></td> </tr> <tr> <td class="quote">Is the ROM file for any given game basically an exact copy of the cartridge memory? Or is there some other junk I will have to read from it (or skip) to get to the stuff the emulator will need to use?</td> </tr></table><span class="postbody">
<br/>
It depends on the platform being emulated. With Game Boy, as with GBA, the "header" is part of the ROM, not skipped as in the NES. Every bit in a .gb or .gbc ROM file is a bit in the ROM chip.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Also, there are files with different extensions. Will this have any effect on their contents?</td> </tr></table><span class="postbody">
<br/>
The extensions .gb, .sgb, and .gbc mean exactly the same thing: a bit-for-bit copy of the content of a Game Boy ROM chip. Game Boy Color and Super Game Boy modes are actually denoted by bits in the header, which the SGB BIOS and the GBC BIOS read.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84590 - thegamefreak0134 - Tue May 23, 2006 3:13 pm</h4>
    <div class="postbody"><span class="postbody">Hmm.. I was looking at the "hex dump" of the nintendo logo, and to tell the truth I can't see how they get a nintendo logo from that. All I can make out of it is garbage. (Although it is definately the right garbage, as I checked the site against several commercial ROMs.) Is it done this way on purpose? Or perhaps is this used with a mask or something similar to produce the actual image? I realize that my emulator need not care what this data contains, but I still eventually want to fake the intro logo as an option. (and thus fake the garbage that comes from a bad header.)
<br/>
<br/>
Also, does someone know if it's possible to set priority in directDraw? (new at this, remember?) If so, I could just use the image functions there for sprites and save some processing time.
<br/>
<br/>
-thegamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84603 - SteveH - Tue May 23, 2006 5:25 pm</h4>
    <div class="postbody"><span class="postbody">What do you mean by priority?
<br/>
<br/>
And DirectDraw does not have any idea about sprites, and with the way sprites are stored in the 1D mode, you will be better off writing your own sprite handlers...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84625 - HyperHacker - Tue May 23, 2006 7:39 pm</h4>
    <div class="postbody"><span class="postbody">On Game Boy the Nintendo logo is several tiles (I think 8 or 16) stored in monochrome format. The bootROM converts them to 4-colour and copies them into VRAM; I believe the tilemap is defined in the bootROM. On GBA I think it's the same, but compressed. However, the compression header is not stored in the ROM, but rather in the BIOS, for 2 reasons:
<br/>
<br/>
1) It's always going to be the same, so there's no point taking up the extra space.
<br/>
2) If the compression header were malformed it could overflow a buffer and/or overwrite code in memory.
<br/>
<br/>
BTW, Game Boy (even Color) only has a bootROM, not a full-blown BIOS. Super GB has one though.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84634 - thegamefreak0134 - Tue May 23, 2006 8:54 pm</h4>
    <div class="postbody"><span class="postbody">By priority, I mean which sprites appear in front. In the old GB mode, sprites have priority by the X coordinate (left is on top) and then by OAM position, while in the color mode there is the option to specify sprite priority, much like in the GBA.
<br/>
<br/>
I realised that I probably shouldn't use DirectDraw, mainly because I am going to have to write my own sprite handlers anyway. Although few games use it I'm sure, it is possible I believe to change a sprite's position every scanline, thus making DirectDraw most likely unable to handle the change. I'll be coding the entire screen draw routine by the pixel, thank you very much. (And looking at the logic, it doesn't look that hard either.)
<br/>
<br/>
I still need to do DirectInput. Turns out, my VB form isn't handling the key states mainly because Windows isn't handling them right. It's doing that whole repeating key thing rather than just registering the button as down. (stupid windows.) Unless there's a way to turn that off with code, I'll stick to DirectX. (Provided, of course, I can get it to work at all... Should be simple but it's being a pain instead.)
<br/>
<br/>
-thegamefreak0134<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84678 - HyperHacker - Wed May 24, 2006 2:39 am</h4>
    <div class="postbody"><span class="postbody">You really only need to set the appropriate bit in the keydown event, and clear it in keyup. It shouldn't matter if keydown fires multiple times. (I may have those names wrong; haven't used VB in ages.)<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84696 - SteveH - Wed May 24, 2006 8:41 am</h4>
    <div class="postbody"><span class="postbody">No DirectDraw does not have any priority stuff.
<br/>
<br/>
You will be better off writing your emulator in C++ using DirectDraw and DirectInput natevly, instead of using VB which IMHO is not good for games, mainly as it's a very slow lnguage to run (even GDI games are slow in VB).
<br/>
<br/>
I'm currently in the design stage of a suite of tools to help design levels for games, and the first thing I've done is look at the 2D hardware limitations, 8x8 tiles, flip's, palettes, etc and the only thing I can think of doing is writing the whole thing in C++ using either GDI or DirectDraw to blit the tiles onto the window.  Ether way it will be fun...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84699 - DekuTree64 - Wed May 24, 2006 9:06 am</h4>
    <div class="postbody"><span class="postbody">Yeah, best to just use a plain old array of memory for the screen. When I was toying around with a GBA emulator a while back, I used OpenGL to display my buffer. The setup code is pretty short if you want it.
<br/>
<br/>
Perhaps I'll try my hand at GBC too, once I have a bit more free time. What I really wanted to do before was a SNES emulator on DS, but I'm a bit lazy for that to get very far :)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84719 - doublec - Wed May 24, 2006 11:22 am</h4>
    <div class="postbody"><span class="postbody">The OmegaGB site, a gameboy emulator written in Haskell, has pointers to a number of GB resources:
<br/>
<br/>
<a href="http://www.mutantlemon.com/omegagb/devlog/" target="_blank">http://www.mutantlemon.com/omegagb/devlog/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84720 - Mighty Max - Wed May 24, 2006 11:31 am</h4>
    <div class="postbody"><span class="postbody">On the first read, i thought "OMG Haskell? This is nuts!"
<br/>
<br/>
But on the second thought, yes, sound like the perfect system to emulate a cpu on. I mean, you actually define the cpu's function, and not how to emulate it.
<br/>
<br/>
Cool thing.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84746 - thegamefreak0134 - Wed May 24, 2006 3:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You will be better off writing your emulator in C++ using DirectDraw and DirectInput natevly, instead of using VB which IMHO is not good for games, mainly as it's a very slow lnguage to run (even GDI games are slow in VB). </td> </tr></table><span class="postbody">
<br/>
<br/>
Actually, I'm told that in .NET (which I use) VB code compiles down to the same base code as C++, so the only real benefit of C++ is if I'm comfortable with it. I am, but thats not the point. Also, I've already determined that DirectDraw is not the way to go, as I just need to do pixel stuff. I already have info on how to quickly draw pixels in VB, so it's not a problem.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You really only need to set the appropriate bit in the keydown event, and clear it in keyup. It shouldn't matter if keydown fires multiple times. (I may have those names wrong; haven't used VB in ages.)</td> </tr></table><span class="postbody">
<br/>
<br/>
You know, you might have a good point there. My other program was clearing the keys every instruction, and attempting to re-read them. I suppose if windows doesn't send a message that fast (and why should it? stupid cheap piece of...) then the logical solution is to read it that way. You are a genius. I should go fix my other thingy now!
<br/>
<br/>
I think I have enough info to actually get the thing started. However, I have one last question. There is only a certain length of memory that the games use to access things on the cart. There is a register that is used to access the other memory banks in the cart as well. Does increasing this register simply increase the cart memory offset by he ammount of memory that can be read at one time? 
<br/>
<br/>
What I mean is, do I read the info from the ROM like:
<br/>
<br/>
Requested Byte + (BankSelect * Banksize)
<br/>
<br/>
? Or do I have to do something different? The docs are a little unclear about this.
<br/>
<br/>
-thegamefreak<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84788 - dXtr - Wed May 24, 2006 8:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>thegamefreak0134 wrote:</b></span></td> </tr> <tr> <td class="quote">Actually, I'm told that in .NET (which I use) VB code compiles down to the same base code as C++, so the only real benefit of C++ is if I'm comfortable with it.</td> </tr></table><span class="postbody">
<br/>
<br/>
Correction.. exchange VB with VB.NET and C++ with C++.NET (or managed C++) and the statement should be correct<br/>_________________<br/>go back to coding and stop screaming wolf :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#84792 - thegamefreak0134 - Wed May 24, 2006 8:32 pm</h4>
    <div class="postbody"><span class="postbody">Grrr... you know what I meant.<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85356 - Helius - Mon May 29, 2006 9:21 am</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
You might want to take a look at this: <a class="postlink" href="http://www.emutalk.net/forumdisplay.php?f=30" target="_blank">http://www.emutalk.net/forumdisplay.php?f=30</a>
<br/>
<br/>
And this too: <a class="postlink" href="http://www.emutalk.net/showthread.php?t=20521" target="_blank">http://www.emutalk.net/showthread.php?t=20521</a>
<br/>
<br/>
Good luck with your emus.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85542 - thegamefreak0134 - Wed May 31, 2006 4:17 pm</h4>
    <div class="postbody"><span class="postbody">OK, naturally I'm having some issues with the Pandocs. They're wonderfull, but a bit confusing in two areas.
<br/>
<br/>
(1) In the CPU instruction set, I'm confised about how they're showing the opcodes. What do the xx, rr, and nn mean? It never specifies. Also, if an instruction has no specific hex identifier, how do I know to execute it?
<br/>
<br/>
Take this example:
<br/>
<br/>
  ld   r,r         xx         4 ---- r=r
<br/>
  ld   r,n         xx nn      8 ---- r=n
<br/>
  ld   r,(HL)      xx         8 ---- r=(HL)
<br/>
  ld   (HL),r      7x         8 ---- (HL)=r
<br/>
  ld   (HL),n      36 nn     12 ----
<br/>
  ld   A,(BC)      0A         8 ----
<br/>
  ld   A,(DE)      1A         8 ----
<br/>
  ld   A,(nn)      FA        16 ----
<br/>
(Pandocs)
<br/>
<br/>
Note the instructions at the top. What on earth will xx look like in hex? I assume some of it is supposedc to be replaced with a register, which leads me to other questions. If an instruction requires a certain register, how would that be done in hex? (ie, what's the hex representation of every register?)
<br/>
<br/>
I understand that nn is supposed to be a number, usualy a byte, correct?
<br/>
<br/>
(2) Look up again. The timing on the rigt hand side (the ones divisible by 4) are throwing me a little. I understand them, but I don't understand what I can use them for. Is there a list of how long it takes the gameboy to do things like draw pixels and wait in vblank that is measured in the same units as these timings? He's kinda unclear on what the units are throughout the docs.
<br/>
<br/>
Any help clearing this up would be greatly appreciated. Thanks a lot!
<br/>
<br/>
-thegamefreak
<br/>
<br/>
EDIT- Well curse filters. Apparently my spacing on the documentation is gone. Y'all know where to find it, or can understand this, right?<br/>_________________<br/>What if the hokey-pokey really is what it's all about?
<br/>
<br/>
[url=http:/www.darknovagames.com/index.php?action=recruit&amp;clanid=1]Support Zeta on DarkNova![/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85546 - thehive - Wed May 31, 2006 5:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">(1) In the CPU instruction set, I'm confised about how they're showing the opcodes. What do the xx, rr, and nn mean? It never specifies. Also, if an instruction has no specific hex identifier, how do I know to execute it? 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
r refers to a register (A, B, C, D, H, L, etc).
<br/>
rr refers to a register pair (BC, DE, HL, etc).
<br/>
nn refers to the next byte in memory after the instruction.
<br/>
<br/>
xx in the pan docs is simply a placeholder for the real hex values.
<br/>
You'll need to get hold of the Z80 instruction set to determine the hex values of every instruction (note the GB has a cut down Z80 instruction set, so refer to the Pan docs for the actual differences).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">2) Look up again. The timing on the rigt hand side (the ones divisible by 4) are throwing me a little. I understand them, but I don't understand what I can use them for. Is there a list of how long it takes the gameboy to do things like draw pixels and wait in vblank that is measured in the same units as these timings? He's kinda unclear on what the units are throughout the docs. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The timings given are the CPU clocks or cycles that each instruction takes to execute. You will need to count these to determine when an IRQ or interrupt occurs. For example the pan docs state that a complete screen refresh occurs ever 70224 clks, so in simple terms you start to draw the screen after counting this many clocks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85855 - Helius - Fri Jun 02, 2006 5:32 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.emutalk.net/attachment.php?attachmentid=15944&amp;d=1085342251" target="_blank">http://www.emutalk.net/attachment.php?attachmentid=15944&amp;d=1085342251</a>
<br/>
<br/>
You might read the thread I told you, loads of information there ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86209 - Two9A - Mon Jun 05, 2006 2:34 pm</h4>
    <div class="postbody"><span class="postbody">Only just found this thread, so apologies for partial resurrection. I've been procrastinating on a DMG emulator for over a year now, so I'm not too great a guide on that side, but when you get to the GBA/DS, feel free to flick through the source to DSemu and "DSemu: next generation".
<br/>
<br/>
doublec maintains the DSemu codebase now, but it was always a horribly hacked-up mess; DSemu-ng has a little design principle behind it, so should make more sense to you. Each emulator is about 30k lines of the programming language concerned (C or C++) last time I checked.
<br/>
<br/>
You'll enjoy the ARM instruction set: much more orthogonal than Z80, a dream for an assembly coder. (Nightmare for an emulator, mind.)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
