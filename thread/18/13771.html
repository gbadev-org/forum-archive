<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>File System Size Limits - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > File System Size Limits</h2>
<div id="posts">
<div class="post">
    <h4>#135659 - jonnyhilly - Wed Jul 25, 2007 9:44 am</h4>
    <div class="postbody"><span class="postbody">Hi, I'm using the file system and added a big database file, about 4mb
<br/>
and the compiler game me an error about pointers not working...
<br/>
I though I could have more than 4MB of data if I use the file system. How does this work, and what are the real limits ?
<br/>
thanks
<br/>
Jon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135663 - Sektor - Wed Jul 25, 2007 11:29 am</h4>
    <div class="postbody"><span class="postbody">What file system are you using?  Libfat can access files stored on your card of any size.
<br/>
<br/>
The arm9 binary can't be larger than 4MB since it is loaded into RAM.  That would only happen if you were embedding the data.  If you attach it to the .nds after compiling then it won't be loaded into RAM and you could access it with libfat if you knew where on the card the .nds file was stored or you could just have it as an external file.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://gtamp.com/DS" target="_blank">GTAMP.com/DS</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135665 - OOPMan - Wed Jul 25, 2007 12:13 pm</h4>
    <div class="postbody"><span class="postbody">Even if you are using libfat, attempting to load the entire file into memory won't really work...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135683 - jonnyhilly - Wed Jul 25, 2007 4:42 pm</h4>
    <div class="postbody"><span class="postbody">I'm using the file system which comes with devkitpro, 
<br/>
"embedded_gbfs"  so that must be the problem
<br/>
<br/>
I'm only loading a line of text at a time, but I guess that doesn't matter
<br/>
as its just down to the file being too big to include.
<br/>
<br/>
I'll go searching for LibFat
<br/>
<br/>
thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135688 - kusma - Wed Jul 25, 2007 4:51 pm</h4>
    <div class="postbody"><span class="postbody">libfat also comes with devkitPro.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135710 - M3d10n - Wed Jul 25, 2007 6:33 pm</h4>
    <div class="postbody"><span class="postbody">GBFS only works for slot-2 flashcarts, since the GBA cart space is memory mapped. If you use it on slot-1 devices, you'll be limited to the 4MB main memory. Use libfat for that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135772 - jonnyhilly - Thu Jul 26, 2007 7:35 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">libfat also comes with devkitPro.</td> </tr></table><span class="postbody">
<br/>
<br/>
It does? cool, thanks
<br/>
<br/>
<br/>
I found fat.h and libfat.a in the lib and include folders.
<br/>
<br/>
I don't see any examples that uses libfat though
<br/>
<br/>
I see, sound, graphics, input, realTimeClock, debugging and filesystem example folders, and the filesystem folder only has embedded_gbfs examples. no, libFat examples though
<br/>
<br/>
Where can I get some example code or some docs on libfat ?
<br/>
or for that matter, docs on the whole libnds ?
<br/>
Do I need a special makefile ?
<br/>
<br/>
thanks for the tip</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135775 - calcprogrammer1 - Thu Jul 26, 2007 7:56 am</h4>
    <div class="postbody"><span class="postbody">Libfat is pretty awesome...I'm using it for my file browser, and it's pretty good.  You can read the directory list and open files.  The command for reading a file is simple:
<br/>
<br/>
fread();
<br/>
<br/>
though I forget the syntax, you can search online for "fread() c" (libfat replicates all the C file functions on the DS).  I think it was <a href="http://www.cplusplus.com" target="_blank">www.cplusplus.com</a> that had some good references.
<br/>
EDIT: Here's the page I was referring to:
<br/>
<a class="postlink" href="http://www.cplusplus.com/reference/clibrary/cstdio/fread.html" target="_blank">http://www.cplusplus.com/reference/clibrary/cstdio/fread.html</a>
<br/>
<br/>
You can read files in text or binary mode, though for a database you'd probably want text, read a line of text in, store it to an array, etc, but remember that what's loaded in RAM at any given time has to be &lt;4MB, so cycle the data in and out from the file.
<br/>
<br/>
You'll also need the includes
<br/>
#include &lt;fat.h&gt;
<br/>
#include &lt;sys/dir.h&gt; //for directory support
<br/>
<br/>
You also have to change the LIBS section of the makefile, find the line
<br/>
LIBS     := -lnds9
<br/>
and change to
<br/>
LIBS     := -lfat -lnds9
<br/>
<br/>
and last you have to use the command
<br/>
fatInitDefault();
<br/>
<br/>
to set up the FAT system...look on Chishm's libfat page for info.<br/>_________________<br/>DS Firmware 1, Datel Games n' Music card / Chism's FW hacked GBA MP v2 CF
<br/>
<br/>
There's no place like 127.0.0.1.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135777 - jonnyhilly - Thu Jul 26, 2007 8:05 am</h4>
    <div class="postbody"><span class="postbody">thanks very much
<br/>
I have to say the help on these forums is great
<br/>
I hope to contribute in future :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#135780 - calcprogrammer1 - Thu Jul 26, 2007 8:10 am</h4>
    <div class="postbody"><span class="postbody">That's exactly why I visit these forums every day :)
<br/>
<br/>
Now that I've had some experience in programming libfat (though I'm still awful at it), I post what I've learned, and if you're in need of source code, I'll post some examples if I know any, that's something that people on these forums have done for me.
<br/>
<br/>
...I guess that's a good thing, because I haven't found much 'official' documentation (other than references to other c sites) for these libraries.
<br/>
<br/>
Another thing I'd recommend to new DS programmers: PAlib (www.palib.info), it takes the figuring of allocating vram and stuff just to display a background or an image out, but it's still compatible with libfat, I'm using it (along with libfat) to create my file browser.<br/>_________________<br/>DS Firmware 1, Datel Games n' Music card / Chism's FW hacked GBA MP v2 CF
<br/>
<br/>
There's no place like 127.0.0.1.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
