<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Deleting textures using libnds videogl functions? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Deleting textures using libnds videogl functions?</h2>
<div id="posts">
<div class="post">
    <h4>#163480 - 3dfx - Fri Oct 03, 2008 2:22 am</h4>
    <div class="postbody"><span class="postbody">Is there a way to delete a texture with libnds?
<br/>
I mean glDeleteTextures isn't implemented in libnds.
<br/>
Texture was created using glGenTextures ... bind ... etc.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163487 - silent_code - Fri Oct 03, 2008 9:39 am</h4>
    <div class="postbody"><span class="postbody">You have to implement it yourself, but maybe the next libnds release will support better texture management. We'll have to see (or ask the devs). :^)
<br/>
<br/>
There are some texture managers floating aroud the forum, though. Do a search.
<br/>
<br/>
Good luck. :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163530 - 3dfx - Sat Oct 04, 2008 7:58 am</h4>
    <div class="postbody"><span class="postbody">Interesting.
<br/>
<br/>
Quick question, can I manipulate the texture directly, setting individual pixels after I have bound and loaded it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163533 - silent_code - Sat Oct 04, 2008 8:53 am</h4>
    <div class="postbody"><span class="postbody">EDIT: It turns out, the VRAM switching timing I was writing about isn'zt true. Please read on, though.
<br/>
<br/>
NOTE: I am not entirely sure (in fact, I am quite the opposite), if all of this information is right (regarding VRAM switching time), so you best test it out and see for yourself!
<br/>
<br/>
<br/>
Yes, just make sure you don't want to display the texture (as well as others, as you'll see) for about three frames, as VRAM writing is only supported in LCD mode and switching VRAM bank modes happens only in the next frame. Any textures located in that VRAM bank will not be accessible to the 3D rendering units.
<br/>
I might not be 100% right, but I guess it's close enough. Look at the following quote:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gbatec wrote:</b></span></td> </tr> <tr> <td class="quote">In Extended Palette and Texture Image/Palette modes, VRAM is not mapped to CPU address space, and can be accessed only by the display controller (so, to initialize or change the memory, it should be temporarily switched to Plain-CPU mode).</td> </tr></table><span class="postbody">
<br/>
Good luck. :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"><br/><br/>Last edited by silent_code on Sat Oct 04, 2008 11:51 pm; edited 3 times in total</span></div>    
</div>
<div class="post">
    <h4>#163535 - eKid - Sat Oct 04, 2008 10:06 am</h4>
    <div class="postbody"><span class="postbody">Hmm, I thought the bank switching was immediate, and you just have to change the texture within the 'smaller' 3D vblank. (since rendering starts 48 lines before vblank ends)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163559 - silent_code - Sat Oct 04, 2008 11:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>eKid wrote:</b></span></td> </tr> <tr> <td class="quote">Hmm, I thought the bank switching was immediate, and you just have to change the texture within the 'smaller' 3D vblank. (since rendering starts 48 lines before vblank ends)</td> </tr></table><span class="postbody">
<br/>
<br/>
You might be right (and you probably are), but I couldn't find the right timing when doing some more involved capturing stuff. Might just be, that I've mixed up some things there. I'm not sure, because it's been a while since I last tinkered with the NDS's VRAM.
<br/>
<br/>
Point is, it has to be done right and fast, otherwise it's going to be flickering hell. :^)
<br/>
<br/>
Steps include:
<br/>
<br/>
- switch desired VRAM bank to LCD mode
<br/>
- modify texels
<br/>
- switch VRAM bank back to texture mode
<br/>
- do it fast
<br/>
- watch your timing
<br/>
<br/>
EDIT:
<br/>
<br/>
I just found this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gbatek wrote:</b></span></td> </tr> <tr> <td class="quote">After setting the Capture Enable bit, capture starts at next line 0, and the capture enable/busy bit is then automatically cleared (in line 192, regardless of the capture size).</td> </tr></table><span class="postbody">
<br/>
<br/>
So, it's the capturing that is only available in the frame after enabling it and eKid is right. (Btw: Thanks for pointing it out!) :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163565 - zeruda - Sun Oct 05, 2008 3:26 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>3dfx wrote:</b></span></td> </tr> <tr> <td class="quote">Quick question, can I manipulate the texture directly, setting individual pixels after I have bound and loaded it?</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes you can. Silent explained it above, here's some code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">vramSetBankA(VRAM_A_LCD);
<br/>
VRAM_A[0] = 0;           // VRAM_A is a 16 bit pointer
<br/>
VRAM_A[1] = 56;         // so this line writes to the 3rd and 4th bytes
<br/>
...
<br/>
...
<br/>
VRAM_A[65535] = 8978; 
<br/>
VRAM_A[65536] = 8978; // Bank A is 128K, so this'll overflow to bank B(meaning a logical flaw)
<br/>
vramSetBankA(VRAM_A_TEXTURE);</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
