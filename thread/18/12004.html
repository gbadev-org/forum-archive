<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>problem compiling libFB - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > problem compiling libFB</h2>
<div id="posts">
<div class="post">
    <h4>#112993 - thing - Fri Dec 22, 2006 6:47 am</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
I'm new to NDS development (which means I'm a noob) and I'm trying to recompile Dragonming's libFB and its 'sample1' for the devkitARM 19b but I'm getting problems. Using the supplied Makefile, libFB compiles with flag '-fPIC' for position independent code, but that makes the linker crash when compiling 'sample1' with message:
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-eabi-g++ -MMD -MP -MF /home/Abe/nds/projects/libFB_sample1/build/arm9.d -g -Wall -O2 -mcpu=arm9tdmi -mtune=arm9tdmi -fomit-frame-pointer -ffast-math -mthumb -mthumb-interwork -I/home/Abe/nds/projects/libFB_sample1/include -I/home/Abe/nds/projects/libFB_sample1/build -Ic:/util/nds/devkitPro/libfb/include -Ic:/util/nds/devkitPro/libnds/include -Ic:/util/nds/devkitPro/libfb/include -Ic:/util/nds/devkitPro/libnds/include -I/home/Abe/nds/projects/libFB_sample1/build -DARM9 -fno-rtti -fno-exceptions -c /home/Abe/nds/projects/libFB_sample1/source/arm9.cpp -o arm9.o
<br/>
<br/>
linking libFB_sample1.elf
<br/>
c:/util/nds/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.1.1/../../../../arm-eabi/bin/ld.exe: error: no memory region specified for loadable section `.rel.dyn'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If I remove '-fPIC' from libFB makefile, 'sample1' compiles fine, but doesn't run appropriately on dualis nor no$gba (sorry, my gear to run homebrew on my NDS is on its way). The precompiled 'sample1.nds' from Dragonmind's website runs fine on both emulators, though...
<br/>
<br/>
I couldn't find anything similar to this in this forum, which makes me think that I'm asking something trivial (sorry if that's the case).
<br/>
<br/>
Any ideas to help me get past this error will be greatly appreciated.
<br/>
<br/>
Thanks a lot,
<br/>
Thing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113004 - OOPMan - Fri Dec 22, 2006 8:31 am</h4>
    <div class="postbody"><span class="postbody">Some kind of devkitPro version clash maybe?
<br/>
<br/>
Possibly DragonMinded was working with an older version of dkp...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113007 - chishm - Fri Dec 22, 2006 9:51 am</h4>
    <div class="postbody"><span class="postbody">It is a DKP problem, mainly the link scripts. In fact, I ran across this exact same error a few hours ago. To fix it, you'll need to edit the file ds_arm9.ld . Find the line that says:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   .got            : { *(.got.plt) *(.got) } &gt;ewram = 0
<br/>
</td> </tr></table><span class="postbody"> and change it to </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   .got            : { *(.got.plt) *(.got) *(.rel.got) } &gt;ewram = 0</td> </tr></table><span class="postbody">
<br/>
I'm not entirely sure that this will fix it completely, but at least you'll be able to link it.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113092 - thing - Fri Dec 22, 2006 11:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'm not entirely sure that this will fix it completely, but at least you'll be able to link it.</td> </tr></table><span class="postbody">
<br/>
<br/>
Chishm, your trick makes the linker work, that's great! I would never get it fixed as linking libraries is waaay too advanced for me... 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'm not entirely sure that this will fix it completely, but at least you'll be able to link it.</td> </tr></table><span class="postbody">
<br/>
<br/>
Well, seems to be working... :)
<br/>
<br/>
Anyway, I've noticed that libFB 'sample1' source code has problems, the included 'font_kartika_14.h' is making the sample crash. I've replaced it with 'font_arial_9.h' (from 'fonts.zip' also downloadable from Dragonmind's website) and now the sample is alright. It requires a few tweaks to adjust the text boxes with the new font size, but that's easy.
<br/>
<br/>
Thanks for all the help... Now if I could find documentation for libFB... ;)
<br/>
<br/>
Season's Greetings to you all!
<br/>
Thing</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
