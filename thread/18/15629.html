<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Efficient DS development - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Efficient DS development</h2>
<div id="posts">
<div class="post">
    <h4>#157986 - AO - Mon Jun 02, 2008 9:22 pm</h4>
    <div class="postbody"><span class="postbody">Hey guys, as I'm new to homebrew for the DS I'm interested in knowing the kind of techniques and workflow you use for developing, testing and debugging DS apps.
<br/>
<br/>
I've set up a VS 2k5 project with a Makefile for compiling for the DS platform. I quickly found there's no way i'm gonna do a compile -&gt; copy to flash -&gt; insert flash into DS -&gt; repeat process for every thing i want to test or debug.
<br/>
<br/>
It seems to be really easy to waste time if you're not being careful.
<br/>
<br/>
Currently I'm developing a DS wrapper in tandem with the DS game. The wrapper only includes the parts i need (like check the required init functiosn are called, GL functions, etc) and i flesh out the implementation of the wrapper as I need the functions.
<br/>
<br/>
Are you guys creating a similar wrapper or do you have another way of testing the app without having to copy the binary over to the DS for each test.
<br/>
<br/>
It's really nice to be able to have edit &amp; continue for debugging the game on windows.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157990 - tepples - Mon Jun 02, 2008 9:31 pm</h4>
    <div class="postbody"><span class="postbody">You could develop a PC port of the game in parallel, from the same source tree. That's what I do for <a class="postlink" href="http://www.pineight.com/lj/" target="_blank">Lockjaw Tetromino Game</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157991 - silent_code - Mon Jun 02, 2008 9:41 pm</h4>
    <div class="postbody"><span class="postbody">i use no$gba (currently the free 2.6 version) for minor debugging and testing (hit F3 to check if no$ detects any errors, that works in any version). obviously that doesn't work for features that no$ doesn't emulate, but most of it is just eyecandy (at least the things i can thinking of right now) anyway.
<br/>
<br/>
in the end, all major testing is done on hw. nothing beats that! :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157994 - AO - Mon Jun 02, 2008 10:43 pm</h4>
    <div class="postbody"><span class="postbody">Tried No$gba 2.6a
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Errors per second -- 532,476
<br/>
Total Errors -- 1,597,428
<br/>
Low Power Mode -- Unsupported (drains battery power)
<br/>
Multiboot Support -- Unsupported (bad entrypoint)
<br/>
Quality Rating -- Disqualified</td> </tr></table><span class="postbody">
<br/>
I don't find that terribly helpful, i'm not sure why it's finding that many errors/what kind of errors it's finding.
<br/>
<br/>
the nds binary is created with: ndstool -c game.nds -9 game9.bin -7 arm7.bin</span><span class="gensmall"><br/><br/>Last edited by AO on Mon Jun 02, 2008 10:44 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#157995 - DensitY - Mon Jun 02, 2008 10:44 pm</h4>
    <div class="postbody"><span class="postbody">the no$gba emulator is your best bet. I setup a while ago (don't really remember how, it was ages ago) an extra option in my VS menu which'll launch no$gba + my .no.gba file. allowes me to compile then quickly test. Sadly this doesn't allow things like Edit and Continue to work, which is a pain because features like that make PC based deving a complete joy.
<br/>
<br/>
In the end you will need todo some sort of hardware testing, sometimes things work on no$gba that won't on hardware (generally if you have a odd bug). just pray you don't have todo any heavy wifi usage development with your project, as currently testing of wifi based apps are hardware only as far as I know.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157996 - silent_code - Mon Jun 02, 2008 11:56 pm</h4>
    <div class="postbody"><span class="postbody">@ AO:
<br/>
<br/>
i find that *quite* helpful!
<br/>
<br/>
you can always insert infinite loops before lines and see which lines cause the errors. although this procedure is sub optimal, you can still get most errors traked down quite easyly.
<br/>
<br/>
the only cases that won't be helping are unsupported features and "buggy" libraries. ;^)
<br/>
<br/>
give it a try, let's see if you can get it down to one error or less. i usually have *always* one error, which occurs *before* the first line in main(). maybe it's counting running windows an error? ... :^p<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#157997 - DensitY - Tue Jun 03, 2008 12:04 am</h4>
    <div class="postbody"><span class="postbody">some DS debugging requires old school screen prints + inserting loop code to pause the app manually.. generally required if you get hardware specific bugs.. and yes its a major pain but all in good fun.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158003 - Cydrak - Tue Jun 03, 2008 2:51 am</h4>
    <div class="postbody"><span class="postbody">If you can get it working, IMHO, wifi is the way to go.
<br/>
<br/>
There are several downloaders; generally these save to slot-2 RAM or to the memory card, then run the *.NDS. Some even have code you can use to restart the loader at runtime.
<br/>
<br/>
These are the ones I'm aware of, there might be others:
<br/>
- DSlurper (download via HTTP):   <a href="http://www.scumways.com/dslurper/" target="_blank">http://www.scumways.com/dslurper/</a>
<br/>
- HTTPexec (another HTTP launcher):   <a href="http://forum.gbadev.org/viewtopic.php?t=13143&amp;highlight=httpexec" target="_blank">http://forum.gbadev.org/viewtopic.php?t=13143&amp;highlight=httpexec</a>
<br/>
- DSFTP (an FTP server for the mem-card):   <a href="http://giesler.biz/bjoern/en/sw_dsftp.html" target="_blank">http://giesler.biz/bjoern/en/sw_dsftp.html</a>
<br/>
- Wifiloader ("netcat" to SLOT-2 RAM; dead link):   <a href="http://forum.gbadev.org/viewtopic.php?t=11665&amp;start=15" target="_blank">http://forum.gbadev.org/viewtopic.php?t=11665&amp;start=15</a>
<br/>
<br/>
Personally, I use a (heavily modified) build of Wifiloader; I haven't released it since it's still WIP and I'd like to add a few things. I never tried any of the others... so I can't say much about them.
<br/>
<br/>
One thing to beware of is old wifi and FAT libraries. Sometimes a new wifi chipset breaks homebrew, so you may need to recompile with current libs. And gba_nds_fat (long since replaced) has been known to trash memory cards. I started back in Jan/Feb 2007 and hit both problems, but modern apps should fare better.
<br/>
<br/>
With a wifi tool and a "restart" hotkey in my project, I've gotten compile cycles down to ~15-20 seconds for small binaries... so long as nothing crashes too badly!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158025 - silent_code - Tue Jun 03, 2008 7:16 pm</h4>
    <div class="postbody"><span class="postbody">wow, that sounds nice!
<br/>
<br/>
my only problem with wifi-ing is, that you need a special adapter with special "hacked" drivers to simulate an access point.
<br/>
<br/>
now, how will i get it to work with my *laptop's* build in atheos card (or the msi usb dongle i have)? thiswillworkNOT! ;^p
<br/>
<br/>
to make things wores, i even have to use another (intel) pc, than my dev machine (the laptop) to burn my slot2 gba cart, because i can't get the software/driver to work with any amd system (although someone here wrote he's no problem at all with the very same brand i'm using and his amd system/s)...
<br/>
<br/>
so, has the current state of wifi powered dev improved over what i have just written, or didn't it change at all? i would appreciate using wifi, because i then didn't have to waste so much energy any more. :^)
<br/>
<br/>
peace out! :?)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158034 - EyeballKid - Tue Jun 03, 2008 7:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">wow, that sounds nice!
<br/>
<br/>
my only problem with wifi-ing is, that you need a special adapter with special "hacked" drivers to simulate an access point.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
No, not if you're using one of the apps Cydrak mentioned.
<br/>
I use (and wrote) <a class="postlink" href="http://www.scumways.com/dslurper" target="_blank">DSlurper</a>, and it just connects to a web server, which is pretty trivial to set up on your development machine.
<br/>
(I'm just preparing a new release of dslurper, should appear in the next day or two...)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158037 - silent_code - Tue Jun 03, 2008 9:12 pm</h4>
    <div class="postbody"><span class="postbody">THAT SOUNDS AWESOME!
<br/>
<br/>
do i need flashme installed in order to make it work? what about older gba slot2-only carts, with no ram and build-in flash memory (so, not a FAT device)?<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"><br/><br/>Last edited by silent_code on Tue Jun 03, 2008 9:37 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#158039 - AO - Tue Jun 03, 2008 9:34 pm</h4>
    <div class="postbody"><span class="postbody">The wifi http downloader sounds like a great idea and fixes the biggest issue i have now, having to physically move the flash card between PC and DS for each test.
<br/>
<br/>
I think I'll continue with my DS wrapper, run the binary with no$gba to check for errors now and then and create a simple http server to handle requests from... I was gonna choose HTTPexec since it seems relatively new, but is DSlurper gonna be compiled against the latest libfat/devkitarm/wifilibs and all that so i don't have to think about the problems Cydrak mentioned with older versions?
<br/>
<br/>
I'm not sure how stable the DS is after trying to restart itself and run the latest binary but i'll think about that when i get to it, there's a bunch of links here.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158045 - TwentySeven - Tue Jun 03, 2008 10:29 pm</h4>
    <div class="postbody"><span class="postbody">At worst you'll have toggle the power and try again.  Homebrew seems to have a random failure rate on my ds-x of about 2%.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158047 - Cydrak - Tue Jun 03, 2008 10:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">my only problem with wifi-ing is, that you need a special adapter with special "hacked" drivers to simulate an access point.</td> </tr></table><span class="postbody">
<br/>
Nah, these apps use a standard AP. The wifi does have trouble with some of them; I needed to assign a static IP, rather than use DHCP, for example.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">do i need flashme installed in order to make it work?</td> </tr></table><span class="postbody">
<br/>
You just need to be able to start the loader, and have a working wifi profile set up in the firmware. A WFC game like Mario Kart or Animal Crossing works for this; I think DSOrganize can also configure them now.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">what about older gba slot2-only carts, with no ram and build-in flash memory (so, not a FAT device)?</td> </tr></table><span class="postbody">
<br/>
Ahh... this is a different story. Trouble is, the downloaded file has to go somewhere. I guess the easiest way is to save in EWRAM, then have a tiny ARM7 stub handle the relocation. Wifiloader pulls this trick from slot-2... I'm not aware of a pure EWRAM loader, though.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>AO wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not sure how stable the DS is after trying to restart itself and run the latest binary but i'll think about that when i get to it, there's a bunch of links here.</td> </tr></table><span class="postbody">
<br/>
It's not a "hard boot" in any sense; remember, the DS has already gone through the BIOS, firmware, and a launcher on the way to your app. This is just another path. ;)
<br/>
<br/>
Now, different flashcards (and loaders) do have their quirks. And your last binary will have left some state behind. So either way, you should already be initializing everything you need. Obviously you will also want to clean up (HDMA, timers, etc) during the "reset" process. For the most part, the DS seems quite tolerant of this.
<br/>
<br/>
There is one thing you can't just kill at any time though, and that is your 3D task. That is: you <span style="font-style: italic">must</span> be sure you've finished your scene and glFlush()ed for the current frame. If you don't--and yes, I found out the hard way--the geometry engine will choke and die on the <span style="font-style: italic">next</span> glFlush(), when it sees the half-baked display list. Then you're doomed to a power cycle, since further 3D attempts will fill the command buffer and lock hard. @_@</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158050 - silent_code - Tue Jun 03, 2008 11:02 pm</h4>
    <div class="postbody"><span class="postbody">thanks, but now i am a sad panda. :^C<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158055 - AO - Wed Jun 04, 2008 12:18 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote">for this; I think DSOrganize can also configure them now.
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">what about older gba slot2-only carts, with no ram and build-in flash memory (so, not a FAT device)?</td> </tr></table><span class="postbody">
<br/>
Ahh... this is a different story. Trouble is, the downloaded file has to go somewhere. I guess the easiest way is to save in EWRAM, then have a tiny ARM7 stub handle the relocation. Wifiloader pulls this trick from slot-2... I'm not aware of a pure EWRAM loader, though.</span></td> </tr></table><span class="postbody">
<br/>
silent_code: Why not buy a cyclo DS evolution like i have or any slot 1 cart, they're not very expensive.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158056 - silent_code - Wed Jun 04, 2008 1:00 am</h4>
    <div class="postbody"><span class="postbody">i'm saving for one, but i'm not quite there, yet. ;^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158141 - Abcd1234 - Thu Jun 05, 2008 5:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DensitY wrote:</b></span></td> </tr> <tr> <td class="quote">some DS debugging requires old school screen prints + inserting loop code to pause the app manually.. generally required if you get hardware specific bugs.. and yes its a major pain but all in good fun.</td> </tr></table><span class="postbody">
<br/>
<br/>
I've actually found Masscat's gdb stub to be incredibly helpful here (I've used it extensively while developing nethackds).  Actually being able to debug running code on the DS has allowed me to find bugs that, otherwise, would've been impossible to find.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158143 - Sarvesh50 - Thu Jun 05, 2008 6:41 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">You could develop a PC port of the game in parallel, from the same source tree. That's what I do for <a class="postlink" href="http://www.pineight.com/lj/" target="_blank">Lockjaw Tetromino Game</a>.</td> </tr></table><span class="postbody">
<br/>
Or you could help the port of transport tycoon ds <a class="postlink" href="http://www.tt-forums.net/viewtopic.php?t=35306" target="_blank">http://www.tt-forums.net/viewtopic.php?t=35306</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158144 - kusma - Thu Jun 05, 2008 6:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sarvesh50 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">You could develop a PC port of the game in parallel, from the same source tree. That's what I do for <a class="postlink" href="http://www.pineight.com/lj/" target="_blank">Lockjaw Tetromino Game</a>.</td> </tr></table><span class="postbody">
<br/>
Or you could help the port of transport tycoon ds <a class="postlink" href="http://www.tt-forums.net/viewtopic.php?t=35306" target="_blank">http://www.tt-forums.net/viewtopic.php?t=35306</a></span></td> </tr></table><span class="postbody">
<br/>
Dude, stop. He wasn't looking for what to develop, he was looking for a way of improving his methods of development. I hope you're not going to dig through all the threads here to find other places to promote your pet idea.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158148 - silent_code - Thu Jun 05, 2008 8:47 pm</h4>
    <div class="postbody"><span class="postbody">Or you could download my most recent release "Zombie NDS" off my page and try to break the highscore... &lt;sarcasm/&gt; ;^)
<br/>
<br/>
EDIT: just search the forum for mallinfo, there are several posts about it, some with example code.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"><br/><br/>Last edited by silent_code on Thu Jun 05, 2008 11:47 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#158153 - AO - Thu Jun 05, 2008 10:16 pm</h4>
    <div class="postbody"><span class="postbody">Also with only 4MB of memory, is there a way of verifying how much memory is being used?
<br/>
<br/>
Currently I'm just coding away but it's important to know the limitations i have. For example how big can the arm7/9 images be? Does their size affect how much heap i can allocate? Is there some way to find the available heap/stack space at runtime at the very least so i can print some warnings when i get close to the limits?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158154 - Maxxie - Thu Jun 05, 2008 10:31 pm</h4>
    <div class="postbody"><span class="postbody">bigger binaries size increase the address of the heap begin. Thus yes, larger binaries mean lower heapsizes.
<br/>
<br/>
You can use mallinfo to get information about the current malloc-situation.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
