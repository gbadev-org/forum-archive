<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems with UDP - sendto only sends in own subnet ?! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Problems with UDP - sendto only sends in own subnet ?!</h2>
<div id="posts">
<div class="post">
    <h4>#121437 - qw3rty - Mon Mar 12, 2007 1:53 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I recently updated to the newest wifi-lib (CVS), adn now my app doesn't connect to IP's that aren't in the NDS's subnet.
<br/>
I use the UDP-socket code of wifi-lib-test 0.3a as base for my app.
<br/>
<br/>
This is how I open the socket :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
        sock=socket(AF_INET,SOCK_DGRAM,0);
<br/>
   sa_incoming.sin_family=AF_INET;
<br/>
   sa_incoming.sin_port=htons(portnum_game);
<br/>
   sa_incoming.sin_addr.s_addr=INADDR_ANY;
<br/>
   if (bind(sock,(struct sockaddr *) &amp;sa_incoming,sizeof(sa_incoming)) == -1)
<br/>
   {
<br/>
      closesocket(sock);
<br/>
      return -1;
<br/>
   }
<br/>
   ioctl(sock,FIONBIO,&amp;i);</td> </tr></table><span class="postbody">
<br/>
<br/>
This is how I send :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
        sa_outgoing.sin_family=AF_INET;
<br/>
   sa_outgoing.sin_port=htons(portnum);
<br/>
   sa_outgoing.sin_addr.s_addr=destip;
<br/>
<br/>
   //send packet
<br/>
   num_bytes_sent = sendto(sock,((u8*)buffer,buffer_len,0,(struct sockaddr *)&amp;sa_outgoing,sizeof(sa_outgoing));
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
If destip is not within the own subnet, the NDS does send NOTHING (not even an ARP-request)
<br/>
<br/>
P.S: I also tried wifi-lib-test 0.3a compiled with the newset dswifi-lib (and of course adapted to work again - close --&gt; closesocket) with the same results. Not a packet sent out, if it's in a different subnet :(
<br/>
<br/>
P.P.S. : TCP-connections can't connect to the outside either.(tried with wifi-lib-test, compiled with the cvs-lib)
<br/>
<br/>
P.P.P.S : I compiled it wih wifi-lib 0.3c, and it works again :O</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121441 - qw3rty - Mon Mar 12, 2007 2:52 pm</h4>
    <div class="postbody"><span class="postbody">Better a new post, than yet another P.S. :
<br/>
<br/>
I have tried 3 different wifi-libs now :
<br/>
<br/>
wifi-lib0.3c - WORKS
<br/>
wifi-lib0.3d - WORKS
<br/>
wifi-lib CVS - BROKEN !!!
<br/>
<br/>
no idea what's wrong though - I haven't found any recent changes in CVS-browse :-?
<br/>
And the only thing I change is the wifi-lib, I keep the CVS-libnds</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121444 - Lick - Mon Mar 12, 2007 2:55 pm</h4>
    <div class="postbody"><span class="postbody">How do you transfer the binary?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121447 - qw3rty - Mon Mar 12, 2007 3:00 pm</h4>
    <div class="postbody"><span class="postbody">Transfer the binary ? to the NDS you mean ?
<br/>
I transfer it with wifi-transfer (I changed it to use dldi, it corrupted my CF-card all the time ;) )
<br/>
<br/>
I turn off the NDS before starting my app though - learned it the hard way (see my other topic).
<br/>
(so I doubt wifitransfer is interfering with my app)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121449 - Lick - Mon Mar 12, 2007 3:02 pm</h4>
    <div class="postbody"><span class="postbody">Could you not copy it manually (wired)?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121470 - qw3rty - Mon Mar 12, 2007 5:04 pm</h4>
    <div class="postbody"><span class="postbody">I could of course unplug my card, put the CF-card in the card-reader, and transfer it by USB-cable, but do you really think it would make a difference ?
<br/>
wifi-lib 0.3d (non-CVS) also works transferred by wifitransfer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
