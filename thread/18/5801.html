<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Getting Started - Detecting WiFi Packets - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Getting Started - Detecting WiFi Packets</h2>
<div id="posts">
<div class="post">
    <h4>#43435 - Vixus - Mon May 23, 2005 2:50 pm</h4>
    <div class="postbody"><span class="postbody">Right, I know I'm just starting out here, a "n00b" as it were. I've noticed a lack of non-hoax NDS tunnelling projecs around (tell me if I'm wrong) and want to fill this gap. I have a vague idea of how tunnelling software works and an even vaguer idea of how to get started creating my own. For one thing I need to find out how the DS communicates its multiplayer information, right? Next I need to be able to decode these packets (I think) and pass them on to other players, correct?
<br/>
<br/>
So how should I go about:
<br/>
- Getting my PC to detect the DS?
<br/>
- Intercepting packets given off by the DS?
<br/>
<br/>
Thanks, just tolerate me and tell me if I'm going about anything the wrong way ;)<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"><br/><br/>Last edited by Vixus on Wed May 25, 2005 10:20 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#43439 - Mr Snowflake - Mon May 23, 2005 3:56 pm</h4>
    <div class="postbody"><span class="postbody">It's not that I don't want to see this happen, but what makes you think you can pull this off and others can't? I'm just sceptic because all the hoaxes there have been on the net, since the launch</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43440 - Vixus - Mon May 23, 2005 4:07 pm</h4>
    <div class="postbody"><span class="postbody">That's the point. I'm sure there are many who are way more capable than me at pulling this off, yet I haven't seen anyone try! So someone should, and everyone has to start somewhere... so I decided, why not me? Is there anything wrong with that? I'm getting tired of all these hoaxes too, don't worry. I've waited for ages since the launch and haven't seen any true work so, well, you could call it taking matters into my own hands! :)<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43475 - doublec - Mon May 23, 2005 10:33 pm</h4>
    <div class="postbody"><span class="postbody">To communicate with the DS you might want to consider using the driver that the Wireless Multiboot program uses:
<br/>
<br/>
<a href="http://users.belgacom.net/bn967347/" target="_blank">http://users.belgacom.net/bn967347/</a>
<br/>
<br/>
Since WMB communicates with the DS using it I suppose it could be used by other programs. The downside of course is there is no docs for it. Would the author of that driver mind other people using it for other programs like tunnelling?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43484 - Mr Snowflake - Mon May 23, 2005 11:56 pm</h4>
    <div class="postbody"><span class="postbody">Ask Tim, he's around here. With this driver, I think you already have a big part of the hardest part done. Namely: getting the wificard receiving and sending ds packages, I just don't know if it will work with real game traffic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43556 - Vixus - Tue May 24, 2005 4:14 pm</h4>
    <div class="postbody"><span class="postbody">It should, because you are simply recieving the game packets and sending a copy of them to the people at the other line, am I correct? This is what I was thinking:
<br/>
<br/>
[ DS ] --&gt; *packet* --&gt; [ WiFi Card/Router ]--&gt;[ Server <b style="color:#FFA34F">Tunnel</b> Program ] --&gt; ***INTERNET*** --&gt; [ Client <b style="color:#FFA34F">Tunnel</b> Program ] --&gt; [ WiFi ] --&gt; *packet* --&gt; [ DS ]
<br/>
<br/>
Thanks for the link doublec.<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43647 - Vixus - Wed May 25, 2005 10:21 am</h4>
    <div class="postbody"><span class="postbody">Sorry for the double post, just needed to boost this up... can DS packets be detected by a normal packet sniffing program such as Packetyzer?<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43698 - Darkain - Wed May 25, 2005 8:20 pm</h4>
    <div class="postbody"><span class="postbody">i would just like to point out that the reason the DS isnt tunneled, is because those of us that know HOW to do it, dont really care to.  we are busy working on other more important projects currently. 
<br/>
<br/>
but to give you a little heads up, direct tunneling of the DS wont work (too much latency over the net).  instead, you will have to emulate a low latency connection by having each PC emulate a DS, and auto-respond w/ OK packets, and only forward actual data packets.  this is also true for the handshaking process.  plus, you might need to do some MAC translation, depending on if you can fake your MAC address or not.  another note:  there is currently only 1 known working chipset at the moment that can get to this level of emulation, the one that is being used for WifiMe.<br/>_________________<br/>-=- Darkain Dragoon -=-
<br/>
<a class="postlink" href="http://www.darkain.com" target="_blank">http://www.darkain.com</a>
<br/>
<a class="postlink" href="http://ds.darkain.com/hack" target="_blank">DarkStar</a> for <a class="postlink" href="http://ds.darkain.com" target="_blank">Nintendo DS</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43708 - Chetic - Wed May 25, 2005 9:24 pm</h4>
    <div class="postbody"><span class="postbody">This means you will have to use "special" software on a PC between for all the online homebrew stuff that might come though, right?
<br/>
Would be a real shame.. I was really hoping I'd be able to run stuff in school, except the normal games.<br/>_________________<br/>Packin':
<br/>
Grey DS with FlashMe v7
<br/>
1Gbit XG2T 2005 (Neoflash compatible)
<br/>
GBAMP, Supercard CF, 512Mb Magic Key 3 and EZFA 256Mbit</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43717 - assassda - Wed May 25, 2005 10:10 pm</h4>
    <div class="postbody"><span class="postbody">well once the official online service is released it may be possible to use over any wifi card but for anything homebrew you need a ralink card</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43719 - Vixus - Wed May 25, 2005 10:32 pm</h4>
    <div class="postbody"><span class="postbody">Yep, I've been corresponding with tim. I wonder if you can use a wireless router though.<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43724 - Darkain - Wed May 25, 2005 11:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Vixus wrote:</b></span></td> </tr> <tr> <td class="quote">Yep, I've been corresponding with tim. I wonder if you can use a wireless router though.</td> </tr></table><span class="postbody">
<br/>
<br/>
we've gone over this countless times.  for nintendos service?  yes.  for anything else?  no.  why?  because routers route at the TCP level, not the raw 802.11 level.<br/>_________________<br/>-=- Darkain Dragoon -=-
<br/>
<a class="postlink" href="http://www.darkain.com" target="_blank">http://www.darkain.com</a>
<br/>
<a class="postlink" href="http://ds.darkain.com/hack" target="_blank">DarkStar</a> for <a class="postlink" href="http://ds.darkain.com" target="_blank">Nintendo DS</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43755 - nix - Thu May 26, 2005 8:24 am</h4>
    <div class="postbody"><span class="postbody">afaik, Team XLink actually did try tunnelling, but gave up. Most other people seem to have done the same.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43761 - Vixus - Thu May 26, 2005 10:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkain wrote:</b></span></td> </tr> <tr> <td class="quote">we've gone over this countless times.</td> </tr></table><span class="postbody">
<br/>
I haven't! :D
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkain wrote:</b></span></td> </tr> <tr> <td class="quote">For nintendos service?  yes.  for anything else?  no.  why?  because routers route at the TCP level, not the raw 802.11 level.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ok, well thanks for clearing that up. In short, any tunneling software would actually have to overlay TCP information on top of the raw 802.11 data for it to work with a router, right?<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43765 - linus - Thu May 26, 2005 1:26 pm</h4>
    <div class="postbody"><span class="postbody">RE: router
<br/>
<br/>
This is a bit pointless and off the wall but if you put one of the ralink pcmcia inside the linksys WRT54G and customize the firmware would it be possible to <b style="color:#FFA34F">tunnel</b> the packets via a router?
<br/>
<br/>
Believe me i am in no way suggesting this as a feasable or worthwhile exercise. You would have to have a very indepth knowledge of the WRT54G firmware and ralink drivers, not to mention the problems of timing and latency with nifi tunneling. Also not to mention why bother use a router?
<br/>
<br/>
Anywho i just wondered if its technically possible. Im sure there would probably be problems getting an ralink pcmcia card working in a linksys router :)
<br/>
<br/>
RE: TCP
<br/>
<br/>
As far as i understand it you would have to encapsulate the raw nifi packets in some TCP packets. It is very easy to have a simplified view of tunneling but there is quite a lot to it, and i dont claim to have anywhere near the amount of knowledge required to do it. Im sure there are people like Darkain who could do it but there working on other things. For that reason i strongly encourage people to talk about it even if they themselves cant do it because it sparks ideas. 
<br/>
<br/>
Many people dont really see tunneling as worthwhile now that nintendo has announced its online service, but i still think its worth doing because many games will still be released that are [edit]not[/edit] online that we will want to play over the net.
<br/>
<br/>
[/waffle]
<br/>
<br/>
Linus</span><span class="gensmall"><br/><br/>Last edited by linus on Thu May 26, 2005 6:17 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#43771 - Vixus - Thu May 26, 2005 3:57 pm</h4>
    <div class="postbody"><span class="postbody">It's for the games that aren't online already.
<br/>
<br/>
Well...
<br/>
<br/>
*TCP*NiFi*TCP* &lt;--- this is my impression of a NiFi packet getting packaged inside a TCP thing.
<br/>
<br/>
OK, I was thinking about this to get it working with a wireless router:
<br/>
<br/>
DS=&gt;[NiFi] ---&gt; Card=&gt; Program (Nifi + TCP) --router-internet--&gt; [*TCP*NiFi*TCP*] ---&gt; Router=&gt; Client (NiFi - TCP) ---&gt; Card=&gt; [NiFi]=&gt;DS
<br/>
<br/>
Because the router cannot use raw 802.11 frames... but first, wouldn't it be simply possible to:
<br/>
<br/>
DS=&gt;[NiFi] ---&gt; Card=&gt; Program (Encode Nifi) --internet--&gt; [*TCP*NiFi*TCP*] ---&gt; Router=&gt; Client (Decode NiFi) ---&gt; Card=&gt; [NiFi]=&gt;DS
<br/>
<br/>
***Where NiFi == DS Packet.***<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"><br/><br/>Last edited by Vixus on Thu May 26, 2005 6:28 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#43778 - linus - Thu May 26, 2005 6:16 pm</h4>
    <div class="postbody"><span class="postbody">im a bit confused, on the second one it looks like your trying to send a raw DS packet over the net. The top one looks ok, where you've encapsulated the DS packet in a TCP packet. Sending a raw DS (nifi) packet over the web wouldnt do anything, it wouldnt know where to go youd have to specify an IP which is the IP of the computer "client" program. Darkains website has some differences between a NiFi and WiFi packet. 
<br/>
<br/>
I think for simplicities sake you should forget about routers theyre confusing what your trying to do. The program should be running on a pc at either end, each computer should use its internet connection to send packets but you shouldnt worry whether this is via a router or not.
<br/>
<br/>
Linus
<br/>
<br/>
PS
<br/>
<br/>
i meant *not* online in my last post ill edit it now</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43779 - Vixus - Thu May 26, 2005 6:24 pm</h4>
    <div class="postbody"><span class="postbody">Oh sorry, I didn't change the second one... the NiFi packet would be packaged within a packet created by the tunneling software.<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43821 - linus - Fri May 27, 2005 1:19 am</h4>
    <div class="postbody"><span class="postbody">urm i dont understand the difference between:
<br/>
<br/>
Client (Decode NiFi)
<br/>
<br/>
and
<br/>
<br/>
Client (NiFi - TCP)
<br/>
<br/>
i still think you shouldnt be worrying about routers, the hard bit is sorting out the timing and latency issues between the ds's connected over the internet. Itd be an achievement just to get tunneling over a lan or anything with lowish latency.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43822 - doublec - Fri May 27, 2005 1:25 am</h4>
    <div class="postbody"><span class="postbody">A good first step would be to document the protocol for the communication between the two DS's. Then someone could get started writing the program to do the tunnelling.
<br/>
<br/>
Even just starting the first step of documenting the protocol for the part where DS1 sends out "I've got data for another DS'. Then you could write a program to <b style="color:#FFA34F">tunnel</b> this specific bit.
<br/>
<br/>
Testing could be fun. Running the program on DS1, tunnelling it on your PC. Running 30 feet away to DS2 and PC2 (so DS2 doesn't pick up the direct communication with DS1). Sounds like a good way to get fit :-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43823 - Darkain - Fri May 27, 2005 1:28 am</h4>
    <div class="postbody"><span class="postbody">woah... nice idea... too bad nobody thought about this in the "DS wireless cracking thread" that started last year...
<br/>
[/sarcasm]
<br/>
<br/>
really tho, go read that thread if you want "documentation".  its full of our already existing trial and error comments and other stuff from figuring out the DSs various protocols.<br/>_________________<br/>-=- Darkain Dragoon -=-
<br/>
<a class="postlink" href="http://www.darkain.com" target="_blank">http://www.darkain.com</a>
<br/>
<a class="postlink" href="http://ds.darkain.com/hack" target="_blank">DarkStar</a> for <a class="postlink" href="http://ds.darkain.com" target="_blank">Nintendo DS</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43864 - Vixus - Fri May 27, 2005 12:07 pm</h4>
    <div class="postbody"><span class="postbody">Thanks, darkain and everyone else... I better carry out some more research first! :)
<br/>
<br/>
Hmm, that topic seems to be based on people trying to decode the actual DS packets... I didn't really think you'd have to... I thought you could just insert the DS packets into another with the appropriate information to sent it across the web, and then get the client at the other end to 'remove' the extra information, get the raw DS packet, and pass it on to the client DS.<br/>_________________<br/><a class="postlink" href="http://bg.spheredev.net/tv/" target="_blank">TunnelVision Website</a> - Bringing DS multiplayer to the masses.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
