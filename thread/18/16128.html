<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Help with EABI versions and other building errors - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Help with EABI versions and other building errors</h2>
<div id="posts">
<div class="post">
    <h4>#163814 - zzo38computer - Sun Oct 12, 2008 10:15 pm</h4>
    <div class="postbody"><span class="postbody">I made a software <a class="postlink" href="http://zzo38computer.cjb.net/nitro2/Xyds" target="_blank">Xyds</a> but it didn't work on real hardware the first time, it work on emulator only. I downloaded the new version of devkitARM, in case that was a mistake in the old version of devkitARM, but now I get error message:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">F:\devkitPro\proj\xyds&gt;make
<br/>
make -C arm7
<br/>
make[1]: Entering directory `/f/devkitPro/proj/xyds/arm7'
<br/>
linking xyds.arm7.elf
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0\libgcc.a(_divsi3.o): In fun
<br/>
ction `__aeabi_idiv':
<br/>
(.text+0x0): multiple definition of `__divsi3'
<br/>
f:/devkitpro/libnds/lib\libnds7.a(division.o):e:/projects/devkitPro/libnds/sourc
<br/>
e/common/division.s:(.text+0x0): first defined here
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: ERROR: Source object f:/devkitpro/libnds/lib\libnds7.a(clock.o) has EABI v
<br/>
ersion 0, but target f:/devkitPro/proj/xyds/arm7/xyds.arm7.elf has EABI version
<br/>
4
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: failed to merge target specific data of file f:/devkitpro/libnds/lib\libnd
<br/>
s7.a(clock.o)
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: ERROR: Source object f:/devkitpro/libnds/lib\libnds7.a(touch.o) has EABI v
<br/>
ersion 0, but target f:/devkitPro/proj/xyds/arm7/xyds.arm7.elf has EABI version
<br/>
4
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: failed to merge target specific data of file f:/devkitpro/libnds/lib\libnd
<br/>
s7.a(touch.o)
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: ERROR: Source object f:/devkitpro/libnds/lib\libnds7.a(interrupts.o) has E
<br/>
ABI version 0, but target f:/devkitPro/proj/xyds/arm7/xyds.arm7.elf has EABI ver
<br/>
sion 4
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: failed to merge target specific data of file f:/devkitpro/libnds/lib\libnd
<br/>
s7.a(interrupts.o)
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: ERROR: Source object f:/devkitpro/libnds/lib\libnds7.a(biosCalls.o) has EA
<br/>
BI version 0, but target f:/devkitPro/proj/xyds/arm7/xyds.arm7.elf has EABI vers
<br/>
ion 4
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: failed to merge target specific data of file f:/devkitpro/libnds/lib\libnd
<br/>
s7.a(biosCalls.o)
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: ERROR: Source object f:/devkitpro/libnds/lib\libnds7.a(division.o) has EAB
<br/>
I version 0, but target f:/devkitPro/proj/xyds/arm7/xyds.arm7.elf has EABI versi
<br/>
on 4
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: failed to merge target specific data of file f:/devkitpro/libnds/lib\libnd
<br/>
s7.a(division.o)
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: ERROR: Source object f:/devkitpro/libnds/lib\libnds7.a(interruptDispatcher
<br/>
.o) has EABI version 0, but target f:/devkitPro/proj/xyds/arm7/xyds.arm7.elf has
<br/>
 EABI version 4
<br/>
f:/devkitpro/devkitarm/bin/../lib/gcc/arm-eabi/4.3.0/../../../../arm-eabi/bin/ld
<br/>
.exe: failed to merge target specific data of file f:/devkitpro/libnds/lib\libnd
<br/>
s7.a(interruptDispatcher.o)
<br/>
collect2: ld returned 1 exit status
<br/>
make[2]: *** [/f/devkitPro/proj/xyds/arm7/xyds.arm7.elf] Error 1
<br/>
make[1]: *** [build] Error 2
<br/>
make[1]: Leaving directory `/f/devkitPro/proj/xyds/arm7'
<br/>
make: *** [arm7/xyds.elf] Error 2</td> </tr></table><span class="postbody">Can you tell me how to fix it, please? What is a EABI version, anyways?<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163817 - tepples - Sun Oct 12, 2008 11:18 pm</h4>
    <div class="postbody"><span class="postbody">The EABI version is essentially the format of .o files.
<br/>
<br/>
Did you update libnds at the same time?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163819 - silent_code - Sun Oct 12, 2008 11:24 pm</h4>
    <div class="postbody"><span class="postbody">Double post? :^|<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163832 - zzo38computer - Mon Oct 13, 2008 4:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">The EABI version is essentially the format of .o files.
<br/>
<br/>
Did you update libnds at the same time?</td> </tr></table><span class="postbody">
<br/>
I updated libnds. The EABI version is fixed now, but there is error with ARM7 codes now. Does the ARM7 codes need to be updated for new libnds? Does the makefile have to be changed? If so, can you post the new ARM7 codes here? I just used the default ARM7 codes in my project.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">f:/devkitPro/proj/xyds/arm7/source/main7.c: In function 'VblankHandler':
<br/>
f:/devkitPro/proj/xyds/arm7/source/main7.c:35: error: 'TransferRegion' has no member named 'curtime'
<br/>
f:/devkitPro/proj/xyds/arm7/source/main7.c:70: error: 'TransferRegion' has no member named 'heartbeat'
<br/>
f:/devkitPro/proj/xyds/arm7/source/main7.c:82: error: 'TransferRegion' has no member named 'curtime'
<br/>
f:/devkitPro/proj/xyds/arm7/source/main7.c:35: warning: unused variable 'ct'</td> </tr></table><span class="postbody">
<br/>
<br/>
Can you please also look to see if there is any other mistakes in my codes? (I posted the link at the top message of this thread)<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163835 - mml - Mon Oct 13, 2008 8:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I just used the default ARM7 codes in my project.</td> </tr></table><span class="postbody">
<br/>
<br/>
Then replace it with the new ARM7 code from the updated templates</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163841 - zzo38computer - Mon Oct 13, 2008 4:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mml wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I just used the default ARM7 codes in my project.</td> </tr></table><span class="postbody">
<br/>
<br/>
Then replace it with the new ARM7 code from the updated templates</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I fixed that, and then I fixed the names for the register but I have the same problem as I did before I replaced the devkitPro and libnds.
<br/>
<br/>
These two codes work correctly on DeSmuME emulator, but on real hardware, updatetile won't change the palettes used by the tiles (but it will flip them over like it is supposed to), and update1char won't change anything at all.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void updatetile(u16 m) {
<br/>
   m=m&amp;~1;
<br/>
   int x=((m-0xE000)&gt;&gt;1)%xymram[0xFFF3];
<br/>
   int y=((m-0xE000)&gt;&gt;1)/xymram[0xFFF3];
<br/>
   u16* p=(u16*)(SCREEN_BASE_BLOCK(0)+y*64+x*2);
<br/>
   u16 d=xymram[m];
<br/>
   if(xymram[m+1]&amp;0x01) d|=0x1000;
<br/>
   if(xymram[m+1]&amp;0x40) d|=0x0800;
<br/>
   if(xymram[m+1]&amp;0x80) d|=0x0400;
<br/>
   *p=d;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void update1char(u8 d) {
<br/>
   u8* p;
<br/>
   u16 m=0xC000+8*d;
<br/>
   u8 z,d1;
<br/>
   int x,y;
<br/>
   for(y=0;y&lt;8;y++) {
<br/>
      z=xymram[y+m];
<br/>
      for(x=0;x&lt;8;x+=2) {
<br/>
         p=(u8*)(CHAR_BASE_BLOCK(1)+32*d+4*y+x/2);
<br/>
         d1=0x22;
<br/>
         if(z&amp;(0x80&gt;&gt;x)) d1|=0x01;
<br/>
         if(z&amp;(0x80&gt;&gt;(x+1))) d1|=0x10;
<br/>
         *p=d1;
<br/>
      }
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Here's the initialization codes, in case the initialization codes have something to do with it:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void gfx_init() {   
<br/>
   REG_POWERCNT=POWER_SWAP_LCDS | POWER_ALL_2D;
<br/>
   vramSetMainBanks(VRAM_A_MAIN_BG,VRAM_B_MAIN_BG,VRAM_C_SUB_BG,VRAM_D_LCD);
<br/>
   SUB_DISPLAY_CR=MODE_0_2D|DISPLAY_BG0_ACTIVE;
<br/>
   DISPLAY_CR=MODE_0_2D|DISPLAY_BG0_ACTIVE;
<br/>
   SUB_BG0_CR=BG_TILE_BASE(1);
<br/>
   SUB_BG0_X0=0;
<br/>
   SUB_BG0_Y0=0;
<br/>
   BG0_CR=BG_TILE_BASE(1);
<br/>
   BG0_X0=0;
<br/>
   BG0_Y0=0;
<br/>
   swiFastCopy(&amp;font_bin,(u16*)(CHAR_BASE_BLOCK_SUB(1)),font_bin_size/4);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
The sub display works fine, only the main display has the problems I described above.<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163842 - elhobbs - Mon Oct 13, 2008 4:46 pm</h4>
    <div class="postbody"><span class="postbody">update1char is doing 8 bit writes to video memory - this does not work. you need to do 16 bit writes to video memory.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163843 - josath - Mon Oct 13, 2008 5:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zzo38computer wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void updatetile(u16 m) {
<br/>
   m=m&amp;~1;
<br/>
   int x=((m-0xE000)&gt;&gt;1)%xymram[0xFFF3];
<br/>
   int y=((m-0xE000)&gt;&gt;1)/xymram[0xFFF3];
<br/>
   u16* p=(u16*)(SCREEN_BASE_BLOCK(0)+y*64+x*2);
<br/>
   u16 d=xymram[m];
<br/>
   if(xymram[m+1]&amp;0x01) d|=0x1000;
<br/>
   if(xymram[m+1]&amp;0x40) d|=0x0800;
<br/>
   if(xymram[m+1]&amp;0x80) d|=0x0400;
<br/>
   *p=d;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void update1char(u8 d) {
<br/>
   u8* p;
<br/>
   u16 m=0xC000+8*d;
<br/>
   u8 z,d1;
<br/>
   int x,y;
<br/>
   for(y=0;y&lt;8;y++) {
<br/>
      z=xymram[y+m];
<br/>
      for(x=0;x&lt;8;x+=2) {
<br/>
         p=(u8*)(CHAR_BASE_BLOCK(1)+32*d+4*y+x/2);
<br/>
         d1=0x22;
<br/>
         if(z&amp;(0x80&gt;&gt;x)) d1|=0x01;
<br/>
         if(z&amp;(0x80&gt;&gt;(x+1))) d1|=0x10;
<br/>
         *p=d1;
<br/>
      }
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
Holy magic numbers, Batman!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163845 - zzo38computer - Mon Oct 13, 2008 6:41 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">update1char is doing 8 bit writes to video memory - this does not work. you need to do 16 bit writes to video memory.</td> </tr></table><span class="postbody">Thanks. That fixed it. I used this code:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void write8bitvram(u8* p8,u8 v8) {
<br/>
   u16* p16=(u16*)(((u32)p8)&amp;~1);
<br/>
   if(((u32)p8)&amp;1) {
<br/>
      *p16=(0x00FF&amp;*p16)|(v8*0x100);
<br/>
   } else {
<br/>
      *p16=(0xFF00&amp;*p16)|(v8);
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">Is this the best way to do it? Is there a better way? And why does the NDS require 16 bit writes to video memory anyways?<br/>_________________<br/><span style="font-weight: bold">Important:</span> Please send messages about FWNITRO to the public forum, not privately to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163851 - elhobbs - Mon Oct 13, 2008 7:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zzo38computer wrote:</b></span></td> </tr> <tr> <td class="quote">Is this the best way to do it? Is there a better way? And why does the NDS require 16 bit writes to video memory anyways?</td> </tr></table><span class="postbody">maybe.probably.because it does.
<br/>
<br/>
it depend on what you are using it for. If you are trying draw the entire screen with this then it will be very slow. if it is used to load or update something everyonce in a while then it is probably fine.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
