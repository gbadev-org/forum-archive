<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Get current 3D coordinate ? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Get current 3D coordinate ?</h2>
<div id="posts">
<div class="post">
    <h4>#147544 - ix78 - Sat Dec 22, 2007 2:14 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
I'm writing a small game in 3D (breakout) and have already bumped into a problem &gt;_&lt;"
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
float obj_x;
<br/>
float obj_y;
<br/>
float obj_origin_x;
<br/>
float obj_origin_y;
<br/>
float obj_angel;
<br/>
float obj_travel;
<br/>
<br/>
void ball_fire(void)
<br/>
{
<br/>
 obj_origin_x = obj_x;
<br/>
 obj_origin_y = obj_y;
<br/>
 obj_angel = 30;
<br/>
 obj_travel = 0;
<br/>
}
<br/>
<br/>
void ball_update(void)
<br/>
{
<br/>
 glPushMatrix();
<br/>
 glTranslatef(obj_origin_x, obj_origin_y, 0);
<br/>
 glRotateZ(obj_angel);
<br/>
 glTranslatef(0, obj_travel, 0);
<br/>
 DrawObj();
<br/>
 glPopMatrix(1);
<br/>
<br/>
 obj_travel += .1;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The code above should be pretty straightforward...
<br/>
<br/>
The problem now is I do not know the ball's actual x, y coordinate in relation to the original world coordinate for me to do collision detection with other objects in the world.
<br/>
<br/>
Is there a way to get access to current world matrix? Or do I have to write my own matrix functions to calculate the position?
<br/>
<br/>
Hope I'm not confusing anybody here :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147552 - Sausage Boy - Sat Dec 22, 2007 11:14 pm</h4>
    <div class="postbody"><span class="postbody">It sounds like you should learn some trigonometry. I found this guide pretty helpful:
<br/>
<br/>
<a href="http://www.clarku.edu/~djoyce/trig/" target="_blank">http://www.clarku.edu/~djoyce/trig/</a>
<br/>
<br/>
Your current strategy, while cool, is a very unusual and impractical way to handle this problem. But yeah, come back after you've really studied, and really _understand_ trigonometry, especially sines and cosines. They will help you greatly in the long run.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147561 - crossraleigh - Sun Dec 23, 2007 7:20 am</h4>
    <div class="postbody"><span class="postbody">If you already understand trigonometry and you still want the matrix, there is a memory area that GBATEK calls CLIPMTX_RESULT which libnds will read for you using glGetFixed(GL_GET_MATRIX_POSITION, &amp;matrix).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147583 - M3d10n - Sun Dec 23, 2007 10:41 pm</h4>
    <div class="postbody"><span class="postbody">Reading the matrix for this sounds really overkill. You are using the graphics functions to move the ball position and trying to read it back. This is not the best way to do it.
<br/>
<br/>
You need proper variables for tracking the ball's position (ball_x, ball_y). Update your ball position (by modifying ball_x and ball_y, as example), then pass it to glTranslate the render your ball in the desired position instead.
<br/>
<br/>
--EDIT--
<br/>
<br/>
Ah, now I understood why you want to read the matrix: you're using an angle-based rotation to change the ball direction. Like Sausage Boy, trigonometry allows you to calculate the coordinates the ball should move for a given angle, but for a simple breakout game you don't even need to worry about angles:
<br/>
<br/>
Use variables to keep track of the ball's X and Y velocities. On every update, add the X velocity to the balls X position and the Y velocity to the ball's Y position. 
<br/>
<br/>
Then you only need to invert the sign of the X velocity if the ball collides with an block horizontally, and the Y velocity's sign if it hits something vertically. To change the angle when the ball hits the paddle, use some number fudging or hardcoded X and Y velocities based on where in the paddle the ball hit: a greater Y velocity than an X one if the ball hits the middle of the paddle, and the inverse if it hits the sides.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
