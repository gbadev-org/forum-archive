<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>WMB host question. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > WMB host question.</h2>
<div id="posts">
<div class="post">
    <h4>#165093 - freddan007 - Tue Dec 09, 2008 8:20 pm</h4>
    <div class="postbody"><span class="postbody">Please move this if it's in the wrong forum.
<br/>
I downloaded the 2.3 (or something) version of the wmbhost RSA mod by yellowstar and tried to send the homebrew balance by seddy from my dsx to my other ds. As far as I have read this shouldn't be possible if the other ds is not flashed. My question is will my ds get flashed if I used the DS-Xtream card because I successfully sent the homebrew to the other DS but when it started it froze.
<br/>
<br/>
Video of the attempt:
<br/>
<a href="http://www.youtube.com/watch?v=8_1747uUvFc" target="_blank">http://www.youtube.com/watch?v=8_1747uUvFc</a>
<br/>
(If I can't post links: h ttp : / /w w w.y out ube.co m/wa tch?v= 8_1747 uUv F c           without spaces)
<br/>
<br/>
Is this what should happen if the firmwire is not flashed or should the RSA frame not be possible to send?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165146 - yellowstar - Wed Dec 10, 2008 9:51 pm</h4>
    <div class="postbody"><span class="postbody">The current WMB Host RSA Mod release is 2.2b. It is normal for the client DS to freeze with an odd gray logo after downloading the homebrew software, when the client DS is not flashed. Flashing will allow homebrew sent over WMB to run.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165167 - freddan007 - Thu Dec 11, 2008 9:49 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yellowstar wrote:</b></span></td> </tr> <tr> <td class="quote">The current WMB Host RSA Mod release is 2.2b. It is normal for the client DS to freeze with an odd gray logo after downloading the homebrew software, when the client DS is not flashed. Flashing will allow homebrew sent over WMB to run.</td> </tr></table><span class="postbody">Thanks for the reply. Do you know what is causing the freaze after the "nintendo like" logo has showed up?(Except from the un flashed firmwire)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165182 - yellowstar - Thu Dec 11, 2008 7:10 pm</h4>
    <div class="postbody"><span class="postbody">Official software sent over WMB is RSA signed. There's a public key, and a private key. The public key included in the signature, is used for verification. The private key is used for generating the public key, and signing. We don't know what the private key is, since no-one but Nintendo knows what it is. Really - it's not included in any DS software at all. Brute-forcing the private key, is not feasible. Even the best supercomputers couldn't generate the correct key before the DS becomes obsolete.(Like at least a century)  When verification fails on a stock DS/NoFlashMe DS, the freeze happens. FlashMe patches the verification result so the DS boots the homebrew, instead of freezing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165183 - freddan007 - Thu Dec 11, 2008 7:15 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yellowstar wrote:</b></span></td> </tr> <tr> <td class="quote">Official software sent over WMB is RSA signed. There's a public key, and a private key. The public key included in the signature, is used for verification. The private key is used for generating the public key, and signing. We don't know what the private key is, since no-one but Nintendo knows what it is. Really - it's not included in any DS software at all. Brute-forcing the private key, is not feasible. Even the best supercomputers couldn't generate the correct key before the DS becomes obsolete.(Like at least a century)  When verification fails on a stock DS/NoFlashMe DS, the freeze happens. FlashMe patches the verification result so the DS boots the homebrew, instead of freezing.</td> </tr></table><span class="postbody">Is the private key stored anywhere or is the nds using some sort of algorythm to generate it? How many bytes/bits is the key? Can't you sniff the key?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165185 - yellowstar - Thu Dec 11, 2008 8:18 pm</h4>
    <div class="postbody"><span class="postbody">No, it's nowhere we can get it - it's only stored with Nintendo's signing software. The private key is fixed - using the wrong private key results in a verification failure. It's 1024-bits/128-bytes. Sniffing is not possible. RSA is a sort of encryption, but it's meant for authentication, like SHA-1 hashes, which is what the DS uses for WMB verification. The private key is used to generate the public key. As said before, this is done during signing. The public key is basically an encrypted hash of the header, arm7/9 binaries. To decrypt and verify the public key/signature, you don't need the private key, you just need another public key. The official WMB client uses a public key stored in the firmware for this. To verify, you just need to decrypt the signature with a public key, such as the WMB client's public key, then compute the combined hash for the header, arm7/9 binaries, then compare this hash, and the decrypted hash. If they match, verification passed, otherwise verification failed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165199 - freddan007 - Fri Dec 12, 2008 1:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yellowstar wrote:</b></span></td> </tr> <tr> <td class="quote">No, it's nowhere we can get it - it's only stored with Nintendo's signing software. The private key is fixed - using the wrong private key results in a verification failure. It's 1024-bits/128-bytes. Sniffing is not possible. RSA is a sort of encryption, but it's meant for authentication, like SHA-1 hashes, which is what the DS uses for WMB verification. The private key is used to generate the public key. As said before, this is done during signing. The public key is basically an encrypted hash of the header, arm7/9 binaries. To decrypt and verify the public key/signature, you don't need the private key, you just need another public key. The official WMB client uses a public key stored in the firmware for this. To verify, you just need to decrypt the signature with a public key, such as the WMB client's public key, then compute the combined hash for the header, arm7/9 binaries, then compare this hash, and the decrypted hash. If they match, verification passed, otherwise verification failed.</td> </tr></table><span class="postbody">So you would need to get the source of the nds firmwire/one roms to be able to calculate it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165201 - chuckstudios - Fri Dec 12, 2008 1:48 pm</h4>
    <div class="postbody"><span class="postbody">No, you'd need to break into Nintendo and steal hard drives. And then you go to prison.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165227 - freddan007 - Sat Dec 13, 2008 4:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chuckstudios wrote:</b></span></td> </tr> <tr> <td class="quote">No, you'd need to break into Nintendo and steal hard drives. And then you go to prison.</td> </tr></table><span class="postbody">Not if they can't prove it. Muahahahahahaaa...
<br/>
It would be possible to crack it but it would be very very very hard(Without breaking into nintendo). There is just one thing that bothers me. How does the other ds know it's the right/wrong key? That must be in the firmwire right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165233 - yellowstar - Sun Dec 14, 2008 12:32 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>freddan007 wrote:</b></span></td> </tr> <tr> <td class="quote">How does the other ds know it's the right/wrong key? That must be in the firmwire right?</td> </tr></table><span class="postbody"> I already explained that in my previous post. Yes, the public key used for verification is in the firmware. When signing is done, a public key is generated from the private key and a combined hash previously described. This key is usually stored as the RSA signature stored at the end of the .nds. The signature is a encrypted combined hash, and decryption of it is done with another public key, normally the public key from the firmware. If the calculated combined hash does not match the decrypted hash, verification fails.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165322 - tepples - Wed Dec 17, 2008 5:59 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>freddan007 wrote:</b></span></td> </tr> <tr> <td class="quote">There is just one thing that bothers me. How does the other ds know it's the right/wrong key?</td> </tr></table><span class="postbody">
<br/>
Please go to Wikipedia and look up RSA. After you understand RSA, you'll probably understand our explanations of how the DS firmware applies RSA.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165334 - HyperHacker - Wed Dec 17, 2008 9:23 am</h4>
    <div class="postbody"><span class="postbody">To oversimplify a bit: it's an algorithm. X goes in, Y comes out. Y can easily be extracted from the firmware, but it's only good for verifying the binary. To make a new binary pass verification, we need X. Only Nintendo has X (it's not anywhere in the code, etc), and it's a ridiculously huge number that would take at best hundreds of years to guess or brute-force. Knowing Y does not help you determine X at all, and the algorithm only works one way (i.e. you can't just use it "in reverse").
<br/>
FlashMe reprograms it to skip the verification, so it will run any program you send it. That doesn't work in reverse either though - other DSes will still reject the program being sent from one that accepted it, if they aren't also flashed.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165339 - freddan007 - Wed Dec 17, 2008 2:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">To oversimplify a bit: it's an algorithm. X goes in, Y comes out. Y can easily be extracted from the firmware, but it's only good for verifying the binary. To make a new binary pass verification, we need X. Only Nintendo has X (it's not anywhere in the code, etc), and it's a ridiculously huge number that would take at best hundreds of years to guess or brute-force. Knowing Y does not help you determine X at all, and the algorithm only works one way (i.e. you can't just use it "in reverse").
<br/>
FlashMe reprograms it to skip the verification, so it will run any program you send it. That doesn't work in reverse either though - other DSes will still reject the program being sent from one that accepted it, if they aren't also flashed.</td> </tr></table><span class="postbody">One more thing(Sorry for beeing a noob). Is X the same on all games or is it generated by nintendo for every game?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
