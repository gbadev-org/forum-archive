<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>2 MP3 Streams - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > 2 MP3 Streams</h2>
<div id="posts">
<div class="post">
    <h4>#121115 - DVSoftware - Fri Mar 09, 2007 2:56 am</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
Is it possible to decode 2 64kbps mono mp3 streams on ARM7 with helix, or should i seek another codec for my needs?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121120 - Firon - Fri Mar 09, 2007 4:24 am</h4>
    <div class="postbody"><span class="postbody">The ARM7 only has enough CPU power to decode one MP3 stream.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121122 - tepples - Fri Mar 09, 2007 4:34 am</h4>
    <div class="postbody"><span class="postbody">But if it can decode a 2-channel MP3 stream in real time, why can't it decode two 1-channel MP3 streams in real time?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121127 - Firon - Fri Mar 09, 2007 7:41 am</h4>
    <div class="postbody"><span class="postbody">Can it? I don't remember it being able to... I could've sworn simon only got it decoding a 2-channel stream on the ARM9.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121132 - simonjhall - Fri Mar 09, 2007 10:26 am</h4>
    <div class="postbody"><span class="postbody">I don't reckon you'd be able to play two mono 64kbps streams on the ARM7 - I couldn't even get it to do stereo!
<br/>
<br/>
Either that decoder isn't good enough or the processor ain't up to the task.
<br/>
However Helix is tiny hence why I'm using it. I couldn't fit anything else in the 96k!
<br/>
<br/>
The ARM9 has more than enough grunt to do what you want though.<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121137 - DVSoftware - Fri Mar 09, 2007 11:55 am</h4>
    <div class="postbody"><span class="postbody">i know that arm9 can do it, but game needs to run, too
<br/>
i'm creating some music game, and i need to play 2 streams :/
<br/>
<br/>
according to helix community, ARM7 should be able to decode 320kbps 48khz stream using 30 mhz... 
<br/>
have you compiled it with fixed point define?
<br/>
<br/>
Edit:
<br/>
can you suggest some less cpu intensive codec, that can be used on nintendo ds, and that can compress one song to less than 5 mb?
<br/>
<br/>
Edit #2:
<br/>
Real audio might be an answer
<br/>
<a href="https://datatype.helixcommunity.org/ra8fixpt" target="_blank">https://datatype.helixcommunity.org/ra8fixpt</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121138 - simonjhall - Fri Mar 09, 2007 12:15 pm</h4>
    <div class="postbody"><span class="postbody">320kbps? No chance! The figures quoted on that site are misleading. For instance, it assumes certain things about memory access times.
<br/>
<br/>
I'm using the fixed-point ARM-asm optimised build but I still get low performance. I reckon that the performance is funky due to the lack of data cache. I'll try again this weekend if you like, in case I'm doing something wrong...
<br/>
<br/>
On the other hand, the ARM9 which does have a data cache doesn't do that much better - it's only about twice as fast (which is in line with the increase in clock speed).<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121142 - OOPMan - Fri Mar 09, 2007 1:40 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, what Simon said...
<br/>
<br/>
I'm pretty sure the Helix site is a little more specific than just saying "ARM7, 320kbps, 48khz, 30mhz"
<br/>
<br/>
ARM are not like PC CPUs. They don't tend to come package as separate things that can be dropped into a motherboard.
<br/>
<br/>
They usually come in the form of highly embedded SOCs with wildly varying features when it comes to things cache, etc...
<br/>
<br/>
So blanket statements about Helix on ARMs are silly, because the ARM line is a very very very diverse thing...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121145 - tepples - Fri Mar 09, 2007 2:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DVSoftware wrote:</b></span></td> </tr> <tr> <td class="quote">can you suggest some less cpu intensive codec, that can be used on nintendo ds, and that can compress one song to less than 5 mb?</td> </tr></table><span class="postbody">
<br/>
One song of how long? And do you need higher fidelity than players of a handheld game expect? I've used <a class="postlink" href="http://www.pineight.com/gba/gsm/" target="_blank">GSM Full Rate on the Game Boy Advance</a>, which is half as fast as the DS's ARM7. Others have had success with MP2.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121150 - DVSoftware - Fri Mar 09, 2007 3:22 pm</h4>
    <div class="postbody"><span class="postbody">Approx. 3 minute song.
<br/>
I need it at least 22khz and quality that's equal or better to 64kbits mp3.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121178 - silent_code - Fri Mar 09, 2007 10:19 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>OOPMan wrote:</b></span></td> </tr> <tr> <td class="quote">ARM are not like PC CPUs. They don't tend to come package as separate things that can be dropped into a motherboard. They usually come in the form of highly embedded SOCs with wildly varying features when it comes to things cache, etc...</td> </tr></table><span class="postbody">
<br/>
<br/>
that's right!
<br/>
(@ DVSoftware) and it's even worse: arm don't even sell cpus, they sell cpu architectures! (that's like blueprints.)
<br/>
in the case of the nds' processors, nintendo bought the license, added some optional components they needed and then sent the whole thing to production by themselves (that's sort of a rush through the process, but you get the idea).
<br/>
you can be certain, that two arm7 based cpus of two different devices will perform differntly and will have different features. take the gp32 as an example (that may be able to do the mp3 stuff you want, i guess).
<br/>
<br/>
it's kind of like with ibm's power pc cpus. you can't compare a gekko (gamecube) cpu to a xbox 360 cpu (core), though they are both based on the ppc architecture. even the cell cpu is a ppc "on the outside". afaik the same code will run on all these cpus (with none or minor changes), but perform very differently.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121217 - Firon - Sat Mar 10, 2007 10:24 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DVSoftware wrote:</b></span></td> </tr> <tr> <td class="quote">Approx. 3 minute song.
<br/>
I need it at least 22khz and quality that's equal or better to 64kbits mp3.</td> </tr></table><span class="postbody">
<br/>
You could try looking into WavPack lossy using fast mode (-fx3). Assuming you resample the input before encoding to 32768Hz (or lower) and mono, you should have no problem decoding two streams on the ARM7.
<br/>
You won't get 64kbit/s, but you can do pretty decent. I was doing 180kbps in 32768Hz stereo, so you could maybe get away with 100-120 per stream in mono. Less if you don't mind some additional hiss/roughness.
<br/>
<br/>
<a href="http://www.wavpack.com/downloads.html" target="_blank">http://www.wavpack.com/downloads.html</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121232 - DVSoftware - Sat Mar 10, 2007 5:44 pm</h4>
    <div class="postbody"><span class="postbody">interesting, can you direct me how can i use the decoder on ds?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121279 - bsder - Sun Mar 11, 2007 1:24 am</h4>
    <div class="postbody"><span class="postbody">If you can, you'd probably be better off going with the Tremor codec from Ogg Vorbis.
<br/>
<br/>
Ogg seems to require a little less CPU horsepower than MP3 as it trades some lookup tables for computation.
<br/>
<br/>
I don't know if you can fit the whole codec in 96K, though.  I think you can fit the decoder, but there are some lookup tables you might need to stash in main memory.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121431 - OOPMan - Mon Mar 12, 2007 11:49 am</h4>
    <div class="postbody"><span class="postbody">simonjhall has treaded the path of Tremor on the ARM7 before bsder. Unfortunately, it's a little too bloated by his accounts to run nicely on the DS' ARM7...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121522 - HyperHacker - Mon Mar 12, 2007 10:13 pm</h4>
    <div class="postbody"><span class="postbody">Hm, OGG uses less CPU power than MP3? I always thought it was the opposite.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121529 - simonjhall - Mon Mar 12, 2007 10:32 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, I couldn't fit tremor into the 64+32k of fast memory available to the ARM7. Yeah, I could have relocated it elsewhere in memory but 100k of memory is really hard to come by :-)
<br/>
As a result I have no idea of what the performance is like. I'd imagine it being poor...
<br/>
<br/>
The reason I've decided on using MP3 over OGG (so far...) is because I can fit the Helix decoder, the DS wifi lib and a gallon of sound code into that same 96k. I can't fit printf/sprintf in there though :-(<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121534 - Lick - Mon Mar 12, 2007 10:47 pm</h4>
    <div class="postbody"><span class="postbody">On the ARM9 OGG was <span style="font-weight: bold">much</span> faster. Perhaps due to the fact that Tremor is an optimized library, where libmad is not.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121567 - HyperHacker - Tue Mar 13, 2007 5:10 am</h4>
    <div class="postbody"><span class="postbody">What about for R4300? Is there a nice optimized OGG decoder for that, and/or does OGG need less CPU power than MP3 in general (not just one specific decoder)?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121597 - OOPMan - Tue Mar 13, 2007 10:26 am</h4>
    <div class="postbody"><span class="postbody">I always thought OGG generally had higher decoding requirements, being a more complex codec...
<br/>
<br/>
Maybe I'm wrong, though...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
