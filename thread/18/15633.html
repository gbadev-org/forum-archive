<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Chishm's exec-stub, devkitARM r22 and up - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Chishm's exec-stub, devkitARM r22 and up</h2>
<div id="posts">
<div class="post">
    <h4>#158064 - kusma - Wed Jun 04, 2008 2:37 am</h4>
    <div class="postbody"><span class="postbody">Today, while working on a project that uses Chishm's exec-stub, I upgraded devkitARM from r21 to r23 and exec started freezing the hardware. After downgrading step by step, I found out that devkitARM r22 was the earliest release of devkitARM to trigger this issue with my codebase.
<br/>
<br/>
Has anyone seen similar behavior? Is there any known fix or work-around? These kinds of issues are a bit hard to debug ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158088 - elhobbs - Wed Jun 04, 2008 5:52 pm</h4>
    <div class="postbody"><span class="postbody">I am not sure but I think I remember something about newlib being a lot bigger in the newer releases and using up all the memory on the arm7... or something along those lines</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158126 - kusma - Thu Jun 05, 2008 11:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">I am not sure but I think I remember something about newlib being a lot bigger in the newer releases and using up all the memory on the arm7... or something along those lines</td> </tr></table><span class="postbody">
<br/>
Hmm, where can I find more information about this? I'm a bit curious, since neither the ARM7 or the ARM9 seems to need much memory. I guess I could try to link r22-object files with the r21-linker and see if it helps...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158130 - Dwedit - Thu Jun 05, 2008 11:46 am</h4>
    <div class="postbody"><span class="postbody">Post the .map files, those are what matters.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158131 - kusma - Thu Jun 05, 2008 12:13 pm</h4>
    <div class="postbody"><span class="postbody">Good point, I'll have a look at them and post them if I can't find anything suspicious myself.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158145 - kusma - Thu Jun 05, 2008 7:19 pm</h4>
    <div class="postbody"><span class="postbody">I can't really find anything out of the ordinary with the map-files.
<br/>
<br/>
Here's the arm7 map-files:
<br/>
<a class="postlink" href="http://kg.slengpung.com/kussie/arm7_r21.map" target="_blank">http://kg.slengpung.com/kussie/arm7_r21.map</a>
<br/>
<a class="postlink" href="http://kg.slengpung.com/kussie/arm7_r22.map" target="_blank">http://kg.slengpung.com/kussie/arm7_r22.map</a>
<br/>
<br/>
Here's the arm9 map-files:
<br/>
<a class="postlink" href="http://kg.slengpung.com/kussie/arm9_r21.map" target="_blank">http://kg.slengpung.com/kussie/arm9_r21.map</a>
<br/>
<a class="postlink" href="http://kg.slengpung.com/kussie/arm9_r22.map" target="_blank">http://kg.slengpung.com/kussie/arm9_r22.map</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158810 - Zalo - Wed Jun 18, 2008 1:12 pm</h4>
    <div class="postbody"><span class="postbody">Hi. I have also upgraded to r23 from r20 (yes, I don't like to upgrade because I always have problems with it)
<br/>
<br/>
I have discovered that dirnext function has stopped working. Can anybody else try if it works? Basically, this loop
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">while(dirnext(dir, filename, &amp;st) == 0)
<br/>
  {
<br/>
...
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
never ends :(<br/>_________________<br/>-----
<br/>
Zalo</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158812 - kusma - Wed Jun 18, 2008 1:30 pm</h4>
    <div class="postbody"><span class="postbody">This works just fine for me with r23. What are the exact conditions for your issue? How many files does the folder you enumerate contain, what filesystem are you using?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158853 - Zalo - Thu Jun 19, 2008 1:32 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
I am using libfat. Ii doesn't seem to be a problem with the number of files in the folder as I have tried on different folders.
<br/>
<br/>
The function iterates on "..", ".", and then freezes.
<br/>
<br/>
I patched the app with DLDI for scsd and trying on no$GBA with fcfsr. In booth places I have the same problem
<br/>
<br/>
If I downgrade to DevKitArm r20 everything works fine again<br/>_________________<br/>-----
<br/>
Zalo</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159266 - fluff - Sat Jun 28, 2008 11:43 am</h4>
    <div class="postbody"><span class="postbody">Zalo:
<br/>
<br/>
maybe you're running PAlib or some other big invasive lib? libfat's directory functions didn't work for me with r23 and PAlib. Getting rid of the latter solved the problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159429 - Maple - Mon Jun 30, 2008 6:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>fluff wrote:</b></span></td> </tr> <tr> <td class="quote">Zalo:
<br/>
<br/>
maybe you're running PAlib or some other big invasive lib? libfat's directory functions didn't work for me with r23 and PAlib. Getting rid of the latter solved the problem.</td> </tr></table><span class="postbody">
<br/>
Well unless you re-wrote a lot of code, then PALib and r23 aren't compatible in the first place, regardless of using libfat or not.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159430 - fluff - Mon Jun 30, 2008 6:52 pm</h4>
    <div class="postbody"><span class="postbody">Worked decent enough for me, but I wasn't really using much of PAlib's functionality so there were probably things that didn't work correctly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159440 - Zalo - Mon Jun 30, 2008 11:35 pm</h4>
    <div class="postbody"><span class="postbody">I am not using palib... this is weird. It only happens to me then?<br/>_________________<br/>-----
<br/>
Zalo</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#159514 - chishm - Wed Jul 02, 2008 4:09 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Zalo wrote:</b></span></td> </tr> <tr> <td class="quote">Hi. I have also upgraded to r23 from r20 (yes, I don't like to upgrade because I always have problems with it)
<br/>
<br/>
I have discovered that dirnext function has stopped working. Can anybody else try if it works? Basically, this loop
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">while(dirnext(dir, filename, &amp;st) == 0)
<br/>
  {
<br/>
...
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
never ends :(</span></td> </tr></table><span class="postbody">
<br/>
Make sure filename is at least 768 bytes long, although MAXPATHLEN is safer.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
