<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>appended data - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > appended data</h2>
<div id="posts">
<div class="post">
    <h4>#145455 - pettsu - Thu Nov 15, 2007 7:46 pm</h4>
    <div class="postbody"><span class="postbody">hi, i'm new here so forgive me a little. i'm appending a data file to the .nds file and there's two things i'd like help with:
<br/>
<br/>
1. getting the address of the data. i'm guessing NDSHeader.romSize comes into it and i've tried a few values but to no avail
<br/>
<br/>
and
<br/>
<br/>
2. a cleaner way of appending the data. at the moment i compile the .nds with a makefile from ndslib (using visual c++) then i've got a copy of ndstool and a .bat file which extracts the .nds file and recreates it with my data appended. pretty shabby i know but i've hardly used makefiles and i'm tentative about changing existing ones too much
<br/>
<br/>
any help or advice is appreciated, thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145505 - M3d10n - Fri Nov 16, 2007 10:01 pm</h4>
    <div class="postbody"><span class="postbody">LibFAT using the FCSR DLDI driver. Works like a charm on my EZ-Flash 2. U simply did a few changes to the DLDIrc bat files so my build process also rebuilds the appended data.
<br/>
<br/>
Do a search for FCSR, there are other threads with details on using it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145523 - tepples - Sat Nov 17, 2007 4:35 am</h4>
    <div class="postbody"><span class="postbody">FCSR works on some (most?) SLOT-2 cards. As far as I can tell, it's not designed for SLOT-1 cards.
<br/>
<br/>
pettsu: Which flash equipment are you using?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145564 - pettsu - Sun Nov 18, 2007 4:54 am</h4>
    <div class="postbody"><span class="postbody">ah sorry, i should have said i'm using an r4 (slot 1). i have libfat working well with external file data.
<br/>
<br/>
is appended data accessible with slot 1 devices ?
<br/>
<br/>
i searched a bit more, but i think i'm out of my depth. i'm only about two weeks into NDS homebrew and i'm just finding out what is and isn't immediately possible.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145565 - Lazy1 - Sun Nov 18, 2007 5:10 am</h4>
    <div class="postbody"><span class="postbody">Maybe fcsr could be modified to work with images appended to the arm9 binary?
<br/>
The main problem is that now is that quite a bit of your ram is locked into holding a filesystem.
<br/>
<br/>
Why not just read from disc?
<br/>
<br/>
Edit #4:
<br/>
You can just include files directly into your app by renaming them to have a .bin extension and dropping them in your arm9/data folder.
<br/>
<br/>
You can access the files like this: (NOTE: From memory, please correct if wrong)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
extern u8 yourfilename_start[ ];
<br/>
extern int yourfilename_size;
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145567 - tepples - Sun Nov 18, 2007 5:15 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pettsu wrote:</b></span></td> </tr> <tr> <td class="quote">is appended data accessible with slot 1 devices ?</td> </tr></table><span class="postbody">
<br/>
It is if you use fopen() to open the .nds file.
<br/>
<br/>
But this introduces a new problem: How do you find the path of the .nds file that is running? Until flash card menus add support for devkitARM R21's new argv[], the easiest way to do this is probably <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=13195" target="_blank">EFS</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145573 - pettsu - Sun Nov 18, 2007 6:35 am</h4>
    <div class="postbody"><span class="postbody">i read the "Filesystem idea" thread and it told me a lot of the issues about this.
<br/>
<br/>
Lazy1, anything arm9/data/.bin will exist in RAM, i think, which i'll end up doing for small files but eventually i'll have files totalling more than 4MB. (i learnt to access it via #include "file.h", with filename_bin and filename_bin_size being the data address and size)
<br/>
<br/>
reading from disc isn't really a problem, i just wanted to know if there were any alternatives.
<br/>
<br/>
tepples, thank you. i didn't think to actually open the nds file and just assumed it's contents were already accessible. it's all making more sense to me now though.
<br/>
<br/>
thanks to all</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
