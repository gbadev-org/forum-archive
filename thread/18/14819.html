<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Question about multiple .h/.cpp files - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Question about multiple .h/.cpp files</h2>
<div id="posts">
<div class="post">
    <h4>#148779 - Jeremysr - Thu Jan 10, 2008 6:18 am</h4>
    <div class="postbody"><span class="postbody">In the past with my DS homebrew projects that use multiple files and header files, I always had a main.h file that all my .c files included, and the main.h file had a whole bunch of defines and includes. I now realize that it's probably better to seperate all my .cpp files so they work without depending on a giant main.h file.
<br/>
<br/>
My problem is that I can't figure out how to make all my files "share" global variables. With my previous DS homebrew projects I just put something like "int x;" in a header file and all my files could access that variable (I actually had one .h file for each .c file, but it would just include main.h, have some function prototypes, and define global variables.) When I try to put "int x;" in a header file now, though, it gives me an error, saying:
<br/>
<br/>
asdf.o:/home/.../source/asdf.cpp:20: multiple definition of `x'
<br/>
main.o:/home/.../source/main.cpp:5: first defined here
<br/>
<br/>
main.cpp includes asdf.h and asdf.cpp includes asdf.h also. And I do have the "#ifndef _asdf_h #define _asdf_h ... #endif" code surrounding my header files.
<br/>
<br/>
Anyone know what I'm doing wrong? (Or should I post code?)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148780 - eKid - Thu Jan 10, 2008 6:23 am</h4>
    <div class="postbody"><span class="postbody">you shouldn't have any actual variable definitions in header files, what i would do is define the 'int x;' in whatever source file is most relevant to it, then in the 'main.h' that everything includes i would add '<span style="font-weight: bold">extern</span> int x;', which lets you access that <span style="font-style: italic">external</span> variable in other source files.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148781 - zeruda - Thu Jan 10, 2008 6:30 am</h4>
    <div class="postbody"><span class="postbody">Just a note, when you do int x; what you are doing is not only naming a variable, but also allocating memory for that variable. Hence putting variable declarations in header files is a no no.
<br/>
<br/>
So as said in the header file just put extern int x; This names the variable but doesn't allocate memory. Then in any one .c file that includes that header put the int x; declaration. At this point memory is allocated and also all .c files that can see the header file will also see that extern int x; and will thus have access to it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148782 - Jeremysr - Thu Jan 10, 2008 6:35 am</h4>
    <div class="postbody"><span class="postbody">Alright thanks for the quick replies. :D I got it working with extern.
<br/>
<br/>
(BTW I don't use the main.h anymore, I was just explaining what I used to use in the first paragraph... but it doesn't matter)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
