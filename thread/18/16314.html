<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>More Windows on DS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > More Windows on DS</h2>
<div id="posts">
<div class="post">
    <h4>#165608 - MaesterRowen - Mon Dec 29, 2008 10:42 pm</h4>
    <div class="postbody"><span class="postbody">I am having some trouble, that maybe someone here can help clarify for me.
<br/>
<br/>
Using Window 0, Bits 0 - 5 control each item that can be included in window0
<br/>
<br/>
Using Window 1, Bits 8-13 control each item that can be included in window1
<br/>
<br/>
Now to include everything in window 0, I create the define WIN0_ALL 0x3F
<br/>
<br/>
My experience tells me to include everything in window 1, without affecting window 0 would be to create the define WIN1_ALL 0x3F &lt;&lt; 8
<br/>
<br/>
However, it only works when I create the define WIN1_ALL 0x3FFF.  Now to me, it seems like that would affect any information in WIN0.
<br/>
<br/>
Here is a snippet of my code to see if its something in there that might be problematic:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define WIN0_BG0 BIT(0)
<br/>
#define WIN0_BG1 BIT(1)
<br/>
#define WIN0_BG2 BIT(2)
<br/>
#define WIN0_BG3 BIT(3)
<br/>
#define WIN0_OBJ BIT(4)
<br/>
#define WIN0_GFX BIT(5)
<br/>
#define WIN0_ALL 0x3F
<br/>
<br/>
#define WIN1_BG0 BIT(8)
<br/>
#define WIN1_BG1 BIT(9)
<br/>
#define WIN1_BG2 BIT(10)
<br/>
#define WIN1_BG3 BIT(11)
<br/>
#define WIN1_OBJ BIT(12)
<br/>
#define WIN1_GFX BIT(13)
<br/>
#define WIN1_ALL 0x3F &lt;&lt; 8
<br/>
<br/>
(code inside my init function below)
<br/>
<br/>
   videoSetMode(MODE_5_2D | DISPLAY_BG3_ACTIVE | DISPLAY_WIN1_ON);
<br/>
<br/>
   WIN1_X0 = 64;
<br/>
   WIN1_X1 = 128;
<br/>
   WIN1_Y0 = 64;
<br/>
   WIN1_Y1 = 128;
<br/>
   
<br/>
   WIN_IN = WIN1_ALL ^ WIN1_GFX;
<br/>
   WIN_OUT = WIN1_ALL;
<br/>
   
<br/>
   BLEND_CR = BLEND_SRC_BG3 | BLEND_FADE_BLACK;
<br/>
   BLEND_Y = 12;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Now the Idea is to have my Background be faded with Window 1 showing a rectangular non-faded portion of the background.
<br/>
<br/>
When I change all of my WIN1's to WIN0 it works fine.  Any help would be awesome!
<br/>
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165609 - dovoto - Mon Dec 29, 2008 10:54 pm</h4>
    <div class="postbody"><span class="postbody">Your way:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define WIN1_ALL 0x3F &lt;&lt; 8 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
BAD!!!!!!!!
<br/>
<br/>
<br/>
My way:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define WIN1_ALL (0x3F &lt;&lt; 8) 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
GOOD!!!!!
<br/>
<br/>
Your way:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
WIN_IN = WIN1_ALL ^ WIN1_GFX; 
<br/>
<br/>
//aka
<br/>
WIN_IN = 0x3F &lt;&lt; 8 ^ BIT(13);
<br/>
<br/>
//aka
<br/>
WIN_IN = 0x3F &lt;&lt; (8200);  //probably not going to work
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
BAD!!!!<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165610 - MaesterRowen - Mon Dec 29, 2008 10:55 pm</h4>
    <div class="postbody"><span class="postbody">Nice, gotchya.
<br/>
<br/>
Let me try it out.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165611 - MaesterRowen - Mon Dec 29, 2008 11:00 pm</h4>
    <div class="postbody"><span class="postbody">Actually, that was a good catch and definitely problematic.
<br/>
<br/>
But it seems, after looking closely at the TONC guide for the bit layout of the WIN_IN and WIN_OUT I noticed it says that the upper bits for WIN_OUT are for WIN_OBJ.
<br/>
<br/>
<br/>
I ended up making this change:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
WIN_IN = WIN1_ALL ^ WIN1_GFX; 
<br/>
WIN_OUT = 0x3F;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Combined with your fix, and this change, it works now under Window 1.
<br/>
<br/>
Now to figure out how to get sprites to work as a window mask.  &gt;&lt;.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
