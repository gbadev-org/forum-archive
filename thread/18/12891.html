<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Playing/Debugging DLDI games on emulator - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Playing/Debugging DLDI games on emulator</h2>
<div id="posts">
<div class="post">
    <h4>#124019 - Lupi - Mon Apr 02, 2007 2:39 pm</h4>
    <div class="postbody"><span class="postbody">Well, I'm trying to get some screens and videos with no$gba in Windows XP of NeoFlash Games. The problem is that some of the games require DLDI and they won't work on emulator.
<br/>
<br/>
I have found this:
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=12654%3C/blockquote%3E%3C/div%3E" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12654%3C/blockquote%3E%3C/div%3E</a>
<br/>
<br/>
But I can't get it to work. Any ideas?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124022 - Diddl - Mon Apr 02, 2007 3:21 pm</h4>
    <div class="postbody"><span class="postbody">problem is that this solution does only append alle files on poor NDS file and make it bigger and bigger.
<br/>
<br/>
memory on  a NDS is only 4MB and if NDS file has 1 the sum of all files may not increase 3 MB (in case of 3MB there would be no working RAM for application!)
<br/>
<br/>
-----
<br/>
<br/>
the only way would be, if a creator of the emul would support pluggable Slot 1 support. like vice makes this for C64 cartridges. within emu application should be a menu "mount slot 1" and you give a directory  of your harddisk or a whole drive as parameter. or maybe only a big file (FAT image).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124023 - GPFerror - Mon Apr 02, 2007 3:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupi wrote:</b></span></td> </tr> <tr> <td class="quote">Well, I'm trying to get some screens and videos with no$gba in Windows XP of NeoFlash Games. The problem is that some of the games require DLDI and they won't work on emulator.
<br/>
<br/>
I have found this:
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=12654%3C/blockquote%3E%3C/div%3E" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12654%3C/blockquote%3E%3C/div%3E</a>
<br/>
<br/>
But I can't get it to work. Any ideas?</td> </tr></table><span class="postbody">
<br/>
<br/>
Whats not working?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124025 - Lupi - Mon Apr 02, 2007 3:47 pm</h4>
    <div class="postbody"><span class="postbody">I get the .ds.gba (or .sc.nds)
<br/>
<br/>
Then I downloaded the dldi that they talk about in that post
<br/>
This one:
<br/>
<a href="http://gpf.dcemu.co.uk/files/pc/fcsrDLDI.zip" target="_blank">http://gpf.dcemu.co.uk/files/pc/fcsrDLDI.zip</a>
<br/>
<br/>
I use DLDItool GUI for windows that detects that dldi, I select it (FlashCartSRam), then load the .ds.gba and click on Patch.
<br/>
<br/>
Once it has finished, I load the .ds.gba in no$gba but it fails libfat inicialization.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124027 - Quirky - Mon Apr 02, 2007 4:32 pm</h4>
    <div class="postbody"><span class="postbody">Desmume has some limited flash support, but not with a patched .nds file. At least IME the emulator doesn't load files when the .nds has been patched for the ez-flash 5.
<br/>
<br/>
Perhaps try a different patch, or use the default (unpatched) ROM file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124033 - GPFerror - Mon Apr 02, 2007 5:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupi wrote:</b></span></td> </tr> <tr> <td class="quote">I get the .ds.gba (or .sc.nds)
<br/>
<br/>
Then I downloaded the dldi that they talk about in that post
<br/>
This one:
<br/>
<a href="http://gpf.dcemu.co.uk/files/pc/fcsrDLDI.zip" target="_blank">http://gpf.dcemu.co.uk/files/pc/fcsrDLDI.zip</a>
<br/>
<br/>
I use DLDItool GUI for windows that detects that dldi, I select it (FlashCartSRam), then load the .ds.gba and click on Patch.
<br/>
<br/>
Once it has finished, I load the .ds.gba in no$gba but it fails libfat inicialization.</td> </tr></table><span class="postbody">
<br/>
<br/>
make sure and padbin 512 the ds.gba file before appending the fcsr image to it, and then dldi patch
<br/>
<br/>
FCSR images work in desmume, no$gba and ideas and should work on hardware for some cards as well.
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124039 - Lupi - Mon Apr 02, 2007 6:07 pm</h4>
    <div class="postbody"><span class="postbody">Ok, What I do, for example, with Warcraft Tower Defense, I make an image of the maps folder:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">build.bat maps.img maps</td> </tr></table><span class="postbody">
<br/>
<br/>
Then I padbin the .ds.gba
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">padbin 512 TowerDefense.ds.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
Next, I add the image to the end of the original rom
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">cat TowerDefense.ds.gba maps.img &gt; TD.sd.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
And lastly, I patch woth DLDI
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">dlditool.exe fcsr.dldi TD.ds.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
<span style="font-weight: bold">WHAT I GET:</span>
<br/>
The Fat starts correctly, but it say the folder maps can't be found</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124063 - GPFerror - Mon Apr 02, 2007 11:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupi wrote:</b></span></td> </tr> <tr> <td class="quote">Ok, What I do, for example, with Warcraft Tower Defense, I make an image of the maps folder:
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">build.bat maps.img maps</td> </tr></table><span class="postbody">
<br/>
<br/>
Then I padbin the .ds.gba
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">padbin 512 TowerDefense.ds.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
Next, I add the image to the end of the original rom
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">cat TowerDefense.ds.gba maps.img &gt; TD.sd.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
And lastly, I patch woth DLDI
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">dlditool.exe fcsr.dldi TD.ds.gba</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
<span style="font-weight: bold">WHAT I GET:</span>
<br/>
The Fat starts correctly, but it say the folder maps can't be found</span></td> </tr></table><span class="postbody">
<br/>
<br/>
put the maps folder under a another directory.
<br/>
<br/>
fcsrdir/map
<br/>
<br/>
build.bat maps.img fcsrdir
<br/>
<br/>
so that the map directory is included in the image, otherwise it will only contains stuff under the map directory.
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124066 - sirpoonga - Mon Apr 02, 2007 11:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>GPFerror wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupi wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">build.bat maps.img maps</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
put the maps folder under a another directory.
<br/>
<br/>
fcsrdir/map
<br/>
<br/>
build.bat maps.img fcsrdir
<br/>
<br/>
so that the map directory is included in the image, otherwise it will only contains stuff under the map directory.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
In case that is confusing I will reword it.  The parameter you send in to build.bat is the root folder.  So if i have c:\files and do a build.bat maps.img c:\files, the contents of c:\files become the root folder for the gba program.
<br/>
In fact, my current c:\files looks like
<br/>
c:\files\settings.maz
<br/>
c:\files\mazes\testmaze.txt
<br/>
So after building the image the settings.maz is in the root (/) folder of the fscr image.
<br/>
<br/>
So with your command you aren't adding the maps folder to the image, you are making the maps folder the root folder of the image.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124130 - Lupi - Tue Apr 03, 2007 11:28 am</h4>
    <div class="postbody"><span class="postbody">Hmm, it seems the build.bat is not working correctly
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Builds a FAT disk image from a given directory.
<br/>
64
<br/>
Creating image
<br/>
creating FAT12 image size = 0.01 MB's
<br/>
<br/>
<br/>
Working[]DoneInjectFile("C:\files\duke3d\DEFS.CON") [b]failed[/b]
<br/>
Blessing image
<br/>
OK - start1:0 size1:0
<br/>
"FAT12 image built as DATA.img from /C:\files"</td> </tr></table><span class="postbody">
<br/>
<br/>
The file is in there, and I'm setting C:\files as the "root" I will add later. Why does it fail?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124146 - GPFerror - Tue Apr 03, 2007 3:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lupi wrote:</b></span></td> </tr> <tr> <td class="quote">Hmm, it seems the build.bat is not working correctly
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Builds a FAT disk image from a given directory.
<br/>
64
<br/>
Creating image
<br/>
creating FAT12 image size = 0.01 MB's
<br/>
<br/>
<br/>
Working[]DoneInjectFile("C:\files\duke3d\DEFS.CON") [b]failed[/b]
<br/>
Blessing image
<br/>
OK - start1:0 size1:0
<br/>
"FAT12 image built as DATA.img from /C:\files"</td> </tr></table><span class="postbody">
<br/>
<br/>
The file is in there, and I'm setting C:\files as the "root" I will add later. Why does it fail?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
It seems i miscalculated the smallest file size that mkdosfs.exe would take, edit the build.bat line
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if /I %size% LSS 10000  (                      set /A size="10000" )</td> </tr></table><span class="postbody">
<br/>
<br/>
change to
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if /I %size% LSS 300000  (                      set /A size="300000" )</td> </tr></table><span class="postbody">
<br/>
<br/>
Also based on your example above you forgot to put your duke3d.grp file in the directory otherwise it would have been large enough to build the FAT12 file :)
<br/>
<br/>
Troy(GPF)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124152 - Lupi - Tue Apr 03, 2007 5:14 pm</h4>
    <div class="postbody"><span class="postbody">Nothing, I even tried with 11000000 so it can have like 10 MB of data (the duke3d.grp is that big), padbin, then cat, last dldi and I a extrange advice telling me the CON files weren't found or something, asking me if I wanted to create them, but the execution stops...
<br/>
<br/>
I give up, I will just record my DS screen with a webcam to make the videos, thanks anyway :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124179 - tyraen - Tue Apr 03, 2007 9:56 pm</h4>
    <div class="postbody"><span class="postbody">I'm getting the same error, after changing references to 10000 to 300000.  I'm trying to get DSO to run on my comp so I can test out my plugin, although this way would still be a little annoying.  I guess it might be ok to set up a script to it all... isn't there an emu that emulates file structures differently? (goes looking)
<br/>
<br/>
UPDATE: Actually, I tried adding my plugin, now the directory structure is like this:
<br/>
temp\
<br/>
temp\DSOrganize
<br/>
temp\DSOrganize\RESOURCES
<br/>
temp\DSOrganize\RESOURCES\resource0.bin
<br/>
temp\DSOrganize\PLUGINS\dsoBib.dsp
<br/>
temp\bib\kjv.bib
<br/>
<br/>
Anyways, when I enter the browser of DSO, the directory structure looks like this:
<br/>
\bib
<br/>
\bib\kjv.bib
<br/>
\DSOrganize
<br/>
\DSOrganize\resource0.bin
<br/>
<br/>
I'm building this in Windows, maybe that's the problem *sigh*
<br/>
<br/>
UPDATE2: Also, I don't get that error anymore.  When I remove the bib directory, the error returns.  The file the error says  it has a problem with is the resource0.bin file.  Strange...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124272 - sirpoonga - Wed Apr 04, 2007 7:22 pm</h4>
    <div class="postbody"><span class="postbody">Does fat12 have naming restrictions?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124279 - tepples - Wed Apr 04, 2007 9:08 pm</h4>
    <div class="postbody"><span class="postbody">The only difference among FAT12, FAT16, and FAT32 is the number of clusters on the disk (&lt;4000, 4100-65500, or 65600+). File and folder name restrictions don't depend on the number of clusters on the disk. They depend only on whether the operating system vendor has licensed the VFAT patents from Microsoft (in jurisdictions that grant patents on algorithms).<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124320 - HyperHacker - Thu Apr 05, 2007 2:27 am</h4>
    <div class="postbody"><span class="postbody">Isn't FAT16 (and I would imagine FAT12) limited to 255 file entries in the root directory? (And since long file names use multiple entries, that can be less than 255 files.) I found that with my MP3 player, formatted as FAT32 I could fill it right up (and it was faster too :D).<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124332 - tepples - Thu Apr 05, 2007 3:56 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">Isn't FAT16 (and I would imagine FAT12) limited to 255 file entries in the root directory?</td> </tr></table><span class="postbody">
<br/>
What root directory? I thought homebrew programs were supposed to store their Application Data in the /data folder.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124479 - HyperHacker - Fri Apr 06, 2007 6:16 am</h4>
    <div class="postbody"><span class="postbody">I'm just saying there are some restrictions in FAT16 that aren't there in FAT32. At least, that's what I was told, and it seemed to be true in my case.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124727 - dantheman - Sun Apr 08, 2007 12:25 am</h4>
    <div class="postbody"><span class="postbody">If it helps at all, I've found that adding a few random files to the new "root" of the image makes it work correctly if the homebrew you are using relies on only a specific folder being present.  For instance, if I'm using SNEmulDS and simply put my "SNES" folder in the folder specified in build.bat, it will fail.  If I add a few files so that the root directory has file1.abc and file2.abc and the "SNES" directory, it works.  
<br/>
<br/>
To help clarify, if I have this directory structure:
<br/>
<br/>
fcsrimage
<br/>
--fcsr
<br/>
----snes
<br/>
------game1.smc
<br/>
------game2.smc
<br/>
--build.bat
<br/>
--other building files
<br/>
<br/>
And type 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">build.bat image.img fcsr</td> </tr></table><span class="postbody">
<br/>
and continue the rest of the process for creating a DLDI patched file, it fails.  
<br/>
<br/>
If I have this directory structure:
<br/>
<br/>
fcsrimage
<br/>
--fcsr
<br/>
----snes
<br/>
------game1.smc
<br/>
------game2.smc
<br/>
----random1.file
<br/>
----random2.file
<br/>
--build.bat
<br/>
--other building files
<br/>
<br/>
And type the same command, SNEmulDS recognizes the filesystem and shows the list of games.
<br/>
<br/>
Granted, this is using an older version of SNEmulDS that doesn't require the snemul.cfg file to be in the root directory.  I'm guessing that the newer versions would work fine as a result, but I have not tested it.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
