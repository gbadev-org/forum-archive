<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ds tilemapper problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > ds tilemapper problem</h2>
<div id="posts">
<div class="post">
    <h4>#64800 - ninogenio - Mon Dec 26, 2005 10:26 pm</h4>
    <div class="postbody"><span class="postbody">heres some code ive been messing with now ive almost got it working but the tiles get ever so slightly scrambled i know its something pretty silly but i just cant see it if anyone could point out what wrong with the code then majore thanks.
<br/>
<br/>
the pic im using is just the 256 drunken loggo pic that comes with ndslib.
<br/>
<br/>
also is it possible to map 16bit tiles?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;nds.h&gt;
<br/>
#include "drunkenlogo_bin.h"
<br/>
#include "palette_bin.h"
<br/>
<br/>
void drawMap(u16*);
<br/>
<br/>
int main(int argc, char** argv) 
<br/>
{
<br/>
             const int char_base = 0;
<br/>
             const int screen_base = 20;
<br/>
<br/>
             POWER_CR = POWER_ALL_2D;
<br/>
 
<br/>
             vramSetBankA(VRAM_A_MAIN_BG);
<br/>
             vramSetBankC(VRAM_C_SUB_BG);
<br/>
 
<br/>
             DISPLAY_CR = MODE_0_2D | DISPLAY_BG0_ACTIVE;
<br/>
             BG0_CR = TEXTBG_SIZE_256x256 | BG_COLOR_256 | BG_TILE_BASE(char_base) | BG_MAP_BASE(screen_base);
<br/>
<br/>
             u16* tile = (u16*)CHAR_BASE_BLOCK(char_base);
<br/>
             u16* map = (u16*)SCREEN_BASE_BLOCK(screen_base);
<br/>
             
<br/>
             for (int y=0; y&lt;256*256 ; y++)
<br/>
             {
<br/>
                           tile[y] = ((u16*)drunkenlogo_bin)[y];
<br/>
             }
<br/>
<br/>
             for(int i = 0; i &lt; 256; ++i) 
<br/>
             {
<br/>
                       BG_PALETTE[i] = ((u16*)palette_bin)[i];
<br/>
             }
<br/>
             drawMap(map);
<br/>
      
<br/>
        while(1)
<br/>
        {
<br/>
             swiWaitForVBlank();
<br/>
        }
<br/>
        return 0;
<br/>
}
<br/>
<br/>
  
<br/>
void drawMap(u16* map)
<br/>
{
<br/>
           for(int i = 0; i &lt; 31*23;++i) 
<br/>
           {
<br/>
                   map[i] = (u16)i;
<br/>
           }
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
