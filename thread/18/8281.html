<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>PC replacement for libnds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > PC replacement for libnds</h2>
<div id="posts">
<div class="post">
    <h4>#68643 - NoLongerRegistered - Thu Jan 26, 2006 5:53 am</h4>
    <div class="postbody"><span class="postbody">I was wondering if anyone wants a lib that is similar to libnds for the PC (as in linux, windows and mac). This way we can test code nativly on the PC and debug it easier. Not exactly a perfect replacement but i think it is nice to be able to play your DS games on PC or at least test it out.
<br/>
<br/>
I have some code that doesnt work too well but does the job for a tiled bg and rgb16 sprites. Is anyone interested helping in writing a full replacement?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68644 - Normmatt - Thu Jan 26, 2006 6:04 am</h4>
    <div class="postbody"><span class="postbody">thats what an emulator is for. and there are about 4 emulators atm: iDeaS, DeSmuME, DSEmu, DSEmu-ng and Dualis.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68661 - doublec - Thu Jan 26, 2006 8:54 am</h4>
    <div class="postbody"><span class="postbody">Why not work on one of the emulators and help get that up to a level that it can emulate everything libnds does?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68695 - NoLongerRegistered - Thu Jan 26, 2006 12:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doublec wrote:</b></span></td> </tr> <tr> <td class="quote">Why not work on one of the emulators and help get that up to a level that it can emulate everything libnds does?</td> </tr></table><span class="postbody">
<br/>
<br/>
I'll be happy to help out some emulator authors. The point is so we can run and test nativily and use breakpoints to step through source or PC only memory managers. You cant do that though an emulator also the game would run much faster.
<br/>
<br/>
I take it that no one is interested?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68698 - acox - Thu Jan 26, 2006 12:25 pm</h4>
    <div class="postbody"><span class="postbody">I think it is a good idea.
<br/>
<br/>
But I would go one level lower. Either:
<br/>
<br/>
1) Write a HPL (Hardware Presentation Layer) that simply wraps registers in inline function calls. Relayer ndslib on top of this. Implement it for pc.
<br/>
<br/>
2) (bit hazy on this one) Virtualisaion. Use page falts to trap access to DS registers on PC and have handlers implement whatever functionality was 
<br/>
supposed to be behind the regs. Or mod the binary so loads and stores go through a filter that looks for special addresses.
<br/>
<br/>
Then you can debug the ndslib code and through the ndslib code as well as your app's. Factors out the question 'is this bug in my app or my PC ndslib?'.
<br/>
<br/>
Some details to do with DMA and peripherals accessing memory to think about.<br/>_________________<br/><a class="postlink" href="http://www.btinternet.com/~ahcox/GBA/" target="_blank">3D on GBA</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68734 - wintermute - Thu Jan 26, 2006 4:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>StealthEntity wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>doublec wrote:</b></span></td> </tr> <tr> <td class="quote">Why not work on one of the emulators and help get that up to a level that it can emulate everything libnds does?</td> </tr></table><span class="postbody">
<br/>
<br/>
I'll be happy to help out some emulator authors. The point is so we can run and test nativily and use breakpoints to step through source or PC only memory managers. You cant do that though an emulator also the game would run much faster.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Speed of emulation isn't so much of an issue when single stepping and if an emulator implemented a gdb server then source level debugging of DS native  apps could be a reality. See Visualboy Advance
<br/>
<br/>
<a href="http://www.devkitpro.org/debugging-with-vba-and-insight.shtml" target="_blank">http://www.devkitpro.org/debugging-with-vba-and-insight.shtml</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68748 - HyperHacker - Thu Jan 26, 2006 6:02 pm</h4>
    <div class="postbody"><span class="postbody">I suppose you could implement an NDS subsystem, but it would basically just be an emulator built into Windows. Also, while you could probably create a version of PALib for PC, low-level things like direct memory accessing (many homebrew games do things like <span style="font-style: italic">((vuint16*)0x04001234) = 0x69</span> or some such) would need to be modified anyway. (Perhaps the writes could just be trapped, but it would probably be quite slow.)
<br/>
<br/>
The main issue is that DS is ARM7/ARM9, so no matter how it's implemented, emulation would still be required. Unless your PC happens to contain both of these.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68979 - dovoto - Fri Jan 27, 2006 7:34 pm</h4>
    <div class="postbody"><span class="postbody">LIBNDS is not currently abstracted to the point of making a realistic win API wrapper for it...
<br/>
<br/>
Although some functionality in libnds is high level (the 3D lib, some vram managment, some basic print functionality, and some simple IO for instance) much of the video hardware still must be controlled via direct hardware interaction through registers.
<br/>
<br/>
Allthough, since all registers are defined or enumerated it would be possible to create windows based headers for all of these that map writes to another area and then renders video based on the this (this would nearly be a full NDS 2D video hardware emulator).  This would be a pain to implement and even more a pain to maintain though.
<br/>
<br/>
The 3D layer is probably wrapable right now although there are still significant enough differences between openGL and the DS hardware that it would be difficult to use the wrapper for 3D engine development.
<br/>
<br/>
Building your own abstraction layer on top of libnds would be the best way to go.  This could be nothing more than wrappers for register writes and a bit higher level access to backgrounds and sprites and other video hardware...or it could be at a much higher level which is where a wrapper becomes most usefull.
<br/>
<br/>
 Libnds is intended for low level access to hardware and is ment mainly as a base for people to derive full libraries from (such as PALIB).  If interest is high enough (and other libs such as PALIB are not satisfying the interest for higher level access) I will look into developing a higher level api that is seperate from (but sits on top of) libnds.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
