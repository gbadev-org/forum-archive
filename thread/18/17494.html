<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>removing sections - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > removing sections</h2>
<div id="posts">
<div class="post">
    <h4>#176002 - Samu - Thu Mar 17, 2011 12:27 am</h4>
    <div class="postbody"><span class="postbody">hello
<br/>
<br/>
I was wondering if its possible to delete part of a tiled background at runtime, or at least simulate it. Its hard to explain what i mean so ill attach a picture showing what i mean.
<br/>
<br/>
<a href="http://img810.imageshack.us/img810/9553/68974481.gif">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
is it possible to do this, remove part of a tiled background, leaving the background behind it visible?
<br/>
<br/>
thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176003 - Dwedit - Thu Mar 17, 2011 7:05 am</h4>
    <div class="postbody"><span class="postbody">Normally, you do this by using more tiles.  So you have your original tile, and you need a section cut out of it.  Just copy it to another tile, change the map ram to indicate that you are using a different tile, and do your drawing on the new tile.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176004 - Ruben - Thu Mar 17, 2011 7:48 am</h4>
    <div class="postbody"><span class="postbody">Building on what Dwedit said:
<br/>
You could probably build a VRAM managing system to make this easier.
<br/>
Something like...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//! Number of internal structures
<br/>
#define VRAM_ALLOC 8
<br/>
<br/>
//! Allocation structure type
<br/>
typedef struct {
<br/>
        void *base;
<br/>
        void *next;
<br/>
} vid_Alloc_t;
<br/>
<br/>
//! Internal structure
<br/>
static vid_Alloc_t vid_iVRAMAlloc[VRAM_ALLOC];
<br/>
<br/>
//! Get new 'section' (or increase length)
<br/>
void *vid_VRAMNew(u32 len, vid_Alloc_t *sect) {
<br/>
        if(!sect) {
<br/>
                //! Create new section
<br/>
                int i;
<br/>
                for(i=0;i&lt;8;i++) {
<br/>
                        if(!vid_iVRAMAlloc[i].base) {
<br/>
                                //! Each 'section' has 10000/x bytes of RAM
<br/>
                                void *base = (void*)(0x06000000 + i*(0x10000/VRAM_ALLOC));
<br/>
                                
<br/>
                                //! Set base+end
<br/>
                                vid_iVRAMAlloc.base = base;
<br/>
                                vid_iVRAMAlloc.next = base + len;
<br/>
                                
<br/>
                                //! Return base
<br/>
                                return base;
<br/>
                        }
<br/>
                } return 0;
<br/>
        } else {
<br/>
                //! Resize section and return new base
<br/>
                void *old = sect-&gt;next; sect-&gt;next += len;
<br/>
                return old;
<br/>
        }
<br/>
}
<br/>
<br/>
//! Delete 'section'
<br/>
void vid_VRAMDel(vid_Alloc_t *sect) {
<br/>
        sect-&gt;base = 0;
<br/>
        sect-&gt;next = 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
EDIT:
<br/>
You could probably get rid of the 'base' member if you don't need to know the beginning address for the current section.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176011 - sverx - Fri Mar 18, 2011 1:09 pm</h4>
    <div class="postbody"><span class="postbody">if the part you want to remove isn't convex you could try windowing and HDMA...
<br/>
<br/>
... or object windows.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176013 - headspin - Fri Mar 18, 2011 1:19 pm</h4>
    <div class="postbody"><span class="postbody">If you don't have repeating tiles you can also edit the tile data directly.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
