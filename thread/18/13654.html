<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Licks Locator() - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Licks Locator()</h2>
<div id="posts">
<div class="post">
    <h4>#134314 - Lick - Thu Jul 12, 2007 1:13 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Download</span>
<br/>
Demo: <a class="postlink" href="http://lickr.org/files/LicksLocator.zip" target="_blank">http://lickr.org/files/LicksLocator.zip</a> (Demo searches for "DSLiveWeather" <b style="color:#FFA34F">directory</b>. Maximum depth is 3: /&lt;1&gt;/&lt;2&gt;/DSLiveWeather. Includes a timer.)
<br/>
C file: <a class="postlink" href="http://lickr.org/files/LicksLocator.c" target="_blank">http://lickr.org/files/LicksLocator.c</a>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=134465#134465" target="_blank">Scrolldown for <span style="font-weight: bold">melw's modified &amp; better version</span></a>
<br/>
<br/>
<span style="font-weight: bold">Description</span>
<br/>
It's simply a C function that searches for a <b style="color:#FFA34F">directory</b> or a file inside a certain start-<b style="color:#FFA34F">directory</b> and within a certain depth. Only <span style="font-style: italic">1 result</span> is returned, but that's enough for many purposes.
<br/>
<br/>
<span style="font-weight: bold">Performance</span>
<br/>
It's fast enough, as long as you don't have thousands of directories in the depth range. The demo includes a timer, so see for yourself.
<br/>
<br/>
<span style="font-weight: bold">Usage</span> </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Locator(StartDirectory, SearchString, IsADirectory, Depth, OutputBuffer);</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">Example</span>
<br/>
This example will search for the DSLiveWeather <b style="color:#FFA34F">directory</b> within 3 depth levels starting from the root. It will find one of these:
<br/>
- DSLiveWeather
<br/>
- /&lt;1&gt;/DSLiveWeather
<br/>
- /&lt;1&gt;/&lt;2&gt;/DSLiveWeather </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Locator("/", "DSLiveWeather", true, 3, path);</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"><br/><br/>Last edited by Lick on Fri Jul 13, 2007 9:42 am; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#134318 - Lick - Thu Jul 12, 2007 1:19 pm</h4>
    <div class="postbody"><span class="postbody">Oh by the way, this will be in DSLiveWeather the next release. For all you "/data/&lt;app&gt;" freaks! ;)<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134320 - felix123 - Thu Jul 12, 2007 1:37 pm</h4>
    <div class="postbody"><span class="postbody">Thank you!<br/>_________________<br/><a class="postlink" href="http://en.wikipedia.org/wiki/NDSh" target="_blank">Nintendo DS homebrew on Wikipedia</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134321 - spinal_cord - Thu Jul 12, 2007 1:40 pm</h4>
    <div class="postbody"><span class="postbody">So this means that we will no longer need to put our files in a specific place? cool.<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134327 - OOPMan - Thu Jul 12, 2007 2:06 pm</h4>
    <div class="postbody"><span class="postbody">Only if people start using it. Still, it's simple enough and a maximum depth of 3 will probably for enough for most apps and freaks who pack their devices full of stuff...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134348 - tondopie - Thu Jul 12, 2007 5:11 pm</h4>
    <div class="postbody"><span class="postbody">this sounds like a nice idea. Hopefully more people will use it and we can avoid cluttering up the root.<br/>_________________<br/><span style="font-weight: bold">Development Blog:</span> <a class="postlink" href="http://teendev.org" target="_blank">http://teendev.org</a>
<br/>
<span style="font-weight: bold">Homebrew Podcast:</span> <a class="postlink" href="http://homebrewcast.net" target="_blank">http://homebrewcast.net</a>
<br/>
<span style="font-weight: bold">Web Design:</span> <a class="postlink" href="http://xtendesign.net" target="_blank">http://xtendesign.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134378 - Lick - Thu Jul 12, 2007 9:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>spinal_cord wrote:</b></span></td> </tr> <tr> <td class="quote">So this means that we will no longer need to put our files in a specific place? cool.</td> </tr></table><span class="postbody">
<br/>
Well, you still have to put your files within the depth range, but indeed, you get more freedom and flexibility in how you arrange your folders and move them around. 
<br/>
Although, since static naming is important to finding the right folder/file, you can't rename them. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>OOPMan wrote:</b></span></td> </tr> <tr> <td class="quote">Only if people start using it.</td> </tr></table><span class="postbody">
<br/>
Always a problem isn't it..!
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Still, it's simple enough and a maximum depth of 3 will probably for enough for most apps and freaks who pack their devices full of stuff...</td> </tr></table><span class="postbody">
<br/>
The maximum depth of 3 referred to the demo project. In reality the developer can decide how deep the application scans. I recommend 3 or 4 for the depth. I don't think people actually go that deep every time they want to start homebrew, that would take too much time.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134465 - melw - Fri Jul 13, 2007 9:34 am</h4>
    <div class="postbody"><span class="postbody">Cheers! Added this to my own project space for loading external configuration files... I had to make a few changes to get it working, though: using non-case sensitive string comparison and not adding trailing slashes if we're searching for a file, not a <b style="color:#FFA34F">directory</b>.
<br/>
<br/>
Here's a slightly updated/modified version:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">bool fileLocator(char *start, char *target, bool isDir, int depth, char *result)
<br/>
{
<br/>
   struct stat st;
<br/>
   DIR_ITER *dir = diropen(start);
<br/>
   static char child[256];
<br/>
   char temp[256];
<br/>
   
<br/>
   if (dir)
<br/>
   {
<br/>
      while (dirnext(dir, child, &amp;st) == 0)
<br/>
      {
<br/>
         if (strlen(child) == 1 &amp;&amp; child[0] == '.')
<br/>
            continue;
<br/>
                  
<br/>
         if (strlen(child) == 2 &amp;&amp; child[0] == '.' &amp;&amp; child[1] == '.')
<br/>
            continue;
<br/>
         
<br/>
         if (((st.st_mode &amp; S_IFDIR) &amp;&amp; isDir) || (!(st.st_mode &amp; S_IFDIR) &amp;&amp; !isDir) )
<br/>
         {
<br/>
            if (strcasecmp(target, child) == 0) // changed from strcmp to strcasecmp
<br/>
            {
<br/>
               strcpy(result, start);
<br/>
               if (start[strlen(start)-1] != '/')
<br/>
                  strcat(result, "/");
<br/>
<br/>
               strcat(result, child);
<br/>
               if(isDir) // only add trailing slash if we're searching for a <b style="color:#FFA34F">directory</b>
<br/>
                  strcat(result, "/");
<br/>
            
<br/>
               dirclose(dir);
<br/>
               return true;
<br/>
            }
<br/>
         }
<br/>
            
<br/>
         if ((st.st_mode &amp; S_IFDIR) &amp;&amp; depth &gt; 1)
<br/>
         {
<br/>
            strcpy(temp, start);
<br/>
            if (start[strlen(start)-1] != '/')
<br/>
               strcat(temp, "/");
<br/>
<br/>
            strcat(temp, child);
<br/>
            strcat(temp, "/");
<br/>
            
<br/>
            if (fileLocator(temp, target, isDir, depth-1, result))
<br/>
            {
<br/>
               dirclose(dir);
<br/>
               return true;
<br/>
            }
<br/>
         }
<br/>
      }
<br/>
   }
<br/>
   
<br/>
   dirclose(dir);
<br/>
   return false;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134466 - Dwedit - Fri Jul 13, 2007 9:38 am</h4>
    <div class="postbody"><span class="postbody">Is this breadth first or depth first?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134468 - Lick - Fri Jul 13, 2007 9:38 am</h4>
    <div class="postbody"><span class="postbody">Great work! I'll use your version then. ;D
<br/>
<br/>
I believe it's depth first. Code-wise this is the easiest because it doesn't require storing the directories in a list first. It just goes into directories as it finds them. I don't think performance is an issue in any case.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145788 - Dark Knight ez - Thu Nov 22, 2007 3:01 pm</h4>
    <div class="postbody"><span class="postbody">My appologies for resurrecting a dead topic, but I wanted to confirm this small function is indeed license free without any strings attached whatsoever. /being overly careful with other people's code<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145794 - Lick - Thu Nov 22, 2007 4:09 pm</h4>
    <div class="postbody"><span class="postbody">Well yes, my initial version is public domain, provided as-is.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145802 - Rajveer - Thu Nov 22, 2007 6:29 pm</h4>
    <div class="postbody"><span class="postbody">I wanted to thank Lick and Melw for the code but I didn't want to bring up an old topic. I'll take this chance to say thanks guys!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
