<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Divide? Floating point? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Divide? Floating point?</h2>
<div id="posts">
<div class="post">
    <h4>#46691 - LOst? - Wed Jun 29, 2005 4:20 am</h4>
    <div class="postbody"><span class="postbody">Just want to know if you can use divide faster on the DS than the GBA, or if it is the same slow divide?
<br/>
<br/>
Also, how do you manage 3D coordinates? With floating point? Or fixed point?
<br/>
<br/>
What is consolePrintf? Who made it?
<br/>
<br/>
Who made libnds?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46692 - rize - Wed Jun 29, 2005 4:42 am</h4>
    <div class="postbody"><span class="postbody">it's all fixed point, but there is a hardware divide and square root unit
<br/>
<br/>
you load the parameter registers, set the control register, check the "done" bit and retrieve the result when its finished.  there are ndslib functions that use the hardware for divide and sqrt and you can look them up in nds/arm9/math.h to see how they work</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46694 - gladius - Wed Jun 29, 2005 4:42 am</h4>
    <div class="postbody"><span class="postbody">There is a hardware divide unit built into the DS, so they are much faster than on the DS.
<br/>
<br/>
And you should use fixed point for your 3d engine.  Floating point is just too slow without a hardware unit to work with it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46697 - tepples - Wed Jun 29, 2005 5:59 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gladius wrote:</b></span></td> </tr> <tr> <td class="quote">There is a hardware divide unit built into the DS, so they are much faster than on the DS.</td> </tr></table><span class="postbody">
<br/>
But does the runtime library (e.g. __divsi3()) use the divide HW automatically for those combinations of data types where it makes sense?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46702 - LOst? - Wed Jun 29, 2005 6:19 am</h4>
    <div class="postbody"><span class="postbody">Thank you for your kind replies!
<br/>
<br/>
I have finally got my DevkitPro environment up, and i can now run my DS demos on the real hardware for the first time. I am very satisfied!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46710 - rize - Wed Jun 29, 2005 7:31 am</h4>
    <div class="postbody"><span class="postbody">be advised that ( last I checked) dualis doesn't produce accurate results for f32 hardware divide and sqrt.  If you get weird results the emulator may be to blame.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#46751 - crossraleigh - Thu Jun 30, 2005 3:56 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">But does the runtime library (e.g. __divsi3()) use the divide HW automatically for those combinations of data types where it makes sense?</td> </tr></table><span class="postbody">
<br/>
As of a couple weeks ago, both libnds and libgba use SWI calls for division. I thought that libnds would be changed to use hardware, but glancing at the current CVS it doesn't look like it has.
<br/>
<br/>
In response to the OP:
<br/>
<br/>
Like gladius said, the DS doesn't have an FPU; use fixed point. Specifically, divf32() and sqrtf32() give access to the hardware's 20:12 fixed point functions that rize described.
<br/>
<br/>
Joat and dovoto made and maintain ndslib, so I imagine that one of them made consolePrintf. WinterMute integrates their changes into libnds since apparently Joat won't agree to move ndslib to the devkitPro repository.<br/>_________________<br/>My world is black and white, but if I blink fast enough, I see it in grayscale.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
