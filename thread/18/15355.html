<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>No Microphone Input Example?(libnds) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > No Microphone Input Example?(libnds)</h2>
<div id="posts">
<div class="post">
    <h4>#154118 - PlagueSpark - Fri Apr 11, 2008 3:31 pm</h4>
    <div class="postbody"><span class="postbody">I'm using libnds +VC2005 Express
<br/>
<br/>
As docs/manuals are printed - microphone is managed by arm7 (unacssasable by arm9) even found that function in arm7
<br/>
<br/>
I know that palib gives acess to function that returns the unsigned short int value of microphone input.
<br/>
<br/>
So topic is: Is there any code samples(/project templates) that shows how to handle microphone input by just libnds???</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154125 - silent_code - Fri Apr 11, 2008 7:18 pm</h4>
    <div class="postbody"><span class="postbody">hi!
<br/>
<br/>
i can't remember if there's an example that comes with libnds, but i remember that there was one on chris double's (?) page.
<br/>
also, i don't know if this helps or not, but you can always check <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#dssoundcapture" target="_blank">gbatek</a> for accurate information!
<br/>
<br/>
happy coding!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154131 - PlagueSpark - Fri Apr 11, 2008 8:19 pm</h4>
    <div class="postbody"><span class="postbody">There is no microphone example that comes with libnds
<br/>
<br/>
It seems that I should use "combined template" instead of "arm9 template"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154135 - PlagueSpark - Fri Apr 11, 2008 9:16 pm</h4>
    <div class="postbody"><span class="postbody">Sorry for Double-Posting!
<br/>
<br/>
I found cool and quick solution!
<br/>
<br/>
All need is to modificate arm7 core file for sending MIC_ReadData() instead of pressure power on ordinate :)
<br/>
<br/>
And ofcource adding MIC_ON() on ARM7's start up
<br/>
<br/>
Pressure values are not much being used (I believe)
<br/>
<br/>
So every time touchscreen is read - he brings microphone data on it's .px of data structure</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154163 - silent_code - Sat Apr 12, 2008 2:16 am</h4>
    <div class="postbody"><span class="postbody">i guess this is a "dirty" way of doing it. well, i haven't used the microphone, yet, so i don't know.
<br/>
btw: <a class="postlink" href="http://www.double.co.nz/nintendo_ds/nds_develop9.html" target="_blank">here</a> is the tutorial i mentioned before. beware, it's quite old!
<br/>
<br/>
have fun!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154167 - 0xtob - Sat Apr 12, 2008 2:49 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=71350#71350" target="_blank">Here</a> is a simple microphone example that shows how to trigger recording from the arm9 and has much higher quality than libnds's integrated microphone functions. I'm not sure if it still compiles, but you'll get the idea. This program uses a shared memory command passing interface by dekutree. A cleaner way of passing commands between the CPUs would use the FIFO, but for my software the shared memory approach has proven very reliable.<br/>_________________<br/><a class="postlink" href="http://blog.dev-scene.com/0xtob" target="_blank">http://blog.dev-scene.com/0xtob</a> | <a class="postlink" href="http://nitrotracker.tobw.net" target="_blank">http://nitrotracker.tobw.net</a> | <a class="postlink" href="http://dsmi.tobw.net" target="_blank">http://dsmi.tobw.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154175 - PlagueSpark - Sat Apr 12, 2008 9:12 am</h4>
    <div class="postbody"><span class="postbody">I had read the "old" microphone example before doing <b style="color:#FFA34F">mic</b> code realisation by mine.
<br/>
<br/>
All I was needed was the current microfone input (detecting blowing), not a recorded fragment.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154182 - silent_code - Sat Apr 12, 2008 12:42 pm</h4>
    <div class="postbody"><span class="postbody">ah, then all you need is a threshold value.
<br/>
you simply fill a small buffer with recorded audio and iterate over it to check for that. then it' sufficient to return a single int. you're right. :^)
<br/>
<br/>
btw: welcome to the forum. :^D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154183 - PlagueSpark - Sat Apr 12, 2008 1:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">ah, then all you need is a threshold value.
<br/>
you simply fill a small buffer with recorded audio and iterate over it to check for that. then it' sufficient to return a single int. you're right. :^)
<br/>
</td> </tr></table><span class="postbody">
<br/>
Why check some filled buffer? On each touchscreen check my solution already sends current byte of microphone input. Totaly no need to iterate something. So for each frame I got <b style="color:#FFA34F">mic</b> byte to make something out of this.
<br/>
To do this is only needed to adjust two strings in libnds arm7 template
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   IPC-&gt;touchX         = x;
<br/>
   IPC-&gt;touchY         = y;
<br/>
   IPC-&gt;touchXpx      = MIC_ReadData();// HERE!
<br/>
   IPC-&gt;touchYpx      = ypx;
<br/>
   IPC-&gt;touchZ1      = z1;
<br/>
   IPC-&gt;touchZ2      = z2;
<br/>
   IPC-&gt;buttons      = but;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   irqInit();
<br/>
   
<br/>
   MIC_On();// AND HERE :)
<br/>
<br/>
   initClockIRQ();
<br/>
<br/>
   SetYtrigger(80);
<br/>
   irqSet(IRQ_VCOUNT, VcountHandler);
<br/>
   irqSet(IRQ_VBLANK, VblankHandler);
<br/>
</td> </tr></table><span class="postbody">
<br/>
No need for some cpu and memory consuming operations
<br/>
<br/>
Only disadvance that pressure value by x is missed, but it the Y pressure value can act as X also if your application need it (stylus is round also).
<br/>
<br/>
This is a pity that there is not much homebrew taking advantage of microphone :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154203 - silent_code - Sat Apr 12, 2008 9:45 pm</h4>
    <div class="postbody"><span class="postbody">oh, i was just thinking, it might be better to use several values to ensure consistency (in that case you normally wouldn't count too short inputs), but yes, your approach is also valid. 60 samples per second are *quite* ok. ;^)
<br/>
can't you extend the structure that holds the values to add your mircophone value?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154238 - PlagueSpark - Sun Apr 13, 2008 9:29 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">can't you extend the structure that holds the values to add your mircophone value?</td> </tr></table><span class="postbody">
<br/>
I'm not sure what you want to say 8-/
<br/>
Why is to sum something?
<br/>
The program on arm9 recieves all needed data to work with microphone.
<br/>
So u8 (is native format data of microphone) is totaly enogh to check if the microphone catches blowing or scream :) at current frame
<br/>
There is no need to code something more on arm7.
<br/>
For games/programs that needs microphone as "another action button" my solution works supreme :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154247 - wintermute - Sun Apr 13, 2008 1:15 pm</h4>
    <div class="postbody"><span class="postbody">Any code that uses the IPC struct will fail in future updates of libnds, it's best if you avoid custom arm7 code for now.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
