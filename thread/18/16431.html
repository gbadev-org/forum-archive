<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>makefile: Adding automatic EFS and ds.gba (solved) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > makefile: Adding automatic EFS and ds.gba (solved)</h2>
<div id="posts">
<div class="post">
    <h4>#166538 - Emmanuel - Mon Feb 09, 2009 4:02 pm</h4>
    <div class="postbody"><span class="postbody">Which lines and where do I add them to embed EFS and generate a ds.gba along with the .nds at compilation?
<br/>
<br/>
I'm using the Combined template...
<br/>
<br/>
(or embedding with NitroFS... even better)
<br/>
<br/>
BTW, Why should I use NitroFS over EFS?
<br/>
<br/>
Where can I get NitroFS if it's better than EFS? How is it used?</span><span class="gensmall"><br/><br/>Last edited by Emmanuel on Tue Feb 10, 2009 2:53 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#166545 - kusma - Mon Feb 09, 2009 5:21 pm</h4>
    <div class="postbody"><span class="postbody">NitroFS isn't really "better" than EFS, it's a bit more light-weight and focused IMO. While EFS supports writing files, NitroFS does not. There might also be some performance differences, but that'd be outside of my knowledge.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166567 - Echo49 - Mon Feb 09, 2009 9:33 pm</h4>
    <div class="postbody"><span class="postbody">I don't know much about makefiles, but I use the following setup (I associate .nds with no$gba):
<br/>
Makefile (added to the end):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">emu:
<br/>
   ndstool   -c $(TARGET).nds -7 $(TARGET).arm7 -9 $(TARGET).arm9 -d nitro</td> </tr></table><span class="postbody">
<br/>
Batch file:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">make
<br/>
make emu
<br/>
start [name].nds</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166568 - cory1492 - Mon Feb 09, 2009 9:42 pm</h4>
    <div class="postbody"><span class="postbody">In the combined makefile (the root one, not one of the ones in the arm dirs) look for a bit like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
$(TARGET).nds   :   $(TARGET).arm7 $(TARGET).arm9
<br/>
   ndstool   -c $(TARGET).nds -7 $(TARGET).arm7 -9 $(TARGET).arm9</td> </tr></table><span class="postbody">
<br/>
Which is what you'd modify. As Echo49 mentions above, if your files are going to be used by NitroFS you can just add the "-d dirname" bit to the end of the ndstool line. For EFS I'm not so sure, though it appears it uses exactly the same method for appending (ndstool's -d option) so something along these lines:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
$(TARGET).nds   :   $(TARGET).arm7 $(TARGET).arm9
<br/>
   ndstool   -c $(TARGET).nds -7 $(TARGET).arm7 -9 $(TARGET).arm9 -d dirname
<br/>
   efs $(TARGET).nds</td> </tr></table><span class="postbody">
<br/>
though efs.exe itself will need to be somewhere on the paths that the makefile is aware of.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166577 - Echo49 - Tue Feb 10, 2009 6:32 am</h4>
    <div class="postbody"><span class="postbody">Btw, the reason I use a separate command for adding the directory is because it allows me to use just the "make" command to compile for DS, since I only use NitroFS when testing on an emulator, whereas I read straight from fat when testing on hardware.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166582 - Emmanuel - Tue Feb 10, 2009 2:53 pm</h4>
    <div class="postbody"><span class="postbody">Thanks, it works all right</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
