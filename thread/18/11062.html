<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to see asm-code of compled cpp file? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > How to see asm-code of compled cpp file?</h2>
<div id="posts">
<div class="post">
    <h4>#101492 - HotChilli - Tue Sep 05, 2006 10:42 pm</h4>
    <div class="postbody"><span class="postbody">I have heard about parameters for GCC that permit to see asm-code of compiled cpp file. But what is the parameter? Or another way for see asm-code?
<br/>
<br/>
PS: This is nice for program optimization on cpp-coding-level. ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101493 - sajiimori - Tue Sep 05, 2006 10:50 pm</h4>
    <div class="postbody"><span class="postbody">The best way to see the compiler output for a module is to compile it with -S.  That will produce an .s file instead of an .o file.
<br/>
<br/>
For disassembling an .o file, use objdump -d.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101500 - gmiller - Wed Sep 06, 2006 12:13 am</h4>
    <div class="postbody"><span class="postbody">If you use -save-temps you will get assembly output for each file and the compile will still happen.  The -S will stop the compile before calling the assembler.  But if you just want to look at the assembly output the -S will do the job.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101501 - HotChilli - Wed Sep 06, 2006 12:47 am</h4>
    <div class="postbody"><span class="postbody">Yeah - thanx, sajiimori and gmiller. That's work! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101864 - PypeBros - Fri Sep 08, 2006 2:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">The best way to see the compiler output for a module is to compile it with -S.  That will produce an .s file instead of an .o file.
<br/>
<br/>
For disassembling an .o file, use objdump -d.</td> </tr></table><span class="postbody">
<br/>
<br/>
objdump -drS thefile.o is my favourite one. Mixing your C code with ASM output :P<br/>_________________<br/><a class="postlink" href="http://sylvainhb.blogspot.com/p/sprite-editor.html" target="_blank"> SEDS: Sprite Edition on DS</a> :: <a class="postlink" href="http://sylvainhb.blogspot.com/search/label/modplayer" target="_blank">modplayer</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101887 - josath - Fri Sep 08, 2006 5:51 pm</h4>
    <div class="postbody"><span class="postbody">that objdump command doesn't seem to work reliably with c++ code, the asm and code are both in the output, but it doesn't seem to be matched together: there will be a big block of source code, then a big block of asm</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101897 - sajiimori - Fri Sep 08, 2006 7:27 pm</h4>
    <div class="postbody"><span class="postbody">Even with no optimization?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101901 - josath - Fri Sep 08, 2006 7:45 pm</h4>
    <div class="postbody"><span class="postbody">Here's the command that gets called during compilation:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
arm-eabi-g++ -MMD -MP -MF arm9/build/main.d -g -Wall -mcpu=arm9tdmi -mtune=arm9tdmi -fomit-frame-pointer -ffast-math -mthumb-interwork -Iarm9/include -Ilibnds/include -Ilibfat/nds/include -Iarm9/build -DARM9 -c arm9/source/main.cpp -o main.o
<br/>
</td> </tr></table><span class="postbody"> (paths truncated to make it cleaner)
<br/>
<br/>
Here's the output of "objdrump -drS main.o &gt; dump.s": <a href="http://h.davr.org/dump.s" target="_blank">http://h.davr.org/dump.s</a>
<br/>
<br/>
search for occurrances of 'loadSplash' (please excuse my poor coding habits :P ), and you will see there is no asm directly mixed with the code, but loadsplash occurs later in the ASM. same with the main function. however other functions have their asm mixed in fine.
<br/>
<br/>
This kind of output, if I can get it to work reliably could actually be quite useful -- until now, I haven't found a way that will mix the generated ASM along with the original</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101903 - sajiimori - Fri Sep 08, 2006 8:05 pm</h4>
    <div class="postbody"><span class="postbody">I'm actually not sure what I'm looking at there.  The macros and #ifdefs and commented-out code make it hard to tell if anything is actually going wrong.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101974 - PypeBros - Sat Sep 09, 2006 10:05 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">Here's the command that gets called during compilation:
<br/>
search for occurrances of 'loadSplash' (please excuse my poor coding habits :P ), and you will see there is no asm directly mixed with the code, but loadsplash occurs later in the ASM. same with the main function. however other functions have their asm mixed in fine.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Hmm. surprising. i have to admit i mainly worked with C so far. Maybe asking for the corresponding line numbers would help ... or make sure the line numbers aren't stripped from the executable.<br/>_________________<br/><a class="postlink" href="http://sylvainhb.blogspot.com/p/sprite-editor.html" target="_blank"> SEDS: Sprite Edition on DS</a> :: <a class="postlink" href="http://sylvainhb.blogspot.com/search/label/modplayer" target="_blank">modplayer</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101983 - gmiller - Sat Sep 09, 2006 2:27 pm</h4>
    <div class="postbody"><span class="postbody">Sounds like you would want the debug information included in the code.  Things will not match up to your code if you specify any optimizations other than '-O0' which will disable most optimization that the compiler would do after intermediate code generation.  To include debug just add '-g' to the commad line to your compiler and you will get more information.  Of course this does bloat the size of the generated code but if you goal is to "look" at it then this will accomplish what you want.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
