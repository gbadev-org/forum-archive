<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>16-bit sprite question - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > 16-bit sprite question</h2>
<div id="posts">
<div class="post">
    <h4>#148818 - JanoSicek - Thu Jan 10, 2008 7:35 pm</h4>
    <div class="postbody"><span class="postbody">Hello.
<br/>
<br/>
I have read that for 16-bit bitmap sprites the ATTR2 palette values are used as Alpha value.
<br/>
<br/>
What does this mean? How can I use it and for what?
<br/>
I haven't find any documentation for this.
<br/>
<br/>
Second question -- The effects on sprites (fade-in/fade-out/blend) work in what way? Can anyone point me to some documentation about this?
<br/>
<br/>
Also, can I use Window to fade-out a portion of tiled background? To make it darken and then put some text over it in another background?
<br/>
<br/>
Thanks for answers and links!
<br/>
<br/>
J.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148844 - yellowstar - Fri Jan 11, 2008 4:01 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I have read that for 16-bit bitmap sprites the ATTR2 palette values are used as Alpha value.
<br/>
<br/>
What does this mean? How can I use it and for what?
<br/>
I haven't find any documentation for this.
<br/>
</td> </tr></table><span class="postbody">
<br/>
This applies to all palettes on DS/GBA.
<br/>
The first palette index is the alpha index. Any pixels with this index are transparent.(Index zero)
<br/>
So, you would have the pixels you don't want to be seen, set to index 0,
<br/>
while the ones you want set to their respective values.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Second question -- The effects on sprites (fade-in/fade-out/blend) work in what way? Can anyone point me to some documentation about this?
<br/>
<br/>
Also, can I use Window to fade-out a portion of tiled background? To make it darken and then put some text over it in another background?
<br/>
</td> </tr></table><span class="postbody">
<br/>
I've never tried/learned about blending and such, so I can't help you with
<br/>
that. Somebody else needs to help with that.
<br/>
I probably would be able to figure it out by checking <a class="postlink" href="http://nocash.emubase.de/gbatek.htm" target="_blank">gbatek.</a>(That's THE number ONE resource for DS homebrew programmers, and probably GBA too.)
<br/>
<br/>
@Windows Q:
<br/>
Yes, but you'll have it do each bg seperately. Or flatten the image/project
<br/>
in your image editor.(Or export each layer for the bgs)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148853 - JanoSicek - Fri Jan 11, 2008 8:57 am</h4>
    <div class="postbody"><span class="postbody">Thanks  for the answers!
<br/>
Here are my comments:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yellowstar wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I have read that for 16-bit bitmap sprites the ATTR2 palette values are used as Alpha value.
<br/>
<br/>
What does this mean? How can I use it and for what?
<br/>
I haven't find any documentation for this.
<br/>
</td> </tr></table><span class="postbody">
<br/>
This applies to all palettes on DS/GBA.
<br/>
The first palette index is the alpha index. Any pixels with this index are transparent.(Index zero)
<br/>
So, you would have the pixels you don't want to be seen, set to index 0,
<br/>
while the ones you want set to their respective values.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
IN GBAtek I found this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>GBAtek wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
also in that mode, the color bits (Attr 2, Bit 12-15) are used as Alpha-OAM value (instead of as palette setting).
<br/>
</td> </tr></table><span class="postbody">
<br/>
Therefore my question was what happends when in bitmap mode I set the Alpha-OAM to some value, for example ... 7? I have no palette, as the sprite is 15-bit color, and  the transparency is done by 16th bit of each pixel
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yellowstar wrote:</b></span></td> </tr> <tr> <td class="quote">@Windows Q:
<br/>
Yes, but you'll have it do each bg seperately. Or flatten the image/project
<br/>
in your image editor.(Or export each layer for the bgs)</td> </tr></table><span class="postbody">
<br/>
Example of what I want to do:
<br/>
I have layer 0,1,2,3 tiled backgrounds. 0 is on top
<br/>
I want layers 1,2,3 to darken and 0 to not change
<br/>
<br/>
Can i set the layers to apply the effect as bg1,bg2,bg3 and effect as fade out? will this take  the topmost pixel from these 3 bgs and fade it  out, before possibly overlapping bg0 on top of it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148861 - eKid - Fri Jan 11, 2008 3:06 pm</h4>
    <div class="postbody"><span class="postbody">When using bitmap sprites the Attr2 palette value becomes an alpha blending value. It is to be used together with BLEND_CR (blending control). The sprite will blend with the targets specified in the 'destination' of BLEND_CR. Bitmap sprites won't be affected by other special effects in BLEND_CR (such as fade-black/fade-white) they'll always use alpha blending.
<br/>
<br/>
I ran a few tests....
<br/>
<a href="http://ekid.nintendev.com/bitmap_sprites.zip" target="_blank">http://ekid.nintendev.com/bitmap_sprites.zip</a>
<br/>
Blending doesn't work properly in any emulator, you'll have to test on hardware.
<br/>
<br/>
Another small thing I noticed is that even when the blending targets are all disabled, if the alpha value is 0 the sprite will not be drawn (and drawn fully if nonzero).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148870 - JanoSicek - Fri Jan 11, 2008 4:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>eKid wrote:</b></span></td> </tr> <tr> <td class="quote">When using bitmap sprites the Attr2 palette value becomes an alpha blending value. It is to be used together with BLEND_CR (blending control). The sprite will blend with the targets specified in the 'destination' of BLEND_CR. Bitmap sprites won't be affected by other special effects in BLEND_CR (such as fade-black/fade-white) they'll always use alpha blending.
<br/>
<br/>
I ran a few tests....
<br/>
<a href="http://ekid.nintendev.com/bitmap_sprites.zip" target="_blank">http://ekid.nintendev.com/bitmap_sprites.zip</a>
<br/>
Blending doesn't work properly in any emulator, you'll have to test on hardware.
<br/>
<br/>
Another small thing I noticed is that even when the blending targets are all disabled, if the alpha value is 0 the sprite will not be drawn (and drawn fully if nonzero).</td> </tr></table><span class="postbody">
<br/>
If I undestand correctly:
<br/>
If a sprite is TILE-BASED, then it will only blend if the blending bit for it is set, and all such sprites will be blended by the same factor.
<br/>
<br/>
If a sprite is BITMAP-BASED, then it will always blend by the factor set in this attribute...
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148871 - eKid - Fri Jan 11, 2008 4:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If I undestand correctly:
<br/>
If a sprite is TILE-BASED, then it will only blend if the blending bit for it is set, and all such sprites will be blended by the same factor.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Right, unless the 'source' of BLEND_CR includes the sprite bit, then <span style="font-style: italic">all</span> sprites will have blending enabled.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Also, can I use Window to fade-out a portion of tiled background? To make it darken and then put some text over it in another background?
<br/>
</td> </tr></table><span class="postbody">
<br/>
Yes the windows can mask out special effects. I have a demo here that demonstrates this
<br/>
<a href="http://ekid.nintendev.com/spotlight.zip" target="_blank">http://ekid.nintendev.com/spotlight.zip</a>
<br/>
<br/>
Basically what you want to do is set 'WIN_IN' to everything and 'WIN_OUT' to everything <span style="font-style: italic">except</span> special effects (a window must also be enabled in DISPLAY_CR). Then BLEND_CR can be set to 'fade to black' mode, and the darkness specified in BLEND_Y. This makes only the portion inside the window coordinates darkened.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
