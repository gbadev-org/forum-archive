<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>BackGround Question [Resolved] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > BackGround Question [Resolved]</h2>
<div id="posts">
<div class="post">
    <h4>#162453 - crazycrow - Wed Sep 03, 2008 9:05 am</h4>
    <div class="postbody"><span class="postbody">Hi, 
<br/>
I try to draw something on the BG3 (a shape) , and on the BG2 I have a image display.
<br/>
<br/>
I init the screen like that 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
vramSetMainBanks(VRAM_A_MAIN_BG_0x06000000, VRAM_B_LCD,VRAM_C_SUB_BG , VRAM_D_LCD);
<br/>
<br/>
<br/>
 videoSetModeSub( MODE_5_2D | DISPLAY_BG2_ACTIVE | DISPLAY_BG3_ACTIVE);
<br/>
    SUB_BG2_CR = BG_BMP8_256x256 | BG_PRIORITY_3 | BG_BMP_BASE(0);
<br/>
    SUB_BG2_XDX = 256;
<br/>
    SUB_BG2_XDY = 0;
<br/>
    SUB_BG2_YDX = 0;
<br/>
    SUB_BG2_YDY = 256;
<br/>
    SUB_BG2_CX = 0;
<br/>
    SUB_BG2_CY = 0;
<br/>
<br/>
<br/>
<br/>
    SUB_BG3_CR = BG_BMP16_256x256 | BG_PRIORITY_0 | BG_BMP_BASE(4);
<br/>
    SUB_BG3_XDX = 256;
<br/>
    SUB_BG3_XDY = 0;
<br/>
    SUB_BG3_YDX = 0;
<br/>
    SUB_BG3_YDY = 256;
<br/>
    SUB_BG3_CX = 0;
<br/>
    SUB_BG3_CY = 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I use BG_BMP_RAM_SUB(0) and BG_BMP_RAM_SUB(4) to draw in.
<br/>
<br/>
The probleme is that the shape is not draw, but the image is draw.
<br/>
With Dualis, I can see in the memory, the BG2 contain the image, and the BG3 , the shape.
<br/>
<br/>
Where I have Wrong ?</span><span class="gensmall"><br/><br/>Last edited by crazycrow on Wed Sep 03, 2008 3:00 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#162455 - jimis - Wed Sep 03, 2008 9:52 am</h4>
    <div class="postbody"><span class="postbody">There is a problem with the priorities
<br/>
More specificaly:
<br/>
Replace this SUB_BG2_CR = BG_BMP8_256x256 | BG_PRIORITY_3 | BG_BMP_BASE(0);
<br/>
with SUB_BG2_CR = BG_BMP8_256x256 | BG_PRIORITY_0 | BG_BMP_BASE(0);
<br/>
and this SUB_BG3_CR = BG_BMP16_256x256 | BG_PRIORITY_0 | BG_BMP_BASE(4);
<br/>
with this SUB_BG3_CR = BG_BMP16_256x256 | BG_PRIORITY_1 | BG_BMP_BASE(4);</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162458 - crazycrow - Wed Sep 03, 2008 10:22 am</h4>
    <div class="postbody"><span class="postbody">I try it , but doesn't work.
<br/>
<br/>
If I have understand, the BG with priority 0 is in front of the BG with priority 1.
<br/>
<br/>
I want my bg3 is front of the BG2.
<br/>
<br/>
If I keep the priority order, and un put the BG3 in BG_BMP8_256x256, it display something, but not in 16bit, it use the palette of the BG2.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162461 - crazycrow - Wed Sep 03, 2008 2:59 pm</h4>
    <div class="postbody"><span class="postbody">I have found the problem, I have forgot the transparency of the shape.
<br/>
<br/>
It work now.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162481 - Cydrak - Wed Sep 03, 2008 9:45 pm</h4>
    <div class="postbody"><span class="postbody">Have you run on hardware yet? Bank C is only 128K, which is too small, so the shape may wrap around and clobber your image. You need at least 48K + 96K = 144K for these 256x192 bitmaps.
<br/>
<br/>
(Actually you need more--64K + 128K--if the whole 256x256 are shown; if not, then it's okay to re-use the excess, by changing the BMP_BASE(4) to BMP_BASE(3) for example. However, this still won't give you enough room.)
<br/>
<br/>
I don't know about Dualis, but be careful: emulators tend to be more lenient.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162522 - crazycrow - Thu Sep 04, 2008 10:08 am</h4>
    <div class="postbody"><span class="postbody">I use an Image 256x192 , and a shape 50x50 on the top left, for training in DS Dev.
<br/>
<br/>
But I haven't actually how the VRAM_X work.
<br/>
<br/>
Do you have a tuto or some exemple of each VRAM when vramSetMainBanks is called ?
<br/>
<br/>
If I have understand, 
<br/>
<br/>
VRAM_A_MAIN_BG is active, BG_BMP_BASE(0) = VRAM_A, for the top screen</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
