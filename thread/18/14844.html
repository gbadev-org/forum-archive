<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to force a rebuild if makefile changes? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > How to force a rebuild if makefile changes?</h2>
<div id="posts">
<div class="post">
    <h4>#148999 - Dwedit - Sun Jan 13, 2008 12:14 pm</h4>
    <div class="postbody"><span class="postbody">How do I make it so it rebuilds everything if the makefile is newer than the current output file?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149000 - Lick - Sun Jan 13, 2008 12:57 pm</h4>
    <div class="postbody"><span class="postbody">Delete the build directories?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149002 - kusma - Sun Jan 13, 2008 1:01 pm</h4>
    <div class="postbody"><span class="postbody">"make clean all" is the "standard" way to force a rebuild with makefiles.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149004 - Dark Knight ez - Sun Jan 13, 2008 1:28 pm</h4>
    <div class="postbody"><span class="postbody">I think Dwedit means doing this with a rule in the Makefile itself, not having to worry about this himself.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://amplituds.drunkencoders.com" target="_blank">AmplituDS website</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149007 - kusma - Sun Jan 13, 2008 2:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dark Knight ez wrote:</b></span></td> </tr> <tr> <td class="quote">I think Dwedit means doing this with a rule in the Makefile itself, not having to worry about this himself.</td> </tr></table><span class="postbody">
<br/>
Well, then you'd have to make all targets depend on the makefile, and that's not something I'd recommend for a variety of reasons. What's the big problem with having to make clean manually after you've already done the already manual job of modifying a makefile?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149018 - nipil - Sun Jan 13, 2008 5:20 pm</h4>
    <div class="postbody"><span class="postbody">IF you're using programmer's notepad, well...
<br/>
ALT+2, then ALT+1 is *really* fast.
<br/>
So fast actually that i clean my project a whole too often ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149024 - simonjhall - Sun Jan 13, 2008 6:31 pm</h4>
    <div class="postbody"><span class="postbody">kusma is right - the 'make clean all' thing is pretty standard. Even IDEs like eclipse call make with 'clean all' when it wants to do a rebuild.
<br/>
However, for the lazy you could always add an extra rule named 'rebuild' that looks a bit like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">rebuild:
<br/>
    $(MAKE) clean
<br/>
    $(MAKE) all</td> </tr></table><span class="postbody">and then call make rebuild when you want to that.<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149030 - Peter - Sun Jan 13, 2008 7:52 pm</h4>
    <div class="postbody"><span class="postbody">and if you want to make all targets, -B is your friend:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>make --help wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Usage: make [options] [target] ...
<br/>
Options:
<br/>
  -B, --always-make           Unconditionally make all targets.
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>Kind Regards,
<br/>
Peter</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149179 - PypeBros - Wed Jan 16, 2008 1:07 pm</h4>
    <div class="postbody"><span class="postbody">include the makefile in the dependencies of the target ?<br/>_________________<br/><a class="postlink" href="http://sylvainhb.blogspot.com/p/sprite-editor.html" target="_blank"> SEDS: Sprite Edition on DS</a> :: <a class="postlink" href="http://sylvainhb.blogspot.com/search/label/modplayer" target="_blank">modplayer</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149196 - Dwedit - Wed Jan 16, 2008 4:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>PypeBros wrote:</b></span></td> </tr> <tr> <td class="quote">include the makefile in the dependencies of the target ?</td> </tr></table><span class="postbody">
<br/>
<br/>
How do I correctly do this?  I'm pretty much a n00b to makefiles.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149203 - kusma - Wed Jan 16, 2008 5:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">How do I correctly do this?  I'm pretty much a n00b to makefiles.</td> </tr></table><span class="postbody">
<br/>
First I'd like to warn you a bit: Think about why you're doing this. What problems does it solve? I'm not sure I see this as a very practical thing to spend time on, and it makes the makefiles a bit more cryptic. And I think a simple "make clean" is easy enough to do manually whenever you modify a makefile. But that might just be me.
<br/>
<br/>
Anyway, normal make rules are defined like this
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">target : dependencies
<br/>
   commands
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
What you should do, is append the $(MAKEFILE_LIST), a "magic" variable containing all makefiles (the root makefile plus all included makefiles), to the dependency list.
<br/>
<br/>
For example: If your makefile had a rule like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">%.o : %.c
<br/>
   $(COMPILE.c) $(OUTPUT_OPTION) $&lt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
you would want to change it to this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">%.o : %.c $(MAKEFILE_LIST)
<br/>
   $(COMPILE.c) $(OUTPUT_OPTION) $&lt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Simple as that.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
