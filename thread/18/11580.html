<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Swapping LCD's without using LCDSwap - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Swapping LCD's without using LCDSwap</h2>
<div id="posts">
<div class="post">
    <h4>#107563 - headspin - Mon Oct 30, 2006 10:26 pm</h4>
    <div class="postbody"><span class="postbody">I've had a few people reporting problems with LCDSwap(). It was with Supercards I think. So I'm recompiling some old code to avoid using it.
<br/>
<br/>
Here are my video mode and bank setup's
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetMode(MODE_5_2D | DISPLAY_BG3_ACTIVE); 
<br/>
videoSetModeSub(MODE_0_2D | DISPLAY_BG0_ACTIVE);
<br/>
vramSetMainBanks(VRAM_A_MAIN_BG_0x6000000, VRAM_B_MAIN_BG_0x6020000, VRAM_C_SUB_BG , VRAM_D_LCD);
<br/>
SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
BG3_CR = BG_BMP16_256x256;</td> </tr></table><span class="postbody">
<br/>
<br/>
Now I thought it would be a simple matter of swapping over the first two banks to VRAM_A_SUB_BG_0x6200000 and VRAM_B_SUB_BG_0x6220000. Problem is I only see a defintion for Sub screen in bank C (VRAM_C_SUB_BG_0x6200000).
<br/>
<br/>
Is there a way I can avoid the LCDSwap bug in Supercards and switch over the banks? Or is there some other way?<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107565 - omaremad - Mon Oct 30, 2006 10:45 pm</h4>
    <div class="postbody"><span class="postbody">Works fine on my supercard, maybe its m3? ithink the m3 needs to have all the ram banks cleared througly othewise its buggy try pepsimans loader.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107567 - josath - Mon Oct 30, 2006 11:34 pm</h4>
    <div class="postbody"><span class="postbody">There's an easier way. Instead of using lcdSwap(), use lcdMainOnTop() or lcdMainOnBottom() (I think those are the names, look in video.h if they don't work)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107579 - TJ - Tue Oct 31, 2006 1:47 am</h4>
    <div class="postbody"><span class="postbody">lcdSwap works fine on my SuperCard as well.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107582 - headspin - Tue Oct 31, 2006 3:24 am</h4>
    <div class="postbody"><span class="postbody">Okay, just checked my e-mail and it was a user with an M3 SD cart that had the LCDSwap() issue.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107622 - HyperHacker - Tue Oct 31, 2006 5:43 pm</h4>
    <div class="postbody"><span class="postbody">lcdSwap() is unreliable for setting the initial screen position since you don't know what it is to begin with. Use lcdMainOnTop() or lcdMainOnBottom() to set up, and lcdSwap() when you actually need to switch screens.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107631 - OOPMan - Tue Oct 31, 2006 6:38 pm</h4>
    <div class="postbody"><span class="postbody">Hmmmm, I do recall having problems with some older homebrew whereby loading direct from the SC menu would result in the app hanging with the screens reversed shortly hafter startup. Starting via DSO or Moonshell usually fixed this...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107948 - PypeBros - Fri Nov 03, 2006 10:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>headspin wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Now I thought it would be a simple matter of swapping over the first two banks to VRAM_A_SUB_BG_0x6200000 and VRAM_B_SUB_BG_0x6220000. Problem is I only see a defintion for Sub screen in bank C (VRAM_C_SUB_BG_0x6200000).
<br/>
<br/>
Is there a way I can avoid the LCDSwap bug in Supercards and switch over the banks? Or is there some other way?</td> </tr></table><span class="postbody">
<br/>
<br/>
That would only partially emulate the LCD swap, anyway. E.g. sprite memory wouldn't be swapped (so you have to move manually all the sprites to the new screen), and that doesn't make your bottom screen more powerful (e.g. you don't change the physical location of the screen that is 3D-capable).
<br/>
<br/>
Still that could be a nice trick if you want to swap the capabilities without swapping the content (e.g. your 3D-rendered avatar moves to the upper screen so you want the upper screen to become the main screen but the tiles of your dungeon-of-darkness should still remain in place).<br/>_________________<br/><a class="postlink" href="http://sylvainhb.blogspot.com/p/sprite-editor.html" target="_blank"> SEDS: Sprite Edition on DS</a> :: <a class="postlink" href="http://sylvainhb.blogspot.com/search/label/modplayer" target="_blank">modplayer</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
