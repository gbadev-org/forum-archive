<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Calculate volume/volume shift properly? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Calculate volume/volume shift properly?</h2>
<div id="posts">
<div class="post">
    <h4>#173777 - Ruben - Fri Apr 30, 2010 11:45 am</h4>
    <div class="postbody"><span class="postbody">Hi.
<br/>
<br/>
So I was doing some work on my Midi music player [and yes, once I actually implement bank loads it'll be adjusted to work with libnds as well]... and decided that it's time to work with shifted volume [that is, using the hardware /2, /4, /16 values]. My first attempt was rather bad as it compared the limits of 3 possibilities. I know MaxMod uses a LUT, but is there a better way to calculate a volume + shift when one has a 25-bit accuracy, 7-bit integer value as volume?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173785 - Miked0801 - Fri Apr 30, 2010 4:44 pm</h4>
    <div class="postbody"><span class="postbody">Not quite sure what you are asking, could you post a snippet of sample code?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173793 - Ruben - Sat May 01, 2010 6:22 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">40004x0h - NDS7 - SOUNDxCNT - Sound Channel X Control Register (R/W)
<br/>
<br/>
  Bit0-6    Volume Mul   (0..127=silent..loud)
<br/>
  Bit7      Not used     (always zero)
<br/>
  Bit8-9    Volume Div   (0=Normal, 1=Div2, 2=Div4, 3=Div16)</td> </tr></table><span class="postbody">
<br/>
While I can just use a 0 division ['normal' mode], it seems more proper to use an actual scaling value [bits 8-9].</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173794 - Dwedit - Sat May 01, 2010 6:34 am</h4>
    <div class="postbody"><span class="postbody">Volume division seems worthless, since you can just change the volume between 0 and 127 directly.  I guess it's just for situations where you want to temporarily make the music quieter.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173795 - Ruben - Sat May 01, 2010 7:03 am</h4>
    <div class="postbody"><span class="postbody">Hm, so there's pretty much no point in keeping the sound volume accuracy? But then why do MaxMod and official games use the division?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
