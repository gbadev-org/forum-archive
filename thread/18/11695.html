<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dur...stoopid keypad related question... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Dur...stoopid keypad related question...</h2>
<div id="posts">
<div class="post">
    <h4>#108945 - OOPMan - Mon Nov 13, 2006 11:23 am</h4>
    <div class="postbody"><span class="postbody">Just a quick question which is probably pretty stupid but...
<br/>
<br/>
I'm mucking about with the keypad stuff and would just like to know what value to check for for keysDown() to indicate that no keys are down. I'd prefer not to have to call keysUp() with a long string of bit ands as well...
<br/>
<br/>
I'm probably missing something obivious here but using 0 didn't *seem* to work (It was in a switch statement and gcc complained that case 0 was  duplicated of one of my prior cases...)
<br/>
<br/>
So, what value should I check for?
<br/>
<br/>
*waits for the laughter*<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108948 - Mr Snowflake - Mon Nov 13, 2006 12:26 pm</h4>
    <div class="postbody"><span class="postbody">Maybe a stupid reply, but shouldn't the lid bit be negated?<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108949 - OOPMan - Mon Nov 13, 2006 12:33 pm</h4>
    <div class="postbody"><span class="postbody">Hmmmmmm, probably a good thing to check for...
<br/>
<br/>
Any other suggestions...
<br/>
<br/>
Basically what I'm trying to do is this...
<br/>
<br/>
1: User presses a key or combo of keys
<br/>
2: Program records combo
<br/>
3: When user releases all keys, program prints last key combo formed<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108967 - outphase - Mon Nov 13, 2006 5:19 pm</h4>
    <div class="postbody"><span class="postbody">One problem with this approach is that no one will release all keys at the same time, so your combo will be incomplete.
<br/>
<br/>
If I understand what you want to do correctly, you can negate bit 13 (KEY_LID), then check to see if the value is 0 for keyDown(). although I don't know if KEY_LID is 1 or 0 when it's open.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108974 - OOPMan - Mon Nov 13, 2006 6:28 pm</h4>
    <div class="postbody"><span class="postbody">That's a good point. I hadn't thought of that :-(<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109028 - HyperHacker - Tue Nov 14, 2006 6:15 am</h4>
    <div class="postbody"><span class="postbody">What I do is keep u32 KeysPressed and KeysHeld in IPC. On each VBlank ARM7 gathers all the keypad info and writes it into these. KeysPressed is the keys that were pressed this frame and KeysHeld is those that have been held for more than one frame. I don't recall the precise method I used to determine which are held, but I could look it up if you need it.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109033 - OOPMan - Tue Nov 14, 2006 7:37 am</h4>
    <div class="postbody"><span class="postbody">That might be useful, thanks HH :-)<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109062 - josath - Tue Nov 14, 2006 6:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">What I do is keep u32 KeysPressed and KeysHeld in IPC. On each VBlank ARM7 gathers all the keypad info and writes it into these. KeysPressed is the keys that were pressed this frame and KeysHeld is those that have been held for more than one frame. I don't recall the precise method I used to determine which are held, but I could look it up if you need it.</td> </tr></table><span class="postbody">
<br/>
<br/>
libnds includes these functions now. You just have to call 'scanKeys()' every time to update them, then use:
<br/>
keysDown() // keys pressed this frame
<br/>
keysHeld() // keys which are held down
<br/>
keysUp() // keys which were just let go this frame</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109065 - outphase - Tue Nov 14, 2006 7:05 pm</h4>
    <div class="postbody"><span class="postbody">Using those functions, I guess you could record your keys held until keyup has a value.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109226 - HyperHacker - Thu Nov 16, 2006 6:53 am</h4>
    <div class="postbody"><span class="postbody">Interesting, but that means calling a function every time I want the key status, which probably has more overhead than just reading the data out of IPC.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109239 - tepples - Thu Nov 16, 2006 8:35 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">that means calling a function every time I want the key status, which probably has more overhead than just reading the data out of IPC.</td> </tr></table><span class="postbody">
<br/>
Some function calls don't have overhead, and these are called <span style="font-weight: bold">static inline</span>. If you find a place where wintermute forgot to mark a function in libnds for proper inlining, let him know.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109253 - Mr Snowflake - Thu Nov 16, 2006 12:00 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Some function calls don't have overhead, and these are called <span style="font-weight: bold">static inline</span>. If you find a place where wintermute forgot to mark a function in libnds for proper inlining, let him know.</td> </tr></table><span class="postbody">If the functionbodies are declared in the header file, the static inline isn't needed. They will be implicitly inline.<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#109276 - tepples - Thu Nov 16, 2006 7:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mr Snowflake wrote:</b></span></td> </tr> <tr> <td class="quote">If the functionbodies are declared in the header file, the static inline isn't needed. They will be implicitly inline.</td> </tr></table><span class="postbody">
<br/>
As I understand it, what you say applies only in C++ and only to methods of a class.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
