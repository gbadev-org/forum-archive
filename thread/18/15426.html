<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sound:what's the difference between 'Manual' and 'One-Shot'? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Sound:what's the difference between 'Manual' and 'One-Shot'?</h2>
<div id="posts">
<div class="post">
    <h4>#154771 - sverx - Mon Apr 21, 2008 4:06 pm</h4>
    <div class="postbody"><span class="postbody">While I'm still stuck with the RTC (as you can see <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=15349" target="_blank">here</a> ... ) I took a pause and I went back to the <span style="font-weight: bold">sound</span> argument.
<br/>
<br/>
Short. The question is: what's the difference between the different sample repeat modes? Because <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#dssound" target="_blank">gbatek</a> says that bits 27-28 of the channel control register (SOUNDxCNT) have these meaning:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Bit27-28  Repeat Mode  (0=Manual, 1=Loop Infinite, 2=One-Shot, 3=Prohibited)</td> </tr></table><span class="postbody">
<br/>
<br/>
and in the libnds file <span style="font-style: italic">arm7/audio.h</span> there are 2 defines:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define SOUND_REPEAT    BIT(27)
<br/>
#define SOUND_ONE_SHOT  BIT(28)</td> </tr></table><span class="postbody">
<br/>
<br/>
... well, of course I understand the 'repeat' mode, and I already used it... what I really can't understand is: what's the difference between <span style="font-weight: bold">Manual</span> ( 0b00 ) and <span style="font-weight: bold">One-Shot</span> ( 0b10 ) ?
<br/>
<br/>
TIA :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154788 - Cydrak - Mon Apr 21, 2008 7:12 pm</h4>
    <div class="postbody"><span class="postbody">(Ahh, GBAtek, <span style="font-style: italic">ever</span> so helpful with your terminology.. :b)
<br/>
<br/>
These would be better called "GBA" and "instrument" or "looped" modes.
<br/>
<br/>
<span style="font-weight: bold">GBA style (mode 0)</span>:
<br/>
Plays until stopped. Not very useful, unless you like listening to your code. ;)
<br/>
Starting from the source, it'll blow through the whole 0x0000000..0x7FFFFFF region, usually taking a few minutes each time.
<br/>
<br/>
<span style="font-weight: bold">Looped instruments (modes 1 and 2)</span>:
<br/>
1) Play SOUNDxPNT (SCHANNEL_REPEAT_POINT) words from the source.
<br/>
2) Play SOUNDxLEN (SCHANNEL_LENGTH) words from the repeat point.
<br/>
3) If looping still enabled (mode == 1), repeat from (2).
<br/>
<br/>
Phase (1) occurs even if not looping; in that case it's important to zero the restart point.
<br/>
<br/>
Changing modes does work mid-sample; eg. a looping channel that was changed to one-shot, will stop next time it hits the end of the loop. Unfortunately, I couldn't make it accept a new length at this time, it seems to only "take" when restarted. So, you can't abuse that to set a loop that ends before the sample does...
<br/>
<br/>
(I'll take a look at the RTC shortly: an MP3 alarm was one of my old back-burner projects, and I could swear I'd gotten it working. I used my own API with #defines from the datasheet, however, so it's not obvious what I did differently.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154880 - sverx - Tue Apr 22, 2008 8:33 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote">(Ahh, GBAtek, <span style="font-style: italic">ever</span> so helpful with your terminology.. :b)</td> </tr></table><span class="postbody">
<br/>
<br/>
sorry, I'm not really good with english so I didn't get what you mean here...
<br/>
<br/>
BTW thanks for your reply, it's very clear and useful :)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote">These would be better called "GBA" and "instrument" or "looped" modes.
<br/>
<span style="font-weight: bold">GBA style (mode 0)</span>:
<br/>
Plays until stopped. Not very useful, unless you like listening to your code. ;)</td> </tr></table><span class="postbody">
<br/>
<br/>
That's what I call taking code AND music to an upper new level ;)
<br/>
(ok, seriously, it seems to me that this <span style="font-style: italic">mode 0</span> isn't really useful...)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote">Starting from the source, it'll blow through the whole 0x0000000..0x7FFFFFF region, usually taking a few minutes each time.
<br/>
<br/>
<span style="font-weight: bold">Looped instruments (modes 1 and 2)</span>:
<br/>
1) Play SOUNDxPNT (SCHANNEL_REPEAT_POINT) words from the source.
<br/>
2) Play SOUNDxLEN (SCHANNEL_LENGTH) words from the repeat point.
<br/>
3) If looping still enabled (mode == 1), repeat from (2).
<br/>
<br/>
Phase (1) occurs even if not looping; in that case it's important to zero the restart point.
<br/>
<br/>
Changing modes does work mid-sample; eg. a looping channel that was changed to one-shot, will stop next time it hits the end of the loop. Unfortunately, I couldn't make it accept a new length at this time, it seems to only "take" when restarted. So, you can't abuse that to set a loop that ends before the sample does...</td> </tr></table><span class="postbody">
<br/>
<br/>
I see, very good. Anyway sample can be stopped resetting the channel enable bit so... right? :)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote">(I'll take a look at the RTC shortly: an MP3 alarm was one of my old back-burner projects, and I could swear I'd gotten it working. I used my own API with #defines from the datasheet, however, so it's not obvious what I did differently.)</td> </tr></table><span class="postbody">
<br/>
<br/>
I would appreciate a lot if you could check if you did something different or in a different order to make it work. Funny it's that if I set the alarm 1 to occour every minute ('minute steady alarm') <span style="font-weight: bold">it works</span>, I get the IRQ :|
<br/>
<br/>
Thanks! Ciao! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155027 - Cydrak - Thu Apr 24, 2008 1:54 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">sorry, I'm not really good with english so I didn't get what you mean here...</td> </tr></table><span class="postbody">
<br/>
Heh, sorry--some mild frustration there. I feel that GBAtek likes to use plenty of odd, technical words, rather than just explaining what the hardware was meant to do. It makes more sense to me now, but it took time. English is a really good point though: To the extent there's a language gap, I can't complain. While I was born overseas, that doesn't exactly confer German skills on its own. So if these docs weren't English, I'd be in trouble. ;)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">That's what I call taking code AND music to an upper new level ;)</td> </tr></table><span class="postbody">
<br/>
Hah! Actually, it reminds me far too much of those old, ear-wrecking dot-matrix printers. Though it <span style="font-style: italic">is</span> occasionally more musical.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">(ok, seriously, it seems to me that this mode 0 isn't really useful...)</td> </tr></table><span class="postbody">
<br/>
Well, that's the only mode the GBA had. It's just on the NDS, you have the nicer loops.. (Though, a readable SCHANNEL_TIMER, for streaming, would be better still...)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">Anyway sample can be stopped resetting the channel enable bit so... right? :) </td> </tr></table><span class="postbody">
<br/>
Of course. Have fun!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155046 - sverx - Thu Apr 24, 2008 12:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">sorry, I'm not really good with english so I didn't get what you mean here...</td> </tr></table><span class="postbody">
<br/>
Heh, sorry--some mild frustration there. I feel that GBAtek likes to use plenty of odd, technical words, rather than just explaining what the hardware was meant to do. It makes more sense to me now, but it took time. English is a really good point though: To the extent there's a language gap, I can't complain. While I was born overseas, that doesn't exactly confer German skills on its own. So if these docs weren't English, I'd be in trouble. ;)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Well... thanks for your explanation but I think I didn't get it completely even this time :|
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cydrak wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">That's what I call taking code AND music to an upper new level ;)</td> </tr></table><span class="postbody">
<br/>
Hah! Actually, it reminds me far too much of those old, ear-wrecking dot-matrix printers. Though it <span style="font-style: italic">is</span> occasionally more musical.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
So you'll love <a class="postlink" href="http://www.youtube.com/watch?v=FHcV8vZ96OM" target="_blank">this</a> :)
<br/>
<br/>
Bye!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155573 - furrykef - Thu May 01, 2008 1:51 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">Well... thanks for your explanation but I think I didn't get it completely even this time :|</td> </tr></table><span class="postbody">
<br/>
<br/>
Cydrak was just sarcastically praising the GBAtek documentation (in other words, insulting it by saying the opposite of what he really means).
<br/>
<br/>
- Kef</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
