<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem with lights - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Problem with lights</h2>
<div id="posts">
<div class="post">
    <h4>#126262 - trabis - Sat Apr 21, 2007 11:49 am</h4>
    <div class="postbody"><span class="postbody">Hello, i want a simple code with a 3d cube and changing color light but something is wrong. I`ve modified the lesson06 from nehe libnds examples. That?s the loop code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
   while (1) 
<br/>
   {
<br/>
      // Reset the screen and setup the view
<br/>
      glReset();
<br/>
      gluPerspective(35, 256.0 / 192.0, 0.1, 100);
<br/>
      glColor3f(1,1,1);
<br/>
      
<br/>
      glLight(0, RGB15(r,g,b) , 0,              floattov10(-1.0),       0);
<br/>
      glLight(1, RGB15(r,g,b) , 0,              0,   floattov10(-1.0));
<br/>
      glLight(2, RGB15(r,g,b) , 0,              0,   floattov10(1.0));
<br/>
<br/>
      glMatrixMode(GL_TEXTURE);
<br/>
      glIdentity();
<br/>
      
<br/>
      glMatrixMode(GL_MODELVIEW);
<br/>
<br/>
      //need to set up some material properties since DS does not have them set by default
<br/>
      glMaterialf(GL_AMBIENT, RGB15(16,16,16));
<br/>
      glMaterialf(GL_DIFFUSE, RGB15(16,16,16));
<br/>
      glMaterialf(GL_SPECULAR, BIT(15) | RGB15(8,8,8));
<br/>
      glMaterialf(GL_EMISSION, RGB15(16,16,16));
<br/>
<br/>
      //ds uses a table for shinyness..this generates a half-ass one
<br/>
      glMaterialShinyness();
<br/>
      
<br/>
      // Set the current matrix to be the model matrix
<br/>
      glMatrixMode(GL_MODELVIEW);
<br/>
      
<br/>
      //Push our original Matrix onto the stack (save state)
<br/>
      glPushMatrix();   
<br/>
<br/>
      //ds specific, several attributes can be set here   
<br/>
      glPolyFmt(POLY_ALPHA(31) | POLY_CULL_NONE  | POLY_FORMAT_LIGHT0| POLY_FORMAT_LIGHT1| POLY_FORMAT_LIGHT2);
<br/>
      
<br/>
      DrawGLScene();
<br/>
      
<br/>
      // Pop our Matrix from the stack (restore state)
<br/>
      glPopMatrix(1);
<br/>
<br/>
      // flush to screen   
<br/>
      glFlush();
<br/>
      
<br/>
      r=(r+1)%32;
<br/>
      g=(g+1)%32;
<br/>
      b=(b+1)%32;
<br/>
   
<br/>
   }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Why don`t I feel any difference? Can anyone help me?
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126300 - 3D_geek - Sun Apr 22, 2007 12:57 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>trabis wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
      glLight(0, RGB15(r,g,b) , 0,              floattov10(-1.0),       0);
<br/>
      glLight(1, RGB15(r,g,b) , 0,              0,   floattov10(-1.0));
<br/>
      glLight(2, RGB15(r,g,b) , 0,              0,   floattov10(1.0));
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
One problem that's immediately obvious is that you are overflowing the coordinates you pass to your light sources.  The coordinates must fit in 10 bits after floattov10 - and the number +1 doesn't.  Try values like 0.9 instead of 1.0.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126331 - trabis - Sun Apr 22, 2007 11:33 am</h4>
    <div class="postbody"><span class="postbody">I`ve just try it but nothing changes. Thanks for your idea.
<br/>
<br/>
Any other solution?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
