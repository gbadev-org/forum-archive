<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>g++ bloat? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > g++ bloat?</h2>
<div id="posts">
<div class="post">
    <h4>#141215 - Moby Disk - Sun Sep 23, 2007 7:16 am</h4>
    <div class="postbody"><span class="postbody">I took one of the palib demo applications and I renamed the file extension from .c to .cpp.  The resulting output file went from 79k to 135k.  I assume g++ is linking in some unnecessary libraries, but then the linker should remove them if they aren't used.  Anybody know what this is?  It shouldn't be debug info since I added -g0 to the Makefile.
<br/>
<br/>
If I add #include &lt;iostream&gt; it goes up to 389k.  Now that's just silly.
<br/>
<br/>
By comparison, a basic C++ console application using iostream on Windows compiled with MSVC 2005 is 108k.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141234 - kusma - Sun Sep 23, 2007 11:35 am</h4>
    <div class="postbody"><span class="postbody">try adding -fno-rtti and -fno-exceptions to your compile-flags...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141240 - Sunray - Sun Sep 23, 2007 1:14 pm</h4>
    <div class="postbody"><span class="postbody">If you declare static variables inside functions then compile with -fno-threadsafe-statics to reduce the code size significantly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141242 - Moby Disk - Sun Sep 23, 2007 1:44 pm</h4>
    <div class="postbody"><span class="postbody">Tried both, no help.  But they are good to know for the future.  Just for reference, here is the main.cpp:
<br/>
<br/>
#include &lt;iostream&gt;
<br/>
<br/>
int main(int argc, char ** argv)
<br/>
{
<br/>
	return 0;
<br/>
}
<br/>
<br/>
Although I didn't scrub the libnds libraries out of the Makefile, but I don't think that is it since 95% of the space appears when I add #include &lt;iostream&gt;
<br/>
<br/>
I thought ld would remove unused dependencies.  Perhaps ld is unable to do that with the iostream functions for some reason?  Maybe I should try this under some other OS.  Could it be a gcc/ld issue.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141291 - Dood77 - Sun Sep 23, 2007 9:06 pm</h4>
    <div class="postbody"><span class="postbody">iostream is known to add a ton more overhead than stdio...<br/>_________________<br/>If I use a term wrong or something then feel free to correct, I?m not much of a programmer.
<br/>
<span style="font-size: 9px; line-height: normal">
<br/>
Original DS Phat obtained on day of release + flashme v7
<br/>
Supercard: miniSD, Kingston 1GB, Kingston 2GB
<br/>
Ralink chipset PCI NIC
<br/>
</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141367 - sajiimori - Mon Sep 24, 2007 6:49 pm</h4>
    <div class="postbody"><span class="postbody">iostream declares static objects that are initialized before entering main().  The constructors for those objects are therefore always referenced, and the constructors apparently cause just about everything else to link in.
<br/>
<br/>
iostream is a beast -- I'd avoid it for game dev.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
