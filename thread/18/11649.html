<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Looking into the light - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Looking into the light</h2>
<div id="posts">
<div class="post">
    <h4>#108400 - Rajveer - Wed Nov 08, 2006 3:03 pm</h4>
    <div class="postbody"><span class="postbody">Hi guys. I've added light to my game, but whenever I position the camera in a way that it looks towards the light everything goes darker (even the models I'm not using light on). Is this normal or have I screwed around with something? :S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108443 - Payk - Wed Nov 08, 2006 9:18 pm</h4>
    <div class="postbody"><span class="postbody">Maybe some code helps to understand...
<br/>
code from cam, lights, and renderscenes...
<br/>
But indeed a strange thing</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108454 - Rajveer - Wed Nov 08, 2006 11:56 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I'm still fairly new to coding in general and especially with the DS so dont laugh at any newb mistakes! ;)
<br/>
<br/>
FIRST
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   while(1)
<br/>
   {
<br/>
      glReset();
<br/>
<br/>
      glMatrixMode(GL_TEXTURE);
<br/>
      glIdentity();
<br/>
      glPushMatrix();
<br/>
      
<br/>
      glMaterialf(GL_AMBIENT, RGB15(20,20,20));
<br/>
      glMaterialf(GL_DIFFUSE, RGB15(31,31,31));
<br/>
//      glMaterialf(GL_SPECULAR, BIT(15) | RGB15(8,8,8));
<br/>
//      glMaterialf(GL_EMISSION, RGB15(5,5,5));
<br/>
      
<br/>
//      glMaterialShinyness();
<br/>
      
<br/>
      glEnable(GL_ANTIALIAS);      
<br/>
      DrawGLScene();
<br/>
      
<br/>
      glPopMatrix(1);
<br/>
      swiWaitForVBlank();
<br/>
      glFlush();
<br/>
      
<br/>
   }
<br/>
   
<br/>
   return 0;</td> </tr></table><span class="postbody">
<br/>
<br/>
SECOND
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   if(currentCamera == 0)
<br/>
   {
<br/>
      camerapos[0] = player[1].transmatrix[12] - mulf32(20480,player[1].transmatrix[8]) + mulf32(12288,player[1].transmatrix[4]);
<br/>
      camerapos[1] = player[1].transmatrix[13] - mulf32(20480,player[1].transmatrix[9]) + mulf32(12288,player[1].transmatrix[5]);
<br/>
      camerapos[2] = player[1].transmatrix[14] - mulf32(20480,player[1].transmatrix[10]) + mulf32(12288,player[1].transmatrix[6]);
<br/>
<br/>
      cameralook[0] = player[1].transmatrix[12] + mulf32(5000,player[1].transmatrix[4]);
<br/>
      cameralook[1] = player[1].transmatrix[13] + mulf32(5000,player[1].transmatrix[5]);
<br/>
      cameralook[2] = player[1].transmatrix[14] + mulf32(5000,player[1].transmatrix[6]);
<br/>
<br/>
      cameraup[0] = player[1].transmatrix[4];
<br/>
      cameraup[1] = player[1].transmatrix[5];
<br/>
      cameraup[2] = player[1].transmatrix[6];
<br/>
   }
<br/>
   else if(currentCamera == 1)
<br/>
   {
<br/>
      camerapos[0] = player[0].transmatrix[12] - mulf32(20480,player[0].transmatrix[8]) + mulf32(12288,player[0].transmatrix[4]);
<br/>
      camerapos[1] = player[0].transmatrix[13] - mulf32(20480,player[0].transmatrix[9]) + mulf32(12288,player[0].transmatrix[5]);
<br/>
      camerapos[2] = player[0].transmatrix[14] - mulf32(20480,player[0].transmatrix[10]) + mulf32(12288,player[0].transmatrix[6]);
<br/>
<br/>
      cameralook[0] = player[0].transmatrix[12] + mulf32(5000,player[0].transmatrix[4]);
<br/>
      cameralook[1] = player[0].transmatrix[13] + mulf32(5000,player[0].transmatrix[5]);
<br/>
      cameralook[2] = player[0].transmatrix[14] + mulf32(5000,player[0].transmatrix[6]);
<br/>
<br/>
      cameraup[0] = player[0].transmatrix[4];
<br/>
      cameraup[1] = player[0].transmatrix[5];
<br/>
      cameraup[2] = player[0].transmatrix[6];
<br/>
   }
<br/>
   
<br/>
/* SET THE SCENE AND THE CAMERA-----------------------------------------*/
<br/>
//   glOrtho(-40,40,-30,30,0.1,10000);
<br/>
   gluPerspective(38, 256.0 / 192.0, 0.1, 2000);
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glPolyFmt(POLY_ALPHA(31) | POLY_CULL_NONE);
<br/>
   
<br/>
   glLoadIdentity();
<br/>
   gluLookAtf32(camerapos[0], camerapos[1], camerapos[2],cameralook[0],cameralook[1],cameralook[2],cameraup[0],cameraup[1],cameraup[2]);
<br/>
   glLight(0, RGB15(31,31,31) , 0, floattov10(1), 0);
<br/>
<br/>
/* DRAW THE SKYBOX------------------------------------------------------*/
<br/>
   glPushMatrix();
<br/>
   
<br/>
   glTranslate3f32(camerapos[0],camerapos[1],camerapos[2]);
<br/>
   glScalef(90,90,90);
<br/>
   DrawSkybox();
<br/>
   glPopMatrix(1);
<br/>
   
<br/>
/* DRAW THE LEVEL------------------------------------------------------*/
<br/>
   glPolyFmt(POLY_ALPHA(31) | POLY_CULL_NONE | POLY_FORMAT_LIGHT0);
<br/>
   glPushMatrix();
<br/>
<br/>
   glScalef(LevelScale,LevelScale,LevelScale);
<br/>
   DrawLevel1();
<br/>
   glPopMatrix(1);
<br/>
      
<br/>
   glPushMatrix();
<br/>
   
<br/>
   glTranslate3f32(Waypoint1[player[1].currentWaypoint].x, Waypoint1[player[1].currentWaypoint].y, Waypoint1[player[1].currentWaypoint].z);
<br/>
   DrawSkybox();
<br/>
   glPopMatrix(1);
<br/>
<br/>
/* DRAW THE COMPUTER SHIP-----------------------------------------------*/
<br/>
   glPushMatrix();
<br/>
<br/>
   glMultMatrix4x4((m4x4 *)&amp;player[1].transmatrix[0]);
<br/>
   glBindTexture(GL_TEXTURE_2D, shiptextures[0]);
<br/>
   Draw3DS(0);
<br/>
   glBindTexture(0, 0);
<br/>
   glPopMatrix(1);
<br/>
<br/>
/* DRAW THE PLAYER SHIP------------------------------------------------------*/
<br/>
   glPushMatrix();
<br/>
<br/>
   glMultMatrix4x4((m4x4 *)&amp;player[0].transmatrix[0]);
<br/>
   glRotatef32i(player[0].tilt,0,0,4096);
<br/>
   glBindTexture(GL_TEXTURE_2D, shiptextures[0]);
<br/>
   Draw3DS(0);
<br/>
   glBindTexture(0, 0);
<br/>
   glPopMatrix(1);</td> </tr></table><span class="postbody">
<br/>
<br/>
P.S. whats a renderscene?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108461 - Payk - Thu Nov 09, 2006 2:14 am</h4>
    <div class="postbody"><span class="postbody">First of all: i dont laugh....i used float all the time and hat about 10FPS before knowing about fixed point...pppl may laught about me some months ago...Thats why i told you that :D
<br/>
The other thing is that i meaned with the renderscene part...there where u call the normal and vertex functions. Maybe its wrong name for that :D
<br/>
Not sure....english isnt may mother language (as u maybe able to read ;) )
<br/>
...
<br/>
Hmh i dont find the bug ...sorry. But i can see that your arent a n00p at all.Your new to ds, well, but not new to opengl, right?
<br/>
(its late...will watch that tomorow again)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108509 - Rajveer - Thu Nov 09, 2006 6:49 pm</h4>
    <div class="postbody"><span class="postbody">Lol so did I until I realised that the DS cant do float, then I learnt about fixed :-D
<br/>
<br/>
Damn I'm not sure whats wrong with the code, it's a really weird thing thats going on. Cheers for helping anyways Payk :)
<br/>
<br/>
P.S. I'm still a noob, the only other times I've coded are java/pascal in uni and visual basic at college, been teaching myself c and opengl over the summer and been programming on the ds as my first project. It's going well, I've learnt a hell of alot!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
