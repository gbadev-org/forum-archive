<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Using jpg/png files loaded from filesystem in 3d scene? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Using jpg/png files loaded from filesystem in 3d scene?</h2>
<div id="posts">
<div class="post">
    <h4>#173847 - SatNav - Tue May 04, 2010 1:49 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
As the title suggests, I'm trying to find the best way to display a jpeg or png image from disk in a 3d scene. I want to be able to select an image to use as a background in my Rubik's Cube game. I've had a search around, and didn't find anything of much use, but I may have missed something, so apologies if I have.
<br/>
<br/>
I've found pnglib, and libjpeg - I'm guessing I have to use those. would I need to compile them for DS first? once I can actually load in the images, how would I use them in the scene? Would it involve somehow texture-mapping them to the rear poly (or another poly that I draw in manually)? Or is there some easier way that I could just plop them onto the background?
<br/>
<br/>
TIA,
<br/>
Mark<br/>_________________<br/>Cube-DS: A Kick-Ass Rubik's Cube Game for DS
<br/>
<a class="postlink" href="http://cube-ds.googlecode.com" target="_blank">http://cube-ds.googlecode.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173848 - sverx - Tue May 04, 2010 2:35 pm</h4>
    <div class="postbody"><span class="postbody">You can load a jpg using the JPEG Decompression Library for DS kindly provided by HeadSpin, <a class="postlink" href="http://www.headsoft.com.au/index.php?category=nds" target="_blank">here</a>, DS Tools section. Then you could copy the image data into a VRAM bank and use that data as a texture.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173850 - vuurrobin - Tue May 04, 2010 3:42 pm</h4>
    <div class="postbody"><span class="postbody">if the images will always be the same, you can use grit to convert them during compile time. 
<br/>
<br/>
if the images are from users, than you can use one of the portlibs to decompress them during runtime.
<br/>
<br/>
<a href="http://wiki.devkitpro.org/index.php/portlibs" target="_blank">http://wiki.devkitpro.org/index.php/portlibs</a><br/>_________________<br/>my blog:
<br/>
<a href="http://vuurrobin.100webcustomers.com/" target="_blank">http://vuurrobin.100webcustomers.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173860 - Miked0801 - Tue May 04, 2010 9:26 pm</h4>
    <div class="postbody"><span class="postbody">FYI JPEG decompression tends to be very slow in my experience.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173869 - SatNav - Wed May 05, 2010 4:23 pm</h4>
    <div class="postbody"><span class="postbody">Awesome responses, thanks very much :)
<br/>
<br/>
vuurrobin: Yes, the image will be supplied by the user - I thought it would be a nice touch for players to be able to select their own background image to use in the game. And cheers for pointing me to those portlibs, I had no idea they were there - so much for my googling skills!
<br/>
<br/>
Miked: Hmm... how slow is slow? could you maybe give me a guess for, say, a 1024x768? Speed isn't a huge issue, since usually only one jpeg will need to be decompressed per play session, but if it's gonna take more than 3 or 4 seconds I might have to rethink..
<br/>
<br/>
Not looking forward to tackling texture mapping - I've barely even looked at it, past browsing through the devkitpro examples :/<br/>_________________<br/>Cube-DS: A Kick-Ass Rubik's Cube Game for DS
<br/>
<a class="postlink" href="http://cube-ds.googlecode.com" target="_blank">http://cube-ds.googlecode.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173870 - Ruben - Wed May 05, 2010 4:37 pm</h4>
    <div class="postbody"><span class="postbody">Erm.... Why would you want to decompress a 1024x768 image if the screens are only 256x192? o_O</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173872 - SatNav - Wed May 05, 2010 6:19 pm</h4>
    <div class="postbody"><span class="postbody">I don't especially, but it doesn't seem unlikely that a lazy user might find a large jpg somewhere on the interwebs and want to use it without bothering to resize :P<br/>_________________<br/>Cube-DS: A Kick-Ass Rubik's Cube Game for DS
<br/>
<a class="postlink" href="http://cube-ds.googlecode.com" target="_blank">http://cube-ds.googlecode.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173905 - Miked0801 - Fri May 07, 2010 6:50 pm</h4>
    <div class="postbody"><span class="postbody">I can't say exactly as it varies a ton per library - though the DS has a DSP that can hardware accelerate this, though I'm not sure how much support there is for this in hobbiest land.
<br/>
<br/>
I wouldn't be surprised to see a 256x192 image take 1 second to decompress.  A 1024x768 - well, you'd probably run out of RAM and patience before it was done. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173968 - sverx - Mon May 10, 2010 10:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">I wouldn't be surprised to see a 256x192 image take 1 second to decompress.</td> </tr></table><span class="postbody">
<br/>
<br/>
No, it's faster. Check Cydrak <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=159501#159501" target="_blank">18 bpp display demo</a>.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173983 - Miked0801 - Mon May 10, 2010 7:36 pm</h4>
    <div class="postbody"><span class="postbody">Excellent then - again I haven't had to decompress a JPG outside of APIs for quite a while so I had no frame of refernce since GBA days.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174066 - dheart88 - Sun May 16, 2010 10:48 pm</h4>
    <div class="postbody"><span class="postbody">Well, grit provided with Devkitpro chain tool... Actually i use gfx2gba to create an image into these files:
<br/>
<br/>
bgPal.bin
<br/>
bgTiles.bin
<br/>
bgMap.bin
<br/>
<br/>
after that just load all of them in their pointer, pal in background palette, Tiles in background tiles and Map in background map.. 
<br/>
--------------------------------------------------------
<br/>
It's not hard to combine 2 BG (1 3D and 1 2D), if you put the 3D in bg0 and 2D in yourBGhere:
<br/>
<br/>
bgPriority(bg0,1);
<br/>
bgPriority(yourBGhere,0);
<br/>
<br/>
you also can stay in only 1 bg 3D, by inserting a quad that will fit your screen and then change your view with glulookat() to change the view before rendering your model</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
