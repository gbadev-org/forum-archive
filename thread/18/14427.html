<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How the official roms read and write on the cartridge? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > How the official roms read and write on the cartridge?</h2>
<div id="posts">
<div class="post">
    <h4>#144203 - Yota_VGA - Tue Oct 30, 2007 3:37 am</h4>
    <div class="postbody"><span class="postbody">Hi, I'm new in this community.
<br/>
<br/>
I understand that actually is almost impossible to use the commands 
<br/>
that are used for read and write the official cartridges in an homebrew, but I 
<br/>
don't understand why.
<br/>
<br/>
If you have a slot-1 card, for example the R4, you can (obiously if legal) use 
<br/>
almost all the roms fetched from the official cartridges, but if you run 
<br/>
a homebrew that use the "standard commands" with this card it seem that does not work. So I suppose that the problem is the crypt system of the DS.
<br/>
I've read some technical information on this crypt system, but I don't
<br/>
full understand how all the things work.
<br/>
<br/>
How can an official game read the cartridge?
<br/>
Which are the differences between a rom fetched from an official 
<br/>
cartridge and an homebrew, expecially with regard to reading and writing on rom?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144208 - tepples - Tue Oct 30, 2007 4:26 am</h4>
    <div class="postbody"><span class="postbody">Commercial games use the Nitro SDK to read files from the Game Card. How does knowing how to read commercial Game Cards help you to develop original homebrew games?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144210 - Yota_VGA - Tue Oct 30, 2007 4:41 am</h4>
    <div class="postbody"><span class="postbody">I know that commercial games use the Nitro SDK, but how the Nitro SDK manage the cartridge? :)
<br/>
<br/>
However, this is mainly a my curiosity, but the DMA reading and some other things are useful sometimes, I think.
<br/>
I know that many cartridges have some commands very similar to the corrispective commands used from the official cartridges, but these aren't portable :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144211 - tepples - Tue Oct 30, 2007 4:56 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Yota_VGA wrote:</b></span></td> </tr> <tr> <td class="quote">I know that commercial games use the Nitro SDK, but how the Nitro SDK manage the cartridge? :)</td> </tr></table><span class="postbody">
<br/>
In a different way from how homebrew programs manage the cartridge. This is documented in GBATEK by Martin Korth.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I know that many cartridges have some commands very similar to the corrispective commands used from the official cartridges, but these aren't portable :)</td> </tr></table><span class="postbody">
<br/>
That's why libfat has <a class="postlink" href="http://dldi.drunkencoders.com/index.php?title=Main_Page" target="_blank">DLDI</a>. It abstracts over the ways that different flash devices implement "read sector" and "write sector", so all you have to worry about are fopen(), fread(), and fclose().<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144234 - Yota_VGA - Tue Oct 30, 2007 4:09 pm</h4>
    <div class="postbody"><span class="postbody">Yes, I've read GBATEK, but I don't understand how the crypt work.
<br/>
I think that the cartridge is readed whitout encryption by the official cartridges, but why the cartridges can read the card whitout encription and the homebrew can't?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">That's why libfat has <a class="postlink" href="http://dldi.drunkencoders.com/index.php?title=Main_Page" target="_blank">DLDI</a>. It abstracts over the ways that different flash devices implement "read sector" and "write sector", so all you have to worry about are fopen(), fread(), and fclose().</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, but you can't use some things, for example the DMA channel.
<br/>
libfat and DLDI are surely a great alternative, and I think that this is better than NitroSDK for many purposes, but in some circumstances I think that isn't it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144249 - tepples - Tue Oct 30, 2007 9:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Yota_VGA wrote:</b></span></td> </tr> <tr> <td class="quote">Yes, I've read GBATEK, but I don't understand how the crypt work.
<br/>
I think that the cartridge is readed whitout encryption by the official cartridges, but why the cartridges can read the card whitout encription and the homebrew can't?</td> </tr></table><span class="postbody">
<br/>
There are two layers of encryption: cart protocol encryption and the encryption of the secure area. The cart protocol encryption, once it is turned on, is handled transparently by the DS hardware. The "secure area" of a DS card, which contains some of the executable code, is actually encrypted on the ROM chip and decrypted by the BIOS before the firmware gets control.
<br/>
<br/>
(Brought to you by <a class="postlink" href="http://en.wikipedia.org/wiki/WP:AGF" target="_blank">AGF</a>.)<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144253 - Yota_VGA - Tue Oct 30, 2007 10:38 pm</h4>
    <div class="postbody"><span class="postbody">Mh, so a homebrew can't turn on the cartridge encryption and so it don't read a cartridge?
<br/>
If all work in this manner I understand all.
<br/>
<br/>
Thanks for the precious help :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144256 - Lick - Tue Oct 30, 2007 10:42 pm</h4>
    <div class="postbody"><span class="postbody">Homebrew software CAN initialize the card, but it requires the card to be re-inserted, and you need to know how the procedure works.
<br/>
<br/>
Because that procedure is rather complicated (and requires re-insertion), homebrew device manufacturers simply opted to supply us with libfat-compatible procedures, so we can just use libfat.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#144258 - Yota_VGA - Tue Oct 30, 2007 10:46 pm</h4>
    <div class="postbody"><span class="postbody">Oh, ok :D
<br/>
<br/>
Thanks so much, all clear now :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
