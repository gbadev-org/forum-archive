<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>libmad on Windows - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > libmad on Windows</h2>
<div id="posts">
<div class="post">
    <h4>#113995 - zon7 - Tue Jan 02, 2007 2:37 pm</h4>
    <div class="postbody"><span class="postbody">Hi. I'm trying to get libmad working on a project, but I'm stuck trying to link to libmad.
<br/>
I supose I must build the lib first, but I don't know how. I0ve searched over the forum and found this post.
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=11048" target="_blank">http://forum.gbadev.org/viewtopic.php?t=11048</a>
<br/>
But it's for linux.
<br/>
<br/>
Actually, I get this errors:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-eabi-gcc -MMD -MP -MF /c/devkitPro/examples/nds/TouchTest9/build/layer12.d -Wall -O2 -mcpu=arm9tdmi -mtune=arm9tdmi -fomit-frame-pointer -ffast-math -mthumb -mthumb-interwork -I/c/devkitPro/examples/nds/TouchTest9/include -I/c/devkitPro/examples/nds/TouchTest9/build -I/c/devkitPro/libnds/include -I/c/devkitPro/libnds/include -I/c/devkitPro/examples/nds/TouchTest9/build -DARM9 -DFPM_ARM -DASO_INTERLEAVE1 -DASO_IMDCT -DOPT_ACCURACY -c /c/devkitPro/examples/nds/TouchTest9/source/libmad/layer12.c -o layer12.o
<br/>
C:/DOCUME~1/zon7/CONFIG~1/Temp/ccUnAz2v.s: Assembler messages:
<br/>
C:/DOCUME~1/zon7/CONFIG~1/Temp/ccUnAz2v.s:58: Error: selected processor does not support `smull r1,ip,r2,r3'
<br/>
C:/DOCUME~1/zon7/CONFIG~1/Temp/ccUnAz2v.s:60: Error: unshifted register required -- `adc r3,r1,ip,lsl#4
<br/>
...'</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114004 - Mighty Max - Tue Jan 02, 2007 5:06 pm</h4>
    <div class="postbody"><span class="postbody">Dont use the imdct_l_arm.s 
<br/>
<br/>
It is utilizing an arm that has an fpu, which the DS hasn't.
<br/>
<br/>
Dont set "FPM_ARM"<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114061 - zon7 - Wed Jan 03, 2007 12:42 pm</h4>
    <div class="postbody"><span class="postbody">Well, now it compiles, but I run out of ideas. So I took the Moonshell code and give it a try.
<br/>
The problem is with the interrupt handler.It uses register IE and IF. Both of them are not declared and I have searched for them in the devkitarm with no luck.
<br/>
Is there a new name in r19 or I miss something?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114062 - Mighty Max - Wed Jan 03, 2007 12:47 pm</h4>
    <div class="postbody"><span class="postbody">They got renamed to REG_IE, REG_IF to match the naming sheme.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114067 - zon7 - Wed Jan 03, 2007 2:05 pm</h4>
    <div class="postbody"><span class="postbody">hehehe, I figured it. Now I only got error in this line
<br/>
IPC_SYNC=IPC_SYNC_IRQ_ENABLE;
<br/>
<br/>
I have searched in the CVS and found that now its called REG_IPC_SYNC
<br/>
Now it compiles ok but no sound.
<br/>
Actually it doesnt enter the update if into the InterruptHandler.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void InterruptHandler(void) {
<br/>
    u32 flags = REG_IF;
<br/>
<br/>
  if(flags&amp;IRQ_IPC_SYNC){
<br/>
   iprintf("\nHOlA");
<br/>
    strpcmUpdate();
<br/>
    REG_IF = IRQ_IPC_SYNC;
<br/>
    return;
<br/>
  }
<br/>
<br/>
    if (flags &amp; IRQ_VBLANK) {
<br/>
        VBLANK_INTR_WAIT_FLAGS=IRQ_VBLANK;
<br/>
        REG_IF = IRQ_VBLANK;
<br/>
        return;
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
So IRQ_IPC_SYNC is never activated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114070 - zon7 - Wed Jan 03, 2007 2:43 pm</h4>
    <div class="postbody"><span class="postbody">I have uploaded the code so someone could find the error.
<br/>
<a class="postlink" href="https://www.alu.ua.es/j/jma27/nds/Test.zip" target="_blank">https://www.alu.ua.es/j/jma27/nds/Test.zip</a>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114071 - Mighty Max - Wed Jan 03, 2007 3:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<span style="font-weight: bold">Authorization Required</span>
<br/>
This server could not verify that you are authorized to access the document requested. Either you supplied the wrong credentials (e.g., bad password), or your browser doesn't understand how to supply the credentials required.
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114077 - zon7 - Wed Jan 03, 2007 5:46 pm</h4>
    <div class="postbody"><span class="postbody">Ups, I put an s :P
<br/>
<br/>
<a class="postlink" href="http://www.alu.ua.es/j/jma27/nds/Test.zip" target="_blank">http://www.alu.ua.es/j/jma27/nds/Test.zip</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114080 - Mighty Max - Wed Jan 03, 2007 6:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_IF = IRQ_IPC_SYNC;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
in InitInterrupts should have been REG_IE=...
<br/>
<br/>
Using the irqInit/irqSet/irqEnable functions of libnds could be usefull ;)<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114100 - zon7 - Wed Jan 03, 2007 11:57 pm</h4>
    <div class="postbody"><span class="postbody">Well, that was a line I wrote there to activate the Sync bit at the beginning but it did't work. I checked the code and it had other things not corrected.
<br/>
I have uploaded it again with the original Moonshell code and the register and irq names updated to r19. But it still doesn't work.
<br/>
Same link as above</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114102 - Mighty Max - Thu Jan 04, 2007 12:15 am</h4>
    <div class="postbody"><span class="postbody">I have overseen that last time, but where is the arm7 code?
<br/>
<br/>
The default arm7 bin does not do anything with the FIFO. So you'll wait forever for an sync to happen when it never gets triggered from the other side.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114110 - zon7 - Thu Jan 04, 2007 2:26 am</h4>
    <div class="postbody"><span class="postbody">hehehe.
<br/>
I have begin with the ndsexamples code. Is there anyway to add the arm7 files and to compile arm7 and arm9 separated?
<br/>
I'm using the programmers Notepad :P
<br/>
To lazy to boot on linux.
<br/>
thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114111 - zon7 - Thu Jan 04, 2007 2:40 am</h4>
    <div class="postbody"><span class="postbody">Well, finally have it working!
<br/>
Thanks a lot Mighty Max.
<br/>
If anyone wants the code (is the moonshell original code but tweaked to work on r19, no many changes.) I can upload it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114283 - Jevin - Sat Jan 06, 2007 6:36 am</h4>
    <div class="postbody"><span class="postbody">Please do! I would like to use it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#114606 - zon7 - Tue Jan 09, 2007 1:09 pm</h4>
    <div class="postbody"><span class="postbody">Sorry but I've been out last weekend
<br/>
Here you have the code uploaded.
<br/>
<a class="postlink" href="http://www.alu.ua.es/j/jma27/nds/20050807_mp3playtestVA.zip" target="_blank">http://www.alu.ua.es/j/jma27/nds/20050807_mp3playtestVA.zip</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
