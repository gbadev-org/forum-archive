<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>pthreads with devkitARM - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > pthreads with devkitARM</h2>
<div id="posts">
<div class="post">
    <h4>#168880 - BlazerRazor - Mon Jun 01, 2009 4:22 pm</h4>
    <div class="postbody"><span class="postbody">Hello fellow coders,
<br/>
<br/>
Do any of you know if it is possible to use POSIX threads on the Nintendo DS with devkitARM?
<br/>
I've been looking around in the devkitARM directory and I can find a header, pthread.h, and it seems to be implemented.
<br/>
<br/>
The problem I am experiencing is that when I try compiling my code I get a "error: 'pthread_t' undeclared (first use in this function)" when declaring the usual pthread_t. I have included the pthread.h but I does not work.
<br/>
<br/>
Any suggestions or solutions would be greatly appreciated!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168881 - wintermute - Mon Jun 01, 2009 4:57 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, devkitARM does not support threading.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168887 - samel - Mon Jun 01, 2009 5:55 pm</h4>
    <div class="postbody"><span class="postbody">Here you can find thread for the DS.
<br/>
<br/>
<a href="http://donotjava.netsons.org/?page_id=67" target="_blank">http://donotjava.netsons.org/?page_id=67</a>
<br/>
<br/>
Feel free to ask, test and use 8)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168894 - BlazerRazor - Mon Jun 01, 2009 8:45 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the replies, really appreciate it!
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>samel wrote:</b></span></td> </tr> <tr> <td class="quote">Here you can find thread for the DS.
<br/>
<br/>
<a href="http://donotjava.netsons.org/?page_id=67" target="_blank">http://donotjava.netsons.org/?page_id=67</a>
<br/>
<br/>
Feel free to ask, test and use 8)</td> </tr></table><span class="postbody">
<br/>
Wow, very cool and nice! Thanks!
<br/>
<br/>
You have any example? Just a simple thread test using the library.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168897 - wintermute - Mon Jun 01, 2009 10:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>samel wrote:</b></span></td> </tr> <tr> <td class="quote">Here you can find thread for the DS.
<br/>
<br/>
<a href="http://donotjava.netsons.org/?page_id=67" target="_blank">http://donotjava.netsons.org/?page_id=67</a>
<br/>
<br/>
Feel free to ask, test and use 8)</td> </tr></table><span class="postbody">
<br/>
<br/>
Please do not use this, the toolchain <span style="font-weight: bold">does not</span> support threading. Bad things <span style="font-weight: bold">will</span> happen.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168898 - samel - Mon Jun 01, 2009 10:18 pm</h4>
    <div class="postbody"><span class="postbody">@wintermute
<br/>
Can you explain why? I've used it with r21 and it work well. May be with newer version you have to modify something, but I don't think "Bad things will happen".
<br/>
<br/>
@BlazerRazor
<br/>
There is an example in the zip file, take a look at main9.c</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168900 - wintermute - Mon Jun 01, 2009 10:42 pm</h4>
    <div class="postbody"><span class="postbody">Without threading support in the toolchain any attempt to use threads on the DS <span style="font-weight: bold">will</span> fail at some point. Many libc functions are not re-entrant which will cause all sorts of interesting issues.
<br/>
<br/>
Primarily, stdio will cause stupendous crashes with threads.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168901 - samel - Mon Jun 01, 2009 10:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Without threading support in the toolchain any attempt to use threads on the DS <span style="font-weight: bold">will</span> fail at some point.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So you never use interrupt on the DS? That's basicaly the same idea as thread .... you <span style="font-weight: bold">can</span> use thread on the DS as long as you write the appropiate code.
<br/>
Well, not posix thread, but something like that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Many libc functions are not re-entrant which will cause all sorts of interesting issues.
<br/>
<br/>
Primarily, stdio will cause stupendous crashes with threads.</td> </tr></table><span class="postbody">
<br/>
<br/>
As I said before:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>samel wrote:</b></span></td> </tr> <tr> <td class="quote">May be with newer version you have to modify something, but I don't think "Bad things will happen". 
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168902 - wintermute - Mon Jun 01, 2009 11:09 pm</h4>
    <div class="postbody"><span class="postbody">Interrupts and threads are two entirely different things.
<br/>
<br/>
Threads on the DS are inappropriate due to lack of toolchain support and the impact on execution speed due to the need to place the stack in slow RAM.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168903 - samel - Mon Jun 01, 2009 11:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Interrupts and threads are two entirely different things.
<br/>
<br/>
Threads on the DS are inappropriate due to lack of toolchain support and the impact on execution speed due to the need to place the stack in slow RAM.</td> </tr></table><span class="postbody">
<br/>
<br/>
You're right, but that's a dirty replacement 8)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168905 - BlazerRazor - Mon Jun 01, 2009 11:37 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the talk guys :D
<br/>
<br/>
I have decided not to use any threads, but the reason I ask for threads was because I am currently working on a client-server remote mouse and keyboard control application and I need to send both UDP and TCP packages at the same time. I guess I'll drop that idea and find another appropriate way of doing this.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168906 - samel - Mon Jun 01, 2009 11:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>BlazerRazor wrote:</b></span></td> </tr> <tr> <td class="quote">Thanks for the talk guys :D
<br/>
<br/>
I have decided not to use any threads, but the reason I ask for threads was because I am currently working on a client-server remote mouse and keyboard control application and I need to send both UDP and TCP packages at the same time. I guess I'll drop that idea and find another appropriate way of doing this.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ok, you made the right choose. 8)))))))
<br/>
That's not a good idea to use ThreaDS for network comunication.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168907 - Pete_Lockwood - Tue Jun 02, 2009 1:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>BlazerRazor wrote:</b></span></td> </tr> <tr> <td class="quote">I need to send both UDP and TCP packages at the same time. I guess I'll drop that idea and find another appropriate way of doing this.</td> </tr></table><span class="postbody">
<br/>
<br/>
Nothing stops you doing this without threads.  Use non-blocking sockets and calls to select().<br/>_________________<br/>It's not an illusion, it just looks like one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168908 - Dwedit - Tue Jun 02, 2009 1:26 am</h4>
    <div class="postbody"><span class="postbody">How about some kind of simple round robin thread system that uses an IRQ or Yield call to switch to another thread?
<br/>
Just need to support threads yielding to wait for IRQ or something like that.
<br/>
<br/>
All you really need for a context switch is to move the PC and stack around, and set a number or something to indicate which thread you are currently running.  For example, if you know you can get by with a 1K stack, use that.
<br/>
<br/>
Just don't call any LIBC functions from both threads, not even malloc.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168910 - elwing - Tue Jun 02, 2009 6:50 am</h4>
    <div class="postbody"><span class="postbody">what about <a class="postlink" href="http://www.sics.se/~adam/pt/" target="_blank">http://www.sics.se/~adam/pt/</a> ?
<br/>
it's not thread as you generally use the term, but it should simplify a game engine coding, no?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
