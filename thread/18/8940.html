<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Format of compressed textures? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Format of compressed textures?</h2>
<div id="posts">
<div class="post">
    <h4>#75910 - EyeballKid - Thu Mar 16, 2006 11:17 pm</h4>
    <div class="postbody"><span class="postbody">Does anyone have any info on the format for compressed textures on the DS?
<br/>
I've been scouring the web for clues, but no joy so far :-(
<br/>
<br/>
Thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75925 - tepples - Fri Mar 17, 2006 1:11 am</h4>
    <div class="postbody"><span class="postbody">What you think of as texture compression might just be 16-color indexed textures.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75979 - sasq - Fri Mar 17, 2006 9:36 am</h4>
    <div class="postbody"><span class="postbody">No, its basically a texture divided into 4x4 blocks with 2 bits per pixel and one 4 color palette per block. Not completey clear on how you should place it in VRAM though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75982 - EyeballKid - Fri Mar 17, 2006 10:36 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sasq wrote:</b></span></td> </tr> <tr> <td class="quote">No, its basically a texture divided into 4x4 blocks with 2 bits per pixel and one 4 color palette per block. Not completey clear on how you should place it in VRAM though.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ahh... cool! maybe it's S3TC format?
<br/>
<a href="http://www.hardwarecentral.com/hardwarecentral/reports/140/4/" target="_blank">http://www.hardwarecentral.com/hardwarecentral/reports/140/4/</a>
<br/>
<br/>
As you described, except only two colours in the palette are stored, with the other two being derived by interpolation...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75998 - sasq - Fri Mar 17, 2006 3:05 pm</h4>
    <div class="postbody"><span class="postbody">yes it seems to be S3TC more or less... for each block you can decide if you want to specify only 2 colors and interpolate the other two, or specify 4 individual colors...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76038 - tepples - Fri Mar 17, 2006 10:07 pm</h4>
    <div class="postbody"><span class="postbody">The GameCube is known to use S3TC. Given parallels between GameCube and DS 3D in other ways, I'd expect the DS to also support S3TC.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77063 - masscat - Mon Mar 27, 2006 10:06 pm</h4>
    <div class="postbody"><span class="postbody">I have been playing around trying to figure out how to use compressed textures.
<br/>
The texel data and palette are seperate. As said above, each texel is 2 bits which forms the index into the palette.
<br/>
The following shows how a byte array of texture data would appear on screen (assuming a one to one mapping between texel and pixel) when it is copied into VRAM using the glTexImage2D function. Each byte is shown split into the 2bit fields.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">unsigned char texture_data[] = { (a,b,c,d), (e,f,g,h), (i,j,k,l), (m,n,o,p), (q,r,s,t), (u,v,w,x), .......}
<br/>
<br/>
Appearance on screen:
<br/>
<br/>
d, c, b, a, t, s, r, q, ...........
<br/>
h, g, f, e, x, w, v, u, ...........
<br/>
l, k, j, i, ...........
<br/>
p, o, n, m, ...........
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The palette is not working for me. The first four entries are being used as the palette for all 4x4 texel groups. Any texel with the value 11 is actually transparent.
<br/>
Anybody know how to handle the palette?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77119 - EyeballKid - Tue Mar 28, 2006 12:12 pm</h4>
    <div class="postbody"><span class="postbody">How are you treating the palette currently?
<br/>
<br/>
From what I can tell, the other paletted texture formats reference a palette residing in another VRAM bank. I wonder if the compressed texture format also uses a separate palette or an "inline" palette (like S3TC, where 2 RGB values follow each 4x4 block of pixels)...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#77122 - masscat - Tue Mar 28, 2006 1:04 pm</h4>
    <div class="postbody"><span class="postbody">I have set up the palette as 4 16bit values per 4x4 texel block just as an array. I copy these into VRAM using the glTexLoadPal. Since I only have one texture and one palette I am assuming the palette gets copied into VRAM bank E.
<br/>
<br/>
If I do not copy the palette, I get colours for indices 00, 01 and 10 as black and 11 as transparent. I imagine this is because the VRAM bank has been zeroed at some point.
<br/>
<br/>
From my experiments, I believe the palette is seperate in a similar way to normal palette textures.
<br/>
<br/>
The code is based on one of the examples from libnds. You can download it from <a class="postlink" href="http://masscat.afraid.org/ninds/tars/3Dtest.tar.bz" target="_blank">here</a>.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
