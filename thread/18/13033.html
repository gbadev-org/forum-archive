<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Stupid Question: Max. Polycount 2048 or 4096? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Stupid Question: Max. Polycount 2048 or 4096?</h2>
<div id="posts">
<div class="post">
    <h4>#126177 - Mifheu - Fri Apr 20, 2007 5:56 pm</h4>
    <div class="postbody"><span class="postbody">I'am currently in the planning stage for a DS game and I'd like to know, if the DS can really draw ~4000 polys when the game is running at 30fps. I searched around the net and got lots of different informations. As far as I know, the DS can render ~2048 polys/6144 verts at 60fps depending on the kind your mesh is build (polystrips/quads and so on). But I also heard, it is possible to double the polycount to 4096 polys by dropping the framerate to 30fps and use some tricks.
<br/>
I'd really like to know, if this is true, because I want the right informations for my concept and my prototype graphics, so I can do right planning for the graphics and the stages. And of course it would be bad to tell bullsh.t to potential publishers in the fist place. :)
<br/>
Can anyone clarify this? Thanx!<br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126187 - dovoto - Fri Apr 20, 2007 7:36 pm</h4>
    <div class="postbody"><span class="postbody">You cannot really increase the poly count by droping the frame rate as the DS only has enough room in its vertex buffers for 2048 triangles.
<br/>
<br/>
What you can do however is to render a frame and capture it to vram then render another frame on top.  With careful compositing you can effectivly get twice the polies.  For instance you could render the terain in one pass and the objects in another for an outdoor scene.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126190 - Mifheu - Fri Apr 20, 2007 7:52 pm</h4>
    <div class="postbody"><span class="postbody">Thanx alot.
<br/>
Just a few hours later I found a description on how to "increase" the polycount. May just work for my concept. On the other hand, as far as I understand this technique, it means you lose a memorybank, which is not so nice ;-)<br/>_________________<br/>Simplicity is the most complex topic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126212 - Dood77 - Sat Apr 21, 2007 1:04 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dovoto wrote:</b></span></td> </tr> <tr> <td class="quote">What you can do however is to render a frame and capture it to vram then render another frame on top.  With careful compositing you can effectivly get twice the polies.  For instance you could render the terain in one pass and the objects in another for an outdoor scene.</td> </tr></table><span class="postbody">
<br/>
Heh, so you're effectively running at 60fps, but using every other frame for graphics enhancements and holding them back a frame, so really its 30fps...?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126223 - M3d10n - Sat Apr 21, 2007 2:35 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dovoto wrote:</b></span></td> </tr> <tr> <td class="quote">What you can do however is to render a frame and capture it to vram then render another frame on top.  With careful compositing you can effectivly get twice the polies.  For instance you could render the terain in one pass and the objects in another for an outdoor scene.</td> </tr></table><span class="postbody">
<br/>
<br/>
But there's no way to preserve the depth buffer between each pass, is there? 
<br/>
<br/>
If not, wouldn't it be safer and easier to change the near and far clipping planes in each pass and split the scene in distant/nearby geometry? It would generate a few more polygons due to the clipping, though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126272 - 3D_geek - Sat Apr 21, 2007 4:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">But there's no way to preserve the depth buffer between each pass, is there?</td> </tr></table><span class="postbody">
<br/>
<br/>
No - I'm pretty sure the NDS doesn't even <span style="font-style: italic">have</span> a depth buffer in the conventional sense. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">If not, wouldn't it be safer and easier to change the near and far clipping planes in each pass and split the scene in distant/nearby geometry? It would generate a few more polygons due to the clipping, though.</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm not sure whether it clips before or after the 2048 triangle buffer - if it's before then what you propose is a really good way to go - it it's after then you're still screwed.
<br/>
<br/>
But either way, the worst problem (in a very dynamic game) is knowing where to split the Z depth to ensure that no part of the scene blows the limit - without range-sorting, you can't ever know.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126273 - tepples - Sat Apr 21, 2007 5:02 pm</h4>
    <div class="postbody"><span class="postbody">If you can sort most of your geometry before sending it to the GTE, you can split it into a back frame and a front frame, and nobody will notice slight coverage errors at the "crack" between the two passes. For instance, in a game like <span style="font-style: italic">Animal Crossing: Wild World</span>, where the camera is always at the south, you can draw the north half of the visible acre in one frame and the south half in the next.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126296 - LiraNuna - Sat Apr 21, 2007 10:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You cannot really increase the poly count by droping the frame rate as the DS only has enough room in its vertex buffers for 2048 triangles. </td> </tr></table><span class="postbody">
<br/>
<br/>
2048 triangles? the GBA's ARM7 can draw more then that with it's eyes closed and hands behind it's back. Just check kusma's _amazing_ engine (shift faced clowns).
<br/>
<a class="postlink" href="http://pouet.net/groups.php?which=4843&amp;order=release" target="_blank">Just look at their (his?) engine growing, doing much better then the DS's HW 3D. </a>
<br/>
<br/>
/me looks at the DS's box, which says something about 'stunning' 3D graphics
<br/>
<br/>
&lt;/rant&gt;<br/>_________________<br/>Private property.
<br/>
Violators will be shot, survivors will be shot again.</span><span class="gensmall"><br/><br/>Last edited by LiraNuna on Sun Apr 22, 2007 11:55 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#126298 - 3D_geek - Sun Apr 22, 2007 12:41 am</h4>
    <div class="postbody"><span class="postbody">That's a REALLY outrageous claim...and it can't go unanswered.
<br/>
<br/>
The NDS's 3D processor can draw 2048 large-area, depth-sorted, textured, fogged, alpha-blended, transformed and lit (with four coloured light sources) triangles at 60Hz frame rates.
<br/>
<br/>
With the ARM7, you have a 33MHz clock - at 2048 triangles and 60Hz, that's 268 CPU clock cycles per triangle - perhaps just barely enough for a minimal rotate/translate/perspect/clip/light providing vertices are shared between triangles efficiently.  But you've also got to fill the pixels - and at 256x192 pixels resolution and 60 Hz frame rate (which the 3D processor maintains very solidly), you have a whole 11 clock cycles per pixel - and that's assuming you are using zero time for your per-vertex operations...which you are most certainly not!  That's not enough to do even one true perspective texture lookup - let alone fogging, blending, edge antialiasing and all of the other things the NDS's 3D processor can do at pixel rates - and that;s assuming you only have one layer of pixels covering the screen - with is a completely unreasonable thing.
<br/>
<br/>
You may be able to find some suitably crippled 3D rendering mode that'll get you 2048 triangles at 60 frames per second - but not with all of the bells and whistles you need for serious 3D gaming.
<br/>
<br/>
So please - lets have none of these outrageous claims.  You can't possibly come even close to doing 2048 "usefully rendered" 3D triangles at 60Hz on the ARM7 - you can do that quite easily on the ARM9+3D-copro - end of story.
<br/>
<br/>
Geez - do you really think Nintendo would have gone to all of that development expense if the new machine was spec'ed no better than a GBA?
<br/>
<br/>
Get real.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126310 - tepples - Sun Apr 22, 2007 2:39 am</h4>
    <div class="postbody"><span class="postbody">The Shitfaced Clowns demos, such as Newton and FFD, run at about 12 fps. In fact, they overclock the GBA ROM to 2/1 wait to do it. That's why they also come in a patched version for F2A and other slower GBA cards that only support 3/1, and why they don't stand a chance of running on a SuperCard.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126319 - DekuTree64 - Sun Apr 22, 2007 5:16 am</h4>
    <div class="postbody"><span class="postbody">It would be interesting to see a game that runs more or less entirely on ARM7, using ARM9 as a software rendering powerhouse. That way you get cache for textures, and "free" division.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126329 - kusma - Sun Apr 22, 2007 11:13 am</h4>
    <div class="postbody"><span class="postbody">The Shitfaced Clowns engine does not run anywhere near 2048 polys at 60 fps. It's a pretty basic scan-converting 3d engine with some neat hacks (like anti aliasing). On the DS you have three processors running in parallel, and not using one of them would be plain stupid. So, while you'll most likely have to live with the 2048-poly limit, you can spend the free cpu cycles on other useful things.
<br/>
<br/>
edit: Also keep in mind that this is 2048 visible polygons. That's actually quite a lot.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126355 - tepples - Sun Apr 22, 2007 4:17 pm</h4>
    <div class="postbody"><span class="postbody">So if you include polygons that face away from the camera in your scene's triangle count, the limit does come closer to 4096 triangles. You can inflate this further if you can find <span style="font-style: italic">quads,</span> or pairs of triangles that share a side and have coplanar vertices. A quad takes up 4/3 of the space of a triangle in vertex RAM, compared to the equivalent triangles that take up 2 triangles.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126367 - silent_code - Sun Apr 22, 2007 6:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mifheu wrote:</b></span></td> </tr> <tr> <td class="quote">Just a few hours later I found a description on how to "increase" the polycount. </td> </tr></table><span class="postbody">
<br/>
<br/>
so, where did you find it? share the information with us. ;^)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126373 - HyperHacker - Sun Apr 22, 2007 6:53 pm</h4>
    <div class="postbody"><span class="postbody">Keep in mind too: you could use that nice CPU power on the ARM7 and ARM9 to do software rendering while simultaneously doing hardware rendering with the GPU. kusma said it best: you have 3 processors, why ignore one?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126378 - tepples - Sun Apr 22, 2007 7:09 pm</h4>
    <div class="postbody"><span class="postbody">Hardware and software rendered objects cannot occlude each other. You can have a software background, a hardware middle, and a software foreground, but you can't have software-rendered objects in the middle of hardware-rendered objects.
<br/>
<br/>
Another thing you can do is use the 3D hardware to render with capture and, in the next frame, display the captured textures as sprites using the 2D core. This sort of resembles the way <span style="font-style: italic">Tony Hawk's Pro Skater</span> games for GBA worked. If you do it right, you might not lose overall 60fps even if you do lose 60fps for individual sprites.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126385 - HyperHacker - Sun Apr 22, 2007 7:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Hardware and software rendered objects cannot occlude each other. You can have a software background, a hardware middle, and a software foreground, but you can't have software-rendered objects in the middle of hardware-rendered objects.</td> </tr></table><span class="postbody">No, but you could e.g. software-render parts of your scene as a texture, using one hardware polygon to display a number of software polygons. It all really depends on your scene what can be done.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126386 - kusma - Sun Apr 22, 2007 7:34 pm</h4>
    <div class="postbody"><span class="postbody">or how about doing texture-space effects on the ARM9 for the next GPU frame?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126509 - M3d10n - Mon Apr 23, 2007 11:09 pm</h4>
    <div class="postbody"><span class="postbody">Tepples, maybe you could use a software renderer to draw impostors for distant objects and maybe even characters, and then mix those with the actual HW 3D stuff using screen aligned quads?
<br/>
<br/>
Such objects will require little fillrate due to the small rendered region, but would consume valuable polygons if rendered using the 3D hardware.
<br/>
<br/>
Actually I suspect that Dragon Quest Monster game already does that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126512 - tepples - Tue Apr 24, 2007 12:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>M3d10n wrote:</b></span></td> </tr> <tr> <td class="quote">Tepples, maybe you could use a software renderer to draw impostors for distant objects and maybe even characters, and then mix those with the actual HW 3D stuff using screen aligned quads?
<br/>
<br/>
Such objects will require little fillrate due to the small rendered region, but would consume valuable polygons if rendered using the 3D hardware.
<br/>
<br/>
Actually I suspect that Dragon Quest Monster game already does that.</td> </tr></table><span class="postbody">
<br/>
So does Animal Crossing.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126956 - Marcel24 - Sat Apr 28, 2007 12:27 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
maybe we can get over the 2048 poly limit..
<br/>
<br/>
We have 6144 vertex ram for 2048 polys.
<br/>
<br/>
What happends if we use TRIANGLE_STRIPS for saving some vertex's ?
<br/>
<br/>
can we then go throw the limit ?
<br/>
<br/>
just a thought..
<br/>
<br/>
<br/>
cya</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126958 - tepples - Sat Apr 28, 2007 1:57 pm</h4>
    <div class="postbody"><span class="postbody">There's also a limitation on polygon RAM, and triangle strips won't help you much with that. If you use quad strips, you can break that. For instance, a <a class="postlink" href="http://en.wikipedia.org/wiki/Deltoidal_icositetrahedron" target="_blank">24-sided ball</a> can be drawn as six strips.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126970 - gabebear - Sat Apr 28, 2007 4:16 pm</h4>
    <div class="postbody"><span class="postbody">I've not played with it, but you can pre-load the depth buffer each frame.
<br/>
<br/>
<a href="http://nocash.emubase.de/gbatek.htm#ds3drearplane" target="_blank">http://nocash.emubase.de/gbatek.htm#ds3drearplane</a>
<br/>
<br/>
Which should make it possible to have software and hardware rendered 3D objects occlude each other. I haven't seen anyone use this feature, but it could be used to make some really neat effects.
<br/>
<br/>
Too bad there doesn't seem to be any way to read out the depth buffer...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127724 - silent_code - Fri May 04, 2007 9:37 am</h4>
    <div class="postbody"><span class="postbody">but that costs you a whole vbank... and i don't remember if you then *had* to use the bg image too (like forced to use it), which also requires a whole vbank.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
