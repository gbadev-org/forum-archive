<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>dmaCopy problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > dmaCopy problem</h2>
<div id="posts">
<div class="post">
    <h4>#93753 - spencer723 - Fri Jul 21, 2006 12:31 am</h4>
    <div class="postbody"><span class="postbody">For some reason when I try this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">dmaCopy(myBG_bin, BG_TILE_RAM_SUB(0), myBG_bin_size);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I get the error:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">error: invalid conversion from 'int' to 'void*'
<br/>
error: initializing argument 2 of 'void dmaCopy(const void*, void*, uint32)'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Anyone have any idea what's going on? It's worked before but now it won't compile</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93755 - tepples - Fri Jul 21, 2006 12:49 am</h4>
    <div class="postbody"><span class="postbody">How is BG_TILE_RAM_SUB() defined? And did it "work[] before" in C when you are now using C++?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93756 - spencer723 - Fri Jul 21, 2006 1:05 am</h4>
    <div class="postbody"><span class="postbody">I'm afraid I'm not following you tepples :S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93757 - tepples - Fri Jul 21, 2006 1:08 am</h4>
    <div class="postbody"><span class="postbody"><ol type="1"><li>The expression BG_TILE_RAM_SUB(0) looks like the evaluation of a preprocessor macro. In which header file is this macro defined? </li><li>Are you using the C language, or are you using the C++ language? </li><li>Was the program where the code "worked before" written in the C language, or was it written in the C++ language? </li><li>Exactly what do you not understand about these questions? </li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93767 - spencer723 - Fri Jul 21, 2006 4:11 am</h4>
    <div class="postbody"><span class="postbody">1. It is defined in &lt;nds/arm9/video.h&gt;
<br/>
2. C++
<br/>
3. Same program, different Makefile
<br/>
4. Just the wording of your question caught me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93771 - tepples - Fri Jul 21, 2006 4:47 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>spencer723 wrote:</b></span></td> </tr> <tr> <td class="quote">1. It is defined in &lt;nds/arm9/video.h&gt;</td> </tr></table><span class="postbody">
<br/>
Then the answer to "How is it defined?" is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define BG_TILE_RAM_SUB(base) (((base)*0x4000) + 0x06200000)</td> </tr></table><span class="postbody">
<br/>
Notice the lack of a cast to any pointer type here.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">2. C++</td> </tr></table><span class="postbody">
<br/>
ISO C++ is much stricter about pointer casting than C ever was:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// In your code, you'll need to replace this expression
<br/>
BG_TILE_RAM_SUB(base)
<br/>
<br/>
// with this expression
<br/>
reinterpret_cast&lt;void *&gt;(BG_TILE_RAM_SUB(base))</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93797 - parrot_ - Fri Jul 21, 2006 9:18 am</h4>
    <div class="postbody"><span class="postbody">I'm sure just adding (void*) works too.<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93820 - spencer723 - Fri Jul 21, 2006 1:52 pm</h4>
    <div class="postbody"><span class="postbody">Ahh, I knew I forgot something, thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93878 - tepples - Fri Jul 21, 2006 7:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>parrot_ wrote:</b></span></td> </tr> <tr> <td class="quote">I'm sure just adding (void*) works too.</td> </tr></table><span class="postbody">
<br/>
Right, but C style casting will likely be dropped in future versions of C++.
<br/>
<br/>
Synonyms:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">reinterpret_cast&lt;type&gt;(expr) // C++ way
<br/>
(type) expr // C way
<br/>
<br/>
// The portable way
<br/>
#ifdef __cplusplus
<br/>
  #define CAST(type, expr) (reinterpret_cast&lt;type&gt;(expr))
<br/>
#else
<br/>
  #define CAST(type, expr) ((type)(expr))
<br/>
#endif</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93882 - Sausage Boy - Fri Jul 21, 2006 8:07 pm</h4>
    <div class="postbody"><span class="postbody">I don't think C style casting will be dropped, as it will brake almost every larger program in existance. That's just stupid.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93905 - PeterM - Fri Jul 21, 2006 10:22 pm</h4>
    <div class="postbody"><span class="postbody">The reason C++ has extra casts is to make the purpose of the code clear to the reader.
<br/>
<br/>
static_cast is for conversions which are somewhat sane (base* -&gt; subclass*, float -&gt; int etc)
<br/>
reinterpret_cast is the dangerous one (int &lt;-&gt; ptr etc)
<br/>
dynamic_cast does runtime error checking for silly casts (cat* -&gt; sheep* etc)
<br/>
const_cast is for casting away consts (indicative of lazy programming somewhere)
<br/>
<br/>
What I do is just use static_cast, and the compiler will tell me if that's not good enough.
<br/>
<br/>
Whereas C just has a plain old cast, and you've go to figure out WTF the coder was thinking yourself.<br/>_________________<br/><a href="http://aaiiee.wordpress.com/" target="_blank">http://aaiiee.wordpress.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93919 - HyperHacker - Sat Jul 22, 2006 12:06 am</h4>
    <div class="postbody"><span class="postbody">...Which is where comments come in.
<br/>
<br/>
Isn't C++ supposed to be backward compatible anyway?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93956 - tepples - Sat Jul 22, 2006 2:29 am</h4>
    <div class="postbody"><span class="postbody">The C++ language is not a strict superset of the C language. It's a superset of a fairly comprehensive subset of the C language. If you have a C program with variables called 'throw', 'xor', 'template', or 'new', it is not a valid C++ program.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
