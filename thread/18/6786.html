<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Accurate touchscreen readings... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Accurate touchscreen readings...</h2>
<div id="posts">
<div class="post">
    <h4>#53350 - audiotheory - Wed Sep 07, 2005 7:49 pm</h4>
    <div class="postbody"><span class="postbody">Hello all,
<br/>
this is my first real post here. I've been lurking for a while and last night I finally decided to install the nds dev tools on my system. I was quite active in the GBC dev scene for a while back in the day and also have done a few GBA projects - it is now time to jump into the wonderful world of the DS!!
<br/>
I am beginning work on a little notepad style app - the big difference to other such apps that are floating around in the DS homebrew realm? 
<br/>
Handwriting recognition!
<br/>
I have devised a simple HR engine that I think will work pretty nicely and should be rather easy to implement - which leads me to the title of this thread.
<br/>
All of the examples I have compiled that give the X, Y coordinates of the touchscreen suffer from the same problems:
<br/>
<br/>
Top-left of the screen jumps around the -2, -1 mark
<br/>
Bottom-right of the screen jumps around the 256, 190 mark
<br/>
Holding the stylus in one point gives jittery results
<br/>
<br/>
I need to be able to read stable coordinates from the touch screen so that:
<br/>
<br/>
Top-left of the screen always reads 0, 0
<br/>
Bottom-right of the screen always reads 255, 191
<br/>
Holding the stylus in one point gives the same coordinates without jittering
<br/>
<br/>
I have read various posts on this topic over the months but I dont feel like there has been a definative answer yet - also searching is becoming harder and harder with every subsequent thread!
<br/>
<br/>
Any help on this will be greatly appreciated - even if its just a "use the f**kin search button - heres a previous thread that answers your questions" style response :D
<br/>
<br/>
cheers
<br/>
<br/>
<br/>
:theory</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53354 - headspin - Wed Sep 07, 2005 8:05 pm</h4>
    <div class="postbody"><span class="postbody">Have you tried callibrating your touchscreen in your DS preferences?
<br/>
<br/>
Anyways, I thought handwriting recognition was a good idea, and found a single character recognition example in java a while ago. Perhaps it can give you some ideas on improving your app. Check it out, it's called <a class="postlink" href="http://www.hellkvist.org/software/" target="_blank">JMerlin</a>
<br/>
<br/>
Good luck with the app.. you will probably get a better reply from someone regarding your touchscreen issues..<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53356 - Sausage Boy - Wed Sep 07, 2005 8:19 pm</h4>
    <div class="postbody"><span class="postbody">The offset stuff is just wrong calibration. It's almost impossible
<br/>
to calibrate good enough to make the top right corner 0x0 and so on.
<br/>
<br/>
You might solve your jittering by reading the touch lots of times per
<br/>
frame and calculate the middle value. I've heard people mention that.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53368 - audiotheory - Wed Sep 07, 2005 10:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>headspin wrote:</b></span></td> </tr> <tr> <td class="quote">Have you tried callibrating your touchscreen in your DS preferences?
<br/>
<br/>
Anyways, I thought handwriting recognition was a good idea, and found a single character recognition example in java a while ago. Perhaps it can give you some ideas on improving your app. Check it out, it's called <a class="postlink" href="http://www.hellkvist.org/software/" target="_blank">JMerlin</a>
<br/>
<br/>
Good luck with the app.. you will probably get a better reply from someone regarding your touchscreen issues..</td> </tr></table><span class="postbody">
<br/>
<br/>
Thank you very much for that link, I downloaded the source - it makes for interesting reading.
<br/>
The method I've come up with is alot simpler though - Im going to use a basic 3x3 position matrix to define strokes. Using this idea I could store a simple stroke (an 'R' for example) in as little as 2 bytes!!
<br/>
On further googling I've discovered that the 3x3 matrix idea I came up with last night has actually been used in a free stroke-recognition library - its always reasuring to find out an idea you've had has been put into practice by someone else! :)
<br/>
<br/>
As for my original question regarding touchscreen coordinates, again thanks for the advice. 
<br/>
<br/>
@Sausageboy: taking the mean value of multiple samples definately sounds like a good idea to minimise jitter. As for getting the same coordinate values on every DS - there has to be a way of reading the calibration data and taking that into account right?
<br/>
<br/>
Can anyone point me in the right direction on this subject? 
<br/>
<br/>
Cool 3D stuff and wifi capabilities are definately things that I am excited about - but for me personally, I would really like to get the basics accurate first!
<br/>
ie. standard code that gives reliable readings of the touchscreen on every DS.
<br/>
<br/>
cheers again
<br/>
<br/>
<br/>
:theory</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53376 - deltro - Thu Sep 08, 2005 1:33 am</h4>
    <div class="postbody"><span class="postbody">That'd be an interesting function to add to the library, and save processor time. Take 3-5 reads on the touch screen, and average the coord's.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53389 - natrium42 - Thu Sep 08, 2005 2:54 am</h4>
    <div class="postbody"><span class="postbody">Try taking touchscreen readings more often than a VBLANK interrupt (i.e. use a timer interrupt) and then average values. Also, discard clearly bad readings when averaging.<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53393 - cybereality - Thu Sep 08, 2005 3:22 am</h4>
    <div class="postbody"><span class="postbody">You may also want to look at finding the mode value instead of the median. For instance, you said you want the null touch to be a solid 0,0 on the touch screen input. If you just averaged the values (with the -1s and -2s) you  would get an average of -1,-1 which is still not what you want. If you, however, took a sample of 10 readings and in 6 of them you got 0, you can say that the function will return zero and discard jitter data. Similarly, you can just set an x or y value less then zero to equal 0 (same with max values). This will give more accurate results then just averaging because then you must deal with converting floats to ints and the jitter that will create.
<br/>
<br/>
// cybereality</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53540 - deltro - Fri Sep 09, 2005 1:48 am</h4>
    <div class="postbody"><span class="postbody">Why was that 3D pool demo so jittery?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53567 - audiotheory - Fri Sep 09, 2005 6:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>deltro wrote:</b></span></td> </tr> <tr> <td class="quote">Why was that 3D pool demo so jittery?</td> </tr></table><span class="postbody">
<br/>
<br/>
Pretty much all the demos/examples I've seen that require moving the stylus suffer from this problem.
<br/>
There doesn't seem to be a standard solution to this yet - which is why I was asking.
<br/>
<br/>
I'm working on music during the day so my time to work on DS stuff is limited - ie late at night when the wifes in bed and I cant work on music! But I will be sure to share anything I figure out.
<br/>
<br/>
<br/>
:theory</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53586 - tepples - Fri Sep 09, 2005 3:48 pm</h4>
    <div class="postbody"><span class="postbody">Do any of the official Nintendo DS games require touching at a precision within plus or minus two pixels?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53589 - dis169 - Fri Sep 09, 2005 4:41 pm</h4>
    <div class="postbody"><span class="postbody">I could be wrong, its been a while since i looked at the code and even then it was briefly, but doesn't the touch screen generate heat values.  IIRC they're wrapped via some macros or function calls to give the x/y values but you might have more luck if you grab the original data and wrap it with knowledge of what your trying to achieve.
<br/>
<br/>
Likely the conversion was made to fit the majority of apps where small precision isn't needed and its probably culled in an effort to remove small errors.  Unfortunately you may find that you have to introduce the chance of jitter when the touch stick is relatively static if you want finer procision.
<br/>
<br/>
Course as i said, its been a while and i could be wrong.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53591 - Sausage Boy - Fri Sep 09, 2005 4:45 pm</h4>
    <div class="postbody"><span class="postbody">Libnds uses the calibration points automagically. The problem is, it's hard to calibrate
<br/>
good enough to have exact pixel positions, most users don't want to spend hours
<br/>
with a microscope to calibrate.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53624 - audiotheory - Fri Sep 09, 2005 9:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Do any of the official Nintendo DS games require touching at a precision within plus or minus two pixels?</td> </tr></table><span class="postbody">
<br/>
<br/>
A good point and I guess there aren't many applications where that kind of precision would be required - however I find it hard to believe that Nintendos official librarys simpley say "if you need to read precise values - tough"!
<br/>
However this is splitting hairs slightly. I guess the bigger problem to be resolved is the jitter and this is something that official Nintendo games most definately do not suffer from.
<br/>
<br/>
<br/>
:theory</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53625 - krunkster - Fri Sep 09, 2005 10:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>audiotheory wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Do any of the official Nintendo DS games require touching at a precision within plus or minus two pixels?</td> </tr></table><span class="postbody">
<br/>
A good point and I guess there aren't many applications where that kind of precision would be required - :theory</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I don't think you need this sort of precision either.
<br/>
Just record all valid plot points while the pen is down and then when you lift run your recognition routines.  Hopefully the character recognition routine you use is good enough to compensate for the jitter.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53845 - headspin - Mon Sep 12, 2005 5:24 pm</h4>
    <div class="postbody"><span class="postbody">I know of two methods to remove the jitter, but I'm unsure how accurate they are between different DS'.
<br/>
<br/>
Method 1: Compare absolute value of last reading with new reading
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define MOVE_MAX 16
<br/>
<br/>
int new_x, new_y;
<br/>
new_x = IPC-&gt;touchXpx;
<br/>
new_y = IPC-&gt;touchYpx;
<br/>
<br/>
if(abs(new_x-old_x)&lt;MOVE_MAX &amp;&amp; abs(new_y-old_y)&lt;MOVE_MAX)</td> </tr></table><span class="postbody">
<br/>
<br/>
Method 2: Check Z1 &amp; Z2 is not zero
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int z1, z2;
<br/>
z1 = IPC-&gt;touchZ1;
<br/>
z2 = IPC-&gt;touchZ2;
<br/>
<br/>
if(z1!=0 &amp;&amp; z2!=0)</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#53863 - Mollusk - Mon Sep 12, 2005 8:30 pm</h4>
    <div class="postbody"><span class="postbody">I had a pretty simple method to remove jittering, although it's not perfect... I used it on a bitmap viewer, to scroll the bitmap around (it was a pain to have the bitmap move by itself although the stylus was held still).
<br/>
<br/>
My method : calculate the distance between the preceding point and the new one... Simply (StylusX - oldStylusX)^2 + (StylusY - oldStylusY)^2... You don't need to take the square root. I chose a value of 9 (so that would a a minimum distance of 3 pixels), but you can chose, say 6 or 7, and not move unless you have that minimum distance...
<br/>
<br/>
It's works fairly well</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54103 - Mollusk - Thu Sep 15, 2005 5:46 pm</h4>
    <div class="postbody"><span class="postbody">I changed my arm7 stylus code to limit the range to 0-255 for x and 0-191 for y...
<br/>
<br/>
Then I added a sort of anti-jitter code, takes 2 lines... just what I said : check the distance between the last point and the new point, update if big enough, and it works perfectly, no more jittering ! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54111 - natrium42 - Thu Sep 15, 2005 6:16 pm</h4>
    <div class="postbody"><span class="postbody">How often do you take readings?<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54112 - Mollusk - Thu Sep 15, 2005 6:17 pm</h4>
    <div class="postbody"><span class="postbody">in the arm7 vbl -&gt; 60 times per second, I guess</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54121 - Defect - Thu Sep 15, 2005 6:34 pm</h4>
    <div class="postbody"><span class="postbody">Can this same approach be taken with the stylus support in the heritic and hexen ports?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54125 - Mollusk - Thu Sep 15, 2005 6:40 pm</h4>
    <div class="postbody"><span class="postbody">it could be taken anywhere, I guess...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54127 - Defect - Thu Sep 15, 2005 6:43 pm</h4>
    <div class="postbody"><span class="postbody">The jittery stylus movement and freezing up, are the only things holding me back from playing more of those ports.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54136 - natrium42 - Thu Sep 15, 2005 8:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mollusk wrote:</b></span></td> </tr> <tr> <td class="quote">in the arm7 vbl -&gt; 60 times per second, I guess</td> </tr></table><span class="postbody">
<br/>
You should take it more often than that. Especially, when you are averaging :)<br/>_________________<br/><a class="postlink" href="http://www.natrium42.com" target="_blank">www.natrium42.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54157 - cybereality - Thu Sep 15, 2005 11:48 pm</h4>
    <div class="postbody"><span class="postbody">I am working on a method to get solid input from the touch screen. One thing I have noticed in my tests is that the cursor jitters if you dont press hard enough. If you jab hard on the screen it will produce accurate results. If you just slightly graze the screen (ie barely touch it) i wont give back anything useful. My method is based on interpolating the most likely touch point based on surrounding data. If you limit the range of movement from one point to another you also limit the speed you can move the stylus. So it may elliminate jitter, but you also cannot move the stylus quick across the screen. I'll be finishing up the test in the next day or so, I will post the code. Right now I am having trouble getting the timer irqs working so I can poll the screen more than the VBlank. Once I fix that, it should be no problem.<br/>_________________<br/><a class="postlink" href="http://www.cybereality.com" target="_blank">// cybereality</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54171 - deltro - Fri Sep 16, 2005 1:48 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Defect wrote:</b></span></td> </tr> <tr> <td class="quote">The jittery stylus movement and freezing up, are the only things holding me back from playing more of those ports.</td> </tr></table><span class="postbody"> The only thing holding me back from playing more of those ports is my intense lack of flash cart ._.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54183 - Mollusk - Fri Sep 16, 2005 7:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"> If you limit the range of movement from one point to another you also limit the speed you can move the stylus. </td> </tr></table><span class="postbody">
<br/>
<br/>
It's actually the opposite I did : I give a minimum range to have ! So it doesn't change anything for when you move quickly around the screen</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54191 - headspin - Fri Sep 16, 2005 10:48 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>cybereality wrote:</b></span></td> </tr> <tr> <td class="quote">...I am working on a method to get solid input from the touch screen. One thing I have noticed in my tests is that the cursor jitters if you dont press hard enough...</td> </tr></table><span class="postbody">
<br/>
<br/>
Don't forget that there are at least two different types of touch screens which seem to respond in slightly different ways.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54207 - Yoko - Fri Sep 16, 2005 4:59 pm</h4>
    <div class="postbody"><span class="postbody">While handwriting recognition may seem like a "natural" choice, it my opinion it is the wrong choice for the touch screen text entry.
<br/>
<br/>
Think about how the letters were evolved; definitely not for speed or convenience. Many letters require multi strokes and multi turns and stops, whereas a single tap or stroke on the touch screen should suffice to convey the intention.
<br/>
<br/>
There are other input systems, besides HR or Graffiti, that comes much closer to ideal, and much, must faster. Once that I am using on my table pc which I think is quite appropriate for DS is MessagEase (<a class="postlink" href="http://www.exideas.com" target="_blank">www.exideas.com</a>). It uses a SINGLE tap or a SINGLE stroke to enter almost any letter, number or character, making it super fast.
<br/>
<br/>
I believe in taking advantage of the strength of the machines we have, not trying to fit what we have to the older inefficient ways.
<br/>
<br/>
Old habits are hard to break. It took a few decades to convince Europe to discard the old Roman numerals!
<br/>
<a href="http://www.exideas.com/ME/pics/MEBasic.jpg">[Images not permitted - Click here to view it]</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54210 - Mighty Max - Fri Sep 16, 2005 5:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Yoko wrote:</b></span></td> </tr> <tr> <td class="quote">Old habits are hard to break. </td> </tr></table><span class="postbody">
<br/>
<br/>
Do the first step and replace your clock with a metric compliant one.
<br/>
<br/>
With the next Beep it's 9 deziday and 5 centidays :p ... oh wait ... a day? Screw it, we just make the year have 100 days to match the pattern.
<br/>
<br/>
*g*
<br/>
<br/>
Old habits have a reason, they are evolved. New and designed means always lack somewhere. Let the new method grow a few years, and check if it really has a better advantages to disadvantages ratio. Doubt it tbh.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54241 - Yoko - Sat Sep 17, 2005 1:27 am</h4>
    <div class="postbody"><span class="postbody">Surely you are jesting!
<br/>
<br/>
Reductio Ad Nauseum has never been a wise man's "proof". Your distortion of the metric system is neither funny, nor self serving!
<br/>
<br/>
We are still stuck at the egotistical whims of Julius and Augustus to have two meaningless months, shifting the seventh month to the ninth position, etc., and you are talking about the old rusted habits as evolution?
<br/>
<br/>
Try multiplying using roman numerals! 
<br/>
<br/>
Your "logic" echoes the simpleton cries for reaming with the "tried and true number system" which resulted in the delay of Western Civilization's renaissance and enlightenment for about eighty years.
<br/>
<br/>
Wise man invents; ordinary man follows.
<br/>
<br/>
:)
<br/>
<br/>
:)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54381 - deltro - Sun Sep 18, 2005 9:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mighty Max wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Yoko wrote:</b></span></td> </tr> <tr> <td class="quote">Old habits are hard to break. </td> </tr></table><span class="postbody">
<br/>
<br/>
Do the first step and replace your clock with a metric compliant one.
<br/>
<br/>
With the next Beep it's 9 deziday and 5 centidays :p ... oh wait ... a day? Screw it, we just make the year have 100 days to match the pattern.</span></td> </tr></table><span class="postbody">
<br/>
Metric &gt; *</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54619 - beejayzed - Tue Sep 20, 2005 10:42 pm</h4>
    <div class="postbody"><span class="postbody">Em, just wanted to say that pictochat doesn't seem to filter out the jittering. I get horizontal lines when I'm trying to tap dots quite often.
<br/>
I dunno, maybe it's just my DS...
<br/>
<br/>
The SM64DS drawing app doesn't do this, although the drawing does seem to have some lag to it. The slight lag might be intentional though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54876 - Zapf_Bandit - Fri Sep 23, 2005 7:20 am</h4>
    <div class="postbody"><span class="postbody">I was having issues when requiring a tap of the stylus to be in a correct position. I kept finding that the first cycle or two after pressing (and when releasing) gave wierd positions. It also drifted towards the correct for about 8 frames.
<br/>
<br/>
In order to fix this I let the position converge before using it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
uint16 /*bool*/ wasDown = false;
<br/>
uint16 x = 0;
<br/>
uint16 y = 0;
<br/>
    
<br/>
while(1) 
<br/>
{
<br/>
     
<br/>
   uint16 /*bool*/ doIt = false;
<br/>
         
<br/>
   if (!(IPC-&gt;buttons &amp; 0x40)) // If the touchpad is down
<br/>
   {
<br/>
      
<br/>
      if (wasDown)
<br/>
      {
<br/>
         uint16 nx = IPC-&gt;touchXpx;
<br/>
         uint16 ny = IPC-&gt;touchYpx;
<br/>
         doIt = (((nx-x)*(nx-x)) + ((ny-y)*(ny-y)) &lt;= 2); //Could use 1 here if you wanted...
<br/>
         x = nx;
<br/>
         y = ny;
<br/>
      }
<br/>
      else
<br/>
      {
<br/>
         x = IPC-&gt;touchXpx;
<br/>
         y = IPC-&gt;touchYpx;
<br/>
      }
<br/>
         
<br/>
      if (doIt)
<br/>
      {
<br/>
         //OK, now pos has converged and is (x,y)
<br/>
         //Do something now......
<br/>
      }
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
      wasDown = false;
<br/>
   }
<br/>
<br/>
   swiWaitForVBlank();
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This will avoid both press and release problems. Keep in mind it won't track fast movement well and is mainly for clicking. I hope this helps someone. It took me a while to think of and works well for me.
<br/>
<br/>
Zapf Bandit</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54878 - Mollusk - Fri Sep 23, 2005 7:23 am</h4>
    <div class="postbody"><span class="postbody">What I did to try to avoid wrong values when you do a new press was just retard the newpress by 1 frame... If you do a new press, it doesn't do anything (returns not held), and if the stylus is still held, it then returns a new press with the values... Seems to have worked pretty well for me</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
