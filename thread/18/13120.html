<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>putting files in roms - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > putting files in roms</h2>
<div id="posts">
<div class="post">
    <h4>#127476 - snowsquirrel - Wed May 02, 2007 8:04 pm</h4>
    <div class="postbody"><span class="postbody">Simple question:
<br/>
<br/>
I want to add some data to my ds project.  I am assuming libfat is the way to do this.  So I link in libfat, and try to open a file as "fat0:/test.txt", and it fails.
<br/>
<br/>
Most likely it is missing from .nds.  So my question is, what do I have to do, to get test.txt into my .nds file so it is found?
<br/>
<br/>
Thanks,
<br/>
~S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127486 - josath - Wed May 02, 2007 11:01 pm</h4>
    <div class="postbody"><span class="postbody">You don't have to specify fat0:
<br/>
<br/>
Just do fopen("/test.txt", "r");. Of course, make sure 'test.txt' actually exists on your SD or CF card in the root directory.
<br/>
<br/>
Basically, you don't embed the files in your .nds if you want to use libfat. You put them on the card along with the .nds</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127488 - snowsquirrel - Wed May 02, 2007 11:24 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the reply.  That clears a lot up.  Now, what if I wanted to embed in the .nds?  Should I be looking at gbafs for that?
<br/>
<br/>
Thanks,
<br/>
<br/>
~S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127489 - Lick - Wed May 02, 2007 11:49 pm</h4>
    <div class="postbody"><span class="postbody">Instead of GBFS you could simply rename your file *.bin, and put it in the data folder. Just like your graphics.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127490 - snowsquirrel - Wed May 02, 2007 11:53 pm</h4>
    <div class="postbody"><span class="postbody">I use my own makefile.  
<br/>
<br/>
(For images I use PAGfx.exe which converts them to static arrays, for now.  I was going to change this though.)
<br/>
<br/>
My makefile doesn't do anything to the data directory.  But I'll look at the makefile templates and see what they do with .bin files in the data directory.
<br/>
<br/>
Then how do I load/read those files, at runtime?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127492 - Lick - Thu May 03, 2007 12:12 am</h4>
    <div class="postbody"><span class="postbody">How do you load your graphics? (If you have any)
<br/>
<br/>
The libnds template Makefile takes all the *.bin from the data folder and automatically includes it in your binary. It also generates header files that you include (don't even need to write them yourself) in your project.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "webcam_bin.h" // "data/webcam.bin"
<br/>
<br/>
memcpy(dst, webcam_bin, webcam_bin_size);</td> </tr></table><span class="postbody">
<br/>
<br/>
That's all there is to it.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127501 - tepples - Thu May 03, 2007 12:45 am</h4>
    <div class="postbody"><span class="postbody">But then how do you get the makefile to regenerate the .bin files every time the corresponding .bmp files change?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127506 - Lick - Thu May 03, 2007 12:48 am</h4>
    <div class="postbody"><span class="postbody">Not sure, but it seems to auto-detect it in my projects. If I change the file it will be told in the build output messages. If I haven't changed it, it won't be in those messages.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127517 - snowsquirrel - Thu May 03, 2007 1:31 am</h4>
    <div class="postbody"><span class="postbody">If it is putting it in a .h, then it must be as static data.  My understanding is that if it is static data, then on most systems, it must be taking up RAM?  Whereas if it is in a file, it is not taking up memory until you load it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">memcpy(dst, webcam_bin, webcam_bin_size);</td> </tr></table><span class="postbody">
<br/>
<br/>
dst must be the same size as webcam_bin, so now you have it memory twice.
<br/>
<br/>
This is what I currently do with images.  This is what I  am trying to get away from.
<br/>
<br/>
~S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127524 - Lick - Thu May 03, 2007 2:09 am</h4>
    <div class="postbody"><span class="postbody">Well as far as I know, GBFS data has to be loaded into memory as well (because it's in your NDS file and that whole file gets loaded). 
<br/>
<br/>
Only libfat will keep the files away from RAM until needed.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127525 - snowsquirrel - Thu May 03, 2007 2:11 am</h4>
    <div class="postbody"><span class="postbody">hmmm, ok.  sounds like libfat is what I want.  Thanks,
<br/>
~S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127527 - Lick - Thu May 03, 2007 2:20 am</h4>
    <div class="postbody"><span class="postbody">No problem,
<br/>
~L<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127536 - snowsquirrel - Thu May 03, 2007 3:33 am</h4>
    <div class="postbody"><span class="postbody">OK,  I put a test.txt right beside my .nds file.  Then I run desmume.exe on the .nds, but I am unable to open the file:
<br/>
<br/>
<br/>
	fatInit( 8, true);
<br/>
	const char* mesg = 0;
<br/>
	FILE* test = fopen( "/delme.txt", "r" );
<br/>
	if( test )
<br/>
	{
<br/>
		mesg = "opened file";
<br/>
	}
<br/>
	else
<br/>
	{
<br/>
		mesg = "could not open file";
<br/>
	}
<br/>
	fclose( test );
<br/>
	SCRN_PRINT( mesg );</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127537 - tepples - Thu May 03, 2007 3:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>snowsquirrel wrote:</b></span></td> </tr> <tr> <td class="quote">OK,  I put a test.txt right beside my .nds file.  Then I run desmume.exe</td> </tr></table><span class="postbody">
<br/>
Have you tried checking the fatInit() return value? Have you tried running the file on a Nintendo DS video game system instead of on desmume.exe?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127539 - snowsquirrel - Thu May 03, 2007 4:00 am</h4>
    <div class="postbody"><span class="postbody">Yeah, you got it.  The init is failing...  probably to do with emulator I am guessing.
<br/>
<br/>
I still don't have a flash cart yet.  It is in the works.  Are there any emulators that work with libfat?
<br/>
<br/>
~S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127548 - GPFerror - Thu May 03, 2007 5:13 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>snowsquirrel wrote:</b></span></td> </tr> <tr> <td class="quote">Yeah, you got it.  The init is failing...  probably to do with emulator I am guessing.
<br/>
<br/>
I still don't have a flash cart yet.  It is in the works.  Are there any emulators that work with libfat?
<br/>
<br/>
~S</td> </tr></table><span class="postbody">
<br/>
<br/>
search forums for FCSR.
<br/>
<br/>
desumem, no$gba and ideas all work with libfat with specially appended FAT12 images and patched with a fcsr.dldi patcher</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127603 - snowsquirrel - Thu May 03, 2007 2:34 pm</h4>
    <div class="postbody"><span class="postbody">Ok, following these steps from GPFerror:
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=12654%3C/blockquote%3E%3C/div%3E" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12654%3C/blockquote%3E%3C/div%3E</a>
<br/>
<br/>
I got the filesystem to init using no$gba.  desmume just crashes though.
<br/>
<br/>
~S</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
