<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Pointer problems - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Pointer problems</h2>
<div id="posts">
<div class="post">
    <h4>#174679 - iainprice - Thu Jul 08, 2010 8:44 pm</h4>
    <div class="postbody"><span class="postbody">I have a problem, it keeps saying that matrix is used un-initiated....
<br/>
<br/>
[code]t contains floats
<br/>
<br/>
void DrawCubes(void) 
<br/>
{ 
<br/>
   m4x4 *matrix; 
<br/>
<br/>
   for (int i = 0; i &lt; CUBECOUNT; i++) 
<br/>
   { 
<br/>
      matrix-&gt;m[0] = t.rot[0][0]; 
<br/>
      matrix-&gt;m[4] = t.rot[0][1]; 
<br/>
      matrix-&gt;m[8] = t.rot[0][2]; 
<br/>
      matrix-&gt;m[1] = t.rot[1][0]; 
<br/>
      matrix-&gt;m[5] = t.rot[1][1]; 
<br/>
      matrix-&gt;m[9] = t.rot[1][2]; 
<br/>
      matrix-&gt;m[2] = t.rot[2][0]; 
<br/>
      matrix-&gt;m[6] = t.rot[2][1]; 
<br/>
      matrix-&gt;m[10] = t.rot[2][2]; 
<br/>
      matrix-&gt;m[12] = t.pos[0]; 
<br/>
      matrix-&gt;m[13] = t.pos[1]; 
<br/>
      matrix-&gt;m[14] = t.pos[2]; 
<br/>
      matrix-&gt;m[3] = 0.0f; 
<br/>
      matrix-&gt;m[7] = 0.0f; 
<br/>
      matrix-&gt;m[11] = 0.0f; 
<br/>
      matrix-&gt;m[15] = 1.0f; 
<br/>
      glPushMatrix(); 
<br/>
      glMultMatrix4x4(matrix);
<br/>
      drawcube(0.1, 0.1, 0.1);
<br/>
      glPopMatrix(1); 
<br/>
   } 
<br/>
} 
<br/>
[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174680 - headspin - Thu Jul 08, 2010 9:10 pm</h4>
    <div class="postbody"><span class="postbody">You're using a pointer without creating an object. Just use
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">m4x4 matrix; </td> </tr></table><span class="postbody">
<br/>
<br/>
And change
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">matrix-&gt;m[0] = t.rot[0][0];
<br/>
...</td> </tr></table><span class="postbody">
<br/>
<br/>
to
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">matrix.m[0] = t.rot[0][0];
<br/>
...</td> </tr></table><span class="postbody">
<br/>
<br/>
If you used a pointer you would have to "new" it then "delete" it later.
<br/>
<br/>
Eg.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">m4x4* matrix = new m4x4();
<br/>
...
<br/>
delee matrix;</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174681 - iainprice - Thu Jul 08, 2010 9:33 pm</h4>
    <div class="postbody"><span class="postbody">glMultMatrix4x4(matrix); 
<br/>
<br/>
needs a pointer
<br/>
<br/>
so I'll try new and delete.....
<br/>
<br/>
thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174684 - headspin - Thu Jul 08, 2010 9:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>iainprice wrote:</b></span></td> </tr> <tr> <td class="quote">glMultMatrix4x4(matrix); 
<br/>
<br/>
needs a pointer
<br/>
<br/>
so I'll try new and delete.....
<br/>
<br/>
thanks</td> </tr></table><span class="postbody">
<br/>
<br/>
You don't need to use new and delete just send it the address
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">m4x4 matrix;
<br/>
...
<br/>
glMultMatrix4x4(&amp;matrix);</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174686 - iainprice - Thu Jul 08, 2010 10:33 pm</h4>
    <div class="postbody"><span class="postbody">m4x4* matrix = new m4x4(); 
<br/>
<br/>
void DrawCubes(void) 
<br/>
{ 
<br/>
      matrix-&gt;m[0] = t.rot[0][0]; 
<br/>
      matrix-&gt;m[4] = t.rot[0][1]; 
<br/>
      matrix-&gt;m[8] = t.rot[0][2]; 
<br/>
      matrix-&gt;m[1] = t.rot[1][0]; 
<br/>
      matrix-&gt;m[5] = t.rot[1][1]; 
<br/>
      matrix-&gt;m[9] = t.rot[1][2]; 
<br/>
      matrix-&gt;m[2] = t.rot[2][0]; 
<br/>
      matrix-&gt;m[6] = t.rot[2][1]; 
<br/>
      matrix-&gt;m[10] = t.rot[2][2]; 
<br/>
      matrix-&gt;m[12] = t.pos[0]; 
<br/>
      matrix-&gt;m[13] = t.pos[1]; 
<br/>
      matrix-&gt;m[14] = t.pos[2]; 
<br/>
      matrix-&gt;m[3] = 0.0f; 
<br/>
      matrix-&gt;m[7] = 0.0f; 
<br/>
      matrix-&gt;m[11] = 0.0f; 
<br/>
      matrix-&gt;m[15] = 1.0f; 
<br/>
      glPushMatrix(); 
<br/>
      glMultMatrix4x4(matrix);
<br/>
      drawcube(0.1, 0.1, 0.1);
<br/>
      glPopMatrix(1); 
<br/>
      printf("y=%f   ",t.pos[1]);
<br/>
} 
<br/>
<br/>
<br/>
or
<br/>
<br/>
<br/>
m4x4 matrix;
<br/>
<br/>
void DrawCubes(void) 
<br/>
{
<br/>
      matrix.m[0] = t.rot[0][0]; 
<br/>
      matrix.m[4] = t.rot[0][1]; 
<br/>
      matrix.m[8] = t.rot[0][2]; 
<br/>
      matrix.m[1] = t.rot[1][0]; 
<br/>
      matrix.m[5] = t.rot[1][1]; 
<br/>
      matrix.m[9] = t.rot[1][2]; 
<br/>
      matrix.m[2] = t.rot[2][0]; 
<br/>
      matrix.m[6] = t.rot[2][1]; 
<br/>
      matrix.m[10] = t.rot[2][2]; 
<br/>
      matrix.m[12] = t.pos[0]; 
<br/>
      matrix.m[13] = t.pos[1]; 
<br/>
      matrix.m[14] = t.pos[2]; 
<br/>
      matrix.m[3] = 0.0f; 
<br/>
      matrix.m[7] = 0.0f; 
<br/>
      matrix.m[11] = 0.0f; 
<br/>
      matrix.m[15] = 1.0f; 
<br/>
      glPushMatrix(); 
<br/>
      glMultMatrix4x4(&amp;matrix);
<br/>
      drawcube(0.1, 0.1, 0.1);
<br/>
      glPopMatrix(1); 
<br/>
      printf("y=%f   ",t.pos[1]);
<br/>
} 
<br/>
<br/>
Both ways are happy and compile but neither translates the cube.
<br/>
<br/>
i hate pointers, I always seem to get things mixed up with passing the pointer or the address or a pointer to a pointer......</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174692 - elhobbs - Thu Jul 08, 2010 11:22 pm</h4>
    <div class="postbody"><span class="postbody">It is hard to say why it does not work as you do not show enough code to tell. What is the current matrix, what values did you put in your matrix. Why not just use gltranslate and glrotate?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#174693 - iainprice - Thu Jul 08, 2010 11:41 pm</h4>
    <div class="postbody"><span class="postbody">How can i change a 4x4 to xyz rotation and xyz tranform?
<br/>
<br/>
On my example:
<br/>
matrix.m[12] = t.pos[0]; 
<br/>
matrix.m[13] = t.pos[1]; 
<br/>
matrix.m[14] = t.pos[2]; 
<br/>
<br/>
is the transform I do after the rotation......
<br/>
<br/>
Thanks, nearly sorted now :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
