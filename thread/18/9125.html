<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Anybody porting Nethack? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Anybody porting Nethack?</h2>
<div id="posts">
<div class="post">
    <h4>#78030 - sofakng - Tue Apr 04, 2006 6:49 pm</h4>
    <div class="postbody"><span class="postbody">I'm very interested in porting Nethack to the DS but this thing looks MASSIVE and incredibly hard to port.
<br/>
<br/>
If nobody is trying to port it, can anybody give me and tips on how to port it myself?  (eg. where to start)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78036 - Roc - Tue Apr 04, 2006 8:02 pm</h4>
    <div class="postbody"><span class="postbody">Nothing productive to say other than it would be absolutely amazing to have a DS Nethack port =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78047 - headspin - Tue Apr 04, 2006 9:16 pm</h4>
    <div class="postbody"><span class="postbody">Nethack was too much for the GBA from memory (pardon the pun). But I remember <a class="postlink" href="http://www.geocities.com/quirky_2k1/games/rogue/index.html" target="_blank">Rogue</a> was ported to it, and then there is <a class="postlink" href="http://www.zincland.com/powder/index.php" target="_blank">Powder</a>. Some guy was porting <a class="postlink" href="http://episteme.arstechnica.com/eve/ubb.x/a/tpc/f/39309975/m/535004863731" target="_blank">Angband</a> a while back. These are just a few Nethack type ports. Probably worth doing a bit of research into these port and perhaps contact the authors for some help.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78053 - josath - Tue Apr 04, 2006 10:16 pm</h4>
    <div class="postbody"><span class="postbody">I ported Hack a while ago, but it requires DSLinux...
<br/>
<a href="http://davr.drunkencoders.com/linux/#hack" target="_blank">http://davr.drunkencoders.com/linux/#hack</a>
<br/>
I don't know if it still works on the latest dslinux.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78054 - sofakng - Tue Apr 04, 2006 10:30 pm</h4>
    <div class="postbody"><span class="postbody">Would you be able to give me some pointers on porting it over to native DS?
<br/>
<br/>
I'm a Delphi (eg. pascal) Database developer and should have sufficient programming knowledge to port it.  I've already looked at the code and some of the C-specific code looks a bit confusing (FDECL, NDECL [what do they mean?]) but I shouldn't have a problem if I get some advice.. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78215 - Wosret - Wed Apr 05, 2006 11:46 pm</h4>
    <div class="postbody"><span class="postbody">I actually had the same idea and started working on porting Nethack to the DS just a few days ago.  Here are some ideas that may be helpful to you.  (Note: I'm nowhere close to finishing this project yet, so any of these could be completely wrong)
<br/>
<br/>
Since Nethack will refuse to run if it can't find certain files, the first thing to do is to write some functions that emulate standard file I/O functions by using chishm's FAT library.  A good tip for writing those is to look at sys/wince/celib.c.  It contains all the I/O functions that the FAT library does not support, rewritten to use Windows CE file I/O APIs (which is fairly easy to fix).
<br/>
<br/>
I finished those functions yesterday (you can see them <a class="postlink" href="http://stuartp.commixus.com/nhds/" target="_blank">here</a> if you want) so now I'm working on the interface functions that are described in doc/window.doc.  You cannot use a tiled background for the map because Nethack uses a total of 1037 tiles, and the DS only supports 1024.  For this, use framebuffer mode or have it draw ASCII graphics.
<br/>
<br/>
Finally, about the *DECLs: (from include/tradstdc.h:114)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
 * NDECL() is used for functions with zero arguments;
<br/>
 * FDECL() is used for functions with a fixed number of arguments;
<br/>
 * VDECL() is used for functions with a variable number of arguments.
<br/>
</td> </tr></table><span class="postbody">
<br/>
So far, I haven't needed to change these at all to get it to compile.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78235 - tepples - Thu Apr 06, 2006 2:31 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Wosret wrote:</b></span></td> </tr> <tr> <td class="quote">I'm working on the interface functions that are described in doc/window.doc.  You cannot use a tiled background for the map because Nethack uses a total of 1037 tiles, and the DS only supports 1024.  For this, use framebuffer mode or have it draw ASCII graphics.</td> </tr></table><span class="postbody">
<br/>
That or compromise: find the 13 tiles that are most similar to other tiles.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78239 - sofakng - Thu Apr 06, 2006 2:46 am</h4>
    <div class="postbody"><span class="postbody">How are you getting it to compile?  Are you using anything from the sys or win directories?  I was trying to start over from scratch (eg. not using anything from sys/share, sys/winnt, or /win/win32), but maybe thats not the right approach either.
<br/>
<br/>
Would you be willing to share your skeleton port code? (eg. the one that compiles at least)
<br/>
<br/>
To be honest, I really doubt I can port this thing but I'm still interested in trying.  What you already have done in ds_io is a bit above my experience, but what the heck :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78246 - Wosret - Thu Apr 06, 2006 4:04 am</h4>
    <div class="postbody"><span class="postbody">So far I haven't needed anything from the sys and win directories, except for copying fscanf, fprintf, and vfprintf from sys/wince/celib.c.
<br/>
<br/>
The instructions to get it to compile are a bit long, so I uploaded them to my website: <a class="postlink" href="http://stuartp.commixus.com/nhds/instructions.html" target="_blank">Instructions</a>
<br/>
<br/>
I also uploaded everything I have so far: <a class="postlink" href="http://stuartp.commixus.com/nhds/nethackDS.zip" target="_blank">Source</a> (4MB)
<br/>
Just so you know, it isn't the official release - when I started working on this, I used the patched version that I play.  You can remove almost all of the patch code by commenting the #defines in section 5 of config.h.  
<br/>
If it dies when you try to compile, try moving or deleting src/ds_win.c and src/ds_gfx.c - they weren't supposed to be in the .zip and it takes too long to upload it again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78257 - sofakng - Thu Apr 06, 2006 4:45 am</h4>
    <div class="postbody"><span class="postbody">Excellent, thanks!
<br/>
<br/>
I'll take a look through the sourcecode to see what you have...
<br/>
<br/>
If I have any questions, would it be OK to e-mail you?
<br/>
<br/>
<br/>
Oh... and what are you using to compile this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78338 - Wosret - Thu Apr 06, 2006 11:32 pm</h4>
    <div class="postbody"><span class="postbody">I'm compiling it with DevKitPro r17, libnds-20060201, and the makefile from the combined template from nds-examples-20051019, all of which came from the latest DevKitPro Updater.  If you have questions, feel free to email me at <a href="mailto:gbadev@stuartp.commixus.com">gbadev@stuartp.commixus.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
