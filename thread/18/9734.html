<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>compiling woes - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > compiling woes</h2>
<div id="posts">
<div class="post">
    <h4>#85324 - Dannon - Mon May 29, 2006 12:52 am</h4>
    <div class="postbody"><span class="postbody">I am getting 2 errors for my input file when I compile:
<br/>
<br/>
error: redefinition of 'class CInput'
<br/>
error: previous definition of 'class CInput'
<br/>
<br/>
These errors are in reference to the:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
class CInput
<br/>
{
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This is the code that I have in my input_ds.h:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;nds.h&gt;
<br/>
<br/>
class CInput
<br/>
{
<br/>
public:
<br/>
   CInput();
<br/>
   ~CInput();
<br/>
<br/>
   bool Initialise();
<br/>
};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Any suggestions as to the problem, it's normally something really simple.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85326 - MrD - Mon May 29, 2006 1:30 am</h4>
    <div class="postbody"><span class="postbody">You might need to add some multiple-inclusion safeguards, to stop the file containing your class description from being included more than once:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#ifndef CINPUT_H
<br/>
#define CINPUT_H
<br/>
<br/>
#include &lt;nds.h&gt;
<br/>
<br/>
class CInput
<br/>
{
<br/>
public:
<br/>
   CInput();
<br/>
   ~CInput();
<br/>
<br/>
   bool Initialise();
<br/>
};
<br/>
<br/>
#endif /* CINPUT_H */</td> </tr></table><span class="postbody"><br/>_________________<br/>Not active on this forum. For Lemmings DS help see its website.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85327 - Dannon - Mon May 29, 2006 1:48 am</h4>
    <div class="postbody"><span class="postbody">Thanks, I think that got it.
<br/>
<br/>
Now I have a completely different error though, on my 'class CInput' line as shown in my previous code, as well as some others such as the Initialise function in main.c and the 'class CDisplay' line at the top of the display.h file, I am getting an error which says:
<br/>
<br/>
error: expected '=', ',', ', ', ;', 'asm', '__attribute__' before 'CInput'</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85331 - MrD - Mon May 29, 2006 2:16 am</h4>
    <div class="postbody"><span class="postbody">That error usually means that it hasn't recognised one of the tokens as a valid type. You can get that error if you do something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">struct Player {
<br/>
   int x,y;
<br/>
};
<br/>
<br/>
Player dave;</td> </tr></table><span class="postbody">
<br/>
<br/>
... when compiling under a strict C standard.
<br/>
<br/>
Just a guess, but try changing your class header file's extension from .h to .hpp.
<br/>
<br/>
Edit - The error might be because your main source file is a .c file, and you're trying to use the C++ classes feature. Try changing the class header to .hpp and the main source to main.cpp<br/>_________________<br/>Not active on this forum. For Lemmings DS help see its website.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85342 - Dannon - Mon May 29, 2006 4:22 am</h4>
    <div class="postbody"><span class="postbody">Changing my main.c to .cpp did it.
<br/>
<br/>
Thanks a lot, all problems, for the moment, solved. 
<br/>
<br/>
--Dannon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85598 - Dannon - Thu Jun 01, 2006 5:27 am</h4>
    <div class="postbody"><span class="postbody">More complaints from the compiler, it has started complaining about the ds variable types in some of my files such as v16, u32, u8.  It also comes up with the some errors for nds/arm9/console.h so I'm wondering if there is some kind of linking error, I have tried putting libnds back again but it did nothing. Any help?
<br/>
<br/>
--Dannon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85606 - MrD - Thu Jun 01, 2006 9:12 am</h4>
    <div class="postbody"><span class="postbody">Can you paste the errors?<br/>_________________<br/>Not active on this forum. For Lemmings DS help see its website.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85619 - wintermute - Thu Jun 01, 2006 11:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dannon wrote:</b></span></td> </tr> <tr> <td class="quote">More complaints from the compiler, it has started complaining about the ds variable types in some of my files such as v16, u32, u8.  It also comes up with the some errors for nds/arm9/console.h so I'm wondering if there is some kind of linking error, I have tried putting libnds back again but it did nothing. Any help?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You're probably using an old makefile, grab one from the latest examples.
<br/>
<br/>
for reference you should have
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
CXXFLAGS := $(CFLAGS) -fno-rtti -fno-exceptions 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
in the makefile<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85682 - Dannon - Thu Jun 01, 2006 7:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
./arm9/source/displayEntityModel_ds.h:18: error 'v16' has not been declared'
<br/>
./arm9/source/displayEntityModel_ds.h:18: error 'u32' has not been declared'
<br/>
./arm9/source/displayEntityModel_ds.h:18: error 'u32' has not been declared'
<br/>
./arm9/source/displayEntityModel_ds.h:18: error 'u32' has not been declared'
<br/>
./arm9/source/displayEntityModel_ds.h:20: error 'v16' has not been declared'
<br/>
<br/>
./arm9/source/world.cpp:157: error: 'class CInput' has no member named 'm_touchReadXY'
<br/>
./arm9/source/world.cpp:157: error: 'class CInput' has no member named 'm_touchReadXY'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This continues for any reference to v16, u16, u32, u8 throughout my code.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
./nds/arm9/console.h:33: error 'touchPosition' does not name a type
<br/>
./nds/arm9/console.h:42: error 'touchPosition' does not name a type
<br/>
./nds/arm9/console.h:94: error 'u16' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'font' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'u16' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'charBase' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'u16' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'u8' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'u16' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'map' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'u8' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error 'u8' was not declared in this scope
<br/>
./nds/arm9/console.h:94: error: initializer expression list treated as compound void
<br/>
./nds/arm9/console.h:104: error: variable of field 'consoleInitDefault' declared void
<br/>
./nds/arm9/console.h:104: error 'u16' was not declared in this scope
<br/>
./nds/arm9/console.h:104: error 'map' was not declared in this scope
<br/>
./nds/arm9/console.h:104: error 'u16' was not declared in this scope
<br/>
./nds/arm9/console.h:104: error 'charBase' was not declared in this scope
<br/>
./nds/arm9/console.h:104: error 'u8' was not declared in this scope
<br/>
./nds/arm9/console.h:104: error: initializer expression list treated as compound void
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I tried appending the makefile but it didn't seem to make any bit of difference.
<br/>
<br/>
Any other suggestions?
<br/>
<br/>
--Dannon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85701 - wintermute - Thu Jun 01, 2006 10:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dannon wrote:</b></span></td> </tr> <tr> <td class="quote">[code]
<br/>
I tried appending the makefile but it didn't seem to make any bit of difference.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
appending the makefile?
<br/>
<br/>
There's something very, very wrong with your build setup somewhere.
<br/>
<br/>
Try *replacing* your makefile with one of the standard ones from recent examples.
<br/>
<br/>
This looks like nds.h is not being included.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85732 - silent_code - Fri Jun 02, 2006 2:07 am</h4>
    <div class="postbody"><span class="postbody">hi,
<br/>
<br/>
first thing: you don'T have to make these #ifndefs and stuff, just make sure you have a #pragma once on top of each header file. this is just an alternative (and it works).
<br/>
<br/>
second issue looks like you missed to include the nds.h file... or something went really wrong with you make setup (as the others already said). try compiling one of the emapbles and then grab that makefile from it... but check if the nds.h is accessable from all .cpp files where it's needed! also look for include orders and the like!
<br/>
<br/>
Rob</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85739 - tepples - Fri Jun 02, 2006 2:48 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">first thing: you don'T have to make these #ifndefs and stuff, just make sure you have a #pragma once on top of each header file. this is just an alternative (and it works).</td> </tr></table><span class="postbody">
<br/>
#pragma once is not portable. If you switch compilers, or you switch versions of your compiler, your #pragmas may stop working. Always use #ifdef guards for multiple inclusion.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85751 - silent_code - Fri Jun 02, 2006 4:34 am</h4>
    <div class="postbody"><span class="postbody">as stated before: it's an alternative... well, i should have said that it depends on the compiler to support it. thanks tepples :)
<br/>
<br/>
it works well with gcc (and i think i remember ms vs6) and being a lazy person i use it for every header file i write. i find those ifndefs horrible.
<br/>
<br/>
though you're right, it can save you some work when switching compilers for a project. well, i won't switch ;p</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85754 - Dannon - Fri Jun 02, 2006 5:02 am</h4>
    <div class="postbody"><span class="postbody">Right then, I have uploaded my code to: <a class="postlink" href="http://dannons.50megs.com/index.html" target="_blank">http://dannons.50megs.com/index.html</a>, just click the link on the page.
<br/>
<br/>
It should currently be just displaying what buttons are being pressed and not being pressed, a bit of a glorified Hello World really, not very exciting but it's just a start, I am attempting a simple 3D engine with simple physics so this is me starting to setup all of my classes, etc.  
<br/>
<br/>
If I could also get a little feedback on how this setup would work on the DS, can the DS handle vector lists? Any other feedback would be greatly appreciated
<br/>
<br/>
--Dannon</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85756 - silent_code - Fri Jun 02, 2006 5:05 am</h4>
    <div class="postbody"><span class="postbody">what do you mean by vector lists... i know what they are, but what you want to use them for?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85757 - silent_code - Fri Jun 02, 2006 5:20 am</h4>
    <div class="postbody"><span class="postbody">dude, i checked it... i didn't look through all files, but the ones that yield the errors and i must admit that i can't find anything wrong. must be something quitte "special". i compared it to my projects (that all compile without error...) and the only difference is the directory layout. i use a source, a build, a data and an include dir. i also use the standard makefile. you seem to use the template, so that shouldn't be the point. i'd have to get a second look. don't know when i'll find some time for it, but it's quite an interesting thing.
<br/>
<br/>
i'd really like to know why this happens.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85788 - wintermute - Fri Jun 02, 2006 10:55 am</h4>
    <div class="postbody"><span class="postbody">from world.cpp
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
 1   //////////
<br/>
//   world.cpp   
<br/>
//   --Dannon
<br/>
//
<br/>
<br/>
#include "world.h"
<br/>
#include "input_ds.h"
<br/>
#include "display_ds.h"
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;nds/arm9/console.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Note the spurious first line which appears to be the source of your errors. You should also get into the habit of including nds.h <span style="font-weight: bold">first</span>. This is where the nds type definitions are included from.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//////////
<br/>
//   world.cpp   
<br/>
//   --Dannon
<br/>
//
<br/>
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
#include "world.h"
<br/>
#include "input_ds.h"
<br/>
#include "display_ds.h"
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85802 - silent_code - Fri Jun 02, 2006 12:39 pm</h4>
    <div class="postbody"><span class="postbody">i checked that, didn't work!? no change at all...
<br/>
<br/>
he used to include the nds.h nearly everywhere, still it won't compile.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85841 - wintermute - Fri Jun 02, 2006 4:01 pm</h4>
    <div class="postbody"><span class="postbody">No idea what to say.
<br/>
<br/>
The project compiled for me with that modification ( and the addition of a standard arm7 core - you seem to have missed the code for that in the archive )
<br/>
<br/>
Are you <span style="font-weight: bold">absolutely</span> sure you modified the right source file?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86063 - Dannon - Sun Jun 04, 2006 3:54 am</h4>
    <div class="postbody"><span class="postbody">It's all working fine now, I am such a retard sometimes when it comes to coding all my problems are always just over looked simple ones, anyway it was sorted pretty quickly, I have upgraded to R19 of devkitARM too and still no problems.  I noticed the arm7 code was missing I have no idea where it went, I just copied the one from the template.
<br/>
<br/>
I have another question now though, I have managed to get some 3D going now, but if I want to start it I have to start my program in 3D mode, I use the following code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
bool CDisplay::InitialiseInGame()
<br/>
{
<br/>
   powerON( POWER_ALL );
<br/>
<br/>
   videoSetMode(MODE_0_3D);
<br/>
   
<br/>
   videoSetModeSub( MODE_0_2D | DISPLAY_BG0_ACTIVE ); 
<br/>
<br/>
         SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
   BG_PALETTE_SUB[255] = RGB15(31,31,31);
<br/>
<br/>
//   Temp
<br/>
   consoleInitDefault( (u16*)SCREEN_BASE_BLOCK_SUB( 31 ), (u16*)CHAR_BASE_BLOCK_SUB( 0 ), 16 );
<br/>
<br/>
   irqInit();
<br/>
   irqEnable(IRQ_VBLANK);
<br/>
<br/>
   glViewPort(0,0,255,191);
<br/>
<br/>
   glClearColor(0,0,0);
<br/>
   glClearDepth(0x7FFF);
<br/>
<br/>
         return true;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Is there a way to switch the screen to using 3D so that I can jump from menu (all 2D from the simple graphics demos) to using 3D on the top screen, powerSET maybe?, and how do I get the console to run on the lower screen at the same time, do I need some more setup lines than above?
<br/>
<br/>
Thanks for all the help.
<br/>
<br/>
--Dannon</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
