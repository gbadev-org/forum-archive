<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Most efficient method of rendering huge polygons? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Most efficient method of rendering huge polygons?</h2>
<div id="posts">
<div class="post">
    <h4>#123391 - adzz182 - Tue Mar 27, 2007 9:40 pm</h4>
    <div class="postbody"><span class="postbody">I am quite new to openGL programming, I know there are many different methods of rendering polygons. As the DS is no processing powerhouse, could someone please explain to me the most resource efficient method.
<br/>
<br/>
Right now i am using Blender 3D for Mac OSX to create my 3D environment, i found a partially DS compatible plugin for Blender (which i am currently editing to make it more efficient) which exports your polygon as a long series of glVertex / glNormal calls 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Eg,
<br/>
<br/>
glBegin(1);
<br/>
      glNormal3f(0.257637, 0.417096, 0.871548);
<br/>
      glVertex3f(0.750000, -1.000000, -0.000000);
<br/>
      glNormal3f(0.257546, 0.488174, 0.833857);
<br/>
      glVertex3f(0.873768, -0.997926, -0.068859);
<br/>
      glNormal3f(0.210730, 0.194952, 0.957884);
<br/>
      glVertex3f(0.872332, -0.870509, -0.149090);
<br/>
      glNormal3f(0.287729, 0.279122, 0.916105);
<br/>
      glVertex3f(0.749025, -0.873358, -0.054499);
<br/>
glEnd();
<br/>
glBegin(1);
<br/>
etc
<br/>
etc
<br/>
etc
<br/>
</td> </tr></table><span class="postbody">
<br/>
Is this an efficient was of drawing polygons, or is using Vertex arrays or maybe Height Maps better?
<br/>
<br/>
Thanks alot</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123399 - simonjhall - Tue Mar 27, 2007 10:09 pm</h4>
    <div class="postbody"><span class="postbody">That isn't the best way of doing it, as those are the floating-point wrapper functions, and the DS has no floating-point unit.
<br/>
A better way is to convert (offline, or at load time) all your floating-point vertices and normals to the fixed-point format used by the DS.
<br/>
<br/>
For instance, the DS vertex format that I use (look <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#ds3dpolygondefinitionsbyvertices" target="_blank">http://nocash.emubase.de/gbatek.htm#ds3dpolygondefinitionsbyvertices</a> for more details) is the 4.12 fixed-point format. So when I load all my verts I multiply them by 4096 to get them into this format, then truncate them to ints.
<br/>
<br/>
Then when it comes to actually doing the glVertex3f call I do this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define GFX_BEGIN         (*(volatile unsigned int *) 0x04000500)
<br/>
#define GFX_VERTEX16          (*(volatile unsigned int *) 0x0400048C)
<br/>
#define DS_BEGIN_TRIANGLE() GFX_BEGIN = 0
<br/>
#define DS_VERTEX3V16(x, y, z) GFX_VERTEX16 = (y &lt;&lt; 16) | (x &amp; 0xFFFF); GFX_VERTEX16 = ((unsigned int)(unsigned short)z)
<br/>
<br/>
....
<br/>
DS_BEGIN_TRIANGLE();
<br/>
DS_VERTEX3V16(vert_x, vert_y, vert_z);
<br/>
DS_VERTEX3V16(vert_x2, vert_y2, vert_z2);
<br/>
DS_VERTEX3V16(vert_x3, vert_y3, vert_z3);
<br/>
...
<br/>
</td> </tr></table><span class="postbody">etc. This way you don't need to do expensive fp stuff per-tri.
<br/>
There's no need for a glEnd().
<br/>
There are also (native) fixed-point versions of glTexcoord2f and glNormal3f. Read that web page :-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123400 - silent_code - Tue Mar 27, 2007 10:24 pm</h4>
    <div class="postbody"><span class="postbody">plus, you will have your models hardcoded inside the executable and that is not what you want in the long term. btw: don't mix up opengl with libnds' gl. it's similar, but not fully compatible.
<br/>
<br/>
you better store your models in some file format and write a rendering routine that takes a set of vertex/primitive (triangle, quad whatever) data (a mesh) and displays it. or you export the meshes to native nds display list binaries. you decide.</span><span class="gensmall"><br/><br/>Last edited by silent_code on Sun Apr 01, 2007 6:33 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#123442 - ikaris - Wed Mar 28, 2007 6:20 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">you better store your models in some file format and write a rendering routine that takes a set of vertex/primitive (triangle, quad whatever) data (a mesh) and displays it. or you export the meshes to native nds display list binaries. you decide.</td> </tr></table><span class="postbody">
<br/>
<br/>
Though it depends upon what you're after, I would personally recommend the former (rendering routine).  That's what I'm doing now since it allows me to do UV animation, skinning, etc...
<br/>
<br/>
However, if you want to generate a display list and you can get your hands on a copy of Maya, you can use my Display List Exporter:
<br/>
<br/>
<a href="http://www.vurtx.com/tools/dlDSDisplayListExporter.zip" target="_blank">http://www.vurtx.com/tools/dlDSDisplayListExporter.zip</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123890 - M3d10n - Sun Apr 01, 2007 5:10 am</h4>
    <div class="postbody"><span class="postbody">Hey, Ikaris, why don't you give the FBX SDK a look? 
<br/>
<br/>
I believe your exporter would become more widely used if you created a FBX-to-DSdl converter. You'd support many programs in a single strike, since most big apps can export FBX files (with the glorious exception of Blender, it seems.)
<br/>
<br/>
You could also try the Collada SDK.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
