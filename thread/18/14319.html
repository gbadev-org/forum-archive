<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>devkitARM r20 gotchas thread? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > devkitARM r20 gotchas thread?</h2>
<div id="posts">
<div class="post">
    <h4>#142818 - abszero - Sat Oct 13, 2007 10:56 pm</h4>
    <div class="postbody"><span class="postbody">It seems like it would be helpful to have a stickied list of known issues in r20 for quick reference.  All those things that one might assume would work but don't.
<br/>
<br/>
I'd start such a thread myself but it probably makes more sense for a mod to create/maintain it since I won't necessarily be around to update the first post with new gotchas all the time.  Maybe a wiki or something would be a better solution for continuous updating but I don't have any experience in setting those up...
<br/>
<br/>
Anyways, a few off the top of my head are:
<br/>
  -rename (stdio.h) doesn't work
<br/>
  -time (time.h) doesn't work
<br/>
  -IPC-&gt;time is not updated with the current time by the default ARM7 code
<br/>
  -fseek (stdio.h) can and occasionally does call _FAT_seek_r (from libfat's fatfile.c) with an unchecked null pointer, resulting in crashes/exceptions</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142831 - Peter - Sun Oct 14, 2007 8:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>abszero wrote:</b></span></td> </tr> <tr> <td class="quote">It seems like it would be helpful to have a stickied list of known issues in r20 for quick reference.  All those things that one might assume would work but don't.</td> </tr></table><span class="postbody">
<br/>
It make sense to post bugs into the devkitPro bug-tracker, wouldn't it?
<br/>
<br/>
<a class="postlink" href="http://sourceforge.net/tracker/?atid=668551&amp;group_id=114505&amp;func=browse" target="_blank">devkitPro Bug Tracker</a>
<br/>
<a class="postlink" href="http://sourceforge.net/tracker/?atid=668554&amp;group_id=114505&amp;func=browse" target="_blank">devkitPro Feature Requests</a><br/>_________________<br/>Kind Regards,
<br/>
Peter</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142832 - NeX - Sun Oct 14, 2007 10:20 am</h4>
    <div class="postbody"><span class="postbody">That sentence didn't make sense.  :D<br/>_________________<br/><a class="postlink" href="http://www.mediafire.com/?cuyb10fzdz2" target="_blank">Strummer</a> or <a class="postlink" href="http://www.mediafire.com/?71zxcztscix" target="_blank">Drummer?</a>.  
<br/>
Or maybe you would rather play with sand? <a class="postlink" href="http://www.mediafire.com/?a05z5wmdvxm" target="_blank">Sandscape is for you in that case.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142841 - tepples - Sun Oct 14, 2007 1:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>abszero wrote:</b></span></td> </tr> <tr> <td class="quote">It seems like it would be helpful to have a stickied list of known issues in r20 for quick reference.</td> </tr></table><span class="postbody">
<br/>
It make sense to post bugs into the devkitPro bug-tracker, wouldn't it?
<br/>
<br/>
<a class="postlink" href="http://sourceforge.net/tracker/?atid=668551&amp;group_id=114505&amp;func=browse" target="_blank">devkitPro Bug Tracker</a>
<br/>
<a class="postlink" href="http://sourceforge.net/tracker/?atid=668554&amp;group_id=114505&amp;func=browse" target="_blank">devkitPro Feature Requests</a></span></td> </tr></table><span class="postbody">
<br/>
I thought discussing the bugs here before asking the developers would have benefit for much the same reason that projects such as Mozilla Firefox have "release notes" at the same time that they have public bug trackers:
<br/>
<ul><li>One could read a list of the most commonly encountered unexpected behaviors in one place, especially such behaviors that turn out to be intended. </li><li>We wouldn't waste the developers' time with duplicate defect reports. </li></ul>
<br/>
Here are some gotchas that I have found or read about: <ul><li>In the libnds version released alongside r20, VRAM_B_MAIN_SPRITE places bank B at 0x06420000, not 0x06400000 as in older versions. This could cause sprites to disappear. (Intended.) </li><li>The IPC structure in libnds tends to change right around the time devkitARM gets an update. If you use a custom ARM7 code, and you find that a libnds update breaks your program, then copy and paste your custom code into the ARM7 code from the combined template. </li><li>The devoptab allows no way for a read-write file system such as libfat to report back the amount of free space for additional files. (Fix rumored for r21.) </li><li>GCC depends on file system semantics of Windows XP and older operating systems to find its worker programs. Windows Vista changed file system semantics in the interest of security. Using devkitARM r20 under Windows Vista needs a path workaround. (Fix rumored for r21, which may break this workaround.) </li></ul><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142843 - Mighty Max - Sun Oct 14, 2007 2:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<ul><li>One could read a list of the most commonly encountered unexpected behaviors in one place, especially such behaviors that turn out to be intended. </li><li>We wouldn't waste the developers' time with duplicate defect reports. </li></ul></td> </tr></table><span class="postbody">
<br/>
<br/>
This is exactly what a bugtracker is supposed to do.
<br/>
Channeling bugreports. It does not make much sense to decentralize this channeling again, as this is making the bugtracker moo: "What this bug is not known? But i reported this on forum.noonecares.com!"
<br/>
<br/>
For multiples there are means on both sides in a bugtracker: Merging/Closing duplicates for the devs and "Search bugs" for the reporters.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142845 - tepples - Sun Oct 14, 2007 3:17 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mighty Max wrote:</b></span></td> </tr> <tr> <td class="quote">But i reported this on forum.noonecares.com!</td> </tr></table><span class="postbody">
<br/>
The idea is that someone who reads both forum.noonecares.com and the project's official issue tracker would see that the issue report concerns an actual defect[1], not a <a class="postlink" href="http://en.wikipedia.org/wiki/PICNIC" target="_blank">PICNIC</a>, and suggest that the reporter elevate it to the developers. I see this idiom between mozillaZine forums and bugzilla.mozilla.org sometimes.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mighty Max wrote:</b></span></td> </tr> <tr> <td class="quote">For multiples there are means on both sides in a bugtracker: Merging/Closing duplicates for the devs and "Search bugs" for the reporters.</td> </tr></table><span class="postbody">
<br/>
True, but search isn't perfect. A lot of issue trackers come initially set to "Search only open issues", which does not return any results for issues that are fixed in CVS but not in released binaries ("RESOLVED FIXED" in Bugzilla), or for issues that are closed as intended behavior ("RESOLVED INVALID" in Bugzilla). It might be that the devkitPro developers don't mind duplicates reported by the "unwashed masses" who can't figure out the intricacies of a particular issue tracker's search feature, but is this the case?
<br/>
<br/>
A couple issues I posted in various projects' SourceForge.net issue trackers got shot down. Some projects don't specify whether standards conformance issues are treated as defects or as missing features: "You should have posted this in Feature Requests." Sometimes the reporter can't figure out a rationale for maintainers' priority decisions: "If you wanted this feature to be in the top 1,000 priorities, you should have implemented it yourself and posted your code in Patches." Even with sample code that demonstrates the algorithms that would be used, the integration burden falls on the person who discovered the issue: "Your demonstration is not acceptable. You should have implemented it yourself <span style="font-style: italic">in the domain-specific language I prefer</span> and provided a <span style="font-style: italic">patch that applies cleanly</span> against CVS".
<br/>
<br/>
This may warrant a topic for discussing the subtleties of search in SourceForge.net issue trackers.
<br/>
<br/>
[1] To me, a "bug" is Beedrill, not Missingno. A "bug" is an <a class="postlink" href="http://en.wikipedia.org/wiki/Arthropod" target="_blank">arthropod</a>. A software defect is a software defect.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142898 - abszero - Sun Oct 14, 2007 10:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>abszero wrote:</b></span></td> </tr> <tr> <td class="quote">It seems like it would be helpful to have a stickied list of known issues in r20 for quick reference.  All those things that one might assume would work but don't.</td> </tr></table><span class="postbody">
<br/>
It make sense to post bugs into the devkitPro bug-tracker, wouldn't it?
<br/>
<br/>
<a class="postlink" href="http://sourceforge.net/tracker/?atid=668551&amp;group_id=114505&amp;func=browse" target="_blank">devkitPro Bug Tracker</a>
<br/>
<a class="postlink" href="http://sourceforge.net/tracker/?atid=668554&amp;group_id=114505&amp;func=browse" target="_blank">devkitPro Feature Requests</a></span></td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah, I had thought that too, but as it stands there seem to be only six relatively obscure bugs listed in the tracker, which suggests to me that either a) the tracker isn't being actively used for these types of things b) I don't know how to read the tracker properly, neither of which made it a very tempting option to me :P.  
<br/>
<br/>
And moreover, in my somewhat limited experience, trackers tend to be filled with lots of little obscure bugs, whereas I intended this list to be more common things that an average developer will probably run into, sorta like tepples mentioned.
<br/>
<br/>
Well, I need to run for now but I'll update the top post later with tepples' issues and with workarounds to the ones I listed originally.   I can probably even add links to the original thread discussions for those too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142901 - Dood77 - Sun Oct 14, 2007 10:14 pm</h4>
    <div class="postbody"><span class="postbody">I don't have much if any knowledge about bug-tracking and such, but maybe this forum would be more useful than the standard online bug-tracker because it offers the possibility of discussion, it being in a forum format.<br/>_________________<br/>If I use a term wrong or something then feel free to correct, I?m not much of a programmer.
<br/>
<span style="font-size: 9px; line-height: normal">
<br/>
Original DS Phat obtained on day of release + flashme v7
<br/>
Supercard: miniSD, Kingston 1GB, Kingston 2GB
<br/>
Ralink chipset PCI NIC
<br/>
</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142913 - wintermute - Mon Oct 15, 2007 12:52 am</h4>
    <div class="postbody"><span class="postbody">The six bugs you mention are the ones that remain open. There are several more bugs which have been fixed and closed.
<br/>
<br/>
The active maintainers tend not to read every thread on this or any other forum.
<br/>
<br/>
Where bugs are submitted with a proper test case they tend to be dealt with fairly quickly. If a proven fix is submitted that time will be even shorter.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Anyways, a few off the top of my head are:
<br/>
-rename (stdio.h) doesn't work
<br/>
-time (time.h) doesn't work
<br/>
-IPC-&gt;time is not updated with the current time by the default ARM7 code
<br/>
-fseek (stdio.h) can and occasionally does call _FAT_seek_r (from libfat's fatfile.c) with an unchecked null pointer, resulting in crashes/exceptions
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
None of the elements in the IPC struct should be depended on by user code. Once I find a good way of removing the struct entirely it will vanish but until then the struct can and will be subject to change.
<br/>
<br/>
Currently, as far as I can test the others have all been fixed in R21. I still have a final test run to do of the main toolchain then check the examples against CVS libnds before a final release.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
GCC depends on file system semantics of Windows XP and older operating systems to find its worker programs. Windows Vista changed file system semantics in the interest of security. Using devkitARM r20 under Windows Vista needs a path workaround. (Fix rumored for r21, which may break this workaround.)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Incorrect.
<br/>
<br/>
Vista changed the default behaviour of certain filesytem related functions in the name of security. The path "workaround" that is being suggested is not applicable to any future updates of devkitARM and will, in all probability , break the toolchain.
<br/>
<br/>
<span style="font-weight: bold">note:</span> The "fix" <span style="font-weight: bold">will probably</span> break the toolchain. The order of that statement is important.
<br/>
<br/>
More generally, I have to say this thread is unlikely to be useful. The bug tracker is the best way to have problems looked at and fixed. Threads like this tend to hang around long past their sell by date &amp; cause more issues than they solve.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142920 - tepples - Mon Oct 15, 2007 2:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Windows Vista changed file system semantics in the interest of security.</td> </tr></table><span class="postbody">
<br/>
Incorrect.
<br/>
<br/>
Vista changed the default behaviour of certain filesytem related functions in the name of security.</span></td> </tr></table><span class="postbody">
<br/>
I don't understand how this differs from what I wrote.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">More generally, I have to say this thread is unlikely to be useful. The bug tracker is the best way to have problems looked at and fixed.</td> </tr></table><span class="postbody">
<br/>
In theory, you'd be right. But do you have any search tips for novices to SourceForge.net's bug tracker? The default behaviors of most bug trackers' built-in search differ from the default behaviors of Google, Yahoo!, and Windows Live search, and these differences confuse some novices.
<br/>
<br/>
Would a topic like this be useful if each entry were to link to an artifact on SF.net?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142926 - wintermute - Mon Oct 15, 2007 6:02 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Windows Vista changed file system semantics in the interest of security.</td> </tr></table><span class="postbody">
<br/>
Incorrect.
<br/>
<br/>
Vista changed the default behaviour of certain filesytem related functions in the name of security.</span></td> </tr></table><span class="postbody">
<br/>
I don't understand how this differs from what I wrote.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Your statement seemed to imply that the filesystem itself has changed in some way and that GCC was dependent on features of the old system. In actual fact Vista now fails if previously "don't care" bits are set in file attributes for particular functions. 
<br/>
<br/>
You also missed the important part of my correction in your quote. The alleged "workaround" is nothing more than an ill advised hack which <span style="font-weight: bold">will</span> cause issues.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">More generally, I have to say this thread is unlikely to be useful. The bug tracker is the best way to have problems looked at and fixed.</td> </tr></table><span class="postbody">
<br/>
In theory, you'd be right. But do you have any search tips for novices to SourceForge.net's bug tracker? The default behaviors of most bug trackers' built-in search differ from the default behaviors of Google, Yahoo!, and Windows Live search, and these differences confuse some novices.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I'm really rather confused by this. If a bug is reported in the tracker it gets looked at and fixed if possible. I don't really see what search has to do with anything - duplicate reports can be closed &amp; redirected, it's not a huge issue.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Would a topic like this be useful if each entry were to link to an artifact on SF.net?</td> </tr></table><span class="postbody">
<br/>
<br/>
Not really, no.
<br/>
<br/>
The purpose of a bugtracker is to give the maintainers a document of an issue. Once the issue is cleared it's not generally that relevant to anyone not maintaining toolchain code.
<br/>
<br/>
Ultimately my point was that issues which get reported via the mailing lists or trackers will get dealt with much sooner than anything posted on a forum.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"><br/><br/>Last edited by wintermute on Mon Oct 15, 2007 6:17 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#142928 - keldon - Mon Oct 15, 2007 6:16 am</h4>
    <div class="postbody"><span class="postbody">I was under the impression that the thread was about the noted issues and not bug tracking them. Of course these issues can be listed on the release notes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142930 - wintermute - Mon Oct 15, 2007 6:22 am</h4>
    <div class="postbody"><span class="postbody">Yet the noted issues were in fact bugs &amp; should have been reported in the bugtracker.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142934 - keldon - Mon Oct 15, 2007 9:05 am</h4>
    <div class="postbody"><span class="postbody">Ah, maybe people need to be encouraged to make more bug reports and not assume that a bug is something to "live with".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142935 - Dwedit - Mon Oct 15, 2007 9:16 am</h4>
    <div class="postbody"><span class="postbody">The devkitpro.org web site is worse than useless.  From all the information posted there, I would not even know that the source code to libnds even existed.
<br/>
<br/>
Devkitpro.org really <span style="font-weight: bold">really</span> needs to liberally add links to the sourceforge site in places wherever it's appropriate.  For example, from the "Download" page, I should be able to get to the browsable CVS tree.
<br/>
<br/>
Bold White text placed next to nonbold white text does not look like links.  Finding the hidden white links is like playing "Where's Waldo".  Fix the damn CSS.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#142951 - keldon - Mon Oct 15, 2007 1:10 pm</h4>
    <div class="postbody"><span class="postbody">Actually that website is a little 'naughty', but having said that until you mentioned it the CSS never flagged any warning signs! My usability nag for the website has been (to the best of my memory) resolved.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
