<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dualis glCallList problems? Try this.... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Dualis glCallList problems? Try this....</h2>
<div id="posts">
<div class="post">
    <h4>#103713 - DiscoStew - Sun Sep 24, 2006 1:48 am</h4>
    <div class="postbody"><span class="postbody">Unless my computer just sucks, I don't think I'm the only one that is having problems when trying to run a display list in Dualis. Symptoms I've seen ranged from both screens flickering to even just nothing showing up on the 3D screen. I have no hardware to allow me to test on my own DS, and Ideas doesn't seem to have a Z-buffer to show what the object would really look like, or even run at 60FPS. I've been using ikaris's Maya exporter, but haven't been able to get anything displayed in Dualis.
<br/>
<br/>
Luckly, it seemed that drawing the scene manually works in Dualis, so I decided to try and just take the display list, and do the commands for each manually, and I'm glad I did, for now I have a way of making my objects render.
<br/>
<br/>
This code is just a method for getting around having to use glCallList, but it is NOT a replacement. Not only is it unoptimized and slow since it's doing things manually, but it isn't even complete, and I have only been doing tests with objects I make in Maya and using ikaris's exporter, which only exports certain attributes of the objects. If you know how each of the commands work, then it should be easy enough to add to what I have. If your display list has other commands that this function isn't doing, you will need to add those commands yourself, or you will run into problems with this.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void InterpretDisplayList(u32* list)
<br/>
{
<br/>
   u32 CurCommandList = 0;
<br/>
   u32 CommandCheck = 0;
<br/>
   u32 count = *list++;
<br/>
   u32 CommandList = 0;
<br/>
   while (count &gt; 0)
<br/>
   {
<br/>
      CurCommandList = *list++;
<br/>
      CommandCheck = 0;
<br/>
      for(CommandList = 0; CommandList &lt; 4; CommandList++, CommandCheck += 8)
<br/>
      {
<br/>
         u32 CurCommand = ((CurCommandList &gt;&gt; CommandCheck) &amp; 0x000000FF);
<br/>
         switch (CurCommand)
<br/>
         {
<br/>
         case 0:                  //FIFO_NOP
<br/>
            break;
<br/>
         case 32:               //FIFO_COLOR
<br/>
            GFX_COLOR = *list++;
<br/>
            count--;
<br/>
            break;
<br/>
         case 33:               //FIFO_NORMAL
<br/>
            GFX_NORMAL = *list++;
<br/>
            count--;
<br/>
            break;
<br/>
         case 34:               //FIFO_TEX_COORD
<br/>
            GFX_TEX_COORD = *list++;
<br/>
            count--;
<br/>
            break;
<br/>
         case 35:               //FIFO_VERTEX16:
<br/>
            GFX_VERTEX16 = *list++;
<br/>
            GFX_VERTEX16 = *list++;
<br/>
            count -= 2;
<br/>
            break;
<br/>
         case 64:               //FIFO_BEGIN
<br/>
            GFX_BEGIN = *list++;
<br/>
            count--;
<br/>
            break;
<br/>
         case 65:               //FIFO_END
<br/>
            GFX_END = 0;
<br/>
            break;
<br/>
         }
<br/>
      }
<br/>
      count--;
<br/>
   }
<br/>
   return;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
Again, it is NOT a replacement for glCallList, but rather just a temporary workaround if you having the same troubles as I am. And please don't point out problems in my code, like it being sloppy and such, because it wasn't my intention to make it look good or organized. I just wanted it working.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103762 - Sausage Boy - Sun Sep 24, 2006 12:40 pm</h4>
    <div class="postbody"><span class="postbody">NOP support (among other things, possibly) is broken in dualis.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
