<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How can i change arm9 execute address? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > How can i change arm9 execute address?</h2>
<div id="posts">
<div class="post">
    <h4>#117308 - alex_III - Sat Feb 03, 2007 7:00 pm</h4>
    <div class="postbody"><span class="postbody">I use devkitPro libnds to write ds program.
<br/>
arm9 execute address default is 0x02000000
<br/>
Is there any way to change it? 
<br/>
for example change to 0x02500000
<br/>
I have no idea ..thx a lot</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117314 - tepples - Sat Feb 03, 2007 8:04 pm</h4>
    <div class="postbody"><span class="postbody">The main RAM is 0x02000000 through 0x023FFFFF. Did you <span style="font-style: italic">want</span> to execute out of an address mirror?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117322 - alex_III - Sat Feb 03, 2007 8:37 pm</h4>
    <div class="postbody"><span class="postbody">just for example...change to 0x02100000</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117323 - tepples - Sat Feb 03, 2007 8:41 pm</h4>
    <div class="postbody"><span class="postbody">I'm guessing that this would involve changes to the link script and to the parameters passed to ndstool.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117340 - Lick - Sat Feb 03, 2007 11:38 pm</h4>
    <div class="postbody"><span class="postbody">Go to your Makefile, look up the line with ndstool and add parameters to change the address. 
<br/>
<br/>
To find the parameters, simply run ndstool.exe for the usage.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117359 - alex_III - Sun Feb 04, 2007 3:55 am</h4>
    <div class="postbody"><span class="postbody">i tried the parameters
<br/>
<br/>
-r9 0x02100000(ARM9 RAM address)
<br/>
-e9 0x02100000(ARM9 RAM entry)
<br/>
<br/>
addresses changed but .nds can't run now..
<br/>
maybe these parameters just change the addresses in header</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117369 - Sausage Boy - Sun Feb 04, 2007 10:24 am</h4>
    <div class="postbody"><span class="postbody">It most likely doesn't work because your program thinks it's running from 0x02000000 anyways. You need to change that at some other place, if you're lucky it's in the Makefile, or maybe it's hidden somewhere deep in devkitARM. What are you trying to accomplish anyways?<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117386 - alex_III - Sun Feb 04, 2007 4:13 pm</h4>
    <div class="postbody"><span class="postbody">hope you can understand my english
<br/>
i try to write a ds game trainer
<br/>
the trainer have to run before ds game
<br/>
actually i don't know how to do it..i am a rookie
<br/>
<br/>
i use devkitPro libnds to write a ds game trainer.
<br/>
and add trainer to the end of ds game arm9
<br/>
then from game's arm9 execute address jump to trainer
<br/>
finally at the end of trainer jump back to ds game
<br/>
so i want to know how to change trainer's arm9 execute address
<br/>
or is there any better way to do it?
<br/>
<br/>
for example
<br/>
02000800 b 02100000 ds game arm9 execute address
<br/>
02000804 
<br/>
   :
<br/>
020FFFFC            ds game arm9 end
<br/>
<br/>
<br/>
02100000            trainer start
<br/>
02100004
<br/>
   :
<br/>
02110000 b 02000804 trainer end</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117399 - tepples - Sun Feb 04, 2007 5:11 pm</h4>
    <div class="postbody"><span class="postbody">What you want to do is edit <span style="font-weight: bold">a copy of</span> the link script so that your trainer code is linked to run from 0x02100000.
<br/>
<br/>
EDIT: clarification of what I meant, in bold<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"><br/><br/>Last edited by tepples on Sun Feb 04, 2007 6:37 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#117405 - wintermute - Sun Feb 04, 2007 6:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">What you want to do is edit the link script so that your trainer code is linked to run from 0x02100000.</td> </tr></table><span class="postbody">
<br/>
<br/>
No, you most definitely don't want to do that.
<br/>
<br/>
In the arm9 Makefile for your project (you are using one of the standardised templates aren't you) you need to edit LDFLAGS so it reads as follows.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
LDFLAGS   =   -specs=ds_arm9.specs -Wl,--section-start,.init=0x02100000 -g $(ARCH) -Wl,-Map,$(notdir $*.map)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The address given can be anywhere in ewram.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117409 - kusma - Sun Feb 04, 2007 6:50 pm</h4>
    <div class="postbody"><span class="postbody">another simple solution would be to overwrite the first instruction of the application (the one at 02000000?) with a branch to an unused location. Then do your patching, and perform the original first instruction before branching back.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117417 - alex_III - Sun Feb 04, 2007 8:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
LDFLAGS   =   -specs=ds_arm9.specs -Wl,--section-start,.init=0x02100000 -g $(ARCH) -Wl,-Map,$(notdir $*.map)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It's working!!
<br/>
thanks to everyone for helping!!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117475 - wintermute - Mon Feb 05, 2007 1:20 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">What you want to do is edit <span style="font-weight: bold">a copy of</span> the link script so that your trainer code is linked to run from 0x02100000.
<br/>
<br/>
EDIT: clarification of what I meant, in bold</td> </tr></table><span class="postbody">
<br/>
<br/>
Marginally better but still no cigar.
<br/>
<br/>
The advantage of the approach I specified using linker flags is that it will still work even if the linkscript changes.
<br/>
<br/>
When I switched from arm-elf to arm-eabi tools several things changed in the linkscripts and the crt0 files and the old files were no longer compatible with the new toolchain. If future binutils updates require tweaks then using a copy of the old linkscripts will cause failures again.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
