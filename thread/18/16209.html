<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>SDL_LoadBMP crahes SDL on NDS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > SDL_LoadBMP crahes SDL on NDS</h2>
<div id="posts">
<div class="post">
    <h4>#164699 - RatherBeerBrew - Fri Nov 14, 2008 3:00 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I just installed SDL-port for NDS in DevkitPro. But I've got some problems...
<br/>
<br/>
if I use "SDL_LoadBMP" to load my .bmp-Images, SDL/NDS crashes. Is there any howto/tutorial f?r using bitmaps on NDS-port of SDL?
<br/>
<br/>
Here's what I do:
<br/>
<br/>
8&lt; 8&lt; 8&lt; 8&lt; 8&lt; 8&lt; 8&lt; 8&lt; 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pac = SDL_LoadBMP("gfx\pac.bmp");
<br/>
   if ( pac == NULL) {
<br/>
      printf("Can't load image of tux: %s", SDL_GetError());
<br/>
      exit(1);
<br/>
   };</td> </tr></table><span class="postbody">
<br/>
&gt;8 &gt;8 &gt;8 &gt;8 &gt;8 &gt;8 &gt;8 &gt;8
<br/>
<br/>
BTW: on SDL-ports for PC/LINUX/Wii &gt;&gt;this&lt;&lt; source works fine! Any Ideas?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#164704 - Ludo6431 - Fri Nov 14, 2008 7:50 pm</h4>
    <div class="postbody"><span class="postbody">I never used SDL nor on DS neither on PC, but have you correctly initialized the fat system ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#164758 - RatherBeerBrew - Tue Nov 18, 2008 10:31 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ludo6431 wrote:</b></span></td> </tr> <tr> <td class="quote">I never used SDL nor on DS neither on PC, but have you correctly initialized the fat system ?</td> </tr></table><span class="postbody">
<br/>
<br/>
No, but dark voices told me that NDS is a rom image and fat can't be used. So I have to convert .bmp into .c and bind into my source, right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#164761 - thedopefish - Tue Nov 18, 2008 3:52 pm</h4>
    <div class="postbody"><span class="postbody">The dark voices lied to you.
<br/>
<br/>
You can link binary data like your .bmp directly into your application, which means you get at your data by just referencing a variable rather than loading an actual file.  For images in particular, you can use grit to convert them into a DS-friendly format, which makes them more efficient to deal with in your code.
<br/>
<br/>
However, you also have the option of using libfat, which allows you to read and write files just like you would in an ordinary PC application.
<br/>
<br/>
Also, note that SDL is not really ideal to use on the DS, because it does not take full advantage of the hardware.  You should consider looking into the DS' native graphics functionality instead.<br/>_________________<br/>#include &lt;sig.h&gt;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#164808 - HyperHacker - Sat Nov 22, 2008 6:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RatherBeerBrew wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pac = SDL_LoadBMP("gfx\pac.bmp");
<br/>
   if ( pac == NULL) {
<br/>
      printf("Can't load image of tux: %s", SDL_GetError());
<br/>
      exit(1);
<br/>
   };</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">"gfx<span style="color: #FF0000">/</span>pac.bmp"<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#164810 - Ludo6431 - Sat Nov 22, 2008 9:21 am</h4>
    <div class="postbody"><span class="postbody">I'm sure that you can't load your ".c" bmp like this :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pac = SDL_LoadBMP("gfx\pac.bmp");
<br/>
   if ( pac == NULL) {
<br/>
      printf("Can't load image of tux: %s", SDL_GetError());
<br/>
      exit(1);
<br/>
   };</td> </tr></table><span class="postbody">
<br/>
<br/>
I think SDL_LoadBMP load a bmp from the fat fs.
<br/>
try to  add :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;fat.h&gt;
<br/>
if(!fatInitDefault()) {
<br/>
printf("Can't initialise fat fs\n");
<br/>
exit(1);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
on top of your code.
<br/>
<br/>
put this instead of your code :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">pac = SDL_LoadBMP("/pac.bmp");
<br/>
   if ( pac == NULL) {
<br/>
      printf("Can't load image of tux: %s", SDL_GetError());
<br/>
      exit(1);
<br/>
   };</td> </tr></table><span class="postbody">
<br/>
and put the file pac.bmp on the root of your memory card.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
