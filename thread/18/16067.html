<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DLDI Question... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > DLDI Question...</h2>
<div id="posts">
<div class="post">
    <h4>#163078 - darkchild - Sun Sep 21, 2008 10:24 pm</h4>
    <div class="postbody"><span class="postbody">Is it possible to print onscreen which DLDI device the NDS Rom is patched for?
<br/>
if so, how?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163080 - silent_code - Sun Sep 21, 2008 10:39 pm</h4>
    <div class="postbody"><span class="postbody">Yes, it is. There's an identifier of some sort and an API function that returns it, iIrc. Please search the forum.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163081 - AntonioND - Sun Sep 21, 2008 10:43 pm</h4>
    <div class="postbody"><span class="postbody">Take a look at this:
<br/>
<a href="http://chishm.drunkencoders.com/libfat/index.html" target="_blank">http://chishm.drunkencoders.com/libfat/index.html</a>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><span style="font-weight: bold">stat</span>
<br/>
<br/>
The stat information of a file includes some useful information.
<br/>
<br/>
The st_ino field contains the start cluster number of the file, which can be passed to NDSMP.
<br/>
<br/>
The st_dev field contains a unique identifier for the inserted device. For example, for a file openned on the GBAMP CF, the st_dev has a value of 0x4643504D. This is 'MPCF' if placed in a string.</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163082 - darkchild - Sun Sep 21, 2008 11:28 pm</h4>
    <div class="postbody"><span class="postbody">can you give me an example?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163098 - AntonioND - Mon Sep 22, 2008 3:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>darkchild wrote:</b></span></td> </tr> <tr> <td class="quote">can you give me an example?</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;dir.h&gt;
<br/>
#include &lt;unistd.h&gt;
<br/>
<br/>
struct stat st;
<br/>
char filename[MAXPATHLEN];
<br/>
DIR_ITER* dir;
<br/>
<br/>
dir = diropen ("/"); 
<br/>
<br/>
if (dir == NULL) 
<br/>
   iprintf ("Unable to open the directory.\n");
<br/>
else if (dirnext(dir, filename, &amp;st) == 0) 
<br/>
   iprintf ("Device: %s\n", st.st_dev);
<br/>
else    iprintf ("Didn't find any file.\n");
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I haven't tested it, but it should work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163102 - darkchild - Mon Sep 22, 2008 4:26 pm</h4>
    <div class="postbody"><span class="postbody">My DS shows a black screen when I print the device name :X
<br/>
on the emulator (DeSmuME It shows nothing :X)
<br/>
<br/>
edit:
<br/>
<br/>
ST_DEV returns an integer..
<br/>
That's why it crashed..</span><span class="gensmall"><br/><br/>Last edited by darkchild on Mon Sep 22, 2008 4:35 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#163103 - AntonioND - Mon Sep 22, 2008 4:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>darkchild wrote:</b></span></td> </tr> <tr> <td class="quote">My DS shows a black screen when I print the device name :X
<br/>
on the emulator (DeSmuME It shows nothing :X)</td> </tr></table><span class="postbody">
<br/>
Try with %d instead of %s.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163104 - darkchild - Mon Sep 22, 2008 4:35 pm</h4>
    <div class="postbody"><span class="postbody">as I found out XD it now only shows a number, but what can I do with this number?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163106 - thoduv - Mon Sep 22, 2008 5:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">iprintf ("Device: %c%c%c%c\n", (st.st_dev&gt;&gt;24)&amp;0xff,(st.st_dev&gt;&gt;16)&amp;0xff,(st.st_dev&gt;&gt;8)&amp;0xff,(st.st_dev)&amp;0xff); </td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163109 - darkchild - Mon Sep 22, 2008 6:59 pm</h4>
    <div class="postbody"><span class="postbody">can those "Calculations" be made into a final variable? (Char variable if possible)
<br/>
edit:
<br/>
got it working!
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
char card[5];
<br/>
card[3] = (st.st_dev&gt;&gt;24)&amp;0xff;
<br/>
card[2] = (st.st_dev&gt;&gt;16)&amp;0xff;
<br/>
card[1] = (st.st_dev&gt;&gt;8)&amp;0xff;
<br/>
card[0] = (st.st_dev)&amp;0xff;
<br/>
card[4] = '\0';
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
thanks :D</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163111 - josath - Mon Sep 22, 2008 8:17 pm</h4>
    <div class="postbody"><span class="postbody">This should be a simpler way instead of the above calculation:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">char card[5];
<br/>
memcpy(card, st.st_dev, 4);
<br/>
card[4] = '\0';</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#163114 - Maxxie - Mon Sep 22, 2008 8:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
char card[5] ;
<br/>
snprintf(card,sizeof(card),"%s",&amp;st.st_dev) ;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
@josath, you would want to use the reference to the int for the memcpy instead of the int itself (cast to a pointer)
<br/>
<br/>
This should btw the reason for the crash in the first place. (ignoring the missing string termination)<br/>_________________<br/><a class="postlink" href="http://nintendods.desperate-programmers.com/doku.php?id=wireless_io_map" target="_blank">Trying  to bring more detail into understanding the wireless hardware</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
