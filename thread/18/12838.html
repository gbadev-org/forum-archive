<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Semi-transparent texture problems - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Semi-transparent texture problems</h2>
<div id="posts">
<div class="post">
    <h4>#123303 - Rajveer - Tue Mar 27, 2007 4:30 am</h4>
    <div class="postbody"><span class="postbody">Hi guys. I have a texture, with a section of it semi-transparent. What I do is:
<br/>
<br/>
-Use Photoshop to save it as a PNG (24-bit with Transparency)
<br/>
-Use Sausage Boy's (excellent) TexMex tool to convert it to a texture mode 1 file (RGB32_A3)
<br/>
-Load it into my game, load it into VRAM with:
<br/>
    glTexImage2D(0, 0, GL_RGB32_A3, TEXTURE_SIZE_128 , TEXTURE_SIZE_128, 0, TEXGEN_TEXCOORD | GL_TEXTURE_WRAP_S | GL_TEXTURE_WRAP_T, (u8*)road3);
<br/>
<br/>
The problem is when in the game, no colours are displayed i.e. it's greyscale. Even the part of the texture which has no transparency is transparent. However, the darker parts of the texture are less transparent. It seems as if the colour is being stripped and used as the alpha values...or...something! Anybody got any ideas??
<br/>
<br/>
P.S. I've tried with Standard PNG's in Photoshop and 24-bit with transparency.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123345 - Sausage Boy - Tue Mar 27, 2007 2:50 pm</h4>
    <div class="postbody"><span class="postbody">Hmm... I have no clue. Could you please take your code, your image and the command you use with texmex and send it to my email? I'll have a look at it.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123352 - Rajveer - Tue Mar 27, 2007 4:24 pm</h4>
    <div class="postbody"><span class="postbody">Cheers for the offer Sausage Boy! Before I do I'll give a little update:
<br/>
<br/>
Alpha works, I wasn't saving the file properly (I still had an opaque background which I've deleted). The image is still greyscale however, but the parts which are not semi-transparent are not semi-transparent in the game now.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123397 - silent_code - Tue Mar 27, 2007 10:00 pm</h4>
    <div class="postbody"><span class="postbody">sounds like you only copy one "channel byte", instead of all three. also remember that the channel order is not rgba on nds (15 bit color).
<br/>
<br/>
i'll release a demo showing off different things (mainly shadow volumes) in "a few days" and it includes .tga loading. maybe that'll help.
<br/>
<br/>
happy coding!</span><span class="gensmall"><br/><br/>Last edited by silent_code on Tue Mar 27, 2007 11:03 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#123405 - Rajveer - Tue Mar 27, 2007 10:42 pm</h4>
    <div class="postbody"><span class="postbody">When you say I only copy one channel byte, do you mean when loading the file into VRAM? If so how would I copy the rest?
<br/>
<br/>
I'll look forward to your demo coming out in a few days, might clear it up!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123406 - silent_code - Tue Mar 27, 2007 10:55 pm</h4>
    <div class="postbody"><span class="postbody">it very much depends on what texture format you use. and i'm talking about loading... heck i overlooked you use texmex.
<br/>
<br/>
in general: assuming your file is rgba, you'd read a byte (red), then another (green) and another one (blue) plus alpha and convert them to each 5 bit then recombine them to a 15bit value, when using 15/16bit textures. you could also read a whole 32bit word texel (if you can) and separate the channels.
<br/>
<br/>
i haven't worked with texmex, so i'm of no big help with that. i can only say that it definitely sounds like you have that problem.
<br/>
<br/>
ps: i can't guarantee it'll be there in "a few days", as i don't have inet at home, but i'll have it done in a reasonable time. (it's near completion already).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123501 - Rajveer - Wed Mar 28, 2007 5:16 pm</h4>
    <div class="postbody"><span class="postbody">Ok I've been reading up on some things, and realise I haven't been setting up a palette or anything. Some examples only load the texture, but in the palette cube demo (where transparent textures are used) palettes are setup for each texture. Is this also where I could be going wrong? Could somebody please explain/point me to what/why I'd use a paletted texture?
<br/>
<br/>
I'm sure I'm not doing anything else wrong: other people have been using the exact same method of converting a 24-bit PNG with transparency enabled with TexMex mode 1 and getting it to work...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123531 - tepples - Wed Mar 28, 2007 9:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Rajveer wrote:</b></span></td> </tr> <tr> <td class="quote">Could somebody please explain/point me to what/why I'd use a paletted texture?</td> </tr></table><span class="postbody">
<br/>
Why? More detail. With 4-bit paletted textures: 262144 texels per VRAM bank. With 16-bit direct color textures: 65536 texels per VRAM bank.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123713 - silent_code - Fri Mar 30, 2007 3:12 pm</h4>
    <div class="postbody"><span class="postbody">you can get away with really good looking textures, even when only using 32 colors. using palettes helps reducing texture memory usage (as tepples already pointed out) a lot. if you cleverly palletize (is that the right word?) your images, you will hardly notice the difference between a 5bit and a 15bit texture while playing.
<br/>
in order to know what colors are used by the texture, you supply the palette. then, the colors of the image (the texels) are merely (5bit) indices to (15/16bit) palette entries (plus alpha), than direct color values.
<br/>
you need to use this texture mode if you want to have multiple levels of alpha. the 5bit color / 3bit alpha or vice versa modes are the only ones that have this option.
<br/>
<br/>
ps: i plan releasing my demo today, i'll have to check licenses first, though. (like the free filesystem and demo code snippets i use in it).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123767 - Rajveer - Fri Mar 30, 2007 11:09 pm</h4>
    <div class="postbody"><span class="postbody">Thanks guys for the replies. So as an example a 32 colour paletted texture of a green apple could have 32 shades of green in it's palette, so that the texture could only use these colours cutting down on memory whilst still giving alot of detail? I gotta learn how to use paletted textures!
<br/>
<br/>
Also, you said that in order to use textures with multiple alpha levels you NEED to use it as a paletted texture right? In this case I'd better start looking for paletted textures tutorials!
<br/>
<br/>
I look forward to your demo! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123776 - silent_code - Sat Mar 31, 2007 12:39 am</h4>
    <div class="postbody"><span class="postbody">DEMO: <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=12873" target="_blank">http://forum.gbadev.org/viewtopic.php?t=12873</a>
<br/>
<br/>
you better get tonc. that's for gba, but you can learn a lot you'll be able to apply to nds. like palettes. :^D</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
