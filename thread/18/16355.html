<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems with glOrtho() - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Problems with glOrtho()</h2>
<div id="posts">
<div class="post">
    <h4>#165954 - Kath - Wed Jan 14, 2009 9:19 am</h4>
    <div class="postbody"><span class="postbody">Hello, I'm trying to use glOrtho() to be able to draw to the screen using pixel coordinates in 3d, so setting it to 256x192. I did this before in an older project but copying this code to the new one results in nothing displaying, I've since tried using the Ortho example code which works but when I change the values I get nothing again.
<br/>
<br/>
For example this code displays as expected, a quad taking up the top left 1/4 of the screen:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrtho(0, 6, 6, 0, 1, 100);
<br/>
<br/>
glBegin(GL_QUADS);
<br/>
<br/>
glVertex3v16( inttov16(0), inttov16(0), inttov16(-1) );
<br/>
glVertex3v16( inttov16(0), inttov16(3), inttov16(-1) );
<br/>
glVertex3v16( inttov16(3), inttov16(3), inttov16(-1) );
<br/>
glVertex3v16( inttov16(3), inttov16(0), inttov16(-1) );
<br/>
<br/>
glEnd();</td> </tr></table><span class="postbody">
<br/>
<br/>
However this code results in nothing being drawn:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glOrtho(0, 256, 192, 0, 1, 100);
<br/>
<br/>
glBegin(GL_QUADS);
<br/>
<br/>
glVertex3v16( inttov16(100), inttov16(100), inttov16(-1) );
<br/>
glVertex3v16( inttov16(100), inttov16(150), inttov16(-1) );
<br/>
glVertex3v16( inttov16(200), inttov16(150), inttov16(-1) );
<br/>
glVertex3v16( inttov16(200), inttov16(100), inttov16(-1) );
<br/>
<br/>
glEnd();</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm wondering if I'm doing something extremely wrong here. My 3d setup is below:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void Setup3d()
<br/>
{
<br/>
   glInit();
<br/>
 
<br/>
   // Enable AA, textures and blending.
<br/>
   glEnable( GL_ANTIALIAS );
<br/>
   glEnable( GL_TEXTURE_2D );
<br/>
   glEnable( GL_BLEND );
<br/>
<br/>
   // Setup the background.
<br/>
   glClearColor( 16, 16, 16, 31 ); 
<br/>
   glClearPolyID( 63 ); 
<br/>
   glClearDepth( 0x7FFF );
<br/>
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glLoadIdentity();
<br/>
<br/>
   glMaterialf(GL_AMBIENT, RGB15(16,16,16));
<br/>
   glMaterialf(GL_DIFFUSE, RGB15(16,16,16));
<br/>
   glMaterialf(GL_SPECULAR, BIT(15) | RGB15(8,8,8));
<br/>
   glMaterialf(GL_EMISSION, RGB15(16,16,16));
<br/>
<br/>
   glPolyFmt( POLY_ID(0) | POLY_ALPHA(31)  | POLY_CULL_NONE ); 
<br/>
<br/>
   // Set our viewport to be the same size as the screen
<br/>
   glViewport(0,0,255,191);
<br/>
   
<br/>
   // Set ortho mode.
<br/>
   glMatrixMode(GL_PROJECTION);
<br/>
   glLoadIdentity();
<br/>
   glOrtho(0, 6, 6, 0, 1, 100);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks in advance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165963 - AxemRed - Wed Jan 14, 2009 3:31 pm</h4>
    <div class="postbody"><span class="postbody">inttov16(200) overflows, 200&lt;&lt;12 doesn't fit inside a 16 bit number.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165973 - Kaiser - Wed Jan 14, 2009 9:06 pm</h4>
    <div class="postbody"><span class="postbody">You can use my ortho setup for reference if you want:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void GL_Enable2D(int znear)
<br/>
{
<br/>
   glMatrixMode(GL_PROJECTION);
<br/>
   glLoadIdentity();
<br/>
   glMatrixMode(GL_MODELVIEW);
<br/>
   glLoadIdentity();
<br/>
   glOrtho(0, 256&gt;&gt;5, 192&gt;&gt;5, 0, znear, 4);
<br/>
   glScalef(128.0f, 128.0f, 128.0f);
<br/>
   glPushMatrix();
<br/>
}
<br/>
<br/>
void GL_Disable2D(void)
<br/>
{
<br/>
   glPopMatrix(1);
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Just add GL_Enable2D(znear value) before drawing stuff and add GL_Disable2D when finished.
<br/>
<br/>
I added glScalef(128.0f, 128.0f, 128.0f) so you don't have to convert the x, y values into fixed numbers, so basically it adding a value of 0 - 255 for the draw x and 0 - 191 for the draw y will work instead of having to always shift by 7.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
