<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Help: multiple palettes? [solved] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Help: multiple palettes? [solved]</h2>
<div id="posts">
<div class="post">
    <h4>#166632 - Emmanuel - Thu Feb 12, 2009 3:22 pm</h4>
    <div class="postbody"><span class="postbody">Well, first of all, in my BackgrounsAllInOne example, the extended palette is missing, it's an empty function... in case that was the example that answers this...
<br/>
<br/>
Well, what I'm trying to accomplish:
<br/>
To have each background with a different tile set, map, and palette... 
<br/>
<br/>
I load the palette with:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">memcpy(BG_PALETTE, buffer, size);</td> </tr></table><span class="postbody">
<br/>
and
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">memcpy(BG_PALETTE_SUB, buffer, size);</td> </tr></table><span class="postbody">
<br/>
<br/>
But that gives me one palette per screen... how can I make it so each background can have it's palette? I'm gonna be using multiple layers, 256 colors each, and only the most recently added bg looks like it's supposed to (obviously... according to my code...)</span><span class="gensmall"><br/><br/>Last edited by Emmanuel on Fri Feb 13, 2009 4:07 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#166641 - albinofrenchy - Thu Feb 12, 2009 5:52 pm</h4>
    <div class="postbody"><span class="postbody">As far as all this graphics stuff goes, I'm a complete newb and have never used an extended palette. But if you haven't looked at <a class="postlink" href="http://www.liranuna.com/nds-2d-tuts/lesson-5/#Extended_Palettes" target="_blank">this tutorial</a> yet, it might be beneficial for you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166661 - elwing - Fri Feb 13, 2009 8:12 am</h4>
    <div class="postbody"><span class="postbody">I think TONC documentation about palette is still relevent for the NDS... and if that is the case, it is the document you want to read...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166664 - Emmanuel - Fri Feb 13, 2009 10:34 am</h4>
    <div class="postbody"><span class="postbody">Tonc seems to be for GBA, and I didn't found anything about extended palettes...
<br/>
I got how to write the Palette: I set a bank as LCD, write, and then set the bank to ext_palette... but I still don't get how to tell the BG which palette to use, it still uses the defaul one apparently...
<br/>
LiraNuna's is for an older libnds apparently, as the code didn't compile, and he uses gfx2gba... while I use grit...
<br/>
<br/>
sorry for my noobness... I just changed from PAlib and I've never coded at low level...
<br/>
<br/>
I've tested it with dualis, and it tells me I copied the palette to the slot I wanted... but, the background still looks inappropiately... how do I tell the BG to use the Main slot1 palette?
<br/>
<br/>
Right now, on hardware and nogba the last background loaded looks OK but the first one looks all black... but on DeSemuME  it looks perfectly...
<br/>
I know I must be missing something small... any ideas?
<br/>
<br/>
For the archive, I fixed it... I had forgotten to set the VRAM bank as LCD before copying the palette</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166743 - sverx - Mon Feb 16, 2009 10:16 am</h4>
    <div class="postbody"><span class="postbody">You should enable extended palettes:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetMode ( &lt;your mode&gt; | DISPLAY_BG_EXT_PALETTE);</td> </tr></table><span class="postbody">
<br/>
<br/>
Did you do that?<br/>_________________<br/><a class="postlink" href="http://bit.ly/yiQrz9" target="_blank">libXM7</a>|<a class="postlink" href="http://bit.ly/yJwcOo" target="_blank">NDS programming tutorial (Italiano)</a>|<a class="postlink" href="http://disjointedstudio.blogspot.com/" target="_blank">Waimanu DS / GBA</a>|<a class="postlink" href="http://adshomebrewersdiary.blogspot.com" target="_blank">A DS Homebrewer's Diary</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166746 - Emmanuel - Mon Feb 16, 2009 1:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">You should enable extended palettes:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetMode ( &lt;your mode&gt; | DISPLAY_BG_EXT_PALETTE);</td> </tr></table><span class="postbody">
<br/>
<br/>
Did you do that?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
OMG! Thx... you just solved my other problem... I had done that for main screen... but
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetModeSub(MODE_0_2D|
<br/>
                DISPLAY_BG0_ACTIVE |
<br/>
                DISPLAY_BG1_ACTIVE |
<br/>
            DISPLAY_BG2_ACTIVE |
<br/>
            DISPLAY_BG3_ACTIVE | 
<br/>
            DISPLAY_BG_EXT_PALETTE);</td> </tr></table><span class="postbody">
<br/>
and know that other prob is fixed...
<br/>
I was having a problem with the subscreen not using extended palette
<br/>
THX!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166749 - sverx - Mon Feb 16, 2009 3:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Emmanuel wrote:</b></span></td> </tr> <tr> <td class="quote">you just solved my other problem...</td> </tr></table><span class="postbody">
<br/>
<br/>
lol... so which problem is left? If you still can't see extended palettes I guess it's because you forgot to specify the palette that should be used in the tile, check <a class="postlink" href="http://www.dev-scene.com/NDS/Tutorials_Day_4#Map_Entries" target="_blank">here</a>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">tilenum |= (palette &lt;&lt; 12);</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://bit.ly/yiQrz9" target="_blank">libXM7</a>|<a class="postlink" href="http://bit.ly/yJwcOo" target="_blank">NDS programming tutorial (Italiano)</a>|<a class="postlink" href="http://disjointedstudio.blogspot.com/" target="_blank">Waimanu DS / GBA</a>|<a class="postlink" href="http://adshomebrewersdiary.blogspot.com" target="_blank">A DS Homebrewer's Diary</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166753 - Emmanuel - Mon Feb 16, 2009 4:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sverx wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
lol... so which problem is left? </td> </tr></table><span class="postbody">
<br/>
None, solved... and you just solved another problem I was having before I posted with that link... 
<br/>
<br/>
Thanks, fixed completely</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
