<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Are KEY_LEFT and KEY_RIGHT working? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Are KEY_LEFT and KEY_RIGHT working?</h2>
<div id="posts">
<div class="post">
    <h4>#168539 - sverx - Mon May 04, 2009 12:14 pm</h4>
    <div class="postbody"><span class="postbody">Hi! I've got that simple piece of code that doesn't work as expected both with no$gba and a real NDS Lite... it swaps screens only if I press the X button, nothing happens if I use the LEFT or RIGHT keys instead.
<br/>
<br/>
I'm using the latest devkit and libnds, AFAIK...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (keysHeld() &amp; (KEY_LEFT|KEY_RIGHT|KEY_X)) {  
<br/>
  lcdMainOnBottom();
<br/>
} else {
<br/>
  lcdMainOnTop();
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Any ideas? I've been searching the forum for this with no luck...
<br/>
Thanks!
<br/>
<br/>
<br/>
<br/>
<br/>
?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168540 - elhobbs - Mon May 04, 2009 1:18 pm</h4>
    <div class="postbody"><span class="postbody">search for keysHeld
<br/>
<br/>
main points - make sure you do not call irqInit, scanKeys needs to be called at lease twice for keysHeld to return a value. if you are trying to detect if a key is held at startup then call scanKeys twice in a row.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168543 - sverx - Mon May 04, 2009 2:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">search for keysHeld
<br/>
<br/>
main points - make sure you do not call irqInit, scanKeys needs to be called at lease twice for keysHeld to return a value. if you are trying to detect if a key is held at startup then call scanKeys twice in a row.</td> </tr></table><span class="postbody">
<br/>
<br/>
No luck... I've read other topics about other type of problems, nothing related to what I'm experiencing... I call that keysHeld() in a code like this
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">while(1) {
<br/>
  scanKeys();
<br/>
  // here the code I wrote in my previous post
<br/>
  swiWaitForVBlank();
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
and it's OK when I hold X, not OK when I hold LEFT or RIGHT instead... and I do not have any irqInit() in my code... other suggestions?
<br/>
<br/>
<br/>
?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168544 - gauauu - Mon May 04, 2009 3:03 pm</h4>
    <div class="postbody"><span class="postbody">Is the value returned from keysHeld changed when you press left and right?  The problem is either in keysHeld or in your KEY_LEFT/KEY_RIGHT constants, so it shouldn't be too hard to narrow down which it is.  
<br/>
<br/>
Do you have a text system set up?  If so, loop and repeatedly dump out the value of keysHeld and check it against what the specs tell you.   You should be able to find out pretty fast where the issue is.  (Now finding out WHY might be trickier)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168546 - sverx - Mon May 04, 2009 3:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gauauu wrote:</b></span></td> </tr> <tr> <td class="quote">Is the value returned from keysHeld changed when you press left and right?</td> </tr></table><span class="postbody">
<br/>
<br/>
Good suggestion. I made a test and... yes, it changes. 0x200 and 0x100 respectively. So it's funny, because I'm using the... oh-oh-oh ... ok, ok, I made a big confusion: I meant to use KEY_R and KEY_L (shoulder buttons), not KEY_RIGHT and KEY_LEFT (on "cross" button).
<br/>
<br/>
Keep this post for future generations ;)
<br/>
<br/>
Thanks! :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
