<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>libFB with devkitPro r20 and new libnds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > libFB with devkitPro r20 and new libnds</h2>
<div id="posts">
<div class="post">
    <h4>#118024 - Primetime00 - Fri Feb 09, 2007 4:35 am</h4>
    <div class="postbody"><span class="postbody">Anyone have libFB working for the new toolchain and libnds?
<br/>
I'm just trying to draw a rectangle.
<br/>
Seems to work fine in the emulator, but two blank screens on the DS.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    powerON(POWER_ALL_2D);
<br/>
    irqSet(IRQ_VBLANK, 0);
<br/>
    irqEnable(IRQ_VBLANK);
<br/>
    
<br/>
    fb_init();
<br/>
    fb_drawRect(6, 6, 60, 60, RGB15(31,31,31));
<br/>
    swiWaitForVBlank();
<br/>
    fb_swapBuffers();
<br/>
    while(1) 
<br/>
    {    
<br/>
        swiWaitForVBlank();
<br/>
    }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks
<br/>
-RYan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118027 - tepples - Fri Feb 09, 2007 5:08 am</h4>
    <div class="postbody"><span class="postbody">Tried ORing your color value with 0x8000? That turns on the alpha bit. Any pixel without the alpha bit turned on just shows the layer beneath, which is usually just the value of BG_PALETTE[0] unless you've turned on more than one layer.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118048 - Primetime00 - Fri Feb 09, 2007 1:11 pm</h4>
    <div class="postbody"><span class="postbody">Unfortunately that still only gives me 2 blanks.  Still works in the emulator.
<br/>
Maybe I'll try it later with devkit r19.
<br/>
<br/>
-RYan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118062 - DragonMinded - Fri Feb 09, 2007 5:30 pm</h4>
    <div class="postbody"><span class="postbody">I don't have r20 so I can't tell you why this isn't working, but you don't need to OR the bits due to libFB managing that for you.<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118067 - Primetime00 - Fri Feb 09, 2007 6:57 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, I kind of thought so.  I've tried it on r19, and I am getting the same results.  So I'm going to revert back to the older libnds and check if it works with that.
<br/>
<br/>
-Ryan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118072 - DragonMinded - Fri Feb 09, 2007 8:29 pm</h4>
    <div class="postbody"><span class="postbody">When I have the time, I plan on testing out r20, and I can see why it's not working...
<br/>
<br/>
For now, I am actually posting from the lab room at school, no time ;P<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118180 - Primetime00 - Sat Feb 10, 2007 9:39 pm</h4>
    <div class="postbody"><span class="postbody">ok, it seems to work now.
<br/>
Just replace 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">irqSet(IRQ_VBLANK, 0);</td> </tr></table><span class="postbody">
<br/>
with
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">irqInit();</td> </tr></table><span class="postbody">
<br/>
<br/>
That seems to fix the problem.  So libFB works with both r20 and the new libnds.
<br/>
<br/>
-RYan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118182 - Lick - Sat Feb 10, 2007 10:30 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Primetime00 wrote:</b></span></td> </tr> <tr> <td class="quote">ok, it seems to work now.
<br/>
Just replace 
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">irqSet(IRQ_VBLANK, 0);</td> </tr></table><span class="postbody">
<br/>
with
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">irqInit();</td> </tr></table><span class="postbody">
<br/>
<br/>
That seems to fix the problem.  So libFB works with both r20 and the new libnds.
<br/>
<br/>
-RYan</span></td> </tr></table><span class="postbody">
<br/>
<br/>
You should not <span style="font-weight: bold">replace</span> it, but <span style="font-weight: bold">put in front</span> of it. :)<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118200 - wintermute - Sun Feb 11, 2007 12:50 am</h4>
    <div class="postbody"><span class="postbody">Indeed.
<br/>
<br/>
irqInit() is needed to initialise the interrupt system.
<br/>
<br/>
irqEnable(IRQ_VBLANK); is probably better than irqSet(IRQ_VBLANK, 0); though - the second may not enable the interrupt. The vblank interrupt <span style="font-weight: bold">must</span> be enabled for swiWaitForVBlank() to operate as expected.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#118229 - Primetime00 - Sun Feb 11, 2007 7:21 am</h4>
    <div class="postbody"><span class="postbody">ah, ok
<br/>
Thanks
<br/>
<br/>
-RYan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
