<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Touch screen drawing demo - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Touch screen drawing demo</h2>
<div id="posts">
<div class="post">
    <h4>#108888 - outphase - Sun Nov 12, 2006 6:00 pm</h4>
    <div class="postbody"><span class="postbody">I'm working on a project for school demonstrating assorted DS functions. I wanted to make a little touch screen notepad demo. Is there any way to speed this up so there is a continuous line? Thanks.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int main(void) {
<br/>
//---------------------------------------------------------------------------------
<br/>
   touchPosition touchXY;
<br/>
   
<br/>
<br/>
   irqInit();
<br/>
   irqSet(IRQ_VBLANK, Vblank);
<br/>
   irqEnable(IRQ_VBLANK);
<br/>
   videoSetMode(MODE_FB0);   //Text on main screen
<br/>
   videoSetModeSub(MODE_0_2D | DISPLAY_BG0_ACTIVE);   //Frame Buffer
<br/>
   //vramSetBankC(VRAM_C_SUB_BG); 
<br/>
   
<br/>
   vramSetMainBanks(   VRAM_A_LCD, VRAM_B_LCD,
<br/>
                  VRAM_C_SUB_BG , VRAM_D_LCD);
<br/>
<br/>
   lcdSwap();
<br/>
   BG0_CR = BG_MAP_BASE(31);//use bg0 for the text
<br/>
   
<br/>
   BG_PALETTE[255] = RGB15(31,31,31);//by default font rendered with color 255
<br/>
   
<br/>
   SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
   
<br/>
   BG_PALETTE_SUB[255] = RGB15(31,31,31);   //by default font will be rendered with color 255
<br/>
<br/>
   
<br/>
   //consoleInit() is a lot more flexible but this gets you up and running quick
<br/>
   consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(31), (u16*)CHAR_BASE_BLOCK_SUB(0), 16);
<br/>
   consoleClear();
<br/>
<br/>
   iprintf("EE464 Project\nProof of Concept\nTouch Pad Demo\n\n");
<br/>
   iprintf("Press Start to clear screen\n");
<br/>
   iprintf("Press A to flood");
<br/>
<br/>
   for(int i = 0; i &lt; 256*192; i++)
<br/>
      VRAM_A[i] = RGB15(0,0,0);
<br/>
<br/>
   while(1) {
<br/>
   
<br/>
      
<br/>
      swiWaitForVBlank();
<br/>
      
<br/>
      scanKeys();
<br/>
      touchXY=touchReadXY();
<br/>
      int held = keysHeld();
<br/>
      
<br/>
      if(held&amp;KEY_TOUCH)
<br/>
         VRAM_A[(touchXY.px) + (touchXY.py) * 256]=RGB15(31,31,31);
<br/>
         
<br/>
      if(held&amp;KEY_START)
<br/>
         for(int i = 0; i &lt; 256*192; i++)
<br/>
            VRAM_A[i] = RGB15(0,0,0);
<br/>
      if(held&amp;KEY_A)
<br/>
         for(int i = 0; i &lt; 256*192; i++)
<br/>
            VRAM_A[i] = RGB15(0,0,31);
<br/>
   }
<br/>
<br/>
   return 0;
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108889 - Sausage Boy - Sun Nov 12, 2006 6:18 pm</h4>
    <div class="postbody"><span class="postbody">You could remember the last position touched, and draw a line between the old and the new positions (if the styles has not been lifted, of course).<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108891 - outphase - Sun Nov 12, 2006 6:56 pm</h4>
    <div class="postbody"><span class="postbody">Is there a function for that or do I need my own?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108892 - Sausage Boy - Sun Nov 12, 2006 7:19 pm</h4>
    <div class="postbody"><span class="postbody">You'll have to write this yourself, google for "line drawing algorithms".<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#108894 - outphase - Sun Nov 12, 2006 7:56 pm</h4>
    <div class="postbody"><span class="postbody">i'm using the Bresenham algorithm and it looks great. Thanks.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
