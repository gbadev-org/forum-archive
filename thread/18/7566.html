<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GBA mode screen border (demo) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > GBA mode screen border (demo)</h2>
<div id="posts">
<div class="post">
    <h4>#61659 - chishm - Tue Nov 22, 2005 12:02 pm</h4>
    <div class="postbody"><span class="postbody">I have whipped up this quick demo of how to have borders in GBA mode. To use it, start the NDS file using your favourite method. Then insert a GBA game (you can remove the flash cart if you need to) and press A to start it, with the <b style="color:#FFA34F">border</b> around the game <b style="color:#FFA34F">screen</b>.
<br/>
<br/>
Crappy source code is included, to demonstrate how to do it in your own applications.
<br/>
<br/>
The image is a raw 15 bit, 256 * 192 pixel image, if you want to change it. You will need to recompile with DevKitPro r17 if you do.
<br/>
<br/>
I almost forgot the <a class="postlink" href="http://www.geocities.com/chishm1/gbamp/GBA_Border.zip" target="_blank">link</a>.
<br/>
<br/>
I have to thank MightyMax for the idea for this. It was his comments on left over NDS data in GBA mode that inspired me to try it out.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61662 - buZz_ - Tue Nov 22, 2005 12:47 pm</h4>
    <div class="postbody"><span class="postbody">great work chishm :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61701 - tepples - Tue Nov 22, 2005 8:10 pm</h4>
    <div class="postbody"><span class="postbody">Could you use this in a future version of your GBAMP firmware hack to provide an error message if the FAT driver fails to find _boot_mp.nds? This would help distinguishing "booting in GBA mode" from "booting in DS mode but falling back to GBA mode", saving a bit of troubleshooting time.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61708 - Ilomoga - Tue Nov 22, 2005 8:50 pm</h4>
    <div class="postbody"><span class="postbody">Wow, that's a quite nice demo :D
<br/>
<br/>
Would it be possible to make a DS loader (like MultiNDS) that supports both *.nds and *.gba files?<br/>_________________<br/>The future of gaming is mobile Handheld Gaming.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61724 - Mighty Max - Tue Nov 22, 2005 9:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ilomoga wrote:</b></span></td> </tr> <tr> <td class="quote">Wow, that's a quite nice demo :D
<br/>
<br/>
Would it be possible to make a DS loader (like MultiNDS) that supports both *.nds and *.gba files?</td> </tr></table><span class="postbody">
<br/>
<br/>
That was basically the reason why we experimented with left over ram :p Some Method to pass parameters over into gba mode.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61745 - josath - Wed Nov 23, 2005 1:10 am</h4>
    <div class="postbody"><span class="postbody">well, if all you want to do is pass info from ds mode into gba mode, on the gbamp, why not just write it to a file? like __gbamp.tmp or something?
<br/>
<br/>
but the <b style="color:#FFA34F">border</b> is cool nevertheless, now we need to make it load from a .bmp file on the cf card, so people can have their own borders while playing gba games.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61752 - chishm - Wed Nov 23, 2005 2:48 am</h4>
    <div class="postbody"><span class="postbody">Actually, to load a file, all I need to know is the cluster number. That is 32bits long. I have 5 registers in the CF card, each one 8 bits wide. They should survive a soft reset with their data intact, and readable. I just haven't gotten around to implementing it yet.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61762 - tepples - Wed Nov 23, 2005 3:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chishm wrote:</b></span></td> </tr> <tr> <td class="quote">Actually, to load a file, all I need to know is the cluster number. That is 32bits long.</td> </tr></table><span class="postbody">
<br/>
And the file length in bytes. Otherwise the file length is rounded up to the number of bytes per cluster. But for <span style="font-style: italic">some</span> formats this might not matter.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"><br/><br/>Last edited by tepples on Wed Nov 23, 2005 2:26 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#61776 - chishm - Wed Nov 23, 2005 8:55 am</h4>
    <div class="postbody"><span class="postbody">I have been experimenting some more. It seems that if I set the display into frame buffer mode, then I only need to fill the buffer being used with the data. However, only VRAM banks A or B can be used. If C or D are used, the GBA display doesn't show up.
<br/>
However, doing this causes the DS to render the GBA <b style="color:#FFA34F">screen</b> at only 30 fps, rather than the usual 60. 
<br/>
<br/>
The better option is to fill VRAM banks A and B with the background display, then switch to MODE_0_2D (or any other non-framebuffer mode). This allows the GBA display to run at 60 fps.
<br/>
<br/>
In either case, the image data is 256*192 pixels, 15bpp, no alpha bit.
<br/>
<br/>
My theory about how this works:
<br/>
The DS <b style="color:#FFA34F">screen</b> is 256 * 192, while the GBA <b style="color:#FFA34F">screen</b> is 240 * 160 pixels. The VRAM banks are used as a buffer between the GBA renderer and the DS <b style="color:#FFA34F">screen</b>, but the buffers are not cleared between frames (why bother?). Since the <b style="color:#FFA34F">border</b> is still in the buffer, it won't be cleared.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61878 - biubid_boy - Thu Nov 24, 2005 1:06 pm</h4>
    <div class="postbody"><span class="postbody">Perhaps this could be modified to make the game use the whole <b style="color:#FFA34F">screen</b>, like what you can do in Gooba.
<br/>
<br/>
//EDIT: Maybe a buffer-overflow can be used to control the ds part of the <b style="color:#FFA34F">screen</b>.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61910 - IxthusTiger - Fri Nov 25, 2005 1:39 am</h4>
    <div class="postbody"><span class="postbody">what's "pircay??"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#61923 - chishm - Fri Nov 25, 2005 9:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>biubid_boy wrote:</b></span></td> </tr> <tr> <td class="quote">Perhaps this could be modified to make the game use the whole <b style="color:#FFA34F">screen</b>, like what you can do in Gooba.
<br/>
<br/>
//EDIT: Maybe a buffer-overflow can be used to control the ds part of the <b style="color:#FFA34F">screen</b>.</td> </tr></table><span class="postbody">
<br/>
No, its not possible. To software running on the GBA, the <b style="color:#FFA34F">screen</b> buffer is just like a normal GBA <b style="color:#FFA34F">screen</b>, there is no way for it to access the outside. The DS hardware is what takes care of the conversion between the two formats. The <b style="color:#FFA34F">border</b> is created in NDS mode, while that hardware is still accessable.
<br/>
<br/>
To use your Goo<span style="font-style: italic">m</span>ba analogy, the DS hardware is like the emulator. It is what takes care of drawing the <b style="color:#FFA34F">screen</b>. The GBA game is like the GB ROM, it has no idea that it is not running on the real thing, and so can't change its behaviour. The only reason you can see more in Goomba is because the emulator draws the <b style="color:#FFA34F">screen</b> differently. For the same thing to happen on the DS, the DS <span style="font-weight: bold">hardware</span> would have to be modified to draw outside of the normal <b style="color:#FFA34F">screen</b> area.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95634 - spinal_cord - Sun Jul 30, 2006 5:17 pm</h4>
    <div class="postbody"><span class="postbody">broken link, i wanted to try this :(
<br/>
<br/>
It would be cool and a flashme add-on, eg, the firmware could check the game in the gba slot, and load a background accordingly.
<br/>
<br/>
would this be possible?<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95694 - ph0x - Sun Jul 30, 2006 7:54 pm</h4>
    <div class="postbody"><span class="postbody">spinal_cord,
<br/>
<br/>
i wrote similar tool today:
<br/>
<a href="http://scdev.org/forum/viewtopic.php?t=5192&amp;postdays=0&amp;postorder=asc&amp;start=0" target="_blank">http://scdev.org/forum/viewtopic.php?t=5192&amp;postdays=0&amp;postorder=asc&amp;start=0</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95713 - spinal_cord - Sun Jul 30, 2006 8:16 pm</h4>
    <div class="postbody"><span class="postbody">I was hoping sor somwthing i could run from gbamp, can this do that, eg, run this. I cant use .ds.gba, i need .nds instead<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95723 - ph0x - Sun Jul 30, 2006 8:28 pm</h4>
    <div class="postbody"><span class="postbody">does it work if you rename it to .nds?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95753 - spinal_cord - Sun Jul 30, 2006 10:42 pm</h4>
    <div class="postbody"><span class="postbody">nope, 2x white screens.<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95817 - HyperHacker - Mon Jul 31, 2006 6:05 am</h4>
    <div class="postbody"><span class="postbody">I made <a class="postlink" href="http://hypernova.amarok-shadow.com/programs.php?id=bootgba" target="_blank">a program for this</a> a while ago, and I intend to add a hell of a lot more options soon.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95860 - spinal_cord - Mon Jul 31, 2006 10:13 am</h4>
    <div class="postbody"><span class="postbody">That one works fine for me. thankyou.
<br/>
<br/>
What sort of features?<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96065 - HyperHacker - Tue Aug 01, 2006 3:19 am</h4>
    <div class="postbody"><span class="postbody">Basically turning it into a general-purpose boot menu that can launch NDS apps, game cards, etc.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96090 - spinal_cord - Tue Aug 01, 2006 9:41 am</h4>
    <div class="postbody"><span class="postbody">is it possible to read the cart name (or some sort of ID) so that a specific background can be load for each cart with less user fiddling, perhaps using some sort if .ini file. So that a different backgrougd can be loaded for each game without me having to set anything?<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96095 - Scorpei - Tue Aug 01, 2006 10:28 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">I made <a class="postlink" href="http://hypernova.amarok-shadow.com/programs.php?id=bootgba" target="_blank">a program for this</a> a while ago, and I intend to add a hell of a lot more options soon.</td> </tr></table><span class="postbody">
<br/>
Hmm, I can't seem to load my own borders....
<br/>
I've tried using the SC-SD and GBAMP, just a simple .bmp image 24bit.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96097 - Sausage Boy - Tue Aug 01, 2006 10:33 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>spinal_cord wrote:</b></span></td> </tr> <tr> <td class="quote">is it possible to read the cart name (or some sort of ID) so that a specific background can be load for each cart with less user fiddling, perhaps using some sort if .ini file. So that a different backgrougd can be loaded for each game without me having to set anything?</td> </tr></table><span class="postbody">
<br/>
<br/>
Just read the game title, 0x800000a0 to 0x800000ab (12 chars) in NDS mode.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96104 - spinal_cord - Tue Aug 01, 2006 11:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Scorpei wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">I made <a class="postlink" href="http://hypernova.amarok-shadow.com/programs.php?id=bootgba" target="_blank">a program for this</a> a while ago, and I intend to add a hell of a lot more options soon.</td> </tr></table><span class="postbody">
<br/>
Hmm, I can't seem to load my own borders....
<br/>
I've tried using the SC-SD and GBAMP, just a simple .bmp image 24bit.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I'm using an 8-bit bmp, it works fine. (using GBAMP CF)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sausage Boy wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Just read the game title, 0x800000a0 to 0x800000ab (12 chars) in NDS mode.</td> </tr></table><span class="postbody">
<br/>
<br/>
And this could be used in some sort of table to load a specific image (perhaps naming the image the same as the game title?) cool.<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96109 - Scorpei - Tue Aug 01, 2006 12:26 pm</h4>
    <div class="postbody"><span class="postbody">I got it to work if I start the app from my GBAMP, but when I start it from my SC it doesn't want to work (I started it up after patching it with ndsloader.bin).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96177 - HyperHacker - Tue Aug 01, 2006 7:52 pm</h4>
    <div class="postbody"><span class="postbody">Are they in \GBA Borders?
<br/>
<br/>
Loading a specific image based on the title of the game was planned originally, but I'd have to load all the images into memory first, because the program can't very well read the cartridge to see what game is being played when the GBAMP/whatever device is still inserted. The next version does automatically load default.bmp if it exists though, and I plan to add a mechanism for homebrew GBA ROMs to contain their own border. (Can GBA ROMs specify a border image for the Game Boy Player?)<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123989 - felix123 - Mon Apr 02, 2007 10:30 am</h4>
    <div class="postbody"><span class="postbody">Looks like R4 included this feature in 1.08<br/>_________________<br/><a class="postlink" href="http://en.wikipedia.org/wiki/NDSh" target="_blank">Nintendo DS homebrew on Wikipedia</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123999 - HyperHacker - Mon Apr 02, 2007 12:12 pm</h4>
    <div class="postbody"><span class="postbody">Neat. FYI, I haven't forgotten this project. I'm just having some trouble getting libFAT, rebootlib, my NDS launching code and my console library to cooperate with eachother.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
