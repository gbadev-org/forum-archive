<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>EDIT: Self-answered Noob Question About Shared Memory - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > EDIT: Self-answered Noob Question About Shared Memory</h2>
<div id="posts">
<div class="post">
    <h4>#146252 - natxcross - Sat Dec 01, 2007 1:13 pm</h4>
    <div class="postbody"><span class="postbody">Hello! I've had a look around, but haven't found the answer to this one anywhere. How much shared memory does the DS have, and where is it?
<br/>
<br/>
For those wondering why I'm not figuring out FIFO, it's because I'm trying to merge some MP3 code with PALib while doing the least work possible.
<br/>
<br/>
EDIT: And what do you know, no sooner do I post this then I find somewhere with the answer. It's 037F:8000-037F:FFFF according to <a class="postlink" href="http://www.neimod.com/dstek/" target="_blank">http://www.neimod.com/dstek/</a>. Well, I did say it was a noob question.<br/>_________________<br/><a class="postlink" href="http://www.ys3.org/" target="_blank">YS3 - Occasional Entertainment.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#146381 - wintermute - Mon Dec 03, 2007 8:27 am</h4>
    <div class="postbody"><span class="postbody">You didn't find the answer at all.
<br/>
<br/>
The switchable iwram banks are dedicated to the arm7 processor in a standard devkitARM nds project, generally you shouldn't change that without a very, very good reason.
<br/>
<br/>
As it happens, the entirety of the 4meg ewram region is accessible to both processors but some care is needed to maintain cache coherency &amp; ensure that data written by the arm9 is actually available in the memory for the arm7 to read.
<br/>
<br/>
The ewram area is at 0x02000000 to 0x023FFFFF but the upper 4k of that is reserved for system and libnds internal variables.
<br/>
<br/>
To avoid problems with the cache there are a couple of methods you can use. Firstly, when writing to memory that you intend the arm7 to read later you should flush the cache for the area you're working with using DC_FlushRange( address, size).
<br/>
<br/>
For reading data that the arm7 has written you should ensure that the cache is invalidated for the area you're working with - DC_InvalidateRange( address, size).
<br/>
<br/>
To make things slightly easier there is also an uncached mirror of main memory from 0x02400000 to 0x027FFFFF. Reads and writes in this region do not go through the cache and will not require flushing or invalidating.
<br/>
<br/>
I'm also going to have to advise that you start learning to code with libnds rather than relying on PAlib. Given that the PAlib installer deliberately breaks devkitARM in order to compensate for their poor design choices I am now removing all pretence of diplomacy regarding that library. Future updates to libnds and devkitARM are extremely unlikely to be compatible with PAlib and several upcoming features will obsolete large parts of their code. As far as I'm concerned the PAlib installer should be considered malware since it overwrites devkitPro supplied libraries with unsupported versions supplied from unknown sources.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
