<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem getting my game to diplay correctly [Renamed] - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Problem getting my game to diplay correctly [Renamed]</h2>
<div id="posts">
<div class="post">
    <h4>#149361 - HubbubJub - Sat Jan 19, 2008 1:45 am</h4>
    <div class="postbody"><span class="postbody">Hi, I've just been playing around with a small game for a few days, and I've been having trouble getting it to display correctly. I've been using the swiWaitForVBlank() function that I've seen in a few tutorials, but it doesn't seem to be doing the right thing for me...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">swiWaitForVBlank();
<br/>
<br/>
// Clear console.
<br/>
consoleClear();
<br/>
      
<br/>
// Clear background.
<br/>
for(i = 0; i &lt; SCREEN_WIDTH * SCREEN_HEIGHT; i++)
<br/>
   VRAM_A[i] = BG_COLOR;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This code is at the end of my main game loop. There are a few printf functions that write at the beginning of the loop, but I never see them (I'm assuming because the console is cleared too often/quickly). Also, the top third of my main screen is always black, which I'm assuming is the fault of the background clear not being synchronized with the drawing. I've been reading a bunch of tutorial but I can't seem to figure out how to get everything to display correctly. Thanks in advance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149366 - gmiller - Sat Jan 19, 2008 5:25 am</h4>
    <div class="postbody"><span class="postbody">Just remember that the wait for VBlank starts your code running at the beginning of VBlank but if the time that the code takes to do it business is longer than the VBlank period you will be writing to VRAM while the hardware is drawing ....
<br/>
<br/>
You can do the clear of the screen or set it to a single color with a single DMA.  The loop may take too long.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149371 - HubbubJub - Sat Jan 19, 2008 9:13 am</h4>
    <div class="postbody"><span class="postbody">Is there a faster way to clear the screen than the loop? And how, if so? And how does the DMA work? Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149383 - HubbubJub - Sat Jan 19, 2008 12:43 pm</h4>
    <div class="postbody"><span class="postbody">Actually, I fixed it! (In case anyone was wondering, I used memset(VRAM_A, 0, SCREEN_WIDTH*SCREEN_HEIGHT &lt;&lt; 1). Not sure why I had to multiply it by two though -- if anyone could shed some light on that that would be awesome.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149385 - tepples - Sat Jan 19, 2008 1:21 pm</h4>
    <div class="postbody"><span class="postbody">But does the screen really need to be cleared every frame? Can you describe what you are drawing, in such a way that explains why the screen needs to be cleared every frame?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149391 - dovoto - Sat Jan 19, 2008 2:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HubbubJub wrote:</b></span></td> </tr> <tr> <td class="quote">Actually, I fixed it! (In case anyone was wondering, I used memset(VRAM_A, 0, SCREEN_WIDTH*SCREEN_HEIGHT &lt;&lt; 1). Not sure why I had to multiply it by two though -- if anyone could shed some light on that that would be awesome.)</td> </tr></table><span class="postbody">
<br/>
<br/>
Each pixel in fram buffer is 16 bits (2 bytes) while memset takes a byte count as its size specifier.
<br/>
<br/>
That out of the way, dont spend a lot of time trying to get your frame buffer stuff working well or efficiently.  The frame buffer is not reall there for general purpose graphics.
<br/>
<br/>
The DS has a fairly impressive aray of interesting 2D hardware that handles the majority of rending for you (static and moving backgrounds, objects which float above / below / between the backgrounds) and errasing vram is never needed when the 2D hardware is employed.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
