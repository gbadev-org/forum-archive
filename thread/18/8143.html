<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems with text... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Problems with text...</h2>
<div id="posts">
<div class="post">
    <h4>#67184 - Linkiboy - Mon Jan 16, 2006 3:07 am</h4>
    <div class="postbody"><span class="postbody">Well, I finally got sprites moving, and they detect their collison (yay!), and I got text to show up, but in seperate .nds files. When I try to combine The two scrips, It compiles with no errors, but The text doesn't show up...
<br/>
<br/>
Text script:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "..\nds.h"
<br/>
#include "..\memory.h"
<br/>
#include "..\screen.h"
<br/>
#include "..\system.h"
<br/>
#include "..\sprtext.h"
<br/>
<br/>
int main()
<br/>
{
<br/>
int i;
<br/>
powerON(POWER_ALL);
<br/>
videoSetMode(MODE_0_2D | SPR_1D_LAYOUT | SPR_ACTIVE);
<br/>
VRAM_BANK_A(VRAM_SPRITE);
<br/>
SetupText();
<br/>
Print(0,0,0x01,0);
<br/>
PrintString(8,0,"Hello",1);
<br/>
PrintNum(16,0,0xff,6);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Here is the combined script:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "..\nds.h"
<br/>
#include "..\memory.h"
<br/>
#include "..\screen.h"
<br/>
#include "..\system.h"
<br/>
#include "..\keys.h"
<br/>
#include "..\ipc.h"
<br/>
#include "..\sprtext.h"
<br/>
#include "spr.h"
<br/>
<br/>
int x,y,spritex,spritey,tempx,tempy,wait,i;
<br/>
<br/>
void removesprites() //function, outside main, must be called from within main
<br/>
{
<br/>
for(i = 0; i &lt; 128; i++)
<br/>
OAM[i * 4] = ATTR0_DISABLED;
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
powerON(POWER_ALL);
<br/>
videoSetMode(MODE_0_2D | SPR_1D_LAYOUT | SPR_ACTIVE); //activates 2d and turns on sprites in 1d mode
<br/>
VRAM_BANK_A(VRAM_SPRITE); //sprite vram
<br/>
SetupText();
<br/>
Print(0,0,0x01,0);
<br/>
PrintString(8,0,"Hello",1);
<br/>
PrintNum(16,0,0xff,6);
<br/>
SPRITE_PALETTE[1] = RGB(31,0,0); //sprites pallet
<br/>
for(i = 0; i &lt; 256; i++)
<br/>
SPRITE_PALETTE[i] = ((u16*)testPalette)[i];
<br/>
for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)testData)[i];
<br/>
for(i = 0; i &lt; 128; i++)
<br/>
removesprites(); //uses function to remove sprites from the screen
<br/>
spritey = 50;
<br/>
spritex = 100;
<br/>
y = 100;
<br/>
x = 200;
<br/>
while(1)
<br/>
{
<br/>
IPC[0] = spritex;
<br/>
IPC[2] = spritey;
<br/>
if(READ_KEYS &amp; KEY_UP)
<br/>
{
<br/>
tempy = y;
<br/>
tempy--;
<br/>
if(tempy&gt;0 &amp; (x&lt;spritex-32 | x&gt;spritex+32 | tempy&lt;spritey-32 | tempy&gt;spritey+32)){y = tempy;}
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_DOWN)
<br/>
{
<br/>
tempy = y;
<br/>
tempy++;
<br/>
if(tempy&lt;184 &amp; (x&lt;spritex-32 | x&gt;spritex+32 | tempy&lt;spritey-32 | tempy&gt;spritey+32)){y = tempy;}
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_LEFT)
<br/>
{
<br/>
tempx = x;
<br/>
tempx--;
<br/>
if(tempx&gt;0 &amp; (tempx&lt;spritex-32 | tempx&gt;spritex+32 | y&lt;spritey-32 | y&gt;spritey+32)){x = tempx;}
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_RIGHT)
<br/>
{
<br/>
tempx = x;
<br/>
tempx++;
<br/>
if(tempx&lt;248 &amp; (tempx&lt;spritex-32 | tempx&gt;spritex+32 | y&lt;spritey-32 | y&gt;spritey+32)){x = tempx;}
<br/>
}
<br/>
tempx = IPC[0];
<br/>
tempy = IPC[2];
<br/>
if(IPC[1]){
<br/>
IPC[1] = 0;
<br/>
if(tempx&gt;0 &amp; (tempx&lt;x-32 | tempx&gt;x+32 | spritey&lt;y-32 | spritey&gt;y+32)){spritex=tempx;}
<br/>
}
<br/>
if(IPC[3]){
<br/>
IPC[3] = 0;
<br/>
if(tempy&gt;0 &amp; (spritex&lt;x-32 | spritex&gt;x+32 | tempy&lt;y-32 | tempy&gt;y+32)){spritey=tempy;}
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_A)
<br/>
{
<br/>
tempx = spritex;
<br/>
tempx++;
<br/>
if(tempx&lt;248 &amp; (tempx&lt;x-8 | tempx&gt;x+8 | spritey&lt;y-8 | spritey&gt;y+8)){spritex = tempx;}
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_B)
<br/>
{
<br/>
tempy = spritey;
<br/>
tempy++;
<br/>
if(tempy&lt;184 &amp; (spritex&lt;x-8 | spritex&gt;x+8 | tempy&lt;y-8 | tempy&gt;y+8)){spritey = tempy;}
<br/>
}
<br/>
OAM[0] = ATTR0_COLOR_256 | ATTR0_SQUARE | spritey; //ATTR0, atribute which controls sprites colour, shape and x coord
<br/>
OAM[1] = ATTR1_SIZE_32 | spritex; //ATTR1 is size and y coord
<br/>
OAM[2] = 0; //ATTR2 is sprite img no.
<br/>
OAM[4] = ATTR0_COLOR_256 | ATTR0_SQUARE | y; //ATTR0, atribute which controls sprites colour, shape and y coord
<br/>
OAM[5] = ATTR1_SIZE_32 | x; //ATTR1 is size and x coord
<br/>
OAM[6] = 0; //ATTR2 is sprite img no.
<br/>
//oam3 rotates and zooms but is not needed
<br/>
for(wait=0;wait&lt;1000;wait++) wait = wait;
<br/>
WaitForVBlank();
<br/>
}
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If you need any other pieces of code ask me.
<br/>
<br/>
So what am i doing wrong?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67238 - Maverick - Mon Jan 16, 2006 12:10 pm</h4>
    <div class="postbody"><span class="postbody">That is a strange piece of code
<br/>
<br/>
Youre using sprites 0 to 6 to display text, using the remove sprites function and  then using 0 and 1 to display your sprites<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67266 - Linkiboy - Mon Jan 16, 2006 4:54 pm</h4>
    <div class="postbody"><span class="postbody">So how would I have it so that the sprites and text were both shown on the same time? I've been messing around with the code, Got the text to show up, but it turned my sprites into ABCDEFGHIJKLMNO packed together in a square...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67298 - Maverick - Mon Jan 16, 2006 8:14 pm</h4>
    <div class="postbody"><span class="postbody">Well, in sprtext, the letters are placed into the data area from 0 to 2687, so you could start from here adding your data if you wanted to, or you could use bgtext for your text and have none of the sprite area taken up by the letters. The letters data takes up the same space for the backgrounds, so if you were using backgrounds and bgtext together, you would have to do the same thing<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67300 - Linkiboy - Mon Jan 16, 2006 9:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Maverick wrote:</b></span></td> </tr> <tr> <td class="quote">Well, in sprtext, the letters are placed into the data area from 0 to 2687, so you could start from here adding your data if you wanted to, or you could use bgtext for your text and have none of the sprite area taken up by the letters. The letters data takes up the same space for the backgrounds, so if you were using backgrounds and bgtext together, you would have to do the same thing</td> </tr></table><span class="postbody">Ok, thanks. BTW will you ever finish the rest of the tutorials on your site?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67309 - Maverick - Mon Jan 16, 2006 10:24 pm</h4>
    <div class="postbody"><span class="postbody">ATM, theyre not popular at all, and i havent been getting any feedback from the ones i have done, but i am currently in the process of porting my code to libnds and will be updating and continuing with my DS section once this is done
<br/>
<br/>
Thankyou for your interest<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
