<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Interrupts Interrupting Interrupts... que'd or ignored? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Interrupts Interrupting Interrupts... que'd or ignored?</h2>
<div id="posts">
<div class="post">
    <h4>#145259 - Natso - Tue Nov 13, 2007 6:45 am</h4>
    <div class="postbody"><span class="postbody">Ok, speaking strictly for the ARM7 here...
<br/>
<br/>
Situation:
<br/>
Audio Interrupt triggers, and is in the proccess of handling it's data when all of a sudden...
<br/>
Keypad Interrupt!
<br/>
<br/>
<br/>
What my main question is how exactly will this resolve?
<br/>
I hear that interrupts can't interrupt each other, so...
<br/>
<br/>
Will the interrupt simply never happen?
<br/>
Will the interrupt happen after the resolution of the audio interrupt?
<br/>
And... is the keypad interrupt continuous? (Like, until you release that key? or is it only triggered on key-press)<br/>_________________<br/>I'm a bomb technitian. If you see me running, try to keep up ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145398 - gladius - Wed Nov 14, 2007 10:05 pm</h4>
    <div class="postbody"><span class="postbody">Interrupts can be re-entrant, so it depends on the current default behavior of libnds what will happen.  Assuming that re-entrant interrupts are disabled, the keypad interrupt will happen after the audio interrupt has completed processing.
<br/>
<br/>
Interrupts are not continuous.  Basically, after every instruction the processor checks if any bits are set in REG_IF and if interrupts are enabled.  If there is one set, it disables interrupts, switches to irq mode and jumps to the irq handler.  This is why you have to set the bit in REG_IF in your interrupt handler.  If you don't, it will just fire the interrupt immediately again after interrupts are enabled.
<br/>
<br/>
In the keypad case, I don't remember when the REG_IF bit is set, but as long as the bit isn't cleared, the interrupt will be waiting around to happen as soon as interrupts are enabled.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
