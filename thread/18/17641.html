<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ds fps or 3ps camera? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > ds fps or 3ps camera?</h2>
<div id="posts">
<div class="post">
    <h4>#176797 - t377y000 - Fri Oct 14, 2011 6:08 am</h4>
    <div class="postbody"><span class="postbody">hi was just wondering if anyone knew how to put a fps camera together in opengl/c.
<br/>
<br/>
iv tried kinda got it working, but cant seem to figure it out.
<br/>
useing the example code from example&gt;nds&gt;graphics&gt;3d&gt;boxtest. 
<br/>
exactly how the camera works in ds fps games like call of duty or metroid.
<br/>
<br/>
exactly like this.
<br/>
<a href="http://www.youtube.com/watch?v=BY7BVAYjSUo" target="_blank">http://www.youtube.com/watch?v=BY7BVAYjSUo</a>
<br/>
<br/>
anyone help?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176888 - keldon - Sat Oct 15, 2011 5:45 pm</h4>
    <div class="postbody"><span class="postbody">Well I had a look at the video on your site and you seem to have it moving around. What exactly are you having troubles with?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176903 - t377y000 - Sun Oct 16, 2011 8:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">Well I had a look at the video on your site and you seem to have it moving around. What exactly are you having troubles with?</td> </tr></table><span class="postbody">
<br/>
<br/>
sorry if it took long to reply, but actually on that video im using nitro engine.
<br/>
this:
<br/>
<a href="http://antoniond.drunkencoders.com/nitroengine.html" target="_blank">http://antoniond.drunkencoders.com/nitroengine.html</a>
<br/>
<br/>
but now im wanting to use stright libnds with open gl &amp; c.
<br/>
<br/>
also that video you see on my page the camera is moved &amp; rotated with the dpad not touch screen.<br/>_________________<br/><a href="https://sites.google.com/site/t3gameszero/Home" target="_blank">https://sites.google.com/site/t3gameszero/Home</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176904 - keldon - Sun Oct 16, 2011 11:17 pm</h4>
    <div class="postbody"><span class="postbody">Well the stylus input is easy; write some code that makes sense of the stylus input to detect x/y plane movement ... convert that into an angle to rotate or a distance to move, apply that to the appropriate matrices.
<br/>
<br/>
In writing this response I made some initial assumptions based on what I got from your query (please don't be offended if that is not the case, I'm not too sure so feel free to correct me <span style="font-weight: bold">^_^</span>):
<br/>
 - This is your first 3d engine and will be stepping in some fairly new territory
<br/>
 - Some areas will be quite foreign, so you'll have to learn a few concepts such as frustum culling, back face elimination and lighting equations etc, due to the engine usually taking care of that
<br/>
<br/>
As for moving from NitroEngine to <a class="postlink" href="http://devkitpro.org/wiki/libogc/GX" target="_blank">libogc</a>; you will have to write the model struct/classes yourself, etc. Thankfully the <a class="postlink" href="http://www.opengl.org/documentation/red_book/" target="_blank">OpenGL Redbook</a> explains plenty of 3d concepts, such as <a class="postlink" href="http://fly.cc.fer.hr/~unreal/theredbook/chapter03.html" target="_blank">Chapter 3 (viewing)</a> where it explains the different matrix transformations that go on in modelling, and also hierarchical modelling (though it may use a different name for it).
<br/>
<br/>
So if this is your first 3d engine (as I presume) then creating a framework whereby you can write the type of code below will tell you just about everything you need to know about how to achieve what you are after.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Note: every 'Object' has the following matrices:
<br/>
// - Local matrix, changed rarely
<br/>
// - Current matrix, regularly changed
<br/>
// - Operation matrix, applied to Current matrix whenever default operation is called,
<br/>
//   this can be used to create objects that constantly rotate around it's axis or something
<br/>
// ... The operation matrix is really there to illustrate this example
<br/>
<br/>
// Create a 3d box that can fit inside of a unit length circle
<br/>
Object* Create3dBox()
<br/>
{
<br/>
   // Vertice units so that square fits inside a unit length circle
<br/>
   Fixed32 a(Fixed32(2).SquareRoot());
<br/>
<br/>
   int vertexCount = 8;
<br/>
   Vertex *vertices = new Vertex[vertexCount];
<br/>
   vertices[0] = Vertex(a, a, a);
<br/>
   vertices[1] = Vertex(a, a, -a);
<br/>
   vertices[2] = Vertex(a, -a, -a);
<br/>
   // ... and so on
<br/>
<br/>
   int faceCount = 6;
<br/>
   Face *faces = new Face[faceCount];
<br/>
   int *indexArray;
<br/>
   int faceIndexCount = 4;
<br/>
   // Face 0 (east)
<br/>
      indexArray = new int[faceIndexCount];
<br/>
      indexArray[0] = 0;
<br/>
      indexArray[1] = 1;
<br/>
      indexArray[2] = 2;
<br/>
      indexArray[3] = 3;
<br/>
      faces[0] = Face(vertices, indexArray, faceIndexCount);
<br/>
   // Face 1 (front)
<br/>
      indexArray = new int[faceIndexCount];
<br/>
      indexArray[0] = 4;
<br/>
      indexArray[1] = 0;
<br/>
      indexArray[2] = 3;
<br/>
      indexArray[3] = 7;
<br/>
   // ... and so on
<br/>
<br/>
   return new Object(vertices, vertexCount, faces, faceCount);
<br/>
      
<br/>
} // Create3dBox
<br/>
<br/>
<br/>
// Creates a model of our solar system, fitting inside of a unit
<br/>
// length circle (with planets being represented by cubes)
<br/>
// The moon will circle the Earth
<br/>
Model* CreateSolarSystem()
<br/>
{
<br/>
   int objectCount = 9; // Sun, 8 (real planets that does not include pluto)
<br/>
<br/>
   // filled with objectCount+1(with the moon's data being the last element).
<br/>
   Fixed32 solarSystemObjectSizes[] = { /* Array filled with valid data */};
<br/>
   Fixed32 distanceFromSun[] = { /*Array filled with valid data */};
<br/>
   Fixed32 orbitRotation[] = { /*Array filled with valid data */};
<br/>
   
<br/>
<br/>
<br/>
   Model *models = new Model[objectCount];
<br/>
<br/>
   // Moon will orbit the Earth
<br/>
   Model *moon = new Model[1];
<br/>
<br/>
   for(int i = 0; i &lt; objectCount+1; ++i)
<br/>
   {
<br/>
      // Note that the moon is object 9 and will orbit the Earth, which will be later reflected in the model created
<br/>
      Matrix local;
<br/>
      local.setToIdentity();
<br/>
      // Is moon object ?
<br/>
      if( i == 9 )
<br/>
      {
<br/>
         // Descale size of Earth for the moon, since the moon's operations will occur after the Earth
<br/>
         local.scale(Fixed32(1) / Fixed32(solarSystemObjectSizes[3]));
<br/>
      }
<br/>
      local.translate(distanceFromSun[i], 0, 0);
<br/>
      local.scale(solarSystemObjectSizes[i]);
<br/>
<br/>
      // Operation matrix that will make the object orbit
<br/>
      Matrix operation;
<br/>
      operation.setToIdentity();
<br/>
      operation.rotateY(orbitRotation)
<br/>
<br/>
      Matrix current;
<br/>
      current.setToIdentity();
<br/>
<br/>
      Object *object = Create3dBox();
<br/>
<br/>
      Model *childModel = null;
<br/>
      int childModelCount = 0;
<br/>
<br/>
      // Is earth object ?
<br/>
      if( i == 3 )
<br/>
      {
<br/>
         childModel = moon;
<br/>
         childModelCount = 1;
<br/>
      }
<br/>
      Model *model = new Model(object, local, current, operation, 
<br/>
         childModel, childModelCount);
<br/>
   }
<br/>
<br/>
   Matrix identity;
<br/>
   matrix.setToIdentity();
<br/>
<br/>
   Object *nullObject = null;
<br/>
   Model *solarSystem = new Model(nullObject, identity, identity, identity,
<br/>
      models, objectCount+1);
<br/>
   return solarSystem;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Also you can draw from the NitroEngine code, though much of what is important to learn (I believe) often comes from the experience of just coding it.
<br/>
<br/>
And it would be very helpful to know what stage you're at and the sort of experience you have in order to better provide you with the right knowledge or questions for your query as I've been quite presumptuous in my response, and I do see you've done quite a bit of 3d work on the ds. You do seem to be making plenty of progress so I'm really looking forward to your work!
<br/>
<br/>
<br/>
Happy coding.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176907 - t377y000 - Mon Oct 17, 2011 9:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">Well the stylus input is easy; write some code that makes sense of the stylus input to detect x/y plane movement ... convert that into an angle to rotate or a distance to move, apply that to the appropriate matrices.
<br/>
<br/>
In writing this response I made some initial assumptions based on what I got from your query (please don't be offended if that is not the case, I'm not too sure so feel free to correct me <span style="font-weight: bold">^_^</span>):
<br/>
 - This is your first 3d engine and will be stepping in some fairly new territory
<br/>
 - Some areas will be quite foreign, so you'll have to learn a few concepts such as frustum culling, back face elimination and lighting equations etc, due to the engine usually taking care of that
<br/>
<br/>
As for moving from NitroEngine to <a class="postlink" href="http://devkitpro.org/wiki/libogc/GX" target="_blank">libogc</a>; you will have to write the model struct/classes yourself, etc. Thankfully the <a class="postlink" href="http://www.opengl.org/documentation/red_book/" target="_blank">OpenGL Redbook</a> explains plenty of 3d concepts, such as <a class="postlink" href="http://fly.cc.fer.hr/~unreal/theredbook/chapter03.html" target="_blank">Chapter 3 (viewing)</a> where it explains the different matrix transformations that go on in modelling, and also hierarchical modelling (though it may use a different name for it).
<br/>
<br/>
<br/>
<br/>
Also you can draw from the NitroEngine code, though much of what is important to learn (I believe) often comes from the experience of just coding it.
<br/>
<br/>
And it would be very helpful to know what stage you're at and the sort of experience you have in order to better provide you with the right knowledge or questions for your query as I've been quite presumptuous in my response, and I do see you've done quite a bit of 3d work on the ds. You do seem to be making plenty of progress so I'm really looking forward to your work!
<br/>
<br/>
<br/>
Happy coding.</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
my 1st 3d engine?  ^.^
<br/>
well sorta, i worked in open gl before &amp; direct x/dark gdk, that was years ago &amp; sorta just did some practice stuff. 
<br/>
never started getting into open gl until now. started using nitro engine my sophomore year, which was like 3 or 4 years ago. learned everything on my own tho. also learned o use blender very well i use it for modeling &amp; animation.
<br/>
my 1st project in nitro engine was gta 3 ds. 
<br/>
below is 1st vid of like 6 vids showing different progress learning to use nitro engine.
<br/>
<a href="http://www.youtube.com/watch?v=KzF6ngBxloc" target="_blank">http://www.youtube.com/watch?v=KzF6ngBxloc</a>
<br/>
demo here:
<br/>
<a href="https://sites.google.com/site/t3gameszero/downloads/ds-games/gta_3_ds" target="_blank">https://sites.google.com/site/t3gameszero/downloads/ds-games/gta_3_ds</a>
<br/>
<br/>
then some other practice projects(like loading sonic models &amp; stuff like that.)
<br/>
 then i cancelled gta 3 ds to start on sandbox engine ds-dsi. which is my main project now. planning on making into a huge game when i get this basic sandbox game camera &amp; open gl/c thing down lol.
<br/>
<br/>
some areas will be foreign? yes possible, im a fast learner tho, in nitro engine i did some culling back &amp; front stuff like that, &amp; in libnds i learned to change drawing distance, which i couldn't find out to do on nitro engine lol. gluprospective();
<br/>
<br/>
&amp; thanks for you're time
<br/>
can i email you to show you the current source codes &amp; compiled versions i have been trying?<br/>_________________<br/><a href="https://sites.google.com/site/t3gameszero/Home" target="_blank">https://sites.google.com/site/t3gameszero/Home</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176912 - keldon - Tue Oct 18, 2011 10:40 pm</h4>
    <div class="postbody"><span class="postbody">Well why not make them public on something like Github or mediafire for all to see? If not I can pm my email and have a look at it some time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#176936 - t377y000 - Sun Oct 30, 2011 3:26 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">Well why not make them public on something like Github or mediafire for all to see? If not I can pm my email and have a look at it some time.</td> </tr></table><span class="postbody">
<br/>
<br/>
sorry took so long to reply been busy trying to work on this &amp; stuff. but check this out.
<br/>
<br/>
ok this is what im useing.
<br/>
<br/>
actually i tried this. its in open gl
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">(this parts up at top near the includes)
<br/>
//touch rot camera
<br/>
int rx = 0, ry = 0;
<br/>
int oldx = 0, oldy = 0;
<br/>
 
<br/>
(this parts in the middle under main &amp; while)
<br/>
(useing the opengl functions)
<br/>
//camera with touchscreen
<br/>
glLoadIdentity();
<br/>
touchRead(&amp;touchXY);
<br/>
//reset x and y when user touches screen
<br/>
if( Press &amp; KEY_TOUCH){
<br/>
oldx = touchXY.px;
<br/>
oldy = touchXY.py;}
<br/>
//if user drags then grab the delta
<br/>
if( held &amp; KEY_TOUCH){
<br/>
rx += touchXY.px - oldx;
<br/>
oldx = touchXY.px;
<br/>
ry += touchXY.py - oldy;
<br/>
oldy = touchXY.py;}
<br/>
 
<br/>
(this parts at bottom)
<br/>
glRotateX(ry);
<br/>
glRotateY(rx);</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
