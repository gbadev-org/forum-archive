<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>NEW Subpixel font 4x8 with no color artifacts - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > NEW Subpixel font 4x8 with no color artifacts</h2>
<div id="posts">
<div class="post">
    <h4>#149034 - JanoSicek - Sun Jan 13, 2008 10:45 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
I am quite new to the  homebrew community, and today it is 7 days since I started developing. My first release is a font. I took interestin sub-pixel font made by Sylfurd, however the color artifacts were quite ugly.
<br/>
<br/>
Therefore I have created a new font, it is 4x8, so it is slightly bigger, however the readability is superb. There are almost no color artifacts, and the font is gamma-corrected for NDS screen.
<br/>
<br/>
The advantage of size 4x8 is that  you can use it on a tiled background BG0 and BG1! I scroll BG1 4 pixels to the right and then I can do tiled text output using these two layers. 
<br/>
<br/>
A short page with preview of the font and some info can be found here:
<br/>
<br/>
<a href="http://www.haluz.org/yesh" target="_blank">http://www.haluz.org/yesh</a>
<br/>
<br/>
There is also possibility of doing 3x8 font which would be rendered in same way as font Yesh1, therefore it would have the same size as Sylfurd's, however there  will be no color artifacts present. If you need some help with text output, ask away, as  I feel like an expert after reading several papers on subpixel font rendering and gamma correction :) Also, can anyone tell me how the  font in SylphIRC or SylphAMP works? I cannot make these application run.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149035 - Lord Graga - Sun Jan 13, 2008 11:09 pm</h4>
    <div class="postbody"><span class="postbody">You could also put them into a single layer by scaling it to half width and scaling the tiles up to double width.
<br/>
<br/>
Awesome job, if I ever need a console they might come handy.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149037 - JanoSicek - Sun Jan 13, 2008 11:37 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lord Graga wrote:</b></span></td> </tr> <tr> <td class="quote">You could also put them into a single layer by scaling it to half width and scaling the tiles up to double width.
<br/>
<br/>
Awesome job, if I ever need a console they might come handy.</td> </tr></table><span class="postbody">
<br/>
That's exactly what am I doing, however that takes a rotation background, and my BG2 and BG3 are already used. You can use it both ways.
<br/>
<br/>
BTW: You can put fixed-width font into a tiled background with size 3x8,4x8,6x8 and 8x8 with some scaling. The size 5x8 and 7x8 don't work, or at least they weren't for me. The first column of characters is not displaying the same data as the last column of characters, due to the floating point errors.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149038 - tepples - Sun Jan 13, 2008 11:46 pm</h4>
    <div class="postbody"><span class="postbody">Or you can use both BG0 and BG1, loading the font into the left half of each tile and then putting even columns in BG0 and odd columns in BG1. The 80-column mode on the Apple II used a similar 2-layer interleave, and so do the 12-pixel-wide modes of Puyo Pop and Luminesweeper.
<br/>
<br/>
That said, I'll probably make a demo that uses a similar technique with my own font because I prefer DFSG freedom.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149039 - JanoSicek - Mon Jan 14, 2008 12:14 am</h4>
    <div class="postbody"><span class="postbody">Yeah I am using the two tilemap technique. BG0 for even columns and BG1 for odd columns. Works pretty quick. 
<br/>
<br/>
I do not want to restrict anyone, please use my font in any of your projects!
<br/>
If anyone is interested in a good 3x8 font then maybe I'll render it. However I  do not know if a lot of people need more than 64 characters per line.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151653 - Lazy1 - Sat Mar 01, 2008 11:49 pm</h4>
    <div class="postbody"><span class="postbody">I'd like a 3x8 font :D
<br/>
I'm using your 4x8 one and it looks great but even more text would be nice.
<br/>
<br/>
Though I'm rendering to a framebuffer it's more than fast enough, filling the screen with As gets about 117FPS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151742 - Lazy1 - Tue Mar 04, 2008 7:00 am</h4>
    <div class="postbody"><span class="postbody">Well then, does anyone know how I can get a full 3x8 subpixel font?
<br/>
I know there is one floating around but that's just data in a header file, I need an actual bitmap that I can see to understand.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151779 - JanoSicek - Tue Mar 04, 2008 10:31 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm currently out of country, and I do not have my DS developmnet files here. What application you want to use the 3x8 font in? 
<br/>
<br/>
J.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151782 - Lazy1 - Tue Mar 04, 2008 10:35 pm</h4>
    <div class="postbody"><span class="postbody">I was just playing around with this stuff and wanted to replace the libnds console with a much larger subpixel based one as a learning exercise.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151784 - JanoSicek - Tue Mar 04, 2008 10:50 pm</h4>
    <div class="postbody"><span class="postbody">I was thinking of the 3x8 or even 3x6 exactly for the console, but the 4x8 turned out to be quite readable and sufficiently small so I stopped. You can try to create your own font :) 
<br/>
[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151785 - Lazy1 - Tue Mar 04, 2008 10:57 pm</h4>
    <div class="postbody"><span class="postbody">I would if I know how, any directions on how to do this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151788 - JanoSicek - Tue Mar 04, 2008 11:12 pm</h4>
    <div class="postbody"><span class="postbody">First you must draw a font in 9x8 grid.
<br/>
I recommend having empty first and last column.
<br/>
I also recommend to not using thin lines -- that means having a 1 in a row with 0 on both sides: 00001000 is not nice,  000110000 is better.
<br/>
<br/>
Now if you split this 9 numbers for a row into three groups of three, that's three pixels. Three numbers denote RGB parts of the color (or BGR). If you have a row: 011 000 110 then this corresponds to pixels: cyan, black, magenta. 
<br/>
<br/>
As you can see this will produce quite colorful font. This is algorithm used in generating the old, Sylfurd's font. To overcome this we will blur the source data. The 011 000 110. 
<br/>
<br/>
The blur algorithm computes average of three numbers. To get value in column X, average X-1, X and X+1. 
<br/>
<br/>
The 011 000 110 becomes 1,2,2,1,0,1,2,2,1 (in thirds)
<br/>
<br/>
Therefore the three pixels will be not CYAN, BLACK and MAGENTA, but #55AAAA, #550055, and #AAAA55. Here I use colors 00,55,AA,FF but the DS has no gamma correction, and you should use other value, I don't know them at the moment, but you can use the dropper tool on my font and find out. The Yesh2 font uses another blur and more colors...
<br/>
<br/>
I hope this was at least in part understandable...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151798 - Lazy1 - Wed Mar 05, 2008 12:26 am</h4>
    <div class="postbody"><span class="postbody">So I have to draw the font myself?
<br/>
That may be a problem since I can't draw anything even reasonably well.
<br/>
<br/>
Would it be possible to render a normal, fixed-width font into an image and convert it that way?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151799 - tepples - Wed Mar 05, 2008 12:29 am</h4>
    <div class="postbody"><span class="postbody">On the DS Lite, you can assume that gamma is <a class="postlink" href="http://en.wikipedia.org/wiki/SRGB" target="_blank">close to 2.2 like on a PC</a>.
<br/>
<br/>
1/3 power: (1/3)^(1/2.2) * 31 = 19
<br/>
2/3 power: (2/3)^(1/2.2) * 31 = 26
<br/>
<br/>
But then don't you need 64 colors to get all possible combinations of 0, 1/3, 2/3, and 1? Sure, some combinations aren't reachable from the [1 1 1]/3 convolution, but don't you need more than 16 to hit the ones that are?
<br/>
<br/>
Lazy1:
<br/>
Yes it would be possible to convert an existing fixed-width font. Start with some of <a class="postlink" href="http://pinocchio.jk0.org/nes/8x8s.png" target="_blank">these 8x8 pixel fonts</a>, and then just add a blank column at one side of each glyph.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151800 - JanoSicek - Wed Mar 05, 2008 12:35 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">On the DS Lite, you can assume that gamma is <a class="postlink" href="http://en.wikipedia.org/wiki/SRGB" target="_blank">close to 2.2 like on a PC</a>.
<br/>
<br/>
1/3 power: (1/3)^(1/2.2) * 31 = 19
<br/>
2/3 power: (2/3)^(1/2.2) * 31 = 26
<br/>
<br/>
But then don't you need 64 colors to get all possible combinations of 0, 1/3, 2/3, and 1? Sure, some combinations aren't reachable from the [1 1 1]/3 convolution, but don't you need more than 16 to hit the ones that are?
<br/>
</td> </tr></table><span class="postbody">
<br/>
In theory there are 64, but in my font I had about 19. With blurring 1,2,3,2,1 there is even more possibilities, as you have 9 shades of grey per subpixel, that's 9*9*9 theoretical colors, but the real number is much much much smalller (40ish)
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<br/>
<br/>
Lazy1:
<br/>
Yes it would be possible to convert an existing fixed-width font. Start with some of <a class="postlink" href="http://pinocchio.jk0.org/nes/8x8s.png" target="_blank">these 8x8 pixel fonts</a>, and then just add a blank column at one side of each glyph.</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151805 - Lazy1 - Wed Mar 05, 2008 2:32 am</h4>
    <div class="postbody"><span class="postbody">Is there any way to get a full 8x8 font that has the extended characters as well?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151931 - tepples - Thu Mar 06, 2008 9:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">In theory there are 64, but in my font I had about 19.</td> </tr></table><span class="postbody">
<br/>
The point is that 19 &gt; 16, meaning I have to double VRAM usage by using 256-color tiles (64 bytes per tile) rather than 16-color tiles (32 bytes per tile). That could mean the difference between fitting the screen into a VRAM bank or not.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lazy1 wrote:</b></span></td> </tr> <tr> <td class="quote">Is there any way to get a full 8x8 font that has the extended characters as well?</td> </tr></table><span class="postbody">
<br/>
There are tens of thousands of characters in Unicode, and many of them are in writing systems that don't easily shrink to 4x8 or even 8x8 pixels. Which "extended characters" are you talking about? Did you mean "MS-DOS code page 437"? Or "ISO 8859-1"? Or "Windows code page 1252"?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151963 - Lazy1 - Fri Mar 07, 2008 3:44 am</h4>
    <div class="postbody"><span class="postbody">I would guess code page 437, I am not concerned with unicode.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151966 - tepples - Fri Mar 07, 2008 5:18 am</h4>
    <div class="postbody"><span class="postbody">8x8s.png is updated with a font that covers all of cp437.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#152053 - Lazy1 - Sun Mar 09, 2008 1:20 am</h4>
    <div class="postbody"><span class="postbody">Thanks!
<br/>
I got the font converted although not with blurring yet but it's pretty readable.
<br/>
<br/>
Although unlike the 4x8 font it doesn't like being colorized, I guess it's just too small for that.
<br/>
Unless I'm trying to color the text wrong which I'm doing by shifting down certain color components to make the character appear a certain color.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#153357 - JanoSicek - Sat Mar 29, 2008 1:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JanoSicek wrote:</b></span></td> </tr> <tr> <td class="quote">In theory there are 64, but in my font I had about 19.</td> </tr></table><span class="postbody">
<br/>
The point is that 19 &gt; 16, meaning I have to double VRAM usage by using 256-color tiles (64 bytes per tile) rather than 16-color tiles (32 bytes per tile). That could mean the difference between fitting the screen into a VRAM bank or not.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Of the 19 colors you can easily use 16 and ignore 3 with the smallest count. They are used only for a minimal number of pixels. Or you can just reduce the number of colors to 16 in your favorite painting program.
<br/>
<br/>
And to answer later question about coloring a font. I don't believe this is as easy as shifting some colors. Maybe if you XOR the image with some color, then it would work, but you would need to have a contrast background. For example for red font you need cyan background...
<br/>
<br/>
J.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158870 - TwentySeven - Thu Jun 19, 2008 11:12 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the neat idea!
<br/>
<br/>
Here's my donation, a colourized touchup of the bios character page.
<br/>
<br/>
<a class="postlink" href="http://www.two-seven.net/TwoSeven_Font.bmp" target="_blank">http://www.two-seven.net/TwoSeven_Font.bmp</a>
<br/>
<br/>
<br/>
By the way, I found it significantly easier to work with a 12x8 tile size for building the 4x8 subpixel fonts..  Converting a 8x8 pixel font to 12x8 is a 150% stretch in photoshop, and then you can go in and give it a good ol' edit.  Gives good results :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158878 - TwentySeven - Fri Jun 20, 2008 3:25 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.two-seven.net/subpixelfontmaker.zip" target="_blank">www.two-seven.net/subpixelfontmaker.zip</a>
<br/>
<br/>
Here's a (super quick) little C# app I put together to let you build your own.
<br/>
<br/>
<a href="http://www.two-seven.net/fontedit.gif">[Images not permitted - Click here to view it]</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158886 - JanoSicek - Fri Jun 20, 2008 7:11 am</h4>
    <div class="postbody"><span class="postbody">Cool app!
<br/>
Does the dropshadow really work? I'm surprised!
<br/>
The sample image looks a bit red-ish.
<br/>
BTW How do you calculate blur?
<br/>
I used only two options:
<br/>
a) average of three (1,1,1)
<br/>
b) weighed average of five (1,2,3,2,1)
<br/>
But now I think that the best option would be a filter which has the biggest difference between weights of the middle pixel and the one next to it. In the two examples the differences are 0% and 33%. The best filter satisfying all constraints would be (1,1,2,1,1) with difference of 50%. Maybe you can try adding that one :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158890 - TwentySeven - Fri Jun 20, 2008 8:09 am</h4>
    <div class="postbody"><span class="postbody">Yeah, well I used a red dropshadow :)
<br/>
<br/>
For sampling a 12x8 down to a 4x8 you don't really need to use the R,G,B sub-pixels in a pixel to get a clean result, you can simply do a proper multisample per pixel and use whatever colouring you like (Including dropshadows and other tints)
<br/>
<br/>
If you want to use "proper" sub-pixels you're pretty much limited to white/grey font only...
<br/>
<br/>
As for filtering i do a horizontal one on the 12x8 source data using those exact kernels, 1,1,1 or 12321</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
