<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>A few (hopefully) simple questions - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > A few (hopefully) simple questions</h2>
<div id="posts">
<div class="post">
    <h4>#154648 - ZeroSum - Sat Apr 19, 2008 8:35 pm</h4>
    <div class="postbody"><span class="postbody">I've been playing around with libnds a bit and currently have some questions. I might have answered some of them myself but I'd like some confirmation that I've understood some things properly. I don't have my DS at the moment so sorry if some are painfully obvious if I just tried changed the code &gt;&lt;
<br/>
<br/>
1) To change a background I've just been dmaCopy'ing a new background into the memory. Am I right that the DS will just constantly draw whatever is in the memory it's pointing to and there's no need to "unload" things or constantly redraw it (like after every frame on a PC)?
<br/>
<br/>
2) Every sprite tutorial I've read has used one image per sprite. I've got about ~100 sprites so I would like to use just a sprite "sheet", would the tile hardware let me do this? Would I have to space the sprites in the sheet image a certain way?
<br/>
<br/>
3) Can you change video modes and vram settings whenever you want? I suppose yes as long as you set everything up right after each change?
<br/>
<br/>
4) Out of interest, is it possible to use backgrounds, sprites and the frame buffer on the same screen at the same time? So I could pixel plot over the top if I wanted to?
<br/>
<br/>
5) How would I set up the console to draw over the top of other backgrounds? I use both screens for the game but would like to display the log over the top of one if a button is pressed but I'm unsure how initConsoleDefault works...
<br/>
<br/>
At the moment I setup the console like so:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// This sets the BG to use a certain tilemap? Is this a default character tilemap? Could I change the font by replacing this if I wanted?
<br/>
SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
<br/>
// Text is drawn using this palette colour.
<br/>
BG_PALETTE_SUB[255] = RGB15(5,31,5);   
<br/>
<br/>
consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(31), (u16*)CHAR_BASE_BLOCK_SUB(0), 16);</td> </tr></table><span class="postbody">
<br/>
<br/>
To draw the text over the top of the game I should set it to the topmost background I'm guessing, but would I need to change any of the parameters for consoleInitDefault()? What does the first and second parameter actually point to? If I wanted to display on the main screen can I just take out the _SUB parts?
<br/>
<br/>
Thanks for reading!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154650 - josath - Sat Apr 19, 2008 8:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ZeroSum wrote:</b></span></td> </tr> <tr> <td class="quote">1) To change a background I've just been dmaCopy'ing a new background into the memory. Am I right that the DS will just constantly draw whatever is in the memory it's pointing to and there's no need to "unload" things or constantly redraw it (like after every frame on a PC)?</td> </tr></table><span class="postbody">
<br/>
Right... the DS gfx hardware just uses the data you feed it and draws it on the screen for you
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">2) Every sprite tutorial I've read has used one image per sprite. I've got about ~100 sprites so I would like to use just a sprite "sheet", would the tile hardware let me do this? Would I have to space the sprites in the sheet image a certain way?</td> </tr></table><span class="postbody">
<br/>
Read this tutorial on GBA sprites. DS sprites are almost exactly the same:
<br/>
<a href="http://www.coranac.com/tonc/text/regobj.htm" target="_blank">http://www.coranac.com/tonc/text/regobj.htm</a>
<br/>
<br/>
In particular, see the parts about 1D and 2D mapping. 2D mapping seems to make more sense at first, but 1D mapping is usually a lot easier to implement &amp; more efficient (no gaps in your VRAM)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">3) Can you change video modes and vram settings whenever you want? I suppose yes as long as you set everything up right after each change?</td> </tr></table><span class="postbody">
<br/>
Yeah, you can pretty much change the settings whenever you want. Ideally though, you make the changes during VBLANK so that the screen doesn't flicker / tear.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">4) Out of interest, is it possible to use backgrounds, sprites and the frame buffer on the same screen at the same time? So I could pixel plot over the top if I wanted to?</td> </tr></table><span class="postbody">
<br/>
Yes and no. You can use background and sprites at once, but not framebuffer mode. HOWEVER: You can have a 'bitmap' background which acts just like the framebuffer mode with a few more features. And you can change the priority of the backgrounds/sprites so some are on top/underneath/etc</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154657 - Cydrak - Sat Apr 19, 2008 11:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">4) Out of interest, is it possible to use backgrounds, sprites and the frame buffer on the same screen at the same time? So I could pixel plot over the top if I wanted to?</td> </tr></table><span class="postbody">
<br/>
Worth noting is the DS' separation between display and rendering (only partial, since they're synchronized). Framebuffer is a <span style="font-style: italic">display mode</span> and it works by reading from VRAM, instead of the 2D layer engine. DISPLAY_CR:0-3 could be called a <span style="font-style: italic">render mode</span>: it controls behavior of the layers (tilemap or 3D on BG0, and affine toggles for BG2-3).
<br/>
<br/>
That's why you "can't" use framebuffer and BGs on the same screen.
<br/>
<br/>
It's a lot clearer when you look at the capture unit, which blends and <span style="font-style: italic">writes</span> to framebuffers. In that case, a framebuffer display makes perfect sense: it gives you motion blur, limited rendering offscreen, etc. Then you're using BG, OBJ and/or 3D indirectly, through the capture.
<br/>
<br/>
If you just want to plot though, then as josath said, a bitmap is much more flexible (you even get two of them).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">5) How would I set up the console to draw over the top of other backgrounds? I use both screens for the game but would like to display the log over the top of one if a button is pressed but I'm unsure how initConsoleDefault works...</td> </tr></table><span class="postbody">
<br/>
This is a good question. consoleInitDefault(mapPtr, tilePtr, colors) does two things:
<br/>
1) Copies the console font (256 tiles or 8KB) to *tilePtr. If colors != 16, the tiles will be 8-bit. In either case color 255 will be used.
<br/>
2) Sets up the console, which will then draw text to *mapPtr.
<br/>
<br/>
The console never touches your BGs, so set them up however you like. All it needs is empty VRAM for a 32x32 map, some tiles, and a BG set up to use the memory you passed in. It doesn't even care which screen it's on, so you can remove the "SUB"s if you want.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154724 - ZeroSum - Sun Apr 20, 2008 11:51 pm</h4>
    <div class="postbody"><span class="postbody">Thank you for the replies and links. Makes a lot more sense now.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
