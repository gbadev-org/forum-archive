<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Raising pitch of a sound effect - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Raising pitch of a sound effect</h2>
<div id="posts">
<div class="post">
    <h4>#117189 - zohar - Fri Feb 02, 2007 4:18 am</h4>
    <div class="postbody"><span class="postbody">From libnds, TransferSoundData(..) will allow you to adjust the frequencies of audio files. Raising the frequency of a sample will increase its pitch and also speed up its total playtime.
<br/>
<br/>
Of course, this is what it is supposed to do--but, is there any way to raise the pitch of a sound effect <span style="font-weight: bold">without</span> affecting its length? Has anyone written any expanded sound functions beyond the limited TransferSoundData(..)?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117202 - HyperHacker - Fri Feb 02, 2007 9:51 am</h4>
    <div class="postbody"><span class="postbody">This frequency change is handled in hardware, changing the rate it reads the sound data. Suppose you want to double the pitch, then you need to double the length too since the same amount of data now creates a sound half as long. You could do this by doubling the data itself; read one byte/word/whatever size you're using from the file, and write it twice into memory (01 02 03 becomes 01 01 02 02 03 03). However a more efficient way would probably be just to change the pitch in software as you read it (01 02 03 becomes 02 04 06).
<br/>
<br/>
I hope this is right, anyway, because I've never done it myself. ^_^;<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117211 - 0xtob - Fri Feb 02, 2007 11:27 am</h4>
    <div class="postbody"><span class="postbody">Well, It's not that easy unfortunately.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You could do this by doubling the data itself; read one byte/word/whatever size you're using from the file, and write it twice into memory (01 02 03 becomes 01 01 02 02 03 03).</td> </tr></table><span class="postbody">
<br/>
This would actually have the same effect as dividing the sampling rate by two, i.e. the sample gets twice as long and the pitch gets lower.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">However a more efficient way would probably be just to change the pitch in software as you read it (01 02 03 becomes 02 04 06).</td> </tr></table><span class="postbody">
<br/>
This would increase the amplitude of the signal, and wouldn't affect the pitch at all. In <a class="postlink" href="http://en.wikipedia.org/wiki/Pulse-code_modulation" target="_blank">PCM</a> waveforms (i.e. the sound data the DS and pretty much everything else uses) the individual values don't mean the pitch but the amplitude of the recorded sound at the given time.
<br/>
<br/>
For changing the pitch without affecting the speed, you would have to do some digital signal processing. As always, Wikipedia has a good overview on <a class="postlink" href="http://en.wikipedia.org/wiki/Audio_timescale-pitch_modification" target="_blank">Pich Shifting</a>. Maybe it's possible to port the <a class="postlink" href="http://www.surina.net/soundtouch/" target="_blank">SoundTouch</a> library.<br/>_________________<br/><a class="postlink" href="http://blog.dev-scene.com/0xtob" target="_blank">http://blog.dev-scene.com/0xtob</a> | <a class="postlink" href="http://nitrotracker.tobw.net" target="_blank">http://nitrotracker.tobw.net</a> | <a class="postlink" href="http://dsmi.tobw.net" target="_blank">http://dsmi.tobw.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117243 - zohar - Fri Feb 02, 2007 8:23 pm</h4>
    <div class="postbody"><span class="postbody">I have some background in DSP so I know I can get pitch-shifting to work on a PC (either via MATLAB or other applications). The problem is... since I'm new to DS programming, I'm not sure how to even start doing this on a DS. How do I even read an audio file's data with devkit? How would I write it back to memory after I've altered it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117246 - tepples - Fri Feb 02, 2007 8:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zohar wrote:</b></span></td> </tr> <tr> <td class="quote">How do I even read an audio file's data with devkit?</td> </tr></table><span class="postbody">
<br/>
Use Chishm's libfat and a .wav parser library (which I can provide if you want).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">How would I write it back to memory after I've altered it?</td> </tr></table><span class="postbody">
<br/>
Use Chishm's libfat and a .wav writer library (which I can provide if you want).<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117289 - zohar - Sat Feb 03, 2007 10:14 am</h4>
    <div class="postbody"><span class="postbody">Yeah, tepples, that would be great. Do you have a link or will you send it via email? Also, I thought DS only takes raw files?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117318 - tepples - Sat Feb 03, 2007 8:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zohar wrote:</b></span></td> </tr> <tr> <td class="quote">Yeah, tepples, that would be great. Do you have a link</td> </tr></table><span class="postbody">
<br/>
Look in <a class="postlink" href="http://nesdev.parodius.com/#PCSound" target="_blank">81</a> and <a class="postlink" href="http://www.pineight.com/gba/#8ad" target="_blank">8ad</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Also, I thought DS only takes raw files?</td> </tr></table><span class="postbody">
<br/>
The DS <span style="font-style: italic">hardware</span> only takes raw files, but your code can load a .wav file from FAT into RAM, invert the most significant bit of each sample to convert unsigned samples to signed samples (if the file's header indicates that the data is 8-bit PCM), and then tell the ARM7 to copy the address, format, rate, and length of the sound data from the file's header into the sound registers.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117415 - silent_code - Sun Feb 04, 2007 7:59 pm</h4>
    <div class="postbody"><span class="postbody">*OFFTOPIC*
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zohar wrote:</b></span></td> </tr> <tr> <td class="quote"> ... via MATLAB or ...</td> </tr></table><span class="postbody">
<br/>
<br/>
OMFG, MATLAB! now, that's an application i *can't* stand. yeah, it's powerfull and all, but...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#117482 - zohar - Mon Feb 05, 2007 2:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">OMFG, MATLAB! now, that's an application i *can't* stand. yeah, it's powerfull and all, but...</td> </tr></table><span class="postbody">
<br/>
<br/>
lol, I was the same way too actually. But after a while, you really have to appreciate everything it does, and how well it does it. It's just ridiculous.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
