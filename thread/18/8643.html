<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>devkitPRO help: compiling DSBoy - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > devkitPRO help: compiling DSBoy</h2>
<div id="posts">
<div class="post">
    <h4>#72599 - Hypershell - Mon Feb 20, 2006 8:17 am</h4>
    <div class="postbody"><span class="postbody">Okay, so I downloaded Ethos's <a class="postlink" href="http://ethos.oddigytitanium.com/dsboy/DSBoy0.1.zip" target="_blank">DSBoy</a> to see how it compares to the other GBC emulators out there.  Problem, it's in source code only, and I'm not a programmer.  But, I gotta try anyway.  So, I stick my MegaMan Xtreme2 game into the proper folder and rename it appropriately as per the instructions.  Downloaded devkitPRO, grabbed a tutorial, and attempted to compile.
<br/>
<br/>
Then this happens:
<br/>
<a href="http://home.comcast.net/~Serpentara/DSBoyError.gif">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
Now, I'm your typical math/science wiz and I've done some extremely basic text-editor and hex-editor tinkering, but my coding knowledge is nonexistant.  I had to ask a friend how to move up a directory in DOS.  &gt;_&gt;
<br/>
<br/>
So, preferrably in a total-n00b-style explanation, how do I fix those errors?<br/>_________________<br/>MKDS friend code: 459633-596796
<br/>
Contact me on AIM to exchange.  I have accessed the extra 12 tracks online.
<br/>
<span style="font-weight: bold"><span style="font-style: italic">NOTE: Projectile items will not work in the docked ship of Airship Fortress, or the tunnel of Waluigi Pinball.</span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72644 - Sausage Boy - Mon Feb 20, 2006 8:31 pm</h4>
    <div class="postbody"><span class="postbody">Short explanation: Download an older version of libnds.
<br/>
<br/>
Long explanation: Well, those commands don't exist anymore, so you'd need to modify them. I did, and then got tons of errors about bad instructions in cpu_a.s, so I suppose you'll have to go with the short explanation.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72646 - genfish - Mon Feb 20, 2006 8:54 pm</h4>
    <div class="postbody"><span class="postbody">commands shouldnt be removed for backwards compatability i think :(<br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72718 - Hypershell - Tue Feb 21, 2006 5:28 am</h4>
    <div class="postbody"><span class="postbody">Yeah, one would think.
<br/>
<br/>
Thanks a million for your help, Sausage Boy.  Now to figure WHICH version of libnds this #$(%*&amp;#$ thing will work with.<br/>_________________<br/>MKDS friend code: 459633-596796
<br/>
Contact me on AIM to exchange.  I have accessed the extra 12 tracks online.
<br/>
<span style="font-weight: bold"><span style="font-style: italic">NOTE: Projectile items will not work in the docked ship of Airship Fortress, or the tunnel of Waluigi Pinball.</span></span></span><span class="gensmall"><br/><br/>Last edited by Hypershell on Tue Feb 21, 2006 5:46 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#72720 - tepples - Tue Feb 21, 2006 5:32 am</h4>
    <div class="postbody"><span class="postbody">Or you could just comment out all the 'console' stuff, as it's likely just debugging information.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72728 - Hypershell - Tue Feb 21, 2006 6:13 am</h4>
    <div class="postbody"><span class="postbody">The version of libnds that eliminated the commands was apparantly 20050914.  20050804 or anything lower will take the lcd.cpp file just fine.
<br/>
<br/>
The problem is, like Sausage Boy and his mod attempts, I too get a bazillion "Error: bad instruction" messages regarding cpu_a.s
<br/>
<br/>
Tried using tepples' method too, the same thing happened.<br/>_________________<br/>MKDS friend code: 459633-596796
<br/>
Contact me on AIM to exchange.  I have accessed the extra 12 tracks online.
<br/>
<span style="font-weight: bold"><span style="font-style: italic">NOTE: Projectile items will not work in the docked ship of Airship Fortress, or the tunnel of Waluigi Pinball.</span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72737 - tepples - Tue Feb 21, 2006 7:27 am</h4>
    <div class="postbody"><span class="postbody">Anything involving existing '.s' files should be replaced with the equivalent C code or translated from x86 assembly language into ARM assembly language. If you need a gbz80 core, it might be worth your while to look at porting Goomba Color.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72741 - crossraleigh - Tue Feb 21, 2006 8:04 am</h4>
    <div class="postbody"><span class="postbody">Or rather, fix the full path include of macro.h in cpu_a.s. It's ARM code (with lots of macros).
<br/>
<br/>
Also, be sure to run <span style="font-style: italic">make build</span> instead of just <span style="font-style: italic">make</span>. That makefile is botched up.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72758 - strager - Tue Feb 21, 2006 1:51 pm</h4>
    <div class="postbody"><span class="postbody">I think that the problem is with the .s script file is that gcc is not preprocessing the file first.  Somewhere in the compiler's docs, it says that for an assembly file to be preprocessed, it's file extention must be a capitol S.  I don't think this works in Windows (because maybe the filename is all lowercase once it gets to gcc), so you need to use the compiler option "-x assembler-with-cpp".  Just make sure you don't compile your C/C++ source files with this option, or you'd be in trouble!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72783 - crossraleigh - Tue Feb 21, 2006 7:11 pm</h4>
    <div class="postbody"><span class="postbody">Preprocessing won't fix the wrong absolute path include.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">.include "d:/eclipse/workspace/DS_ASM/asm/macro.h"</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72798 - Hypershell - Tue Feb 21, 2006 9:22 pm</h4>
    <div class="postbody"><span class="postbody">Strager and Tepples, I appreciate the help, but as I mentioned in my first post I have basically no programming experience, so you're starting to lose me.
<br/>
<br/>
Crossraleigh, I corrected the file path, that seemed to fix things.  Trouble is I can't figure out where/if it's saving the file.  I think what's going on is that it's automatically cleaning the folder it previously saved to.
<br/>
<br/>
EDITS: And yes, that was it, so I had to edit Makefile so as not to delete the .nds and .ds.gba files.  Also had to apply Pepsiman's M3 power loader, but it's finally working.<br/>_________________<br/>MKDS friend code: 459633-596796
<br/>
Contact me on AIM to exchange.  I have accessed the extra 12 tracks online.
<br/>
<span style="font-weight: bold"><span style="font-style: italic">NOTE: Projectile items will not work in the docked ship of Airship Fortress, or the tunnel of Waluigi Pinball.</span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72807 - tepples - Tue Feb 21, 2006 10:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Hypershell wrote:</b></span></td> </tr> <tr> <td class="quote">Strager and Tepples, I appreciate the help, but as I mentioned in my first post I have basically no programming experience, so you're starting to lose me.</td> </tr></table><span class="postbody">
<br/>
In that case, I'd suggest sticking with Goomba Color until somebody with more programming experience steps to the plate.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72808 - Sausage Boy - Tue Feb 21, 2006 10:09 pm</h4>
    <div class="postbody"><span class="postbody">Ok, to make it compile, you need to uncomment the consolePrintf's, seems like you did that. I tried replacing them with the correct commands, and all I got was an irritating WAIT: 0 on the top screen repeated over and over again.
<br/>
<br/>
Next you need to fix the path in cpu_a.s. I wanted it simple, so I just typed in the absolute path on my computer. macro.h is in the same folder as cpu_a.s.
<br/>
<br/>
Now, open a terminal with Start-&gt;Run and type cmd. cd your way to where the DSBoy map is. For example, "cd C:\Projects\DSBoy". If the map is on a different partition, type D: (for example) before you use cd.
<br/>
<br/>
Type "make clean" (without quotes). You should see "clean ...". Now type "make build". It will print shitloads of stuff, but the last line should say "built ... DSBoy.ds.gba". You should now have DSBoy.nds and DSBoy.ds.gba in the DSBoy directory.
<br/>
<br/>
If you want to use another rom, rename it to gbarom.bin and put it in the data folder.
<br/>
<br/>
Enjoy ;)<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"><br/><br/>Last edited by Sausage Boy on Tue Feb 21, 2006 10:10 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#72809 - Hypershell - Tue Feb 21, 2006 10:09 pm</h4>
    <div class="postbody"><span class="postbody">I got it, Sausage Boy, I was just a little late editing my post.
<br/>
<br/>
Well, my curiosity is satisfied, although Goomba Color is definitely the better emu.  Nice to at least know how the others compare.
<br/>
<br/>
Thanks for your help, everyone, I appreciate it a lot.<br/>_________________<br/>MKDS friend code: 459633-596796
<br/>
Contact me on AIM to exchange.  I have accessed the extra 12 tracks online.
<br/>
<span style="font-weight: bold"><span style="font-style: italic">NOTE: Projectile items will not work in the docked ship of Airship Fortress, or the tunnel of Waluigi Pinball.</span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72829 - wintermute - Wed Feb 22, 2006 12:59 am</h4>
    <div class="postbody"><span class="postbody">Here's a patch to fix the problems.
<br/>
<br/>
<a href="http://devkitpro.sourceforge.net/DSBoy.patch" target="_blank">http://devkitpro.sourceforge.net/DSBoy.patch</a>
<br/>
<br/>
In order to apply this patch save it to your hard drive, extract the DSBoy archive linked earlier in the thread then open an msys terminal - this is found in the devkitPro start menu if you used the windows installer. Move to the DSboy directory - i.e. cd /e/projects/DSBoy - then type 'patch -p1 -i &lt;path to&gt;/DSBoy.patch' where &lt;path to&gt; is replaced by the full path (or a relative path&gt; to the patch file.
<br/>
<br/>
What I've done is fix the makefile so a normal make works, add a pnproj file, replace the consolePrintf with iprintf and fix the include path in the asm.
<br/>
<br/>
I haven't tested the resulting build but it does compile cleanly.
<br/>
<br/>
If you have problems applying the patch then the patched source is also available at <a href="http://devkitpro.sourceforge.net/DSBoy-update.zip" target="_blank">http://devkitpro.sourceforge.net/DSBoy-update.zip</a>
<br/>
<br/>
The advantage of the patch file is that you can see exactly what changes were made.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
