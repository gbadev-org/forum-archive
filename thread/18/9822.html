<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>REG_IF quick question - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > REG_IF quick question</h2>
<div id="posts">
<div class="post">
    <h4>#86569 - wickedtrickster - Wed Jun 07, 2006 10:11 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
I'm currently coding at interrupt handler to be call once per VBlank. So far, everything works, my code is as follow:
<br/>
<br/>
void on_irq (void) {
<br/>
  if (REG_IF &amp; IRQ_VBLANK) {
<br/>
    do_stuff ();
<br/>
    VBLANK_INTR_WAIT_FLAGS |= IRQ_VBLANK;
<br/>
    REG_IF |= IRQ_VBLANK;
<br/>
}
<br/>
<br/>
Well, what's bugging me is this line :
<br/>
<br/>
REG_IF |= IRQ_VBLANK;
<br/>
<br/>
which is the same as 
<br/>
<br/>
REG_IF = REG_IF | IRQ_VBLANK;
<br/>
<br/>
which since we are inside a if (REG_IF &amp; IRQ_VBLANK) is the same as
<br/>
<br/>
REG_IF = REG_IF;
<br/>
<br/>
Which doesn't make sense. I did some search on the forum and found that you need to write set bits to REG_IF in order to let the DS knows you handled the interrupts. With this explanation, a line like
<br/>
<br/>
REG_IF = REG_IF;
<br/>
<br/>
tell the DS you handled all interrupts, which works in my code since I only manage 1 interrupts but I do not think it was the idea when the code was written. Shouldn't the line
<br/>
<br/>
REG_IF |= IRQ_VBLANK;
<br/>
<br/>
be written
<br/>
<br/>
REG_IF = IRQ_VBLANK;
<br/>
<br/>
? Yet, allmost all the example code I find on the internet do the |= kind of code. I guess there is something I understood wrong, but I can't figured out what is it....
<br/>
<br/>
Thank you,
<br/>
Ben.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86572 - NEiM0D - Wed Jun 07, 2006 10:13 pm</h4>
    <div class="postbody"><span class="postbody">It should be REG_IF = IRQ_VBLANK. Everyone doing it with |= is simply wrong.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86575 - wickedtrickster - Wed Jun 07, 2006 10:29 pm</h4>
    <div class="postbody"><span class="postbody">Ok, thankx a lot !</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
