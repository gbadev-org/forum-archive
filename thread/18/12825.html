<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Changing texture data - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Changing texture data</h2>
<div id="posts">
<div class="post">
    <h4>#123191 - zeGouky - Mon Mar 26, 2007 1:08 am</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
i was wondering how to change the texture data after allocation and i found some answers on the forum but i get black pixel on the first 64 lines of the screen.
<br/>
<br/>
To change the texture data i'm using the function glTexImage2D_retAddr found on the forum and when i want to change the data im doing like that :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
      uint32 vram_temp = vramSetMainBanks( VRAM_A_LCD, VRAM_B_LCD, VRAM_C_LCD, VRAM_D_LCD);
<br/>
<br/>
      dmaCopy( data, texture_addr, (256*256)&lt;&lt;1);
<br/>
   
<br/>
      vramRestoreMainBanks( vram_temp); 
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I tried swiCopy and im getting the result, if I copy only half of the texture then no black lines.
<br/>
<br/>
Anyone already had this issue ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123200 - DekuTree64 - Mon Mar 26, 2007 2:48 am</h4>
    <div class="postbody"><span class="postbody">You have to wait until VBlank to avoid the black lines. Since you have to take the VRAM banks away from the 3D hardware to transfer things to them, it just renders black instead.
<br/>
The best way I know of to deal with it is to write a transfer queue system instead of doing the copy directly in the model loader code.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123203 - tepples - Mon Mar 26, 2007 2:50 am</h4>
    <div class="postbody"><span class="postbody">Have you tried waiting for vblank, copying the first half of the texture data, waiting for another vblank, and copying the second half of the texture data?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123216 - zeGouky - Mon Mar 26, 2007 8:29 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm doing the texture changes right after the swiWaitForVBlank(); but still get the black lines.  
<br/>
<br/>
I can try to write the texture in 2 half.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123217 - HyperHacker - Mon Mar 26, 2007 8:45 am</h4>
    <div class="postbody"><span class="postbody">If that works, you might try copying it during HBlank too. More difficult, but you may well pull it off in one frame.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#123395 - silent_code - Tue Mar 27, 2007 9:55 pm</h4>
    <div class="postbody"><span class="postbody">can't it be done with interrupts???? i don't have much experience with them, but they somehow came to my mind while reading this. &lt;crazymode&gt;("go away, BAD INTERRUPT, *BAD* INTERRUPT! SIT!")&lt;/crazymode&gt;</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
