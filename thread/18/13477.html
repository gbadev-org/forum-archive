<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>USB Debugging, how to implement it? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > USB Debugging, how to implement it?</h2>
<div id="posts">
<div class="post">
    <h4>#131850 - goruka - Wed Jun 20, 2007 6:33 pm</h4>
    <div class="postbody"><span class="postbody">Ok, it seems using the USB chip inside the n-card is pretty simple, as it had registers just mapped to the GBA rom area.. Also, as it seems this chip is kind of popular in many devices, I though i'd write some debugging support (writing out printf's and gdb)... however, I've been checking usb.org and i can't seen to find any "standard" device i can emulate for communicating (as in, something that can emulate a serial port under windows, and a /dev/ttyUSB under linux/unixes)..
<br/>
I want to use an existing device driver because I don't really want to bother writing a write for any OS the thing will run on... so, what USB device do you people recommend me to emulate for DS &lt;-&gt; PC communication?
<br/>
<br/>
Thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131852 - Diddl - Wed Jun 20, 2007 6:49 pm</h4>
    <div class="postbody"><span class="postbody">I would implement an virtual Com like some USB devices have. So normal debug over serial port is useable without changes</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131854 - goruka - Wed Jun 20, 2007 7:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Diddl wrote:</b></span></td> </tr> <tr> <td class="quote">I would implement an virtual Com like some USB devices have. So normal debug over serial port is useable without changes</td> </tr></table><span class="postbody">
<br/>
<br/>
That's pretty much what I want to do, but there doesn't seem to be any device like that in the USB.org standard device  specifications... or at least none that i could find. I don't want to do anything that forces me to write a driver, (and much less a windows driver) since that's a lot more work...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131869 - tepples - Wed Jun 20, 2007 9:50 pm</h4>
    <div class="postbody"><span class="postbody">USB has a <a class="postlink" href="http://www.usb.org/developers/defined_class/#BaseClass02h" target="_blank">communications device class</a>, which USB to RS232 adapters use. Have you checked the <a class="postlink" href="http://www.usb.org/developers/devclass_docs#approved" target="_blank">communication device class spec</a>?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131916 - masscat - Thu Jun 21, 2007 10:48 am</h4>
    <div class="postbody"><span class="postbody">My understanding of what you are trying to do is plug the n-card into the PC via USB and have it appear as a serial port.
<br/>
If this is correct and you do not want to write your own PC side driver then you will have to emulate (on the DS/n-card side) a serial/UART USB bridge device and borrow the vendor/device id of somebody's product that uses the device so that the PC can then use their driver.
<br/>
<br/>
Looking at the linux kernel source there are a number of devices you could emulate (have a look in drivers/usb/serial). For example, one device I picked at random was the Prolific PL2303, the datasheet of which is available from the <a class="postlink" href="http://www.prolific.com.tw/" target="_blank">Prolific website</a>. The kernel source also includes vendor/device id pairs of products that use the device.
<br/>
<br/>
Have a look at the other devices as there may be one that is easier/nicer to emulate, as here is a comment from the kernel usb to serial driver code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/* BEGIN HORRIBLE HACK FOR PL2303 */
<br/>
/* this is needed due to the looney way its endpoints are set up */</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
