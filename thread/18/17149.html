<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Recent PAlib updates explained - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Recent PAlib updates explained</h2>
<div id="posts">
<div class="post">
    <h4>#172931 - fincs - Thu Mar 11, 2010 10:19 pm</h4>
    <div class="postbody"><span class="postbody">(Note: this was supposed to be a reply to a help post in this forum that had to do with PAlib)
<br/>
<br/>
Recently there has been some effort put into PAlib to make it less "evil" and compatible with the latest versions of devkitARM and libnds.
<br/>
<br/>
This is PAlib's recent story:
<br/>
First of all, Mollusk went MIA around a year ago or so. Some community builds appeared at the time. Afterwards libnds 1.3.0 was released and WinterMute showed up in the (old) PAlib forums to make us think about the situation.
<br/>
After understanding that PAlib was now a community project, I and n00bey started to adapt PAlib to the latest toolchain and libraries. Lots of beta versions were released at the time, each one fixing known bad practice problems and removing unused/deprecated/useless/unclean stuff. This includes the removal of the (rather shoddy) FatLoading, Video (wtf?) and GIF to tiles (wtf?!?!) modules and the deprecation of the #include data.c method and lots of token pasting macros.
<br/>
<br/>
At the time of writing PAlib is fully compatible with the latest versions of everything (albeit needing a recompilation to solve vramSetBankXX problems). The only problem with PAlib now is its clunkiness.
<br/>
<br/>
The reason that PAlib has so many wrappers around libnds/etc is actually historical. Mollusk said that PAlib began as a libnds replacement (with its own interrupt/etc system). libnds continued evolving, and it was clear that PAlib had to somehow adapt to the situation. Mollusk then decided to change PAlib to be based on libnds (with many incompatibilities), and this brought all the maintenance problems the devkitPro team has had to deal with.
<br/>
<br/>
The future of PAlib will probably consist on a complete rewrite. This new "PAlib" would have a completely different approach. It would be a series of wrappers around libnds that would manage the "hard" part of the equation (VRAM managing), and possibly some sugar here and there, but never an all-in-one DS homebrew library.
<br/>
<br/>
Go to <a class="postlink" href="http://wiki.devkitpro.org/index.php/PAlib" target="_blank">the new PAlib homepage</a> for updated information.</span><span class="gensmall"><br/><br/>Last edited by fincs on Fri Mar 12, 2010 9:24 pm; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#172935 - wintermute - Fri Mar 12, 2010 12:18 am</h4>
    <div class="postbody"><span class="postbody">No version of PALib will *ever* be supported by devkitPro given the major issues that it and it's users have caused us.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Mollusk then decided to change PAlib to be based on libnds (with many incompatibilities), and this brought all the maintenance problems the devkitPro team has had to deal with. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
That's a complete lie. The PALib installer deliberately overwrote libraries and broke the toolchain. Even now I'm *still* seeing problems from that.
<br/>
<br/>
The single best thing you could possibly do for the homebrew community is leave PALib to die instead of attempting to resurrect a decomposing corpse.
<br/>
<br/>
Even now, there is zero contact with the toolchain and library maintainers. No advice is being sought on how best to ensure that your code, examples and tutorials don't break the tools they depend on.
<br/>
<br/>
Wrappers and sugar for libnds would be far better contributed to libnds and you'd be much better off talking to us on IRC.
<br/>
<br/>
Here's some code I was looking at earlier :-
<br/>
<br/>
The libnds code
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int soundPlayPSG(DutyCycle cycle, u16 freq, u8 volume, u8 pan){
<br/>
   FifoMessage msg;
<br/>
<br/>
   msg.type = SOUND_PSG_MESSAGE;
<br/>
   msg.SoundPsg.dutyCycle = cycle;
<br/>
   msg.SoundPsg.freq = freq;
<br/>
   msg.SoundPsg.volume = volume;
<br/>
   msg.SoundPsg.pan = pan;
<br/>
<br/>
   fifoSendDatamsg(FIFO_SOUND, sizeof(msg), (u8*)&amp;msg);
<br/>
<br/>
   while(!fifoCheckValue32(FIFO_SOUND));
<br/>
<br/>
   return (int)fifoGetValue32(FIFO_SOUND);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Some code recently added to PALib
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void PA_PlayPSG(u8 chan, u8 vol, u8 pan, u32 freq, u8 duty) {
<br/>
   PA_FifoMsg msg;
<br/>
   msg.type = PA_MSG_PSG;
<br/>
   msg.PSGMsg.freq = freq &lt;&lt; 1; // a bug that fixes a bug.
<br/>
   msg.PSGMsg.chan = (chan &amp; 7) | 8; // clip it to a valid PSG channel
<br/>
   msg.PSGMsg.vol = vol &amp; 0x7F;
<br/>
   msg.PSGMsg.pan = pan &amp; 0x7F;
<br/>
   msg.PSGMsg.duty = duty &amp; 7;
<br/>
   PA_SendFifoMsg(msg);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
What exactly was the point of that? Why didn't you come and suggest libnds should work this way?
<br/>
<br/>
There are other source files in there that have basically been lifted from libnds with renamed functions.
<br/>
<br/>
Do you have permission to distribute no$gba?
<br/>
<br/>
Why are you still using templates from 4 years ago? Didn't you learn anything from PALib templates failing when we moved from arm-elf to arm-eabi? People using the standard devkitPro supplied templates didn't even notice.
<br/>
<br/>
There's so much more insanity in PALib that I wouldn't even know where to begin fixing it.
<br/>
<br/>
And pull that wiki, half of it reads like a manual on how to turn yourself into the worst programmer ever.
<br/>
<br/>
Please, for the good of DS Homebrew, let it die.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172946 - sverx - Fri Mar 12, 2010 10:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>fincs wrote:</b></span></td> </tr> <tr> <td class="quote">a series of wrappers around libnds that would manage the "hard" part of the equation (VRAM managing), and possibly some sugar here and there</td> </tr></table><span class="postbody">
<br/>
<br/>
I guess wrappers could become contributions to libnds? I've read in this forum somebody's already doing something similar...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172962 - fincs - Fri Mar 12, 2010 9:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Mollusk then decided to change PAlib to be based on libnds (with many incompatibilities), and this brought all the maintenance problems the devkitPro team has had to deal with. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
That's a complete lie. The PAlib installer deliberately overwrote libraries and broke the toolchain. Even now I'm *still* seeing problems from that.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Guess I kind of smoothed up too much that part...
<br/>
The beginning of what I said is right (Mollusk "adapted" PAlib to be based off libnds), but as libnds changed (and thus breaking PAlib) Mollusk (dumbly) decided to bundle old versions of libnds with it, causing the maintenance problems you have had.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
The single best thing you could possibly do for the homebrew community is leave PAlib to die instead of attempting to resurrect a decomposing corpse.
<br/>
</td> </tr></table><span class="postbody">
<br/>
You're right (myself I don't use PAlib anymore), but remember that there are still many people depending on PAlib. The least I can do is to try to maintain this "corpse" until better wrappers/tutorials are written for libnds (patater's uses floats!!!!).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Here's some code I was looking at earlier :-
<br/>
<br/>
The libnds code
<br/>
(snip)
<br/>
<br/>
Some code recently added to PALib
<br/>
(snip)
<br/>
<br/>
What exactly was the point of that? Why didn't you come and suggest libnds should work this way?
<br/>
</td> </tr></table><span class="postbody">
<br/>
In order to deliver battery, temperature and microphone "volume" (btw why wasn't that added to libnds?) to the ARM9 a FIFO channel had to be allocated. I decided to use FIFO_SOUND since there already are sound solutions that work with PAlib (Maxmod and *shudder* ASlib). Now you've made me think...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
There are other source files in there that have basically been lifted from libnds with renamed functions.
<br/>
<br/>
Do you have permission to distribute no$gba?
<br/>
</td> </tr></table><span class="postbody">
<br/>
Those are things that I haven't touched.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Why are you still using templates from 4 years ago? Didn't you learn anything from PALib templates failing when we moved from arm-elf to arm-eabi? People using the standard devkitPro supplied templates didn't even notice.
<br/>
</td> </tr></table><span class="postbody">
<br/>
The makefile was updated to be more recent/newbie-friendly in the latest PAlib version.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
There's so much more insanity in PALib that I wouldn't even know where to begin fixing it.
<br/>
</td> </tr></table><span class="postbody">
<br/>
You're soo right... (recalls cleaning up PAlib source code files)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
And pull that wiki, half of it reads like a manual on how to turn yourself into the worst programmer ever.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Again, I'm not responsible of that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Please, for the good of DS Homebrew, let it die.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Well, it will die when better wrappers are built for libnds. And the upcoming PAlib release will be the last, I promise.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172970 - wintermute - Sat Mar 13, 2010 1:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>fincs wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
The single best thing you could possibly do for the homebrew community is leave PAlib to die instead of attempting to resurrect a decomposing corpse.
<br/>
</td> </tr></table><span class="postbody">
<br/>
You're right (myself I don't use PAlib anymore), but remember that there are still many people depending on PAlib. The least I can do is to try to maintain this "corpse" until better wrappers/tutorials are written for libnds (patater's uses floats!!!!).
<br/>
</span></td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
No, the least you could do is co-operate with the toolchain maintainers and help provide those wrappers and tutorials.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
In order to deliver battery, temperature and microphone "volume" (btw why wasn't that added to libnds?) to the ARM9 a FIFO channel had to be allocated. I decided to use FIFO_SOUND since there already are sound solutions that work with PAlib (Maxmod and *shudder* ASlib). Now you've made me think...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It wasn't added to libnds because no-one got round to it yet - mainly because we keep getting distracted by broken tools caused by PALib installs.
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Please, for the good of DS Homebrew, let it die.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Well, it will die when better wrappers are built for libnds. And the upcoming PAlib release will be the last, I promise.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
There's an easy answer to that  ... help us to help you. i.e. start being part of the solution and stop being part of the problem.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172971 - fincs - Sat Mar 13, 2010 1:17 pm</h4>
    <div class="postbody"><span class="postbody">Well, in fact I'm (supposed to be) making a wrapper library, but it still doesn't have anything since it was started then left over...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
