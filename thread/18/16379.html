<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Corrupted memory - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Corrupted memory</h2>
<div id="posts">
<div class="post">
    <h4>#166124 - Echo49 - Fri Jan 30, 2009 12:46 pm</h4>
    <div class="postbody"><span class="postbody">I have code similar to the following:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">class Object
<br/>
{
<br/>
    public:
<br/>
        Object(int value);
<br/>
        int getValue() { return mValue; }
<br/>
    protected:
<br/>
        int mValue;
<br/>
};
<br/>
<br/>
Object::Object(int value)
<br/>
{
<br/>
    mValue = value;
<br/>
    iprintf("%i", mValue);
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
    Object o(100);
<br/>
    iprintf("%i", o.getValue());
<br/>
}</td> </tr></table><span class="postbody">
<br/>
The first iprintf outputs the correct value as expected, but the one after the constructor returns is a totally different value. Any idea what is causing this - some sort of stack corruption?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166126 - hacker013 - Fri Jan 30, 2009 6:04 pm</h4>
    <div class="postbody"><span class="postbody">i think this should work:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
class Object 
<br/>
{ 
<br/>
    public: 
<br/>
        Object(int value); 
<br/>
        int getValue(); 
<br/>
    protected: 
<br/>
        int mValue; 
<br/>
}; 
<br/>
<br/>
Object::Object(int value) 
<br/>
{ 
<br/>
    mValue = value; 
<br/>
    iprintf("%i", mValue); 
<br/>
} 
<br/>
<br/>
int Object::getValue()
<br/>
{
<br/>
return mValue;
<br/>
}
<br/>
<br/>
int main() 
<br/>
{ 
<br/>
    Object o(100); 
<br/>
    iprintf("%i", o.getValue()); 
<br/>
}
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166129 - Echo49 - Fri Jan 30, 2009 9:45 pm</h4>
    <div class="postbody"><span class="postbody">I found my mistake; My code actually uses an object rather than an int in the class, and I foolishly declared an object on the stack in the constructor to assign to it. So, as soon as the constructor returned, the pointer was no longer valid. That should teach me to code at 1am ==</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
