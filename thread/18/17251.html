<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Trouble compiling libpogo2 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Trouble compiling libpogo2</h2>
<div id="posts">
<div class="post">
    <h4>#173954 - JackUzi - Mon May 10, 2010 12:10 am</h4>
    <div class="postbody"><span class="postbody">Hello. I am trying to compile libpogo and glkpogo using devkitarm but aren't having much luck so far. I am very new to DS development so I was hoping someone might me able to tell me what I am doing wrong.
<br/>
<br/>
I am developing on Ubuntu 10.4 and have the following environment variables set:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
DEVKITARM=/opt/devkitpro/devkitARM
<br/>
DEVKITPRO=/opt/devkitpro
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
When I run configure, with what may or may not be the correct arguments I get:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">~/svn/pogo2/libpogo$ ./configure --enable-platform=NDS --host=arm-eabi --build=arm-eabi --prefix=/opt/devkitpro/devkitARM/
<br/>
checking for a BSD-compatible install... /usr/bin/install -c
<br/>
checking whether build environment is sane... yes
<br/>
checking for a thread-safe mkdir -p... /bin/mkdir -p
<br/>
checking for gawk... gawk
<br/>
checking whether make sets $(MAKE)... yes
<br/>
configure: Selected ARM based platform NDS
<br/>
configure: Using ../../libnds as libnds location
<br/>
checking build system type... arm-unknown-eabi
<br/>
checking host system type... arm-unknown-eabi
<br/>
checking for freetype-config... freetype-config
<br/>
checking for arm-eabi-gcc... arm-eabi-gcc
<br/>
checking whether the C compiler works... no
<br/>
configure: error: in `/home/stuart/svn/pogo2/libpogo':
<br/>
configure: error: C compiler cannot create executables
<br/>
See `config.log' for more details.
<br/>
</td> </tr></table><span class="postbody">
<br/>
The relevant section from config.log appears to be:Configured with:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> ../../gcc-4.4.3/configure --enable-languages=c,c++,objc --with-cpu=arm7tdmi --enable-interwork --enable-multilib --with-gcc --with-gnu-ld --with-gnu-as --disable-dependency-tracking --disable-shared --disable-threads --disable-win32-registry --disable-nls --disable-debug --disable-libmudflap --disable-libssp --disable-libgomp --disable-libstdcxx-pch --target=arm-eabi --with-newlib --prefix=/opt/devkitpro/devkitARM --with-bugurl=http://wiki.devkitpro.org/index.php/Bug_Reports --with-pkgversion='devkitARM release 30'
<br/>
Thread model: single
<br/>
gcc version 4.4.3 (devkitARM release 30)
<br/>
configure:2898: $? = 0
<br/>
configure:2887: arm-eabi-gcc -V &gt;&amp;5
<br/>
arm-eabi-gcc: '-V' option must have argument
<br/>
configure:2898: $? = 1
<br/>
configure:2887: arm-eabi-gcc -qversion &gt;&amp;5
<br/>
arm-eabi-gcc: unrecognized option '-qversion'
<br/>
arm-eabi-gcc: no input files
<br/>
configure:2898: $? = 1
<br/>
configure:2918: checking whether the C compiler works
<br/>
configure:2940: arm-eabi-gcc  -mthumb-interwork -specs=ds_arm9.specs   conftest.c  &gt;&amp;5
<br/>
/opt/devkitpro/devkitARM/lib/gcc/arm-eabi/4.4.3/../../../../arm-eabi/lib/ds_arm9_crt0.o: In function `CIDLoop':
<br/>
(.init+0x1c0): undefined reference to `__libnds_mpu_setup'
<br/>
/opt/devkitpro/devkitARM/lib/gcc/arm-eabi/4.4.3/../../../../arm-eabi/lib/ds_arm9_crt0.o: In function `CIDLoop':
<br/>
(.init+0x210): undefined reference to `initSystem'
<br/>
/opt/devkitpro/devkitARM/lib/gcc/arm-eabi/4.4.3/../../../../arm-eabi/lib/ds_arm9_crt0.o: In function `CIDLoop':
<br/>
(.init+0x21c): undefined reference to `__libnds_exit'
<br/>
collect2: ld returned 1 exit status
<br/>
configure:2944: $? = 1
<br/>
configure:2982: result: no
<br/>
configure: failed program was:
<br/>
| /* confdefs.h */
<br/>
| #define PACKAGE_NAME "libpogo"
<br/>
| #define PACKAGE_TARNAME "libpogo"
<br/>
| #define PACKAGE_VERSION "2.0"
<br/>
| #define PACKAGE_STRING "libpogo 2.0"
<br/>
| #define PACKAGE_BUGREPORT "jonas@nightmode.org"
<br/>
| #define PACKAGE_URL ""
<br/>
| #define PACKAGE "libpogo"
<br/>
| #define VERSION "2.0"
<br/>
| /* end confdefs.h.  */
<br/>
|
<br/>
| int
<br/>
| main ()
<br/>
| {
<br/>
|
<br/>
|   ;
<br/>
|   return 0;
<br/>
| }
<br/>
configure:2987: error: in `/home/stuart/svn/pogo2/libpogo':
<br/>
configure:2991: error: C compiler cannot create executables
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It seems to make the the compiler arm-eabi-gcc doesn't seem to like a lot of the arguments passed to it (and delegates all the real work to gcc anyway???) If anyone can offer any advice on what to try next it would be greatly appreciated!
<br/>
<br/>
Stuart</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173956 - Dwedit - Mon May 10, 2010 1:37 am</h4>
    <div class="postbody"><span class="postbody">Is this that code from Pogoshell that does bankswitching on the various different flash cartridges?
<br/>
<br/>
I bet it would need some changes to go from the GBA to the NDS.
<br/>
<br/>
Kuwanger seems to have taken over Pogoshell, so maybe direct some questions towards him.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173958 - JackUzi - Mon May 10, 2010 1:55 am</h4>
    <div class="postbody"><span class="postbody">Thanks for the suggestion, but it appears the PogoShell may be unrelated (or another app based on libpogo?). This is a site that talks a bit about GlkPogo, which seems to use libpogo for screen display and input: <a href="http://www.qj.net/qjnet/nintendo-ds/text-adventures-on-the-ds-glk-pogo-v10.html" target="_blank">http://www.qj.net/qjnet/nintendo-ds/text-adventures-on-the-ds-glk-pogo-v10.html</a>
<br/>
<br/>
It also seems to me that the errors are more relating to my configure options  than the libpogo code itself. It seems the the app itself looks for the NDS platform target, and I have experimented with no --build or a build of something like i486-linux-gnu, but still without luck. 
<br/>
<br/>
If I use:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
./configure --host=arm-eabi --prefix=/opt/devkitpro/devkitARM/
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
./configure runs to completion but then make fails with:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
mv -f .deps/libpogo_a-memory.Tpo .deps/libpogo_a-memory.Po
<br/>
arm-eabi-gcc -DHAVE_CONFIG_H -I. -I..  -O2 -DPLATFORM=PC -I../include -DLIBPOGO  -DUSE_SDL -I/usr/include/SDL -D_GNU_SOURCE=1 -D_REENTRANT    -MT libpogo_a-device.o -MD -MP -MF .deps/libpogo_a-device.Tpo -c -o libpogo_a-device.o `test -f 'device.c' || echo './'`device.c
<br/>
In file included from /usr/include/SDL/SDL_main.h:26,
<br/>
                 from /usr/include/SDL/SDL.h:30,
<br/>
                 from device.c:90:
<br/>
/usr/include/SDL/SDL_stdinc.h:63:22: error: strings.h: No such file or directory
<br/>
In file included from /usr/include/SDL/SDL_main.h:26,
<br/>
                 from /usr/include/SDL/SDL.h:30,
<br/>
                 from device.c:90:
<br/>
/usr/include/SDL/SDL_stdinc.h:151: error: size of array 'SDL_dummy_enum' is negative
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It seems that --enable-platform=NDS prevents the use of SDL, but with that option ./configure fails with this error again:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
configure:2940: arm-eabi-gcc  -mthumb-interwork -specs=ds_arm9.specs   conftest.c  &gt;&amp;5
<br/>
/opt/devkitpro/devkitARM/lib/gcc/arm-eabi/4.4.3/../../../../arm-eabi/lib/ds_arm9_crt0.o: In function `CIDLoop':
<br/>
(.init+0x1c0): undefined reference to `__libnds_mpu_setup'
<br/>
/opt/devkitpro/devkitARM/lib/gcc/arm-eabi/4.4.3/../../../../arm-eabi/lib/ds_arm9_crt0.o: In function `CIDLoop':
<br/>
(.init+0x210): undefined reference to `initSystem'
<br/>
/opt/devkitpro/devkitARM/lib/gcc/arm-eabi/4.4.3/../../../../arm-eabi/lib/ds_arm9_crt0.o: In function `CIDLoop':
<br/>
(.init+0x21c): undefined reference to `__libnds_exit'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Seems like a bit of a catch 22 at the moment... :(
<br/>
<br/>
Stuart</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173964 - JackUzi - Mon May 10, 2010 8:18 am</h4>
    <div class="postbody"><span class="postbody">As a bit of an update, the configure seems to work now that I use this configure line:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
./configure --enable-platform=NDS --host=arm-eabi --prefix=/opt/devkitpro/devkitARM/
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
with these two environment variable set:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
export LIBS=-lnds9
<br/>
export LDFLAGS=-L/opt/devkitpro/libnds/lib
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Trying to make the library itself now fails with:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
make  all-recursive
<br/>
make[1]: Entering directory `/home/stuart/svn/pogo2/libpogo'
<br/>
Making all in src
<br/>
make[2]: Entering directory `/home/stuart/svn/pogo2/libpogo/src'
<br/>
arm-eabi-gcc -DHAVE_CONFIG_H -I. -I..  -O2 -DPLATFORM=NDS -I../include -DLIBPOGO -mcpu=arm9tdmi -mtune=arm9tdmi -mthumb-interwork -fomit-frame-pointer -ffast-math -I../../libnds/include -DARM9     -MT libpogo_a-key_ds.o -MD -MP -MF .deps/libpogo_a-key_ds.Tpo -c -o libpogo_a-key_ds.o `test -f 'key_ds.c' || echo './'`key_ds.c
<br/>
key_ds.c:1:17: error: nds.h: No such file or directory
<br/>
key_ds.c: In function 'key_update':
<br/>
key_ds.c:42: error: 'REG_IF' undeclared (first use in this function)
<br/>
key_ds.c:42: error: (Each undeclared identifier is reported only once
<br/>
key_ds.c:42: error: for each function it appears in.)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm not to confident in '-I../../libnds/include' so I'll start looking for a way to specify a full path, but as always, and hints greatly appreciated...
<br/>
<br/>
Stuart</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173971 - JackUzi - Mon May 10, 2010 12:32 pm</h4>
    <div class="postbody"><span class="postbody">Okay, so excuse me turning this thread more of a blog than a discussion, but I have been making progress...
<br/>
<br/>
Only now I'm truly stuck. I get the impression that perhaps this code is just starting to show it's age and isn't 100% compatible with the current version of libnds and devkitARM. I've managed to tweak a few things here and there and get many of the modules compiling now, but the button input stuff just doesn't seem to be done the way things need to be these days.
<br/>
<br/>
It makes references to IPC-&gt;buttons and IPC-&gt;touchXpx which I can't find defined in any of the current header files.
<br/>
<br/>
Can anyone confirm that there is a new way of reading input?
<br/>
<br/>
Stuart</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173972 - sverx - Mon May 10, 2010 2:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>JackUzi wrote:</b></span></td> </tr> <tr> <td class="quote">Can anyone confirm that there is a new way of reading input?</td> </tr></table><span class="postbody">
<br/>
<br/>
I confirm.
<br/>
<a href="http://libnds.devkitpro.org/a00081.html" target="_blank">http://libnds.devkitpro.org/a00081.html</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
