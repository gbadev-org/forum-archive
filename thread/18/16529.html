<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Running Code from VRAM? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Running Code from VRAM?</h2>
<div id="posts">
<div class="post">
    <h4>#167391 - hacker013 - Tue Mar 10, 2009 7:24 pm</h4>
    <div class="postbody"><span class="postbody">Hey everybody,
<br/>
<br/>
Is it possible to run code from vram? If yes, how will that work? Just copy the code to vram and execute it?
<br/>
<br/>
gr,
<br/>
<br/>
newbie013<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167398 - Dwedit - Tue Mar 10, 2009 8:19 pm</h4>
    <div class="postbody"><span class="postbody">Might have to modify the cache settings to get it to perform decently, I don't think it caches VRAM by default.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167416 - hacker013 - Wed Mar 11, 2009 8:07 am</h4>
    <div class="postbody"><span class="postbody">How do you mean?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167419 - Dwedit - Wed Mar 11, 2009 9:04 am</h4>
    <div class="postbody"><span class="postbody">The memory protection unit is configured so that the IO registers and VRAM both share cacheability settings.  When you jump to VRAM, by default, it is not cached.  This would slow down code running from there.
<br/>
<br/>
Assuming you are using the standard devkitpro crt0.s file, to turn on the instruction cache for the "VRAM + IO PORTS + PALETTE + OAM" region, use this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
    ldr    r0,=0b01000011
<br/>
    mcr    p15, 0, r0, c2, c0, 1
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If you don't use the cache, fetching instructions is 10 times slower.
<br/>
<br/>
<br/>
If you are trying to run code from the ARM7, there is no cache for that processor, and the CPU can fetch instructions efficiently.  Only thing about VRAM is that it is 16-bit instead of 32-bit, so fetching an instruction takes 2 cycles instead of 1.  THUMB code takes 1 cycle to fetch the instruction.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167425 - hacker013 - Wed Mar 11, 2009 6:14 pm</h4>
    <div class="postbody"><span class="postbody">@Dwedit
<br/>
I can't find where I must add those 2 lines. Can I just use fread to read it directly to vram or must I use an another way?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167426 - elhobbs - Wed Mar 11, 2009 6:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">Can I just use fread to read it directly to vram or must I use an another way?</td> </tr></table><span class="postbody">fread what to vram?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167427 - hacker013 - Wed Mar 11, 2009 6:44 pm</h4>
    <div class="postbody"><span class="postbody">The kernel made by Mighty Max and updated now by me oO. I'm trying to get it run from vram because it can't fit in siwram because the kernel is now compiled 128kb (damn libfat) and siwram is only 32kb.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167428 - DiscoStew - Wed Mar 11, 2009 6:45 pm</h4>
    <div class="postbody"><span class="postbody">I believe hacker013 wants to copy compiled code from a file (with fread) into VRAM so it can be executed there, yet it just isn't that simple, is it? I'm pretty sure there is much more work to pull that off.
<br/>
<br/>
Also hacker013, the code Dwedit posted only makes those areas cacheable, so should you have code executed from one of those spots with it set as such, it will run faster.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167429 - hacker013 - Wed Mar 11, 2009 6:50 pm</h4>
    <div class="postbody"><span class="postbody">I don't know where to put thos 2 lines in the crt0.s file?
<br/>
<br/>
And also I have this code (modified loader from the original to get it run :) only it doesn't work.) :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/* ndslib includes */
<br/>
#include &lt;nds.h&gt;
<br/>
#include &lt;fat.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
#include "service.h"
<br/>
<br/>
<br/>
/* loader just loads .knl into siwram (0x03000000) */
<br/>
<br/>
int main(int argc,char **argv) {
<br/>
   REG_EXMEMCNT = 0xE800 ;
<br/>
   
<br/>
   /* set power to all devices, make mainscreen the lower */
<br/>
   powerOn(POWER_ALL_2D) ;
<br/>
   powerOff(POWER_SWAP_LCDS) ;
<br/>
    //vramSetMainBanks(   VRAM_A_MAIN_BG_0x06000000,       
<br/>
    //                    VRAM_B_MAIN_BG_0x06020000,      
<br/>
    //                    VRAM_C_LCD,  
<br/>
    //                    VRAM_D_MAIN_BG_0x06040000   
<br/>
    //                    );    
<br/>
                  
<br/>
   //set the video mode
<br/>
    //videoSetMode(  MODE_0_2D | DISPLAY_BG0_ACTIVE );
<br/>
   // black backdrop
<br/>
   //BG_PALETTE[0]=RGB15(0,0,0);
<br/>
   //BG0_CR = BG_MAP_BASE(31);
<br/>
   //BG_PALETTE[255] = RGB15(31,31,31);
<br/>
   // set up debug output 
<br/>
   //consoleInitDefault((u16*)SCREEN_BASE_BLOCK(31), (u16*)CHAR_BASE_BLOCK(0), 16);
<br/>
   consoleDemoInit();
<br/>
   iprintf("Loading kernel ...\n") ;
<br/>
<br/>
   /* fat filesystem */
<br/>
   //bool fat = FAT_InitFiles() ;   
<br/>
   bool fat = fatInitDefault();
<br/>
   if (fat) {
<br/>
      iprintf("  filesystem init\n") ;
<br/>
   } else {
<br/>
      iprintf("  filesystem failed\n") ;
<br/>
   } ;
<br/>
   
<br/>
<br/>
   iprintf("  protection base\n") ;
<br/>
<br/>
      MPU_WriteProtectionBase0(0x0000003F) ;               /* highest priority, access for the system mode to all addresses */
<br/>
      MPU_WriteDataPermissions(0x33333333) ;
<br/>
      MPU_WriteCodePermissions(0x33333333) ;
<br/>
<br/>
   //*(volatile unsigned char *)0x04000247 = 0 ;      // 32kB to arm9, 0kB to arm7
<br/>
   //iprintf("  siwram set\n") ;
<br/>
   
<br/>
   //*(volatile unsigned char *)0x03000000 = 0x12   ;   // access test
<br/>
   //if (*(volatile unsigned char *)0x03000000 != 0x12) {
<br/>
   //   iprintf("  siwram not accessible\n") ;
<br/>
   //   while(1) ;
<br/>
   //} ;
<br/>
   //iprintf("  siwram test\n") ;
<br/>
   
<br/>
   iprintf("  prepaire vram\n");
<br/>
   vramSetBankA(VRAM_A_LCD);
<br/>
   vramSetBankB(VRAM_B_LCD);
<br/>
   
<br/>
   size_t knlSize = 0;
<br/>
   FILE *knl = fopen("NDSOS.knl","rb") ;
<br/>
   if (!knl) {
<br/>
      iprintf("  kernel missing\n") ;
<br/>
      while(1) ;
<br/>
   } ;
<br/>
   // Read File Size 
<br/>
   fseek (knl, 0, SEEK_END);
<br/>
   knlSize = ftell(knl);
<br/>
   if(knlSize==0)
<br/>
   {
<br/>
      fclose(knl);
<br/>
      iprintf("   kernel size=0! - Halted\n");
<br/>
      while(1);
<br/>
   }
<br/>
   //Malloc a tempory buffer
<br/>
   void *buffer = malloc(knlSize);
<br/>
   //Read the kernel from fat
<br/>
   fseek (knl, 0, SEEK_SET);
<br/>
   //unsigned long cnt = fread((void *)0x03000000,1,32*1024,knl) ;
<br/>
   unsigned long cnt = fread(buffer,1,knlSize,knl) ;
<br/>
   
<br/>
   if (cnt==0) {
<br/>
      fclose(knl);
<br/>
      iprintf("  kernel size=0! - Halted\n") ;
<br/>
      while(1) ;
<br/>
   } ;
<br/>
   //Copy kernel to vram
<br/>
   dmaCopyAsynch(buffer,(void *)0x06000000,knlSize);
<br/>
   
<br/>
   fclose(knl) ;
<br/>
   
<br/>
   iprintf("  loaded %ld bytes\n",cnt) ;
<br/>
   
<br/>
   typedef void (*siwram_type)(void) ;
<br/>
   /* main() */
<br/>
   /* jumping just before crt0 would jump */
<br/>
   //siwram_type siwram = (siwram_type)0x03000138 ; 
<br/>
   siwram_type siwram = (siwram_type)0x06000138;
<br/>
   iprintf("  executing\n") ;
<br/>
   //Run kernel
<br/>
   siwram() ;
<br/>
   iprintf("  hmm?\n") ;
<br/>
<br/>
   return 0 ;
<br/>
} ;</td> </tr></table><span class="postbody">
<br/>
<br/>
Can you see what i'm doing wrong?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167430 - elhobbs - Wed Mar 11, 2009 8:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DiscoStew wrote:</b></span></td> </tr> <tr> <td class="quote">I believe hacker013 wants to copy compiled code from a file (with fread) into VRAM so it can be executed there, yet it just isn't that simple, is it? I'm pretty sure there is much more work to pull that off.
<br/>
<br/>
Also hacker013, the code Dwedit posted only makes those areas cacheable, so should you have code executed from one of those spots with it set as such, it will run faster.</td> </tr></table><span class="postbody">I was being intentionally obtuse in order to match the vague request.
<br/>
<br/>
yes, there is probably more that needs to be done. the knl file is probably compiled to run at a fixed address which will need to be changed. also, any 8bit writes to the data section of the kernel will fail when it is in vram (there may not be any though).
<br/>
<br/>
Is this purely an academic exercise? I do not really see any use for this - dslinux has this segment taken care of quite well.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167449 - hacker013 - Thu Mar 12, 2009 2:21 pm</h4>
    <div class="postbody"><span class="postbody">I'm building this because the game i'm making needs some structure to run on. Because I don't want to include in the game things like multithreading and Virtual Memory. This way also other people can use it. If I got it finished. I'm not doing this for school. I'm doing this for my hobby.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167451 - Lazy1 - Thu Mar 12, 2009 3:27 pm</h4>
    <div class="postbody"><span class="postbody">I'm not sure why any game would want to execute code from vram.
<br/>
<br/>
If I were making a game, what I would do is write it on the PC first using a good library like SDL and port it over later.
<br/>
That way you don't need to worry about such things until you are ready to port your code.
<br/>
<br/>
Quake runs fine with the limited DS hardware, if your game requires code to be squeezed into vram then something isn't right.
<br/>
Games do not need their own kernel (at least not usually I would think).
<br/>
<br/>
Although I admit writing a mini OS sounds fun it's not something I personally would jump into without doing a ton of reading first.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167453 - hacker013 - Thu Mar 12, 2009 4:26 pm</h4>
    <div class="postbody"><span class="postbody">I'm want to use vram to run the kernel from because i'm using the basic kernel from mighty max and that one runs from siwram and uses the total main ram for virtual memory. But if I compile it is now with the current devkitARM + libs 128 kb :( (damn libfat).<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167454 - Lazy1 - Thu Mar 12, 2009 4:30 pm</h4>
    <div class="postbody"><span class="postbody">I have to ask though, why do you need virtual memory?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167455 - Mighty Max - Thu Mar 12, 2009 4:46 pm</h4>
    <div class="postbody"><span class="postbody">I would advise to NOT use it other then as the PoC it is.
<br/>
<br/>
It was never intended as a working base but to show that it's possible.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167476 - hacker013 - Fri Mar 13, 2009 11:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lazy1 wrote:</b></span></td> </tr> <tr> <td class="quote">I have to ask though, why do you need virtual memory?</td> </tr></table><span class="postbody">
<br/>
<br/>
My game needs much of ram and I haven't a slot2 expansionpack :(<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167478 - Dwedit - Fri Mar 13, 2009 3:48 pm</h4>
    <div class="postbody"><span class="postbody">LOL OVERLAYS<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167479 - Miked0801 - Fri Mar 13, 2009 4:08 pm</h4>
    <div class="postbody"><span class="postbody">:)
<br/>
<br/>
typedef bool int;
<br/>
static bool stateArray[1024*256];</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167480 - Lazy1 - Fri Mar 13, 2009 4:32 pm</h4>
    <div class="postbody"><span class="postbody">Like I said, Quake fits in the DS's limited memory.
<br/>
If a homebrew project is overrunning those limits it's time to rethink a few things.
<br/>
<br/>
Worry about designing your project first and the porting details later.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167486 - hacker013 - Fri Mar 13, 2009 7:13 pm</h4>
    <div class="postbody"><span class="postbody">I wanna make it nds only -_-<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167488 - Lazy1 - Fri Mar 13, 2009 7:44 pm</h4>
    <div class="postbody"><span class="postbody">No one said you couldn't make it nds only, the idea is that on the PC you have access to debuggers, profilers and a much faster development/testing cycle.
<br/>
For starting a NEW game from scratch it would be so much easier to start on the PC and port it over when it's ready.
<br/>
<br/>
A cheap example would be my port of wolf3d, I did 99% of the screen conversion (320x200-&gt;256x192) on the PC using the SDL code that it originally came with.
<br/>
Since all the menus/ect were hard coded it would have taken AGES to test since I'd have to rebuild and put it on hardware to test whereas ./wolf3d was so much easier and faster.
<br/>
Plus the debugger was there when I needed it, unlike on hardware where there are no debuggers*.
<br/>
<br/>
*Not 100% sure if this is still true</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167489 - DiscoStew - Fri Mar 13, 2009 10:28 pm</h4>
    <div class="postbody"><span class="postbody">With Quake 1, it was optimized to work with just the 4MB on the DS, and the original required at least 16MB of RAM on the PC, I think. Besides, virtual memory is freaking slow.
<br/>
<br/>
What exactly is requiring more than 4MB of main RAM?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">:)
<br/>
<br/>
typedef bool int;
<br/>
static bool stateArray[1024*256];</td> </tr></table><span class="postbody">
<br/>
<br/>
And yet, for every byte used for a boolean value, it can have 8 separated values. So, an array of 1024 ints can actually carry 32768 separate boolean values. It's a good way to condense memory usage if large bool arrays are being used. It just requires a little more processing to input/retrieve.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167493 - Miked0801 - Sat Mar 14, 2009 4:31 am</h4>
    <div class="postbody"><span class="postbody">You missed the point Disco.  The array of u32 bools was a response to the OP not having enough RAM for his game.  PC Development has code like that all the time.  Wasting 97% of your memory without knowing it is all too common.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167495 - DiscoStew - Sat Mar 14, 2009 9:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">You missed the point Disco.  The array of u32 bools was a response to the OP not having enough RAM for his game.  PC Development has code like that all the time.  Wasting 97% of your memory without knowing it is all too common.</td> </tr></table><span class="postbody">
<br/>
<br/>
So THAT'S why Windows keeps crashing!   :P
<br/>
<br/>
But seriously, that never crossed my mind that memory could be wasted in such a fashion, and that often too. Maybe people should go back to working with 286s and older computer models, and learn to deal with limited resources.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167497 - hacker013 - Sat Mar 14, 2009 7:07 pm</h4>
    <div class="postbody"><span class="postbody">Let's say I write it first for the pc. It is a 3d game so I will use then a decent 3d engine like orge3D. When I finish that I will port it over to the nds. Then comes a question like how in gods name would I port the total orge3D to the nds. Or let' say I use a dll, then I have to write a dll system because the nds hasn't one :( So what you guys telling me is a little to much work, don't you think?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167498 - bean_xp - Sat Mar 14, 2009 7:44 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">Let's say I write it first for the pc. It is a 3d game so I will use then a decent 3d engine like orge3D. When I finish that I will port it over to the nds. Then comes a question like how in gods name would I port the total orge3D to the nds. Or let' say I use a dll, then I have to write a dll system because the nds hasn't one :( So what you guys telling me is a little to much work, don't you think?</td> </tr></table><span class="postbody">
<br/>
<br/>
No this wouldn't work at all, you couldn't get a .dll system working on the DS for these purposes. The .dll is compiled for intel processors, so you would recompile the library to run on DS. Also the graphics capabilities of the DS are not even similar to PC graphics cards. You would be far better off using some simple openGL commands for your 3D on PC, most of which are available and offer similar functionality in libnds.
<br/>
<br/>
I also don't see exactly what you need the extra memory for on DS, what exactly are you planning to use it for?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167499 - DiscoStew - Sat Mar 14, 2009 8:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">Let's say I write it first for the pc. It is a 3d game so I will use then a decent 3d engine like orge3D.</td> </tr></table><span class="postbody">
<br/>
<br/>
Stop. Just stop. You are the programmer for your NDS projects. If you can't port something over to the NDS, then don't use it in your PC version. One of the exceptions to use is OpenGL, because much of the functionality that the NDS is capable of has been wrapped up into similar functions in libnds. But with that, you don't port over OpenGL. You just make sure that the functions you use are ones that are available in libnds.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167500 - Kath - Sat Mar 14, 2009 8:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">Let's say I write it first for the pc. It is a 3d game so I will use then a decent 3d engine like orge3D. When I finish that I will port it over to the nds. Then comes a question like how in gods name would I port the total orge3D to the nds. Or let' say I use a dll, then I have to write a dll system because the nds hasn't one :( So what you guys telling me is a little to much work, don't you think?</td> </tr></table><span class="postbody">
<br/>
<br/>
Just write it for PC using intermediate mode OpenGL (glVertex(...) etc.), it is simple enough to port and you can have a running "fake DS" on Windows in under a day. My game code is exactly the same between the PC and DS versions. Even my world/scene classes are the same. The only things rewritten are the renderer, startup, touch (mouse) and the resource loading/unloading code.
<br/>
<br/>
How are you running out of memory anyway? I have an RTS game in ortho 3d and even with a complex scene stuffed inside STL containers I'm never using more than 120k. You'll need to more specific about what you want to achieve.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167501 - DiscoStew - Sat Mar 14, 2009 8:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kath wrote:</b></span></td> </tr> <tr> <td class="quote">Just write it for PC using intermediate mode OpenGL (glVertex(...) etc.), it is simple enough to port and you can have a running "fake DS" on Windows in under a day.</td> </tr></table><span class="postbody">
<br/>
<br/>
This.
<br/>
<br/>
If you are planning to have this be for just the NDS, then set up a PC application with only the basics needed (no fancy stuff) so that it would act like you were running your program under an emulator. The difference would be that it is an actual PC application, which you can test and debug much faster and easier imo. Once it is far enough along, you port it over to the NDS, and make corrections from there.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167502 - hacker013 - Sat Mar 14, 2009 9:14 pm</h4>
    <div class="postbody"><span class="postbody">But aren't there nds debuggers out?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167503 - Miked0801 - Sun Mar 15, 2009 12:20 am</h4>
    <div class="postbody"><span class="postbody">Sure, I use one every day.  Of course I work for a professional game development company that supplies me with the 20k dev system:)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167541 - hacker013 - Tue Mar 17, 2009 8:23 pm</h4>
    <div class="postbody"><span class="postbody">Are there also free debuggers?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167542 - elhobbs - Tue Mar 17, 2009 8:57 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://desmume.org" target="_blank">desmume</a> and insight/gdb work quite well for me. desmume needs to be re-compiled with the gdb stub turned on though - the downloadable binaries do not have this functionality enabled.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167547 - albinofrenchy - Wed Mar 18, 2009 1:47 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://forums.desmume.org/viewtopic.php?id=85" target="_blank">Old binaries do exist.</a>
<br/>
<br/>
They work well enough. The only problem is is that that version will gleefully write protected memory and not core dump when the real thing would.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167558 - hacker013 - Wed Mar 18, 2009 3:01 pm</h4>
    <div class="postbody"><span class="postbody">thx :) I was more thinking to buy no$gba debugger :) but I will try first desmume.
<br/>
<br/>
@mighty max, is it possible to use that part of virtual memory (mem.c + mem.h + mem.swp) as a library in my game oO ? Or have I to modified it first?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167559 - elhobbs - Wed Mar 18, 2009 4:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">thx :) I was more thinking to buy no$gba debugger :) but I will try first desmume.</td> </tr></table><span class="postbody">no$gba is no longer for sale.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">@mighty max, is it possible to use that part of virtual memory (mem.c + mem.h + mem.swp) as a library in my game oO ? Or have I to modified it first?</td> </tr></table><span class="postbody">even though it makes zero sense to use it in a game? and the person who wrote it advises you not to use it? Just out of curiousity: why do you think you need something like this for your game? you would be better served by implementing a cache manager that fits in the memory available to the ds.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167560 - hacker013 - Wed Mar 18, 2009 4:38 pm</h4>
    <div class="postbody"><span class="postbody">Because i'm building a zelda OoT clone. And it needs more then 4mb memory and I haven't a slot2 ram expansion. So I don't wanna use that.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167561 - DiscoStew - Wed Mar 18, 2009 5:17 pm</h4>
    <div class="postbody"><span class="postbody">If I'm not mistaken, the N64 only had 4MB of RAM (excluding the upgrade that came with DK64), and I'm sure OoT didn't use all that memory.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167562 - hacker013 - Wed Mar 18, 2009 6:14 pm</h4>
    <div class="postbody"><span class="postbody">I don't know that for sure but I know de n64 had support for memory extensions like used with zelda MM.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167563 - Mighty Max - Wed Mar 18, 2009 6:16 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">Because i'm building a zelda OoT clone. And it needs more then 4mb memory and I haven't a slot2 ram expansion. So I don't wanna use that.</td> </tr></table><span class="postbody">
<br/>
<br/>
You should not get near to that limit. 
<br/>
Seperate the data from your program (DLDI/EFS it). The data and code needed at any random point in the game should fit with ease.
<br/>
Only if you'd load every data into RAM all the time you should run into problems.
<br/>
<br/>
It's not that the levels or gamestate are very complex ... (iir that game correctly)
<br/>
<br/>
This will not only save you a lot of trouble with a instable code (which that PoC is) but also forces you to make the code and data much more modular which in return extremely fastens the development (reuse of techniques, straight design, easier to read/trace) once the basics are done.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167566 - elhobbs - Wed Mar 18, 2009 6:24 pm</h4>
    <div class="postbody"><span class="postbody">I am not sure if you know this but all of the assets for the entire game do not need to be loaded into the 4MB on the DS at the same time. you could have 200MB or more of total assets for the game. You only need to load stuff into memory as it is needed.
<br/>
<br/>
a swap file will not only drain your battery faster it will also destroy your storage card (sd , micro sd, cflash, etc.) pretty fast too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167567 - Miked0801 - Wed Mar 18, 2009 6:29 pm</h4>
    <div class="postbody"><span class="postbody">How much of your clone is currently build hacker?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167571 - Dwedit - Wed Mar 18, 2009 7:11 pm</h4>
    <div class="postbody"><span class="postbody">In Ocarina of time, it only loads the visuals for rooms that are currently visible.  If you manage to leave the bounds of a room, you can still visit other rooms, but they won't draw, so you will walk against invisible walls.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167574 - hacker013 - Wed Mar 18, 2009 7:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">How much of your clone is currently build hacker?</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm still setting up de basic engine for the menu -_- because nitro engine has many wierd bugs (not showing images and other stuff like that). Maybe you guys can recommend me a other 3d engine with 2d drawing support. I was first thinking that engine used to much ram (so that is the reason I started this topic). But now with the newest libnds the engine doesn't work correctly anymore (Screen screwed up) :'(<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167578 - Emmanuel - Wed Mar 18, 2009 9:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote"> Maybe you guys can recommend me a other 3d engine with 2d drawing support.</td> </tr></table><span class="postbody">
<br/>
Maybe make your own... or try to contribute to improve an existing one...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167587 - Echo49 - Thu Mar 19, 2009 7:36 am</h4>
    <div class="postbody"><span class="postbody">If you're looking into something as (complicated) as running code from VRAM and page files and what not, why not just make your own engine?
<br/>
<br/>
Seriously, it's not that hard to create a wrapper around the 3D functions and make it display 2D. It only took me a few days to make one geared specifically for my game.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167588 - elwing - Thu Mar 19, 2009 8:13 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">I don't know that for sure but I know de n64 had support for memory extensions like used with zelda MM.</td> </tr></table><span class="postbody">
<br/>
<br/>
yes, the N64 support a 4Mb memory extension, however it is <span style="text-decoration: underline">not</span> needed for OoT, majora's mask need it trough... so the original OoT was also running on only 4Mb...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
