<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Transparent Textures - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Transparent Textures</h2>
<div id="posts">
<div class="post">
    <h4>#83170 - Zed0 - Sat May 13, 2006 5:32 pm</h4>
    <div class="postbody"><span class="postbody">Hi there,
<br/>
I'm fairly new here (well I've been lurking a while, but only just got the equipment for homebrew) so I was wondering if you would mind helping me out.
<br/>
Basically I am looking to make textures with transparency (Alpha or palette is good). So far the only way I have found that works is in the demo that came with devkitPro called "Paletted_Cube" which uses two bin files (.tex and .pal converted I think) but I have no idea how to:
<br/>
A: get texture that gives a .tex and .pal file
<br/>
B: convert them to .bin (all the converters I've seen transform from .bmp, .jpg, .png etc).
<br/>
Having had a search around I found the below post <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=8644" target="_blank">here</a> and was wondering if anyone oculd enlighten me as to the "4 lines of code" or point me in the direction of a more efficient way of making transparent textures.
<br/>
<br/>
Any help is appreciated
<br/>
Zed0
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>dovoto wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peyj wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I'd like to know how to create a binary file of an image.
<br/>
I see in the ndsLib example that they load a binary image with his palette. How can we creat such file ?
<br/>
<br/>
thanks
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I just exported it to raw from jasc and made my own 4 lines of code converter for tha demo. I recomend you grab gfx2gba from <a href="http://www.gbadev.org" target="_blank">www.gbadev.org</a> tools.
<br/>
<br/>
Or libnds has functions for directly loading an 8 bit pcx file. You can use this to load in graphics but i dont remember if i stuck in code to put the graphics into tile form as i was mainly using it for textures at the time.
<br/>
</span></td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#83241 - Sausage Boy - Sun May 14, 2006 11:33 am</h4>
    <div class="postbody"><span class="postbody">I'm currently writing an exporter for The Gimp which is supposed to have support for all the documented DS textures. You either wait for that (or some other tool) or write your own, information on the texture formats can be found at <a href="http://dualis.1emulation.com/dsti.html#lcdioteximgparam" target="_blank">http://dualis.1emulation.com/dsti.html#lcdioteximgparam</a>
<br/>
<br/>
I'd also assume that the person who wrote paletted cube has some sort of converter as well, WinterMute might be able to help you with this.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85095 - lazmike - Sat May 27, 2006 12:50 am</h4>
    <div class="postbody"><span class="postbody">As far as I know, the only way to achieve a transparent texture is to change the polyfmt for the polys that have that texture.  only polys with a different poly alpha ID will blend together, either on or off.  Someone please correct me if there is a way for variable polygon alpha.<br/>_________________<br/>-laZmike-
<br/>
<a href="http://lazmike.nintendev.com" target="_blank">http://lazmike.nintendev.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85184 - Sausage Boy - Sat May 27, 2006 6:19 pm</h4>
    <div class="postbody"><span class="postbody">The DS has 7 texture modes. mode 1-4 and 6 are paletted, 5 is compressed and not documented yet, 7 is direct color.
<br/>
<br/>
In all the paletted mode, color 0 can be used for transparency if you pass the correct option in your program.
<br/>
<br/>
Mode 1 and 6 can be semi transparent, mode 1 has 32 colors and 8 alpha values, mode 6 has 8 colors and 32 alpha values.
<br/>
<br/>
You can choose which mode you want to use seperately on all the textures you use.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85193 - Valmond - Sat May 27, 2006 8:05 pm</h4>
    <div class="postbody"><span class="postbody">Don't know if this is what you are looking for, but I just
<br/>
change the .bmp (or whatever I want to load) to .bin
<br/>
This is handled by the makefile in some examples coming
<br/>
with devkitPro so afterwards you just "include" the file in
<br/>
the program :
<br/>
<br/>
test.bmp -&gt; renamed to test.bin
<br/>
then :
<br/>
#include "test_bin.h"
<br/>
<br/>
and access the data with this var :
<br/>
<br/>
test_bin
<br/>
<br/>
<br/>
HTH
<br/>
<br/>
/Valmond</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85206 - tepples - Sat May 27, 2006 9:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sausage Boy wrote:</b></span></td> </tr> <tr> <td class="quote">The DS has 7 texture modes. mode 1-4 and 6 are paletted, 5 is compressed and not documented yet</td> </tr></table><span class="postbody">
<br/>
I seem to remember that the DS uses something like S3 texture compression, which in turn is based on RPZA video compression. Each 4x4 block of pixels has a 16-bit low color, a 16-bit high color, and then 2 bits per pixel where one value is fully low, one is high, and the others are either intermediate values or one intermediate and one transparent.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85215 - Sausage Boy - Sat May 27, 2006 9:55 pm</h4>
    <div class="postbody"><span class="postbody">Would you mind coding a compressor? ;)<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85269 - loading - Sun May 28, 2006 10:39 am</h4>
    <div class="postbody"><span class="postbody">well i can do decoding (without alpha but that should not be hard to add)
<br/>
<br/>
basicly there are 3 files one contayning palette one containing tileid-&gt;pal information and on containing the actual compressed data. It is like yes i's similar to s3tc:
<br/>
<br/>
this is from my software decoder probably not perfect but working
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
u32 Derive4x4(u32 c0, u32 c1, int a0, int a1)
<br/>
{
<br/>
   u8 d1 = (a0*(c0&amp;0xff) + a1*(c1&amp;0xff))/6;
<br/>
   u8 d2 = (a0*((c0&gt;&gt;8)&amp;0xff) + a1*((c1&gt;&gt;8)&amp;0xff))/6;
<br/>
   u8 d3 = (a0*((c0&gt;&gt;16)&amp;0xff) + a1*((c1&gt;&gt;16)&amp;0xff))/6;
<br/>
<br/>
   return (d3&lt;&lt;16)|(d2&lt;&lt;8)|(d1);
<br/>
}
<br/>
<br/>
void CreateNTF4x4(u8 data[], u16 pal[], u16 cdata[],int cols, int rows)
<br/>
{
<br/>
   ResetImage(cols*8, rows*8,TYPERGBA);
<br/>
   u32 *dat = (u32*) data;
<br/>
<br/>
   u32 c[4];
<br/>
   u16 tileid;   
<br/>
   
<br/>
   for(int m=0; m&lt;rows*2; m++)
<br/>
      for(int p=0; p&lt;cols*2; p++)
<br/>
      {
<br/>
         // colorcode start
<br/>
         tileid=((*cdata++)&amp;0x3FF)*2;
<br/>
         
<br/>
         c[0]=(((pal[tileid] &gt;&gt; 10) &amp; 0x1f) &lt;&lt;19) | (((pal[tileid] &gt;&gt; 5) &amp; 0x1F) &lt;&lt;11) | ((pal[tileid] &amp; 0x1F) &lt;&lt;3);
<br/>
         c[1]=(((pal[tileid+1] &gt;&gt; 10) &amp; 0x1f) &lt;&lt;19) | (((pal[tileid+1] &gt;&gt; 5) &amp; 0x1F) &lt;&lt;11) | ((pal[tileid+1] &amp; 0x1F) &lt;&lt;3);
<br/>
         c[2]=Derive4x4(c[0], c[1], 4, 2);
<br/>
         c[3]=Derive4x4(c[0], c[1], 2, 4);
<br/>
         
<br/>
         c[0]|=0xff000000;
<br/>
         c[1]|=0xff000000;
<br/>
         c[2]|=0xff000000;
<br/>
         c[3]|=0xff000000;
<br/>
<br/>
         u32 Pixels= *(dat++);
<br/>
         for(int j=0; j&lt;16; j++) 
<br/>
            SetPixelA(p*4-(j%4)+3,3-(j&gt;&gt;2)+m*4,c[(Pixels&gt;&gt;(30-(j*2)))&amp;0x3]);      
<br/>
      }   
<br/>
   
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
compressing will be quite complicated if you want good results</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87243 - Sausage Boy - Mon Jun 12, 2006 8:34 pm</h4>
    <div class="postbody"><span class="postbody">Ok, if I understand correctly, the palette consists of pairs of colors, with a maximum palette size of 1024 color pairs. Every square selects one pair. Is this correct?
<br/>
<br/>
So far so good, but I wonder where all this data is supposed to be copied on the ds? Isn't there only locations for texture data and palette? Perhaps the data and cdata is loaded from the same place?
<br/>
<br/>
I would be very thankful if you could clear things up for me. Aside from the separation of compressed data and color data, and the palettedness, this format seems very similar to s3tc dxt1, perhaps one could modify the output of such a converter to get one for the DS? I'll look into that.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87258 - loading - Mon Jun 12, 2006 10:31 pm</h4>
    <div class="postbody"><span class="postbody">yes modding s3tc textures -&gt; ds compressed will be more simple than writing an own encoder. all you'd need to do is separate the color and the block data. and so it seems to me at least the nds format does not care if the higher  color value or the lower one is first (which is different according to the s3tc spec)
<br/>
i don't know how to actually use compressed textures on ds tho :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87371 - parrot_ - Tue Jun 13, 2006 4:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Valmond wrote:</b></span></td> </tr> <tr> <td class="quote">Don't know if this is what you are looking for, but I just
<br/>
change the .bmp (or whatever I want to load) to .bin
<br/>
This is handled by the makefile in some examples coming
<br/>
with devkitPro so afterwards you just "include" the file in
<br/>
the program :
<br/>
<br/>
test.bmp -&gt; renamed to test.bin
<br/>
then :
<br/>
#include "test_bin.h"
<br/>
<br/>
and access the data with this var :
<br/>
<br/>
test_bin
<br/>
<br/>
<br/>
HTH
<br/>
<br/>
/Valmond</td> </tr></table><span class="postbody">
<br/>
<br/>
That only works with BMPs because the DS (AFAIK) supports BMP formatted images. Any other format shouldn't work.<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87415 - LiraNuna - Tue Jun 13, 2006 9:00 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>parrot_ wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
That only works with BMPs because the DS (AFAIK) supports BMP formatted images. Any other format shouldn't work.</td> </tr></table><span class="postbody">
<br/>
No it's not...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">but I just
<br/>
change the .bmp (or whatever I want to load) to .bin </td> </tr></table><span class="postbody">
<br/>
Dude, Are you sure you are coding for the DS?!
<br/>
<br/>
use gfx2gba...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87426 - sajiimori - Tue Jun 13, 2006 9:45 pm</h4>
    <div class="postbody"><span class="postbody">The confusion seems to be about the difference between the general concept of a bit-mapped image (sometimes called a "bitmap" for short) and the BMP file format designed by Microsoft.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87548 - Valmond - Wed Jun 14, 2006 1:00 pm</h4>
    <div class="postbody"><span class="postbody">To LiraLuna:
<br/>
<br/>
Yes I do, and thats the way the examples you get
<br/>
with devkitPro Include the data (whatever data
<br/>
you got) into the project.
<br/>
<br/>
And I still think that thats the right answer for the question B...
<br/>
<br/>
You didn't read it huh ;-)
<br/>
<br/>
<br/>
/Valmond
<br/>
ps. there are (obviusly) better ways to include resources, but thats not the question.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87582 - silent_code - Wed Jun 14, 2006 5:49 pm</h4>
    <div class="postbody"><span class="postbody">you include .bmp files as .bin and load it with your own loader code, don't you? i'm confused...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87586 - Dark Knight ez - Wed Jun 14, 2006 5:55 pm</h4>
    <div class="postbody"><span class="postbody">Maybe PCX2Tex will help? It will take a 256 colours PCX file and convert it to a bin file (having looked through its code) with the alpha bit on.
<br/>
See the tools section of Ethos' site.
<br/>
<a href="http://ethos.oddigytitanium.com/" target="_blank">http://ethos.oddigytitanium.com/</a>
<br/>
<br/>
edit:
<br/>
Unlike the "just renamed" explenation given by Valmon below,
<br/>
the conversion to .bin I suggested here should give you a .bin file
<br/>
with contents already appropriate for the DS such as in the examples.</span><span class="gensmall"><br/><br/>Last edited by Dark Knight ez on Thu Jun 15, 2006 4:07 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#87749 - Valmond - Thu Jun 15, 2006 2:51 pm</h4>
    <div class="postbody"><span class="postbody">Just to clarify (I'll try anyway), the .bin used in
<br/>
the examples from devKitPro are just renamed files.
<br/>
<br/>
Just an extension rename.
<br/>
<br/>
<br/>
This makes the makefile include them into the project.
<br/>
(if they are in the data directory)
<br/>
<br/>
<br/>
<br/>
Now, you surely don't want to include windows bitmap files
<br/>
as there are headers and they don't have the data stored
<br/>
in a nice DS/GBA like manner, but you can if you want.
<br/>
<br/>
<br/>
This is one way that gets you'r files on the DS:(If you use the makefile from the examples)
<br/>
1) Convert the data (gfx2gba, PCX2Tex, wavConvert, etc. or convert on the DS or write you'r own tools)
<br/>
2) Change the extention .ext (or whatever .xxx) to .bin 
<br/>
3) put the file in the 'data' directory
<br/>
<br/>
the makefile will at next compile make a foobar.h file that contains a pointer to the data.
<br/>
<br/>
<br/>
<br/>
<br/>
I know, you all know this already, it wast just to clarify :p
<br/>
<br/>
/Valmond
<br/>
[edit to not bump] Yes :p [/edit]</span><span class="gensmall"><br/><br/>Last edited by Valmond on Tue Jun 27, 2006 4:20 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#87787 - silent_code - Thu Jun 15, 2006 6:13 pm</h4>
    <div class="postbody"><span class="postbody">sure we know ;)
<br/>
<br/>
the tool i use (usenti - sweet piece of software!) exports to .bin. that is, it writes raw binary data. the header file generated by the makefile will contain everything (e.g. size of the file) to work with it.
<br/>
<br/>
raw binary data rulez ;)
<br/>
<br/>
thanks for trying to clarify it, anyway! though i don't get your posts saying:
<br/>
<br/>
"Now, you surely don't want to include windows bitmap files
<br/>
as there are headers and they don't have the data stored
<br/>
in a nice DS/GBA like manner, but you can if you want. "
<br/>
<br/>
after you said:
<br/>
<br/>
"Don't know if this is what you are looking for, but I just
<br/>
change the .bmp (or whatever I want to load) to .bin "
<br/>
<br/>
? i think you mean that in a more open, general sense - like "how to include files in your rom".
<br/>
<br/>
:) never mind! :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
