<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>first arm7 test - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > first arm7 test</h2>
<div id="posts">
<div class="post">
    <h4>#129199 - naleksiev - Sun May 20, 2007 4:43 pm</h4>
    <div class="postbody"><span class="postbody">Hello. This is my arm7 test.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void VblankHandler(void)
<br/>
{
<br/>
   BG_PALETTE_SUB[1]++;
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
   irqInit();
<br/>
   irqSet(IRQ_VBLANK, VblankHandler);
<br/>
<br/>
   // Keep the ARM7 idle
<br/>
   while (1) swiWaitForVBlank();
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
I was hoping to figured out if my arm7 code works at all before I start writing the real functionality, unfortunately it doesn't.
<br/>
<br/>
If I add the VblankHandler to my arm9 code I can see the background changing
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void VblankHandler(void)
<br/>
{
<br/>
   BG_PALETTE_SUB[1]++;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
I couldn't find what's wrong with my code. 
<br/>
 - Is my code wrong and why?
<br/>
 - Is there something special that I need to do to make both CPUs boot? Right now I just compile the arm7 and arm9 parts separately and then combine them with ndstool.exe from devkitARM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129205 - Lick - Sun May 20, 2007 6:01 pm</h4>
    <div class="postbody"><span class="postbody">ARM7 doesn't have access to the 2D graphics engine.
<br/>
<br/>
You really should download the libnds examples and use the <span style="font-weight: bold">template</span> projects. Those contain prewritten Makefiles and a lot of good stuff.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129214 - naleksiev - Sun May 20, 2007 6:36 pm</h4>
    <div class="postbody"><span class="postbody">I know about this template and still I want to use my Makefile, it's using the same steps as the template. 
<br/>
<br/>
I notice that arm7 doesn't have any of the graphics defines. So I add the define BG_PALETTE_SUB . Is this what you mean by arm7 doesn't have access to the 2D graphics engine? Or maybe it doesn't have access to the this part of the memory?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define BG_PALETTE_SUB   ((uint16*)0x05000400)</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129220 - tepples - Sun May 20, 2007 6:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>naleksiev wrote:</b></span></td> </tr> <tr> <td class="quote">I notice that arm7 doesn't have any of the graphics defines. So I add the define BG_PALETTE_SUB . Is this what you mean by arm7 doesn't have access to the 2D graphics engine? Or maybe it doesn't have access to the this part of the memory?</td> </tr></table><span class="postbody">
<br/>
The latter is the case. You will need to run graphics code on the ARM9.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129228 - naleksiev - Sun May 20, 2007 7:30 pm</h4>
    <div class="postbody"><span class="postbody">Thank you! 
<br/>
<br/>
I'll assume that my arm7 code is executed correct and I'll proceed with the sound code for it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129366 - naleksiev - Tue May 22, 2007 4:15 am</h4>
    <div class="postbody"><span class="postbody">Finally I can send all messages I want to the arm7 and my sound is working. Once I setup the sound channel I can't modify it. For example I tried to change the panning but nothing is changing in the sound. Also I tried to play a new sound on the same channel also without success.
<br/>
The only way I can modify something or run a new sound is if I first stop the channel and then setup a new one.
<br/>
But then I have another issue it can't be done in the same frame.
<br/>
<br/>
Can someone give me an idea what's wrong. Is there a workaround or maybe gave me some docs about sound on NDS.
<br/>
<br/>
Thank you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129408 - Lick - Tue May 22, 2007 4:17 pm</h4>
    <div class="postbody"><span class="postbody">Panning: it <span style="font-weight: bold">should</span> be changeable while the channel is playing.
<br/>
<br/>
Another sound: use another channel.
<br/>
<br/>
Docs: try <a class="postlink" href="http://nocash.emubase.de/gbatek.htm" target="_blank">gbatek</a>. (<a class="postlink" href="http://lickr.org/gbatek.htm" target="_blank">gzipped</a>)<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129409 - naleksiev - Tue May 22, 2007 4:24 pm</h4>
    <div class="postbody"><span class="postbody">I'm 90% sure it's not changeable :( Or maybe I need to do something else after I set the panning bits?
<br/>
<br/>
I'll give a try to be sure it wasn't my fault.
<br/>
<br/>
And thank you for the specification.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
