<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Distinguish between hardware and emulator at runtime - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Distinguish between hardware and emulator at runtime</h2>
<div id="posts">
<div class="post">
    <h4>#171006 - pladux - Wed Oct 28, 2009 11:33 am</h4>
    <div class="postbody"><span class="postbody">Hey guys,
<br/>
<br/>
i'm working on a little app that is able fetch some data from a website.
<br/>
<br/>
Since there is no emulator with wifi support all calls to Wifi_InitDefault leads to a blank window. On the DS everything just works fine, so i'd like to find a way to feed my app with 'fake data' when it runs on an emulator.
<br/>
<br/>
I want something like
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if(runningOnNDS()) {
<br/>
    retrieveDataFromInternet()
<br/>
} else {
<br/>
    retrieveDataFromLocalFile()
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I do not want
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifdef NDS
<br/>
    retrieveDataFromInternet()
<br/>
#else
<br/>
    retrieveDataFromLocalFile()
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
since this would need an other build target.
<br/>
<br/>
It would be nice if someone could give me a hint.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#171007 - a128 - Wed Oct 28, 2009 12:25 pm</h4>
    <div class="postbody"><span class="postbody">use the libfat (FAT) ....Luke :-)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
   if(fatInitDefault()) {
<br/>
      imfat=true;
<br/>
      printf("Success...gues I have the hardware with DLDI\n");
<br/>
   } else {
<br/>
      imfat=false;
<br/>
      printf("Failed... (normal for some emulators. Dont worry, yet :p)\n");
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
<br/>
as seen in NitroFS<br/>_________________<br/>"Hey! It compiles! Ship it!"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#171008 - pladux - Wed Oct 28, 2009 12:35 pm</h4>
    <div class="postbody"><span class="postbody">thank you</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#171023 - Exophase - Wed Oct 28, 2009 8:37 pm</h4>
    <div class="postbody"><span class="postbody">Why not just test if the WiFi is actually working? That way if an emulator does implement WiFi your code will work on it the proper way, and if the emulator is too genuine/accurate for your check to work then it won't unexpectedly fail.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#171028 - hacker013 - Wed Oct 28, 2009 10:20 pm</h4>
    <div class="postbody"><span class="postbody">libfat read and writes are supported in ideas with a special plugin ;)<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#171037 - TwentySeven - Wed Oct 28, 2009 11:40 pm</h4>
    <div class="postbody"><span class="postbody">Yeah I just check the wifi.
<br/>
<br/>
Wifi_AutoConnect(); // request connect
<br/>
while(1) 
<br/>
{
<br/>
i=Wifi_AssocStatus(); // check status
<br/>
if(i==ASSOCSTATUS_ASSOCIATED) 
<br/>
{
<br/>
Debugout("Connected successfully!");
<br/>
break;
<br/>
}
<br/>
			if(i==ASSOCSTATUS_CANNOTCONNECT) 
<br/>
{
<br/>
Debugout("Could not connect!");
<br/>
return -1;  //probably in an emulator 
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#171049 - a128 - Thu Oct 29, 2009 9:34 am</h4>
    <div class="postbody"><span class="postbody">Ideas also have a WiFi plugin
<br/>
<br/>
But who uses Ideas...?!  My apps never runs on Ideas! Which is sad because I think it has some great debugging features.<br/>_________________<br/>"Hey! It compiles! Ship it!"</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
