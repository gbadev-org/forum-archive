<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>help needed, simple image veiwer app. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > help needed, simple image veiwer app.</h2>
<div id="posts">
<div class="post">
    <h4>#168381 - opearn - Sun Apr 26, 2009 2:03 pm</h4>
    <div class="postbody"><span class="postbody">i'm trying to make a simple image viewer app,
<br/>
<br/>
i need to add my integer and u8 string together to use with dmacopy.
<br/>
i want to use numbers as my imge names so i can easily use code like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (keysHeld()&amp;KEY_RIGHT){
<br/>
picno+=1
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
heres my code so far.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;nds.h&gt;
<br/>
#include &lt;stdio.h&gt;
<br/>
<br/>
#include "0.h"
<br/>
#include "1.h"
<br/>
<br/>
picno = 0;
<br/>
<br/>
int main(void)
<br/>
{
<br/>
    //init video modes
<br/>
   videoSetMode( MODE_5_2D );
<br/>
   videoSetModeSub( MODE_5_2D );
<br/>
   vramSetMainBanks(VRAM_A_MAIN_BG_0x06000000,VRAM_B_MAIN_BG_0x06020000,VRAM_C_SUB_BG_0x06200000,VRAM_D_LCD);
<br/>
<br/>
   //init bgs
<br/>
   int bg3 = bgInit(3, BgType_Bmp8, BgSize_B8_256x256, 0,0);
<br/>
<br/>
   dmaCopy(picno+(u8*)"Bitmap", bgGetGfxPtr(bg3), 256*256);
<br/>
   dmaCopy(picno+(u8*)"Pal", BG_PALETTE, 256*2);
<br/>
<br/>
    while(1){
<br/>
   swiWaitForVBlank();
<br/>
   }
<br/>
<br/>
   return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
thanks in advance for your help[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168384 - chebastian - Sun Apr 26, 2009 2:53 pm</h4>
    <div class="postbody"><span class="postbody">just thinking.
<br/>
<br/>
cant you just put all your images in a big array
<br/>
and increase/decrease the current index of the image you display at button down?
<br/>
<br/>
EDIT: ofcourse not a great idea if you have alot of images, but you get the point.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168391 - dovoto - Mon Apr 27, 2009 2:31 am</h4>
    <div class="postbody"><span class="postbody">hrm... well lets ignore for the moment that including a bunch of pictures in your compiled code is probably bad juju (better to use a file system as this way is going to eat up your 4MB of ram pretty fast).
<br/>
<br/>
Lets also ignore that the way are you going about it is so fundamentally flawed that explaining why would be poorly suited for a forum post.  I highly recommend you take a few days and sit down with a good c book from your library/bookstore/internet.
<br/>
<br/>
Lets then assume that 0.h and 1.h have some reference to your palette and bitmap data like such:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern u16* _0Data;
<br/>
extern u16* _0Pal;
<br/>
<br/>
extern u16* _1Data;
<br/>
extern u16* _1Pal;</td> </tr></table><span class="postbody">
<br/>
<br/>
Then you could do something like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef struct 
<br/>
{
<br/>
   u16* data;
<br/>
   u16* pal;
<br/>
}Picture;
<br/>
<br/>
Picture pics[] = {{_0Data, _0Pal}, {_1Data, _1Pal}};
<br/>
<br/>
...
<br/>
<br/>
   dmaCopy(pics[picno].data, bgGetGfxPtr(bg3), 256*256);
<br/>
   dmaCopy(pics[picno].pal, BG_PALETTE, 256*2); 
<br/>
<br/>
...</td> </tr></table><span class="postbody">
<br/>
<br/>
A file system with a file browser would be a much saner approach or at least preprocessing the image files into an array as editing the pics[] array by hand would be tedious at best and likely error prone.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168392 - opearn - Mon Apr 27, 2009 2:43 am</h4>
    <div class="postbody"><span class="postbody">thanks but...
<br/>
you mentioned loading images from a file system,
<br/>
<br/>
can i load bmps directly of FAT?
<br/>
or do i have to preconvert?
<br/>
<br/>
i'd definatly prefer to load from FAT though.
<br/>
<br/>
oh and is there libfat documentation?
<br/>
<br/>
thanks dovoto.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168393 - dovoto - Mon Apr 27, 2009 2:50 am</h4>
    <div class="postbody"><span class="postbody">There is an example in the example folder for using fatlib.  It really is just a matter of calling fatinit() and then using standard file io.  The example even includes some file browsing if i remember correctly.
<br/>
<br/>
As for leaving the files as .bmp I think that is a great idea.  Not because it is the proper way (.bmp is a pretty crappy format all things considered) but because it would be a useful experience for you if you are just starting out.  
<br/>
<br/>
BMP files are easy to decode and finding info about them on the internet is very easy.  It would be great little project for learning how to access files and display simple graphics on the DS.<br/>_________________<br/><a href="http://www.drunkencoders.com" target="_blank">www.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168394 - opearn - Mon Apr 27, 2009 3:22 am</h4>
    <div class="postbody"><span class="postbody">thanks dovoto,
<br/>
<br/>
also quick question,
<br/>
are you planning to finish your dev-scene tuts?
<br/>
<br/>
<a class="postlink" href="http://dev-scene.com/NDS/Tutorials" target="_blank">http://dev-scene.com/NDS/Tutorials</a>
<br/>
<br/>
i'll try to find some info on decoding bmps later today,
<br/>
but how do i re-encode into the ds's binarys?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
