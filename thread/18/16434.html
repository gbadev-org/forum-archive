<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ini library needed - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > ini library needed</h2>
<div id="posts">
<div class="post">
    <h4>#166597 - hacker013 - Wed Feb 11, 2009 8:39 am</h4>
    <div class="postbody"><span class="postbody">hey everybody,
<br/>
<br/>
I'm looking for an Library for reading from and writing to ini files. I already found the one made by dragonminded but that one only support reading. Does someone from you guys one with reading and writing support?
<br/>
<br/>
gr,
<br/>
<br/>
newbie013<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166600 - kusma - Wed Feb 11, 2009 1:37 pm</h4>
    <div class="postbody"><span class="postbody">Uhh, this is a very simple matter of fscanf and fprintf... Sure you can't handle this by yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166606 - hacker013 - Wed Feb 11, 2009 4:33 pm</h4>
    <div class="postbody"><span class="postbody">i think ini files are more complicated then you think :)<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166607 - elhobbs - Wed Feb 11, 2009 4:45 pm</h4>
    <div class="postbody"><span class="postbody">I think ini files are less complicated then you think...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">;comment
<br/>
[section]
<br/>
key=value</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166608 - hacker013 - Wed Feb 11, 2009 6:12 pm</h4>
    <div class="postbody"><span class="postbody">with fscanf and fprintf i haven't parsed it yet.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166615 - silent_code - Wed Feb 11, 2009 11:36 pm</h4>
    <div class="postbody"><span class="postbody">Maybe XML will prove a better choise for the future?<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166617 - Lazy1 - Thu Feb 12, 2009 12:05 am</h4>
    <div class="postbody"><span class="postbody">It's fairly easy to parse, not sure about writing it since I haven't needed to.
<br/>
<br/>
1) For each line in the file
<br/>
2) Get a pointer to the key/value seperator using <a class="postlink" href="http://linux.die.net/man/3/strstr" target="_blank">strstr()</a>
<br/>
3) Set the key/value seperator to a null terminator
<br/>
4) Add 1 to the pointer returned by strstr
<br/>
<br/>
There you go, your line buffer now is the key and your character pointer points to the value.
<br/>
You'll probably need to handle whitespace though but that's pretty much what I did.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166623 - gauauu - Thu Feb 12, 2009 4:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>silent_code wrote:</b></span></td> </tr> <tr> <td class="quote">Maybe XML will prove a better choise for the future?</td> </tr></table><span class="postbody">
<br/>
Except that XML is much slower and harder to parse.  Which is no big deal on fast machines, but on something slim and slow like the DS, a more compact and simple format can sometimes be desirable.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166624 - elwing - Thu Feb 12, 2009 7:14 am</h4>
    <div class="postbody"><span class="postbody">that said the ol expat is prolly faster than a badly written user ini parser, no? as long as you do not care about schema and such it's quite easy and fast... the dificulty is not the parsing itself it is the datastructure... for simple ini file a simple map would be sufficient but for more complex ini file (ini file with path in [sections]) or for xml you will need a tree...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166627 - timkins - Thu Feb 12, 2009 10:07 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://json.org/" target="_blank">JSON</a> is a nice simple format.  Of the parsers listed on the official site <a class="postlink" href="http://lloydforge.org/projects/yajl/" target="_blank">YAJL</a> seemed to be a good fit for the DS.[/url]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166628 - nanou - Thu Feb 12, 2009 11:14 am</h4>
    <div class="postbody"><span class="postbody">JSON is nice, I only have a couple of minor complaints about it. But I really think that if an .ini file can handle the situation anything more complex is an insane choice, unless you expect to need that complexity later on.
<br/>
<br/>
EDIT: I forgot to mention I agree that YAJL is probably a good fit for the DS. In the meantime I checked and it has no deps and compiles without complaint after fixing paths. I haven't tested it in that state, though, but it looks promising.<br/>_________________<br/>- nanou</span><span class="gensmall"><br/><br/>Last edited by nanou on Thu Feb 12, 2009 12:59 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#166629 - kusma - Thu Feb 12, 2009 12:58 pm</h4>
    <div class="postbody"><span class="postbody">hacker13: can't you use dragonminded's lib for reading the ini-files, and write them using a simple series for fwritef()-calls?
<br/>
<br/>
FWIW, I tried implementing an ini-parser, and it took me about 15 minutes to get it working properly, including all special cases I could think of. I didn't end up using fscanf, since it was easier to just read a line at the time, strip it, classify it, and "manually" parse by using strchr() etc.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166634 - hacker013 - Thu Feb 12, 2009 4:31 pm</h4>
    <div class="postbody"><span class="postbody">the writing is what i think more difficult because i want no dubbel keys, and support for writing commetary :) but if it is so easy, why nobody written a completely library for it in c/c++?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166635 - kusma - Thu Feb 12, 2009 4:36 pm</h4>
    <div class="postbody"><span class="postbody">Someone has: Microsoft. There's INI support in winapi. 
<br/>
<br/>
Anyway: why do you think double keys and comments are issues here? A comment is just a semicolon plus some text. It can perfectly fine be fprintf-ed. Double keys is similarly easy; don't write your keys multiple times...</span><span class="gensmall"><br/><br/>Last edited by kusma on Thu Feb 12, 2009 4:45 pm; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#166636 - hacker013 - Thu Feb 12, 2009 4:39 pm</h4>
    <div class="postbody"><span class="postbody">but if i wanna rewrite a key :( how do i check if it exists and and if not how do i add then the key to the end of the section.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166638 - kusma - Thu Feb 12, 2009 4:45 pm</h4>
    <div class="postbody"><span class="postbody">You parse it all in, and modify. What needs modifying. Or you can just read all the stuff in the ini-file on init, and dump the entire config-database on exit. Or something else.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166639 - kusma - Thu Feb 12, 2009 4:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">Someone has: Microsoft. There's INI support in winapi.</td> </tr></table><span class="postbody">
<br/>
<br/>
And<a class="postlink" href="http://sourceforge.net/projects/libini" target="_blank"> someone at sourceforge</a> has too. And <a class="postlink" href="http://ndevilla.free.fr/iniparser/" target="_blank">someone else</a>. And <a class="postlink" href="http://www.rudeserver.com/config/" target="_blank">someone else</a>... <a class="postlink" href="http://code.jellycan.com/simpleini/" target="_blank">etc</a>. Did you even try <a class="postlink" href="http://letmegooglethatforyou.com/?q=ini+library+c+c%2B%2B" target="_blank">google</a>?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166642 - hacker013 - Thu Feb 12, 2009 6:14 pm</h4>
    <div class="postbody"><span class="postbody">yes i tryed but the most librarys i found were platform dependent<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166644 - Lazy1 - Thu Feb 12, 2009 6:43 pm</h4>
    <div class="postbody"><span class="postbody">Is the data you are trying to read/write complicated enough to need more than a simple key=value format?
<br/>
Something like that would be very easy to write since it's not very complicated.
<br/>
<br/>
If you want to rewrite a key=value pair just read them all in, modify the entry and write them all out again.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166645 - kusma - Thu Feb 12, 2009 8:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">yes i tryed but the most librarys i found were platform dependent</td> </tr></table><span class="postbody">
<br/>
Weird, I thought I remembered you say "but if it is so easy, why nobody written a completely library for it in c/c++?"...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166646 - Tommmie - Thu Feb 12, 2009 8:57 pm</h4>
    <div class="postbody"><span class="postbody">minIni works well for me</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
