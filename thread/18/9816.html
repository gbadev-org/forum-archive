<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>[NEWBIE] Converting PNG to BIN - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > [NEWBIE] Converting PNG to BIN</h2>
<div id="posts">
<div class="post">
    <h4>#86346 - Spaceface - Tue Jun 06, 2006 3:17 pm</h4>
    <div class="postbody"><span class="postbody">Hey there,
<br/>
<br/>
At the moment I'm running through the newbietutorial on <a href="http://www.patatersoft.info/manual.html" target="_blank">http://www.patatersoft.info/manual.html</a> which actually helps a great deal. Within the .ZIP there are several .PNGs and in the /data dir the same amount in .BINs. The manual doesn't seem to cover how to convert from .PNG to .BIN for Windows. What is the right image converter I should use for .BIN conversion and should I use another format than .PNG, if so, what would be better and at which settings?
<br/>
<br/>
Sorry if this is a dumb newbie question, but I really searched and couldn't find it.
<br/>
<br/>
Thanks very much in advance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86350 - Sausage Boy - Tue Jun 06, 2006 4:12 pm</h4>
    <div class="postbody"><span class="postbody">A list of tools can be found at <a href="http://www.gbadev.org/tools.php?section=Graphics" target="_blank">http://www.gbadev.org/tools.php?section=Graphics</a>
<br/>
<br/>
However, .bin only means binary data. The DS has many different graphic modes, I don't know which Patater uses in his guide.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"><br/><br/>Last edited by Sausage Boy on Sat Aug 05, 2006 10:32 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#86420 - Patater - Wed Jun 07, 2006 1:58 am</h4>
    <div class="postbody"><span class="postbody">The manual uses mode5 graphics. The sprites are 256 color paletted and tiled. The BGs are mode5 extended rotation backgrounds, bitmapped and thus non-tiled. gfx2gba should be available for both linux and windows. It will do a fine job converting the sprites, but you'll have to modify the output it gives your for the BGs. The GBA BGs do not have an alphabit, so anything you produce with gfx2gba will not have an alpha bit set. You can use a for loop to load the graphics like so, however:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
for (uint16 i = 0; i &lt; Splash_bin_size / sizeof(uint16); ++i) {
<br/>
   //set bit 15 because gfx2gba is not NDS friendly: we have to set the transparent bit on each pixel
<br/>
   (uint16*)BG_BMP_RAM_SUB(3) = ((uint16*)Splash_bin)[i] | BIT(15);
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86426 - headspin - Wed Jun 07, 2006 3:14 am</h4>
    <div class="postbody"><span class="postbody">..or there is a program called <a class="postlink" href="http://headkaze.webpal.info/" target="_blank">fixbit16</a> that you can use to set the alpha bit on the raw output from gfx2gba. That way you can use the faster DMACopy to VRAM.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86453 - Spaceface - Wed Jun 07, 2006 9:28 am</h4>
    <div class="postbody"><span class="postbody">Thanks a lot for the help. As of now I'm not getting completely what I want. 
<br/>
What I did was use the packed PNG and open it in Photoshop. Then I made it indexed color which forces it to 256 colours:
<br/>
<a href="http://img110.imageshack.us/img110/1913/gba2gfxa8vm.jpg" target="_blank">http://img110.imageshack.us/img110/1913/gba2gfxa8vm.jpg</a>
<br/>
<br/>
I saved that one as a PCX file and pulled it through gfx2gba as you can see here:
<br/>
<a href="http://img110.imageshack.us/img110/1411/gba2gfxb6jj.jpg" target="_blank">http://img110.imageshack.us/img110/1411/gba2gfxb6jj.jpg</a>
<br/>
<br/>
After that I pulled it to fixbit16 (nothing exciting to show ;)) and what suprised me is that the amount of bytes of the file stayed the exact same; 256*192 = 49.152 bytes. But I could be wrong there.. 
<br/>
<br/>
However, once compiled I got this result:
<br/>
<a href="http://img110.imageshack.us/img110/9198/gba2gfxc2ro.jpg" target="_blank">http://img110.imageshack.us/img110/9198/gba2gfxc2ro.jpg</a>
<br/>
<br/>
Where the image seem to be tiled exactly twice the size. The .BINs included in the ZIP of the tutorial were twice the size of 49.152 bytes, and I think (!) that causes <span style="font-weight: bold">my </span>image to be half the size in X and Y. Either way, I can't figure this out really on how this is done. Anyone who can lead my way?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86455 - Dark Knight ez - Wed Jun 07, 2006 10:07 am</h4>
    <div class="postbody"><span class="postbody">First of all, check if the image is of dimension 256x192.
<br/>
I say this because not only is your picture displayed half the size of the screen in width (and then tiled to the right), but also half the size of the screen in height.
<br/>
Further more, I'm assuming the green part should be transparent. Using Photoshop, make the LAST palette entry the transparent one. Photoshop saves the palette inverted, making the last palette entry stored in a file as the first palette entry - which is the transparency entry.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86481 - Spaceface - Wed Jun 07, 2006 2:00 pm</h4>
    <div class="postbody"><span class="postbody">Nah there's no transparency in the image whatsoever.
<br/>
<br/>
<a href="http://img110.imageshack.us/img110/8594/splash4hm.png" target="_blank">http://img110.imageshack.us/img110/8594/splash4hm.png</a>
<br/>
This is the image I'm converting all the time which <span style="font-weight: bold">is</span> 256x192. However when saving as .RAW within Photoshop or converting to it via gfx2gba, it still remains 256 * 192 = 49.152 bytes
<br/>
The .BINs attached with the tutorial seem twice the size. So what seems the most logical?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86488 - Spaceface - Wed Jun 07, 2006 3:42 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Small update:</span>
<br/>
After some conversation with Nikolas on IRC it seems to be that the tutorial uses 16 bit gfx which isn't supported by gfx2gba. I have uploaded my code to <a href="http://rafb.net/paste/results/uybpn249.html" target="_blank">http://rafb.net/paste/results/uybpn249.html</a> for those interested. Maybe it clears things up why it keeps tiling for me. Probably the 8bit/16bit issue which causes it to be exactly half the size. But that's just a guess.. 
<br/>
<br/>
Maybe someone can tell me how to convert a 16bit image to a .RAW format?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86490 - parrot_ - Wed Jun 07, 2006 3:58 pm</h4>
    <div class="postbody"><span class="postbody">@Patater: Hrrm, that, and the fact I forgot to add FAT_InitFiles() to my code may be why my GFX won't show
<br/>
<br/>
@Spaceface: Use Patater's code, replacing Splash_bin_size and Splash_bin.<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86495 - Spaceface - Wed Jun 07, 2006 4:26 pm</h4>
    <div class="postbody"><span class="postbody">Hmmm I'm about to give up on this. Seems like 16 bit images aren't that common on the DS so maybe I shouldn't bother at all. Either way, the for-loop
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void displaySplash(){
<br/>
   for (uint16 i = 0; i &lt; Splash_bin_size / sizeof(uint16); ++i) {
<br/>
      //set bit 15 because gfx2gba is not NDS friendly: we have to set the transparent bit on each pixel
<br/>
      (uint16*)BG_BMP_RAM_SUB(3) = ((uint16*)Splash_bin)[i] | BIT(15);
<br/>
   } 
<br/>
   //dmaCopy(Splash_bin, BG_BMP_RAM_SUB(0), Splash_bin_size);
<br/>
   // sub bg is BG_BMP_RAM_SUB(0)
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Gives me this error
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">c:/devkitPro/projects/Manual_1/source/main.c:59: error: 'for' loop initial declaration used outside C99 mode
<br/>
c:/devkitPro/projects/Manual_1/source/main.c:61: error: invalid lvalue in assignment</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86497 - parrot_ - Wed Jun 07, 2006 4:29 pm</h4>
    <div class="postbody"><span class="postbody">Are you using R19?<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86498 - Dark Knight ez - Wed Jun 07, 2006 4:31 pm</h4>
    <div class="postbody"><span class="postbody">I use this code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (i=0; i&lt; (font_32x32_digits_bin_size &gt;&gt; 1); i++)
<br/>
        SPRITE_GFX_SUB[i] = ((uint16*)font_32x32_digits_bin)[i];</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't have to set a transparency bit, since my gfx2gba takes good care of that. (There are two programs called gdx2gba. Most prefer the one you are using, I believe.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86500 - Spaceface - Wed Jun 07, 2006 4:32 pm</h4>
    <div class="postbody"><span class="postbody">Yeah I think so, downloaded it last Sunday, so I'm guessing I'm using R19..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86502 - parrot_ - Wed Jun 07, 2006 4:40 pm</h4>
    <div class="postbody"><span class="postbody">DevkitARM or gfx2gba? I'm just about to test my app w/ DKA R19 and gfx2gba 0.13, I'll tell you the results<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86504 - Spaceface - Wed Jun 07, 2006 4:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>parrot_ wrote:</b></span></td> </tr> <tr> <td class="quote">DevkitARM or gfx2gba? I'm just about to test my app w/ DKA R19 and gfx2gba 0.13, I'll tell you the results</td> </tr></table><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">=======================
<br/>
gfx2gba Converter v0.13
<br/>
-----------------------
<br/>
(C) 2oo1-2oo2 [TRiNiTY]
<br/>
=======================</td> </tr></table><span class="postbody">
<br/>
<br/>
=)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86507 - parrot_ - Wed Jun 07, 2006 4:54 pm</h4>
    <div class="postbody"><span class="postbody">Dualis murders itself :D I haven't got the opportunity to test on HW, yet<br/>_________________<br/>Squak! etc.
<br/>
<a class="postlink" href="http://squakly.wordpress.com" target="_blank">My Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86508 - Sausage Boy - Wed Jun 07, 2006 4:57 pm</h4>
    <div class="postbody"><span class="postbody">Spaceface, in case you havn't solved your compiling problem, rename the file to main.cpp.
<br/>
<br/>
This is because C doesn't support declaring variables inside the for loop: "for (uint16 i", but C++ does. If you want, you could alternatively change the code to
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
uint16 i;
<br/>
for (i = 0; i &lt; Splash_bin_size / sizeof(uint16); ++i) {
<br/>
      //set bit 15 because gfx2gba is not NDS friendly: we have to set the transparent bit on each pixel
<br/>
      (uint16*)BG_BMP_RAM_SUB(3) = ((uint16*)Splash_bin)[i] | BIT(15);
<br/>
   } 
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86523 - Spaceface - Wed Jun 07, 2006 6:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sausage Boy wrote:</b></span></td> </tr> <tr> <td class="quote">Spaceface, in case you havn't solved your compiling problem, rename the file to main.cpp.
<br/>
<br/>
This is because C doesn't support declaring variables inside the for loop: "for (uint16 i", but C++ does. If you want, you could alternatively change the code to
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
uint16 i;
<br/>
for (i = 0; i &lt; Splash_bin_size / sizeof(uint16); ++i) {
<br/>
      //set bit 15 because gfx2gba is not NDS friendly: we have to set the transparent bit on each pixel
<br/>
      (uint16*)BG_BMP_RAM_SUB(3) = ((uint16*)Splash_bin)[i] | BIT(15);
<br/>
   } 
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">Holy crap I didn't see that yet (the cpp part ;)). Now I'm wondering, this line
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">      (uint16*)BG_BMP_RAM_SUB(3) = ((uint16*)Splash_bin)[i] | BIT(15);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Still gives this error
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">c:/devkitPro/projects/Manual_1/source/main.cpp:62: error: invalid lvalue in assignment</td> </tr></table><span class="postbody">
<br/>
<br/>
It seems to be in the (uint16*)BG_BMP_RAM_SUB(3) part, but I could be wrong. Also removing the typecast didn't help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86528 - masscat - Wed Jun 07, 2006 6:43 pm</h4>
    <div class="postbody"><span class="postbody">Change the line to this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">((uint16*)BG_BMP_RAM_SUB(3))[i] = ((uint16*)Splash_bin)[i] | BIT(15);</td> </tr></table><span class="postbody">
<br/>
This treates the address generated by the macro call and cast (uint16 *)BG_BMP_RAM_SUB(3) as an array indexed by 'i', therefore copying the data pointed to Splash_bin to the GB_BMP_RAM_SUB(3) address.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86536 - Spaceface - Wed Jun 07, 2006 7:25 pm</h4>
    <div class="postbody"><span class="postbody">Works now--code wise, but for one funny reason it's shifted downwards and still tiles, only halfway. Ah well I give up.. thanks a load though guys. Think this lies beyond my knowledge to properly communicate with you guys..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86539 - tepples - Wed Jun 07, 2006 7:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Sausage Boy wrote:</b></span></td> </tr> <tr> <td class="quote">This is because C doesn't support declaring variables inside the for loop</td> </tr></table><span class="postbody">
<br/>
It does if you compile in C99 mode.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96771 - hmbg - Sat Aug 05, 2006 1:27 pm</h4>
    <div class="postbody"><span class="postbody">well, if you give up ... I don't wanna give up
<br/>
I followed this thread and I had and have the same problem like Spaceface. After using the code of masscat I even had the BG but also only half or moved downwards
<br/>
So any Ideas why? Can somebody help me?
<br/>
I even would like to show the background in a different way (maybe 8 bit pal or sth. like that) but don't know how.
<br/>
<br/>
thx hmbg</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96823 - omaremad - Sat Aug 05, 2006 7:00 pm</h4>
    <div class="postbody"><span class="postbody">Well for exrot its best to use jpeg since its the best image compression and its as easy as
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
JPEG_DecompressImage((uint8*)gbfs_get_obj(&amp;data_gbfs, "om.jpg", NULL), BG_GFX, 256, 256);</td> </tr></table><span class="postbody">
<br/>
<br/>
if you are not desprate for 16 bit colours on the other bgs's use 256 colour mode with extened pallets , gfx2gba and usenti work perfect even with direct copies to the vram</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#96848 - Sausage Boy - Sat Aug 05, 2006 10:39 pm</h4>
    <div class="postbody"><span class="postbody">hmbg, get on #dsdev on irc.blitzed.org (if you don't have an irc client, I like <a class="postlink" href="http://puto.homeunix.org/xchat/viewtopic.php?t=5" target="_blank">xchat</a>.
<br/>
<br/>
I or someone else there will probably be able to help you with your problem.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
