<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Printing on main and sub-screen - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Printing on main and sub-screen</h2>
<div id="posts">
<div class="post">
    <h4>#155881 - Roland - Mon May 05, 2008 12:33 am</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
I'm really new to NDS development, and I'm learning the basics without using high-level libraries such as PAlib, because I really want to learn the architecture without any other abstraction layer.
<br/>
Anyway, I have to admit that I'm feeling a bit lost (i.e.: I didn't find the documentation for functions like consoleInit() etc...), today I wrote my first "application", well it's just a text printed with printf() that can be moved around with the touchscreen and resized/rotated, nothing else ;p.
<br/>
Now I'd like to move the text from the lower screen to the upper screen when the user drags it with the pen. The main question is: who decides where the text printed with printf() is actually printed? This is a snippet of the code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   lcdMainOnTop();
<br/>
   videoSetMode(MODE_5_2D | DISPLAY_BG3_ACTIVE);
<br/>
   videoSetModeSub(MODE_5_2D | DISPLAY_BG3_ACTIVE | DISPLAY_BG_EXT_PALETTE);
<br/>
<br/>
   vramSetBankA(VRAM_A_MAIN_BG);
<br/>
   vramSetBankC(VRAM_C_SUB_BG); 
<br/>
<br/>
   SUB_BG3_CR = BG_TILE_BASE(char_base) | BG_MAP_BASE(screen_base) | ROTBG_SIZE_256x256;
<br/>
   
<br/>
   u16* sub_tile = (u16*)CHAR_BASE_BLOCK_SUB(char_base);
<br/>
   u16* sub_map = (u16*)SCREEN_BASE_BLOCK_SUB(screen_base);
<br/>
<br/>
   consoleInit((u16*)fontData, sub_tile, 95, 32, sub_map, CONSOLE_USE_COLOR255, 8);
<br/>
   printf("Test text!\n");
<br/>
</td> </tr></table><span class="postbody">
<br/>
Most of it is taken from an example I've found in devkitpro. printf() prints the text on the lower screen, this is ok for me, but how can I tell it that I want the text to be printed on the upper screen? And if I want to move the text from the lower to the upper screen what should I do?
<br/>
Thanx a lot in advance for your help, I'm really willing to learn the basics and that's why I'm experimenting with the example code, but a lot of parts are quite obscure to me :).
<br/>
<br/>
C u!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155882 - silent_code - Mon May 05, 2008 1:04 am</h4>
    <div class="postbody"><span class="postbody">just a short hint: download the sources for libnds (devkitPro is "just" the "vendor" [is that right, wintermute? ;^D ] for the devkitARM compiler package - you use libnds to interface the nds' hw), they are sufficiently documented.
<br/>
<br/>
the screens are two seperate entities. you need to assign v(ideo)ram banks and set up their usage. this will tell the hw how you will use the vram and what screen will display it.
<br/>
<br/>
so, you need to set up two consoles... might be a bit hard for a starter, i guess. i haven't done it myself (no need to), but i imagine there are other ways of doing it. i have an idea, but i think it might be too confusing and not having done it, i'll better shut up. ;^D
<br/>
<br/>
note: make sure you use the forum search function, this topic has already been discussed, iirc.
<br/>
<br/>
... and welcome to the community! :^D
<br/>
<br/>
happy coding!</span><span class="gensmall"><br/><br/>Last edited by silent_code on Mon May 05, 2008 1:12 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#155883 - tepples - Mon May 05, 2008 1:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Roland wrote:</b></span></td> </tr> <tr> <td class="quote">who decides where the text printed with printf() is actually printed?</td> </tr></table><span class="postbody">
<br/>
That's a matter of what you pass to consoleInit().<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155898 - simonjhall - Mon May 05, 2008 11:45 am</h4>
    <div class="postbody"><span class="postbody">I did a dual-screen console in Q2 by using the regular libnds one on the bottom screen and a '3D' one on the main screen using the same font. You could knock up a similar system, just using a tiled image on the top screen (instead of 3D)? 3D text is a PITA as you can get rendering errors...
<br/>
If libnds could automatically support screen spanning then that would be just epic. Any takers? ;-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155905 - Roland - Mon May 05, 2008 1:39 pm</h4>
    <div class="postbody"><span class="postbody">Thanx a lot for you helpful hints, I'm downloading libnds sources and I'll surely take a look at them. I'm sorry for the duped topic, I used the search function, but maybe I missed the right topic.
<br/>
Thank you very much, I hope to come by here in the next days with questions more intelligent than this one :).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#155906 - silent_code - Mon May 05, 2008 1:53 pm</h4>
    <div class="postbody"><span class="postbody">don't run yourself down, it's not a dumb question. ;^D
<br/>
you're welcome!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
