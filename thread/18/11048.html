<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Mad Lib porting anyone have experience? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Mad Lib porting anyone have experience?</h2>
<div id="posts">
<div class="post">
    <h4>#101370 - smoothingeye - Mon Sep 04, 2006 7:27 pm</h4>
    <div class="postbody"><span class="postbody">I am trying to do a MP3 player using Mad lib . anyone can give me some pointers ?
<br/>
<br/>
<br/>
<br/>
thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101623 - agentq - Wed Sep 06, 2006 10:00 pm</h4>
    <div class="postbody"><span class="postbody">I ported Madlib for the DS port of ScummVM.  It built without any problems on the ds.
<br/>
<br/>
The build command I used is:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">./configure --host=arm-elf --enable-speed --enable-sso -enable-fpm=arm CFLAGS='-specs=ds_arm9.specs -mthumb-interwork'
<br/>
make
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Simplicity itself!  It even has some ARM optimisations compiled in.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101639 - josath - Wed Sep 06, 2006 11:26 pm</h4>
    <div class="postbody"><span class="postbody">Someone should make a ds version of <a class="postlink" href="http://en.wikipedia.org/wiki/Mad_Libs" target="_blank">Mad Lib</a> which lets you write in your responses.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101710 - GPFerror - Thu Sep 07, 2006 4:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">Someone should make a ds version of <a class="postlink" href="http://en.wikipedia.org/wiki/Mad_Libs" target="_blank">Mad Lib</a> which lets you write in your responses.</td> </tr></table><span class="postbody">
<br/>
<br/>
LOL, yeah Mad Lib is cool.
<br/>
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101892 - smoothingeye - Fri Sep 08, 2006 6:50 pm</h4>
    <div class="postbody"><span class="postbody">I got the following error please help when i try to compile Mp3player . why libmad cannot be compoile? for arms?
<br/>
<br/>
<br/>
<br/>
not support `smull r1,r2,r0,r3'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccXmYU4C.s:1009: Error: unshifted register requ
<br/>
ired -- `adc r3,r1,r2,lsl#4'
<br/>
make[2]: *** [layer12.o] Error 1
<br/>
make[1]: *** [build] Error 2
<br/>
make[1]: Leaving directory `/d/Projects/nds/mp3play/arm9'
<br/>
make: *** [arm9/mp3play.elf] Error 2
<br/>
<br/>
seewan@SEEWAN02 /d/Projects/nds/mp3play
<br/>
$ make
<br/>
make -C arm7
<br/>
make[1]: Entering directory `/d/Projects/nds/mp3play/arm7'
<br/>
make[2]: `/d/Projects/nds/mp3play/mp3play.arm7' is up to date.
<br/>
make[1]: Leaving directory `/d/Projects/nds/mp3play/arm7'
<br/>
make -C arm9 -f Makefile
<br/>
make[1]: Entering directory `/d/Projects/nds/mp3play/arm9'
<br/>
layer12.c
<br/>
arm-eabi-gcc -MMD -MP -MF /d/Projects/nds/mp3play/arm9/build/layer12.d -Wall -Os
<br/>
 -mcpu=arm9tdmi -mtune=arm9tdmi -ffast-math -mthumb -mthumb-interwork -I/d/Proje
<br/>
cts/nds/mp3play/arm9/include -I/d/Projects/nds/mp3play/arm9/build -I/c/devkitPro
<br/>
/libnds/include -I/d/Projects/nds/mp3play/arm9/build -DARM9 -DFPM_ARM -DOPT_ACCU
<br/>
RACY  -DROMVER=\"\" -c /d/Projects/nds/mp3play/arm9/source/libmad/layer12.c -o l
<br/>
ayer12.o
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s: Assembler messages:
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:71: Error: selected processor does n
<br/>
ot support `smull r1,ip,r2,r3'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:73: Error: unshifted register requir
<br/>
ed -- `adc r3,r1,ip,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:114: Error: selected processor does
<br/>
not support `smull r2,r1,r0,r3'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:116: Error: unshifted register requi
<br/>
red -- `adc r0,r2,r1,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:489: Error: selected processor does
<br/>
not support `smull r0,r1,r3,r2'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:491: Error: unshifted register requi
<br/>
red -- `adc r3,r0,r1,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:495: Error: selected processor does
<br/>
not support `smull r0,ip,r3,r2'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:497: Error: unshifted register requi
<br/>
red -- `adc r1,r0,ip,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:503: Error: selected processor does
<br/>
not support `smull r1,r0,r3,r2'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:505: Error: unshifted register requi
<br/>
red -- `adc r2,r1,r0,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:640: Error: selected processor does
<br/>
not support `smull r0,r1,r3,r2'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:642: Error: unshifted register requi
<br/>
red -- `adc r3,r0,r1,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:646: Error: selected processor does
<br/>
not support `smull r0,ip,r3,r2'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:648: Error: unshifted register requi
<br/>
red -- `adc r1,r0,ip,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:654: Error: selected processor does
<br/>
not support `smull r1,r0,r3,r2'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:656: Error: unshifted register requi
<br/>
red -- `adc r2,r1,r0,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:930: Error: selected processor does
<br/>
not support `smull r2,ip,r0,r3'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:932: Error: unshifted register requi
<br/>
red -- `adc r1,r2,ip,lsl#4'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:1007: Error: selected processor does
<br/>
 not support `smull r1,r2,r0,r3'
<br/>
C:/DOCUME~1/seewan/LOCALS~1/Temp/ccqkI1f7.s:1009: Error: unshifted register requ
<br/>
ired -- `adc r3,r1,r2,lsl#4'
<br/>
make[2]: *** [layer12.o] Error 1
<br/>
make[1]: *** [build] Error 2
<br/>
make[1]: Leaving directory `/d/Projects/nds/mp3play/arm9'
<br/>
make: *** [arm9/mp3play.elf] Error</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#101909 - agentq - Fri Sep 08, 2006 8:59 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, the command I posted was for Devkitarm v18.  In v19 and above, the target has changed, so the command should be:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">./configure --host=arm-eabi --enable-speed --enable-sso -enable-fpm=arm CFLAGS='-specs=ds_arm9.specs -mthumb-interwork'
<br/>
make</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm not sure what the error messages above are caused by.  It looks like the compiler is set to use the wrong instruction set.  I'd check that you're passing -specs=ds_arm9.specs on the command line properly in single quotes.
<br/>
<br/>
If you can't get it to work, you can remove the --enable-fpm=arm parameter and it will compe in pure C.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102084 - smoothingeye - Sun Sep 10, 2006 6:44 pm</h4>
    <div class="postbody"><span class="postbody">how about these mesage ??? can u tell me how u port the libmad ?
<br/>
<br/>
<br/>
$ make
<br/>
linking .arm9.elf
<br/>
plug_mp3.o: In function `FreeMP3':
<br/>
plug_mp3.c:(.text+0x39c): undefined reference to `mad_frame_finish'
<br/>
plug_mp3.c:(.text+0x3a2): undefined reference to `mad_stream_finish'
<br/>
plug_mp3.c:(.text+0x3b2): undefined reference to `mad_decoder_finish'
<br/>
plug_mp3.o: In function `madusr_decode_exec':
<br/>
plug_mp3.c:(.text+0x404): undefined reference to `mad_header_decode'
<br/>
plug_mp3.c:(.text+0x45e): undefined reference to `mad_frame_decode'
<br/>
plug_mp3.c:(.text+0x4e0): undefined reference to `mad_synth_frame'
<br/>
plug_mp3.o: In function `error':
<br/>
plug_mp3.c:(.text+0x584): undefined reference to `mad_stream_errorstr'
<br/>
plug_mp3.o: In function `input':
<br/>
plug_mp3.c:(.text+0x60c): undefined reference to `mad_stream_buffer'
<br/>
plug_mp3.o: In function `StartMP3':
<br/>
plug_mp3.c:(.text+0x76c): undefined reference to `mad_decoder_init'
<br/>
plug_mp3.c:(.text+0x790): undefined reference to `mad_stream_init'
<br/>
plug_mp3.c:(.text+0x798): undefined reference to `mad_frame_init'
<br/>
plug_mp3.c:(.text+0x7a0): undefined reference to `mad_synth_init'
<br/>
collect2: ld returned 1 exit status
<br/>
make[1]: *** [/d/Projects/NDS/mp3play/arm9/.arm9.elf] Error 1</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102085 - Lick - Sun Sep 10, 2006 7:03 pm</h4>
    <div class="postbody"><span class="postbody">You prolly need to link the library. It would be something along '-lmad'. Add it behind '-lnds' in the Makefile.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102231 - smsisko - Tue Sep 12, 2006 12:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>agentq wrote:</b></span></td> </tr> <tr> <td class="quote">Sorry, the command I posted was for Devkitarm v18.  In v19 and above, the target has changed, so the command should be:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">./configure --host=arm-eabi --enable-speed --enable-sso -enable-fpm=arm CFLAGS='-specs=ds_arm9.specs -mthumb-interwork'
<br/>
make</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
From my personal experience, </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">--enable-speed</td> </tr></table><span class="postbody"> is slower then without it on the DS. 
<br/>
<br/>
But looking back at your configure parameters, I did not have </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">--enable-sso</td> </tr></table><span class="postbody"> either, maybe that's part of the reason ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102404 - smoothingeye - Wed Sep 13, 2006 6:51 pm</h4>
    <div class="postbody"><span class="postbody">I manage to get the lib to work but now the audio is very choppy . can i know where is it like this?
<br/>
<br/>
could it be some timing issue or the Fat lib problem i am using Super card</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
