<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Running tasks on the background for streaming applications? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Running tasks on the background for streaming applications?</h2>
<div id="posts">
<div class="post">
    <h4>#160340 - ragefury32 - Mon Jul 14, 2008 6:08 am</h4>
    <div class="postbody"><span class="postbody">Okay - so I have figured out (somewhat) of how to use WifiAutoConnect to make a connection via DSWifi, but I am having problems with one aspect of socket programming in the DS - how to create a background task.  
<br/>
<br/>
So let me explain what I am trying to do - I am trying to hit a web service with a parameter, something like:
<br/>
GET webapp/dynamic/streamlocations?userid=1123
<br/>
<br/>
And it'll push me a set of values automatically once every second until I close the connection.  
<br/>
<br/>
Here's the question - how would I make the NDS automatically retrieve this information, store it, and allow other things to happen?  I mean, I could make a timer interrupt on the NDS end wake up every second or so, do a connect() and retrieve the results, but the data is already automatically streamed to me.  Is there a way to have something in the background pick up the data off a stream without intervention?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160358 - JYC376 - Mon Jul 14, 2008 3:40 pm</h4>
    <div class="postbody"><span class="postbody">If you mean multithreading, here are some options:
<br/>
<br/>
<a class="postlink" href="http://www.softsystem.co.uk/page9.html" target="_blank">MTClib</a>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=11310&amp;start=0&amp;postdays=0&amp;postorder=asc" target="_blank">Hermes' sound and multithreading lib</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160361 - Maxxie - Mon Jul 14, 2008 4:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ragefury32 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Here's the question - how would I make the NDS automatically retrieve this information, store it, and allow other things to happen?  I mean, I could make a timer interrupt on the NDS end wake up every second or so, do a connect() and retrieve the results, but the data is already automatically streamed to me.  Is there a way to have something in the background pick up the data off a stream without intervention?</td> </tr></table><span class="postbody">
<br/>
<br/>
Have one receiving socket open, have a select(set with timeout=0) to check non blocking whether or not data was received on this connection regulary and in the meantime, do whatever you want.
<br/>
<br/>
No need to open/close connection every time.<br/>_________________<br/><a class="postlink" href="http://nintendods.desperate-programmers.com/doku.php?id=wireless_io_map" target="_blank">Trying  to bring more detail into understanding the wireless hardware</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160364 - elwing - Mon Jul 14, 2008 4:21 pm</h4>
    <div class="postbody"><span class="postbody">just a small offtopic question, that don't fill the multithreading level you need for networking, but does someone already tryed to play with protothread for their main gaming loop?
<br/>
<br/>
<a class="postlink" href="http://www.sics.se/~adam/pt/about.html" target="_blank">protothread</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160382 - tepples - Mon Jul 14, 2008 9:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elwing wrote:</b></span></td> </tr> <tr> <td class="quote"><a class="postlink" href="http://www.sics.se/~adam/pt/about.html" target="_blank">protothread</a></td> </tr></table><span class="postbody">
<br/>
Cooperative multithreading might become viable once devkitARM and libfat support non-blocking I/O. I've seen libfat block for five seconds at a time in some cases.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160388 - josath - Mon Jul 14, 2008 11:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elwing wrote:</b></span></td> </tr> <tr> <td class="quote"><a class="postlink" href="http://www.sics.se/~adam/pt/about.html" target="_blank">protothread</a></td> </tr></table><span class="postbody">
<br/>
Cooperative multithreading might become viable once devkitARM and libfat support non-blocking I/O. I've seen libfat block for five seconds at a time in some cases.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
solution is to stop using the G'n'M card? or are you simply referring to the lag when many drivers are compiled in and it's trying to scan them all? (which only happens if a user didn't apply a DLDI patch)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160390 - Maxxie - Mon Jul 14, 2008 11:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">solution is to stop using the G'n'M card? or are you simply referring to the lag when many drivers are compiled in and it's trying to scan them all? (which only happens if a user didn't apply a DLDI patch)</td> </tr></table><span class="postbody">
<br/>
<br/>
The speed of the device doesn't really matter.
<br/>
It will allways have a size dependand speed difference against a non blocking call. 
<br/>
<br/>
The solution for me was to split the needed reads in very small slizes. Something i would like to avoid with non blocking IO calls.
<br/>
(And this was on a much faster card then the GnM on an r4ds )<br/>_________________<br/><a class="postlink" href="http://nintendods.desperate-programmers.com/doku.php?id=wireless_io_map" target="_blank">Trying  to bring more detail into understanding the wireless hardware</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160400 - tepples - Tue Jul 15, 2008 3:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">solution is to stop using the G'n'M card?</td> </tr></table><span class="postbody">
<br/>
If only I could get my users to do the same...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">or are you simply referring to the lag when many drivers are compiled in and it's trying to scan them all? (which only happens if a user didn't apply a DLDI patch)</td> </tr></table><span class="postbody">
<br/>
The latter. Even when I use the automatic DLDI patch of the R4 firmware, libfat's fatInitDefault() still appears to scan for an FCSR image on the cart in my DS's SLOT-2.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
