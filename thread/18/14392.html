<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Debugging - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Debugging</h2>
<div id="posts">
<div class="post">
    <h4>#143632 - cheese_block - Wed Oct 24, 2007 9:46 pm</h4>
    <div class="postbody"><span class="postbody">Been reading through the various posts concerning DS debugging. I'm looking for source level debugging.
<br/>
<br/>
I've messed around with Insight/GDB, it seems to work for the simple example programs, but doesn't seem to work well for the more complex. I've considered no$cash, but the $1750 is currently out of my price range. Does the $15 version give you much more?
<br/>
<br/>
I wondered what everyone's technique is for debugging their code. Text to screen is fine when you're not using both screen to show much. Do any of the emulators have an output window you can write to?
<br/>
<br/>
Are there any other alternatives?
<br/>
<br/>
I'm going to continue trying to get insight to work a bit better, any tips would be appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143634 - sajiimori - Wed Oct 24, 2007 9:57 pm</h4>
    <div class="postbody"><span class="postbody">If it were me, I'd get the game code to compile on Windows and use the Visual Studio debugger.  There's really no contest in terms of quality.
<br/>
<br/>
I'd use the VisualBoyAdvance source to emulate the 2D hardware, and a higher-level layer to wrap 3D calls.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143664 - DragonMinded - Thu Oct 25, 2007 1:54 am</h4>
    <div class="postbody"><span class="postbody">I know it's not the best way, but I do all my debugging by writes to the filesystem or to the screen.  I have a debug flag I can compile in which turns the top screen into a console, so I can track down crash bugs.  I also have a debug to disc function that will write to the fat system instead of the screen when it's inconvenient to display anything.  As far as debugging in an emulator, I've never tried.<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143690 - DekuTree64 - Thu Oct 25, 2007 10:13 am</h4>
    <div class="postbody"><span class="postbody">I have asserts that can print messages/variable values when they fire, and a button combo to swap the top screen to printf output. I need to give it a real output buffer though, so I can have more than one screen's worth of stuff to look through if it dies (currently just prints to a screen block that I'm not using for anything else).
<br/>
<br/>
And most importantly, I have a wireless card with ralink chipset, so I can multiboot rather than card swapping. Next I need to set up wifilib so I can download and run without even turning the DS off and on :)<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143703 - simonjhall - Thu Oct 25, 2007 1:52 pm</h4>
    <div class="postbody"><span class="postbody">I'm gonna update and re-release the target debugger I wrote last year, adding some new features, fixing some bugs etc. Hopefully will do this after this weekend or something...
<br/>
Should be esp handy now that a gdb comes with r21.<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143745 - HyperHacker - Thu Oct 25, 2007 8:19 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, I just add printfs and/or button press checks as needed and remove them when I'm done. It's not great but it works. I'd implement a simple wifi console sort of thing (send text to PC to display on the screen) but I imagine it'd be more work than the majority of the debugging. :-p<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143770 - wintermute - Thu Oct 25, 2007 10:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>simonjhall wrote:</b></span></td> </tr> <tr> <td class="quote">I'm gonna update and re-release the target debugger I wrote last year, adding some new features, fixing some bugs etc. Hopefully will do this after this weekend or something...
<br/>
Should be esp handy now that a gdb comes with r21.</td> </tr></table><span class="postbody">
<br/>
<br/>
Cool, sort out the evil lawyers then?
<br/>
<br/>
I'd quite like to get some version of a gdb stub into the devkitARM distribution fairly soon - that was one of the reasons for adding gdb in there. 
<br/>
<br/>
Recently I've been playing with masscat's stub and DSerial but right now I'm having trouble getting it to connect at anything other than 9600baud. Would you and Masscat be interested in collaborating on the stub code? How would you feel about a stub library being included as part of the toolchain setup?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143811 - simonjhall - Fri Oct 26, 2007 9:22 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">Cool, sort out the evil lawyers then?</td> </tr></table><span class="postbody">Well... ;-)
<br/>
<br/>
I've just spent a bit of time thinking about this (during my dull journey to work). I'd love to get a bit of debuggin' love into the toolchain, as being able to debug is pretty crucial to writing code. However, given how infrequently people have asked for debugging on here, and there wasn't a very big response to what I released, I'm wondering if people want debugging after all. If people were writing a piece of software and made it compile under visual studio (or whatever) then being able to debug with that is far more productive than doing it on the DS over wifi! On the flip side, being able to debug on the real machine has been completely invaluable for me when writing Quake (esp as you can view all the hardware I/O registers etc) so it can be more useful than running on a PC.
<br/>
I dunno...what are other people's thought's on this?
<br/>
<br/>
With regards to collaborating, yeah, I'm up for that. However that does sound like a complete re-write to me when all I was thinking of doing was making a few small fixes and then re-releasing! Hmm... :-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143832 - masscat - Fri Oct 26, 2007 3:08 pm</h4>
    <div class="postbody"><span class="postbody">My GDB stub code is public domain (as is the GDB stub code in Desmume - the two are very similar with the Desmume stuff being more developed) so if anybody wants to play around with it then please do. I would like to get it into a better condition but have not given it the time and I am not sure when I will be able to.
<br/>
The biggest problem I was finding was that debugging the debugger is not the easiest thing or that much fun. Trying to debug the debugger was the original reason for the GDB stub in Desmume but Desmume is not capable of emulating the hardware features to run the on hardware GDB stub (too many GDB stubs) so I never used it to develop the on hardware stub further.
<br/>
<br/>
There is definitely value of an on hardware debugger. But without a stub in a reasonable state (it is easy to break my on hardware stub with it wondering off never to return) that is easy to incorporate into a project people will not use it.
<br/>
If a debugger stub does get into the tool-chain then there is an opportunity to solve the second part of the problem.
<br/>
<br/>
As for off hardware development I would recommend using Desmume with GDB (or compatible). The Desmume GDB stub allows near full GDB features support (breakpoints, watchpoints and the like). The stub is stable and you can believe what it tells you (I used it to develop Flickbook).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143855 - cheese_block - Fri Oct 26, 2007 8:59 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the replies guys.
<br/>
<br/>
I for one would love some debugging action. It surprises me that people stick with text output (though I'm really impressed with quality that this has produced). I think adding good source level debugging to the toolchain would certainly help the homebrew community.
<br/>
<br/>
Debugging with something like Visual Studio would be the ultimate for me, it's what I'm used to. But debugging on the hardware would also be fantastic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143863 - simonjhall - Fri Oct 26, 2007 10:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>masscat wrote:</b></span></td> </tr> <tr> <td class="quote">The biggest problem I was finding was that debugging the debugger is not the easiest thing or that much fun</td> </tr></table><span class="postbody">Hear hear! I dunno about you, but writing the debugger was one of the most fiddly things I've ever written! The whole thing with the ARM $pc being ahead of where it really is (but how far it is ahead depends on the type of abort) was seriously annoying. Bravo ARM, bravo.
<br/>
<br/>
However stuff like this is why I made my one a two-part debugger - the DS-side thing was very simple, and all the hard work was done on the PC (which allowed me do debug it). If I were to re-write it I'd still keep a PC-side controller/cache program. However this did mean that I managed to get pretty much ever bug out of it, and it's now steady-as. All I want now is ARM7 debugging...
<br/>
<br/>
We could always pass the torch to programmer #3, assuming they were masochistic enough!
<br/>
<br/>
EDIT, cheese, yeah the speed of visual studio is a bit of a way off (the wifi makes it slow) but here's wintermute's picture from a year ago:
<br/>
<a href="http://devkitpro.sourceforge.net/debugging.png" target="_blank">http://devkitpro.sourceforge.net/debugging.png</a><br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143875 - gmiller - Sat Oct 27, 2007 12:45 am</h4>
    <div class="postbody"><span class="postbody">if you have the GDB stub then you should be able to connect the insight debugger included with the devkitARm stuff and go to town.  I use that setup to debug code running on my GP2X and  the debugger running on my PC.  I also do the same thing with the Game Boy Advanced emulator and GBA code running on the same PC.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143881 - kusma - Sat Oct 27, 2007 12:55 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>simonjhall wrote:</b></span></td> </tr> <tr> <td class="quote">Bravo ARM, bravo.</td> </tr></table><span class="postbody">
<br/>
*bows*</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#143891 - M3d10n - Sat Oct 27, 2007 3:06 am</h4>
    <div class="postbody"><span class="postbody">I try to develop and test all logic stuff on a PC first. With some #ifdef usage I can use the same .h and .cpp files in both the PC and the DS executable.
<br/>
<br/>
I haven't had the courage to write graphical code to simulate the DS output, so graphics-related code must be tested on emus or hardware. I plan to do it someday, after I manage to abstract all graphical functions behind my own graphics layer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
