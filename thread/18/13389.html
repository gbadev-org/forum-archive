<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>gbfs won't work on the hardware. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > gbfs won't work on the hardware.</h2>
<div id="posts">
<div class="post">
    <h4>#130871 - BovineFury - Fri Jun 08, 2007 10:50 pm</h4>
    <div class="postbody"><span class="postbody">I recently added gbfs support to my project.   Everything works fine in the emulator, but all I get are white screens when running on the hardware.  I tried reverting to a earlier project and used gbfs for one file.  The results were exactly the same.  No problems on the emulator but nothing runs on the hardware.
<br/>
<br/>
The steps I use to setup the file system are as follows:
<br/>
<br/>
gbfs filesystem.gbfs *.raw *.pal
<br/>
padbin 256 game_code.nds
<br/>
cat game_code.nds filesystem.gbfs &gt;Voltz_DS.nds
<br/>
<br/>
Does anybody have an idea about what is happening?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130872 - NeX - Fri Jun 08, 2007 10:55 pm</h4>
    <div class="postbody"><span class="postbody">I can tell you now I have never had to do anything like that.<br/>_________________<br/><a class="postlink" href="http://www.mediafire.com/?cuyb10fzdz2" target="_blank">Strummer</a> or <a class="postlink" href="http://www.mediafire.com/?71zxcztscix" target="_blank">Drummer?</a>.  
<br/>
Or maybe you would rather play with sand? <a class="postlink" href="http://www.mediafire.com/?a05z5wmdvxm" target="_blank">Sandscape is for you in that case.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130876 - josath - Fri Jun 08, 2007 11:10 pm</h4>
    <div class="postbody"><span class="postbody">Appended gbfs is incompatible with ALL slot-1 devices, as well as GBAMP and Supercard Rumble. You haven't told us what device you are using, but my guess is one of the unsupported ones. Either way, it's not recommended to use appended gbfs, because then many people cannot use your app (unless you provide two versions)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130877 - NeX - Fri Jun 08, 2007 11:16 pm</h4>
    <div class="postbody"><span class="postbody">Well, I have an EFA-Linker which I use embedded GBFS with.  I find it hard to go over 4MB without sounds/music.<br/>_________________<br/><a class="postlink" href="http://www.mediafire.com/?cuyb10fzdz2" target="_blank">Strummer</a> or <a class="postlink" href="http://www.mediafire.com/?71zxcztscix" target="_blank">Drummer?</a>.  
<br/>
Or maybe you would rather play with sand? <a class="postlink" href="http://www.mediafire.com/?a05z5wmdvxm" target="_blank">Sandscape is for you in that case.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#130878 - BovineFury - Fri Jun 08, 2007 11:24 pm</h4>
    <div class="postbody"><span class="postbody">&gt;&gt; josath
<br/>
<br/>
That would be the problem.  Thanks a lot.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131474 - gyokimae - Sat Jun 16, 2007 1:22 am</h4>
    <div class="postbody"><span class="postbody">I've been struggling with the same problem until reading this post. ( I use a R4)
<br/>
<br/>
For applications launched from slot1, are there any alternatives to GBFS for storing data out of the main 4MB RAM and yet have everything in a single file?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131476 - tepples - Sat Jun 16, 2007 1:52 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote">For applications launched from slot1, are there any alternatives to GBFS for storing data out of the main 4MB RAM and yet have everything in a single file?</td> </tr></table><span class="postbody">
<br/>
No, not at least until devkitARM, libnds, and .nds loaders gain support for argv[0].<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131490 - felix123 - Sat Jun 16, 2007 4:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote">For applications launched from slot1, are there any alternatives to GBFS for storing data out of the main 4MB RAM and yet have everything in a single file?</td> </tr></table><span class="postbody">
<br/>
Can you do this with <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=13195" target="_blank">EFS Lib</a>?<br/>_________________<br/><a class="postlink" href="http://en.wikipedia.org/wiki/NDSh" target="_blank">Nintendo DS homebrew on Wikipedia</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131506 - MrD - Sat Jun 16, 2007 2:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote">I've been struggling with the same problem until reading this post. ( I use a R4)
<br/>
<br/>
For applications launched from slot1, are there any alternatives to GBFS for storing data out of the main 4MB RAM and yet have everything in a single file?</td> </tr></table><span class="postbody">
<br/>
<br/>
Why would you want to do this?<br/>_________________<br/>Not active on this forum. For Lemmings DS help see its website.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131510 - gyokimae - Sat Jun 16, 2007 4:38 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Why would you want to do this?</td> </tr></table><span class="postbody">
<br/>
My understanding is that unless you store data in the GBFS or FAT area of the .nds file, the binary must be less than 4MB which is the total size of main memory.
<br/>
<br/>
Please correct me if I am wrong.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131515 - zeruda - Sat Jun 16, 2007 7:02 pm</h4>
    <div class="postbody"><span class="postbody">GBFS works fine for me on my R4. Why do people say it's incompatile with slot-1 devices?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131520 - tepples - Sat Jun 16, 2007 9:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>zeruda wrote:</b></span></td> </tr> <tr> <td class="quote">GBFS works fine for me on my R4. Why do people say it's incompatile with slot-1 devices?</td> </tr></table><span class="postbody">
<br/>
Does <span style="font-style: italic">appended</span> GBFS work on SLOT-1 or GBAMP? Sure, you can load a GBFS file into RAM, or you can load objects from a GBFS, but then how does a program find its GBFS file?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131532 - gyokimae - Sat Jun 16, 2007 11:43 pm</h4>
    <div class="postbody"><span class="postbody">Following tutorials, I've padded the original .nds file and
<br/>
<span style="font-style: italic">cat original.nds images.gbfs &gt; final.nds</span>
<br/>
Is this what could be called appended GBFS?
<br/>
<br/>
Only from trying have I figured out that gbfs_get_obj() returns a file size of zero while all worked as I expected on NO$GBA.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131534 - tepples - Sun Jun 17, 2007 12:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote">Following tutorials, I've padded the original .nds file and
<br/>
<span style="font-style: italic">cat original.nds images.gbfs &gt; final.nds</span>
<br/>
Is this what could be called appended GBFS?</td> </tr></table><span class="postbody">
<br/>
Yes. It does not work on SLOT-1.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Only from trying have I figured out that gbfs_get_obj() returns a file size of zero while all worked as I expected on NO$GBA.</td> </tr></table><span class="postbody">
<br/>
How are you calling it?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131539 - gyokimae - Sun Jun 17, 2007 2:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">How are you calling it?</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't have the code on hand as I have been sandboxing with one .c file and not leaving prior versions.
<br/>
However I do believe I wasn't doing anything obscure.
<br/>
<br/>
Running
<br/>
gbfs_get_obj(targeToStore, "fileNameToLoad", sizeOfFile)
<br/>
<br/>
I would then iprintf() the sizeOfFile to console.
<br/>
<br/>
Under NO$GBA, the sizeOfFile is returned properly and
<br/>
I have not trouble manipulating loaded data.
<br/>
<br/>
On the real machine, printing sizeOfFile shows zero and
<br/>
accessing the loaded data gives me a black screen which
<br/>
I guess is an internal crash.
<br/>
<br/>
<br/>
I hope this response is not too obvious to tepples.
<br/>
Maybe this is all cheese cake to those who know the background
<br/>
enough to understand the deal about certain loaders being able
<br/>
to access argv[0]. I am not yet fluent with the architecture
<br/>
and which parts of the library are more likely "workarounds"
<br/>
designed by unofficial developpers.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131555 - tepples - Sun Jun 17, 2007 8:18 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote">On the real machine, printing sizeOfFile shows zero and
<br/>
accessing the loaded data gives me a black screen which
<br/>
I guess is an internal crash.</td> </tr></table><span class="postbody">
<br/>
What is the return value from find_first_gbfs_file() ? Are you making sure to red-screen if it returns 0? It's possible that NO$GBA emulates a SLOT-2 card, not a SLOT-1 card.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131571 - Lick - Sun Jun 17, 2007 2:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Why would you want to do this?</td> </tr></table><span class="postbody">
<br/>
My understanding is that unless you store data in the GBFS or FAT area of the .nds file, the binary must be less than 4MB which is the total size of main memory.
<br/>
<br/>
Please correct me if I am wrong.</span></td> </tr></table><span class="postbody">
<br/>
That doesn't mean you have to store everything in ONE file. Just use FAT and drop archiving.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131575 - tepples - Sun Jun 17, 2007 2:52 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">Just use FAT and drop archiving.</td> </tr></table><span class="postbody">
<br/>
And watch internal fragmentation bloat your assets by an order of magnitude when a unit with 16x16 pixel 4-bit sprite cels and 16 frames of animation (16*16*4/8*16 = 2048 bytes) takes 16384 bytes on a 1 GB card due to FAT's lack of <a class="postlink" href="http://en.wikipedia.org/wiki/Tail_packing" target="_blank">tail packing</a> and the SuperCard menu's limit of 65,500-some clusters per volume.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131581 - Lick - Sun Jun 17, 2007 3:16 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">Just use FAT and drop archiving.</td> </tr></table><span class="postbody">
<br/>
And watch internal fragmentation bloat your assets by an order of magnitude when a unit with 16x16 pixel 4-bit sprite cels and 16 frames of animation (16*16*4/8*16 = 2048 bytes) takes 16384 bytes on a 1 GB card due to FAT's lack of <a class="postlink" href="http://en.wikipedia.org/wiki/Tail_packing" target="_blank">tail packing</a> and the SuperCard menu's limit of 65,500-some clusters per volume.</span></td> </tr></table><span class="postbody">
<br/>
Just use FAT and drop archiving.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131583 - tepples - Sun Jun 17, 2007 3:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">Just use FAT and drop archiving.</td> </tr></table><span class="postbody">
<br/>
And watch internal fragmentation bloat your assets by an order of magnitude when a unit with 16x16 pixel 4-bit sprite cels and 16 frames of animation (16*16*4/8*16 = 2048 bytes) takes 16384 bytes on a 1 GB card due to FAT's lack of <a class="postlink" href="http://en.wikipedia.org/wiki/Tail_packing" target="_blank">tail packing</a> and the SuperCard menu's limit of 65,500-some clusters per volume.</span></td> </tr></table><span class="postbody">
<br/>
Just use FAT and drop archiving.</span></td> </tr></table><span class="postbody">
<br/>
You said that already. What did you mean by repeating it?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131616 - gyokimae - Sun Jun 17, 2007 11:26 pm</h4>
    <div class="postbody"><span class="postbody">FAT will probably work just fine for games&amp;apps I write for myself.
<br/>
<br/>
Again, please correct me if I am wrong...
<br/>
<br/>
In order to access external files, different methods must be applied depending on the card you use... correct?
<br/>
<br/>
And in order to overcome this, either I must provide multiple binaries supporting different cards, or else I the user needs to apply a DLDI patch on their end after downloading... correct? (I currently understand that that is the whole purpose of the DLDI libraries)
<br/>
<br/>
Since the data I want to use is static, it would be a lot niftier if I could have them download a single file that contained all data.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131618 - tepples - Mon Jun 18, 2007 1:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gyokimae wrote:</b></span></td> </tr> <tr> <td class="quote">please correct me if I am wrong...
<br/>
<br/>
In order to access external files, different methods must be applied depending on the card you use... correct?</td> </tr></table><span class="postbody">
<br/>
Yes, but DLDI hides this all.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">And in order to overcome this, either I must provide multiple binaries supporting different cards, or else I the user needs to apply a DLDI patch on their end after downloading... correct?</td> </tr></table><span class="postbody">
<br/>
Right, and with the DLDI Right Click shell extension for Windows, the majority of users can just copy the .nds to the card and patch it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Since the data I want to use is static, it would be a lot niftier if I could have them download a single file that contained all data.</td> </tr></table><span class="postbody">
<br/>
Lick would want you to have the user download a single file in PKZIP format and then unzip it to the card first.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131619 - chuckstudios - Mon Jun 18, 2007 2:03 am</h4>
    <div class="postbody"><span class="postbody">Why can't you just use EFS? It's pretty much the logical evolution of GBFS, which seems to be your ideal method.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#131673 - gyokimae - Tue Jun 19, 2007 12:16 am</h4>
    <div class="postbody"><span class="postbody">chuckstudios,
<br/>
<br/>
Thanks for the advise.
<br/>
<br/>
This is probably all good for practicle use.
<br/>
<br/>
I guess my interest was partially on the technical aspect rather than practical, on how close the current homebrew development technology was to the designs of official roms.
<br/>
<br/>
Reading the code of EFS, I did get the impression that it yet relies on attaining the name of the currently launched .nds file by iterating files and directories in order to find the starting address of stored data.
<br/>
<br/>
For future reference, I am interested in learning if EFS is yet another method which my become deprecated or require additions when future changes are made to the flash cards.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
