<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>3D Questions - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > 3D Questions</h2>
<div id="posts">
<div class="post">
    <h4>#115549 - The_Perfection - Wed Jan 17, 2007 2:23 am</h4>
    <div class="postbody"><span class="postbody">Hello all,
<br/>
<br/>
I have recently started devving for the NDS (not giving up on the GBA though) and have started playing around with the OpenGL-ish interface to get various 3-dimensional things moving on the screen.  I have run into a few problems though and thought you guys might be able to help.
<br/>
<br/>
Lighting:
<br/>
I realize that the lighting is done with one sign and nine bits of fractional parts as a vector to determine which way the light is going.  So would (in x, y, z)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">0x201, 0x201, 0x201</td> </tr></table><span class="postbody">
<br/>
be the same as 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">0x3FF, 0x3FF, 0x3FF</td> </tr></table><span class="postbody">
<br/>
Since it is a vector, that's what I'm thinking, but I'm not sure since we haven't delt with vectors in my math class yet.  (Although I did gleam much information from TONC.)
<br/>
<br/>
Normals:
<br/>
I know that normals are extremely useful little things when it comes to lighting, but I don't know how to calculate them.  I know it has to be done in the order the points were created, but don't know the actual math behind the little critters.
<br/>
My friend also thought that I might be getting weird shading because the normals have to be calculated every frame.  Do they? or do they automatically adjust when the figure is rotated?  (Like I think they do...)
<br/>
<br/>
Texture Mapping:
<br/>
I actually haven't attempted to texture map anything yet, but the reason I haven't is because I don't fully understand the process.  I looked at the NeHe tutorial and they use a function to add the textures from a pcx file.  What are the steps if I wanted to do it from an image binary?
<br/>
<br/>
<br/>
I'm pretty sure there's more than that, but I can't remeber it right now.
<br/>
<br/>
Wii thank you in Advance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115585 - Lick - Wed Jan 17, 2007 1:39 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Vectors:</span> these can display direction AND length. (5, 5, 5) != (6, 6, 6) because the lengths differ, while the directions match.
<br/>
<br/>
<span style="font-weight: bold">Normals:</span> these only display direction, and the calculated length is always 1. Vectors (5, 5, 5) == (6, 6, 6) when converted to normals, because <span style="font-style: italic">normalized</span>, the lengths are 'removed' and the directions match.
<br/>
* normalization is the act of dividing a vector by it's length. By doing that, you remove the length, leaving you with only a direction; a normal.
<br/>
<br/>
<span style="font-weight: bold">Texture Mapping:</span> you simply copy the image-data into memory, but in the correct format. Then you tell the system what format the texture is in (make sure it matches with the actual data), so it can render that texture.
<br/>
<br/>
I probably made some mistakes while explaining.. Feel free to correct!
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115589 - hellfire - Wed Jan 17, 2007 3:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I know that normals are extremely useful little things when it comes to lighting, but I don't know how to calculate them.
<br/>
I know it has to be done in the order the points were created, but don't know the actual math behind the little critters. </td> </tr></table><span class="postbody">
<br/>
the normal-vector is perpendicular to the surface.
<br/>
you can calculate a perpendicular from two given directions using the <a class="postlink" href="http://en.wikipedia.org/wiki/Cross_product" target="_blank">cross-product</a>.
<br/>
since triangles consist of three points (v1 v2 v3), the two surface-directions are given: v2-v1 and v3-v1
<br/>
- so you can easily compute the normal of a triangle.
<br/>
<br/>
as you want to specify normals per vertex (interpolated lighting, see <a class="postlink" href="http://en.wikipedia.org/wiki/Gouraud_shading" target="_blank">gouraud shading</a>), you can simply average the normals of all triangles sharing a single vertex, thus resulting in the normal vector at this particular point.
<br/>
if you are loading your geometry from a standard file-format, per-vertex-normals are usually stored along.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Normals: [...] the calculated length is always 1</td> </tr></table><span class="postbody">
<br/>
the normal (in the mathematical sense) does not require to be normalized,  but is usually assumed to be normalized to simplify lighting-calculations.<br/>_________________<br/>"The three chief virtues of a programmer are: Laziness, Impatience and Hubris"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115597 - silent_code - Wed Jan 17, 2007 6:52 pm</h4>
    <div class="postbody"><span class="postbody">... and you don't need to calculate them every frame ;) that would be an awlful lot of work... usually, if you use skinned meshes, you simply transform normals along with vertices, but don't recalculate them.
<br/>
btw: make sure you transform a copy, not the original data.
<br/>
<br/>
happy coding</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115609 - The_Perfection - Wed Jan 17, 2007 8:52 pm</h4>
    <div class="postbody"><span class="postbody">Thanks Lick, but you told me stuff I already knew.  I knew about the vectors and their direction and magnitude, but I thought that the lighting vectors were unit vectors, allowing what I had stated to be the same.  It would of come out to (-1,-1,-1) and (-511,-511,-511,) which would still point the same direction, and since I do think it is a unit vector, (technically values can't go above 1) what I had posted would still point the same direction, would it not?
<br/>
<br/>
I also knew that normals were, at most, a value of one in any direction, but I was asking how to calculate a normal, as hellfire explained.  So all I need to do is calculate the cross product of those two directions on a polygon and divide by it's length to get the normal, yes or no?
<br/>
<br/>
Oh yes, that brings up another question, not neccessarily related to 3D...
<br/>
<span style="font-weight: bold">Pre-Calculations</span>:
<br/>
If I were to create an array that will not be modified and put in some conversion factors, (such as floattov10() or a division for example,) would they be pre-calculated and placed into the binary file as an array, or would it call the function for each position in the array as it was accessed?
<br/>
<br/>
Once again with the texture mapping, I knew it had to be in the proper format and in the right area; I was more asking <span style="font-style: italic">what</span> format it had to be in and <span style="font-style: italic">where</span> to put the data.  (I already know you have to allocate memory with a VRAM bank.)  
<br/>
<br/>
<br/>
Apologies for not being specific enough...
<br/>
<br/>
<br/>
And for the normals (silent_code,) you say not to recalculate them, so if I were to call a rotation, the normals would automatically adjust like the points would?  (Also, not working with skinned meshes yet, still getting the basics down.  (Or trying to at least...))  And I do know to use a copy of data if I want to modify something, but thanks anyways for the reminder.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115675 - hellfire - Thu Jan 18, 2007 9:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">So all I need to do is calculate the cross product of those two directions on a polygon and divide by it's length to get the normal, yes or no? </td> </tr></table><span class="postbody">
<br/>
to get the normal of a polygon: yes.
<br/>
everything else i could add here, would majorly interfere with this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">we haven't delt with vectors in my math class yet</td> </tr></table><span class="postbody"><br/>_________________<br/>"The three chief virtues of a programmer are: Laziness, Impatience and Hubris"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115694 - silent_code - Thu Jan 18, 2007 1:01 pm</h4>
    <div class="postbody"><span class="postbody">yes, the mesh will be light accordingly to the light direction, even if you rotate  it. that's the whole idea of hardware t&amp;l anyway. ;) my advise is to google for some simple (especially game specific) vector math. there are also a lot of good, easy to understand tutorials on normal calculations and how to get the job done fast.
<br/>
i once had a lighting demo that calculated normals on load time, but the whole thing looked like poop, so i've written an exporter for my model viewer. now i just load the precalculated data and everything looks fine.
<br/>
<br/>
for textures you best check out the libnds examples. then start writing a better texture loader (my demo crashes on loadpcx() - or whatever it is called). i'd go for a custom file format and just convert any files (.pcx, .tga, .png, .bmp, .whatever) into your format using some magic little tool (you would write it yourself - there are some good libs for image file loading, like devil, or something [i don't use any libs, but opengl and openal, so i don't care about names] that eat a lot of standard formats).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#115721 - The_Perfection - Thu Jan 18, 2007 6:10 pm</h4>
    <div class="postbody"><span class="postbody">I understand vectors easily enough... I just don't have the common sense behind them like most people who actually deal with this stuff all the time do.  I already know several examples for video game vectors, such as:
<br/>
Character movement
<br/>
Projectile movement
<br/>
Image compression (for circles, lines, squares and the like)
<br/>
Path following
<br/>
(More) Realistic gravity
<br/>
and I think... Collision detection
<br/>
<br/>
As for the pre-calculations... have a look at this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//In other.cpp
<br/>
v10 arry[3] = {
<br/>
    0x100, 0x060, 0x003,
<br/>
}
<br/>
<br/>
v10 ar2[2] = {
<br/>
    arry[0]/arry[2], floattov10(-2),
<br/>
}</td> </tr></table><span class="postbody">
<br/>
Would ar2 be calculated at compile time or not?
<br/>
<br/>
Oh yes, feel free to teach me something I don't know, especially if it pertains to math or science.  It just makes it easier when I actually <span style="font-style: italic">have</span> to learn it.
<br/>
<br/>
Oh, and I had forgotten to look at those examples that weren't in NeHe.  I'll make sure to go and check them out ASAP.
<br/>
<br/>
&lt;NervousLaugh&gt;Yeah... about writing my own tool... I'm pretty sure I could write one... but my PC C++ skills aren't all they really should be.  (I wrote a RLE compressor/decompressor once.  The compressor worked fine; the decompressor not so much.)  But I can file handle and I should be able to work off of that.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
