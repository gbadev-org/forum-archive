<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>DSWifi: the perfect connection - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > DSWifi: the perfect connection</h2>
<div id="posts">
<div class="post">
    <h4>#100320 - Lick - Sun Aug 27, 2006 10:56 am</h4>
    <div class="postbody"><span class="postbody">I wonder if there's a way to always be sure that dswifi connects.. If this is a internal hanging bug, then there's little we can do about it. But I've found that the following function does the job pretty good, but still hangs quite often.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">bool NDSX_DSWifi_ConnectAP()
<br/>
{
<br/>
    Wifi_EnableWifi();
<br/>
    Wifi_AutoConnect();
<br/>
    while(1) 
<br/>
    {
<br/>
        scanKeys();
<br/>
        if(keysDown() &amp; KEY_B)
<br/>
            return false;
<br/>
<br/>
       int stat = Wifi_AssocStatus();
<br/>
<br/>
       if(stat == ASSOCSTATUS_ASSOCIATED) 
<br/>
        {
<br/>
          return (ConnectedToAP=true);
<br/>
        }
<br/>
<br/>
       if(stat == ASSOCSTATUS_CANNOTCONNECT) 
<br/>
        {
<br/>
            ConnectedToAP = false;
<br/>
            swiWaitForVBlank();
<br/>
            Wifi_AutoConnect();
<br/>
        }
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I'm guessing that it's internal to DsWifi though.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100335 - kevinc - Sun Aug 27, 2006 12:22 pm</h4>
    <div class="postbody"><span class="postbody">From my experience, Wifi_AssocStatus() can spontaneously return ASSOCSTATUS_CANNOTCONNECT in the middle of authentication; so even a value of 6 doesn't immediately imply that the association failed.<br/>_________________<br/><a class="postlink" href="http://akzeac.blogspot.com" target="_blank">http://akzeac.blogspot.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100410 - sgstair - Sun Aug 27, 2006 7:26 pm</h4>
    <div class="postbody"><span class="postbody">Lick: That code will not return at all if the wifi lib is unable to connect; so it's not possible to tell if it's the wifi lib "hanging" - what is possible is that the lib might be desyncing from the packet buffer (because of malformed packets in your area - but I can't be sure of this yet. - I'll look into it further.
<br/>
<br/>
kevinc: I've never seen that happen, and don't really see how it could happen...
<br/>
if it does happen to you though, would you be willing to help me track down the problem?
<br/>
<br/>
-Stephen<br/>_________________<br/><a class="postlink" href="http://blog.akkit.org/" target="_blank">http://blog.akkit.org/</a> - <a class="postlink" href="http://www.akkit.org/dswifi/" target="_blank">http://www.akkit.org/dswifi/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100415 - kevinc - Sun Aug 27, 2006 7:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgstair wrote:</b></span></td> </tr> <tr> <td class="quote">kevinc: I've never seen that happen, and don't really see how it could happen...
<br/>
if it does happen to you though, would you be willing to help me track down the problem?
<br/>
<br/>
-Stephen</td> </tr></table><span class="postbody">
<br/>
<br/>
You're right, it doesn't :). I'm sorry, I was confusing ASSOCSTATUS_CANNOTCONNECT and ASSOCSTATUS_DISCONNECTED.<br/>_________________<br/><a class="postlink" href="http://akzeac.blogspot.com" target="_blank">http://akzeac.blogspot.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100417 - Lick - Sun Aug 27, 2006 8:15 pm</h4>
    <div class="postbody"><span class="postbody">Sgstair and I figured that it's prolly swiWaitVBlank() that's stalling. But without it, the LED goes weird. Strange..<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
