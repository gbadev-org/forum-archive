<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>mario dumped! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > mario dumped!</h2>
<div id="posts">
<div class="post">
    <h4>#34951 - darkfader - Fri Jan 28, 2005 5:27 pm</h4>
    <div class="postbody"><span class="postbody">&lt;deleted&gt;</span><span class="gensmall"><br/><br/>Last edited by darkfader on Tue Mar 01, 2005 8:37 pm; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#34952 - darkfader - Fri Jan 28, 2005 5:30 pm</h4>
    <div class="postbody"><span class="postbody">&lt;deleted&gt;</span><span class="gensmall"><br/><br/>Last edited by darkfader on Tue Mar 01, 2005 8:36 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#34969 - Abscissa - Fri Jan 28, 2005 7:54 pm</h4>
    <div class="postbody"><span class="postbody">Geez, that's a lot of files :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34971 - fagotero - Fri Jan 28, 2005 8:19 pm</h4>
    <div class="postbody"><span class="postbody">Nice news!  ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34972 - DiscoStew - Fri Jan 28, 2005 8:23 pm</h4>
    <div class="postbody"><span class="postbody">Yeah compared to the Metroid: First Hunt, and that was just a demo.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34983 - Darkain - Fri Jan 28, 2005 10:35 pm</h4>
    <div class="postbody"><span class="postbody">using the nds model viewer, right now we cant view anything in this dump.  why?  every single file is LZ77 compressed.  NOT the same as ZIP, nintendo likes doing things their own way.  ;)
<br/>
<br/>
so, if someone could figure out their compression method, and integrate this into the model viewer, that would be sweet.<br/>_________________<br/>-=- Darkain Dragoon -=-
<br/>
<a class="postlink" href="http://www.darkain.com" target="_blank">http://www.darkain.com</a>
<br/>
<a class="postlink" href="http://ds.darkain.com/hack" target="_blank">DarkStar</a> for <a class="postlink" href="http://ds.darkain.com" target="_blank">Nintendo DS</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34993 - ryuryan - Sat Jan 29, 2005 2:27 am</h4>
    <div class="postbody"><span class="postbody">This is designed to decompress LZ77 pictures from pokemon games,
<br/>
might work straight out or need to be slightly modified.
<br/>
<br/>
<a href="http://www.zophar.net/utilities/download/PokePic-win32-bin.zip" target="_blank">http://www.zophar.net/utilities/download/PokePic-win32-bin.zip</a>
<br/>
<a href="http://www.zophar.net/utilities/download/PokePic-src.zip" target="_blank">http://www.zophar.net/utilities/download/PokePic-src.zip</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34994 - MumblyJoe - Sat Jan 29, 2005 3:01 am</h4>
    <div class="postbody"><span class="postbody">Totally good work man. Wanna share any details about why you couldn't do it when you did metroid and how you overcame those problems?<br/>_________________<br/><a class="postlink" href="http://www.hungrydeveloper.com" target="_blank">www.hungrydeveloper.com</a>
<br/>
Version 2.0 now up - guaranteed at least 100% more pleasing!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35012 - SeKuM - Sat Jan 29, 2005 11:02 am</h4>
    <div class="postbody"><span class="postbody">I'm amazed.
<br/>
<br/>
What is the size of the rom ?!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35056 - Touchstone - Sat Jan 29, 2005 10:59 pm</h4>
    <div class="postbody"><span class="postbody">Uuh, I haven't played this game yet but <span style="font-style: italic">\data\enemy\peach\</span>? Is this Princess Peach? I've never thought of her as an enemy before. :)<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35063 - tepples - Sat Jan 29, 2005 11:46 pm</h4>
    <div class="postbody"><span class="postbody">You've never played Smash Bros. against somebody who can beat 3 teamed level 9 CPUs with Peach.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35073 - NMcCoy - Sun Jan 30, 2005 2:33 am</h4>
    <div class="postbody"><span class="postbody">I wonder what the odds are that someone will find a way to export the models and maps to a popular first-person-shooter model format...?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35083 - netdroid9 - Sun Jan 30, 2005 4:45 am</h4>
    <div class="postbody"><span class="postbody">I suddenly want to import a whole lot of quake 3 weapons as shell models for some reason.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35244 - CoolkcaH - Wed Feb 02, 2005 12:05 am</h4>
    <div class="postbody"><span class="postbody">What's the size of the dump?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35252 - DiscoStew - Wed Feb 02, 2005 3:35 am</h4>
    <div class="postbody"><span class="postbody">Why do many people want to know the size of the dump anyways? I feel it is kinda irrelevent ATM.
<br/>
<br/>
If anything, I'd like to know the format and size of the raw 3D models and animation schemes, a good average poly-count on in-game models, etc, just so I would know what I can work with when the time comes when we all can do some actual DS programming.
<br/>
I'm starting to get the itch of trying (once again) to learn how to use Lightwave, just so that I can get a head start.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35257 - dagamer34 - Wed Feb 02, 2005 5:25 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DiscoStew wrote:</b></span></td> </tr> <tr> <td class="quote">Why do many people want to know the size of the dump anyways? I feel it is kinda irrelevent ATM.
<br/>
<br/>
If anything, I'd like to know the format and size of the raw 3D models and animation schemes, a good average poly-count on in-game models, etc, just so I would know what I can work with when the time comes when we all can do some actual DS programming.
<br/>
I'm starting to get the itch of trying (once again) to learn how to use Lightwave, just so that I can get a head start.</td> </tr></table><span class="postbody">
<br/>
<br/>
Get a feel for the system in general and such. Or maybe to know what kind of game sizes we expect to be dealing with. I mean, Super mario 64 DS is just as large as the Metroid Prime demo. And it's only a demo, not the full game.
<br/>
<br/>
It could be a number of things though; i don't feel like thinking up more.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35306 - CoolkcaH - Wed Feb 02, 2005 9:19 pm</h4>
    <div class="postbody"><span class="postbody">Found this gba LZSS decompression program:
<br/>
<a href="http://www.geocities.com/dkl_74/" target="_blank">http://www.geocities.com/dkl_74/</a>
<br/>
but it's in ARM assembly...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#35353 - bertsnks - Thu Feb 03, 2005 3:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef   unsigned char         u8;
<br/>
typedef   unsigned short int      u16;
<br/>
typedef   unsigned int         u32;
<br/>
<br/>
typedef   signed char            s8;
<br/>
typedef   signed short int      s16;
<br/>
typedef   signed int            s32;
<br/>
<br/>
int main(int argc, char* argv[])
<br/>
{
<br/>
   printf("Nintendo LZ77 unpacker\n");
<br/>
   printf("----------------------\n");
<br/>
<br/>
   FILE *fin, *fout;
<br/>
<br/>
   fin = fopen(argv[1],"rb");
<br/>
   fout = fopen(argv[2],"wb");
<br/>
<br/>
   u8 header, b;
<br/>
   u32 size=0;
<br/>
<br/>
   fread(&amp;header, sizeof(u8), 1, fin);
<br/>
   fread(&amp;b, sizeof(u8), 1, fin);
<br/>
   size+=b&lt;&lt;0;
<br/>
   fread(&amp;b, sizeof(u8), 1, fin);
<br/>
   size+=b&lt;&lt;8;
<br/>
   fread(&amp;b, sizeof(u8), 1, fin);
<br/>
   size+=b&lt;&lt;16;
<br/>
<br/>
   printf("Header: $%02x (%s)\n", header, (header&amp;0xf0)!=0x10?"INCORRECT":"NINTENDO LZ77");
<br/>
   printf("Uncompressed size: %d\n", size);
<br/>
<br/>
   u8 *unpacked = new u8[size];
<br/>
   u8 *begin = unpacked;
<br/>
   u8 *end = unpacked + size;
<br/>
<br/>
   u32 compsize = 0;
<br/>
<br/>
<br/>
   while(begin &lt; end)
<br/>
   {
<br/>
      u8 flag;
<br/>
      fread(&amp;flag, sizeof(u8), 1, fin);
<br/>
      compsize++;
<br/>
<br/>
      for(int i=7;i&gt;=0;i--)
<br/>
      {
<br/>
         if ( (flag &amp; (1&lt;&lt;i)) == 0 )
<br/>
         {
<br/>
            u8 byte;
<br/>
            fread(&amp;byte, sizeof(u8), 1, fin);
<br/>
            compsize++;
<br/>
<br/>
            *begin++ = byte;
<br/>
            if (begin &gt;= end)
<br/>
               break;            
<br/>
         }
<br/>
         else
<br/>
         {
<br/>
            u16 data;
<br/>
            fread(&amp;data, sizeof(u16), 1, fin);
<br/>
            compsize+=2;
<br/>
<br/>
            data = (data&gt;&gt;8) | ((data&lt;&lt;8)&amp;0xff00);
<br/>
            int length = 3+(data&gt;&gt;12);
<br/>
            int offset = (data&amp;0x0FFF);
<br/>
         
<br/>
            for(int j=0;j&lt;length;j++)
<br/>
            {
<br/>
               if (begin-offset-1 &lt; unpacked)
<br/>
                  *begin++ = 0;
<br/>
               else
<br/>
                  *begin++ = *(u8*)(begin-offset-1);
<br/>
               if (begin &gt;= end)
<br/>
                  break;
<br/>
            }
<br/>
         }
<br/>
      }
<br/>
<br/>
   }
<br/>
<br/>
<br/>
   fwrite(unpacked, sizeof(u8), size, fout);
<br/>
<br/>
   fclose(fin);
<br/>
   fclose(fout);
<br/>
<br/>
   int align = 4 - (compsize - (compsize &amp; ~3));
<br/>
<br/>
   printf("Compressed size: %d + %d (align) + %d (header) = %d\n", compsize, align, 4, compsize+4+align);
<br/>
<br/>
   printf("Done.\n");
<br/>
<br/>
<br/>
   delete[] unpacked;
<br/>
<br/>
   return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
