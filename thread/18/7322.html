<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>atan2 on DS? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > atan2 on DS?</h2>
<div id="posts">
<div class="post">
    <h4>#59044 - Extreme Coder - Fri Oct 28, 2005 11:29 am</h4>
    <div class="postbody"><span class="postbody">Hi. I've been looking for the trigonometry function "atan2" on the ds, but with no luck. AFAIK, the GBA had one in its bios,right? Because then I don't want to be forced to use math.h, since it would be much slower on the ds.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59054 - strager - Fri Oct 28, 2005 1:05 pm</h4>
    <div class="postbody"><span class="postbody">There is an SWI/BIOS call/function for atan2: SWI 10.  Here's how to use it (not sure if it's the best way, or if it works):
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Assumed to be compiled as ARM code
<br/>
int swi_atan2(int x, int y)
<br/>
{
<br/>
    int result;
<br/>
<br/>
    asm volatile(
<br/>
    "mov r0, %1\n"
<br/>
    "mov r1, %2\n"
<br/>
    "swi #0x000A0000\n"
<br/>
    "mov %0, r0"
<br/>
    : "=r" (result)
<br/>
    : "r" (x), "r" (y)
<br/>
    : "r0", "r1", "r2", "r3");
<br/>
};
<br/>
<br/>
// If you are using C this might work
<br/>
// Again, ARM is expected
<br/>
int swi_atan2_c(int x, int y)
<br/>
{
<br/>
    asm("swi #0x000A0000\n");
<br/>
};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>GBATek Specifications wrote:</b></span></td> </tr> <tr> <td class="quote"><span style="font-weight: bold">SWI 10 (0Ah) - ArcTan2</span>
<br/>
Calculates the arc tangent after correction processing.
<br/>
Use this in normal situations.
<br/>
<br/>
<span style="font-style: italic">  r0   X, 16bit (1bit sign, 1bit integral part, 14bit decimal part)</span>
<br/>
<span style="font-style: italic">  r1   Y, 16bit (1bit sign, 1bit integral part, 14bit decimal part)</span>
<br/>
<br/>
Return:
<br/>
<br/>
<span style="font-style: italic">  r0   0000h-FFFFh for 0&lt;=THETA&lt;2PI.</span>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Hope this helps!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59059 - Extreme Coder - Fri Oct 28, 2005 3:32 pm</h4>
    <div class="postbody"><span class="postbody">Thanks strager. But this is for the DS,right? Just want to make sure since you mention GBATek there, I'm guessing there might be a difference in the DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59080 - strager - Fri Oct 28, 2005 9:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Extreme Coder wrote:</b></span></td> </tr> <tr> <td class="quote">Thanks strager. But this is for the DS,right? Just want to make sure since you mention GBATek there, I'm guessing there might be a difference in the DS.</td> </tr></table><span class="postbody">
<br/>
Yes, it is for the DS.  That function, as well as some others, are the same as in the GBA.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59123 - Extreme Coder - Sat Oct 29, 2005 9:34 am</h4>
    <div class="postbody"><span class="postbody">Thanks strager, I just had my doubts that it wouldn't be in the DS bios since it isnt mentioned anywhere in NDSTech Wiki, or DSTek.
<br/>
<br/>
I will try it anyway.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59185 - Joat - Sun Oct 30, 2005 3:33 am</h4>
    <div class="postbody"><span class="postbody">I don't mention it anywhere on the wiki, because it doesn't exist!
<br/>
<br/>
Quoth the revevant portion of the ARM9 bios, nevermore:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">swiTable:
<br/>
.word   swi00_SoftReset
<br/>
.word   0x00000000   @ 01
<br/>
.word   0x00000000   @ 02
<br/>
.word   swi03_Delay|1
<br/>
.word   swi04_IntrWait
<br/>
.word   swi05_WaitForVBlank
<br/>
.word   swi06_WaitForIRQ
<br/>
.word   0x00000000   @ 07
<br/>
.word   0x00000000   @ 08
<br/>
.word   swi09_Divide
<br/>
.word   0x00000000   @ 0A
<br/>
.word   swi0B_CpuSet|1
<br/>
.word   swi0C_CpuFastSet
<br/>
.word   swi0D_Sqrt
<br/>
.word   swi0E_CRC16|1
<br/>
.word   swi0F_IsDebugger|1
<br/>
<br/>
.word   swi10_UnpackBits
<br/>
.word   swi11_DecompressLZSSWram
<br/>
.word   swi12_DecompressLZSSVram|1
<br/>
.word   swi13_DecompressHuffman|1
<br/>
.word   swi14_DecompressRLEWram|1
<br/>
.word   swi15_DecompressRLEVram|1
<br/>
.word   swi16_DecodeDelta8|1
<br/>
.word   0x00000000   @ 17
<br/>
.word   swi18_DecodeDelta16|1
<br/>
.word   0x00000000   @ 19
<br/>
.word   0x00000000   @ 1a
<br/>
.word   0x00000000   @ 1b
<br/>
.word   0x00000000   @ 1c
<br/>
.word   0x00000000   @ 1d
<br/>
.word   0x00000000   @ 1e
<br/>
.word   swi1F_SetHaltCR|1</td> </tr></table><span class="postbody">
<br/>
<br/>
Notice the hole at swi 0x0A with an entry of zero.  Bad things will happen if you call it.<br/>_________________<br/>Joat
<br/>
<a href="http://www.bottledlight.com" target="_blank">http://www.bottledlight.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#59193 - tepples - Sun Oct 30, 2005 5:57 am</h4>
    <div class="postbody"><span class="postbody">Then it might have been clearer to mention the holes themselves.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
