<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Texture format and vertex math - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Texture format and vertex math</h2>
<div id="posts">
<div class="post">
    <h4>#40313 - Locke - Sun Apr 17, 2005 12:31 pm</h4>
    <div class="postbody"><span class="postbody">Hi, I started messing up whith my DS and ndslib yesterday, and I have some begginer questions...
<br/>
<br/>
I can't figure out the texture format nds uses, so I checked the textured cube example and tried to replace the texture.bin included with my own texture.bin (raw, same size and 16 bit). Didn't work, I only get a black and grey model.
<br/>
<br/>
I beleive that the problem is the raw format I'm using. Is there any tool to convert a 24bit bmp to the appropiate raw format?
<br/>
<br/>
<br/>
<br/>
Why DS can't handle v16 math? I was trying to calculate some normal tables at loading time...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40316 - FeaRog - Sun Apr 17, 2005 2:28 pm</h4>
    <div class="postbody"><span class="postbody">The textures are in the following format:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">ABBBBBGGGGGRRRRR
<br/>
</td> </tr></table><span class="postbody">
<br/>
But because of the endian-ness it'll look like this in memory:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Byte n   Byte n+1
<br/>
GGGRRRRR ABBBBBGG</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40319 - ector - Sun Apr 17, 2005 2:36 pm</h4>
    <div class="postbody"><span class="postbody">Yeah but that will happen automatically if you write 16-bit values straigt to a file since PC is little-endian too.
<br/>
<br/>
And remember to put a 1 in the A bit.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40325 - tepples - Sun Apr 17, 2005 4:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ector wrote:</b></span></td> </tr> <tr> <td class="quote">Yeah but that will happen automatically if you write 16-bit values straigt to a file since PC is little-endian too.</td> </tr></table><span class="postbody">
<br/>
The Mac is not little-endian. If you plan to release your tools as free software or if you envision porting your tools to another platform, please make them handle data byte-by-byte rather than using chance coincidences to serialize data.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40328 - FeaRog - Sun Apr 17, 2005 4:32 pm</h4>
    <div class="postbody"><span class="postbody">What he said ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40358 - Locke - Sun Apr 17, 2005 11:18 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I think I got it (although sometimes I get a blue-like texture...).
<br/>
<br/>
Another question: texture coordinates range from 0 to (TEX_WIDTH - 1) and 0 to (TEX_HEIGHT - 1), do they? Im getting weird texture mapping and I can't figure out the reason...
<br/>
<br/>
<a href="http://www.filespace.org.nyud.net:8090/Locke/ogre_ds.png">[Images not permitted - Click here to view it]</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#40388 - Locke - Mon Apr 18, 2005 9:54 am</h4>
    <div class="postbody"><span class="postbody">I finally made it. Now we have... YET ANOTHER MD2 VIEWER!! &gt;_&lt;
<br/>
<br/>
I don't feel like releasing at the moment, as it is not a very interesting  piece of code. It was just a little practicing for me.
<br/>
<br/>
Thanks for the help. ;)
<br/>
<br/>
<a class="postlink" href="http://www.filespace.org.nyud.net:8090/Locke/ogre_ds2.jpg" target="_blank">http://www.filespace.org.nyud.net:8090/Locke/ogre_ds2.jpg</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41628 - Locke - Sat Apr 30, 2005 1:43 pm</h4>
    <div class="postbody"><span class="postbody">Another question about textures. I want to use 2 at a time on the screen. One for the model and one for the bg.
<br/>
<br/>
I initialize my textures as follows:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int textures[2];
<br/>
<br/>
vramSetBankA(VRAM_A_TEXTURE);
<br/>
<br/>
glGenTextures(2, &amp;textures[0]);
<br/>
glBindTexture(0, textures[0]);
<br/>
glTexImage2D(0, 0, GL_RGB, TEXTURE_SIZE_128 , TEXTURE_SIZE_128, 0, 0, (u8*)model_tex);
<br/>
glBindTexture(0, textures[1]);
<br/>
glTexImage2D(0, 0, GL_RGB, TEXTURE_SIZE_64, TEXTURE_SIZE_64, 0, 0, (u8*)bg_tex);</td> </tr></table><span class="postbody">
<br/>
<br/>
And with this lines inside my main loop:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">glBindTexture(0, textures[0]);
<br/>
DrawModel();
<br/>
glBindTexture(0, textures[1]);
<br/>
DrawBg();</td> </tr></table><span class="postbody">
<br/>
<br/>
The textures[0] thing works fine, but second one looks like the first with messed sizes. Am I doing something wrong or is it just an emu/lib issue? I don't undestand very well how texture memory works, but I think that my code is correct...
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41634 - bluescrn - Sat Apr 30, 2005 3:48 pm</h4>
    <div class="postbody"><span class="postbody">Have you tried it on hardware?
<br/>
<br/>
I've got 2 textures (a 64x64 and a 128x128) working together on hardware, but it doesn't work in iDeaS. (iDeaS also seems to ignore texture alpha, as I found out when my polygons all disappeared on hardware...)
<br/>
<br/>
Another texture-related question, does the DS support U/V wrapping, and if so, does anyone know how to enable it?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41642 - mike260 - Sat Apr 30, 2005 6:16 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>bluescrn wrote:</b></span></td> </tr> <tr> <td class="quote">Another texture-related question, does the DS support U/V wrapping, and if so, does anyone know how to enable it?</td> </tr></table><span class="postbody">
<br/>
<br/>
When you load a texture, you can specify GL_TEXTURE_REPEAT_[S|T] to enable wrapping, otherwise I think you get clamping. The hardware also appears to support mirroring via GL_TEXTURE_FLIP_[S|T].</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41697 - rize - Sun May 01, 2005 8:17 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ector wrote:</b></span></td> </tr> <tr> <td class="quote">And remember to put a 1 in the A bit.</td> </tr></table><span class="postbody">
<br/>
<br/>
Why?  I was under the impression that a is for alpha and that generally you would want your alpha bits set to 0 unless you need alpha.
<br/>
<br/>
However, I mostly just made that up based on limited prior knowledge of the 8 alpha bits in 32 bit color (which I assumed were set to 0000 0000 for an opaque texture).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41705 - ector - Sun May 01, 2005 11:11 am</h4>
    <div class="postbody"><span class="postbody">With 8-bit alpha, 0 = completely transparent (nothing is drawn), not opaque.
<br/>
Same thing usually with 1-bit alpha</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
