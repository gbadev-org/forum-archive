<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>need help with collision detection - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > need help with collision detection</h2>
<div id="posts">
<div class="post">
    <h4>#92583 - AdamZZ - Fri Jul 14, 2006 12:09 am</h4>
    <div class="postbody"><span class="postbody">im making a Pong game for ds to learn how to make ds games but i cant make a collision detection. does this exist?
<br/>
if (PA_GetSpriteCollision(screen,sprite#1,sprite#2))
<br/>
{
<br/>
// code to be executed when coliding.
<br/>
}
<br/>
<br/>
<br/>
#1 = the sprite to use in my case ball that has the number3
<br/>
#2 = sprite to colide with</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92645 - Zed0 - Fri Jul 14, 2006 9:47 am</h4>
    <div class="postbody"><span class="postbody">No, that command doesn't work.
<br/>
If you are using PAlib then see <a class="postlink" href="http://www.palib.info/wiki/doku.php?id=day6#sprite_collisions" target="_blank">this</a> tutorial for collision detection, both rectangular and circular.<br/>_________________<br/><span style="text-decoration: underline">__Zed0__</span>
<br/>
FlasheMe'd Silver DS - GBAMP-CF - 512MB CF Card - R4DS - 2GB Micro SD Card</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92682 - AdamZZ - Fri Jul 14, 2006 1:09 pm</h4>
    <div class="postbody"><span class="postbody">when i tried it it didnt work :S can some1 post a collision code ? 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include &lt;PA9.h&gt;
<br/>
 
<br/>
// PAGfxConverter Include
<br/>
#include "gfx/all_gfx.c"
<br/>
#include "gfx/all_gfx.h"
<br/>
 
<br/>
int main(void){
<br/>
 
<br/>
   PA_Init(); //PAlib inits
<br/>
   PA_InitVBL();
<br/>
   
<br/>
   PA_LoadSpritePal(0, // Screen
<br/>
         1, // Palette number
<br/>
         (void*)paddle_Pal);   // Palette name
<br/>
               
<br/>
   PA_LoadSpritePal(0, // Screen
<br/>
         2, // Palette number
<br/>
         (void*)ball_Pal);   // Palette name
<br/>
               
<br/>
   PA_CreateSprite(0, // Screen
<br/>
         1, // Sprite number
<br/>
         (void*)paddle_Sprite, // Sprite name
<br/>
         OBJ_SIZE_8X32, // Sprite size
<br/>
         1, // 256 color mode
<br/>
         1, // Sprite palette number
<br/>
         243, 95); // X and Y position on the screen
<br/>
         
<br/>
   PA_CreateSprite(0, // Screen
<br/>
         3, // Sprite number
<br/>
         (void*)ball_Sprite, // Sprite name
<br/>
         OBJ_SIZE_8X8, // Sprite size
<br/>
         1, // 256 color mode
<br/>
         2, // Sprite palette number
<br/>
         127, 95); // X and Y position on the screen
<br/>
         
<br/>
   PA_CreateSprite(0, // Screen
<br/>
         2, // Sprite number
<br/>
         (void*)paddle_Sprite, // Sprite name
<br/>
         OBJ_SIZE_8X32, // Sprite size
<br/>
         1, // 256 color mode
<br/>
         1, // Sprite palette number
<br/>
         5, 95); // X and Y position on the screen
<br/>
 
<br/>
   while(1) // Infinite loops
<br/>
   {
<br/>
        PA_WaitForVBL(); 
<br/>
      
<br/>
      if(Stylus.Held == 1)
<br/>
      {
<br/>
         PA_SetSpriteXY(0,1,243,Stylus.Y);
<br/>
         PA_SetSpriteXY(0,2,5,Stylus.Y);
<br/>
      }
<br/>
   }
<br/>
return 0;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
this is the code i use to make the sprites and to move the two paddles
<br/>
please change this to make it work with the rectangle collision.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92697 - Zed0 - Fri Jul 14, 2006 3:58 pm</h4>
    <div class="postbody"><span class="postbody">Well for a start you're going to have to set up variables for each sprite saying where they are and their sizes, then get onto the collision code in same way as the tutorial I posted.
<br/>
BTW, no one is just going to do it for you.<br/>_________________<br/><span style="text-decoration: underline">__Zed0__</span>
<br/>
FlasheMe'd Silver DS - GBAMP-CF - 512MB CF Card - R4DS - 2GB Micro SD Card</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92715 - AdamZZ - Fri Jul 14, 2006 5:00 pm</h4>
    <div class="postbody"><span class="postbody">ok but how do i set varibles for the sprites??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92762 - naleksiev - Fri Jul 14, 2006 9:01 pm</h4>
    <div class="postbody"><span class="postbody">Hey I don't see your ball moving how you expect to have collisions. Try something more simple like this. I made you a collision detection with the screen bound. 
<br/>
<br/>
I hope I didn't messed up something :(
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define SCR_WIDTH 256
<br/>
#define SCR_HEIGHT 256
<br/>
#define BALL_DIAMETER 8
<br/>
<br/>
<br/>
....
<br/>
<br/>
int ballX =  127;
<br/>
int ballY = 95;
<br/>
int ballSpeedX = 1;
<br/>
int ballSpeedY = 1;
<br/>
int paddleX = 5;
<br/>
int paddleY;
<br/>
<br/>
while(1) // Infinite loops
<br/>
{
<br/>
     PA_WaitForVBL();
<br/>
<br/>
     ballX += ballSpeedX;
<br/>
     ballY += ballSpeedY;
<br/>
<br/>
     if (ballX &lt;= 0 || ballX &gt;= SCR_WIDTH - BALL_DIAMETER) 
<br/>
     {
<br/>
          ballSpeedX = -ballSpeedX;
<br/>
     }
<br/>
     if (ballY &lt;= 0 || ballY &gt;= SCR_HEIGHT - BALL_DIAMETER) 
<br/>
     {
<br/>
          ballSpeedY = -ballSpeedY;
<br/>
     }
<br/>
<br/>
     if(Stylus.Held == 1)
<br/>
     {
<br/>
          PA_SetSpriteXY(0,1,243,Stylus.Y);
<br/>
          PA_SetSpriteXY(0,2,5,Stylus.Y);
<br/>
<br/>
          PA_SetSpriteXY(3,2,ballX,ballY);
<br/>
<br/>
          paddleY = Stylus.Y;
<br/>
     }
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It's not so complex try to understand it and because you have the ballX, ballY, paddleX, paddleY you will be able to try to implement the collision with the paddle by your own. 
<br/>
<br/>
Next time show your collision code that you tried and it's not working and maybe more people will help you. Also if you realy wrote something probably it will be completly different from the code that someone will send to you and you will not be able to compare and find you misstake.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92788 - AdamZZ - Fri Jul 14, 2006 11:16 pm</h4>
    <div class="postbody"><span class="postbody">i didnt want to make the bal move until i got collision :S 
<br/>
<br/>
thanks for helping me :D
<br/>
<br/>
but that code doesnt work :S it when trying to build the nds it gives me a error on line 80 and line 80 is the } of while(1) whats wrong?
<br/>
main.c: error: expected declaration or statement at end of input (im not english im swedish) and i dont know what they mean :S
<br/>
<br/>
im sorry if im a little "give me more" type but im new to this and i need help. :S if you would be the one that needs help i would help you cause i know how it is to be new to something. (im a very good VB6 and Actionscript programmer) im not new to programing but im new to nds and it has some code thats similiar too actionscript (maybe cause actionscript is based on c and nds coding is made in c :D)
<br/>
<br/>
i guess that this is the code for collision on the paddle.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (ballX &lt;= paddleX &amp;&amp; ballY &gt;= paddleY - 32 &amp;&amp; ballY &lt;= paddleY )</td> </tr></table><span class="postbody"> (made a pong game in VB6 that uses the same code (well almost))</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92880 - naleksiev - Sat Jul 15, 2006 4:33 am</h4>
    <div class="postbody"><span class="postbody">About the error I think there is missing { or } in your code. I do not have PA_lib and I didn't try to compile the code that I gave to you. I check it againt and it looks fine to me. The best way to check for {} is if you always indent your code but for example I use Edit Plus to code some times and there is a shortcut Ctrl+] which you can use is when you are pointing on some bracket to go on the oposite one. I think most of the text editors that are made for developers support this shortcut :)
<br/>
<br/>
To start debuging by your self if you do not understand the error you can at least try to remove some of the lines. You just add about 10 lines and your code can't be compiled anymore just remove all and add them one by one to see what's wrong.
<br/>
<br/>
I'm glad you try to write something :) But I believe that your anchor point for the sprite must be the very left top point so the code will be like this.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (ballX &lt;= paddleX &amp;&amp; ballY &gt;= paddleY &amp;&amp; ballY &lt;= paddleY + 32)</td> </tr></table><span class="postbody">
<br/>
<br/>
I think the correct sequence is to write first the movement of the ball and then the collision. You can not test the collision if there's no object to collide.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92891 - Ant6n - Sat Jul 15, 2006 7:35 am</h4>
    <div class="postbody"><span class="postbody">rectangle collision should be 4 tests, if i remember right.
<br/>
i have something like
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(
<br/>
          (shipx+SHIPWIDTH &gt;= rockx) &amp;&amp; (rockx+rockwidth &gt;= shipx)
<br/>
    &amp;&amp;  (shipy+SHIPHEIGHT &gt;= rocky) &amp;&amp; (rocky+rockheight &gt;= shipy)
<br/>
)</td> </tr></table><span class="postbody">
<br/>
<br/>
in some code of mine. pls correct me if i am wrong, i tend to talk bs whenits late</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92904 - AdamZZ - Sat Jul 15, 2006 1:28 pm</h4>
    <div class="postbody"><span class="postbody">thanks :D im gonna delete everything line by line too see whats the problem just like you said :D
<br/>
<br/>
and now when i have almost no line i found the problem :D the main fuction didnt have a end curly bracket :S</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92906 - naleksiev - Sat Jul 15, 2006 2:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">rectangle collision should be 4 tests, if i remember right.
<br/>
i have something like</td> </tr></table><span class="postbody">
<br/>
<br/>
You are right! But because in this game the paddle is so close to the very left side of the screen you can ignore the check for the ball exit from the left side of the paddle. 
<br/>
<br/>
It wasn't bad for first collision detection :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92911 - AdamZZ - Sat Jul 15, 2006 2:56 pm</h4>
    <div class="postbody"><span class="postbody">Thanks all! :D and a special thanks to naleksiev for helping me with collision detection :D
<br/>
<br/>
<a class="postlink" href="http://upload.kinstry.co.uk/users/adamzz/PongDS.rar" target="_blank">http://upload.kinstry.co.uk/users/adamzz/PongDS.rar</a>
<br/>
<br/>
the game is in version 1.0 planning to make up to version 4.0
<br/>
<br/>
right now the game is starting when you start the game on your ds or emulator. it has score and you are competing against yourself.
<br/>
<br/>
in version 4.0 (final) these modes will be availible.
<br/>
VS you
<br/>
VS AI
<br/>
VS friend (on same ds)
<br/>
<br/>
once again Thanks all!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93190 - naleksiev - Mon Jul 17, 2006 3:49 pm</h4>
    <div class="postbody"><span class="postbody">He he :)
<br/>
<br/>
I tried the game only on a notebook without mouse and it was hard for me to move but I think the ball is moving only on angles 45 + (90 * x). I mean the speed on X and Y is the same. So this will be good feature to make the ball move more like blockbreaker the angle to depends from the location collision with the paddle. 
<br/>
Excuse me if it's working and I couldn't see it.
<br/>
<br/>
Btw. Vs friend will be easer I will recomend you to start from it. I think you are going to make it one of the players to move with the DPAD and the other one with B and X. It's going to be easy addition for your current game so you can maybe release the game with both :).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93208 - Sausage Boy - Mon Jul 17, 2006 7:28 pm</h4>
    <div class="postbody"><span class="postbody">Reminds me of my Pong clone, <a class="postlink" href="http://www.gasp.boxgamex.net/?p=7" target="_blank">Extreme Pong</a>.<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
