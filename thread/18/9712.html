<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Scrolling Backgrounds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Scrolling Backgrounds</h2>
<div id="posts">
<div class="post">
    <h4>#85156 - PacoChan - Sat May 27, 2006 2:57 pm</h4>
    <div class="postbody"><span class="postbody">Hi, sorry for my english, I'm spanish. I'm doing a horizontally-scrolling shooter game, where you fly in the space with a spaceship. I have some 16bit bitmaps that are 512x192 pixels. What I want is that this bitmap scrolls horizontally and been repeated when it reaches to the end of the bitmap. So... now that i'm able to show sprites, I don't know how to do this. I've been looking some examples that come with libnds but trere's no one of what I want to do. Could you explain how to do that, with examples(if it's possible)? Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85169 - Linkiboy - Sat May 27, 2006 4:50 pm</h4>
    <div class="postbody"><span class="postbody">The best example for what yer talking about would have to be in PALib. Go download it and look at the examples.
<br/>
<br/>
<a href="http://www.palib.com/" target="_blank">http://www.palib.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85241 - knight0fdragon - Sun May 28, 2006 4:08 am</h4>
    <div class="postbody"><span class="postbody">what you could do is have 2 BGs pointing to the same image
<br/>
<br/>
then when u hit the end of BG1, BG2 begins, when u hit the end of BG2, BG1 begins<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85261 - PacoChan - Sun May 28, 2006 8:43 am</h4>
    <div class="postbody"><span class="postbody">Hi, that is another thing that I don't understand very well. I have two BGs but  when I draw something in one of them, it appears on both. What do I have to do to fraw one bitmap in one BG and another bitmap in the other BG?
<br/>
<br/>
I have also seen in video.h in libnds that are some defines: BG_MOSAIC_ON, BG_MOSAIC_OFF, MOSAIC_CR, SUB_MOSAIC_CR, BG_MOSAIC_ENABLE. Could these defines do that one background is repeated? I tried some of them but it does nothing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85369 - rooter - Mon May 29, 2006 3:32 pm</h4>
    <div class="postbody"><span class="postbody">Look into tile based backgrounds and use a 64x32 tile background and write new tiles into the offscreen area as you are scrolling around.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85376 - silent_code - Mon May 29, 2006 4:38 pm</h4>
    <div class="postbody"><span class="postbody">i can't give you code, but the possibility for repeating backgrounds is there for sure! (i remember messing around with bgs on gba and i had repeating bgs... maybe some certain bits need to be changed... ? still: no code available! though i wish i had... damn hdd crash *upset*) imo using two bgs for the visible effect of one infinitely scrolling bg is a bit overkill and definitly a waste of hardware resources.
<br/>
<br/>
if you have multiple (that means separate) (bitmap) backgrounds you need to write the data into the screen base block memory. then you need to assign a "starting memory block" for each bg. that is typically the first tile (though it is a bmp bg) ;) 
<br/>
<br/>
example (might not be 100% correct, but it works fine for me - worked that out by trial and error ;p ):
<br/>
<br/>
setting up the bgs bmp base:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">BG2_CR = BG_BMP8_256x256 | BG_BMP_BASE(4) | BG_PRIORITY(0);
<br/>
<br/>
BG3_CR = BG_BMP8_256x256 | BG_PRIORITY(3);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
now loading some image data into the background (NOTE: i use 256x192 8bit bmp bgs, but it also workes with 16bit - though you may have to adjust some values):
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for(i = 0; i &lt; 256; i++)
<br/>
// load the bg p?alette into bg palette memory
<br/>
<br/>
BG_PALETTE[i] = ((u16*)bg8_pal_bin)[i];
<br/>
<br/>
// load the lower bg (bg3) img data
<br/>
<br/>
for(i = 0; i &lt; bg8_img_bin_size / sizeof(uint16); i++)
<br/>
((uint16*)SCREEN_BASE_BLOCK(0))[i] = ((uint16*)bg8_img_bin)[i];
<br/>
<br/>
// reset the upper bg (bg2) img data for some random drawing (NOTE: remember the bus is 16bit, so you always draw 2 pixels at once in this mode! because of that it's 128 * 192, not 256 * 192 - and yes, i could have calculated that value instead of doing the multiplication, lazy me ;p )
<br/>
<br/>
for(i = 0; i &lt; 128 * 192; i++)
<br/>
((uint16*)SCREEN_BASE_BLOCK(32))[i] = 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
hope that helps with the same stuff on both bgs issue.
<br/>
<br/>
feel free to ask for some help, of just send me over some code and i'll try to make it work (as soon as i get some minutes off ;p ).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85394 - knight0fdragon - Mon May 29, 2006 9:50 pm</h4>
    <div class="postbody"><span class="postbody">how is it hardware overkill, its 2 bgs pointing to the same area in memory with different settings in CX registers
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
psuedocode
<br/>
<br/>
load the  bitmap and have both bg point to it 
<br/>
BG1_CX = 0
<br/>
BG2_CX = 256
<br/>
<br/>
for x &lt; length
<br/>
{
<br/>
BG1_CX--;
<br/>
if BG1CX == -256
<br/>
  BG1CX = 256
<br/>
BG2_CX--;
<br/>
<br/>
if BG2CX == -256
<br/>
  BG2CX = 256
<br/>
}
<br/>
<br/>
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
if there is some wraparound bit setting then the second BG can just be eliminated[/code]<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85395 - silent_code - Mon May 29, 2006 9:58 pm</h4>
    <div class="postbody"><span class="postbody">you're right, the term "overkill" was a bit exaggerated. well, i just think one can do so much more with two separate backgrounds than using both of them to simulate one continous bg... ;) especially when there's hardware support for that... (i'm not 100% sure - could someone confirm or deny that?!)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85439 - SteveH - Tue May 30, 2006 11:10 am</h4>
    <div class="postbody"><span class="postbody">You do relise that the DS screen is 256 pixels across or 32 tiles across, so to do horizontal scrolling you will need a 64x32 tile map, thus 2 map bases are assigned to the bg with that will be seamless, or if it's a bmp image you might be able to get away with a 256x256 image and update x columns (x = speed of scroll) per vblank, but it might be a tad slow to do...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85447 - PacoChan - Tue May 30, 2006 1:58 pm</h4>
    <div class="postbody"><span class="postbody">Hi, I finally did what knight0fdragon said and it works perfect. I would prefer to use only one background but it doesn't matter. Thanks everyone.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85448 - silent_code - Tue May 30, 2006 2:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>SteveH wrote:</b></span></td> </tr> <tr> <td class="quote">You do relise that the DS screen is 256 pixels across or 32 tiles across, so to do horizontal scrolling you will need a 64x32 tile map, thus 2 map bases are assigned to the bg with that will be seamless, or if it's a bmp image you might be able to get away with a 256x256 image and update x columns (x = speed of scroll) per vblank, but it might be a tad slow to do...</td> </tr></table><span class="postbody">
<br/>
<br/>
i know... my point is to utilize the hardware, if there is a bg repeat. in the case there is no such thing, the 2 bgs solution is fine! (i didn't say it's crap or something!) now let's just forget about it, it's leading us nowhere until someone posts a bg repeat setup or simply proves there is no hw repeat.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85449 - tepples - Tue May 30, 2006 2:22 pm</h4>
    <div class="postbody"><span class="postbody">Yes, there is a background repeat for at least tiled backgrounds.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#85455 - silent_code - Tue May 30, 2006 2:55 pm</h4>
    <div class="postbody"><span class="postbody">:D
<br/>
<br/>
and there are tools that "transform" a bmp image to a tiled map ;)
<br/>
<br/>
yet, you're right to use two bgs as it's easier to fill in non repeating bgs (like when your maps consist of many "screens"), but that can be done with one tiled bg, too (it needs to be wider than the screen, like e.g. 512 pixels or 64 tiles).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86774 - knight0fdragon - Fri Jun 09, 2006 4:12 am</h4>
    <div class="postbody"><span class="postbody">hey try this for wrap  BG3_CR = BG_BMP16_256x256 | BG_WRAP_ON;<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86837 - PacoChan - Fri Jun 09, 2006 8:01 pm</h4>
    <div class="postbody"><span class="postbody">Wow, thanks knight0fdragon, it works perfectly. Now I don't have to use two bgs. That was exactly what I was looking for. ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86853 - knight0fdragon - Fri Jun 09, 2006 10:58 pm</h4>
    <div class="postbody"><span class="postbody">yea fiddleing around with what was available in video.h I came across that, glad it helps, now u can use another background for foreground effects or something<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86925 - silent_code - Sat Jun 10, 2006 5:23 pm</h4>
    <div class="postbody"><span class="postbody">thanks kOd!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
