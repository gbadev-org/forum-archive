<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Using more C++ files - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Using more C++ files</h2>
<div id="posts">
<div class="post">
    <h4>#75621 - patroclus02 - Tue Mar 14, 2006 7:53 pm</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
I would like to split up my code into several c++ source files.
<br/>
Ok, what I've done is to take some functions out to a another .c file, without writing any .h file for it, and not including the new .c file in my main unit, as I get multiple reference to its functions then.
<br/>
<br/>
when I compile, it works fine but I get a
<br/>
warning: implicit declaration of function 'checkTouch'
<br/>
in my main file...
<br/>
<br/>
what is the right way of doing this?
<br/>
Thank you</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75625 - tepples - Tue Mar 14, 2006 8:04 pm</h4>
    <div class="postbody"><span class="postbody">You put the function's prototype in the .h file.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75627 - patroclus02 - Tue Mar 14, 2006 8:17 pm</h4>
    <div class="postbody"><span class="postbody">Writing a h file or not leads to same results.
<br/>
the only way it does not complain about 'implicit declaration' is
<br/>
<br/>
I put c file insice a include directory (defined in makefile)
<br/>
I do "#include "davlib.c" in main file.
<br/>
<br/>
H file is not needed...
<br/>
If I write a H file and include it 
<br/>
"#include "davlib.h" instead of "#include "davlib.c"
<br/>
I get LOTS of warnings...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75629 - tepples - Tue Mar 14, 2006 8:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>patroclus02 wrote:</b></span></td> </tr> <tr> <td class="quote">If I write a H file and include it 
<br/>
"#include "davlib.h" instead of "#include "davlib.c"
<br/>
I get LOTS of warnings...</td> </tr></table><span class="postbody">
<br/>
What is the exact text of the first ten warnings that you get, and what are the exact source lines of code that are listed in these warnings?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75630 - patroclus02 - Tue Mar 14, 2006 8:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
c:/David/NDS/David5/source/gfx/ball.raw.c:4: error: parameter 'ball_Bitmap' is initialized
<br/>
c:/David/NDS/David5/source/gfx/ball.raw.c:5: warning: excess elements in scalar initializer
<br/>
c:/David/NDS/David5/source/gfx/ball.raw.c:5: warning: (near initialization for 'ball_Bitmap')
<br/>
c:/David/NDS/David5/source/gfx/ball.raw.c:5: warning: excess elements in scalar initializer
<br/>
c:/David/NDS/David5/source/gfx/ball.raw.c:5: warning: (near initialization for 'ball_Bitmap')
<br/>
c:/David/NDS/David5/source/gfx/ball.raw.c:5: warning: excess elements in scalar initializer
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And so on. they are grpahics converted with gfx2gba.
<br/>
the only way of getting it working is what I said.
<br/>
Also, if I put C file in source directory along with main.c, and not write "#include davlib.c" neither use any H file, it works but I get a "implicit declaration" warning... don't knwo why</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75631 - tepples - Tue Mar 14, 2006 8:31 pm</h4>
    <div class="postbody"><span class="postbody">Please paste the first five lines of ball.raw.c so that I can show you what to put in the header.
<br/>
<br/>
Clue: The prototype for an initialized array needs the keyword 'extern' before it.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75632 - patroclus02 - Tue Mar 14, 2006 8:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//
<br/>
// ball (256 uncompressed bytes)
<br/>
//
<br/>
const unsigned char ball_Bitmap[256] = {
<br/>
0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06, 0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06,
<br/>
0x00, 0x00, 0x06, 0x06, 0x07, 0x07, 0x07, 0x07, 0x00, 0x00, 0x06, 0x06, 0x07, 0x07, 0x07, 0x07,
<br/>
0x06, 0x06, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08, 0x06, 0x06, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08,
<br/>
0x06, 0x06, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08, 0x06, 0x06, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08,
<br/>
0x06, 0x06, 0x06, 0x06, 0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06, 0x00, 0x00, 0x00, 0x00,
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
there's no H file for this C file neither any other C file I use. this file was created with gfx2gba in SRC mode
<br/>
<br/>
Also it was working perfectly before I tried to split up my code in several C files. and it still works (and I get no warnings) if a don't include the H file "davlib.h".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75634 - tepples - Tue Mar 14, 2006 8:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>patroclus02 wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//
<br/>
// ball (256 uncompressed bytes)
<br/>
//
<br/>
const unsigned char ball_Bitmap[256] = {
<br/>
0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06, 0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06,
<br/>
/*snip*/
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
Put the following line in the .h file for your project:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern const unsigned char ball_Bitmap[256];</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75636 - patroclus02 - Tue Mar 14, 2006 8:59 pm</h4>
    <div class="postbody"><span class="postbody">which H file?
<br/>
I tried to add it to davlib.h and also ball.raw..h, but nothing changes...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75638 - tepples - Tue Mar 14, 2006 9:01 pm</h4>
    <div class="postbody"><span class="postbody">I don't know what davlib.h is. It would be faster for me to help you if you put all your source code in a zip file and post it on the web somewhere so that I can explain the thought process that I would use to help you.
<br/>
<br/>
Or you can convert your images to binary and use GBFS instead of converting your images to source code.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75645 - funkaster - Tue Mar 14, 2006 10:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>patroclus02 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
what is the right way of doing this?
<br/>
Thank you</td> </tr></table><span class="postbody">
<br/>
<br/>
you define either a common header file (with all the function's signatures) or one header per .c file.
<br/>
If you have global variables, you define them in just one .c file, and in the corresponding header file, you define it like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
extern &lt;type&gt; &lt;variable&gt;;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
for instance, if you have a global array of data, you could define it in the source file like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
unsgined char myarray[1024] = {...};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and in the corresponding header like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
extern unsigned char myarray[1024];
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
hth...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75646 - patroclus02 - Tue Mar 14, 2006 10:34 pm</h4>
    <div class="postbody"><span class="postbody">tepples I sent you a MP with the link to download the source code.
<br/>
<br/>
funkaster thanks but that is not the problem I have :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75653 - patroclus02 - Tue Mar 14, 2006 11:41 pm</h4>
    <div class="postbody"><span class="postbody">tepples, thank you. It works.
<br/>
But the extern declarations are a bit messy to include in ALL new header file, and modify all them if something changes...
<br/>
. Do I need to add extern declarations if not going to use those variables in that particular C source file??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75662 - tepples - Wed Mar 15, 2006 12:31 am</h4>
    <div class="postbody"><span class="postbody">No, you don't need extern declarations for things that a given C file doesn't use. For instance, you could have one file that handles copying images into VRAM and then only put the extern declarations for VRAM data in that file.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75674 - genfish - Wed Mar 15, 2006 3:34 am</h4>
    <div class="postbody"><span class="postbody">i do it like this:
<br/>
<br/>
main.cpp
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
#include "CExample.h"
<br/>
<br/>
int main()
<br/>
{
<br/>
// code here
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
CExample.h
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef CExample_h
<br/>
#define CExample_h
<br/>
<br/>
class CExample
<br/>
{
<br/>
public:
<br/>
int a,b;
<br/>
CExample();
<br/>
~CExample();
<br/>
<br/>
private:
<br/>
bool ExampleFunc(int a);
<br/>
};
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
CExample.cpp
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
CExample::CExample()
<br/>
{
<br/>
// constructor code here
<br/>
a = 0;
<br/>
b = 0;
<br/>
}
<br/>
<br/>
CExample::~CExample()
<br/>
{
<br/>
// destructor code
<br/>
}
<br/>
<br/>
bool CExample::ExampleFunc(int a)
<br/>
{
<br/>
// code here
<br/>
<br/>
return true;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75747 - patroclus02 - Wed Mar 15, 2006 6:03 pm</h4>
    <div class="postbody"><span class="postbody">Is there a way of using global defines??
<br/>
I need to acces to some "defines" in more than one source file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75763 - genfish - Wed Mar 15, 2006 8:56 pm</h4>
    <div class="postbody"><span class="postbody">put them in a header and include it where the defines are required.
<br/>
<br/>
I keep relevant defines coupled in files with my ADT's or classes, then the defines are included whenever they are needed.<br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75825 - patroclus02 - Thu Mar 16, 2006 8:51 am</h4>
    <div class="postbody"><span class="postbody">Yes, what I do is define in header file, but I also need to define un its associated C file. then all other C files that include the H header, can acces the defined data.
<br/>
 Is it ok?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75842 - genfish - Thu Mar 16, 2006 3:14 pm</h4>
    <div class="postbody"><span class="postbody">if you have defined something in a header file and that file is included, you do not need to define the values again in the source file<br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75859 - waruwaru - Thu Mar 16, 2006 4:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>patroclus02 wrote:</b></span></td> </tr> <tr> <td class="quote">Yes, what I do is define in header file, but I also need to define un its associated C file. then all other C files that include the H header, can acces the defined data.
<br/>
 Is it ok?</td> </tr></table><span class="postbody">
<br/>
<br/>
do the #ifndef trick.  In each one of your .h file, wrap the entire file in
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef __UNIQUEHEADERFILENAME_H__
<br/>
#define __UNIQUEHEADERFILENAME_H__
<br/>
<br/>
// all your header goes in here
<br/>
#define WHATEVER_YOU_WANT "blahblahblah"
<br/>
<br/>
// also declare your global vars you want to share between files with extern
<br/>
extern int GLOBAL_COUNTER;
<br/>
<br/>
#endif // __UNIQUEHEADERFILENAME_H__
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
And in the cpp file where the global variable is maintained, define the global var:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int GLOBAL_COUNTER = 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Now all your files that needs the #define and the global variables just include this header file.<br/>_________________<br/><a class="postlink" href="http://www.DSLua.com" target="_blank">DSLua - a scripting language for your DS!</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75862 - genfish - Thu Mar 16, 2006 5:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>genfish wrote:</b></span></td> </tr> <tr> <td class="quote">i do it like this:
<br/>
<br/>
CExample.h
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#ifndef CExample_h
<br/>
#define CExample_h
<br/>
<br/>
class CExample
<br/>
{
<br/>
public:
<br/>
int a,b;
<br/>
CExample();
<br/>
~CExample();
<br/>
<br/>
private:
<br/>
bool ExampleFunc(int a);
<br/>
};
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
:)<br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75876 - waruwaru - Thu Mar 16, 2006 7:22 pm</h4>
    <div class="postbody"><span class="postbody">[quote="genfish]:)[/quote]
<br/>
<br/>
That's what I said!  Just kidding. :) Pardon the echos.<br/>_________________<br/><a class="postlink" href="http://www.DSLua.com" target="_blank">DSLua - a scripting language for your DS!</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75882 - patroclus02 - Thu Mar 16, 2006 8:37 pm</h4>
    <div class="postbody"><span class="postbody">do I always have to use the extern directive??
<br/>
So far I'm declaring variables in H files without extern. it works...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75883 - tepples - Thu Mar 16, 2006 9:00 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>patroclus02 wrote:</b></span></td> </tr> <tr> <td class="quote">do I always have to use the extern directive??
<br/>
So far I'm declaring variables in H files without extern. it works...</td> </tr></table><span class="postbody">
<br/>
It won't work in C version 1999, nor in C++, and it isn't reliable for initialized arrays.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75988 - funkaster - Fri Mar 17, 2006 1:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>patroclus02 wrote:</b></span></td> </tr> <tr> <td class="quote">do I always have to use the extern directive??
<br/>
So far I'm declaring variables in H files without extern. it works...</td> </tr></table><span class="postbody">
<br/>
<br/>
May I suggest you to read a good book on C?... K&amp;R is *the* book you should read if you ever want to learn C the good way.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#75994 - genfish - Fri Mar 17, 2006 2:24 pm</h4>
    <div class="postbody"><span class="postbody">This one :)
<br/>
<br/>
<a class="postlink" href="http://www.amazon.co.uk/exec/obidos/ASIN/0131103628/qid=1142601821/sr=8-1/ref=sr_8_xs_ap_i1_xgl/203-5507165-5388768" target="_blank">amazon</a><br/>_________________<br/>there is no rl only afk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76039 - funkaster - Fri Mar 17, 2006 10:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>genfish wrote:</b></span></td> </tr> <tr> <td class="quote">This one :)
<br/>
<br/>
<a class="postlink" href="http://www.amazon.co.uk/exec/obidos/ASIN/0131103628/qid=1142601821/sr=8-1/ref=sr_8_xs_ap_i1_xgl/203-5507165-5388768" target="_blank">amazon</a></td> </tr></table><span class="postbody">
<br/>
<br/>
exactly, that's the bible. ;-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#76191 - silent_code - Sun Mar 19, 2006 4:34 am</h4>
    <div class="postbody"><span class="postbody">sounds like you missed some c/c++ fundamentals. .h files are like signatures or interfaces (not exactly, but one can imagine it) that shouldn't contain any implementations (real code). so, i neither know about your programming skills nor your experience, but i suggest learn using one of those two languages (programming) first. i prefer c++, but i used c a lot in the past. no matter what way you go: start with hello world and stuff and work through a book. and don't just read it, learn from it by typing the listings into your pc and compiling and executing and testing and ... everything. the error messages are the programmers best friends. there's nothing more horrible than typos, ok, but read an error message carefully (ok, skip the wierdo stuff and read the human readable parts) and they'll often direct you to the "hot spot of error".
<br/>
<br/>
and please: i know of NO way you are able to compile and link multi source file projects without headers to let the sources interact in some way (though i don't claim i know a lot about anything). you may also use "#pragma once" instead of the whole "#if...whatever #endif" stuff. read it up, man.
<br/>
defines just need to be defined in a common header (like e.g. "common.h") and included everywhere you need them. trust me (at least a bit), it will help to prevent a few headaches. use as lot of modules (c/c++ source files) as possible! but without headers, they are woth nothing! don't include source files. in my entire programming life there's been only ONE time i needed to include a .c. i haven't checked why, but i may. this one was for university. buggy code. yea, that's how they teach us - we're the future (man, i'm just a BIT offtopic right now)... ;p
<br/>
<br/>
greets!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
