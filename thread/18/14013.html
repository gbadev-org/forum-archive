<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Save data - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Save data</h2>
<div id="posts">
<div class="post">
    <h4>#138661 - FOcaL - Mon Aug 27, 2007 2:30 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I would to save data with my Nintendo DS, but I don?t know how ? I have seen the programm ?sram_demo1? but the compilation fail (and all my path are correctly install) and I don't arrive to modify my programm to include the VRAM part.
<br/>
<br/>
<br/>
<br/>
Thanks for your help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138663 - Diddl - Mon Aug 27, 2007 2:41 pm</h4>
    <div class="postbody"><span class="postbody">look for source code of rein17 and eepinator. within you will find functions to access all kinds of savegame memory currently exists.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138678 - tepples - Mon Aug 27, 2007 7:30 pm</h4>
    <div class="postbody"><span class="postbody">Do you just want to save data, or do you specifically want to save data to a DS Game Card for some reason? If you just want to save data, then you can use libfat to make a folder /data/name_of_your_app/ and then make files inside that.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138727 - FOcaL - Tue Aug 28, 2007 10:29 am</h4>
    <div class="postbody"><span class="postbody">Ok thanks for your response.
<br/>
<br/>
I try to use libfat. If I have another problem I will repost^^
<br/>
<br/>
edit : ok It's good ^^ just think to add LIBS	:= -lfat in makefile to compil :p</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138748 - FOcaL - Tue Aug 28, 2007 3:13 pm</h4>
    <div class="postbody"><span class="postbody">OK I have a little problem :p
<br/>
<br/>
I create my file, enter a text and the read this text.
<br/>
<br/>
But when my file is already create ( we turn off the NDS and turn on) I fail to read the file...
<br/>
If I don't write the text on the same "session", I can't read the file...
<br/>
<br/>
I don't know if I'm clear ^^ but thanks for your help^^
<br/>
<br/>
edit :
<br/>
<br/>
this is my code :
<br/>
<br/>
void SaveToCard(char* data)
<br/>
{
<br/>
    int size;
<br/>
	char *ptr = data;
<br/>
	size=sizeof(data);
<br/>
    if(!fatInitDefault())
<br/>
    {
<br/>
       printtop("Error to create save file");
<br/>
    }   
<br/>
    else
<br/>
    { 
<br/>
         FILE* Write = fopen ("DS.save", "wb");
<br/>
	     fwrite(ptr, 1, size*4, Write);
<br/>
	     fclose(Write);
<br/>
    }
<br/>
}
<br/>
void ReadToCard()
<br/>
{
<br/>
 char result[9999];
<br/>
 int i=0;
<br/>
 char *ptr = &amp;result;
<br/>
 FILE* Read = fopen ("DS.save", "rb");  
<br/>
 if(Read != -1)
<br/>
 {
<br/>
    int size=0;
<br/>
    size=sizeof(ptr);
<br/>
    printtop("Read");
<br/>
    fread(ptr, 1, 4*size, Read);
<br/>
    printtop("Close");
<br/>
    fclose(Read);
<br/>
 }
<br/>
 else printtop("Error to read File");
<br/>
 printtop(ptr);
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138757 - tepples - Tue Aug 28, 2007 7:30 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FOcaL wrote:</b></span></td> </tr> <tr> <td class="quote">this is my code :
<br/>
<br/>
void SaveToCard(char* data)
<br/>
{
<br/>
    int size;
<br/>
	char *ptr = data;
<br/>
	size=sizeof(data);</td> </tr></table><span class="postbody">
<br/>
sizeof(data) will always be 4 on ARM.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
void ReadToCard()
<br/>
{
<br/>
 char result[9999];
<br/>
 int i=0;
<br/>
 char *ptr = &amp;result;
<br/>
 FILE* Read = fopen ("DS.save", "rb");  
<br/>
 if(Read != -1)
<br/>
 {
<br/>
    int size=0;
<br/>
    size=sizeof(ptr);</td> </tr></table><span class="postbody">
<br/>
sizeof(ptr) will always be 4 on ARM.
<br/>
<br/>
Does your code work on a PC?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138763 - Quirky - Tue Aug 28, 2007 9:26 pm</h4>
    <div class="postbody"><span class="postbody">Could be that you don't call fatInit in the Read code. Ideally you should call it once at the start of main(), rather than in the "low-level" save/load stuff.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#138807 - FOcaL - Wed Aug 29, 2007 9:03 am</h4>
    <div class="postbody"><span class="postbody">Yes Quirky you have right. It's a stupid error.... I'm so sorry.
<br/>
<br/>
And this code is an extract from a big code, and it work on the DS.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
