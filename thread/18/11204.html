<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sound sinthesis with DS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Sound sinthesis with DS</h2>
<div id="posts">
<div class="post">
    <h4>#103263 - Kaitain - Wed Sep 20, 2006 1:37 pm</h4>
    <div class="postbody"><span class="postbody">Hi. 
<br/>
<br/>
I'm trying to build some kind of musical instrument NOT based in samples. In order to do that, I need to play different waveforms and modify it's values in realtime. 
<br/>
<br/>
Im a bit newbee in programming and homebrew, so I started with PAlibs. My first question is: can I use PAlib and libnds at he same time?
<br/>
<br/>
Because of the real time modifying, I can't do this using sound files: i have to create the waveform in real time. So, if I'm able to build and array with the info of, lets say, a sine wave, should be possible to play that? 
<br/>
<br/>
(With PALibs, all I've seen are functions to play sound files. As I can gather, with libnds the same problem remains).
<br/>
<br/>
Is maybe possible to send to the sound functions something different that a sound file (like for example, the values that are inside an array)? Is there any function able to do that? 
<br/>
<br/>
Making this possible sould turn the NDS in a powerfull synthetisher!! 
<br/>
<br/>
Any help/suggestion will be very appreciated.
<br/>
<br/>
Thank you in advance. 
<br/>
<br/>
^_^V</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103270 - dub3000 - Wed Sep 20, 2006 2:38 pm</h4>
    <div class="postbody"><span class="postbody">the DS has a couple of channels that can do square waves with variable duty cycle - i used this with a theramin app i built.
<br/>
<br/>
otherwise, i think you'd just stream the generated sound into a circular buffer, like mp3 playback. not sure of what kind of latency to expect, i'd guess it'd be pretty low.
<br/>
<br/>
keep in mind you need to use fixed point math everywhere - you don't have much overhead for doing high quality sound. it ends up being like 10bit 33kHz output anyway, possibly lower - the DACs on the DS aren't exactly audiophile grade.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103290 - OOPMan - Wed Sep 20, 2006 6:15 pm</h4>
    <div class="postbody"><span class="postbody">I don't think there's any reason why you can't use PAlib and libnds. I would imagine that most of PAlib is built on top of libnds anyway...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103294 - Kaitain - Wed Sep 20, 2006 6:45 pm</h4>
    <div class="postbody"><span class="postbody">Thanks a lot for your quick response.
<br/>
<br/>
<br/>
"otherwise, i think you'd just stream the generated sound into a circular buffer, like mp3 playback. not sure of what kind of latency to expect, i'd guess it'd be pretty low. "
<br/>
<br/>
Ok, that's exactly what I'd like to do. Do you know how can I pass the content of a variable to the sound system? Is there any function that can do that?
<br/>
<br/>
Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103316 - Kaitain - Wed Sep 20, 2006 10:32 pm</h4>
    <div class="postbody"><span class="postbody">Another idea: maybe if I modify the code of the function PA_PlaySound, just avoiding the steps of opening and closing the file, and accessing directly o the variables inside, I'd manage to lower the latency.
<br/>
<br/>
Does anybody know where I can find the source code of that function?
<br/>
<br/>
Thank you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103328 - tepples - Wed Sep 20, 2006 11:21 pm</h4>
    <div class="postbody"><span class="postbody">You can send commands and data back and forth using shared memory synchronized either by values of VCOUNT (only one CPU should have access to a block of memory on any given scanline) or through the FIFO.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103361 - OOPMan - Thu Sep 21, 2006 9:27 am</h4>
    <div class="postbody"><span class="postbody">Erm, PALib is an open-source library last time I checked...
<br/>
<br/>
*checks again*
<br/>
<br/>
Bah, the website is giving me issues...
<br/>
<br/>
Anyone else able to confirm this?
<br/>
<br/>
Well, if the library is open, then just grab the source...
<br/>
<br/>
If not, well, you'll have to ask the developer...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103400 - josath - Thu Sep 21, 2006 4:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>OOPMan wrote:</b></span></td> </tr> <tr> <td class="quote">Erm, PALib is an open-source library last time I checked...
<br/>
<br/>
*checks again*
<br/>
<br/>
Bah, the website is giving me issues...
<br/>
<br/>
Anyone else able to confirm this?
<br/>
<br/>
Well, if the library is open, then just grab the source...
<br/>
<br/>
If not, well, you'll have to ask the developer...</td> </tr></table><span class="postbody">
<br/>
<br/>
it's a bit tough to get the source. last time i checked, there are 3 versions:
<br/>
the latest version is ONLY in .exe format. you should be able to extract the source with a little bit of work.
<br/>
there's a 3 month old source version on sourceforge
<br/>
and a 6 month old version in CVS
<br/>
<br/>
though this may have changed by now.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103415 - !cube - Thu Sep 21, 2006 7:09 pm</h4>
    <div class="postbody"><span class="postbody">As someone already pointed out, what you need to do is play a looping sound and treat the sound data as a ringbuffer and mix audio data into that array in vertical blank or with a faster interrupt for a smaller latency. The thing is however that you're confined into using fixed point math and pretty much just simple wavetable synthesis since doing anything else in realtime with a 67MHz cpu is going to be too slow.
<br/>
<br/>
The problem with wavetable synthesis is that to get it sounding good requires quite a lot of memory and that is a luxury one doesn't have with DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103424 - mastertop101 - Thu Sep 21, 2006 8:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
it's a bit tough to get the source. last time i checked, there are 3 versions:
<br/>
the latest version is ONLY in .exe format. you should be able to extract the source with a little bit of work.
<br/>
there's a 3 month old source version on sourceforge
<br/>
and a 6 month old version in CVS
<br/>
<br/>
though this may have changed by now.</td> </tr></table><span class="postbody">
<br/>
<br/>
Hum..? if you run the exe, it gives you the source and installs PAlib, you can compilate (is it really a word ?) palib back..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103457 - tepples - Fri Sep 22, 2006 3:33 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>!cube wrote:</b></span></td> </tr> <tr> <td class="quote">The thing is however that you're confined into using fixed point math and pretty much just simple wavetable synthesis since doing anything else in realtime with a 67MHz cpu is going to be too slow.</td> </tr></table><span class="postbody">
<br/>
Which of the following is too slow in fixed-point arithmetic? <ul><li>Simple subtractive synthesis (e.g. TB-303 emulation) </li><li>FM synthesis (e.g. Yamaha OPL series emulation) </li><li>Karplus-Strong (echo based) synthesis </li></ul><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103492 - !cube - Fri Sep 22, 2006 9:22 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Which of the following is too slow in fixed-point arithmetic? <ul><li>Simple subtractive synthesis (e.g. TB-303 emulation) </li><li>FM synthesis (e.g. Yamaha OPL series emulation) </li><li>Karplus-Strong (echo based) synthesis </li></ul></td> </tr></table><span class="postbody">
<br/>
<br/>
Ok, maybe I should have put it differently: anything having larger polyphony, effects and non-aliasing oscillators with a 67MHz is going to be slow.. which is what I figured he wants to do.
<br/>
<br/>
Making a simple TB-303 emulator or using Karplus-Strong for a single string instrument is perfectly feasible even with a slow cpu and using just fixed point. OPL2 should be possible since it has only two operators but going to OPL3 will most probably already be out of the picture due to added operators and voice count.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
