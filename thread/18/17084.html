<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Compiling to a shared object or using overlays - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Compiling to a shared object or using overlays</h2>
<div id="posts">
<div class="post">
    <h4>#172276 - Tommmie - Thu Jan 28, 2010 5:18 pm</h4>
    <div class="postbody"><span class="postbody">Hey everyone,
<br/>
<br/>
just to keep it short:):
<br/>
Does someone know how you can compile your sources to a shared object (an elf file)? normally you'll also get an elf file, but that's not the kind of elf file I want. I already tried some copy and pastes in my makefile, but that didn't work.
<br/>
<br/>
I already have this line in my makefile, but what additional code do I need?:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">CFLAGS   +=   $(INCLUDE) -DARM9 -fPIC -shared </td> </tr></table><span class="postbody"></span><span class="gensmall"><br/><br/>Last edited by Tommmie on Sun Jan 31, 2010 12:02 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#172290 - Abcd1234 - Fri Jan 29, 2010 6:10 am</h4>
    <div class="postbody"><span class="postbody">Well, unless you plan to write a dynamic linker for the DS, too, I don't expect this'll work the way you're hoping it will. :)
<br/>
<br/>
OOC, what's your goal, anyway?  The only reason I can think of to dynamically load code on the DS is for some sort of plugin model...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172291 - Lino - Fri Jan 29, 2010 6:58 am</h4>
    <div class="postbody"><span class="postbody">like DLDI</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172292 - Tommmie - Fri Jan 29, 2010 7:21 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Abcd1234 wrote:</b></span></td> </tr> <tr> <td class="quote">Well, unless you plan to write a dynamic linker for the DS, too, I don't expect this'll work the way you're hoping it will. :)
<br/>
<br/>
OOC, what's your goal, anyway?  The only reason I can think of to dynamically load code on the DS is for some sort of plugin model...</td> </tr></table><span class="postbody">
<br/>
<br/>
I once made something like dldi, but that wasn't working that well, now I'm planning to make an ELF loader. So instead of a plugin I would have a shared lib/object</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172293 - Lino - Fri Jan 29, 2010 7:29 am</h4>
    <div class="postbody"><span class="postbody">After the compilation you havent an ELF file but only code (otherwise you must remove the objcopy). You must write a simple patcher/loader like,again, DLDI.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172313 - Tommmie - Sat Jan 30, 2010 8:45 am</h4>
    <div class="postbody"><span class="postbody">shared libs are ELF files aren't they? and with normal compilation of a program you'll also get an elf file and some object files(also elf). So isn't it supported by devkitARM to compile to a shared lib or is it possible?
<br/>
<br/>
<span style="font-weight: bold">edit</span> Okay, overlays look also fine to me, but how do you create them? I found an old post about it, but couldn't get it to work(it wasn't really clear to me what to do):
<br/>
<br/>
<a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=14707&amp;highlight=overlay" target="_blank">http://forum.gbadev.org/viewtopic.php?t=14707&amp;highlight=overlay</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
