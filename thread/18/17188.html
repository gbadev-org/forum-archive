<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>communication between arm 9 and arm 7 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > communication between arm 9 and arm 7</h2>
<div id="posts">
<div class="post">
    <h4>#173258 - sylvestersteele - Mon Mar 29, 2010 7:14 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I wrote a simple program- arm7 code is writing to address 0x02400123- just flipping numbers- if its 1 make it 2 and if its 2 make it 1. 
<br/>
<br/>
arm9 is reading the same memory location and printing out that value- but the value never updates.
<br/>
<br/>
Why could this be?
<br/>
<br/>
I am using the non-cachable range of addresses so it look at the main mem every time.
<br/>
<br/>
I've also declared the variable volatile.
<br/>
<br/>
what could be the problem here?
<br/>
<br/>
Communicating through main memory might not be ideal etc- but I thought this was a simple thing to try and I want to get it working.
<br/>
<br/>
Thanks,
<br/>
Sylvester</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173259 - sylvestersteele - Mon Mar 29, 2010 7:24 am</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">ARM 9</span>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int main(void) {
<br/>
//---------------------------------------------------------------------------------
<br/>
   consoleDemoInit();
<br/>
   volatile int* reg= (int *)0x02400123;
<br/>
   
<br/>
   while(1) {
<br/>
   printf ("\nReg is: %d", *reg);
<br/>
    
<br/>
   swiWaitForVBlank();
<br/>
   }
<br/>
<br/>
   return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
<span style="font-weight: bold">ARM7</span>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int main(void) {
<br/>
volatile int *copyToAddress= (int *)0x02400123;
<br/>
*copyToAddress= 1;
<br/>
   while (1){
<br/>
<br/>
      if (*copyToAddress==1){
<br/>
      *copyToAddress=2;
<br/>
      }
<br/>
      else{
<br/>
      *copyToAddress=1;
<br/>
      }
<br/>
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Sylvester</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173260 - Dwedit - Mon Mar 29, 2010 8:01 am</h4>
    <div class="postbody"><span class="postbody">ARM9 has a cache, it will keep pulling the same value out of cache.  Use the FIFO hardware instead, it can even generate interrupts, so you don't need to use polling.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173266 - Mighty Max - Mon Mar 29, 2010 11:13 am</h4>
    <div class="postbody"><span class="postbody">I second the advise from Dwedit.
<br/>
<br/>
However, the cache isn't the problem. The 0x024... mirror region does not have the cache bit set if it hasn't been changed. 
<br/>
The cache is only a problem if the cached mirror writes back to memory. (So you need to take care not to write anything to a cachline mapping to the same physical memory)
<br/>
<br/>
But:
<br/>
The address you are using is is not aligned, you'll receive side-effects from that you have to take into account. Align it to 32bit or use byte access.<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#173273 - elhobbs - Mon Mar 29, 2010 1:27 pm</h4>
    <div class="postbody"><span class="postbody">I think wintermute move the uncached memory region to be compatible with dsi - since the old region fell withing the 16MB range used by the dsi. there is a function to convert an address to the uncached mirror - the name escapes me at the moment...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
