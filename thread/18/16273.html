<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Rendering 3D on both screens (Dual 3D) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Rendering 3D on both screens (Dual 3D)</h2>
<div id="posts">
<div class="post">
    <h4>#165284 - Kaiser - Tue Dec 16, 2008 4:28 am</h4>
    <div class="postbody"><span class="postbody">I've been searching for some tutorials covering this subject but I've had very little luck in finding any. I did find a demo covering this but I fail at understanding what exactly is going on.
<br/>
<br/>
Can someone explain the process in rendering 3D simultaneously on both screens?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165287 - DiscoStew - Tue Dec 16, 2008 5:46 am</h4>
    <div class="postbody"><span class="postbody">The <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#dsvideocaptureandmainmemorydisplaymode" target="_blank">Video Capture Hardware</a> is the core of getting 3D on both screens at the same time (aside from the 3D hardware). Without it, you are stuck with either software rendering, or having 3D on only one screen at any time.
<br/>
<br/>
The trick behind it is that you are taking a snapshot of one frame, and displaying it elsewhere on the next frame, like on the other screen, or as a texture on the current 3D scene to be rendered ( like the <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=16251" target="_blank">Render to Texture</a> example). Capturing requires that the destination VRAM bank be set to LCD mode, but once captured, you can set that VRAM bank to whatever mode is needed.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165288 - Echo49 - Tue Dec 16, 2008 6:19 am</h4>
    <div class="postbody"><span class="postbody">Does this effectively mean you only get 30fps instead of 60?
<br/>
<br/>
edit: also, looking at Antonio's example here: <a href="http://forum.gbadev.org/viewtopic.php?t=16251" target="_blank">http://forum.gbadev.org/viewtopic.php?t=16251</a>
<br/>
<br/>
Since glFlush() is called for both scenes, why isn't there a constant flickering?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165291 - DiscoStew - Tue Dec 16, 2008 7:07 am</h4>
    <div class="postbody"><span class="postbody">Yes, you can only achieve at max 30FPS using this method, because the DS is set at a refresh rate of 60Hz, and the 3D engine and capture unit can only perform their tasks once per frame, and it requires using both twice to get this effect.
<br/>
<br/>
There are 2 glFlush commands in this, but both are not called in the same frame. Each section takes a turn, occupying a frame each, but according to the example, the glFlush commands "could" be placed outside the if-split, making only one needed overall.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165296 - Echo49 - Tue Dec 16, 2008 9:36 am</h4>
    <div class="postbody"><span class="postbody">I mean, flush is called for scene1, then during the next frame it's called for scene2, then scene1, and so on, so why doesn't the screen flicker between the two screens?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165308 - AntonioND - Tue Dec 16, 2008 3:38 pm</h4>
    <div class="postbody"><span class="postbody">Because you show the 3D scene one frame and the next you show the captured image of last frame. For example, for dual 3D:
<br/>
<br/>
Frame A:
<br/>
-Screen1: Rendered 3D scene1. -- Capture for next frame.
<br/>
-Screen2: Captured scene2.
<br/>
<br/>
Frame B:
<br/>
-Screen1: Captured scene1.
<br/>
-Screen2: Rendered 3D scene2. -- Capture for next frame.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165309 - DiscoStew - Tue Dec 16, 2008 4:02 pm</h4>
    <div class="postbody"><span class="postbody">Hehe, just to let you know, the 3D layer "is" flickering between the 2 scenes in the texture example....you just can't see it. AntonioND and I came up with separate methods, but both have sort of the same principle; prevent the 3D layer itself from being shown. For that (as used in the example), you make BG0 inactive, and either use a Framebuffer mode or activate an extra background layer that "covers" the 3D layer (BG0). Unfortunately, this requires that an extra VRAM bank be used, because it isn't just one frame being captured, but both one after the other.
<br/>
<br/>
However, I'm thinking that there might be a way to free up one of the two VRAM banks used, but this method requires AntonioND's method with the framebuffer. I'll see if I can do it, and hopefully have my results tonight or tomorrow, but Finals come first.  :P<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165313 - Kaiser - Tue Dec 16, 2008 7:21 pm</h4>
    <div class="postbody"><span class="postbody">Interesting stuff. I'll try playing around with this and see what comes up. I think the main challenge here is timing the two frames and prevent any flickering.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165315 - AntonioND - Tue Dec 16, 2008 8:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DiscoStew wrote:</b></span></td> </tr> <tr> <td class="quote">I'll see if I can do it, and hopefully have my results tonight or tomorrow, but Finals come first.  :P</td> </tr></table><span class="postbody">
<br/>
Good luck in both things. :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#165317 - DiscoStew - Tue Dec 16, 2008 11:16 pm</h4>
    <div class="postbody"><span class="postbody">Nvm. My idea won't work. Don't know where I got the idea from, but I was under the assumption that the capture unit could also capture to Main Memory so then it could go through the Main Memory Display FIFO to output to Display A. My assumption was wrong.  :(
<br/>
<br/>
Maybe have it capture to VRAM, then right afterwards do a manual copy into main memory, then follow along with the Main Memory Display FIFO? What that might do is allow one of two frames to only need 1 VRAM bank, but the other frame would still need two? Having unequal uses of VRAM wouldn't be ideal for displaying 2 3D screens of the same scene, but it might have other uses. This sort of thing is a bit more complicated than I'm used to. Don't know when I could get around for this one.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
