<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>fwrite() output strings truncated - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > fwrite() output strings truncated</h2>
<div id="posts">
<div class="post">
    <h4>#129387 - gmf - Tue May 22, 2007 8:47 am</h4>
    <div class="postbody"><span class="postbody">I'm not a programmer by trade, but I've managed to skim through all topics and generally have found direct and sufficiently dumbed down terminology to address every difficulty I've had for the DS programming, except for this last one which has been gnawing me for a while.  It's just a simple *.ini file write using libfat (the fread() works fine for the most part), but for some reason my output with fwrite() doesn't output more than four characters with each write.  I'm using the latest devkitpro, libfat, and it says it's patching fine with the supercard lite DLDI (it's actually the only thing I have to test it on).  The problem isn't logical, as I've just been looking at straight-up writes.  Soooo... the following code (just testing stuff):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
FILE* init;
<br/>
<br/>
char* line="AB\nCDE\nGHIJ";
<br/>
char* line2="\nKLMNO\nPQRST";
<br/>
<br/>
init = fopen ("LC2.ini", "w");
<br/>
<br/>
fwrite(line , sizeof(line[0]) , sizeof(line) ,init);
<br/>
fwrite(line2 , sizeof(line2[0]) , sizeof(line2) ,init);
<br/>
<br/>
fclose(init);
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
Yields the following output:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
AB
<br/>
C
<br/>
KLM
<br/>
</td> </tr></table><span class="postbody">
<br/>
So it just outputs four characters from the beginning of each...Am I missing something terribly obvious here?  I wouldn't expect it to be anything too complicated, as I'm very unacquainted with file outputs in c++ (i've just done in-lab quantitative analyses with regex in perl...seemingly much smoother, of course).  So, apologies if this seems to be fundamentally a waste of anyone's time.  I really did search the forums for a long time, and it seems that fwrite() in libfat hasn't had many complaints as of late.
<br/>
And if this is just a random error, should I just tokenize everything into four character strings? (for some reason it doesn't like me doing that right now, but that has to be my own logic fault).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129390 - Sunray - Tue May 22, 2007 9:07 am</h4>
    <div class="postbody"><span class="postbody">sizeof(line) is not what you want. Use strlen(line) instead.
<br/>
<br/>
line is a pointer, sizeof(line) is the size of a pointer (= 4 bytes).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#129393 - gmf - Tue May 22, 2007 10:32 am</h4>
    <div class="postbody"><span class="postbody">well... that was even sillier than I anticipated.  &lt;Kaufman&gt;Thank you very much.&lt;/Kaufman&gt;</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
