<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Compiling with devkitARM r21 under linux - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Compiling with devkitARM r21 under linux</h2>
<div id="posts">
<div class="post">
    <h4>#147341 - tempest - Wed Dec 19, 2007 12:34 am</h4>
    <div class="postbody"><span class="postbody">Hello, tonight I've decided to give devkitARM r21 a shot under my Linux box (Ubuntu 7.10 - Gutsy); being accustomed to Windows' "let-me-do-all-the-work" installer I'm having some troubles to setup the toolchain.
<br/>
<br/>
This has been my progress so far:
<br/>
<br/>
Downloaded files:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">devkitARM_r21-linux.tar.bz2
<br/>
libfat-src-20070127.tar.bz2
<br/>
libnds-src-20071023.tar.bz2
<br/>
nds-examples-20071023.tar.bz2
<br/>
</td> </tr></table><span class="postbody">
<br/>
Added these lines in my ~/.bashrc:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">export DEVKITPRO=~/devkitPRO
<br/>
export DEVKITARM=$DEVKITPRO/devkitARM
<br/>
</td> </tr></table><span class="postbody">
<br/>
Installation:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">cd ~
<br/>
mkdir devkitPRO
<br/>
cd devkitPRO
<br/>
tar xvjf devkitARM_r21-linux.tar.bz2
<br/>
mkdir libnds
<br/>
cd libnds
<br/>
tar xvjf libnds-src-20071023.tar.bz2
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
At this point I can build libnds just by typing <span style="font-weight: bold">make</span> in the libnds directory. Fine, so I try the same with libfat; in <a class="postlink" href="http://www.nabble.com/Re%3A-Problem-compiling-examples-in-Linux-p13417132.html" target="_blank">this post</a> wintermute suggests to create a libfat directory inside libnds directory, so here I go:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">mkdir libfat
<br/>
tar xvjf libfat-src-20070127.tar.bz2
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
But this time <span style="font-weight: bold">make -C nds</span> doesn't work as well:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">io_scsd_s.s
<br/>
arm-eabi-gcc -MMD -MP -MF /home/tempest/devkitPRO/libnds/libfat/nds/release/io_scsd_s.d -x assembler-with-cpp -g -mthumb -mthumb-interwork -c /home/tempest/devkitPRO/libnds/libfat/nds/../source/disc_io/io_scsd_s.s -o io_scsd_s.o
<br/>
mkdir /home/tempest/devkitPRO/libnds/libfat/nds/release/../nds/lib
<br/>
mkdir: cannot create directory `/home/tempest/devkitPRO/libnds/libfat/nds/release/../nds/lib': No such file or directory
<br/>
make[1]: *** [/home/tempest/devkitPRO/libnds/libfat/nds/release/../nds/lib] Error 1
<br/>
make: *** [release] Error 2
<br/>
make: Leaving directory `/home/tempest/devkitPRO/libnds/libfat/nds'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The error is on mkdir invocation; one could work around it using "mkdir -p" instead of plain mkdir, but maybe I have a flaw in my directory structure?
<br/>
<br/>
Thanks in advance for any suggestion!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147380 - melw - Wed Dec 19, 2007 11:53 am</h4>
    <div class="postbody"><span class="postbody">I think you're overusing the directories here, skip the libfat directory and install everything straight into the libnds directory. A normal installation has just devkitPRO/libnds/lib/ and devkitPRO/libnds/include directories, former with needed lib (.a) files and the latter with all header (.h) files. When building the libraries from source, you don't need to extract the source in the same directory either. In fact to keep the installation nice and clean I'd recommend to extract the sources elsewhere.
<br/>
<br/>
(I have actually never installed devkitARM on Linux, but this is how it looks on my living room Mac - should be essentially all the same.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147381 - moshii - Wed Dec 19, 2007 12:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>melw wrote:</b></span></td> </tr> <tr> <td class="quote">I think you're overusing the directories here, skip the libfat directory and install everything straight into the libnds directory.)</td> </tr></table><span class="postbody">
<br/>
<br/>
Without proper packages is probably best not to mix the contents of the binary tarballs.. from a system maintenance point of view. My setup works with each library in a specific directory, and I believe the template makefiles are actually designed to handle that.....
<br/>
<br/>
One thing I have found is that the makefiles or some of the tools don't handle symlinks and builds will fail if your working directory has a symlink somewhere in it's path.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147479 - wintermute - Fri Dec 21, 2007 10:54 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tempest wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
At this point I can build libnds just by typing <span style="font-weight: bold">make</span> in the libnds directory. Fine, so I try the same with libfat; in <a class="postlink" href="http://www.nabble.com/Re%3A-Problem-compiling-examples-in-Linux-p13417132.html" target="_blank">this post</a> wintermute suggests to create a libfat directory inside libnds directory, so here I go:
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
You misunderstood the post. The installer places the binaries for DS libraries in the libnds folder, not in a subdirectory.
<br/>
<br/>
Most, if not all of the source distributions have an install target which installs the libraries and headers in the appropriate place. While you can put the source and the binaries for libnds in the same folder I'd really recommend that you keep the source folder separate &amp; run make install from there.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
But this time <span style="font-weight: bold">make -C nds</span> doesn't work as well:
<br/>
mkdir /home/tempest/devkitPRO/libnds/libfat/nds/release/../nds/lib
<br/>
mkdir: cannot create directory 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This one is a bit weird, running make directly in the nds or gba subdirectories will cause this but it's actually a flaw in the way TOPDIR is created if it doesn't exist. It shouldn't happen when running from the root directory.
<br/>
<br/>
I've corrected this in CVS but you won't currently be able to build libfat from there since it requires devkitARM r22 which hasn't been released and the full patchset for that isn't yet in CVS. You could probably try copying over the makefiles from CVS and see if that helps any.
<br/>
<br/>
Your other option is to try the experimental linux installer instead. See <a href="http://forums.devkitpro.org/viewtopic.php?f=25&amp;t=10" target="_blank">http://forums.devkitpro.org/viewtopic.php?f=25&amp;t=10</a> for details.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"><br/><br/>Last edited by wintermute on Fri Dec 21, 2007 7:54 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#147499 - moshii - Fri Dec 21, 2007 7:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Your other option is to try the experimental linux installer instead. See <a href="http://forums.devkitpro.org/viewtopic.php?f=25&amp;t=10" target="_blank">http://forums.devkitpro.org/viewtopic.php?f=25&amp;t=10</a> for details.</td> </tr></table><span class="postbody">
<br/>
<br/>
Solves a problem that doesn't exist to be honest... and a quick scan of the code seems to suggest that it doesn't even check if the platform it going to unpack i386 binaries on is even i386 compatible. Ouch</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147502 - wintermute - Fri Dec 21, 2007 7:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>moshii wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Your other option is to try the experimental linux installer instead. See <a href="http://forums.devkitpro.org/viewtopic.php?f=25&amp;t=10" target="_blank">http://forums.devkitpro.org/viewtopic.php?f=25&amp;t=10</a> for details.</td> </tr></table><span class="postbody">
<br/>
<br/>
Solves a problem that doesn't exist to be honest... and a quick scan of the code seems to suggest that it doesn't even check if the platform it going to unpack i386 binaries on is even i386 compatible. Ouch</span></td> </tr></table><span class="postbody">
<br/>
<br/>
1. You'd be surprised how many people running linux appear to be completely incapable of setting up devkitARM properly.
<br/>
<br/>
2. I used the term experimental for a reason.
<br/>
<br/>
3. Nobody said you *had* to use it.
<br/>
<br/>
4. If you think it's broken then supply a patch.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#147559 - moshii - Sun Dec 23, 2007 5:31 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
4. If you think it's broken then supply a patch.</td> </tr></table><span class="postbody">
<br/>
<br/>
10 minutes, a can of coke... and checkinstall; I might read the checkinstall man page later and setup the correct dependencies so that libnds depends on the correct version of dka etc. Maybe.
<br/>
<br/>
<a href="http://debian.cardboardbox.org.uk/debkitpro/" target="_blank">http://debian.cardboardbox.org.uk/debkitpro/</a>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sumomo:/home/daniel/Desktop/debkitpro/libnds-20071023# dpkg -i libnds_20071023-1_amd64.deb
<br/>
(Reading database ... 125257 files and directories currently installed.)
<br/>
Preparing to replace libnds 20071023-1 (using libnds_20071023-1_amd64.deb) ...
<br/>
Unpacking replacement libnds ...
<br/>
Setting up libnds (20071023-1) ...
<br/>
sumomo:/home/daniel/Desktop/debkitpro/libnds-20071023# dpkg -r libnds
<br/>
(Reading database ... 125257 files and directories currently installed.)
<br/>
Removing libnds ...
<br/>
sumomo:/home/daniel/Desktop/debkitpro/libnds-20071023# ls /usr/local/debkitpro/
<br/>
devkitarm  dswifi  libfat
<br/>
sumomo:/home/daniel/Desktop/debkitpro/libnds-20071023#</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
