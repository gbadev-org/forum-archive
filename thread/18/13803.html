<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Detecting SRAM? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Detecting SRAM?</h2>
<div id="posts">
<div class="post">
    <h4>#136024 - spinal_cord - Sat Jul 28, 2007 4:20 pm</h4>
    <div class="postbody"><span class="postbody">I was looking through some of the PALib help files, and noticed that although there are functions for reading/writing sram, there does not seem to be a simple doesSRAMexist() (or similar) function. So I was wondering, is there a way to tell if the cart being used has sram or not? before trying to use it.<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136032 - tepples - Sat Jul 28, 2007 5:52 pm</h4>
    <div class="postbody"><span class="postbody">By "SRAM", you're talking about GBA SRAM in 0xA0000000-0xA0007FFF, right? You could just read the SRAM and use a heuristic to see whether the data is valid. Try a GBA game known to use SRAM (e.g. <span style="font-style: italic">F-Zero Maximum Velocity</span>) and try open air.
<br/>
<br/>
What are you ultimately trying to do with the SRAM?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136048 - spinal_cord - Sat Jul 28, 2007 7:43 pm</h4>
    <div class="postbody"><span class="postbody">Just use it fro saves etc. I'm wondering if it is save to attempt read/write if there is no sram, like in  gbamp.<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136055 - tepples - Sat Jul 28, 2007 8:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>spinal_cord wrote:</b></span></td> </tr> <tr> <td class="quote">Just use it fro saves etc.</td> </tr></table><span class="postbody">
<br/>
If you are not trying to have your program interact with commercial GBA Game Paks, then the preferred method of saving in DS homebrew is libfat, not GBA SRAM. At least the SuperCard will destroy the SRAM contents if the power stays off for a significant length of time.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'm wondering if it is save to attempt read/write if there is no sram, like in  gbamp.</td> </tr></table><span class="postbody">
<br/>
It should be safe to use the SRAM, as long as there is a homebrew card (GBA header signature == "PASS") in the GBA slot.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136063 - Ant6n - Sat Jul 28, 2007 9:04 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"> At least the SuperCard will destroy the SRAM contents if the power stays off for a significant length of time.
<br/>
</td> </tr></table><span class="postbody">
<br/>
what length of time (hours, days, months)?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136068 - dantheman - Sat Jul 28, 2007 9:45 pm</h4>
    <div class="postbody"><span class="postbody">It's a matter of seconds or minutes for the Supercard CF, SD, and Lite versions, while the Supercard miniSD does have a battery to back up the SRAM.  Keep in mind however that even with the miniSD version, unless the user uses a method to save the SRAM to a *.sav file on the card, it will be overwritten the next time any program writes to it.  Methods include a button combination (after running the file through the Supercard patcher) and the <a class="postlink" href="http://www.google.com/search?q=qpc%20saving" target="_blank">QPC method</a>.  The DS program DumpSRAM can also be used in place of the Saver tab when using the QPC method, which is useful for Rumble users that find the Saver tab to be broken in DS mode when using the latest few firmware versions.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136108 - josath - Sun Jul 29, 2007 8:33 am</h4>
    <div class="postbody"><span class="postbody">Ideally, you should use libfat to save your game data, and only use SRAM if libfat fails to detect a compatible card.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136111 - Ant6n - Sun Jul 29, 2007 9:01 am</h4>
    <div class="postbody"><span class="postbody">well, sure. but on gba that might not be that easy, i believe on gba libfat only works when compiling as multiboot.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136141 - wintermute - Sun Jul 29, 2007 5:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">well, sure. but on gba that might not be that easy, i believe on gba libfat only works when compiling as multiboot.</td> </tr></table><span class="postbody">
<br/>
<br/>
Why would you believe that?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136142 - wintermute - Sun Jul 29, 2007 5:41 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">well, sure. but on gba that might not be that easy, i believe on gba libfat only works when compiling as multiboot.</td> </tr></table><span class="postbody">
<br/>
<br/>
Sorry, I assumed he meant for DS only, since he mentioned PAlib (a ds-only library) and this was posted in the DS Development forum.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
And given that PAlib is a DS only library it should really be avoiding use of GBA specific things like GBA cart SRAM. It might have been useful back before we had slot 1 cards but these days slot 2 features should be avoided unless *absolutely necessary.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136156 - Ant6n - Sun Jul 29, 2007 8:45 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Ant6n wrote:</b></span></td> </tr> <tr> <td class="quote">well, sure. but on gba that might not be that easy, i believe on gba libfat only works when compiling as multiboot.</td> </tr></table><span class="postbody">
<br/>
Why would you believe that?</span></td> </tr></table><span class="postbody">
<br/>
well, since there is not much documentation, or an example to come along with devkitarm, i can't know for sure. But
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=13354&amp;highlight=libfat+multiboot" target="_blank">http://forum.gbadev.org/viewtopic.php?t=13354&amp;highlight=libfat+multiboot</a>
<br/>
seems to suggest it, also, nobody contradicted me on my help request <a href="http://forum.gbadev.org/viewtopic.php?t=13793&amp;highlight=libfat+multiboot." target="_blank">http://forum.gbadev.org/viewtopic.php?t=13793&amp;highlight=libfat+multiboot.</a> After some hours of fiddling with it following exact instructions on chishm's page (which are sparse), it always gave random crashes. So i basicly arrived at the believe that one cannot use the gba-slot to run code from and read from a fat device at the same time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136169 - wintermute - Sun Jul 29, 2007 9:26 pm</h4>
    <div class="postbody"><span class="postbody">Heh, I deleted that post within a second or two of making it :/
<br/>
<br/>
I realised after I posted that most slot 2 devices probably have their registers in the GBA rom area so it might be somewhat difficult to get this working. Maybe Chishm can shed some light later.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#136214 - chishm - Mon Jul 30, 2007 5:43 am</h4>
    <div class="postbody"><span class="postbody">If you have the disc IO routines in RAM, and those routines switch the cart between ROM and disc and back again, then you should be able to do it without running as a multiboot program. The rest of the FAT library can be in ROM, as can the rest of the program. It will be slower than normal, and you'll need to write your own drivers that do the switching, but it is possible. Why you would want to do it, I dunno. Since this is on DS (should've posted in a GBA forum otherwise), you have 4MiB for code and variables.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
