<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprite memory question. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Sprite memory question.</h2>
<div id="posts">
<div class="post">
    <h4>#148504 - nipil - Sun Jan 06, 2008 4:34 pm</h4>
    <div class="postbody"><span class="postbody">Good day to you, i'm having some questions about sprite banks' use :
<br/>
<br/>
According to the defines in video.h, you ca use the following banks :
<br/>
- MAIN_SPRITE : A, B, E, F, G (total 336KB)
<br/>
- SUB_SPRITE : D, I (total 144KB)
<br/>
<br/>
As you can see, total differs from main and sub engines. My questions are :
<br/>
<br/>
- are we supposed to do most of the 2d work on the "main" ?
<br/>
<br/>
- is there a way to use let's say bank B on sub, or C on any ?
<br/>
<br/>
- and finally <span style="font-weight: bold">can we share a bank on both to avoid loading the same sprites twice</span> ?
<br/>
<br/>
Any hint would make me happy =)</span><span class="gensmall"><br/><br/>Last edited by nipil on Sun Jan 06, 2008 7:26 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#148506 - simonjhall - Sun Jan 06, 2008 4:42 pm</h4>
    <div class="postbody"><span class="postbody">If you've not yet seen it, have a look at:
<br/>
<a href="http://nocash.emubase.de/gbatek.htm#dsvideodisplaysystemblockdiagram" target="_blank">http://nocash.emubase.de/gbatek.htm#dsvideodisplaysystemblockdiagram</a>
<br/>
This shows which banks are can be used by both (look down the left). That doesn't necessarily mean though that you can assign one bank to both engines though! Sorry but I don't really know much about the 2D hardware so I can't be sure about this. DS 3D, however ;-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148512 - wintermute - Sun Jan 06, 2008 5:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>nipil wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
According to the defines in video.h, you ca use the following banks :
<br/>
- MAIN_SPRITE : A, B, E, G (total 336KB)
<br/>
- SUB_SPRITE : D, I (total 144KB)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Those defines aren't quite right - we still have to remove some that don't actually work. You can only assign 128K to engine B.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
- are we supposed to do most of the 2d work on the "main" ?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Not necessarily, you're just a little more limited on engine B.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
- is there a way to use let's say bank B on sub, or C on any ?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
No.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
- and finally <span style="font-weight: bold">can we share a bank on both to avoid loading the same sprites twice</span> ?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
No.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148518 - nipil - Sun Jan 06, 2008 5:51 pm</h4>
    <div class="postbody"><span class="postbody">Thanks a lot for these answers.
<br/>
Clear, fast and efficient ;)
<br/>
Good evening !</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148522 - wintermute - Sun Jan 06, 2008 6:34 pm</h4>
    <div class="postbody"><span class="postbody">Just found the other doc I was looking for, it's a little clearer than gbatek about what VRAM banks can be used for.
<br/>
<br/>
<a href="http://dualis.1emu.net/dsti.html#lcdiovramcnt" target="_blank">http://dualis.1emu.net/dsti.html#lcdiovramcnt</a><br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148524 - nipil - Sun Jan 06, 2008 7:26 pm</h4>
    <div class="postbody"><span class="postbody">In this doc, the possible MAIN/SUB_SPRITE banks are the similar to those i listed (when looking at the Main/Sub OBJ function)...
<br/>
And when you say only 128K of sprites memory can be allocated to engine B (only bank "D"), then "I" shouldn't show up a Sub OBJ...
<br/>
<br/>
Gah. That thing is complicated. But i'll get it, one day.
<br/>
<br/>
PS: now i understand there's so much (example) code using the fb mode ;)
<br/>
<br/>
PPS: i added the missing "F" bank to MAIN_SPRITE in my first post</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148535 - tepples - Sun Jan 06, 2008 10:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>nipil wrote:</b></span></td> </tr> <tr> <td class="quote">In this doc, the possible MAIN/SUB_SPRITE banks are the similar to those i listed (when looking at the Main/Sub OBJ function)...
<br/>
And when you say only 128K of sprites memory can be allocated to engine B (only bank "D"), then "I" shouldn't show up a Sub OBJ...</td> </tr></table><span class="postbody">
<br/>
The point is that you can use <span style="font-weight: bold">either</span> D <span style="font-weight: bold">or</span> I. If you're using D for textures on the 3D core, you can use I for sprites on sub. In 3D mode, one common layout I've seen is
<br/>
<ol type="a"><li>Textures (128 KiB) </li><li>Textures (128 KiB) </li><li>Textures (128 KiB) </li><li>Textures (128 KiB) </li><li>Texture palettes (64 KiB) </li><li>Main background (16 KiB) </li><li>Main sprites (16 KiB) </li><li>Sub background (32 KiB) </li><li>Sub sprites (16 KiB) </li></ol><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148537 - wintermute - Sun Jan 06, 2008 10:42 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>nipil wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
And when you say only 128K of sprites memory can be allocated to engine B (only bank "D"), then "I" shouldn't show up a Sub OBJ...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Note the VRAM addresses those banks can be mapped to - you can either have 128K of sprite memory from bank D <span style="font-weight: bold">or</span> 16k from bank I. They're mutually exclusive.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148539 - nipil - Sun Jan 06, 2008 10:46 pm</h4>
    <div class="postbody"><span class="postbody">Right, i didn't look at the adresses, which are the same for D and I... I think i like this toy more and more. There's always something to discover =)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
