<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Playing/converting sounds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Playing/converting sounds</h2>
<div id="posts">
<div class="post">
    <h4>#158263 - ZeroSum - Sun Jun 08, 2008 1:30 pm</h4>
    <div class="postbody"><span class="postbody">Hi again, I'm trying to play sounds using libnds but am having some trouble playing them correctly. The SimpleSound example works great but using the example code and raw's in my own code everything sounds extremely 'tinny' and distorted. I've been searching around but keep getting contradictory information.
<br/>
<br/>
1. What is the 'correct' format for my own simple sound effects (1-2 second wav's)? So far I'm converting to 11025hz, 8bit, signed raw files using SoX. 
<br/>
<br/>
2. How do I get the makefile to convert the .raw's to .o for me? I've added (copied from the SimpleSound example makefile):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#---------------------------------------------------------------------------------
<br/>
%.raw.o   :   %.raw
<br/>
#---------------------------------------------------------------------------------
<br/>
   @echo $(notdir $&lt;)
<br/>
   @$(bin2o)</td> </tr></table><span class="postbody">
<br/>
to the makefile and made sure the raw was in the data dir but it seems to do nothing. I'm rather new to makefiles so I'm guessing I've missed something. I've just been renaming the .raw to a .bin but would prefer not to have to do that.
<br/>
<br/>
3. The code I'm using to play sounds is just like from the example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
TransferSoundData blaster = {
<br/>
   blaster_bin,      /* Sample address */
<br/>
   blaster_bin_size,   /* Sample length */
<br/>
   11025,            /* Sample rate */
<br/>
   127,            /* Volume */
<br/>
   64,               /* panning */
<br/>
   1                /* format */
<br/>
};
<br/>
<br/>
playSound(&amp;blaster);</td> </tr></table><span class="postbody">
<br/>
I'm using the default arm7 code and devkitPro r23b. Have I (again) missed something which is why everything sounds distorted? Both my own raw's and the example ones both sound wrong.
<br/>
<br/>
Thanks for reading.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158265 - eKid - Sun Jun 08, 2008 2:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">1. What is the 'correct' format for my own simple sound effects (1-2 second wav's)? So far I'm converting to 11025hz, 8bit, signed raw files using SoX. </td> </tr></table><span class="postbody">
<br/>
<br/>
The tinny sound may be from the low sampling rate (11025 is pretty low). Does the quality improve with higher sampling rates?
<br/>
<br/>
Converting 16-bit to 8-bit may cause a tiny bit of distortion (a bit of white noise), but it usually isn't much of an issue.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158268 - tepples - Sun Jun 08, 2008 5:08 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ZeroSum wrote:</b></span></td> </tr> <tr> <td class="quote">The SimpleSound example works great but using the example code and raw's in my own code everything sounds extremely 'tinny' and distorted.</td> </tr></table><span class="postbody">
<br/>
Are you playing your audio through the DS's internal speaker or through headphones? Internal speakers in handheld video game systems have a strong high-pass characteristic, blocking most sound below about 500 Hz. Headphones should reproduce bass more accurately.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158277 - ZeroSum - Sun Jun 08, 2008 7:06 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the replies, I thought it may be that too but after messing around some more I don't think thats it. The SimpleSound example on hardware will play the 'blaster' sound perfectly fine (its the blaster from Star Wars?), yet if I copy the blaster.raw file to my own program and use the exact same code the blaster sound is really distorted. I think I might have missed setting something up but comparing to the example to my code its exactly the same.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158278 - silent_code - Sun Jun 08, 2008 7:13 pm</h4>
    <div class="postbody"><span class="postbody">I am in no position to help you much, as I have only had experience with basic sound programming myself, but I can tell you, this looks a lot like you will have to show your implementation.
<br/>
At least some more information is needed.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158333 - ZeroSum - Mon Jun 09, 2008 11:10 am</h4>
    <div class="postbody"><span class="postbody">After getting up this morning I saw the problem right away. I was playing the sound inside of a keysHeld() if instead of keysDown() so the distorted sound was it playing over itself a couple of times, it works great now. Lesson learned too &gt;&lt;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158334 - silent_code - Mon Jun 09, 2008 11:32 am</h4>
    <div class="postbody"><span class="postbody">There is nothing better than a pair of "fresh" eyes (and ears, when working with audio.) :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
