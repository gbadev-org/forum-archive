<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Errors, please help - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Errors, please help</h2>
<div id="posts">
<div class="post">
    <h4>#67552 - Maverick - Wed Jan 18, 2006 11:58 pm</h4>
    <div class="postbody"><span class="postbody">hello
<br/>
<br/>
i have been trying to compile a slightly cut down version of ethos' sourcecode for lesson 2. The cut down part was removing anything that wasnt there to display the scene
<br/>
<br/>
Here is my code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include &lt;nds.h&gt;
<br/>
#include "..\..\opengl\gl.h"
<br/>
<br/>
<br/>
int main()
<br/>
{
<br/>
powerON(POWER_ALL);
<br/>
videoSetMode(MODE_0_3D);
<br/>
glViewPort(0,0,255,191);
<br/>
glClearColor(0,0,0);
<br/>
glClearDepth(0x7FFF);
<br/>
while (1) {
<br/>
glReset();
<br/>
gluPerspective(35, 256.0 / 192.0, 0.1, 40);
<br/>
gluLookAt(0.0, 0.0, 1.0,
<br/>
     0.0, 0.0, 0.0,
<br/>
     0.0, 1.0, 0.0);
<br/>
glPolyFmt(POLY_ALPHA(31) | POLY_CULL_NONE);
<br/>
glMatrixMode(GL_MODELVIEW);
<br/>
glPushMatrix();
<br/>
glColor3f32(intof32(1),intof32(1),intof32(1));
<br/>
glLoadIdentity();
<br/>
glTranslate3f32(floatof32(-1.5),0,intof32(-6));
<br/>
glBegin(GL_TRIANGLES);
<br/>
glVertex3f32(0, intof32(1), 0);
<br/>
glVertex3f32(intof32(-1), intof32(-1), 0);
<br/>
glVertex3f32(intof32( 1), intof32(-1), 0);
<br/>
glEnd();
<br/>
glTranslate3f32(intof32(3),0,0);
<br/>
glBegin(GL_QUADS);
<br/>
glVertex3f32(intof32(-1), intof32( 1), 0);
<br/>
glVertex3f32(intof32( 1), intof32( 1), 0);
<br/>
glVertex3f32(intof32( 1), intof32(-1), 0);
<br/>
glVertex3f32(intof32(-1), intof32(-1), 0);
<br/>
glEnd();
<br/>
glPopMatrix(1);
<br/>
glFlush();
<br/>
}
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
And here is the batch file i am using to compile(the arm7.c file is an empty main() btw):
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">path=E:\DevKitARM\bin\
<br/>
arm-elf-gcc -mcpu=arm7tdmi -mtune=arm7tdmi -mthumb-interwork -DARM7 -c arm7.c -oarm7.o
<br/>
arm-elf-gcc -mthumb-interwork -specs=ds_arm7.specs arm7.o -o arm7.elf
<br/>
arm-elf-objcopy -O binary arm7.elf arm7.bin
<br/>
arm-elf-gcc -mcpu=arm9tdmi -mtune=arm9tdmi -mthumb-interwork -DARM9 -IE:\DevKitARM\include\libnds\include -c arm9.c -oarm9.o
<br/>
arm-elf-gcc -mthumb-interwork -specs=ds_arm9.specs arm9.o -o arm9.elf
<br/>
arm-elf-objcopy -O binary arm9.elf arm9.bin
<br/>
ndstool -c arm.nds -9 arm9.bin -7 arm7.bin -b ..\..\icon.bmp "Test;Just a test;To see what it does!" -o ..\..\logo.bin
<br/>
del *.o *.elf *.bin
<br/>
pause</td> </tr></table><span class="postbody">
<br/>
<br/>
And when i compile, i get this:
<br/>
<br/>
In file included from arm9.c:2:
<br/>
..\..\opengl\gl.h:6:1: warning: "f32tot16" redefined
<br/>
In file included from E:\DevKitARM\include\libnds\include/nds.h:63,
<br/>
                 from arm9.c:1:
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.h:91:1: warning: this is the location of the previous definition
<br/>
In file included from ..\..\opengl\gl.h:15,
<br/>
                 from arm9.c:2:
<br/>
..\..\opengl\/glRoutines.h:6: error: conflicting types for 'glTranslatef32'
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.inl:88: error: previous definition of 'glTranslatef32' was here
<br/>
..\..\opengl\/glRoutines.h:8: error: conflicting types for 'glScalef32'
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.inl:80: error: previous definition of 'glScalef32' was here
<br/>
<br/>
Ive ran out of ideas and was wondering if anybody was able to help, or had sorted this problem for themselves already
<br/>
<br/>
Thanks for any help<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67587 - HyperHacker - Thu Jan 19, 2006 5:30 am</h4>
    <div class="postbody"><span class="postbody">You sure you're supposed to include the standard gl.h? I haven't used it on DS but it seems unusual. If you are, try switching the order and include gl.h before nds.h. All the errors are complaining of things being defined in one header and redefined in another, so your code probably isn't the problem.
<br/>
<br/>
Also, that make script looks like a stripped-down version of mine. Is it? (Don't mind if it is, just curious.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67601 - Maverick - Thu Jan 19, 2006 10:35 am</h4>
    <div class="postbody"><span class="postbody">This is the gl libs that came with ethos' source. If i take it out, i get:
<br/>
<br/>
arm9.o: In function `main':
<br/>
arm9.c:(.text+0x50): undefined reference to `glReset'
<br/>
arm9.c:(.text+0x64): undefined reference to `gluPerspective'
<br/>
arm9.c:(.text+0xa0): undefined reference to `gluLookAt'
<br/>
arm9.c:(.text+0xc4): undefined reference to `glColor3f32'
<br/>
arm9.c:(.text+0xf0): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x100): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x110): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x13c): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x14c): undefined reference to `glVertex3f32'
<br/>
arm9.o:arm9.c:(.text+0x15c): more undefined references to `glVertex3f32' follow
<br/>
<br/>
The make was very simple at first and has evolved to this point, strange coincedence that we might code in similar ways.<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67760 - HyperHacker - Fri Jan 20, 2006 3:37 am</h4>
    <div class="postbody"><span class="postbody">Great minds think alike I suppose. :-p (Mine's posted in one of my threads if you want to take a look.)
<br/>
<br/>
If removing that file gives undefined reference errors, then yeah, you probably want to leave it in. Did you try switching the order of the #includes? Also make sure you're not just missing a semicolon somewhere, that seems to make some compilers just go completely nuts, especially if it's in a header file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67802 - Maverick - Fri Jan 20, 2006 2:11 pm</h4>
    <div class="postbody"><span class="postbody">This is what i get when the includes are switched:
<br/>
<br/>
In file included from arm9.c:1:
<br/>
..\..\opengl\gl.h:6:1: warning: "f32tot16" redefined
<br/>
In file included from E:\DevKitARM\include\libnds\include/NDS.h:63,
<br/>
                 from ..\..\opengl\gl.h:4,
<br/>
                 from arm9.c:1:
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.h:91:1: warning: this is th
<br/>
e location of the previous definition
<br/>
In file included from ..\..\opengl\gl.h:15,
<br/>
                 from arm9.c:1:
<br/>
..\..\opengl\/glRoutines.h:6: error: conflicting types for 'glTranslatef32'
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.inl:88: error: previous def
<br/>
inition of 'glTranslatef32' was here
<br/>
..\..\opengl\/glRoutines.h:8: error: conflicting types for 'glScalef32'
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.inl:80: error: previous def
<br/>
inition of 'glScalef32' was here
<br/>
<br/>
I couldnt see any missed ;'s, but hey, i might be wrong
<br/>
<br/>
Has anyone managed to get this to work with libnds?<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67803 - Maverick - Fri Jan 20, 2006 2:19 pm</h4>
    <div class="postbody"><span class="postbody">If i go into ethos' source and change his glTranslatef32 and glScalef32 to glTranslate3f32 and glScale3f32, then i get this:
<br/>
<br/>
E:\DSDev\Mine(libnds)\NeHe\Lesson02&gt;arm-elf-gcc -mcpu=arm9tdmi -mtune=arm9tdmi -
<br/>
mthumb-interwork -DARM9 -IE:\DevKitARM\include\libnds\include -c arm9.c -oarm9.o
<br/>
<br/>
In file included from arm9.c:2:
<br/>
..\..\opengl\gl.h:6:1: warning: "f32tot16" redefined
<br/>
In file included from E:\DevKitARM\include\libnds\include/nds.h:63,
<br/>
                 from arm9.c:1:
<br/>
E:\DevKitARM\include\libnds\include/nds/arm9/videoGL.h:91:1: warning: this is th
<br/>
e location of the previous definition
<br/>
<br/>
E:\DSDev\Mine(libnds)\NeHe\Lesson02&gt;arm-elf-gcc -mthumb-interwork -specs=ds_arm9
<br/>
.specs arm9.o -o arm9.elf
<br/>
arm9.o: In function `main':
<br/>
arm9.c:(.text+0x50): undefined reference to `glReset'
<br/>
arm9.c:(.text+0x64): undefined reference to `gluPerspective'
<br/>
arm9.c:(.text+0xa0): undefined reference to `gluLookAt'
<br/>
arm9.c:(.text+0xc4): undefined reference to `glColor3f32'
<br/>
arm9.c:(.text+0xf0): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x100): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x110): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x13c): undefined reference to `glVertex3f32'
<br/>
arm9.c:(.text+0x14c): undefined reference to `glVertex3f32'
<br/>
arm9.o:arm9.c:(.text+0x15c): more undefined references to `glVertex3f32' follow<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67905 - tepples - Sat Jan 21, 2006 6:34 am</h4>
    <div class="postbody"><span class="postbody">"undefined reference" usually means you forgot to specify a library to be linked into your arm9.elf file.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#67935 - Maverick - Sat Jan 21, 2006 10:19 am</h4>
    <div class="postbody"><span class="postbody">I know, i think its the videogl.inl file, they are being prototyped but no code is present after this.
<br/>
<br/>
Here is my source, if anyone can get it to work with libnds, id love to know how:
<br/>
<br/>
<a class="postlink" href="http://downtou.ne1.net/ds/source/Lesson02.rar" target="_blank">http://downtou.ne1.net/ds/source/Lesson02.rar</a><br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"><br/><br/>Last edited by Maverick on Mon Jan 23, 2006 5:27 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#68289 - Maverick - Mon Jan 23, 2006 4:14 pm</h4>
    <div class="postbody"><span class="postbody">I have got it as far as this by forcing the .c files to be included:
<br/>
<br/>
<br/>
arm9.o: In function `glRotateZi':
<br/>
arm9.c:(.text+0x9c8): undefined reference to `SIN_bin'
<br/>
arm9.c:(.text+0x9cc): undefined reference to `COS_bin'
<br/>
arm9.o: In function `glRotateYi':
<br/>
arm9.c:(.text+0xab4): undefined reference to `SIN_bin'
<br/>
arm9.c:(.text+0xab8): undefined reference to `COS_bin'
<br/>
arm9.o: In function `glRotateXi':
<br/>
arm9.c:(.text+0xba0): undefined reference to `SIN_bin'
<br/>
arm9.c:(.text+0xba4): undefined reference to `COS_bin'
<br/>
arm9.o: In function `glRotatef32i':
<br/>
arm9.c:(.text+0xeb0): undefined reference to `SIN_bin'
<br/>
arm9.c:(.text+0xeb4): undefined reference to `COS_bin'
<br/>
arm9.o: In function `gluPerspectivef32':
<br/>
arm9.c:(.text+0x25e8): undefined reference to `TAN_bin'
<br/>
arm9.o: In function `glTexImage2D':
<br/>
arm9.c:(.text+0x3350): undefined reference to `swiCopy'
<br/>
arm9.o: In function `glTexLoadPal':
<br/>
arm9.c:(.text+0x33d4): undefined reference to `swiCopy'
<br/>
<br/>
But cannot get any further. I have updated the source code download. Is anyone able to help?<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68290 - Normmatt - Mon Jan 23, 2006 4:33 pm</h4>
    <div class="postbody"><span class="postbody">your link doesnt seem to work</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#68300 - Maverick - Mon Jan 23, 2006 5:28 pm</h4>
    <div class="postbody"><span class="postbody">Sorry, fixed<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
