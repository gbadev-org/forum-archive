<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>inflateTT/deflateTT - Data compression/decompression for DS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > inflateTT/deflateTT - Data compression/decompression for DS</h2>
<div id="posts">
<div class="post">
    <h4>#116651 - ttursas - Sat Jan 27, 2007 10:45 pm</h4>
    <div class="postbody"><span class="postbody">Hi!
<br/>
<br/>
I just released my implementations of deflate/inflate, the data compression/decompression
<br/>
algorithms (LZ77 + dynamic Huffman trees). Grab the sources here: <a href="http://www.villehelin.com/nintendoDS.html" target="_blank">http://www.villehelin.com/nintendoDS.html</a>
<br/>
<br/>
I didn't follow the RFC-1951 (DEFLATE) 100%, but what I did should be good enough. :)
<br/>
Anyway, deflateTT is the commandline tool to compress stuff, and inflateTT-DS is what
<br/>
you might want to integrate to your Nintendo DS homebrew project.
<br/>
<br/>
Note that inflateTT-DS doesn't need malloc() etc. dynamic memory manager, or libnds,
<br/>
so you should be able to port it also to GBA (just use it the way it is, should work directly?).</span><span class="gensmall"><br/><br/>Last edited by ttursas on Sat Apr 21, 2007 7:41 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#116660 - Lick - Sat Jan 27, 2007 11:46 pm</h4>
    <div class="postbody"><span class="postbody">Wow cool, have you done any tests with it? Is it any better than the BIOS functions?<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#116661 - tepples - Sat Jan 27, 2007 11:48 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ttursas wrote:</b></span></td> </tr> <tr> <td class="quote">I didn't follow the RFC-1951 (DEFLATE) 100%, but what I did should be good enough. :)</td> </tr></table><span class="postbody">
<br/>
Is it compatible with existing DEFLATE-based formats such as PKZIP and Gzip?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#116685 - ttursas - Sun Jan 28, 2007 10:40 am</h4>
    <div class="postbody"><span class="postbody">I haven't compared it to the BIOS stuff, only to gzip. Here's an example:
<br/>
<br/>
The texture that holds the HUD stuff, particles, etc. misc stuff in Wright Flight, 65536B RAW.
<br/>
With gzip, 3605B. With deflateTT, 3828B.
<br/>
<br/>
This is because, I think, I don't store the Huffman trees as optimally as the RFC suggests.
<br/>
Too lazy to do that. :) Anyway, deflateTT is pretty slow, but inflateTT-DS is fast enough so
<br/>
that I can on demand, on the fly, decompress those 128x128 airplane textures. I.e., when
<br/>
a new plane appears on the screen I allocate it room in the VRAM and uncompress its
<br/>
texture there. Works pretty nicely... Start a network match where each player has his own
<br/>
plane and see that it works ok. :)
<br/>
<br/>
And naturally, in the future, I'll write that inflateTT-DS in ARM. :) But more important things
<br/>
first...
<br/>
<br/>
...
<br/>
<br/>
And nope, it's not compatible with PKZIP or Gzip, because I didn't do the header parts
<br/>
according to the specs. The compressed data is stored the way RFC-1951
<br/>
describes, so that should be PKZIP/Gzip compatibe, I guess...
<br/>
<br/>
Anyway, I just wanted to get about the same level of compression than in Gzip, and
<br/>
here it is. I don't care about few bytes, needed just something better than my old
<br/>
RLE packer (anyway, it was just waiting for the moment to be replaced)...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#116686 - ttursas - Sun Jan 28, 2007 10:50 am</h4>
    <div class="postbody"><span class="postbody">If the DS BIOS does only LZ77 decompression, then DEFLATE is better, because
<br/>
DEFLATE has two phases, first it compresses with LZ77, and then it compresses the LZ77
<br/>
output with Huffman coding.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#116707 - ttursas - Sun Jan 28, 2007 5:37 pm</h4>
    <div class="postbody"><span class="postbody">I have to add here that inflateTT-DS takes some heap (around 5KBs total) for the Huffman trees, and the
<br/>
output writing could be more optimal, so if you want faster decompression with less
<br/>
overhead, LZSS might be a better choice.
<br/>
<br/>
inflateTT-DS doesn't decompress to a buffer, but directly to the output, so that's a plus if you
<br/>
consider memory usage. Also, if you have that 5KBs free elsewhere at the time of decompression,
<br/>
feel free to modify inflateTT-DS sources to use that memory instead of its static buffers. :)
<br/>
<br/>
Plus I'll make the next version of deflateTT/inflateTT to store the Huffman trees according
<br/>
to the RFC...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#126279 - ttursas - Sat Apr 21, 2007 7:44 pm</h4>
    <div class="postbody"><span class="postbody">Ok, I just released v1.1 of inflateTT and deflateTT (and inflateTT-DS). Now the Huffman
<br/>
code lengths are also RLE+Huffman compressed so you can expect to get ~200 bytes
<br/>
smaller files with this release. It's still not 100% RFC-1951 compatible, but almost. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#127865 - ttursas - Sat May 05, 2007 11:11 pm</h4>
    <div class="postbody"><span class="postbody">Just released v1.2... v1.1 was a bit buggy, it would choke on big files. Anyway, v1.2 can
<br/>
also RLE compress the raw Huffman code lengths, just like RFC-1951 says, so v1.2
<br/>
should be able to give a few bytes smaller archives than v1.1.
<br/>
<br/>
EDIT: v1.1 RLE'd zeroes in the Huffman code lengths, v1.2 can also RLE other values
<br/>
(RLE'd zeroes have their own codes)...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145918 - ttursas - Sun Nov 25, 2007 4:47 pm</h4>
    <div class="postbody"><span class="postbody">Ok, released version 1.3 of inflateTT-MP. inflate() is now thread safe, has return values, and the header file is C++ compatible. Just started to work on a C++ project with lots of threads... :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145921 - knight0fdragon - Sun Nov 25, 2007 6:45 pm</h4>
    <div class="postbody"><span class="postbody">couldnt you use the bios functions to make it faster? I believe the DS has support for both Huffman and LZ77<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145922 - tepples - Sun Nov 25, 2007 6:46 pm</h4>
    <div class="postbody"><span class="postbody">BIOS LZ77 is limited in the match length and window size. Besides, BIOS does not compress.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#145927 - knight0fdragon - Sun Nov 25, 2007 8:49 pm</h4>
    <div class="postbody"><span class="postbody">well compressing is not a problem if you are compressing it PC side<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#146249 - ttursas - Sat Dec 01, 2007 11:05 am</h4>
    <div class="postbody"><span class="postbody">deflateTT/inflateTT are not the optimal tools for data compression, but just something that you can pretty easily plug in. :) I'm using them all over the place, in Nintendo DS, PSP and PC projects, and it's pretty nice to be able to use one simple function call to decompress data with minimal setups etc.
<br/>
<br/>
Just consider these as an alternative, ok? :D</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
