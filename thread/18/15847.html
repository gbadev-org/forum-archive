<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Dual screen console output - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Dual screen console output</h2>
<div id="posts">
<div class="post">
    <h4>#160679 - Tor - Sun Jul 20, 2008 2:56 am</h4>
    <div class="postbody"><span class="postbody">I have outputting to both screens working, but I am looking for a way to switch between the two without having the screen cleared. If the consoleCls('2') is removed from console.c, when the screen is switched, there is garbage displayed. Is there anyway around this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160685 - silent_code - Sun Jul 20, 2008 9:52 am</h4>
    <div class="postbody"><span class="postbody">The main on top / bottom procedures should do the job... if that's what you are looking for? (You need to clarify how you are switching it, what the setup of the two 2D engines is and what the "garbage" looks like.)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160697 - Tor - Sun Jul 20, 2008 4:07 pm</h4>
    <div class="postbody"><span class="postbody">I added </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void consoleMoveMap(u16* map)
<br/>
{
<br/>
   row = col = 0;
<br/>
<br/>
   fontMap = map;
<br/>
}</td> </tr></table><span class="postbody"> to libnds's console.c and compiled the lib.
<br/>
<br/>
in my code i have </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">inline void consoleOnBottom()
<br/>
{
<br/>
     //consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(2),(u16*)SCREEN_BASE_BLOCK_SUB(0),16);
<br/>
   consoleMoveMap((u16*)SCREEN_BASE_BLOCK_SUB(2));
<br/>
}
<br/>
 
<br/>
inline void consoleOnTop()
<br/>
{  
<br/>
     //consoleInitDefault((u16*)SCREEN_BASE_BLOCK(2),(u16*)SCREEN_BASE_BLOCK(0),16);
<br/>
   consoleMoveMap((u16*)SCREEN_BASE_BLOCK(2));
<br/>
}</td> </tr></table><span class="postbody"> consoleInitDefault will erase the screen due to the consoleCls('2'); call. without it, when the screen switches, there are lots of pluses, asterisks, and weird looking box kinda things. They are all characters and not in the bitmap background because if i attempt to draw over them, they are still showing.
<br/>
<br/>
Oh, and the vram layout (if it matters)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetMode( MODE_5_2D | DISPLAY_BG0_ACTIVE | DISPLAY_BG3_ACTIVE );
<br/>
   
<br/>
   vramSetBankA( VRAM_A_MAIN_BG_0x06000000 );
<br/>
   
<br/>
   BG3_CR = BG_BMP16_256x256;
<br/>
   
<br/>
   BG3_XDX=256;
<br/>
   BG3_XDY=0;
<br/>
   BG3_YDX=0;
<br/>
   BG3_YDY=256;
<br/>
   
<br/>
   BG3_CY = (16*256);
<br/>
        BG0_CR = BG_MAP_BASE( 2 );
<br/>
<br/>
   videoSetModeSub( MODE_5_2D | DISPLAY_BG0_ACTIVE | DISPLAY_BG3_ACTIVE ); 
<br/>
   
<br/>
   vramSetBankC( VRAM_C_SUB_BG_0x06200000 );
<br/>
<br/>
   SUB_BG3_CR = BG_BMP16_256x256;
<br/>
   
<br/>
   SUB_BG3_XDX=256;
<br/>
   SUB_BG3_XDY=0;
<br/>
   SUB_BG3_YDX=0;
<br/>
   SUB_BG3_YDY=256;
<br/>
   SUB_BG3_CY = (16*256); 
<br/>
   SUB_BG0_CR = BG_MAP_BASE( 2 );
<br/>
<br/>
     BG_PALETTE[255] = RGB15(31,31,31);
<br/>
     BG_PALETTE_SUB[255] = RGB15(31,31,31);</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160765 - hacker013 - Mon Jul 21, 2008 4:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Tor wrote:</b></span></td> </tr> <tr> <td class="quote">I added <table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void consoleMoveMap(u16* map)
<br/>
{
<br/>
   row = col = 0;
<br/>
<br/>
   fontMap = map;
<br/>
}</td> </tr></table><span class="postbody"> to libnds's console.c and compiled the lib.
<br/>
<br/>
in my code i have </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">inline void consoleOnBottom()
<br/>
{
<br/>
     //consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(2),(u16*)SCREEN_BASE_BLOCK_SUB(0),16);
<br/>
   consoleMoveMap((u16*)SCREEN_BASE_BLOCK_SUB(2));
<br/>
}
<br/>
 
<br/>
inline void consoleOnTop()
<br/>
{  
<br/>
     //consoleInitDefault((u16*)SCREEN_BASE_BLOCK(2),(u16*)SCREEN_BASE_BLOCK(0),16);
<br/>
   consoleMoveMap((u16*)SCREEN_BASE_BLOCK(2));
<br/>
}</td> </tr></table><span class="postbody"> consoleInitDefault will erase the screen due to the consoleCls('2'); call. without it, when the screen switches, there are lots of pluses, asterisks, and weird looking box kinda things. They are all characters and not in the bitmap background because if i attempt to draw over them, they are still showing.
<br/>
<br/>
Oh, and the vram layout (if it matters)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetMode( MODE_5_2D | DISPLAY_BG0_ACTIVE | DISPLAY_BG3_ACTIVE );
<br/>
   
<br/>
   vramSetBankA( VRAM_A_MAIN_BG_0x06000000 );
<br/>
   
<br/>
   BG3_CR = BG_BMP16_256x256;
<br/>
   
<br/>
   BG3_XDX=256;
<br/>
   BG3_XDY=0;
<br/>
   BG3_YDX=0;
<br/>
   BG3_YDY=256;
<br/>
   
<br/>
   BG3_CY = (16*256);
<br/>
        BG0_CR = BG_MAP_BASE( 2 );
<br/>
<br/>
   videoSetModeSub( MODE_5_2D | DISPLAY_BG0_ACTIVE | DISPLAY_BG3_ACTIVE ); 
<br/>
   
<br/>
   vramSetBankC( VRAM_C_SUB_BG_0x06200000 );
<br/>
<br/>
   SUB_BG3_CR = BG_BMP16_256x256;
<br/>
   
<br/>
   SUB_BG3_XDX=256;
<br/>
   SUB_BG3_XDY=0;
<br/>
   SUB_BG3_YDX=0;
<br/>
   SUB_BG3_YDY=256;
<br/>
   SUB_BG3_CY = (16*256); 
<br/>
   SUB_BG0_CR = BG_MAP_BASE( 2 );
<br/>
<br/>
     BG_PALETTE[255] = RGB15(31,31,31);
<br/>
     BG_PALETTE_SUB[255] = RGB15(31,31,31);</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
the memory from the console and the memory from the background are overlapping eachother.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160831 - Tor - Wed Jul 23, 2008 4:44 am</h4>
    <div class="postbody"><span class="postbody">i was hoping someone would elaborate...but.. since the nds screen is only 256x192 (or something close to that) theres space reserved in the bitmap that isn't being used for the screen. So this shouldn't be an issue...right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160842 - silent_code - Wed Jul 23, 2008 11:55 am</h4>
    <div class="postbody"><span class="postbody">As long as the VRAM banks are assigned propperly, you can access and use any memory "leftovers" via base and character blocks. :^)<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><span style="text-decoration: underline"><span style="font-weight: bold"></span></span> July 5th 08: "<span style="font-weight: bold">Volumetric Shadow Demo</span>" 1.6.0 (final) source released
<br/>
June 5th 08: "<span style="font-weight: bold">Zombie NDS</span>" WIP released!
<br/>
It's all on my page, just click <span style="font-weight: bold">WWW</span> below.</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#160881 - Tor - Wed Jul 23, 2008 11:27 pm</h4>
    <div class="postbody"><span class="postbody">so the code is correct... right?
<br/>
so then why do i get random garbage when i change screens?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
