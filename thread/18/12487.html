<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Main screen disappears when sub screen appears - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Main screen disappears when sub screen appears</h2>
<div id="posts">
<div class="post">
    <h4>#118960 - Massif - Sun Feb 18, 2007 5:03 pm</h4>
    <div class="postbody"><span class="postbody">I'm trying to get graphics to display on the main screen and text on the sub screen. I got it working in Dualis last night. However, I tried running it on my DSLite this morning and the graphics appear for a split second, but then disappear when the text on the sub screen shows up. I was using the touch screen as main and top screen as sub. However, when I removed the lcdSwap() line, the graphics displayed on the top and stayed there, but the text never even showed up on the bottom.
<br/>
<br/>
*EDIT*
<br/>
<br/>
Forgot to post the code. It's a 512x512 image
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">videoSetMode(MODE_5_2D | DISPLAY_BG2_ACTIVE);
<br/>
   vramSetBankA(VRAM_A_MAIN_BG);
<br/>
   vramSetBankB(VRAM_B_MAIN_BG);
<br/>
   BG2_CR = BG_BMP8_512x512 | BG_BMP_BASE(0) | BG_PRIORITY(2);
<br/>
   BG2_XDX = 1 &lt;&lt; 8;
<br/>
   BG2_XDY = 0;
<br/>
   BG2_YDX = 0;
<br/>
   BG2_YDY = 1 &lt;&lt; 8;
<br/>
   BG2_CY = 0;
<br/>
   BG2_CX = 0;
<br/>
   
<br/>
   // Copy image and palette to main screen
<br/>
   dmaCopy(cards512Bitmap, BG_GFX, cards512BitmapLen);
<br/>
   dmaCopy(cards512Pal, BG_PALETTE, cards512PalLen);
<br/>
<br/>
   // Use the sub screen for text output
<br/>
   videoSetModeSub(MODE_0_2D | DISPLAY_BG0_ACTIVE);
<br/>
   vramSetBankC(VRAM_C_SUB_BG);
<br/>
   SUB_BG0_CR = BG_MAP_BASE(31);
<br/>
   
<br/>
   // Set the colour of the font to White.
<br/>
   BG_PALETTE_SUB[255] = RGB15(31,31,31);
<br/>
   consoleInitDefault((u16*)SCREEN_BASE_BLOCK_SUB(31), (u16*)CHAR_BASE_BLOCK_SUB(0), 16);</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121885 - FRuMMaGe - Thu Mar 15, 2007 1:24 pm</h4>
    <div class="postbody"><span class="postbody">I have the same problem :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#121936 - HyperHacker - Thu Mar 15, 2007 9:15 pm</h4>
    <div class="postbody"><span class="postbody">You could step through the code by adding wait loops that will spin until you press and release a button. That'd tell you which line is causing problems.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
