<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Fixing devkitarm's makefile to allow .include and .incbin? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Fixing devkitarm's makefile to allow .include and .incbin?</h2>
<div id="posts">
<div class="post">
    <h4>#158776 - Dwedit - Tue Jun 17, 2008 8:58 pm</h4>
    <div class="postbody"><span class="postbody">Posting here because devkitarm's mailing list and message board are both down.
<br/>
<br/>
Is it possible to fix the magical devkitarm makefile to get Gnu Assembler to support .include and .incbin correctly?
<br/>
<br/>
What methods could be used to go about this?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158802 - josath - Wed Jun 18, 2008 8:19 am</h4>
    <div class="postbody"><span class="postbody">as long as you're using the magical makefile, why not use the magic part that turns binary files into object code for you? then just reference that symbol from within your ASM file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158807 - Dwedit - Wed Jun 18, 2008 12:36 pm</h4>
    <div class="postbody"><span class="postbody">That may be a good workaround, and it's the workaround I use, but it still won't bring back .incbin.  You lose a few cycles because you can't adr a nearby binary file.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158811 - Cearn - Wed Jun 18, 2008 1:26 pm</h4>
    <div class="postbody"><span class="postbody">During compilation/assembling, the current directory is actually the 'build' directory, not the root of the project. The assembler probably can't find the file there, and because the assembler flags don't contain any include-path information it won't look any further either. To fix, add $(INCLUDE) to ASFLAGS as well.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158814 - eKid - Wed Jun 18, 2008 1:47 pm</h4>
    <div class="postbody"><span class="postbody">Last time I checked the assembler directives (.include, .incbin) don't use the include options.. :\
<br/>
#include works though (if using preprocessor).
<br/>
<br/>
If you want to be naughty you could do something like...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
.incbin "../bin/foo.bin"
<br/>
</td> </tr></table><span class="postbody">
<br/>
:P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158817 - Cearn - Wed Jun 18, 2008 4:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>eKid wrote:</b></span></td> </tr> <tr> <td class="quote">Last time I checked the assembler directives (.include, .incbin) don't use the include options.. :\
<br/>
#include works though (if using preprocessor).
<br/>
</td> </tr></table><span class="postbody">No, they should work. At least it does for the <a class="postlink" href="http://sourceware.org/binutils/docs/as/I.html#I" target="_blank">GCC assembler</a>:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gas manual wrote:</b></span></td> </tr> <tr> <td class="quote">Use this option to add a path to the list of directories as searches for files specified in .include directives (see .include). You may use -I as many times as necessary to include a variety of paths. The current working directory is always searched first; after that, as searches any `-I' directories in the same order as they were specified (left to right) on the command line.</td> </tr></table><span class="postbody"> Everything goes through -I, same as the compiler.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#158829 - eKid - Thu Jun 19, 2008 12:31 am</h4>
    <div class="postbody"><span class="postbody">Hmm, I just tested and it does work. :P
<br/>
I guess maybe it was a bug in the previous version.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
