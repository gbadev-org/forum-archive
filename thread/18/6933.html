<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Using G6/M3 as a 32MB RAM expansion - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Using G6/M3 as a 32MB RAM expansion</h2>
<div id="posts">
<div class="post">
    <h4>#54725 - pepsiman - Wed Sep 21, 2005 11:00 pm</h4>
    <div class="postbody"><span class="postbody">The 32MB of RAM in the G6 can be made writable by writing 0xaa55 to 0x09fffffe.
<br/>
<br/>
As with VRAM, 8bit writes do not work correctly.
<br/>
<br/>
The RAM in the M3 can probably be made writable in the same way, but this has not been tested.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54727 - El Hobito - Wed Sep 21, 2005 11:30 pm</h4>
    <div class="postbody"><span class="postbody">sounds good, i have an m3 if needs any help with testing it. 
<br/>
<br/>
off topic, how goes linux cf reading if you dont mind me asking?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54753 - pepsiman - Thu Sep 22, 2005 8:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>El Hobito wrote:</b></span></td> </tr> <tr> <td class="quote">sounds good, i have an m3 if needs any help with testing it. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
My Test App: <a class="postlink" href="http://pepsiman.pwp.blueyonder.co.uk/memtest.gba" target="_blank">http://pepsiman.pwp.blueyonder.co.uk/memtest.gba</a>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>El Hobito wrote:</b></span></td> </tr> <tr> <td class="quote">off topic, how goes linux cf reading if you dont mind me asking?</td> </tr></table><span class="postbody">
<br/>
Linux doesn't yet manage to probe the CF, let alone read it. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54759 - El Hobito - Thu Sep 22, 2005 11:36 am</h4>
    <div class="postbody"><span class="postbody">it doesnt work im afraid (as far as i can tell)
<br/>
<br/>
08000000 = -369098706
<br/>
writing 10 to 08000000
<br/>
08000000 = -369098706
<br/>
writing aa55 to 09fffffe
<br/>
08000000 = -369098706</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54762 - pepsiman - Thu Sep 22, 2005 12:15 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>El Hobito wrote:</b></span></td> </tr> <tr> <td class="quote">it doesnt work im afraid</td> </tr></table><span class="postbody">
<br/>
Thanks.
<br/>
<br/>
I've had a look at the m3 software, it writes 0xaa55 to 0x09ffeffe.
<br/>
<br/>
So here's a new test app:
<br/>
<br/>
<a class="postlink" href="http://pepsiman.pwp.blueyonder.co.uk/m3memtest.gba" target="_blank">http://pepsiman.pwp.blueyonder.co.uk/m3memtest.gba</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54763 - El Hobito - Thu Sep 22, 2005 12:44 pm</h4>
    <div class="postbody"><span class="postbody">yup thats got it
<br/>
08000000 is successfully written to</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54767 - chishm - Thu Sep 22, 2005 1:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pepsiman wrote:</b></span></td> </tr> <tr> <td class="quote">I've had a look at the m3 software, it writes 0xaa55 to 0x09ffeffe</td> </tr></table><span class="postbody">
<br/>
Could I please get the M3 software for disassembally purposes. I just want to figure out how to run the CF on the M3.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54770 - pepsiman - Thu Sep 22, 2005 1:46 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chishm wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Could I please get the M3 software for disassembally purposes. I just want to figure out how to run the CF on the M3.</td> </tr></table><span class="postbody">
<br/>
I was just looking at the realtime save patch code.  I don't have the M3 firmware.
<br/>
I used <a class="postlink" href="http://www.m3adapter.com/download/M3%20game%20manager%201.3.rar" target="_blank">http://www.m3adapter.com/download/M3%20game%20manager%201.3.rar</a> to patch a GBA ROM, then disassembled the result.
<br/>
The CF writing code is probably in the patch too.
<br/>
<br/>
There's a version of moonshell on M3's website that can read the CF.
<br/>
<a class="postlink" href="http://www.m3adapter.com/download/MoonShell%20for%20M3_en.rar" target="_blank">http://www.m3adapter.com/download/MoonShell%20for%20M3_en.rar</a>
<br/>
Have you tried disassembling that?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54772 - El Hobito - Thu Sep 22, 2005 2:42 pm</h4>
    <div class="postbody"><span class="postbody">know a good disassembler pepsiman? i tried disassembling moonshell but it doesnt like it at all and gets stuck in an infinite loop
<br/>
<br/>
================ Header info ================
<br/>
Game Title             : .
<br/>
Game Code              : =??
<br/>
<br/>
Maker Code             : ??
<br/>
Unit Code              : 09
<br/>
Device Code            : ad
<br/>
Card Size              : 11 = 131072MBit
<br/>
Card Info              : $????!?R?
<br/>
Flags                  : 19
<br/>
ARM9_source            : 20ce0993
<br/>
ARM9_execute address   : 4a4a4610
<br/>
ARM9_copy to address   : ec3127f8
<br/>
ARM9_binary size       : 33e8c758
<br/>
ARM7_source            : bfcee382
<br/>
ARM7_execute address   : 94dff485
<br/>
ARM7_copy to address   : c1094bce
<br/>
ARM7_binary size       : c08a5694
<br/>
Filename table offset  : fca77213
<br/>
Filename table size    : 734d849f
<br/>
FAT offset             : 619acaa3
<br/>
FAT size               : 27a39758
<br/>
ARM9 overlay src       : 769803fc
<br/>
ARM9 overlay size      : 61c71d23
<br/>
ARM7 overlay src       : 56ae0403
<br/>
ARM7 overlay size      : 008438bf
<br/>
Unknown2a              : fd0ea740
<br/>
Unknown2a              : 03fe52ff
<br/>
Icon+Titles            : f130956f
<br/>
SecureCRC16[4000-7FFF] : fb97
<br/>
ROM timeout            : 85c0
<br/>
ARM9 unk addr          : 2580d660
<br/>
ARM7 unk addr          : 03be63a9
<br/>
Unknown3c              : N8???4??&gt;Dx
<br/>
ROM size               : 44033ebb
<br/>
header size            : cb900078
<br/>
Logo CRC16[0C0-15B]    : 203c
<br/>
Header CRC16[000-15D]  : e59b
<br/>
<br/>
================ File Allocation Table info ================
<br/>
ADDRESS  SIZE(HEX/DEC)      PATH
<br/>
<br/>
================ ARM9(Main CPU) code ================
<br/>
:EC3127F8 0013FF00 andeqs r15,r3,r0,lsl#0			; r15=0(0x0)
<br/>
:EC3127FC 0013FF00 andeqs r15,r3,r0,lsl#0			; r15=0(0x0)
<br/>
:EC312800 0013FF00 andeqs r15,r3,r0,lsl#0			; r15=0(0x0)
<br/>
:EC312804 0013FF00 andeqs r15,r3,r0,lsl#0			; r15=0(0x0)
<br/>
:EC312808 0013FF00 andeqs r15,r3,r0,lsl#0			; r15=0(0x0)
<br/>
:EC31280C 0013FF00 andeqs r15,r3,r0,lsl#0			; r15=0(0x0)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#54775 - pepsiman - Thu Sep 22, 2005 2:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>El Hobito wrote:</b></span></td> </tr> <tr> <td class="quote">know a good disassembler pepsiman? i tried disassembling moonshell but it doesnt like it at all and gets stuck in an infinite loop.
<br/>
</td> </tr></table><span class="postbody">
<br/>
I use arm-elf-objdump.
<br/>
The MoonShell_EN.NDS file is actually a .ds.gba, so you'll need to remove the loader first.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
