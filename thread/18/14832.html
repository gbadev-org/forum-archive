<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>help with timers - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > help with timers</h2>
<div id="posts">
<div class="post">
    <h4>#148887 - darknut101 - Fri Jan 11, 2008 6:46 pm</h4>
    <div class="postbody"><span class="postbody">Can someone please direct me to a tutorial or some information on timers with libnds. devkitpro doesn't have any useful examples and I can't find any tutorials that cover them in the slightest manner. Thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148889 - eKid - Fri Jan 11, 2008 6:59 pm</h4>
    <div class="postbody"><span class="postbody">timers are rather simple :)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// example to set up a millisecond timer
<br/>
<br/>
// a millisecond counter
<br/>
volatile int milliseconds=0;
<br/>
<br/>
void timer0_function( void )
<br/>
{
<br/>
    // increment milliseconds
<br/>
    milliseconds++;
<br/>
}
<br/>
<br/>
void main( void )
<br/>
{
<br/>
    // initialize interrupts
<br/>
    irqInit();
<br/>
<br/>
    // setup timer0 interrupt
<br/>
    irqSet( IRQ_TIMER0, timer0_function );
<br/>
<br/>
    // set frequency of timer 0 to 1000hz (1 second / 1000)
<br/>
    TIMER0_DATA = TIMER_FREQ(1000);
<br/>
<br/>
/* TIMERx_DATA sets the frequency of timer X (X being 0-&gt;3). Writing to it changes the frequency.
<br/>
    TIMER_FREQ is a definition in libnds that divides the clock frequency by the Hz value given. Keep in mind that there is only a 16-bit counter so larger values may overflow. 
<br/>
*/
<br/>
<br/>
    // start timer0 with interrupt enabled
<br/>
    TIMER0_CR = TIMER_ENABLE | TIMER_IRQ_REQ;
<br/>
<br/>
/* TIMER_ENABLE starts the timer
<br/>
    TIMER_IRQ_REQ is the bit that enables the interrupt.
<br/>
*/
<br/>
    
<br/>
    // ....
<br/>
    // do other things
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
gbatek has a good reference how to control the timers (and everything else) - <a href="http://nocash.emubase.de/gbatek.htm" target="_blank">http://nocash.emubase.de/gbatek.htm</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#148893 - darknut101 - Fri Jan 11, 2008 7:12 pm</h4>
    <div class="postbody"><span class="postbody">thanks a lot. that answered all my questions.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
