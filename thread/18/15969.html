<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>easy guru exception handler - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > easy guru exception handler</h2>
<div id="posts">
<div class="post">
    <h4>#162041 - a128 - Sat Aug 23, 2008 11:12 pm</h4>
    <div class="postbody"><span class="postbody">Here is a modified guru exception handler. 
<br/>
<br/>
<a class="postlink" href="http://www.freewebtown.com/festival2005/EasyGuruStacktrace.tgz" target="_blank">http://www.freewebtown.com/festival2005/EasyGuruStacktrace.tgz</a>
<br/>
<br/>
Use </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">STACK_TRACE();</td> </tr></table><span class="postbody">
<br/>
<br/>
in your code. The handler records the last 21 STACK_TRACE() calls and prints the history (filename + line number) at guru meditation on the top screen of the NDS. Hope it's usefull for someone.
<br/>
It prints somethink like that
<br/>
<br/>
Trace1:Yourfile.cpp 234
<br/>
<br/>
234 is the linenumber of that STACK_TRACE()</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162043 - chuckstudios - Sun Aug 24, 2008 12:02 am</h4>
    <div class="postbody"><span class="postbody">Firefox does not like your webhost because it is a "Reported Attack Site!".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162050 - a128 - Sun Aug 24, 2008 8:40 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chuckstudios wrote:</b></span></td> </tr> <tr> <td class="quote">Firefox does not like your webhost because it is a "Reported Attack Site!".</td> </tr></table><span class="postbody">
<br/>
<br/>
This is offtopic but ok,
<br/>
<br/>
<a class="postlink" href="http://forums.mozillazine.org/viewtopic.php?f=38&amp;t=812995" target="_blank">http://forums.mozillazine.org/viewtopic.php?f=38&amp;t=812995</a>
<br/>
<br/>
I do not care if FF via google  blocks a whole domain. Which is craszy because freewebtown is a free web hoster . Are all pages infected ?</span><span class="gensmall"><br/><br/>Last edited by a128 on Sun Aug 24, 2008 2:29 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#162054 - keldon - Sun Aug 24, 2008 12:17 pm</h4>
    <div class="postbody"><span class="postbody">000webhost.com uses subdomains, rather than subdirectories - making it much easier for google to make web browsing safer.
<br/>
<br/>
<span style="font-size: 9px; line-height: normal">Sure it could be argued that the web will still not be 100% safe as warnings do not guarantee complete freedom from malware, but common sense will tell you that being warned of 90% is much safer than being warned of 0% ^_^</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162055 - Maxxie - Sun Aug 24, 2008 12:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>a128 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Use <table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">STACK_TRACE();</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Why don't you walk the stack (possibly LR itself on the first iteration) for values that point directly after a BX(non lr), BL ,BXL &amp; co? Instead of actively marking your way on the cost of cpu time and programming overhead in each project you want to get traced.<br/>_________________<br/><a class="postlink" href="http://nintendods.desperate-programmers.com/doku.php?id=wireless_io_map" target="_blank">Trying  to bring more detail into understanding the wireless hardware</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162057 - a128 - Sun Aug 24, 2008 2:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Maxxie wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Why don't you walk the stack (possibly LR itself on the first iteration) for values that point directly after a BX(non lr), BL ,BXL &amp; co? Instead of actively marking your way on the cost of cpu time and programming overhead in each project you want to get traced.</td> </tr></table><span class="postbody">
<br/>
<br/>
what do you mean? 
<br/>
Feel free to improve my method and let's share this via source code
<br/>
<br/>
looking thru registers is not very sexy..sometimes</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162179 - chishm - Wed Aug 27, 2008 2:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Maxxie wrote:</b></span></td> </tr> <tr> <td class="quote">Why don't you walk the stack (possibly LR itself on the first iteration) for values that point directly after a BX(non lr), BL ,BXL &amp; co? Instead of actively marking your way on the cost of cpu time and programming overhead in each project you want to get traced.</td> </tr></table><span class="postbody">
<br/>
One possible problem is that there's no tracking of the stack window. Once you go up to the parent function you won't be able to tell how large its stack window was or where the LR was saved. At least without tracing through the function's return code.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#162183 - Maxxie - Wed Aug 27, 2008 4:35 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>chishm wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Maxxie wrote:</b></span></td> </tr> <tr> <td class="quote">Why don't you walk the stack (possibly LR itself on the first iteration) for values that point directly after a BX(non lr), BL ,BXL &amp; co? Instead of actively marking your way on the cost of cpu time and programming overhead in each project you want to get traced.</td> </tr></table><span class="postbody">
<br/>
One possible problem is that there's no tracking of the stack window. Once you go up to the parent function you won't be able to tell how large its stack window was or where the LR was saved. At least without tracing through the function's return code.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
That is not a real problem.
<br/>
<br/>
The return addresses are pretty obvious to spot (Addressrange and content just before), and it is very unlikely that you push such an address onto the stack that points just behind a call/branch that is not a bx lr and in the right form (arm/thumb)
<br/>
<br/>
The few cases that it will create false positives shouldn't bother. And might (if they really bother you) be filtered by limiting the address of the suspected callee somewhere near the already identified point of execution.
<br/>
<br/>
<br/>
Shame i can't work on it right now.<br/>_________________<br/><a class="postlink" href="http://nintendods.desperate-programmers.com/doku.php?id=wireless_io_map" target="_blank">Trying  to bring more detail into understanding the wireless hardware</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
