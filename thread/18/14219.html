<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Helix MP3 decoder - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Helix MP3 decoder</h2>
<div id="posts">
<div class="post">
    <h4>#141444 - Blue Frenzy - Tue Sep 25, 2007 6:00 pm</h4>
    <div class="postbody"><span class="postbody">Is there any way to change the playback position of a playing mp3?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141446 - simonjhall - Tue Sep 25, 2007 6:59 pm</h4>
    <div class="postbody"><span class="postbody">All mp3 frames are the exact same length.
<br/>
To seek, I'd figure out what time you I to go to then compute which frame that'd be in (based on the size of the frame, the bitrate, the sample frequency etc) then make the next fread where I think that frame will start.
<br/>
EDIT: this would be for CBR. VBR would be more entertaining :-)<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141454 - tepples - Tue Sep 25, 2007 8:04 pm</h4>
    <div class="postbody"><span class="postbody">Does an MP3 frame have a timestamp in it? If so, you can try seeking using a <a class="postlink" href="http://en.wikipedia.org/wiki/Newton%27s_method" target="_blank">Newton-Raphson search</a> through the file, and then seek back a few frames to fill the <a class="postlink" href="http://www.mp3-converter.com/mp3codec/implementation.htm#69973" target="_blank">byte reservoir</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141465 - DragonMinded - Tue Sep 25, 2007 10:22 pm</h4>
    <div class="postbody"><span class="postbody">Most mpeg decoders are flexible enough to resync if the header is lost, to the point where you can just seek to any random spot in the file and it'll continue playing from the next frame.  That's what DSOrganize does, except using libmad as the decoder.<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141474 - Blue Frenzy - Tue Sep 25, 2007 11:53 pm</h4>
    <div class="postbody"><span class="postbody">do anyone know what functions or variables should i change to do this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141507 - tepples - Wed Sep 26, 2007 1:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DragonMinded wrote:</b></span></td> </tr> <tr> <td class="quote">Most mpeg decoders are flexible enough to resync if the header is lost, to the point where you can just seek to any random spot in the file and it'll continue playing from the next frame.</td> </tr></table><span class="postbody">
<br/>
But how will it know where in the file it has seeked to so that it can display the correct numbers on the clock? I can imagine cases where the bitrate for one part of the file differs from another, such as an MP3 ripped from a CD that contains an ordinary track, several minutes of silence (at 32 kbps), and a "hidden track".<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141528 - DragonMinded - Wed Sep 26, 2007 6:17 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DragonMinded wrote:</b></span></td> </tr> <tr> <td class="quote">Most mpeg decoders are flexible enough to resync if the header is lost, to the point where you can just seek to any random spot in the file and it'll continue playing from the next frame.</td> </tr></table><span class="postbody">
<br/>
But how will it know where in the file it has seeked to so that it can display the correct numbers on the clock? I can imagine cases where the bitrate for one part of the file differs from another, such as an MP3 ripped from a CD that contains an ordinary track, several minutes of silence (at 32 kbps), and a "hidden track".</span></td> </tr></table><span class="postbody">
<br/>
<br/>
He didn't ask for time, just to seek.  Time is a very different beast.  If you want exactly accurate timing on VBR, you really must parse each header and skip through the file.  If you want a mostly accurate time, you can read the XING (or similar header).  Also, a trick that somewhat works is to initially calculate the time by parsing each header and coming up with a final time, then calculating the average bitrate from that and using that number to estimate time and seek position.<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
