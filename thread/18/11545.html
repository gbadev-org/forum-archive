<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Comparison of the various GBA/DS "file systems"? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Comparison of the various GBA/DS "file systems"?</h2>
<div id="posts">
<div class="post">
    <h4>#107141 - Dwedit - Fri Oct 27, 2006 2:22 am</h4>
    <div class="postbody"><span class="postbody">Has anyone compared ALL of the various GBA/NDS file systems that have been used by various programs, to compare their features, pros/cons, limitations, and see which one is the best?  I'll try to list some of them here:
<br/>
<br/>
FAT disk image
<br/>
Moonshell IMFS
<br/>
Pogoshell Filesystem
<br/>
PinEightGBFS
<br/>
Simple linked list with filesize and filename
<br/>
Searching through a file to look for file ID tokens (JFIF, RIFF, MTHD, NES^Z, etc)
<br/>
<br/>
So which filesystems have been used in GBA/DS programs that I'm missing?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107144 - GPFerror - Fri Oct 27, 2006 4:37 am</h4>
    <div class="postbody"><span class="postbody">my port of romfs to the ds, probably would work on the gba if someone wanted it.
<br/>
<a class="postlink" href="http://gpf.dcemu.co.uk/ndsromdisk.shtml" target="_blank">http://gpf.dcemu.co.uk/ndsromdisk.shtml</a>
<br/>
<br/>
It works similiar to gbfs for finding the disk image, but supports a stdio like api also has support for a ramdisk filesystem as well.
<br/>
<br/>
Also using FSCR images appended to the end of .ds.gba files works seems to work with fatlib on some of the carts that don't have fatlib support I'v heard, I've only used them with Ideas and no$gba emulators.
<br/>
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk/" target="_blank">http://gpf.dcemu.co.uk/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107146 - Dwedit - Fri Oct 27, 2006 4:47 am</h4>
    <div class="postbody"><span class="postbody">I've made a little table of a few so far:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Filesystem Name  Dir NL  name size date  checksum       Extra Inf.    Compression Writable
<br/>
-------------------------------------------------------------------------------------------------
<br/>
FAT              Yes 255 Name Size Date                 Attributes                Yes
<br/>
Moonshell IMFS   Yes 64  Name Size       CRC32                        LZ77        No
<br/>
Pogoshell (ROM)  Yes 32  Name Size                                                No
<br/>
Pogoshell (SRAM) No  32  Name Size Date  GBA Game ID    User #        RLE         Yes
<br/>
PinEightGBFS     No  24  Name Size                                                No
<br/>
PocketNES        No  32  Name Size                                                No
<br/>
PocketNES SRAM   No  32  Name Size Date  Sum First 16k                MiniLZO     Yes
<br/>
</td> </tr></table><span class="postbody">
<br/>
columns:
<br/>
DIR: filesystem supports directories and subdirectories
<br/>
NL: Maximum length of a filename
<br/>
name, size, date: Indicates if the filesystem stores this info
<br/>
checksum: Some filesystems store file checksums
<br/>
Extra Inf: Other misc information
<br/>
Compression: This is for compression done at the file system level
<br/>
Writable: There is code available for writing this on the GBA/DS itself.
<br/>
<br/>
Here's some information about each file system:
<br/>
FAT
<br/>
----
<br/>
This is the FAT16/32 filesystem, either used on a disk, or using a disk image.  Has plenty of overhead.
<br/>
Directories are implemented as special files, containing directory entries.  They are linked.
<br/>
Uses a FAT to determine where clusters are on the disk
<br/>
Uses fixed size file entries, as well as special invalid files to add long names.
<br/>
<br/>
Moonshell IMFS
<br/>
-----------------
<br/>
File system used by moonshell.
<br/>
Directories are implemetned as an directory ID number for a file.   Directories can be contained within directories.
<br/>
Files can be compressed with LZ77, this is done at the filesystem level.
<br/>
Identified by magic number "IMFS"
<br/>
<br/>
Pogoshell
<br/>
-----------
<br/>
Filesystem used by pogoshell on ROM.  GBA files are stored separately from other files, and are aligned to 32k boundaries to support bankswitching the flash cartridge to run them.  Pogoshell itself has ugly limitations on the number of files in a directory, but these are not part of the filesystem itself.  Filenames are 32 characters or less, posing a problem for long names.  It chops off the file extension if the name is too long.
<br/>
Identified by magic number 0xFAB0BABE, must be aligned to 32k boundary.
<br/>
<br/>
Pogoshell SRAM
<br/>
------------------
<br/>
Separate file system used by pogoshell for storing SRAM.  Split accross 3 64k pages of SRAM.  No support for subdirectories.  Originally, pogoshell used the GBA GAME ID to identify which rom a save was associated with, but Kuwanger has modified the shell to remove that "feature".
<br/>
Files are always RLE compressed.
<br/>
Stores a User ID# to allow multiple players to save with the same file.
<br/>
Identified by magic string "MINSF2"
<br/>
<br/>
PinEightGBFS
<br/>
---------------
<br/>
Simple linked appended filesystem, just stores a 24 character filename, a relative pointer to the start of the data, and a relative pointer to the next file.
<br/>
Identified by magic string "PinEightGBFS\r\n\032\n"
<br/>
<br/>
PocketNES
<br/>
------------
<br/>
Very similar to GBFS, but stores flags about how the emulator should treat roms.  Each file gets a 48 byte header, containing filename, flags, and size.
<br/>
No magic number, the emulator knows its size and uses that to determine where to look.  But the position of NES^Z-48 can also be used.
<br/>
<br/>
PocketNES SRAM
<br/>
-------------------
<br/>
Linked structure in SRAM for storing savestates and sram files, all files are compressed with MiniLZO.
<br/>
Magic number is 0x57a731d7 (stateidt).
<br/>
<br/>
Then there are a few filesystems I've forgotten about:
<br/>
Zip File with no compression, used by scummvm ds.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107241 - tepples - Fri Oct 27, 2006 10:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">PinEightGBFS
<br/>
---------------
<br/>
Simple linked appended filesystem, just stores a 24 character filename, a relative pointer to the start of the data, and a relative pointer to the next file.
<br/>
Identified by magic string "PinEightGBFS\r\n\032\n"</td> </tr></table><span class="postbody">
<br/>
Almost. GBFS isn't linked in the sense that PocketNES or Tar is. It consists of a header (containing the magic string and an offset to the directory table), a directory table (similar to that of PogoShell), and file data, where each file data is aligned to 16 bytes. GBFS must be aligned to 256 bytes for use with find_first_gbfs_file() in .gba or ds.gba. The file system itself doesn't support compression, but LOCKJAW: The Overdose demonstrates how to use GBA LZ77 decompression.
<br/>
<br/>
Is there demand for long file names or subdirectory support in GBFS?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107257 - Dwedit - Sat Oct 28, 2006 1:18 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Is there demand for long file names or subdirectory support in GBFS?</td> </tr></table><span class="postbody">
<br/>
<br/>
Only necessary if the filesystem gets browsed or listed, if it's just used as an incbin hack alternative, then it isn't necessary.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#110613 - josath - Wed Nov 29, 2006 10:56 pm</h4>
    <div class="postbody"><span class="postbody">I've put this table into wiki format, haven't finished putting all if the info in, but I also added romfs to the table, and split out FAT for old/new versions, and added a few columns.
<br/>
<br/>
Please, everyone feel free to add any more info that you know to it
<br/>
<br/>
<a href="http://dev-scene.com/NDS/DOCfilesystems" target="_blank">http://dev-scene.com/NDS/DOCfilesystems</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#110619 - tepples - Wed Nov 29, 2006 11:24 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">Please, everyone feel free to add any more info that you know to it
<br/>
<br/>
<a href="http://dev-scene.com/NDS/DOCfilesystems" target="_blank">http://dev-scene.com/NDS/DOCfilesystems</a></td> </tr></table><span class="postbody">
<br/>
The wiki is configured to forbid anonymous editing. Creating an account on the wiki requires creating an account on the forum, which requires downloading and solving a visual CAPTCHA. This took me a couple tries on a PC, and users of DSLinux would have to use the e-mail method instead. And given that the forum and wiki accounts are linked, and a lot of public forums are known to delete inactive accounts, does posting only to the wiki and not to the forum mean my wiki account will be deleted?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#110650 - josath - Thu Nov 30, 2006 2:47 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">Please, everyone feel free to add any more info that you know to it
<br/>
<br/>
<a href="http://dev-scene.com/NDS/DOCfilesystems" target="_blank">http://dev-scene.com/NDS/DOCfilesystems</a></td> </tr></table><span class="postbody">
<br/>
The wiki is configured to forbid anonymous editing. Creating an account on the wiki requires creating an account on the forum, which requires downloading and solving a visual CAPTCHA. This took me a couple tries on a PC, and users of DSLinux would have to use the e-mail method instead. And given that the forum and wiki accounts are linked, and a lot of public forums are known to delete inactive accounts, does posting only to the wiki and not to the forum mean my wiki account will be deleted?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I have a feeling not much wiki editing is going to be done from within dslinux. wiki viewing doesn't require an account. until we come up with better ways, captcha is a must, they were getting spammed. Also I don't think it will expire accounts.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#110801 - Mrshlee - Fri Dec 01, 2006 8:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">Please, everyone feel free to add any more info that you know to it
<br/>
<br/>
<a href="http://dev-scene.com/NDS/DOCfilesystems" target="_blank">http://dev-scene.com/NDS/DOCfilesystems</a></td> </tr></table><span class="postbody">
<br/>
The wiki is configured to forbid anonymous editing. Creating an account on the wiki requires creating an account on the forum, which requires downloading and solving a visual CAPTCHA. This took me a couple tries on a PC, and users of DSLinux would have to use the e-mail method instead. And given that the forum and wiki accounts are linked, and a lot of public forums are known to delete inactive accounts, does posting only to the wiki and not to the forum mean my wiki account will be deleted?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I have a feeling not much wiki editing is going to be done from within dslinux. wiki viewing doesn't require an account. until we come up with better ways, captcha is a must, they were getting spammed. Also I don't think it will expire accounts.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I'm tired so I'll make this quick and straight to the point
<br/>
<br/>
The wiki is configured to allow only those with an active forum account to edit and expand the content of our page. Hopefully requiring people to create an active forum account would lightly encourage people to use it in one form or another plus I've only ever deleted accounts that were used to spam our forums. Our forum was experiencing a LARGE number of she-male porn related bot spam and the CATCHPA system was required to stop this.. the positive side effect is the new system I've installed has actually made the visibility of the Phrase easier to read.
<br/>
<br/>
The system has actually worked very well and while DSLinux sign ups might have become a non-trivial task... this is the first complaint I've heard so far - A large thank-you to everyone who continue to add content to the Dev-Scene project.
<br/>
<br/>
P.S I personally don't believe in the Wikipedia style of anonymous editing but thats another story.<br/>_________________<br/><a class="postlink" href="http://MrShlee.com/" target="_blank">MrShlee.com</a>
<br/>
Projects
<br/>
<a class="postlink" href="http://dev-scene.com/" target="_blank">Dev-Scene</a>
<br/>
<a class="postlink" href="http://MyTechpedia.com/" target="_blank">MyTechpedia</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
