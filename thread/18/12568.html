<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem with swiDecompressLZSSVram., libNDS - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Problem with swiDecompressLZSSVram., libNDS</h2>
<div id="posts">
<div class="post">
    <h4>#119853 - MoonLight - Mon Feb 26, 2007 10:18 pm</h4>
    <div class="postbody"><span class="postbody">I don't know why, but this code hangs the real console up.
<br/>
<br/>
Before the launch of swiDecompressLZSSVram Vram banks configured by vramSetMainBanks(VRAM_A_MAIN_BG_0x06000000, VRAM_B_MAIN_BG_0x06020000, VRAM_C_SUB_BG_0x06200000, VRAM_D_LCD).
<br/>
<br/>
TDecompressionStream CGmConsole::ms_decompCallbacks = { decompGetSize, NULL, decompReadByte };
<br/>
<br/>
uint32 CGmConsole::decompGetSize(const uint8 *source, uint16 *dest, uint32 arg)
<br/>
{
<br/>
	return *((uint32*)source);
<br/>
}
<br/>
<br/>
uint8 CGmConsole::decompReadByte(const uint8 *source)
<br/>
{
<br/>
	return *source;
<br/>
}
<br/>
<br/>
void CGmConsole::Init()
<br/>
{
<br/>
	memset(ms_consoleText, ' ', 768);
<br/>
<br/>
	swiDecompressLZSSVram((void*)consoleFontData, (void*)0x621F400, 0, &amp;ms_decompCallbacks);
<br/>
<br/>
	swiDecompressRLEVram((void*)consoleFontPalette, (void*)0x50005E0, 0, &amp;ms_decompCallbacks);
<br/>
<br/>
	SUB_BG3_CR = BG_PRIORITY_0 | BG_TILE_BASE(7) | BG_MOSAIC_OFF | BG_16_COLOR | BG_MAP_BASE(CONSOLE_BG_MAP_BASE) | BG_WRAP_OFF | BG_32x32;
<br/>
}</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
