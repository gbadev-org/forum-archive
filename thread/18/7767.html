<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Bitmap BG access Problem - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Bitmap BG access Problem</h2>
<div id="posts">
<div class="post">
    <h4>#63460 - dieudunet - Tue Dec 13, 2005 10:11 am</h4>
    <div class="postbody"><span class="postbody">Hi guys, 
<br/>
<br/>
   i got a problem while trying to draw a circle on a 256 color bitmap BG
<br/>
<br/>
 I use mode 5, and i got the first background as Txt background mapped into VRAM_A
<br/>
<br/>
 I have the BG 3 mapped into the VRAM_B as a 256 color bitmap BG
<br/>
i also map the second half of the VRAM_B to be use as a backbuffer for this background
<br/>
<br/>
 So i see my BG3 on the screen, and i draw a circle on the backbuffer , then i switch the backbuffer on the Screen ( by changing the BG_MAP_BASE of the BG 3 ), then i use the first part of the VRAM_B as backbuffer...and so on
<br/>
<br/>
This work well on all emulator like Ensata , Ideas .... but on the real hardware with a Supercard and Superpass i see my bg but not my circle....
<br/>
<br/>
Does the NDS block the screen and do not authorize me to access it ???
<br/>
I put a WaitForVBlank just before to be sure that the screen has just finish...
<br/>
but i can see my circle..................
<br/>
<br/>
Does anyone know why this don't work on real hardware but is ok on ensata ????
<br/>
<br/>
thank a lot</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63465 - Tobin - Tue Dec 13, 2005 10:51 am</h4>
    <div class="postbody"><span class="postbody">Maybe you have forgotton to reset the rotation of the background:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   BG3_XDY = 0;
<br/>
   BG3_YDX = 0;
<br/>
   BG3_XDX = (u16)(1 &lt;&lt; 8);
<br/>
   BG3_YDY = (u16)(1 &lt;&lt; 8);
<br/>
   BG3_CX = 0;
<br/>
   BG3_CY = 0;
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63472 - dieudunet - Tue Dec 13, 2005 12:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Tobin wrote:</b></span></td> </tr> <tr> <td class="quote">Maybe you have forgotton to reset the rotation of the background:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   BG3_XDY = 0;
<br/>
   BG3_YDX = 0;
<br/>
   BG3_XDX = (u16)(1 &lt;&lt; 8);
<br/>
   BG3_YDY = (u16)(1 &lt;&lt; 8);
<br/>
   BG3_CX = 0;
<br/>
   BG3_CY = 0;
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
i do the change but this do not work, i see the BG0 but the BG3 is not update</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63473 - dieudunet - Tue Dec 13, 2005 1:27 pm</h4>
    <div class="postbody"><span class="postbody">I precise a few things because i can't find
<br/>
<br/>
it seems that my NDS ( real hardware ) can't write directly in VRAM while using a BITMAP bg of 256Color ( so 8bit value )
<br/>
<br/>
it works well if i switch it into a True Color ( so 16 bit value )
<br/>
<br/>
Does anyone know Why ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63476 - Tobin - Tue Dec 13, 2005 2:06 pm</h4>
    <div class="postbody"><span class="postbody">I have another idea. You have to write 2 bytes at once to the vram. If you just write one byte, it will not display correct. That's the reason it is displayed if you use true color. 
<br/>
Look here for some details (it is the same on the gba): 
<br/>
<a href="http://user.chem.tue.nl/jakvijn/tonc/bitmaps.htm" target="_blank">http://user.chem.tue.nl/jakvijn/tonc/bitmaps.htm</a>
<br/>
<br/>
Hope that helps</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#63478 - dieudunet - Tue Dec 13, 2005 2:41 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Tobin wrote:</b></span></td> </tr> <tr> <td class="quote">I have another idea. You have to write 2 bytes at once to the vram. If you just write one byte, it will not display correct. That's the reason it is displayed if you use true color. 
<br/>
Look here for some details (it is the same on the gba): 
<br/>
<a href="http://user.chem.tue.nl/jakvijn/tonc/bitmaps.htm" target="_blank">http://user.chem.tue.nl/jakvijn/tonc/bitmaps.htm</a>
<br/>
<br/>
Hope that helps</td> </tr></table><span class="postbody">
<br/>
<br/>
YEAH you're totally right
<br/>
i love you guys
<br/>
<br/>
know i return to my aquarium simulation :P
<br/>
<br/>
Tanks a lot</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
