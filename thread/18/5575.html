<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Disassembling ARM questions (new to Nintendo/not new to ARM) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Disassembling ARM questions (new to Nintendo/not new to ARM)</h2>
<div id="posts">
<div class="post">
    <h4>#41557 - DsPet - Fri Apr 29, 2005 5:17 pm</h4>
    <div class="postbody"><span class="postbody">My Background:
<br/>
I have disassembled and reverse engineered a lot of ARM code in the past -- most recently the ARM based Zipit with encrypted firmware uploads
<br/>
However, I am a Nintendo "newbie". I bought my first Nintendo portable a few days ago, and finally enough hardware to run "FlashMe" only yesterday. After trying all the obvious things [running GBA variant linux, building NDS demo programs, grabbing ARM9 BIOS and disassembling it, grabbing encrypted firmware etc] I'm looking for some new challenges.
<br/>
<br/>
I've checked all the public BBSs and there is a lot of progress being made. Congratulations to all involved. There are a few remaining questions below. I'm asking here because this BBS looks to be the most technical I've found.
<br/>
<br/>
NOTE: I'd be happy with an answer along the lines "we don't know" or in some cases "we know but we don't want to talk about it in public".
<br/>
<br/>
FWIW: Ultimately my goal is to provide an AIBO remote control using an unmodified NDS (AIBO uses WiFi, but it has lower level 802.11 radio access with some limitations)
<br/>
<br/>
====================
<br/>
The Questions:
<br/>
<br/>
The ARM9 BIOS is very easy to grab and disassemble. The ARM7 BIOS is intentionally copy protected.
<br/>
Question #1: Has someone figured out an easy way to grab the ARM7 BIOS ROM?
<br/>
<br/>
------
<br/>
The main 256KB firmware is possible to grab. It is encrypted specific to the device. I see that the "FlashMe" utility will install pre-encrypted firmware (the fast boot and the revert to original) -- encrypted to a specific hardware key. This leads me to believe the firmware encryption and decryption has already been figured out. I haven't found any open source code that does this.
<br/>
Question #2: Is there any public discussion or source code of how to decrypt (and ideally re-encrypt) the firmware for applying your own patches or disassembling things like the Pictochat program ?
<br/>
NOTE: All reverse engineering done under DMCA allowable "fair uses"
<br/>
<br/>
------
<br/>
The "ndslib" is making good progress. I assume that people are reverse engineering it from existing firmware.
<br/>
Question #3: What code / programs are people using to help their disassembly ? (game like the Metroid cart or from the 256K built-in firmware or something else?)
<br/>
NOTE: my interest is mostly in the 802.11 WiFi-/NiFi functionality or areas others haven't already addressed [I don't want to reinvent the wheel]
<br/>
<br/>
------
<br/>
Regarding PictoChat and the "NiFi" protocol
<br/>
Question#4: Has anyone figured out the PictoChat protocol enough to emulate it on the PC or other WiFi-enabled device (like an AIBO) ?
<br/>
<br/>
------
<br/>
Regarding re-signing/re-encrypting for downloaded multi-boot games.
<br/>
I see some discussion on brute-force cracking techniques, however exact details of what needs to be "cracked" are not mentioned. I see Tim's WiFiMe uses existing encrypted/signed binaries.
<br/>
Question#5: Has anyone figured out the decryption algorithm for this (not necessarily the keys) and what is missing.
<br/>
NOTE: This is getting dangerously close the DMCA trouble (more so than the other topics)
<br/>
<br/>
------
<br/>
<br/>
Thanks in advance
<br/>
<br/>
--DsPet/AiboPet</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41607 - PhoenixSoft - Sat Apr 30, 2005 6:56 am</h4>
    <div class="postbody"><span class="postbody">Please don't take anything I say as absolute fact, as I could be wrong.  I just wanted to give you some answers because no-one else has attempted to answer any of your questions yet.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Question #1: Has someone figured out an easy way to grab the ARM7 BIOS ROM?</td> </tr></table><span class="postbody">
<br/>
<br/>
I believe this is identical to the GBA bios except for a couple of bytes.  If I am correct, you should be able to use existing methods used to access the GBA bios.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Question#4: Has anyone figured out the PictoChat protocol enough to emulate it on the PC or other WiFi-enabled device (like an AIBO) ?</td> </tr></table><span class="postbody">
<br/>
<br/>
People have been able to capture packets sent from PictoChat and decode them into images.  I am not sure about sending your own PictoChat packets, though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41615 - caitsith2 - Sat Apr 30, 2005 8:52 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>PhoenixSoft wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Question #1: Has someone figured out an easy way to grab the ARM7 BIOS ROM?</td> </tr></table><span class="postbody">
<br/>
<br/>
I believe this is identical to the GBA bios except for a couple of bytes.  If I am correct, you should be able to use existing methods used to access the GBA bios.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I think what he is getting at, is trying to get the complete DS ARM7 bios.  The secure area, (address &lt; 0x1305) I have no idea how to read.  I recently had someone test an Idea I had, involving the CRC16 function to read it out.  No go.  I have no idea what method is used to read out the secure area.  However, the CRC16 idea I had, can read out the area above the secure area.
<br/>
<br/>
The basic idea, was to make a table you can compare against, for every byte value possible. (256 calls to build the table.)
<br/>
<br/>
Next was to call swiCRC([seed you used to build your table], [bios address], 1), and compare the result against your built table to find out the byte at that address.   The idea unfortunately returned the CRC16 for 0xFF for all bytes in the secure area, yet the rest of the bios read out just fine.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41619 - olimar - Sat Apr 30, 2005 9:32 am</h4>
    <div class="postbody"><span class="postbody"></span><span class="gensmall"><br/><br/>Last edited by olimar on Wed Aug 20, 2008 9:40 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#41792 - DsPet - Sun May 01, 2005 11:08 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the info.
<br/>
I suspected the initial ARM7 BIOS was going to be hard to break open. Yes my interest is in the DS mode version of the ARM7 (not the GBA mode).
<br/>
Finding an unchecked range access in the ARM7 SWI traps is probably the only software exploit - but probably wishful thinking :-&lt;
<br/>
<br/>
I guess the best option is to be hacking the Firmware (stored in I2C flash). If someone would provide some public information how to modify the firmware, that would be great.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#41804 - ector - Mon May 02, 2005 12:45 am</h4>
    <div class="postbody"><span class="postbody">Just so you don't waste your time, I've heard whisperings that it has indeed been read out already...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#42357 - gbarm7 - Tue May 10, 2005 4:08 pm</h4>
    <div class="postbody"><span class="postbody">wow
<br/>
i know that's the subject here but:
<br/>
if you knows such things you'llprobably know where to find some arm7 and arm9 documentation
<br/>
i'd like to start learnong things about arm processor
<br/>
so where sould i start???</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#42358 - captainsoup - Tue May 10, 2005 4:45 pm</h4>
    <div class="postbody"><span class="postbody">&gt;wow 
<br/>
&gt;i know that's the subject here but: 
<br/>
&gt;if you knows such things you'llprobably know where to find some arm7 &gt;and arm9 documentation 
<br/>
&gt;i'd like to start learnong things about arm processor 
<br/>
&gt;so where sould i start???
<br/>
<br/>
There should be tutorials out there on learning to program on the GBA in assembly, so I suggest you start there. Also, you should definately read the ARM7TDMI-S data sheet in it's entirety. You can find it on gbadev.org in Docs-&gt;ARM Documentation.<br/>_________________<br/>--Captain Soup</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
