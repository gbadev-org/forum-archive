<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem with Windows - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Problem with Windows</h2>
<div id="posts">
<div class="post">
    <h4>#86727 - LiraNuna - Thu Jun 08, 2006 8:21 pm</h4>
    <div class="postbody"><span class="postbody">I know how windows are working, and even used them on the GBA back then.
<br/>
But is it me, or they are wierd on the DS?
<br/>
<br/>
I follow only GBAtek for my gfx needs, and I assume it's the same on the DS (it even crosspand the defines in libnds' video.h...).
<br/>
I am using window 1 (yes, it's enabled on 0x4000000, and Window X0, X1, Y0 and Y1 are already inited) and I want my display as follows: 
<br/>
<br/>
BG0, BG1, BG3 and Sprites are on:
<br/>
<ul>BG0 is displayed inside and outside of window1
<br/>
BG1 is shown <span style="text-decoration: underline">only inside window 1</span>
<br/>
BG3 is allways displayed on top on both BGs
<br/>
HW Effect is applied on BG3
<br/>
Sprites anywhere on the screen
<br/>
Priority: BG3 &gt; BG1 &gt; Sprites  &gt; BG0</ul>
<br/>
So I follow my needs, and sets up my code with info from <a class="postlink" href="http://www.work.de/nocash/gbatek.htm#lcdiowindowfeature" target="_blank">GBAtek</a>:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">WIN_IN = BIT(8) | BIT(9) | BIT(11) | BIT(12) | BIT(13);
<br/>
WIN_OUT = BIT(0) | BIT(3) | BIT(4) | BIT(5);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Result: 
<br/>
<ul>BG0 is showing inside and outside window 1.
<br/>
<span style="text-decoration: underline">BG1 isn't showing at all.</span>
<br/>
BG3 is showing inside and outside window 1.
<br/>
Sprites are showing inside and outside window 1.
<br/>
HW effects are applied.</ul>
<br/>
<br/>
Thanks for your help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86739 - DekuTree64 - Thu Jun 08, 2006 9:05 pm</h4>
    <div class="postbody"><span class="postbody">I know you said it is, but it sounds like win1 isn't turned on, or isn't sized properly. Make sure all the regs you're setting are for the same screen, and that they're not being overwritten anywhere (like ORing bits into the window size regs, which I think are write only). 
<br/>
<br/>
Also keep in mind that the window size reg fields are only 8 bits each, so if you try to set the window 256 pixels wide, it will overflow. This kind of hurts the usefulness of windows on the DS, but I guess they decided it wasn't worth the extra cost to redesign the hardware to get that one last pixel.
<br/>
<br/>
There's also a weird problem that the top coordinate of the window doesn't seem to take effect until it gets at least 7 pixels down from the top of the screen. Any less than 7 and the window just extends all the way to the top of the screen. I guess it's a hardware bug of some sort.
<br/>
<br/>
EDIT: I ran some tests, and the top coordinate doesn't work within the upper 7 pixels unless the bottom coordinate is ALSO within the upper 7. Then it works fine. Bizarre.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86746 - LiraNuna - Thu Jun 08, 2006 9:47 pm</h4>
    <div class="postbody"><span class="postbody">The window is turned on, and the coordinates are fine.
<br/>
When I change WIN_IN and WIN_OUT registers, I get diffrent results, but never what I really want i.e only BG0 clipped with the window (Black on inside of window).
<br/>
<br/>
I never got anything to be <span style="text-decoration: underline">only</span> inside of a window, but that's what windows are for...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#86997 - LiraNuna - Sun Jun 11, 2006 9:30 am</h4>
    <div class="postbody"><span class="postbody">No one can help?
<br/>
&lt;/n00b&gt;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88090 - LiraNuna - Sat Jun 17, 2006 3:19 pm</h4>
    <div class="postbody"><span class="postbody">I got my problem solved. no thanks for help</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88093 - Dark Knight ez - Sat Jun 17, 2006 3:33 pm</h4>
    <div class="postbody"><span class="postbody">Sorry I could not be of any help. If I were knowledgable on the subject, I would have responded to your request.
<br/>
May I enquire as to how you solved your problem?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
