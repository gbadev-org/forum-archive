<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>[RESOLVED]Sound problem libnds - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > [RESOLVED]Sound problem libnds</h2>
<div id="posts">
<div class="post">
    <h4>#161477 - sepro - Mon Aug 04, 2008 7:57 pm</h4>
    <div class="postbody"><span class="postbody">I stumbled upon a problem with my sound I really can't seem to fix. 
<br/>
<br/>
So I tried to re-compile my rubik's cube sim with the new devkitarm, libnds, ... I was able to cope with the small differences but the sound is crumbled (this wasn't the case using devkitARM r21). Weird thing is that the sound code worked well when I tested it in a small test prog. Any thought were I should look for the problem. 
<br/>
<br/>
Any other methods to play sounds, now it's basically the simplesound code included in devkitpro i've used.
<br/>
<br/>
<span style="font-weight: bold">Solution:</span> Although I can't figure out why... for some reason the size of the sound wasn't correct (check wntrmute's simplesound). So it played the sound, then started reading parts that weren't sound at all resulting in random bits and bleeps. I fixed it by manually adding the size of the sound file (not a proper solution but for me it works)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#161632 - preussie - Fri Aug 08, 2008 1:50 pm</h4>
    <div class="postbody"><span class="postbody">I had a similar problem when I upgraded to r23b. It seems that the size of some files processed by 'bin2s.exe' have a wrong size. Using the old version of 'bin2s.exe' ( from r20 ) worked for me.<br/>_________________<br/><a class="postlink" href="http://preussie.miscstuff.de/ds//" target="_blank">My NDS Homebrew projects...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#161647 - josath - Sat Aug 09, 2008 2:13 am</h4>
    <div class="postbody"><span class="postbody">You guys manually process your data files, instead of using the template Makefile and having it magically compile them in for you?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#161654 - preussie - Sat Aug 09, 2008 10:42 am</h4>
    <div class="postbody"><span class="postbody">I use sox to generate a raw data file and drop it into my projects 'data' directory and it gets processed by the bin2s tool during the make process ( using the common devkitARM make rules ). 
<br/>
<br/>
In general I have no problem with sound/data files but I noticed that the size of at least  one ( out of 54 ) converted data files seems to be wrong. Using the old bin2s solved the issue for me. 
<br/>
<br/>
Nevertheless I still consider that I might have problem with a 'wild' pointer or something and this is not a general problem ;). But reading that some one else has a similar problem is interesting :)<br/>_________________<br/><a class="postlink" href="http://preussie.miscstuff.de/ds//" target="_blank">My NDS Homebrew projects...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#161656 - sepro - Sat Aug 09, 2008 11:49 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">You guys manually process your data files, instead of using the template Makefile and having it magically compile them in for you?</td> </tr></table><span class="postbody">
<br/>
<br/>
No I use the template makefile. By manually adding the size I mean doing this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">playGenericSound(shuffle_raw,28692);</td> </tr></table><span class="postbody">
<br/>
<br/>
when you want to play the sound. Instead of (like in the sample)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">playGenericSound(shuffle_raw,shuffle_raw_size);</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
The problem seems to be rather atypical. Sometimes it happens... But in the simplesound example + small test program I wrote myself it doesn't happen. So this is definitely not a general problem, making it pretty hard to track.  Maybe I'll try to (temporarily) remove my menu, to test the 'wild' pointer theory. (this is the only part of my project that uses pointers, but uses them heavily. Although I've used the menu class for several things and never had any troubles so far :s)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#161662 - tepples - Sat Aug 09, 2008 4:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>josath wrote:</b></span></td> </tr> <tr> <td class="quote">You guys manually process your data files, instead of using the template Makefile and having it magically compile them in for you?</td> </tr></table><span class="postbody">
<br/>
The DS, GBA, and Windows/Allegro targets of one of my projects all share one source tree. The template makefile would try and fail to compile those translation units that do not apply to a given platform, such as dssound.c on the GBA or pcjoy.c on the DS. So I still roll my own makefile for some more complex projects, especially those whose files need three layers of processing by custom data tools written in (native-compiled) C before they even hit devkitARM.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>preussie wrote:</b></span></td> </tr> <tr> <td class="quote">I use sox to generate a raw data file and drop it into my projects 'data' directory and it gets processed by the bin2s tool during the make process ( using the common devkitARM make rules ).</td> </tr></table><span class="postbody">
<br/>
Did you also manage to figure out a way to get the template makefile to run sox for you?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#161669 - preussie - Sat Aug 09, 2008 8:14 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Did you also manage to figure out a way to get the template makefile to run sox for you?</td> </tr></table><span class="postbody">
<br/>
<br/>
No, I convert the sounds manually :/. Not really a problem for me because they don't change too often - but it would be nice if it would work automatically... :)<br/>_________________<br/><a class="postlink" href="http://preussie.miscstuff.de/ds//" target="_blank">My NDS Homebrew projects...</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
