<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Appropriate data structure for file chooser? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > Appropriate data structure for file chooser?</h2>
<div id="posts">
<div class="post">
    <h4>#124780 - tepples - Sun Apr 08, 2007 4:03 pm</h4>
    <div class="postbody"><span class="postbody">I'm writing a file chooser for a DS app. Is it safe to assume a limit of, say, 256 valid files and folders inside a folder and malloc() enough to hold their names and stats, or should I dynamically resize the array with realloc() as I get results back from dirnext(), or should I use a linked list? What does your file chooser do?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124790 - Zarxrax - Sun Apr 08, 2007 6:09 pm</h4>
    <div class="postbody"><span class="postbody">I limit mine to 256, and if it gets more than that just don't try to store them.
<br/>
<br/>
Whether it's safe to assume a limit like that really depends on what kinds of files people will be listing. For instance, if you are listing NDS roms, I think it would be fairly safe to say that no one would ever have more than 256 in a single folder on their card. If it's something like images or text files though, I can see certain instances where a person MIGHT have more files than that. As long as the user is aware of the limit, I don't think there should be a problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124792 - Touchstone - Sun Apr 08, 2007 6:47 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">I'm writing a file chooser for a DS app. Is it safe to assume a limit of, say, 256 valid files and folders inside a folder and malloc() enough to hold their names and stats, or should I dynamically resize the array with realloc() as I get results back from dirnext(), or should I use a linked list? What does your file chooser do?</td> </tr></table><span class="postbody">
<br/>
I would assume you only need to hold the information for as many files as you can display at any given time. When the user scroll down in the list you simply do the dirnext() to get information for the next file.
<br/>
<br/>
I guess it depends on what you want to achieve though. If you want to have the fastest and best looking file chooser you probably want to pre cache information about every file in the directory, and if you want the most memory efficient and compatible file chooser you'd probably have to read information about the files currently visible to the user. Or maybe you want something in between.
<br/>
<br/>
As a professional programer I'd say you can't assume a limit of X files, but as a hobbyist programmer I'd say screw that, if someone have more than X files in one directory, just inform them of the limitation and only display the X first files, complete the app and later on improve on any annoying limitations.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124793 - DragonMinded - Sun Apr 08, 2007 6:53 pm</h4>
    <div class="postbody"><span class="postbody">In DSO, I simply realloc for every new item in a directory.  The speed isn't affected by this as much as it is by just listing the entire directory.  I have, however, created a struct that gets reallocated, not just a char *buffer or something, as I precache the icon, name, etc.<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124797 - DekuTree64 - Sun Apr 08, 2007 7:28 pm</h4>
    <div class="postbody"><span class="postbody">I loop through and count all the files, then allocate space, then loop through again storing the info for them.
<br/>
<br/>
If speed was a problem, I'd probably start with enough space for maybe 64, and realloc to 2x as much each time it fills up.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124807 - tepples - Sun Apr 08, 2007 8:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Touchstone wrote:</b></span></td> </tr> <tr> <td class="quote">I would assume you only need to hold the information for as many files as you can display at any given time. When the user scroll down in the list you simply do the dirnext() to get information for the next file.</td> </tr></table><span class="postbody">
<br/>
Because there is no dirprevious(), what should be done when the user scrolls back up under your scheme?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124808 - sajiimori - Sun Apr 08, 2007 8:41 pm</h4>
    <div class="postbody"><span class="postbody">Start from the beginning again and count up to n-1.  ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124810 - Lick - Sun Apr 08, 2007 9:08 pm</h4>
    <div class="postbody"><span class="postbody">You could pre-cache every subdirectory of only the <span style="font-style: italic">current</span> directory (depth = 1). That saves memory.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124811 - Touchstone - Sun Apr 08, 2007 9:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Touchstone wrote:</b></span></td> </tr> <tr> <td class="quote">I would assume you only need to hold the information for as many files as you can display at any given time. When the user scroll down in the list you simply do the dirnext() to get information for the next file.</td> </tr></table><span class="postbody">
<br/>
Because there is no dirprevious(), what should be done when the user scrolls back up under your scheme?</span></td> </tr></table><span class="postbody">
<br/>
I don't know the interface you're using so I can't tell you the most efficient way to solve it, but what sajimori said springs to mind. :-)<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124817 - sajiimori - Sun Apr 08, 2007 10:26 pm</h4>
    <div class="postbody"><span class="postbody">As an added bonus, you can scroll from the bottom of the list to the top in only O(n^2) time!  :P</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124818 - HyperHacker - Sun Apr 08, 2007 10:38 pm</h4>
    <div class="postbody"><span class="postbody">Mine is not very efficient but works well enough for the application in question. It only needs the names of the files, so it simply allocates an array of 256 * (Number of files) characters, reallocating it for each item read in with dirnext() (actually the GBA_NDS_FAT equivilant because it's old code I haven't switched to libFAT yet, but anyway). Once the listing is complete it allocates a second array the size of the first and copies the filenames into it in alphabetical order (making exceptions so that '/' is the first character, so directories are listed before files), then frees the first.
<br/>
<br/>
Does dirnext() return files in alphabetical order? That'd make things easier.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124822 - Lick - Sun Apr 08, 2007 11:13 pm</h4>
    <div class="postbody"><span class="postbody">HyperHacker, you don't need a second array if you use a good Sorting Algorithm.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124828 - DragonMinded - Sun Apr 08, 2007 11:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">HyperHacker, you don't need a second array if you use a good Sorting Algorithm.</td> </tr></table><span class="postbody">
<br/>
<br/>
What he said.  Why not use the qsort function?  I use it for all my sort code and I need no additional memory.<br/>_________________<br/>Enter the mind of the dragon.
<br/>
<br/>
<a href="http://dragonminded.blogspot.com" target="_blank">http://dragonminded.blogspot.com</a>
<br/>
<br/>
Seriously guys, how hard is it to simply TRY something yourself?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124899 - HyperHacker - Mon Apr 09, 2007 8:40 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, that's something I've been meaning to work on, I was just lazy.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124915 - Darkflame - Mon Apr 09, 2007 10:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'm writing a file chooser for a DS app. Is it safe to assume a limit of, say, 256 valid files and folders inside a folder </td> </tr></table><span class="postbody">
<br/>
<br/>
Not on my card you can :p
<br/>
<br/>
My NES games A-E folder has about 400 games in it :p
<br/>
<br/>
(and my Comic Book folder is nearly approaching 200)<br/>_________________<br/><a class="postlink" href="http://www.rateoholic.co.uk/RateoholicResults.php#SEARCHFOR=&amp;TYPE=VideoGame%25&amp;BY=darkflame&amp;ORDER=hyb_down&amp;ST=0" target="_blank">Darkflames Reviews</a>    --   
<br/>
Make your own at;
<br/>
<a class="postlink" href="http://www.rateoholic.co.uk" target="_blank"> Rateoholic:Reviews for anything, by anyone.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124916 - josath - Mon Apr 09, 2007 11:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Darkflame wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'm writing a file chooser for a DS app. Is it safe to assume a limit of, say, 256 valid files and folders inside a folder </td> </tr></table><span class="postbody">
<br/>
My NES games A-E folder has about 400 games in it :p
<br/>
<br/>
(and my Comic Book folder is nearly approaching 200)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
That's quite a collection, I only have like 15 NES carts. Do you have them in a display case or anything? That would look cool I bet.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124987 - Darkflame - Tue Apr 10, 2007 6:24 pm</h4>
    <div class="postbody"><span class="postbody">Ok, maybe they arnt all legal.
<br/>
But, that said, I <span style="font-style: italic">do</span> have quite a big Nes collection.
<br/>
<br/>
Not as good as my C16/Plus4 collection, mind you.
<br/>
Chairty shops are a gold mine for cheap old games.<br/>_________________<br/><a class="postlink" href="http://www.rateoholic.co.uk/RateoholicResults.php#SEARCHFOR=&amp;TYPE=VideoGame%25&amp;BY=darkflame&amp;ORDER=hyb_down&amp;ST=0" target="_blank">Darkflames Reviews</a>    --   
<br/>
Make your own at;
<br/>
<a class="postlink" href="http://www.rateoholic.co.uk" target="_blank"> Rateoholic:Reviews for anything, by anyone.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#125036 - HyperHacker - Wed Apr 11, 2007 12:16 am</h4>
    <div class="postbody"><span class="postbody">Well I'm sure that includes a lot of homebrews which aren't available on carts, right?
<br/>
<br/>
Also my MP3 directory has 273 files in it.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#125054 - Darkflame - Wed Apr 11, 2007 1:15 am</h4>
    <div class="postbody"><span class="postbody">My DS Homebrew or my commadore plus/4 homebrew? :p
<br/>
<br/>
Got easily over a hundred DS Homebrew things, but they are  a bit better organised in sub folders.
<br/>
eg,
<br/>
~Games, 
<br/>
~~WiFi Games
<br/>
~Apps
<br/>
~~WiFi Apps
<br/>
~Emulation
<br/>
ect.
<br/>
<br/>
Other stuff on my DS Card is far less organised.
<br/>
Computer game sound tracks, Midis and the like are just one big mess of files.
<br/>
<br/>
oh, and sadly, my Commadore Plus/4 homebrew is still on tapes :p
<br/>
One of these days I might print out and OCR some of my stuff to run them on emulators just for fun. 
<br/>
Didnt make much interesting anyway. A conways game of life here, a 0's and X's game there.
<br/>
Best thing I did on my Commadore is a program to make it print out graphics on a text-based printer. Utterly useless to port.<br/>_________________<br/><a class="postlink" href="http://www.rateoholic.co.uk/RateoholicResults.php#SEARCHFOR=&amp;TYPE=VideoGame%25&amp;BY=darkflame&amp;ORDER=hyb_down&amp;ST=0" target="_blank">Darkflames Reviews</a>    --   
<br/>
Make your own at;
<br/>
<a class="postlink" href="http://www.rateoholic.co.uk" target="_blank"> Rateoholic:Reviews for anything, by anyone.</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#125079 - chishm - Wed Apr 11, 2007 5:30 am</h4>
    <div class="postbody"><span class="postbody">I'd suggest using a double-linked list, add items as you read them, then sort the list when you're finished. C++ has the STL, which can make creating and sorting the list pretty easy to do.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
