<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Matrix manipulation -> Screen Coordinates? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Matrix manipulation -> Screen Coordinates?</h2>
<div id="posts">
<div class="post">
    <h4>#172143 - DiscoStew - Mon Jan 18, 2010 8:03 pm</h4>
    <div class="postbody"><span class="postbody">Some months ago, I had asked about if it were possible to do something like the Painter's Algorithm on the NDS, where you rely on drawing objects from back to front rather than using a depth buffer for sorting. For some time now, I felt that it couldn't be done because of the way the NDS handles the geometry by hardware, but lately, I was thinking about it, and was wondering...
<br/>
<br/>
Is it possible to set up the Perspective Matrix (or one of the others) so that when geometry is sent in, the matrix will convert it to screen coordinates with a constant depth from anything sent in?
<br/>
<br/>
I ask this because I remembered that with POLY_ATTR, bit14 is the Depth Test, where when set, polygons will only be drawn if they match the depth in the internal buffer. While usually used to give the appearance of multi-texturing, if the depth of <span style="font-weight: bold">everything</span> were the same in, then wouldn't that be a reasonable method for setting up a Painter's Algorithm?<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172144 - kusma - Mon Jan 18, 2010 8:20 pm</h4>
    <div class="postbody"><span class="postbody">Why do you want to sort yourself, when the zbuffer is for free?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172146 - DiscoStew - Mon Jan 18, 2010 8:46 pm</h4>
    <div class="postbody"><span class="postbody">It's just a thought if there was ever a need for it. A possible example is a viewing screen within a 3D-scene, that doesn't resort to using up a block of VRAM and using the display capture unit (also forcing the frame limit down), but then again, such an idea would require the same mechanics but on a 3D plane, and because of accuracy, that may not work either. :(<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172147 - sajiimori - Tue Jan 19, 2010 12:41 am</h4>
    <div class="postbody"><span class="postbody">The viewing screen example still tends to require capture because you can't disable the Z buffer even if you want to.
<br/>
<br/>
That is, the DS will <span style="font-style: italic">always</span> drop pixels that don't pass the Z test -- you can't turn off the Z test and do your own sorting.  :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172148 - elhobbs - Tue Jan 19, 2010 3:46 am</h4>
    <div class="postbody"><span class="postbody">I suspect you would also loose perspective correct texturing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172166 - Exophase - Wed Jan 20, 2010 9:15 pm</h4>
    <div class="postbody"><span class="postbody">W is used for perspective correction - if you stay with Z-buffering and manage to get a constant Z then it should work. I think you have two options - either Z = 0 or Z = W * C where C is some constant. W of all the incoming vertexes should be a constant 1.
<br/>
<br/>
Since clipping is done before perspective correction it should be from +/- W, so you want to make sure the Z value is within this range, which 0 should satisfy. Making the entire third row of the projection matrix 0 should accomplish this.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
