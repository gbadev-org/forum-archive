<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Detecting DS Lite (solv'd) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Detecting DS Lite (solv'd)</h2>
<div id="posts">
<div class="post">
    <h4>#132632 - HyperHacker - Thu Jun 28, 2007 9:45 am</h4>
    <div class="postbody"><span class="postbody">I'm using this code copied from Moonshell to tell the difference between DS and DS Lite:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define PM_NDSLITE_ISLITE BIT(6)
<br/>
<br/>
//See if this is a DS Lite
<br/>
   SerialWaitBusy();
<br/>
   REG_SPICNT = SPI_ENABLE | SPI_DEVICE_POWER | SPI_BAUD_1MHz | SPI_CONTINUOUS;
<br/>
   REG_SPIDATA = 0x80;
<br/>
   SerialWaitBusy();
<br/>
   REG_SPICNT = SPI_ENABLE | SPI_DEVICE_POWER | SPI_BAUD_1MHz;
<br/>
   REG_SPIDATA = 0;
<br/>
   SerialWaitBusy();
<br/>
<br/>
   if(REG_SPIDATA &amp; PM_NDSLITE_ISLITE) SysInfo |= SI_DSLITE;</td> </tr></table><span class="postbody">
<br/>
It seems this bit is never set on either type of system. What's the problem here?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"><br/><br/>Last edited by HyperHacker on Fri Jun 29, 2007 1:34 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#132647 - Lick - Thu Jun 28, 2007 11:15 am</h4>
    <div class="postbody"><span class="postbody">Just use this:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">bool Lite = (bool)(readPowerManagement(4) &amp; BIT(6))</td> </tr></table><span class="postbody">
<br/>
<br/>
The problem with your code is the first variable to go in REG_SPIDATA is not 0x80, but (0x80 | 0x4) because you want to read SPI4's bit6, not sPI0's bit6.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132649 - Rajveer - Thu Jun 28, 2007 12:33 pm</h4>
    <div class="postbody"><span class="postbody">Why would you want to detect if it's a Lite or not? I remember something about the regular and Lite screens being different, but what else? I'm just wondering, maybe it will be useful for my project ;).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132654 - tepples - Thu Jun 28, 2007 12:53 pm</h4>
    <div class="postbody"><span class="postbody">Possibly to display the control help on the correct background?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132659 - spinal_cord - Thu Jun 28, 2007 1:53 pm</h4>
    <div class="postbody"><span class="postbody">aren't the lcds a different way round? BGR instead of RGB?<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132666 - Lino - Thu Jun 28, 2007 2:17 pm</h4>
    <div class="postbody"><span class="postbody">Is there then a 4th register? Do you know its configuration?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132669 - Lick - Thu Jun 28, 2007 2:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>spinal_cord wrote:</b></span></td> </tr> <tr> <td class="quote">aren't the lcds a different way round? BGR instead of RGB?</td> </tr></table><span class="postbody">
<br/>
The physical-order, yes. Though the pixeldata are still in RGB. So it only matters when you're using sub-pixel techniques.
<br/>
<br/>
Lino: bit0 and bit1 control the current backlight strength and bit6 is always set on a Lite. This information was first found in Moonshell.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132733 - HyperHacker - Fri Jun 29, 2007 12:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Rajveer wrote:</b></span></td> </tr> <tr> <td class="quote">Why would you want to detect if it's a Lite or not? I remember something about the regular and Lite screens being different, but what else? I'm just wondering, maybe it will be useful for my project ;).</td> </tr></table><span class="postbody">To have backlight brightness controls, of course.
<br/>
<br/>
[edit] So is it not possible to adjust the brightness of each screen individually?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132801 - Lick - Fri Jun 29, 2007 3:54 pm</h4>
    <div class="postbody"><span class="postbody">Nope, but you can shut down each screen individually.
<br/>
<br/>
Also, you could screw with the Master Brightness setting of a screen so it seems to be darker. Not sure how that affects the power usage though, it probably doesn't.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132808 - silent_code - Fri Jun 29, 2007 5:32 pm</h4>
    <div class="postbody"><span class="postbody">the master brightness is just sort of a gama shift... i included that in my volume shadow demo. ;^)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132836 - GPFerror - Fri Jun 29, 2007 11:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">Just use this:<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">bool Lite = (bool)(readPowerManagement(4) &amp; BIT(6))</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
arm7 only ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#132846 - HyperHacker - Sat Jun 30, 2007 3:54 am</h4>
    <div class="postbody"><span class="postbody">Yeah, only ARM7 can access power management. Kind of a shame since it's great for debugging, to be able to blink lights and play sound with only one or two lines of code. All ARM9 can do (short of talking to ARM7) is display something, which requires setting up VRAM etc etc.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
