<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>IPC Now and IPC in the future - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > IPC Now and IPC in the future</h2>
<div id="posts">
<div class="post">
    <h4>#154392 - Lazy1 - Tue Apr 15, 2008 4:57 pm</h4>
    <div class="postbody"><span class="postbody">So I decided to re-port sdl-sopwith with the intention of doing a much better and cleaner job than before.
<br/>
I got sound working yesterday but I'm 99% sure my shared memory IPC will break horribly when devkitARM gets upgraded.
<br/>
<br/>
What is the ideal way to go here?
<br/>
Should I wait until better IPC methods become standard or keep using shared memory and update my code later?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154405 - tepples - Tue Apr 15, 2008 7:51 pm</h4>
    <div class="postbody"><span class="postbody">Isn't there a way to install two copies of devkitARM on a PC, one kept updated and one not updated? I'd like to know too.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154406 - simonjhall - Tue Apr 15, 2008 7:55 pm</h4>
    <div class="postbody"><span class="postbody">Before upgrading I just take a copy the entire devkitpro directory. If I have problems, I just revert to the old one. Easy money...<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154409 - silent_code - Tue Apr 15, 2008 8:42 pm</h4>
    <div class="postbody"><span class="postbody">in code::blocks, i have different compiler sets i can choose from (an create). so i could, in theory, have two isolated installations without collisions. and no environment variables needed (can be set in c::b). ok, i *have* two sets of gcc installed, one for win32 and one for arm/nds.
<br/>
<br/>
for me it's just a matter of tools. :^)
<br/>
<br/>
ps: i was a hardcore shell user (not neccessary knowledge wise, but in usage frequency)... and i still wouldn't touch eclipse (no offense!)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154413 - simonjhall - Tue Apr 15, 2008 10:54 pm</h4>
    <div class="postbody"><span class="postbody">What does this change in IPC mean anyway? As in the IPC struct that's used to move the pen position etc from CPU to the other is going to be changed, or is it something like the FIFO is going to be always in use or something?<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154415 - silent_code - Tue Apr 15, 2008 11:18 pm</h4>
    <div class="postbody"><span class="postbody">afaik, things are going to be handled by the fifo.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154419 - yellowstar - Wed Apr 16, 2008 1:10 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lazy1 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I got sound working yesterday but I'm 99% sure my shared memory IPC will break horribly when devkitARM gets upgraded.
<br/>
</td> </tr></table><span class="postbody">
<br/>
So dka22 is going to not allow anybody to even use shared memory, or at least screw anything using shared memory?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154424 - eKid - Wed Apr 16, 2008 2:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">So dka22 is going to not allow anybody to even use shared memory, or at least screw anything using shared memory?</td> </tr></table><span class="postbody">
<br/>
You can still use shared memory:
<br/>
You just need to:
<br/>
1) allocate memory
<br/>
2) pass pointer through FIFO</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154425 - elhobbs - Wed Apr 16, 2008 2:19 am</h4>
    <div class="postbody"><span class="postbody">I suspect it will only break shared memory if your implementation uses the IPC struct or is tagged unto it - just a guess though. I seam to remember a few threads with certain people getting quite upset whenever someone released a lib that referenced the IPC struct.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154426 - yellowstar - Wed Apr 16, 2008 2:26 am</h4>
    <div class="postbody"><span class="postbody">Good. I was wondering about Juglak's WMB Host, since it uses shared memory.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154493 - wintermute - Thu Apr 17, 2008 12:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yellowstar wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lazy1 wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I got sound working yesterday but I'm 99% sure my shared memory IPC will break horribly when devkitARM gets upgraded.
<br/>
</td> </tr></table><span class="postbody">
<br/>
So dka22 is going to not allow anybody to even use shared memory, or at least screw anything using shared memory?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
This has nothing to do with devkitARM, nothing in the toolchain is particularly DS specific.
<br/>
<br/>
devkitARM release 22 will change nothing that will affect any aspect of the DS libraries.
<br/>
<br/>
The next release of libnds will take place after devkitARM r22, after that the use of shared memory for interprocessor communication will be deprecated. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I seam to remember a few threads with certain people getting quite upset whenever someone released a lib that referenced the IPC struct.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
People are being given advice not to depend on the IPC struct, it *will* be deprecated and removed. This is called fair warning, it's nothing to do with being upset.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154507 - elhobbs - Thu Apr 17, 2008 1:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>elhobbs wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
I seam to remember a few threads with certain people getting quite upset whenever someone released a lib that referenced the IPC struct.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
People are being given advice not to depend on the IPC struct, it *will* be deprecated and removed. This is called fair warning, it's nothing to do with being upset.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
sorry if I offended, I was really just trying to point out this topic has come up a few times before while not naming names. In any case thank you for all of the work you do on devkit/libnds. It not only makes homebrew development for the DS possible, but also fairly painless. Thank you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154520 - simonjhall - Thu Apr 17, 2008 7:46 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">The next release of libnds will take place after devkitARM r22, after that the use of shared memory for interprocessor communication will be deprecated.</td> </tr></table><span class="postbody">What exactly does that mean? And how will it become deprecated? I've never touched the IPC struct, I don't use the FIFO but I do use shared memory (allocated via malloc) in my programs.
<br/>
What will this mean for me?<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154527 - elhobbs - Thu Apr 17, 2008 1:43 pm</h4>
    <div class="postbody"><span class="postbody">it is only an issue if it uses the IPC struct which wintermute said will be depreciated and removed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154528 - wintermute - Thu Apr 17, 2008 1:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>simonjhall wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
What exactly does that mean? And how will it become deprecated? I've never touched the IPC struct, I don't use the FIFO but I do use shared memory (allocated via malloc) in my programs.
<br/>
What will this mean for me?</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't really understand your question. How are you using shared memory without FIFO or the IPC struct?
<br/>
<br/>
One of the major features added to libnds is a FIFO communciation layer and API. The intent is to provide a default arm7 core which provides most features the average homebrewer is likely to need and reduce the need for writing custom code. This, in turn, will allow us to produce better dswifi examples without the need to maintain many examples including a custom core.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154530 - simonjhall - Thu Apr 17, 2008 2:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">One of the major features added to libnds is a FIFO communciation layer and API. The intent is to provide a default arm7 core which provides most features the average homebrewer is likely to need and reduce the need for writing custom code.</td> </tr></table><span class="postbody">Kewl, that sounds fab. Will stuff like text printing and the like be made available through this?<br/>_________________<br/><span style="font-weight: bold"><a class="postlink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=simonjhall%40gmail%2ecom&amp;no_shipping=2&amp;no_note=1&amp;tax=0&amp;currency_code=GBP&amp;lc=GB&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8" target="_blank">Big thanks to everyone who donated for Quake2</a></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154680 - tepples - Sun Apr 20, 2008 7:55 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">I don't really understand your question. How are you using shared memory without FIFO or the IPC struct?
<br/>
<br/>
One of the major features added to libnds is a FIFO communciation layer and API.</td> </tr></table><span class="postbody">
<br/>
So as I understand it, programs that used to send a pointer to shared memory through the IPC struct can be trivially updated to send the same pointer through the FIFO, right?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#154910 - nutki - Tue Apr 22, 2008 9:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote">People are being given advice not to depend on the IPC struct, it *will* be deprecated and removed. This is called fair warning, it's nothing to do with being upset.</td> </tr></table><span class="postbody">
<br/>
<br/>
Will you modify linker scripts to include last 4k of memory in the heap when removing IPC struct? I vote for leaving it as is. I know that using this memory can be replaced by IPC queue, but it would be easier to port existing apps.
<br/>
<br/>
Edit: Speaking of linker script. The DTCM is defined to be 16k in length and the stacks in negative offsets from dtcm_end. This allows full 16k to be allocated in C code using section(".dtcm") and trashing stacks / interrupt vectors in result. Is this considered non issue or I am doing something wrong.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
