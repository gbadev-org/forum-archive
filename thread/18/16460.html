<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Get memory size - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Get memory size</h2>
<div id="posts">
<div class="post">
    <h4>#166821 - hacker013 - Thu Feb 19, 2009 5:23 pm</h4>
    <div class="postbody"><span class="postbody">hey everybody,
<br/>
<br/>
How do I get the size of the allocated memory from a pointer? I've tryed sizeof but that doesn't work.
<br/>
<br/>
gr,
<br/>
<br/>
newbie013<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166822 - elhobbs - Thu Feb 19, 2009 5:42 pm</h4>
    <div class="postbody"><span class="postbody">it depends on the allocator used. you are better off tracking it yourself if you need this information.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166824 - hacker013 - Thu Feb 19, 2009 6:14 pm</h4>
    <div class="postbody"><span class="postbody">i'm making a memory handling library, it is just using malloc, calloc, realloc and free.<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166828 - a128 - Thu Feb 19, 2009 6:43 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void meminfo() {
<br/>
<br/>
#ifdef DEBUG
<br/>
    struct mallinfo info = mallinfo();
<br/>
<br/>
    int byte=(info.usmblks + info.uordblks);
<br/>
/*
<br/>
    if (byte&lt;1024)
<br/>
        iprintf("Memory use: %d bytes\n",byte);
<br/>
    else
<br/>
        iprintf("Memory use: %d KB \n",byte/1024);
<br/>
   */
<br/>
 iprintf("Memory use: %d bytes\n",byte);
<br/>
<br/>
    iprintf("Total heap size: %d KB\n", info.arena/1024);
<br/>
#endif
<br/>
<br/>
<br/>
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
This code is for showing what mem you have left. 
<br/>
<br/>
use the search engine...this mem question is posted dozens of times</span><span class="gensmall"><br/><br/>Last edited by a128 on Fri Feb 20, 2009 9:22 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#166829 - Miked0801 - Thu Feb 19, 2009 6:43 pm</h4>
    <div class="postbody"><span class="postbody">From where?  Which libs alloc functions are you using?  There's a good chance that they have their own memory reporters as well.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166831 - kusma - Thu Feb 19, 2009 7:16 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">How do I get the size of the allocated memory from a pointer?</td> </tr></table><span class="postbody">
<br/>
Easy; you don't. This is not something C/C++ allows you to. As someone else pointed out, you must track this information yourself if you need it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166844 - hacker013 - Fri Feb 20, 2009 11:34 am</h4>
    <div class="postbody"><span class="postbody">I googled it and there is existing a function for that called: _msize() but is this function supported by devkitARM ? i'm using just de basic library's<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166845 - sverx - Fri Feb 20, 2009 11:47 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">How do I get the size of the allocated memory from a pointer?</td> </tr></table><span class="postbody">
<br/>
<br/>
You have to check the size of the type of the memory pointed. So if you have a pointer to a struct, then sizeof(struct).
<br/>
<br/>
btw the size of the allocated memory is decided when you malloc it so just keep it somewhere in memory...<br/>_________________<br/><a class="postlink" href="http://bit.ly/yiQrz9" target="_blank">libXM7</a>|<a class="postlink" href="http://bit.ly/yJwcOo" target="_blank">NDS programming tutorial (Italiano)</a>|<a class="postlink" href="http://disjointedstudio.blogspot.com/" target="_blank">Waimanu DS / GBA</a>|<a class="postlink" href="http://adshomebrewersdiary.blogspot.com" target="_blank">A DS Homebrewer's Diary</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#166849 - elhobbs - Fri Feb 20, 2009 4:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   The `malloc_usable_size' function takes a pointer to a block
<br/>
allocated by `malloc'.  It returns the amount of space that is
<br/>
available in the block.  This may or may not be more than the size
<br/>
requested from `malloc', due to alignment or minimum size constraints.
<br/>
</td> </tr></table><span class="postbody">not sure if it fully implemented but you could give it a try if you insist on ignoring the advice that people have provided you. keep in mind that this does not correlate to the size of the object that you requested, but rather to the size of the block of memory that malloc provides to you.</span><span class="gensmall"><br/><br/>Last edited by elhobbs on Fri Feb 20, 2009 4:32 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#166850 - kusma - Fri Feb 20, 2009 4:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>hacker013 wrote:</b></span></td> </tr> <tr> <td class="quote">I googled it and there is existing a function for that called: _msize() but is this function supported by devkitARM ? i'm using just de basic library's</td> </tr></table><span class="postbody">
<br/>
_msize is specific to Microsoft's CRT implementation, and can't be used on other platforms than Windows.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
