<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>MoonShell boot code - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > MoonShell boot code</h2>
<div id="posts">
<div class="post">
    <h4>#90154 - bjoerngiesler - Wed Jun 28, 2006 5:42 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm trying to pinch a bit of code from the MoonShell sources to build an exec()/system() function, i.e. to run a NDS file from SuperCard (and later others). Long story short, it doesn't work, and I don't know exactly why. Can anyone help out?
<br/>
<br/>
First problem is that the routine resetMemory1_ARM9() doesn't compile. It gives errors such as the following:
<br/>
<br/>
Error: dest and source1 must be the same register -- `orr r2,r1,r0'
<br/>
Error: bad instruction `mcr p15,0,r2,c7,c14,2'
<br/>
<br/>
... and more. I know next to nothing about ARM9 assembler (will have to learn it, obviously); but how can this compile for MoonShell?
<br/>
<br/>
Without the resetMemory1_ARM9 routine (but keeping all other code intact), the launching process just hangs, so I suppose the memory reset is absolutely needed.
<br/>
<br/>
Has anyone done something like this before and can give me some pointers?
<br/>
<br/>
Thanks a lot in advance,
<br/>
Bj?rn</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90211 - tepples - Wed Jun 28, 2006 10:50 pm</h4>
    <div class="postbody"><span class="postbody">Make sure that you're not assembling in Thumb mode.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90301 - chishm - Thu Jun 29, 2006 12:17 pm</h4>
    <div class="postbody"><span class="postbody">In other words, your program will have to be compiled in ARM mode, or you'll need to write external .s files and link them in. There should (hopefully) be something about that in the FAQ.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90307 - bjoerngiesler - Thu Jun 29, 2006 2:11 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
thanks a lot... fixed my problem already. Turns out that the memory reset isn't needed after all.
<br/>
<br/>
I now have a cleaned-up exec() that works for SuperCard and should work for M3 and GBAMP as well, although I have no way to test that. If anyone is interested, I'll put it up somewhere.
<br/>
<br/>
Regards,
<br/>
Bj?rn</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90411 - The 9th Sage - Fri Jun 30, 2006 4:30 am</h4>
    <div class="postbody"><span class="postbody">I could help test either of those.<br/>_________________<br/>Now with 20% More Old Man from Zelda 1 than ever before!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90908 - EyeballKid - Mon Jul 03, 2006 12:41 pm</h4>
    <div class="postbody"><span class="postbody">Ohhh - fantastic! Yes, please post your code!
<br/>
I've got an M3 Perfect SD and a Supercard SD I can test it on for you.
<br/>
<br/>
Thanks!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
