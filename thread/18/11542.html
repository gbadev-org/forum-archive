<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Code: Reset to Supercard, ezflashIV, GBAMP, M3 (NEW) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>DS development > Code: Reset to Supercard, ezflashIV, GBAMP, M3 (NEW)</h2>
<div id="posts">
<div class="post">
    <h4>#107109 - Lick - Thu Oct 26, 2006 6:40 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-size: 18px; line-height: normal"><span style="font-weight: bold">Step 1 ARM9:</span> Device-specific code to reset "Menu" (BootFlash/FlashROM/OS) mode</span>
<br/>
<br/>
<span style="font-weight: bold">Supercard CF(<span style="color: green">works</span>), SD(<span style="color: green">works</span>), miniSD(<span style="color: green">works</span>), microSD(<span style="color: green">works</span>) - Rumble versions are the same?</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  sysSetBusOwners(true, true);
<br/>
  *(vu16*)0x09FFFFFE = 0xA55A;
<br/>
  *(vu16*)0x09FFFFFE = 0xA55A;
<br/>
  *(vu16*)0x09FFFFFE = 0;
<br/>
  *(vu16*)0x09FFFFFE = 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">M3CF(<span style="color: green">works</span>), M3SD(<span style="color: green">works</span>), M3miniSD(<span style="color: green">works</span>), M3Lite(<span style="color: darkblue">should work</span>)</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Note that the M3 requires the ARM7 to jump to 0x80000C0 instead of 0x8000000. See below.
<br/>
<br/>
sysSetBusOwners(true, true);                    
<br/>
u32 mode = 0x00400000;
<br/>
vu16 tmp;
<br/>
tmp = *(vu16*)(0x08E00002);
<br/>
tmp = *(vu16*)(0x0800000E);
<br/>
tmp = *(vu16*)(0x08801FFC);
<br/>
tmp = *(vu16*)(0x0800104A);
<br/>
tmp = *(vu16*)(0x08800612);
<br/>
tmp = *(vu16*)(0x08000000);
<br/>
tmp = *(vu16*)(0x08801B66);
<br/>
tmp = *(vu16*)(0x08000000 + (mode &lt;&lt; 1)); 
<br/>
tmp = *(vu16*)(0x0800080E);
<br/>
tmp = *(vu16*)(0x08000000);
<br/>
tmp = *(vu16*)(0x09000000);
<br/>
<br/>
or..
<br/>
<br/>
sysSetBusOwners(true, true);                    
<br/>
u32 mode = 0x00400004;
<br/>
vu16 tmp;
<br/>
tmp = *(vu16*)(0x08E00002);
<br/>
tmp = *(vu16*)(0x0800000E);
<br/>
tmp = *(vu16*)(0x08801FFC);
<br/>
tmp = *(vu16*)(0x0800104A);
<br/>
tmp = *(vu16*)(0x08800612);
<br/>
tmp = *(vu16*)(0x08000000);
<br/>
tmp = *(vu16*)(0x08801B66);
<br/>
tmp = *(vu16*)(0x08000000 + (mode &lt;&lt; 1)); 
<br/>
tmp = *(vu16*)(0x0800080E);
<br/>
tmp = *(vu16*)(0x08000000);
<br/>
<br/>
tmp = *(vu16*)(0x080001E4);
<br/>
tmp = *(vu16*)(0x080001E4);
<br/>
tmp = *(vu16*)(0x08000188);
<br/>
tmp = *(vu16*)(0x08000188);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">EZFlash III (not tested), EFA2 (not tested)</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  sysSetBusOwners(true, true);
<br/>
  *(u16 *)0x9FE0000 = 0xD200;
<br/>
  *(u16 *)0x8000000 = 0x1500;
<br/>
  *(u16 *)0x8020000 = 0xD200;
<br/>
  *(u16 *)0x8040000 = 0x1500;
<br/>
  *(u16 *)0x9880000 = 1 &lt;&lt; 15; // "Menu" mode
<br/>
  *(u16 *)0x9FC0000 = 0x1500;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">GBAMP with chishms hack(<span style="color: green">works</span>)</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">No code needed. Already in "Menu" mode.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">DS-Extreme (not tested)</span>
<br/>
<span style="font-weight: bold">Ninja DS (not tested)</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">????? Dunno!
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-weight: bold">G6L (by Puyo)</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   sysSetCartOwner(BUS_OWNER_ARM9);
<br/>
   u16 i = *(volatile u16*)0x09000000;
<br/>
   i = *(volatile u16*)0x09FFFFE0;   
<br/>
   i = *(volatile u16*)0x09FFFFEC;
<br/>
   i = *(volatile u16*)0x09FFFFEC;
<br/>
   i = *(volatile u16*)0x09FFFFEC;   
<br/>
   i = *(volatile u16*)0x09FFFFFC;
<br/>
   i = *(volatile u16*)0x09FFFFFC;
<br/>
   i = *(volatile u16*)0x09FFFFFC;   
<br/>
   i = *(volatile u16*)0x09FFFF4A;
<br/>
   i = *(volatile u16*)0x09FFFF4A;
<br/>
   i = *(volatile u16*)0x09FFFF4A;
<br/>
   i = *(volatile u16*)(0x09200000 + (0));
<br/>
   i = *(volatile u16*)0x09FFFFF0;
<br/>
   i = *(volatile u16*)0x09FFFFE8;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<span style="font-size: 18px; line-height: normal"><span style="font-weight: bold">Step 2 ARM9:</span> When the device is in "Menu" mode, enter the famous "PassMe" loop</span>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  sysSetBusOwners(false, false);
<br/>
  *((vu32*)0x027FFFFC) = 0;
<br/>
  *((vu32*)0x027FFE04) = (u32)0xE59FF018;
<br/>
  *((vu32*)0x027FFE24) = (u32)0x027FFE04;
<br/>
  swiSoftReset();
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
<span style="font-size: 18px; line-height: normal"><span style="font-weight: bold">Step 3 ARM7:</span> Keep checking if ARM9 entered "PassMe" loop</span>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while(1)
<br/>
{
<br/>
  if(*((vu32*)0x027FFE24) == (u32)0x027FFE04)
<br/>
  {
<br/>
    *((vu32*)0x027FFE34) = (u32)0x08000000;
<br/>
    // For M3 devices, use: (u32)0x080000C0;
<br/>
    swiSoftReset();
<br/>
  }
<br/>
  swiWaitForVBlank();
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
edit:
<br/>
I will add more device specific code, as I find them.
<br/>
<br/>
edit:
<br/>
I changed the ARM7 jump to 0x08000000. It was first 0x080000C0, but some cards don't work on that one.
<br/>
<br/>
edit:
<br/>
I added '*((vu32*)0x027FFFFC) = 0;' to ARM9. It's only necessary for GBAMP, but it's good to have it at that position.
<br/>
Also, replaced the asm jumps with swiSoftReset().
<br/>
<br/>
<br/>
<br/>
Thanks WinterMute, pepsiman for this method.
<br/>
Thanks Loopy for sharing the firmware decryption/decompression code.
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"><br/><br/>Last edited by Lick on Fri Feb 23, 2007 1:49 pm; edited 32 times in total</span></div>    
</div>
<div class="post">
    <h4>#107119 - Mr Snowflake - Thu Oct 26, 2006 8:35 pm</h4>
    <div class="postbody"><span class="postbody">Nice, always wanted a function like this.
<br/>
<br/>
Now we only need one for M3 :p.<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107122 - Lick - Thu Oct 26, 2006 9:16 pm</h4>
    <div class="postbody"><span class="postbody">It's simple, the theory is like this.
<br/>
<br/>
On the ARM9 side: 
<br/>
<ul>Determine which devicetype (Supercard CF/SD/miniSD/microSD, M3 blabla)
<br/>
Use device-specific code to set it back to Boot Flash mode
<br/>
Go into the famous "PassMe" loop</ul>
<br/>
<br/>
On the ARM7 side:
<br/>
<ul>Wait till ARM9 is in "PassMe" loop
<br/>
Jump to 0x080000C0</ul>
<br/>
<br/>
I'm working on a ready-to-use package!
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107135 - Lick - Fri Oct 27, 2006 12:29 am</h4>
    <div class="postbody"><span class="postbody">--removed. See first post.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"><br/><br/>Last edited by Lick on Fri Oct 27, 2006 3:56 pm; edited 3 times in total</span></div>    
</div>
<div class="post">
    <h4>#107164 - Dark Knight ez - Fri Oct 27, 2006 9:25 am</h4>
    <div class="postbody"><span class="postbody">Might I ask which EZ-Flash product specificly? All of them? 1 through 4?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107171 - Mr Snowflake - Fri Oct 27, 2006 11:02 am</h4>
    <div class="postbody"><span class="postbody">Why are these values changed twice to the same value:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
            *(vu16*)0x09FFFFFE = 0xA55A;
<br/>
            *(vu16*)0x09FFFFFE = 0xA55A;
<br/>
            *(vu16*)0x09FFFFFE = 0;   // Hey! Go back to Boot Flash mode aka "Menu" mode!
<br/>
            *(vu16*)0x09FFFFFE = 0; 
<br/>
</td> </tr></table><span class="postbody">
<br/>
Or is it just a typo?
<br/>
<br/>
BTW: if you don't have a M3 (CF in my case), I'll be happy to test.<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107172 - Dark Knight ez - Fri Oct 27, 2006 11:04 am</h4>
    <div class="postbody"><span class="postbody">It's part of an unlocking mechanism, most likely. Not a typo.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107178 - Lick - Fri Oct 27, 2006 12:50 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold">Might I ask which EZ-Flash product specificly? All of them? 1 through 4?</span>
<br/>
I tested on my ezflash iv lite and it works. But the code is for EFA2, so I suppose the architecture is pretty same on those devices. I need testers though. A lot of them.
<br/>
<br/>
<span style="font-weight: bold">BTW: if you don't have a M3 (CF in my case), I'll be happy to test.</span>
<br/>
Could you test for me? I don't own an M3 but I'm already working on a solution for that device.
<br/>
<br/>
<span style="font-weight: bold">Twice the same value, is it just a typo?</span>
<br/>
Nope, it's part of the talk-to-device procedure. Supercard requires writing 0xA55A twice to that location, then you can write the desired value (in this case: 0) twice.
<br/>
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107196 - Lick - Fri Oct 27, 2006 3:58 pm</h4>
    <div class="postbody"><span class="postbody">Oh gee, I just found out that the EFA2 code doesn't apply to any EZ device. The fact that it worked on my ezflashIVlite was because it doesn't need any set-"Menu"-mode-code.
<br/>
<br/>
Anyway, I updated the first post to reflect what I've tested. I need M3 device testers right now!<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107200 - Dark Knight ez - Fri Oct 27, 2006 4:25 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">EZFlash IV Deluxe(not tested), Lite(works)</td> </tr></table><span class="postbody">
<br/>
Actually, there are the following EZ4 products:
<br/>
- EZ-Flash 4
<br/>
- EZ-Flash 4 Lite
<br/>
- EZ-Flash 4 Lite: Deluxe (more room for GBA programs)
<br/>
- EZ-Flash 4 Lite: Compact (no room for GBA programs)
<br/>
<br/>
I'm pretty sure all EZ-Flash 4 products have the same interface though.
<br/>
EZ-Flash 2 and 3 are closely related to the EZ-Flash 4 (shown by users being able to execute patched games meant to run on EZ-Flash 4, on their EZ-Flash 2 and EZ-Flash 3), but would require testing.
<br/>
<br/>
Thanks for all your effort though. Showing us clearly how this all can be achieved is really appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107201 - Lick - Fri Oct 27, 2006 4:31 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for clearing up. I fixed it in the first post. 
<br/>
<br/>
Are you interested in testing? What cards do you have? I'm looking for testers! 
<br/>
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107205 - knight0fdragon - Fri Oct 27, 2006 4:47 pm</h4>
    <div class="postbody"><span class="postbody">not working on supercard cf<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107207 - Lick - Fri Oct 27, 2006 5:06 pm</h4>
    <div class="postbody"><span class="postbody">Could you upload the source of your test app? I just want to make sure.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107211 - Dark Knight ez - Fri Oct 27, 2006 6:02 pm</h4>
    <div class="postbody"><span class="postbody">I own an EZ-Flash 4 Lite, and an EZ-Flash 2.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107213 - knight0fdragon - Fri Oct 27, 2006 6:10 pm</h4>
    <div class="postbody"><span class="postbody">ok it works with my supercard CF and my XGFlash2 Lite, turns out the ARM7 passme code is also needed<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107238 - Lick - Fri Oct 27, 2006 10:36 pm</h4>
    <div class="postbody"><span class="postbody">Knight0fDragon, with that last device (XGFlash Lite..), do you simply press R or do you touch the Save &amp; Return button?
<br/>
(<span style="font-style: italic">I sent Knight0fDragon a test application</span>)
<br/>
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107260 - knight0fdragon - Sat Oct 28, 2006 2:46 am</h4>
    <div class="postbody"><span class="postbody">R does not work for me ever, it is the save and reset button<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107345 - Lick - Sat Oct 28, 2006 8:41 pm</h4>
    <div class="postbody"><span class="postbody">knight0fdragon: does the XGFlash Lite show a -red- or -green- color, before going back to the bootmenu?
<br/>
<br/>
Also, I have updated the first post many times now. It contains a lot more information, and with the updated code, GBAMP is supported! Yay!<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107651 - Lick - Tue Oct 31, 2006 9:36 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-weight: bold"><span style="color: red">Muahuahuhaha!!</span></span> <span style="font-weight: bold"><span style="color: green">I have added M3 support!</span> </span>Thanks Whacko (irc) for testing on M3CF and M3SD.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107664 - Dark Knight ez - Wed Nov 01, 2006 12:08 am</h4>
    <div class="postbody"><span class="postbody">Good job. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107706 - Sektor - Wed Nov 01, 2006 10:51 am</h4>
    <div class="postbody"><span class="postbody">Yeah nice work.  I can confirm that it boots M3CF.<br/>_________________<br/><span style="font-size: 9px; line-height: normal"><a class="postlink" href="http://gtamp.com/DS" target="_blank">GTAMP.com/DS</a></span></span><span class="gensmall"><br/><br/>Last edited by Sektor on Wed Nov 01, 2006 1:54 pm; edited 5 times in total</span></div>    
</div>
<div class="post">
    <h4>#107714 - 0xtob - Wed Nov 01, 2006 1:02 pm</h4>
    <div class="postbody"><span class="postbody">Great job, Lick! I can confirm it works on M3 miniSD. Once you release the template code, I'll include reboot in my apps.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107726 - Lick - Wed Nov 01, 2006 4:27 pm</h4>
    <div class="postbody"><span class="postbody">Thanks everyone! Really need to thank the testers as well!
<br/>
<br/>
And yes 0xt0b, that reminds me.. 
<br/>
Which of the following distributions would you guys prefer?
<br/>
- Add to libfat. This will need WinterMute and chishm to allow and help me to do.
<br/>
- Build as a new library. For example "libreboot.a" or "libreset.a".
<br/>
- Simply clean up the code and release a .h and a .c/cpp file.
<br/>
<br/>
Thanks,
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107729 - OOPMan - Wed Nov 01, 2006 4:53 pm</h4>
    <div class="postbody"><span class="postbody">Erm, I would say option 2 or option 3. I can't see any logic in adding the code to libfat...
<br/>
<br/>
I would personally prefer to be in the form of a library, but that's just me...
<br/>
<br/>
I imagine the code is simple enough, overall, for it come in the form of a header and so forth...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107741 - sectionboy - Wed Nov 01, 2006 6:28 pm</h4>
    <div class="postbody"><span class="postbody">A simple question, how to detect what type of flash card the program is running on?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107748 - Lick - Wed Nov 01, 2006 6:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sectionboy wrote:</b></span></td> </tr> <tr> <td class="quote">A simple question, how to detect what type of flash card the program is running on?</td> </tr></table><span class="postbody">
<br/>
Use libfat of DevKitPro r19b. Read 'ndsx_gbaslot.h' in the LoveLite sourcecode and you'll find the hack that josath aka davr provided to me.
<br/>
<br/>
OOPMan: I'm thinking of option 2 and 3 also. I prefer building it to a lib .<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107759 - sectionboy - Wed Nov 01, 2006 8:22 pm</h4>
    <div class="postbody"><span class="postbody">Thanks alot!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107792 - chuckstudios - Thu Nov 02, 2006 12:49 am</h4>
    <div class="postbody"><span class="postbody">Hey, great work and all that. This will really help if I ever get around to coding that idea I have...
<br/>
<br/>
Anyways. How about for GBA mode? Here's a program that makes a EZ4 (it works on my EZ3 too) reset from NDS to GBA mode... 
<br/>
<br/>
<a href="http://www.sosuke.com/ezflash/viewtopic.php?t=2599" target="_blank">http://www.sosuke.com/ezflash/viewtopic.php?t=2599</a>
<br/>
<br/>
(it's not the first piece of code, it's the ones later posted by cory1492 that work)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107801 - felix123 - Thu Nov 02, 2006 4:30 am</h4>
    <div class="postbody"><span class="postbody">Great job! Finally homebrew can use the soft reset function!
<br/>
Since this depends on libfat, would option one be the easiest option?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107844 - Lick - Thu Nov 02, 2006 4:18 pm</h4>
    <div class="postbody"><span class="postbody">chuckstudios: I don't think it will be hard to implement, though I also don't think that this feature fits into the subjects category. I would rather see it in libnds.
<br/>
<br/>
felix123: Yup, I hope many developers will use it. This way it will make the DS feel more PDA than handheld, right? I'm not sure if my code will ever get into DevKitPro. WinterMute and chishm haven't replied here so hmm.. I think a library release will be the final choice, then.
<br/>
<br/>
- Lick<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107859 - tepples - Thu Nov 02, 2006 5:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sectionboy wrote:</b></span></td> </tr> <tr> <td class="quote">A simple question, how to detect what type of flash card the program is running on?</td> </tr></table><span class="postbody">
<br/>
Use libfat of DevKitPro r19b.</span></td> </tr></table><span class="postbody">
<br/>
And lose directory reading.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107861 - Lick - Thu Nov 02, 2006 5:27 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sectionboy wrote:</b></span></td> </tr> <tr> <td class="quote">A simple question, how to detect what type of flash card the program is running on?</td> </tr></table><span class="postbody">
<br/>
Use libfat of DevKitPro r19b.</span></td> </tr></table><span class="postbody">
<br/>
And lose directory reading.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">A simple question, how to detect what type of flash card the program is running on?</td> </tr></table><span class="postbody">
<br/>
<br/>
I had only answered his "simple" question. ;P<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#107913 - chishm - Fri Nov 03, 2006 2:13 am</h4>
    <div class="postbody"><span class="postbody">This isn't really within the scope of libfat. libfat is designed for reading and writing FAT formatted media, nothing else. I think the best option would be to release it as a single .h/.c(pp) file combination if it is small enough, or as a library if the source is too complicated to keep in one file or gets updated often.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119433 - Puyo - Thu Feb 22, 2007 11:17 pm</h4>
    <div class="postbody"><span class="postbody">Hi. I just wanted to share this code for rebooting G6L to main menu.
<br/>
<span style="font-weight: bold">Rebooting ARM9:</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
/* Select MENU mode */
<br/>
<br/>
   sysSetCartOwner(BUS_OWNER_ARM9);
<br/>
   SelectOperation(0);
<br/>
<br/>
   sysSetCartOwner(BUS_OWNER_ARM7);
<br/>
   *((vu32*)0x027FFE04) = (u32)0xE59FF018;
<br/>
   *((vu32*)0x027FFE24) = (u32)0x027FFE04;
<br/>
   swiSoftReset(); 
<br/>
<br/>
/* End */
<br/>
<br/>
void SelectOperation(u16 op)
<br/>
{
<br/>
   u16 i;
<br/>
   
<br/>
   i = *(volatile u16*)0x09000000;
<br/>
   i = *(volatile u16*)0x09FFFFE0;
<br/>
   
<br/>
   i = *(volatile u16*)0x09FFFFEC;
<br/>
   i = *(volatile u16*)0x09FFFFEC;
<br/>
   i = *(volatile u16*)0x09FFFFEC;
<br/>
   
<br/>
   i = *(volatile u16*)0x09FFFFFC;
<br/>
   i = *(volatile u16*)0x09FFFFFC;
<br/>
   i = *(volatile u16*)0x09FFFFFC;
<br/>
   
<br/>
   i = *(volatile u16*)0x09FFFF4A;
<br/>
   i = *(volatile u16*)0x09FFFF4A;
<br/>
   i = *(volatile u16*)0x09FFFF4A;
<br/>
<br/>
   i = *(volatile u16*)(0x09200000 + (op&lt;&lt;1));
<br/>
   i = *(volatile u16*)0x09FFFFF0;
<br/>
   i = *(volatile u16*)0x09FFFFE8;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<span style="font-weight: bold">Rebooting ARM7:</span>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   // Standart stuff
<br/>
   while (1) 
<br/>
   {
<br/>
     if(*((vu32*)0x027FFE24) == (u32)0x027FFE04)
<br/>
     {
<br/>
       *((vu32*)0x027FFE34) = (u32)0x080000C0;
<br/>
       swiSoftReset();
<br/>
     }
<br/>
     swiWaitForVBlank();
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
<br/>
And Lick, could you please add this to your library.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119473 - HyperHacker - Fri Feb 23, 2007 10:15 am</h4>
    <div class="postbody"><span class="postbody">Hm, it'd be nice if the cart-reset functions were somehow integrated into libFAT, so they could be part of DLDI patches and have working autodetect.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119484 - Lick - Fri Feb 23, 2007 1:51 pm</h4>
    <div class="postbody"><span class="postbody">Nice find Puyo!
<br/>
<br/>
HyperHacker: I don't think that will ever happen, as it's darn hard to write good enough code that's worthy of getting included into libfat or libnds.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119557 - chishm - Sat Feb 24, 2007 9:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">Hm, it'd be nice if the cart-reset functions were somehow integrated into libFAT, so they could be part of DLDI patches and have working autodetect.</td> </tr></table><span class="postbody">
<br/>
I've said it before -- direct cart reset functions are out of scope of libfat. However, there is a way to do it, which complements the existing functions. Add the code to put the cart into menu mode to the shutdown function of the cart's DLDI. When the card is unmounted, it will be shutdown and placed into menu mode. Then you can call a common reset routine which just resets the DS.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119562 - HyperHacker - Sat Feb 24, 2007 9:54 am</h4>
    <div class="postbody"><span class="postbody">Sometimes you want to unmount and not reset, though. For example my GBA boot menu has the option to unmount at will so that you can do so for slot 2 cards before switching to a GBA cartridge. Unless you just meant unmounting would prepare the card to be reset?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119574 - chishm - Sat Feb 24, 2007 12:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">Unless you just meant unmounting would prepare the card to be reset?</td> </tr></table><span class="postbody">
<br/>
Yes, that's what I said. The card itself is merely placed in the same mode it is in when the DS is first turned on. The DS is reset by a different function, not the shutdown function.<br/>_________________<br/><a class="postlink" href="http://chishm.drunkencoders.com" target="_blank">http://chishm.drunkencoders.com</a>
<br/>
<a class="postlink" href="http://dldi.drunkencoders.com" target="_blank">http://dldi.drunkencoders.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119643 - HyperHacker - Sun Feb 25, 2007 12:07 am</h4>
    <div class="postbody"><span class="postbody">Well that makes sense. Now we just need to go update all the DLDIs to do this... :-/<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119769 - Lick - Mon Feb 26, 2007 12:47 am</h4>
    <div class="postbody"><span class="postbody">And not all DLDIs come with source code. Blegh! 
<br/>
<br/>
But yeah, I think the future for libcartreset will be:
<br/>
1) custom builds of DLDI with reset. These could become official DLDIs, not necessary.
<br/>
2) new simplified API that only does PassMe loop.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119870 - HyperHacker - Mon Feb 26, 2007 11:33 pm</h4>
    <div class="postbody"><span class="postbody">I was recently pondering the idea of a GBA cart library that would tell you just what is inserted (e.g. GBAMP, Mario Kart Super Circuit, Nintendo Rumble Pak etc) and might provide functions to interface with them in various ways outside of what libFAT does (rumble control, EEPROM read/write, reset etc). Since you need to detect the cartridge type to use libCartReset anyway, it seems like they'd go well together. Obviously there aren't going to be DLDIs for rumble paks and GBA games, because there's no filesystem on them, so we can't really use that method.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119878 - tepples - Tue Feb 27, 2007 12:46 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">Obviously there aren't going to be DLDIs for rumble paks and GBA games, because there's no filesystem on them</td> </tr></table><span class="postbody">
<br/>
Is it that there is no file system in a GBA game, or is it that there is no MS-FAT file system in a GBA game? The Jaleco NES compilation is thought to use the PocketNES file system (48-byte header, ROM data, 48-byte header, ROM data, etc). I wonder if any commercial game uses a variant of GBFS.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119890 - HyperHacker - Tue Feb 27, 2007 5:46 am</h4>
    <div class="postbody"><span class="postbody">Well if Chishm wants to add support to libFAT for commercial games' filesystems, then by all means... not really a necessary feature, I'd say.<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
