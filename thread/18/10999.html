<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>detecting screen type BGR vs RGB ? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > detecting screen type BGR vs RGB ?</h2>
<div id="posts">
<div class="post">
    <h4>#100790 - GPFerror - Wed Aug 30, 2006 4:39 pm</h4>
    <div class="postbody"><span class="postbody">I have a library that uses the subpixel font, and was wonder if there was a way to detect if the top screen is RGB or BGR so i display the correct colors on the top screen.
<br/>
<br/>
I was told that all dslites use BGR, while the phat ds's use RGB on top BGR on bottom screen, is this correct?
<br/>
<br/>
So is there a way to detect top screen type or type of hardware from the arm9 preferably?
<br/>
<br/>
thanks,
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100791 - gmiller - Wed Aug 30, 2006 4:44 pm</h4>
    <div class="postbody"><span class="postbody">Not that I know the correct answer, but if the DS Lite will play the old games then I would assume that the layouts are the same.  Some people think of the colors as big-endian (BGR) or little-endian (RGB) but the bits are the same 5 bits for each color in two bytes with a left over bit.  Of course I do not have a DS-Lite so I could be full of ....</span><span class="gensmall"><br/><br/>Last edited by gmiller on Wed Aug 30, 2006 11:10 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#100812 - freemaan - Wed Aug 30, 2006 9:06 pm</h4>
    <div class="postbody"><span class="postbody">Yeah... the "Phat" DS have RGB(top)/BGR(bottom), the Lite have BGR/BGR screens (I've checked them :P)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100820 - gmiller - Wed Aug 30, 2006 11:09 pm</h4>
    <div class="postbody"><span class="postbody">Hmm .. that is interesting.  I noticed that I can select which screen is the GBA screen in the setup menu.  This would mean that they auto convert the colors in GBA mode?  GBA is RGB from lowbit to high bit or BGR from high bit to low.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100821 - spinal_cord - Wed Aug 30, 2006 11:21 pm</h4>
    <div class="postbody"><span class="postbody">I thing he's talking about the screen pixels rather than the colors.
<br/>
<br/>
If it is as it seems, that lites top screens are different from phats, then I would assume detecting the thingy that sets the screen brightness in the lites would tell you the difference (between lite and phat) thus giving you a fair idea as to which is which.<br/>_________________<br/>I'm not a boring person, it's just that boring things keep happening to me.
<br/>
<a class="postlink" href="http://spinal.dizidesigns.co.uk/" target="_blank">Homepage</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100827 - Lick - Wed Aug 30, 2006 11:45 pm</h4>
    <div class="postbody"><span class="postbody">GPF doesn't wunna code teh ARM7 CUP!! =p
<br/>
<br/>
You'll have to man, things like these (SPI reads) are only accessable from the ARM7-side-of-things. 
<br/>
<br/>
Or like I suggested, make a quick boot-screen that asks if it is a lite or phatty.
<br/>
<br/>
[edit] Or make two builds, one for lite and one for phatty.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100842 - tepples - Thu Aug 31, 2006 1:55 am</h4>
    <div class="postbody"><span class="postbody">If it matters, I'd recommend just making a preference for RGB vs. BGR, saving it when the player leaves Options, and loading it from CF/SD/SRAM on startup.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100847 - knight0fdragon - Thu Aug 31, 2006 2:40 am</h4>
    <div class="postbody"><span class="postbody">on a pixel level, the order of the rgb doesnt matter,  I doubt that any of the DS games to date use subpixel graphics, but I could be wrong, for it is good for antialiasing.,  GPF,  is there not a way to check whether the DS is a Phat or a Lite<br/>_________________<br/><a href="http://www.myspace.com/knight0fdragonds" target="_blank">http://www.myspace.com/knight0fdragonds</a>
<br/>
<br/>
MK DS FC: Dragon 330772 075464 
<br/>
AC WW FC: Anthony SamsClub 1933-3433-9458 
<br/>
MPFH: Dragon 0215 4231 1206</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100853 - GPFerror - Thu Aug 31, 2006 4:36 am</h4>
    <div class="postbody"><span class="postbody">yeah adding a splash screen or a special key combination is doable but not very elegant.
<br/>
<br/>
Since its a library that will used by others hopefully, having a custom arm7 makes it more difficult for others to use.
<br/>
<br/>
Well hopefully someone out there figures it out and can share it :)
<br/>
<br/>
Thanks,
<br/>
Troy(GPF)
<br/>
<a href="http://gpf.dcemu.co.uk" target="_blank">http://gpf.dcemu.co.uk</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100861 - HyperHacker - Thu Aug 31, 2006 6:48 am</h4>
    <div class="postbody"><span class="postbody">Do any DS games to date use subpixel rendering? Nintendo may have avoided it in case of problems like this. Anyway I'd suggest making it an option in a menu somewhere, but default to what should be correct based on the Phat vs Lite bit and the screen being used.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gmiller wrote:</b></span></td> </tr> <tr> <td class="quote">Hmm .. that is interesting.  I noticed that I can select which screen is the GBA screen in the setup menu.  This would mean that they auto convert the colors in GBA mode?  GBA is RGB from lowbit to high bit or BGR from high bit to low.</td> </tr></table><span class="postbody">
<br/>
Yeah, do GBA games using subpixel rendering look right on both screens?<br/>_________________<br/>I'm a PSP hacker now, but I still &lt;3 DS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100886 - Lick - Thu Aug 31, 2006 12:37 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">Do any DS games to date use subpixel rendering? Nintendo may have avoided it in case of problems like this. Anyway I'd suggest making it an option in a menu somewhere, but default to what should be correct based on the Phat vs Lite bit and the screen being used.
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gmiller wrote:</b></span></td> </tr> <tr> <td class="quote">Hmm .. that is interesting.  I noticed that I can select which screen is the GBA screen in the setup menu.  This would mean that they auto convert the colors in GBA mode?  GBA is RGB from lowbit to high bit or BGR from high bit to low.</td> </tr></table><span class="postbody">
<br/>
Yeah, do GBA games using subpixel rendering look right on both screens?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Those games may have used a custom ARM7 binary (that GPF doesn't want to use) to see if it's a DS Phatty or DS Lite. This -CAN- be checked, as you can see in my brightness_test demo. The thing is, GPF is writing a library that he wants to be plugged into other projects in a few seconds, not needing the coder to create a whole new ARM7 binary if they don't want to. 
<br/>
<br/>
GPF: it's really easy to check if it's a Phatty or Lite with the ARM7. It's just a matter of setting up a Fifo handler (they do that) that calls a function that handles it (you write this). Two simple steps away from the default bin. But in any case: <span style="font-weight: bold">provide a boolean for the coder to pass to your library and STOP WORRYING.</span>
<br/>
<br/>
 ;)<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100909 - OOPMan - Thu Aug 31, 2006 6:04 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, there is some difference.
<br/>
<br/>
Nethack DS needs to have it's sub-pixel font switched on the DS Lite, otherwise the top screen is unreadable (It made my eyes bleed, almost. The I read that F6 did a switch and it fixed the eye pain)
<br/>
<br/>
I guess it's this BGR vs RGB thing :-)<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100911 - gmiller - Thu Aug 31, 2006 6:19 pm</h4>
    <div class="postbody"><span class="postbody">Wow, I did not know that the lite was that different.  It would seem that there would have to be some auto conversion that you must be able to turn on or early games (before the lite) would be screwed in their display.
<br/>
<br/>
With a lite can you set the top screen to the screen for GBA games?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100918 - josath - Thu Aug 31, 2006 7:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>gmiller wrote:</b></span></td> </tr> <tr> <td class="quote">Wow, I did not know that the lite was that different.  It would seem that there would have to be some auto conversion that you must be able to turn on or early games (before the lite) would be screwed in their display.</td> </tr></table><span class="postbody">
<br/>
The problem ONLY happens if you are doing subpixel rendering. afaik, no commercial games do this, so this is not an issue for them, and no 'conversion' is needed</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100926 - Flood_of_SYNs - Thu Aug 31, 2006 9:45 pm</h4>
    <div class="postbody"><span class="postbody">What about checking the WIFI MAC address?<br/>_________________<br/><span style="font-weight: bold"><span style="font-size: 9px; line-height: normal"><span style="color: blue">Blue NDS v4 (FlashMe v7) - GBAMP V2 CF</span>
<br/>
?There is no shame in not knowing; the shame lies in not finding out.?
<br/>
?The church is near but the road is icy, the bar is far away but I will walk carefully?</span></span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100944 - Lick - Thu Aug 31, 2006 11:34 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://nocash.emubase.de/gbatek.htm#dsfirmwareheader" target="_blank">http://nocash.emubase.de/gbatek.htm#dsfirmwareheader</a>
<br/>
  01Dh 1    Console type? (FFh=NDS, 20h=NDS-lite, 43h=iQueDS)
<br/>
<br/>
If this is proven to be correct, and the dsfirmware is readable from ARM9, then this should do it.
<br/>
<br/>
[edit] But I guess it isn't.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100952 - josath - Fri Sep 01, 2006 12:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote"><a class="postlink" href="http://nocash.emubase.de/gbatek.htm#dsfirmwareheader" target="_blank">http://nocash.emubase.de/gbatek.htm#dsfirmwareheader</a>
<br/>
  01Dh 1    Console type? (FFh=NDS, 20h=NDS-lite, 43h=iQueDS)
<br/>
<br/>
If this is proven to be correct, and the dsfirmware is readable from ARM9, then this should do it.
<br/>
<br/>
[edit] But I guess it isn't.</td> </tr></table><span class="postbody">
<br/>
<br/>
Isn't correct or isn't readable?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#100976 - Lick - Fri Sep 01, 2006 9:29 am</h4>
    <div class="postbody"><span class="postbody">I don't think it's accessable, you'll have to try though.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
