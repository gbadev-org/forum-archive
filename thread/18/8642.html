<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>I still can't figure this out... (Pic with problem included) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>DS development > I still can't figure this out... (Pic with problem included)</h2>
<div id="posts">
<div class="post">
    <h4>#72590 - Linkiboy - Mon Feb 20, 2006 3:58 am</h4>
    <div class="postbody"><span class="postbody">This has been bugging me for ages.
<br/>
<br/>
I'm trying to display two different sprites, but they come out as one sprite which is one on top of the other. Here is a picture of what is happening:
<br/>
<br/>
<a class="postlink" href="http://img132.imageshack.us/img132/3878/problem6pu.jpg" target="_blank">http://img132.imageshack.us/img132/3878/problem6pu.jpg</a>
<br/>
<br/>
Someone explain how this works, please.
<br/>
<br/>
Here is my code....
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "..\nds.h"
<br/>
#include "..\memory.h"
<br/>
#include "..\screen.h"
<br/>
#include "..\system.h"
<br/>
#include "..\keys.h"
<br/>
#include "..\ipc.h"
<br/>
#include "ship.h"
<br/>
<br/>
int x,y,spritex,spritey,tempx,tempy,wait,i;
<br/>
<br/>
void removesprites() //function, outside main, must be called from within main
<br/>
{
<br/>
int i;
<br/>
for(i = 0; i &lt; 1024; i++)
<br/>
OAM[i * 4] = ATTR0_DISABLED;
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
powerON(POWER_ALL);
<br/>
videoSetMode(MODE_0_2D | SPR_1D_LAYOUT | SPR_ACTIVE); //activates 2d and turns on sprites in 1d mode
<br/>
VRAM_BANK_A(VRAM_SPRITE); //sprite vram
<br/>
for(i = 0; i &lt; 512; i++)
<br/>
SPRITE_PALETTE[i] = ((u16*)shipPalette)[i];
<br/>
for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)shipData)[i];
<br/>
for(i = 0; i &lt; 256; i++)
<br/>
removesprites();
<br/>
y = 150;
<br/>
x = 120;
<br/>
SPRITE_PALETTE[1] = RGB(31,0,0); //sprites pallet
<br/>
SPRITE_GFX[0] = 0x0000; //sprite image data
<br/>
SPRITE_GFX[1] = 0x0101;
<br/>
SPRITE_GFX[2] = 0x0101;
<br/>
SPRITE_GFX[3] = 0x0000;
<br/>
SPRITE_GFX[4] = 0x0100;
<br/>
SPRITE_GFX[5] = 0x0000;
<br/>
SPRITE_GFX[6] = 0x0000;
<br/>
SPRITE_GFX[7] = 0x0001;
<br/>
SPRITE_GFX[8] = 0x0100;
<br/>
SPRITE_GFX[9] = 0x0000;
<br/>
SPRITE_GFX[10] = 0x0000;
<br/>
SPRITE_GFX[11] = 0x0001;
<br/>
SPRITE_GFX[12] = 0x0000;
<br/>
SPRITE_GFX[13] = 0x0101;
<br/>
SPRITE_GFX[14] = 0x0101;
<br/>
SPRITE_GFX[15] = 0x0000;
<br/>
SPRITE_GFX[16] = 0x0000;
<br/>
SPRITE_GFX[17] = 0x0100;
<br/>
SPRITE_GFX[18] = 0x0001;
<br/>
SPRITE_GFX[19] = 0x0000;
<br/>
SPRITE_GFX[20] = 0x0000;
<br/>
SPRITE_GFX[21] = 0x0101;
<br/>
SPRITE_GFX[22] = 0x0101;
<br/>
SPRITE_GFX[23] = 0x0000;
<br/>
SPRITE_GFX[24] = 0x0000;
<br/>
SPRITE_GFX[25] = 0x0100;
<br/>
SPRITE_GFX[26] = 0x0001;
<br/>
SPRITE_GFX[27] = 0x0000;
<br/>
SPRITE_GFX[28] = 0x0000;
<br/>
SPRITE_GFX[29] = 0x0001;
<br/>
SPRITE_GFX[30] = 0x0100;
<br/>
SPRITE_GFX[31] = 0x0000;
<br/>
removesprites(); //uses function to remove sprites from the screen
<br/>
spritey = 50;
<br/>
spritex = 100;
<br/>
while(1)
<br/>
{
<br/>
if(READ_KEYS &amp; KEY_LEFT)
<br/>
{
<br/>
tempx = x;
<br/>
tempx--;
<br/>
if(tempx&gt;0 &amp; (tempx&lt;spritex-16 | tempx&gt;spritex+16 | y&lt;spritey-16 | y&gt;spritey+16)){x = tempx;}
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_RIGHT)
<br/>
{
<br/>
tempx = x;
<br/>
tempx++;
<br/>
if(tempx&lt;248 &amp; (tempx&lt;spritex-16 | tempx&gt;spritex+16 | y&lt;spritey-16 | y&gt;spritey+16)){x = tempx;}
<br/>
}
<br/>
<br/>
OAM[0] = ATTR0_COLOR_256 | ATTR0_SQUARE | spritey; //ATTR0, atribute which controls sprites colour, shape and x coord
<br/>
OAM[1] = ATTR1_SIZE_16 | spritex; //ATTR1 is size and y coord
<br/>
OAM[2] = 0; //ATTR2 is sprite img no.
<br/>
OAM[4] = ATTR0_COLOR_256 | ATTR0_SQUARE | y; //ATTR0, atribute which controls sprites colour, shape and y coord
<br/>
OAM[5] = ATTR1_SIZE_16 | x; //ATTR1 is size and x coord
<br/>
OAM[6] = 0; //ATTR2 is sprite img no.
<br/>
//oam3 rotates and zooms but is not needed
<br/>
WaitForVBlank();
<br/>
}
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72637 - waruwaru - Mon Feb 20, 2006 6:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if(tempx&gt;0 &amp; (tempx&lt;spritex-16 | tempx&gt;spritex+16 | y&lt;spritey-16 | y&gt;spritey+16)){x = tempx;} 
<br/>
} 
<br/>
if(READ_KEYS &amp; KEY_RIGHT) 
<br/>
{ 
<br/>
tempx = x; 
<br/>
tempx++; 
<br/>
if(tempx&lt;248 &amp; (tempx&lt;spritex-16 | tempx&gt;spritex+16 | y&lt;spritey-16 | y&gt;spritey+16)){x = tempx;} 
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Not sure if this is your problem, but I think you want the boolean operators <span style="font-weight: bold">&amp;&amp;</span> and <span style="font-weight: bold">||</span>, instead of the bit operators <span style="font-weight: bold">&amp;</span> and <span style="font-weight: bold">|</span>.  Also, personally, I like to put <span style="font-weight: bold">()</span> around each expression, so I don't have to worry about operator precedence.  Something like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if( (tempx&gt;0) &amp;&amp; ( (tempx&lt;(spritex-16)) || (tempx&gt;(spritex+16)) || (y&lt;(spritey-16)) || (y&gt;(spritey+16))))
<br/>
{
<br/>
Â  x = tempx;
<br/>
} 
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72706 - Linkiboy - Tue Feb 21, 2006 4:05 am</h4>
    <div class="postbody"><span class="postbody">No thats not the problem, but thanks for trying.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72708 - tepples - Tue Feb 21, 2006 4:21 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Linkiboy wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)shipData)[i];
<br/>
<br/>
// ...
<br/>
<br/>
SPRITE_GFX[0] = 0x0000; //sprite image data
<br/>
SPRITE_GFX[1] = 0x0101;
<br/>
SPRITE_GFX[2] = 0x0101;
<br/>
SPRITE_GFX[3] = 0x0000;
<br/>
SPRITE_GFX[4] = 0x0100;
<br/>
SPRITE_GFX[5] = 0x0000;
<br/>
SPRITE_GFX[6] = 0x0000;
<br/>
SPRITE_GFX[7] = 0x0001;
<br/>
SPRITE_GFX[8] = 0x0100;
<br/>
SPRITE_GFX[9] = 0x0000;
<br/>
SPRITE_GFX[10] = 0x0000;
<br/>
SPRITE_GFX[11] = 0x0001;
<br/>
SPRITE_GFX[12] = 0x0000;
<br/>
SPRITE_GFX[13] = 0x0101;
<br/>
SPRITE_GFX[14] = 0x0101;
<br/>
SPRITE_GFX[15] = 0x0000;
<br/>
SPRITE_GFX[16] = 0x0000;
<br/>
SPRITE_GFX[17] = 0x0100;
<br/>
SPRITE_GFX[18] = 0x0001;
<br/>
SPRITE_GFX[19] = 0x0000;
<br/>
SPRITE_GFX[20] = 0x0000;
<br/>
SPRITE_GFX[21] = 0x0101;
<br/>
SPRITE_GFX[22] = 0x0101;
<br/>
SPRITE_GFX[23] = 0x0000;
<br/>
SPRITE_GFX[24] = 0x0000;
<br/>
SPRITE_GFX[25] = 0x0100;
<br/>
SPRITE_GFX[26] = 0x0001;
<br/>
SPRITE_GFX[27] = 0x0000;
<br/>
SPRITE_GFX[28] = 0x0000;
<br/>
SPRITE_GFX[29] = 0x0001;
<br/>
SPRITE_GFX[30] = 0x0100;
<br/>
SPRITE_GFX[31] = 0x0000;
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Here you copy in the ship, but then you overwrite it with the spaceman.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">OAM[0] = ATTR0_COLOR_256 | ATTR0_SQUARE | spritey; //ATTR0, atribute which controls sprites colour, shape and x coord
<br/>
OAM[1] = ATTR1_SIZE_16 | spritex; //ATTR1 is size and y coord
<br/>
OAM[2] = 0; //ATTR2 is sprite img no.
<br/>
OAM[4] = ATTR0_COLOR_256 | ATTR0_SQUARE | y; //ATTR0, atribute which controls sprites colour, shape and y coord
<br/>
OAM[5] = ATTR1_SIZE_16 | x; //ATTR1 is size and x coord
<br/>
OAM[6] = 0; //ATTR2 is sprite img no.
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Here you use the same "sprite img no." for both sprites, which turns out to be a ship partially overwritten with a spaceman.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72710 - Linkiboy - Tue Feb 21, 2006 4:28 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Linkiboy wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)shipData)[i];
<br/>
<br/>
// ...
<br/>
<br/>
SPRITE_GFX[0] = 0x0000; //sprite image data
<br/>
SPRITE_GFX[1] = 0x0101;
<br/>
SPRITE_GFX[2] = 0x0101;
<br/>
SPRITE_GFX[3] = 0x0000;
<br/>
SPRITE_GFX[4] = 0x0100;
<br/>
SPRITE_GFX[5] = 0x0000;
<br/>
SPRITE_GFX[6] = 0x0000;
<br/>
SPRITE_GFX[7] = 0x0001;
<br/>
SPRITE_GFX[8] = 0x0100;
<br/>
SPRITE_GFX[9] = 0x0000;
<br/>
SPRITE_GFX[10] = 0x0000;
<br/>
SPRITE_GFX[11] = 0x0001;
<br/>
SPRITE_GFX[12] = 0x0000;
<br/>
SPRITE_GFX[13] = 0x0101;
<br/>
SPRITE_GFX[14] = 0x0101;
<br/>
SPRITE_GFX[15] = 0x0000;
<br/>
SPRITE_GFX[16] = 0x0000;
<br/>
SPRITE_GFX[17] = 0x0100;
<br/>
SPRITE_GFX[18] = 0x0001;
<br/>
SPRITE_GFX[19] = 0x0000;
<br/>
SPRITE_GFX[20] = 0x0000;
<br/>
SPRITE_GFX[21] = 0x0101;
<br/>
SPRITE_GFX[22] = 0x0101;
<br/>
SPRITE_GFX[23] = 0x0000;
<br/>
SPRITE_GFX[24] = 0x0000;
<br/>
SPRITE_GFX[25] = 0x0100;
<br/>
SPRITE_GFX[26] = 0x0001;
<br/>
SPRITE_GFX[27] = 0x0000;
<br/>
SPRITE_GFX[28] = 0x0000;
<br/>
SPRITE_GFX[29] = 0x0001;
<br/>
SPRITE_GFX[30] = 0x0100;
<br/>
SPRITE_GFX[31] = 0x0000;
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Here you copy in the ship, but then you overwrite it with the spaceman.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">OAM[0] = ATTR0_COLOR_256 | ATTR0_SQUARE | spritey; //ATTR0, atribute which controls sprites colour, shape and x coord
<br/>
OAM[1] = ATTR1_SIZE_16 | spritex; //ATTR1 is size and y coord
<br/>
OAM[2] = 0; //ATTR2 is sprite img no.
<br/>
OAM[4] = ATTR0_COLOR_256 | ATTR0_SQUARE | y; //ATTR0, atribute which controls sprites colour, shape and y coord
<br/>
OAM[5] = ATTR1_SIZE_16 | x; //ATTR1 is size and x coord
<br/>
OAM[6] = 0; //ATTR2 is sprite img no.
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Here you use the same "sprite img no." for both sprites, which turns out to be a ship partially overwritten with a spaceman.</span></td> </tr></table><span class="postbody">
<br/>
OK, so I changed it so that the image no. is 1 instead of 0. But how do I make it so the spaceman is not owerwriting the ship? That is the question that has REALLY been killing me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72714 - tepples - Tue Feb 21, 2006 5:00 am</h4>
    <div class="postbody"><span class="postbody">The ship is 4 256-color tiles, right? Each tile is 32 u16s, so try writing the spaceman starting at SPRITE_GFX[128].
<br/>
<br/>
And why are you using 256-color tiles for such simple graphics?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72760 - Linkiboy - Tue Feb 21, 2006 2:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">The ship is 4 256-color tiles, right? Each tile is 32 u16s, so try writing the spaceman starting at SPRITE_GFX[128].
<br/>
<br/>
And why are you using 256-color tiles for such simple graphics?</td> </tr></table><span class="postbody">ATM it's only temporary, they will be much more complex for the actual game. Thanks, tepples.
<br/>
<br/>
edit: and one more question...
<br/>
<br/>
What if I wanted to have 2 sprite files that are like this:
<br/>
for(i = 0; i &lt; 128; i++)
<br/>
SPRITE_PALETTE[i] = ((u16*)testPalette)[i];
<br/>
for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)testData)[i];
<br/>
for(i = 0; i &lt; 64; i++)
<br/>
<br/>
would the second sprite be something like:
<br/>
<br/>
for(i = 128; i &lt; 128; i++)
<br/>
SPRITE_PALETTE[i] = ((u16*)test2Palette)[i];
<br/>
for(i = 128; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)test2Data)[i];
<br/>
for(i = 128; i &lt; 64; i++)
<br/>
<br/>
I'm sorry if the answer is obvious/i'm posting a really stupid attempt.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72780 - Maverick - Tue Feb 21, 2006 6:38 pm</h4>
    <div class="postbody"><span class="postbody">for(i = 0; i &lt; 128; i++) 
<br/>
SPRITE_PALETTE[i+128] = ((u16*)test2Palette)[i]; 
<br/>
for(i = 0; i &lt; 32*16; i++) 
<br/>
SPRITE_GFX[i+(32*16)] = ((u16*)test2Data)[i]; 
<br/>
for(i = 0; i &lt; 64; i++)<br/>_________________<br/><a href="http://downtou.ne1.net/" target="_blank">http://downtou.ne1.net/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72815 - strager - Tue Feb 21, 2006 11:06 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">and one more question...
<br/>
<br/>
What if I wanted to have 2 sprite files that are like this:
<br/>
[...]
<br/>
<br/>
would the second sprite be something like:
<br/>
[...]
<br/>
<br/>
I'm sorry if the answer is obvious/i'm posting a really stupid attempt.</td> </tr></table><span class="postbody">
<br/>
<br/>
I would say create some temporary variables, and update those:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef u16 color;Â  Â // In case you are going to port the prog. to another system, this may help.
<br/>
typedef u8 index;Â  Â  // Same here
<br/>
// ...
<br/>
color *curpal = SPRITE_PALETTE;
<br/>
index *curidx = SPRITE_GFX;
<br/>
// ...
<br/>
// Load first sprite
<br/>
for(i = 0; i &lt; palette1_size; i++, curpal++) {
<br/>
Â  Â  *curpal = palette1[i];
<br/>
}
<br/>
for(i = 0; i &lt; data1_size; i++, curidx++) {
<br/>
Â  Â  *curidx = data1[i];
<br/>
}
<br/>
<br/>
// Load second sprite
<br/>
for(i = 0; i &lt; palette2_size; i++, curpal++) {
<br/>
Â  Â  *curpal = palette2[i];
<br/>
}
<br/>
for(i = 0; i &lt; data2_size; i++, curidx++) {
<br/>
Â  Â  *curidx = data2[i];
<br/>
}
<br/>
<br/>
// Add more for every dataN
<br/>
<br/>
// Load sprite attribute data
<br/>
// ...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Although this works, it may be easier to make some support functions to do it for you.  This would help clean up some space in your main function, as well as save some ROM space.  Two static variables would be used for the counters, and if it receives an input of NULL, reset the counters (if you want to restart the whole process...).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72819 - Linkiboy - Tue Feb 21, 2006 11:34 pm</h4>
    <div class="postbody"><span class="postbody">I tried that..
<br/>
<br/>
<br/>
for(i = 0; i &lt; 128; i++)
<br/>
SPRITE_PALETTE[i] = ((u16*)shipPalette)[i];
<br/>
for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i] = ((u16*)shipData)[i];
<br/>
for(i = 0; i &lt; 64; i++)
<br/>
removesprites();
<br/>
y = 150;
<br/>
x = 120;
<br/>
for(i = 0; i &lt; 128; i++)
<br/>
SPRITE_PALETTE[i+128] = ((u16*)enemyshipPalette)[i];
<br/>
for(i = 0; i &lt; 32*16; i++)
<br/>
SPRITE_GFX[i+(32*16)] = ((u16*)enemyshipData)[i];
<br/>
for(i = 0; i &lt; 64; i++)
<br/>
removesprites();
<br/>
enemyx=50;
<br/>
enemyy=50;
<br/>
<br/>
...but the enemy ship is jumbled. Anything else that I should know about?
<br/>
<br/>
(Both are 16x16 256 color tiles)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#72830 - Linkiboy - Wed Feb 22, 2006 1:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>strager wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">and one more question...
<br/>
<br/>
What if I wanted to have 2 sprite files that are like this:
<br/>
[...]
<br/>
<br/>
would the second sprite be something like:
<br/>
[...]
<br/>
<br/>
I'm sorry if the answer is obvious/i'm posting a really stupid attempt.</td> </tr></table><span class="postbody">
<br/>
<br/>
I would say create some temporary variables, and update those:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
typedef u16 color;Â  Â // In case you are going to port the prog. to another system, this may help.
<br/>
typedef u8 index;Â  Â  // Same here
<br/>
// ...
<br/>
color *curpal = SPRITE_PALETTE;
<br/>
index *curidx = SPRITE_GFX;
<br/>
// ...
<br/>
// Load first sprite
<br/>
for(i = 0; i &lt; palette1_size; i++, curpal++) {
<br/>
Â  Â  *curpal = palette1[i];
<br/>
}
<br/>
for(i = 0; i &lt; data1_size; i++, curidx++) {
<br/>
Â  Â  *curidx = data1[i];
<br/>
}
<br/>
<br/>
// Load second sprite
<br/>
for(i = 0; i &lt; palette2_size; i++, curpal++) {
<br/>
Â  Â  *curpal = palette2[i];
<br/>
}
<br/>
for(i = 0; i &lt; data2_size; i++, curidx++) {
<br/>
Â  Â  *curidx = data2[i];
<br/>
}
<br/>
<br/>
// Add more for every dataN
<br/>
<br/>
// Load sprite attribute data
<br/>
// ...
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Although this works, it may be easier to make some support functions to do it for you.  This would help clean up some space in your main function, as well as save some ROM space.  Two static variables would be used for the counters, and if it receives an input of NULL, reset the counters (if you want to restart the whole process...).</span></td> </tr></table><span class="postbody">
<br/>
Hhmm... that seems like an interesting method. I shall try it... I'll post when results arrive.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73048 - Linkiboy - Wed Feb 22, 2006 11:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "..\nds.h"
<br/>
#include "..\memory.h"
<br/>
#include "..\screen.h"
<br/>
#include "..\system.h"
<br/>
#include "..\keys.h"
<br/>
#include "..\ipc.h"
<br/>
#include "ship.h"
<br/>
#include "eship.h"
<br/>
<br/>
int x,y,spritex,spritey,tempx,tempy,wait,i,bulletx,bullety,ableto,enemyx,enemyy;
<br/>
<br/>
<br/>
<br/>
void removesprites()
<br/>
{
<br/>
int i;
<br/>
for(i = 0; i &lt; 2048; i++)
<br/>
OAM[i * 4] = ATTR0_DISABLED;
<br/>
}
<br/>
<br/>
int main()
<br/>
{
<br/>
powerON(POWER_ALL);
<br/>
videoSetMode(MODE_0_2D | SPR_1D_LAYOUT | SPR_ACTIVE); //activates 2d and turns on sprites in 1d mode
<br/>
VRAM_BANK_A(VRAM_SPRITE); //sprite vram
<br/>
typedef u16 color;Â  Â // In case you are going to port the prog. to another system, this may help.
<br/>
typedef u8 index;Â  Â  // Same here 
<br/>
color *curpal = SPRITE_PALETTE;
<br/>
index *curidx = SPRITE_GFX; 
<br/>
for(i = 0; i &lt; 256; i++, curpal++) {
<br/>
Â  Â  *curpal = shipPalette[i];
<br/>
}
<br/>
for(i = 0; i &lt; SHIP_SIZE; i++, curidx++) {
<br/>
Â  Â  *curidx = shipData[i];
<br/>
}
<br/>
x = 50;
<br/>
y = 50;
<br/>
<br/>
// Load second sprite
<br/>
for(i = 0; i &lt; 256; i++, curpal++) {
<br/>
Â  Â  *curpal = enemyshipPalette[i];
<br/>
}
<br/>
for(i = 0; i &lt; ENEMYSHIP_SIZE; i++, curidx++) {
<br/>
Â  Â  *curidx = enemyshipData[i]; 
<br/>
}
<br/>
<br/>
enemyy = 100;
<br/>
enemyx = 100;
<br/>
<br/>
while(1)
<br/>
{
<br/>
if(READ_KEYS &amp; KEY_LEFT)
<br/>
{
<br/>
tempx = x;
<br/>
tempx--;
<br/>
if(tempx&gt;0 &amp; (tempx&lt;spritex-16 | tempx&gt;spritex+16 | y&lt;spritey-16 | y&gt;spritey+16)){x = tempx;} 
<br/>
}
<br/>
if(READ_KEYS &amp; KEY_RIGHT)
<br/>
{
<br/>
tempx = x;
<br/>
tempx++;
<br/>
if(tempx&lt;248 &amp; (tempx&lt;spritex-16 | tempx&gt;spritex+16 | y&lt;spritey-16 | y&gt;spritey+16)){x = tempx;}
<br/>
}
<br/>
<br/>
<br/>
<br/>
OAM[0] = ATTR0_COLOR_256 | ATTR0_SQUARE | y; //ATTR0, atribute which controls sprites colour, shape and y coord
<br/>
OAM[1] = ATTR1_SIZE_16 | x; //ATTR1 is size and x coord
<br/>
OAM[2] = 0; //ATTR2 is sprite img no.
<br/>
OAM[4] = ATTR0_COLOR_256 | ATTR0_SQUARE | enemyy; //ATTR0, atribute which controls sprites colour, shape and y coord
<br/>
OAM[5] = ATTR1_SIZE_16 | enemyx; //ATTR1 is size and x coord
<br/>
OAM[6] = 1; //ATTR2 is sprite img no.
<br/>
//oam3 rotates and zooms but is not needed
<br/>
WaitForVBlank();
<br/>
}
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Doesn't work. Did I make a mistake again?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
