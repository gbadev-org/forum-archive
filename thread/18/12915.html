<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Can someone plz explain vram banks??? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Can someone plz explain vram banks???</h2>
<div id="posts">
<div class="post">
    <h4>#124350 - Diirewolf - Thu Apr 05, 2007 8:39 am</h4>
    <div class="postbody"><span class="postbody">Im moving from GBA to DS and I realised this new thing.. vram banks. Now gba doesnt have these and I want to know what they are and how to use them. The tutorials ive read just say vramSetBank?(...) and dont explain what it does, ive seen a table of vram banks but dont understand it as I have no clue what they are in the first place.
<br/>
some help please.
<br/>
thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124353 - qw3rty - Thu Apr 05, 2007 10:00 am</h4>
    <div class="postbody"><span class="postbody">Vram is the video-ram of the NDS.
<br/>
<br/>
The GBA had videoram too ! (where you put the chars. and maps / bitmaps).
<br/>
<br/>
The NDS has more than 4 times the VRam of the GBA though.
<br/>
You have to VramSetMainbanks(), to reserve the different VRAM-banks to screen one or two.
<br/>
<br/>
VramSetMainBankA(VRAM_A_MAIN_BG); (call this, to setup VRAM_A to the main-screen - check for spelling though - I wrote this from head ;))</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124354 - Lick - Thu Apr 05, 2007 10:22 am</h4>
    <div class="postbody"><span class="postbody">VRAM Banks have to be <span style="font-weight: bold">mapped</span> at a memory location before you can store graphics data to that memory location.
<br/>
<br/>
Imagine you have a flat table with a hole. That hole is the memory location where you want to put data, a Euro-coin for example. If you try putting the coin there, it will fall through. This is why you need to map your hand (VRAM) under the table at the hole (memory location), so the coin (data) falls on your hand (thus in the VRAM) instead.
<br/>
Some VRAM banks fit some holes, others fit others, so check out the tables to see which 'hand' (VRAM) can be mapped to which 'hole' (memory location).
<br/>
<br/>
For example, VRAM_A to 0x6000000 (aka 'BG_GFX'):
<br/>
vramSetBankA(VRAM_A_MAIN_BG); 
<br/>
or vramSetBankA(VRAM_A_MAIN_BG_0x06000000);
<br/>
Both are the same.<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124358 - Diirewolf - Thu Apr 05, 2007 11:35 am</h4>
    <div class="postbody"><span class="postbody">what exactly do you mean by mapped? you can explain in technical terms, you dont need to use a coin example :). you see with gba, there is just VRAM and if you want to write to it, you just use VRAM[i] = ...
<br/>
why are there sooo many banks ( A - F or whatever it was).
<br/>
thanks for replies</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124359 - OOPMan - Thu Apr 05, 2007 11:56 am</h4>
    <div class="postbody"><span class="postbody">Try doing a search for "memory mapping". By mapping the VRAM to a memory location you make it accessible in the same fashion that normal memory is accessible, via standard memory reading and writing techniques...<br/>_________________<br/>"My boot, your face..." - Attributed to OOPMan, Emperor of Eroticon VI
<br/>
<br/>
You can find my NDS homebrew projects <a class="postlink" href="http://blog.dev-scene.com/oopman/" target="_blank">here...</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124361 - qw3rty - Thu Apr 05, 2007 12:09 pm</h4>
    <div class="postbody"><span class="postbody">each VRAM bank can be "mapped" to different start-adresses.
<br/>
vramSetBankA(VRAM_A_MAIN_BG); sets bank a to 0x06000000. 
<br/>
That's the normal memory area you are used to on GBA.
<br/>
You can however set bankB to 0x06020000, which is right after the first 128k.
<br/>
This will make charbaseblock 4...7 accesible.
<br/>
On the GBA you had only 4 charbaseblocks.
<br/>
(you still are limited to 32 screenbaseblocks though)
<br/>
<br/>
the "normal" vram of the SUBscreen is at 0x06200000.
<br/>
the subscreen can be used the same way as the top screen.
<br/>
<br/>
However, not each bank can be used for every purpose !
<br/>
And different purpose may mean a different memory adresse !
<br/>
<br/>
Before being able to use VRAM you HAVE to set it up, using vramSetMainBankX(&lt;LIBNDS-DEFINE&gt;);
<br/>
<br/>
Detailed info on the VRAM-managing can be found at DSTek :
<br/>
<br/>
<a href="http://neimod.com/dstek/" target="_blank">http://neimod.com/dstek/</a>
<br/>
<br/>
P.S. : The memory adresses etc. are for tiled backgrounds (text) - I don't know for sure what's about rotating BGs, double layering etc.
<br/>
Again - look it up on dstek (you asked for technical info, this will give you technical info ;))</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124362 - Diirewolf - Thu Apr 05, 2007 12:16 pm</h4>
    <div class="postbody"><span class="postbody">ok so from what I understand, if you map vram a memory to background memory, then it will be used for background memory and if you write to BG_GFX or whatever, it will write to VRAM_A?
<br/>
thx</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#124363 - qw3rty - Thu Apr 05, 2007 12:25 pm</h4>
    <div class="postbody"><span class="postbody">look into memory.h and video.h - there are all the defines you need !
<br/>
<br/>
memory.h : 
<br/>
#define BG_GFX			((uint16*)0x6000000)
<br/>
#define BG_GFX_SUB		((uint16*)0x6200000)
<br/>
<br/>
BG_GFX[i] will point to RAM-adresse (0x6000000 + i)- a write or read won't work if you didn't map a vrambank to that memory area before !
<br/>
<br/>
video.h :
<br/>
<br/>
typedef enum {
<br/>
	VRAM_A_LCD	=	0,
<br/>
	VRAM_A_MAIN_BG  = 1,
<br/>
	VRAM_A_MAIN_BG_0x06000000	= 1 | VRAM_OFFSET(0),
<br/>
	VRAM_A_MAIN_BG_0x06020000	= 1 | VRAM_OFFSET(1),
<br/>
	VRAM_A_MAIN_BG_0x06040000	= 1 | VRAM_OFFSET(2),
<br/>
	VRAM_A_MAIN_BG_0x06060000	= 1 | VRAM_OFFSET(3),
<br/>
	VRAM_A_MAIN_SPRITE = 2,
<br/>
	VRAM_A_MAIN_SPRITE_0x06400000	= 2,
<br/>
	VRAM_A_MAIN_SPRITE_0x06420000	= 2 | VRAM_OFFSET(1),
<br/>
	VRAM_A_TEXTURE = 3,
<br/>
	VRAM_A_TEXTURE_SLOT0	= 3 | VRAM_OFFSET(0),
<br/>
	VRAM_A_TEXTURE_SLOT1	= 3 | VRAM_OFFSET(1),
<br/>
	VRAM_A_TEXTURE_SLOT2	= 3 | VRAM_OFFSET(2),
<br/>
	VRAM_A_TEXTURE_SLOT3	= 3 | VRAM_OFFSET(3)
<br/>
} VRAM_A_TYPE;
<br/>
<br/>
these are the different usages of VRAM-bank A.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
