<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GL_TEXTURE - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > GL_TEXTURE</h2>
<div id="posts">
<div class="post">
    <h4>#119169 - Risine - Tue Feb 20, 2007 12:38 pm</h4>
    <div class="postbody"><span class="postbody">I have just updated devkitpro from ??? version to 1.4.2 version, and it seems texturing does not work anymore.
<br/>
I used this code to have good texture matrix :
<br/>
glMatrixMode(GL_TEXTURE);
<br/>
glLoadIdentity();
<br/>
glScalef(Img_width/128.,Img_height/128.,1.);
<br/>
<br/>
But now that does not work anymore depending on texture sizes. ( still works for 128x128 textures, but no more for 256x128,128x64,...)
<br/>
<br/>
Has anyone been confronted to the same problem?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119173 - Risine - Tue Feb 20, 2007 1:05 pm</h4>
    <div class="postbody"><span class="postbody">I think I found the good way to scale the texture matrix :
<br/>
instead of :
<br/>
glScalef(Img_width/128.,Img_height/128.,1.); 
<br/>
I have now :
<br/>
glScalef(Img_width/Img_height,Img_height/Img_width,1.); 
<br/>
<br/>
If someone can confirm/explain that, many thanks, as I don't really understand why width texturing depends on height and height on width.
<br/>
Really strange.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119691 - gabebear - Sun Feb 25, 2007 9:18 am</h4>
    <div class="postbody"><span class="postbody">Are you enabling textures with glEnable(GL_TEXTURE_2D) ? I know some older versions of libnds did this for you.
<br/>
<br/>
The texture coordinates(U and V) are swapped in all released versions of libnds. Texture coords are correct in the CVS version, but if you get the CVS libnds you will also want to grab the CVS examples since several other things have changed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119707 - Risine - Sun Feb 25, 2007 2:30 pm</h4>
    <div class="postbody"><span class="postbody">I'm not using glEnable, but I use glBindTexture(GL_TEXTURE_2D,Textures_gl[face-&gt;Texture]);
<br/>
Maybe that if I replace GL_TEXTURE_2D by 0, I'll be able to use back glScalef(Img_width/128.,Img_height/128.,1.); ?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119748 - gabebear - Sun Feb 25, 2007 8:50 pm</h4>
    <div class="postbody"><span class="postbody">The first argument of glBindTexture is ignored, the DS only supports 2D textures. You must enable textures with glEnable(GL_TEXTURE_2D); before using them. I'm a bit confused on what you are trying to do by scaling the texture matrix.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119805 - Risine - Mon Feb 26, 2007 2:58 pm</h4>
    <div class="postbody"><span class="postbody">If you want to use textures of different sizes ( 32x32,64x128,256x256...), you must adapt the texture matrix in order for the uv values [0,1] to fit to the real texture size</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119826 - Lick - Mon Feb 26, 2007 6:45 pm</h4>
    <div class="postbody"><span class="postbody">The texture matrix is used to transform the UV values. It does not have anything to do with the pixel sizes of the textures, it rather zooms in and out or scrolls, as you scale and translate the matrix.
<br/>
<br/>
For example, by translating the texture matrix of a polygon with a water texture, you can simulate flowing water. (The water texture would be repetitious though.)<br/>_________________<br/><a class="postlink" href="http://licklick.wordpress.com" target="_blank">http://licklick.wordpress.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119833 - tepples - Mon Feb 26, 2007 7:56 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Lick wrote:</b></span></td> </tr> <tr> <td class="quote">For example, by translating the texture matrix of a polygon with a water texture, you can simulate flowing water. (The water texture would be repetitious though.)</td> </tr></table><span class="postbody">
<br/>
You can hide this to an extent by overlaying two water textures, one semi-transparent. <span style="font-style: italic">Animal Crossing</span> for GCN does this.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#119933 - Risine - Tue Feb 27, 2007 5:24 pm</h4>
    <div class="postbody"><span class="postbody">Yes, it has something to do, as your texels don"t take into account the size of the texture and evolve in [0,1].
<br/>
If you don't change the texture matrix depending on its size then you won't have a good result ( when changing a 128x128 texture by a 256x128 for instance for the same texels )
<br/>
or there is a bug somewhere!!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120025 - silent_code - Wed Feb 28, 2007 12:57 pm</h4>
    <div class="postbody"><span class="postbody">no, just scale your uv coordinates to the textures dimensions (don't forget to swap u and v) when loading a mesh (or generating it otherwise) and there you go. i believe it's cheaper than adjusting the matrix every frame.
<br/>
and if you want to implement texture lods, just scale your uvs to the size of the smallest lod and then shift left when rendering with a higher resolution texture. works pretty good for me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120177 - Risine - Thu Mar 01, 2007 4:31 pm</h4>
    <div class="postbody"><span class="postbody">I just saw in videoGL.c that it's what is done in glTexCoord2f ( I use that function to push my texels ), not very efficient indeed.
<br/>
But I still don't understand why I have to change the Texture Matrix :( Quite strange !!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120545 - Risine - Sun Mar 04, 2007 4:58 pm</h4>
    <div class="postbody"><span class="postbody">Found the reason !!! For those who can get in the same troubles :
<br/>
My texels do not depend on texture size and go from [0,0] for left/top texture corner to [1,1] right/bottom texture corner.
<br/>
When rendering, the texels u/v have to be inverted - don't know why, maybe a bug of libnds? -, but the texture width/height are not inverted.
<br/>
So I had to change the texture matrix and scale it with (Width/Height,Height/Width,...) in order to retrieve the good units.
<br/>
( A better way to do it is to change glTexCoord2f function and invert x/y in the call of glTexCoord2t16. )</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#120566 - gabebear - Sun Mar 04, 2007 6:52 pm</h4>
    <div class="postbody"><span class="postbody">The CVS version of libnds has the texture coords correct, so whenever the next release of libnds comes out the inverted texture coords will be fixed.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
