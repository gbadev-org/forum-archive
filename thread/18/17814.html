<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Creating a new station ingame - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>DS development > Creating a new station ingame</h2>
<div id="posts">
<div class="post">
    <h4>#177168 - Anubiss - Mon Jan 09, 2012 11:40 pm</h4>
    <div class="postbody"><span class="postbody">Hey friends.
<br/>
After moving into a new house i find time again for continuing what i begun.
<br/>
The problems with my <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=177129#177129" target="_blank">limits</a> are away.
<br/>
<br/>
Now my ship is flying through the orbit. When it is close to a space-station i want an "options" window to appear. in this option window i wanna have the possibility to create or buy a new station. But after hours of thinking i don?t come to an end with how to do this in C. 
<br/>
I would be thankfull of any idea.
<br/>
<br/>
Here?s my code till now:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
// Includes
<br/>
#include &lt;PA9.h&gt;
<br/>
#include "gfx/all_gfx.c"
<br/>
#include "gfx/all_gfx.h"
<br/>
<br/>
int main(int argc, char ** argv)
<br/>
{
<br/>
   PA_Init();    
<br/>
   PA_InitVBL(); 
<br/>
   PA_EasyBgLoad(0, 1, aa); 
<br/>
   PA_InitText(1,0);
<br/>
   PA_LoadSpritePal(0, 0, (void*)vaisseau_Pal);
<br/>
   PA_LoadSpritePal(0, 1, (void*)station01_Pal);
<br/>
   PA_CreateSprite(0, 0,(void*)vaisseau_Sprite, OBJ_SIZE_32X32,1, 0, 128-16, 96-16); // Das SChiff auf Mitte des unteren Screens setzen
<br/>
<br/>
   PA_SetSpriteRotEnable(0,0,0);
<br/>
   u16 angle = 0; 
<br/>
   int x = (128) &lt;&lt; 8; 
<br/>
   int y = (96) &lt;&lt; 8; 
<br/>
   int sx;
<br/>
   int sy;
<br/>
<br/>
typedef struct{
<br/>
   int x;
<br/>
   int xmax;
<br/>
   int schalter;
<br/>
}pflanze;
<br/>
<br/>
pflanze buche;
<br/>
<br/>
buche.xmax=1000;
<br/>
buche.schalter=0;
<br/>
<br/>
int scrollx = 0; 
<br/>
int scrolly = 0;
<br/>
<br/>
<br/>
//Raumstation:
<br/>
/////////////////////////////////////////////////
<br/>
typedef struct{
<br/>
   int x;
<br/>
   int y;
<br/>
   int flag;
<br/>
   int entfx;
<br/>
   int entfy;
<br/>
}station;
<br/>
station rs;
<br/>
//station fremd[10];//0-9
<br/>
rs.x=200;
<br/>
rs.y=96;
<br/>
rs.flag=0;
<br/>
rs.entfx;
<br/>
rs.entfy;
<br/>
void station01test(void){
<br/>
   rs.entfx=(sx&gt;&gt;8)-(rs.x);//Entfernung zwischen Station und Raumschiff messen
<br/>
      if (rs.entfx&lt;0){rs.entfx=-rs.entfx;}//Betrag, falls Entfernung negativ!
<br/>
   rs.entfy=(sy&gt;&gt;8)-(rs.y);
<br/>
      if (rs.entfy&lt;0){rs.entfy=-rs.entfy;}
<br/>
   
<br/>
   
<br/>
   if (rs.flag==0){
<br/>
      PA_CreateSprite(0, 2,(void*)station01_Sprite, OBJ_SIZE_64X64,1, 1, rs.x-16, rs.y-16);
<br/>
      rs.flag=1;
<br/>
   }
<br/>
   
<br/>
   if ((rs.entfx&gt;100)&amp;&amp;rs.flag==1){
<br/>
      PA_DeleteSprite (0, 2);
<br/>
      rs.flag=0;
<br/>
   }
<br/>
   
<br/>
   if ((rs.entfy&gt;100)&amp;&amp;rs.flag==1){
<br/>
      PA_DeleteSprite (0, 2);
<br/>
      rs.flag=0;
<br/>
   }
<br/>
   
<br/>
   if ((rs.entfx&lt;30)&amp;&amp;(rs.entfy&lt;30)){
<br/>
      PA_OutputText(1,0,2,"'START' zum Landen-");
<br/>
   }
<br/>
   if ((rs.entfx&gt;30)||(rs.entfy&gt;30)){
<br/>
      PA_OutputText(1,0,2,"                      ");
<br/>
   }
<br/>
<br/>
<br/>
}
<br/>
<br/>
//Einfacher test:
<br/>
/////////////////////////////////////////////////
<br/>
void wachse(void){
<br/>
   if (buche.schalter==1)
<br/>
      if(buche.x&lt;buche.xmax)
<br/>
      buche.x++;
<br/>
      if(buche.x==buche.xmax)
<br/>
      buche.x=buche.xmax;
<br/>
   
<br/>
}
<br/>
<br/>
<br/>
<br/>
<br/>
//STATUSBILDSCHIRM
<br/>
//////////////////////////////////////////////////////////////////
<br/>
void statusscreen(void){
<br/>
<br/>
      //Ausgabe von Informationen auf oberen Screen: 
<br/>
      ////////////////////////////////////////////////////////////////////////////////
<br/>
<br/>
      PA_OutputText(1,0,12,"Map-x: %02d", scrollx&gt;&gt;8);
<br/>
      PA_OutputText(1,0,13,"Map-y: %02d", scrolly&gt;&gt;8);
<br/>
      PA_OutputText(1,0,14,"-------------------");
<br/>
      PA_OutputText(1,0,15,"Schiff-x: %02d", sx&gt;&gt;8);
<br/>
      PA_OutputText(1,0,16,"Schiff-y: %02d", sy&gt;&gt;8);
<br/>
      PA_OutputText(1,0,17,"-------------------");
<br/>
      PA_OutputText(1,0,18,"x von Station entfernt: %02d", rs.entfx);
<br/>
      PA_OutputText(1,0,19,"y von Station entfernt: %02d", rs.entfy);
<br/>
      PA_OutputText(1,0,20,"Winkel des Schiffes: %02d", angle);
<br/>
<br/>
}
<br/>
<br/>
<br/>
//MAIN:
<br/>
////////////////////////////////////////////////////////////////////////////////
<br/>
///////////////////////////////////////////////////////////////////////////////
<br/>
   while (1)
<br/>
   {
<br/>
      //Test-Buche: z?hlt von 0 bis 1000, wenn "A" gedr?ckt wird
<br/>
      if (Pad.Newpress.A) buche.schalter=1;
<br/>
      wachse();
<br/>
      PA_OutputText(1,0,0,"%02d", buche.x);
<br/>
      
<br/>
      
<br/>
      //Winkelberechnung-Flugschiff:
<br/>
      ///////////////////////////////////////////////////////////////////////////////   
<br/>
      angle = PA_GetAngle(x&gt;&gt;8, y&gt;&gt;8, Stylus.X, Stylus.Y);                       //
<br/>
      PA_SetRotsetNoZoom(0, 0, angle); // ?nderung des Schiffswinkels             //
<br/>
      //Flugschiff-Koordinaten AUSSERHALB DER ENGINE:
<br/>
      sx=(scrollx+x);
<br/>
      sy=(scrolly+y);
<br/>
      
<br/>
      //Hintergrund-Scrolling: 
<br/>
      //////////////////////////////////////////////////////////////////////////////
<br/>
      if(Pad.Held.B){                                                //
<br/>
         scrollx += PA_Cos(angle);                                    //      
<br/>
         scrolly += PA_Sin(angle);
<br/>
      };
<br/>
      //Map-Grenzen:                                                //
<br/>
      if((scrollx&gt;&gt;8)&gt;(2560-255)){
<br/>
         scrollx=590080;
<br/>
      };
<br/>
      if((scrollx&gt;&gt;8)&lt;0){
<br/>
         scrollx=0;
<br/>
      };
<br/>
      if((-scrolly&gt;&gt;8)&gt;(1600-191)){
<br/>
         scrolly=-360704;   
<br/>
      };
<br/>
      if((-scrolly&gt;&gt;8)&lt;0){
<br/>
         scrolly=0;
<br/>
      };
<br/>
      //Set-Map:
<br/>
      PA_LargeScrollXY(0, 1, scrollx&gt;&gt;8, -scrolly&gt;&gt;8);
<br/>
      
<br/>
      statusscreen();
<br/>
   
<br/>
      PA_SetSpriteXY(0, 0, (x&gt;&gt;8)-16, (y&gt;&gt;8)-16);
<br/>
      PA_SetSpriteXY(0, 2, ((rs.x-16)+(-scrollx&gt;&gt;8))-16, ((rs.y-16)+(scrolly&gt;&gt;8))-16);
<br/>
      station01test();
<br/>
      PA_WaitForVBL();
<br/>
   }
<br/>
   
<br/>
   return 0;
<br/>
   
<br/>
<br/>
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>Fange nie an aufzuhoeren
<br/>
Hoere nie auf anzufangen</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
