<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Just wondering if I am using swi correctly... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Just wondering if I am using swi correctly...</h2>
<div id="posts">
<div class="post">
    <h4>#150770 - yaazz - Tue Feb 12, 2008 1:55 pm</h4>
    <div class="postbody"><span class="postbody">I just finished reading the tutorial on GBA bios functions and I am just wondering If I am using it correctly as Visual Boy Advance still seems to hover at around 8-10% cpu usage.
<br/>
<br/>
What i did is I just put the call swi_call(0x05) inside the while loop in main(). Other then that the code is the same as the topic I started earlier today
<br/>
<br/>
Is this the right way to make the cpu sleep?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150771 - eKid - Tue Feb 12, 2008 2:28 pm</h4>
    <div class="postbody"><span class="postbody">I'm not sure how your swi_call works, but remember that SWI 5 (wait for vblank interrupt) relies on a vblank interrupt and a proper interrupt handler.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150773 - yaazz - Tue Feb 12, 2008 2:46 pm</h4>
    <div class="postbody"><span class="postbody">Yep vblank interrupts are all set up prior to calling swi_call(0x05), but what im asking is do I just put this call in a while loop inside the main function and then battery life will be preserved? 
<br/>
<br/>
Also, how does HALT work? does it just wait for any interrupt? 
<br/>
<br/>
Should I be moving all of my code into interrupts (keys, drawing, game logic) in order to save battery life?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150774 - eKid - Tue Feb 12, 2008 6:01 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Also, how does HALT work? does it just wait for any interrupt?</td> </tr></table><span class="postbody">
<br/>
yeah
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Should I be moving all of my code into interrupts (keys, drawing, game logic) in order to save battery life?</td> </tr></table><span class="postbody">
<br/>
That sounds like it would complicate things... I usually setup my main loop like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
while( true )
<br/>
{
<br/>
    // ...update game logic...
<br/>
<br/>
    // wait for new frame
<br/>
    VBlankIntrWait();
<br/>
    
<br/>
    // ...update graphics...
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The VBlankIntrWait is all that is necessary to save the battery life, because it's the only thing that you have to wait for. ...Unless your program sits idle until some keypresses or something...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150785 - Cearn - Tue Feb 12, 2008 8:56 pm</h4>
    <div class="postbody"><span class="postbody">As far as I know, the percentage in the VBA title bar doesn't actually represent GBA-CPU usage, but the speed relative to 'normal'. If you hit SPACE, for example, you can ramp up the speed and the number goes with it. If you want an actual CPU usage figure, use the debug version of no$gba.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
