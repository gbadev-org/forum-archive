<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>longjump() - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > longjump()</h2>
<div id="posts">
<div class="post">
    <h4>#169681 - sgeos - Wed Jul 29, 2009 5:52 pm</h4>
    <div class="postbody"><span class="postbody">When is it a good idea to use longjump()?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169682 - Dwedit - Wed Jul 29, 2009 6:12 pm</h4>
    <div class="postbody"><span class="postbody">So you can always have a restart or quit function, regardless of what functions have been called.
<br/>
It's also the "C" way to do exception handling.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169731 - sajiimori - Fri Jul 31, 2009 9:01 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, pretty much for exception handling.  For instance, the Lua VM uses it to handle errors.  Otherwise it would have to return error codes through many layers of code, which is especially painful when some of those intermediate layers are already using their return values for various purposes.
<br/>
<br/>
Exception handling doesn't come up in console/handheld game programming very much because rare problems aren't supposed to occur at all; they're bugs that are supposed to be fixed before shipping.  Most other kinds of applications don't have that luxury; there's too many unknowns at runtime.
<br/>
<br/>
Just don't let longjmp() pass through C++ code that might have objects on the stack with destructors, because all those destructors will be skipped.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169733 - sgeos - Fri Jul 31, 2009 9:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">Just don't let longjmp() pass through C++ code that might have objects on the stack with destructors, because all those destructors will be skipped.</td> </tr></table><span class="postbody">
<br/>
I've read that misuse of longjump() can result in memory leaks.  I've never actually had to use longjump(), but it seems like a super goto to me.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169746 - Kyoufu Kawa - Sat Aug 01, 2009 3:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">I've read that misuse of longjump() can result in memory leaks.  I've never actually had to use longjump(), but it seems like a super goto to me.</td> </tr></table><span class="postbody">Super Goto is right. And besides, there's a whole lot of things in C/C++ that can result in memory leaks. Just use it -right-.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169748 - Dwedit - Sat Aug 01, 2009 4:51 pm</h4>
    <div class="postbody"><span class="postbody">It's not so much a goto, it's really a "Goto And Move Stack Pointer".<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169751 - LOst? - Sat Aug 01, 2009 10:41 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">When is it a good idea to use longjump()?</td> </tr></table><span class="postbody">
<br/>
longjump() is what? Is it a GBA thing or a C/C++ thing? If it is a C thing, then I would like to know all about it ;)<br/>_________________<br/><span style="font-style: italic">Exceptions are fun</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169752 - vuurrobin - Sun Aug 02, 2009 12:12 am</h4>
    <div class="postbody"><span class="postbody">it's a c/c++ thing.
<br/>
<br/>
<a href="http://www.cppreference.com/wiki/c/other/longjmp" target="_blank">http://www.cppreference.com/wiki/c/other/longjmp</a>
<br/>
<br/>
<br/>
is this actually being used in a present day application or something that was only used in the days of old. I can't think of any reason to use this, especially with c++ and exeptions.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169817 - sajiimori - Wed Aug 05, 2009 2:10 am</h4>
    <div class="postbody"><span class="postbody">Well for one thing, it's way lighter-weight than C++ exceptions.  It consumes pretty much no memory, whereas exception support makes a much larger executable.
<br/>
<br/>
But you get what you pay for, and longjmp is very basic.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169821 - hacker013 - Wed Aug 05, 2009 9:44 am</h4>
    <div class="postbody"><span class="postbody">So this just moves you to another place in the code like goto ? Or what are the different between the 2?<br/>_________________<br/><a class="postlink" href="http://imetal.nl/" target="_blank">Website / Blog</a>
<br/>
<br/>
Let the nds be with you.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169825 - Dwedit - Wed Aug 05, 2009 1:22 pm</h4>
    <div class="postbody"><span class="postbody">Goto is local to within a function.  Longjmp moves the stack pointer, so you can call a bunch of functions, then Longjmp out of them all back to where you started.  Just like exception handling, but without calling any destructors.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169829 - sgeos - Wed Aug 05, 2009 3:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">Goto is local to within a function.</td> </tr></table><span class="postbody">
<br/>
And it can move forward.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">Longjmp moves the stack pointer, so you can call a bunch of functions, then Longjmp out of them all back to where you started.</td> </tr></table><span class="postbody">
<br/>
Think of something that will rewind out of called functions and return control to a preset point.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">Just like exception handling, but without calling any destructors.</td> </tr></table><span class="postbody">
<br/>
Misuse of longjump() can have bad side effects.  Control is reset to a previous location, but as I understand it not much else is reset.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#169861 - gmiller - Fri Aug 07, 2009 5:29 pm</h4>
    <div class="postbody"><span class="postbody">As others have said setjump / longjump just reset the stack pointer so it can reset local variables but has no impact on globals or the heap.  So any allocation on the heap that the pointers were in in local variables are lost and any globals are not reset.  You can long jump out of one function back into another if you want.  This can be useful or royally screw you depending on how you use it.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
