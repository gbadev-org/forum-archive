<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>(Software) Linker question. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > (Software) Linker question.</h2>
<div id="posts">
<div class="post">
    <h4>#38151 - cyclone - Wed Mar 23, 2005 1:59 am</h4>
    <div class="postbody"><span class="postbody">Hello, 
<br/>
<br/>
Once a program that consists of for example 3 object code files, has been assembled, does it need to linked by a linker for a specific file format?
<br/>
<br/>
Or does the linker just need to do relocation and linking, since the gba game will always run from the same address?
<br/>
<br/>
I just want to know if I understand things correctly.
<br/>
<br/>
basically what the way I understand it is, the assembler will just need to generate the instructions, leave the blanks/symbols for the linker with no regard to anything other than address modification (due to one module using another module and thereby not knowing the exact address of a variable). And then the linker that relocates the addresses and links the object files into one gba file to be run.
<br/>
<br/>
Is that right?
<br/>
Please correct me where needed.
<br/>
<br/>
Thank You.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38164 - Vince - Wed Mar 23, 2005 10:15 am</h4>
    <div class="postbody"><span class="postbody">Hello,
<br/>
<br/>
You are mostly right here. The linker has to understand the object file format generated by the assembler. This is because the linker will read contents from the various object files, resolve symbols as needed, perform relocations, add library code and create a new object file containing everything necessary to run on the platform.
<br/>
<br/>
There is another difference between a GBA binary and a Linux binary for instance : on the former, there is no operating system loader. This means that the final binary will run at fixed address whereas with an OS, the loading address is generally not known : the linker relocates as if all programs will run at, for instance address 0 and the loader relocates as needed when loading the program. This means there will be some relocation information left in the final object file whereas the GBA binary is stripped from all of these.
<br/>
<br/>
I hope it was clear (this is a big subject however). Feel free to ask any more questions if needed.
<br/>
<br/>
Vince<br/>_________________<br/>Reclaim control of your F2A/F2AU with <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=32532" target="_blank">if2a</a> !!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38176 - cyclone - Wed Mar 23, 2005 4:20 pm</h4>
    <div class="postbody"><span class="postbody">Thanks Vince, that's mostly what I was thinking. 
<br/>
<br/>
That makes writing all sorts of low level tools easier since there is no need to adhier to any file format.
<br/>
<br/>
It's like the com format of dos, except even then the os does some loading there but not much.
<br/>
<br/>
Anyway, thanks again for the reply.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38232 - sasq - Thu Mar 24, 2005 11:36 am</h4>
    <div class="postbody"><span class="postbody">I am pretty sure that Linux ELF-files are not relocated but mapped to a static adress and then the MMU takes care of the relocation in hardware instead. That's why there is an option for the gnu-linker that will add relocation data to the ELF, but this option is not commonly used.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#38241 - Vince - Thu Mar 24, 2005 2:57 pm</h4>
    <div class="postbody"><span class="postbody">There is still some relocation information in a final Linux object file that uses dynamic libraries (as shown by the rel.dyn and rel.plt in, for instance, /bin/ls that was dynamically linked). However, these relocations are not meant to be applied to a section of the object file (data, rodata or text).
<br/>
<br/>
As for the MMU, I won't call that relocation. With an MMU, nothing is done on code in the object file, the _translation_ is done in HW on the virtual addresses.
<br/>
<br/>
Finally, you are right concerning ELF _programs_ on Linux (which are never relocated). However, keep in mind that shared libraries (which are also ELF files) are relocated nevertheless in Linux.
<br/>
<br/>
Vince<br/>_________________<br/>Reclaim control of your F2A/F2AU with <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?p=32532" target="_blank">if2a</a> !!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
