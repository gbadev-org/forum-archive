<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>isometric - once more - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > isometric - once more</h2>
<div id="posts">
<div class="post">
    <h4>#44263 - sylphaleya - Tue May 31, 2005 2:42 pm</h4>
    <div class="postbody"><span class="postbody">I try to do my own flexible isometric engine. That means:
<br/>
<br/>
- Tiles can be exchanged on the fly
<br/>
- There are multiple levels
<br/>
<br/>
As conclusion I can't prepare a background layer and an foreground layer at design time.
<br/>
<br/>
I've implemented the following:
<br/>
<br/>
- Switch to mode 0.
<br/>
- Stitch together two tile maps (waste VRAM but I don't care) for floor
<br/>
- Doors and walls and players are drawn as sprites in correct oder two allow overlapping
<br/>
- Effects are drawn with a third tile map
<br/>
<br/>
Advantage: fast
<br/>
Drawbacks: Allows only limited walls, players, ... on one screen hence hard or impossible to manage
<br/>
<br/>
Based on the drawbacks a was thinking of a second approach but I'm not sure if it's practicable:
<br/>
<br/>
- Switch to mode 4
<br/>
- Stitch together floor, walls, upper floors, ...
<br/>
- Use sprites for players
<br/>
<br/>
I've coded (-O2 with gcc, arm-code in iwram) a simple loop only copies crap into the VRAM multiple times to emulate the overdraw and transparency testint. Without doing any math inside the loop, the time needed was awfull.
<br/>
<br/>
So here are my questions:
<br/>
<br/>
- Should I stop develop such crap on this kind of hardware?
<br/>
- You know a far better algorithm anyway?
<br/>
- Should I switch to assembly (looks like there is far better speed, altough I always thought I can't win against a modern compiler)?
<br/>
<br/>
Thanks in advance for any reply</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44265 - strager - Tue May 31, 2005 3:14 pm</h4>
    <div class="postbody"><span class="postbody">How do you want the tiles set up?  Are they like rotated squares:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   ..   
<br/>
  .  .  
<br/>
 .    . 
<br/>
.      .
<br/>
 .    . 
<br/>
  .  .  
<br/>
   ..   
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Or do you want them more flattened:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   ..   
<br/>
 ..  .. 
<br/>
..    ..
<br/>
 ..  .. 
<br/>
   ..   
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The rotated-square method is easier, but only in modes with rotating and scaling.
<br/>
<br/>
The flattened look: I believe you can do a HBlank-copy on the X register:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Origional:
<br/>
........
<br/>
.      .
<br/>
.      .
<br/>
........
<br/>
<br/>
HBlank-ed:
<br/>
   ........
<br/>
  .      .
<br/>
 .      .
<br/>
........
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Then you can do a rotate (try different values to get a constant?).  Never tried it; it may never work...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44400 - Deanonious - Wed Jun 01, 2005 10:58 am</h4>
    <div class="postbody"><span class="postbody">I have often been interested in doing an Isometric Game, games like Ultima 7, Ultima Online, and the Baldur's Gate series (granted BG used a completely different type of Iso engine) are some of the best RPG's ever created.  I do not think I have the skills to make one well on the GBA though, it would be awesome if someone could release a general purpose, full featured, Isometric Graphics engine for the GBA.  I know I am being lazy and asking for a dream (considering I can't even find any really good Iso engines available for the PC) but it would rock if someone did, even if only for others newbs like me to learn from it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44474 - tepples - Thu Jun 02, 2005 3:17 am</h4>
    <div class="postbody"><span class="postbody">Starcraft for PC used a standard overhead engine with isometric-<span style="font-style: italic">looking</span> tiles. A lot of NES games did the same. Try that until you figure out how to make a real iso engine.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44486 - SevenString - Thu Jun 02, 2005 5:12 am</h4>
    <div class="postbody"><span class="postbody">ZERG RUSH!!!
<br/>
<br/>
Yeah, I'm taking the same approach.  Layered pre-generated tiles to simulate iso.  As long as it looks and feels iso, then I'll be happy.
<br/>
<br/>
But dynamic tile rotation could be pretty bitchin...  hmmm...<br/>_________________<br/><span style="font-style: italic">"Artificial Intelligence is no match for natural stupidity."</span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44504 - sylphaleya - Thu Jun 02, 2005 11:53 am</h4>
    <div class="postbody"><span class="postbody">Baldur's Gate is more or less easy (from a programmers perspective) todo beacause everything is drawn by an artist. When the player is behind an objekt you have to overlay a mask or the like.
<br/>
<br/>
Ultima 7 isn't iso (iso perspective) but looks similar to UO. UO allows modification of the map in realtime therefore it's the way an iso engine should work.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44821 - Shade - Sun Jun 05, 2005 8:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sylphaleya wrote:</b></span></td> </tr> <tr> <td class="quote">UO allows modification of the map in realtime therefore it's the way an iso engine should work.</td> </tr></table><span class="postbody">
<br/>
<br/>
Does it? As far as I can remember, the map was static and stored in the client-side...
<br/>
<br/>
So how does on make something similar to Final Fantasy Tactics Advance? Meaning, tiles have different tiles in the background (altitude variantions), etc? Pre-render a tileset before the battle begins?
<br/>
<br/>
Cheers</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44825 - strager - Sun Jun 05, 2005 9:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Shade wrote:</b></span></td> </tr> <tr> <td class="quote">So how does on make something similar to Final Fantasy Tactics Advance? Meaning, tiles have different tiles in the background (altitude variantions), etc? Pre-render a tileset before the battle begins?</td> </tr></table><span class="postbody">
<br/>
<br/>
Yup.  I don't know how the game renders the characters behind an object; maybe another, cover-up sprite?  Research to be done..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44834 - Shade - Sun Jun 05, 2005 9:46 pm</h4>
    <div class="postbody"><span class="postbody">Hmm, as far as I can see in VBA + my extracted FFTA ROM, it's a second tile map with a higher -- err, lower -- err, you know what I mean -- priority. So there's a map of tiles of everything "floor", and a second map of "stuff that gets in the way" (including trees and elevated floors). How they *know* they can get away with only two maps is beyond me for now, I'll have to check that math -- as far as I can see, there could be a mount over the hill over the floor -- but then again, they probably make it so in a way that the floor would be totally ocluded in that case.
<br/>
<br/>
One thing I found interesting is that every tile corresponds to the junction of exactly two pieces of isometric tiles. They reuse the same tiles at different spots quite efficiently that way.
<br/>
<br/>
If anyone is curious, I could post some screenshots.
<br/>
<br/>
Cheers</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44903 - ScottLininger - Mon Jun 06, 2005 6:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Shade wrote:</b></span></td> </tr> <tr> <td class="quote">If anyone is curious, I could post some screenshots.</td> </tr></table><span class="postbody">
<br/>
<br/>
That would be really interesting, if you wouldn't mind. There seem to be a lot of different ways to achieve isometric, each with advantages and disadvantages.
<br/>
<br/>
The way that I solved the problem was with metatiles that are mostly transparent. You can see what I mean at my <a class="postlink" href="http://www.thingker.com/IMPBuilder/" target="_blank">Isometic Map Builder site</a>.
<br/>
<br/>
There are certainly disadvantages to this approach, but the big advantage is that you don't have to maintain a large library of "transition" tiles between your various textures. 
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44926 - strager - Mon Jun 06, 2005 9:22 pm</h4>
    <div class="postbody"><span class="postbody">Wow, Nice idea.  Gotta try that in my DS game I'm making.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44977 - Shade - Tue Jun 07, 2005 1:30 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ScottLininger wrote:</b></span></td> </tr> <tr> <td class="quote">The way that I solved the problem was with metatiles that are mostly transparent. You can see what I mean at my <a class="postlink" href="http://www.thingker.com/IMPBuilder/" target="_blank">Isometic Map Builder site</a>.</td> </tr></table><span class="postbody">
<br/>
That *is* nice stuff, congrats. How well does it work with multiple elevations (e.g., the desk I saw in the foreground on those shots, but with multiple levels)?
<br/>
<br/>
Could I maybe get an account to play around with your map app? I'd love to take a look.
<br/>
<br/>
I'll take and post some screenshots of FFTA in a few.
<br/>
<br/>
Cheers</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44988 - Shade - Tue Jun 07, 2005 2:29 am</h4>
    <div class="postbody"><span class="postbody">(Well, it's the first time I post any images here, since they're small I guess this should be okay... If it's any breach of policy I apologize in advance. Couldn't find anything regarding it in the FAQ.)
<br/>
<br/>
The in-game screenshots:
<br/>
<a href="http://img243.echo.cx/img243/9798/fullrender16qr.png">[Images not permitted - Click here to view it]</a>
<br/>
<a href="http://img243.echo.cx/img243/9035/fullrender20pm.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
The two maps, priorities 3 and 2 respectively:
<br/>
<a href="http://img243.echo.cx/img243/5897/mapbg0pri35cr.png">[Images not permitted - Click here to view it]</a>
<br/>
<a href="http://img243.echo.cx/img243/6476/mapbg1pri28ro.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
The tileset:
<br/>
<a href="http://img34.echo.cx/img34/4166/tiles4hj.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
Hope these are useful. AFAICS, they use the "2 textures per tile" combinations you spoke of.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44995 - MrD - Tue Jun 07, 2005 2:52 am</h4>
    <div class="postbody"><span class="postbody">In the Amiga days, some games had all the visible GFX in a 'display map' and all the areas where sprites would be hidden by it in an 'occlusion map'. GBA iso i'd wager would have a visible floor-stuff BG and a covering overtop-stuff BG with a priority closer to 0. I was gonna say this earlier... but Shade beat me to it with his FFTA screenies &gt;_&lt;.<br/>_________________<br/>Not active on this forum. For Lemmings DS help see its website.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#45180 - sgeos - Wed Jun 08, 2005 10:06 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Shade wrote:</b></span></td> </tr> <tr> <td class="quote">as far as I can see, there could be a mount over the hill over the floor -- but then again, they probably make it so in a way that the floor would be totally ocluded in that case.</td> </tr></table><span class="postbody">
<br/>
All you need to put on the screen is the tile on top and what is behind it.  If something is behind that, you don't need to [b]draw[/i] it, but you need to keep track of what it is internally.  There are algorithms to perfectly draw any(*) isometric or old school overhead RPG style structure on two background layers (forground and background).  IIRC it looks something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void write_tile(int p_x, int p_y, tile_t p_tile)
<br/>
{
<br/>
   tile_t bg_tile = get_bg_tile(p_x, p_y);
<br/>
   tile_t fg_tile = get_fg_tile(p_x, p_y);
<br/>
<br/>
   if (BLANK_TILE == bg_tile)
<br/>
      set_bg_tile(p_x, p_y, p_tile);
<br/>
   else if (BLANK_TILE == fg_tile)
<br/>
      set_fg_tile(p_x, p_y, p_tile);
<br/>
   else
<br/>
   {
<br/>
      set_bg_tile(p_x, p_y, fg_tile);
<br/>
      set_fg_tile(p_x, p_y, p_tile);
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
Sprites are either placed over or under the forground layer.  Sprites in are displayed in depth order.  There are cases where sprites can not be properly displayed, but the exact circumstances escape me right not.  I seem to recall stairs that decend as they move deeper into the map pose problems if you want a sprite on every step.
<br/>
<br/>
(*) Can not handle transparent windows.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
