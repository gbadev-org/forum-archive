<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Is it possible to detect whether you're running on hardware? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Is it possible to detect whether you're running on hardware?</h2>
<div id="posts">
<div class="post">
    <h4>#16661 - ScottLininger - Sun Feb 22, 2004 5:17 am</h4>
    <div class="postbody"><span class="postbody">Does anyone know if there is a way to detect at runtime whether the ROM is on hardware vs. an emulator? 
<br/>
<br/>
I would like to switch out some graphics and change the palette (for gamma reasons) when my game runs on hardware.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16664 - tepples - Sun Feb 22, 2004 5:33 am</h4>
    <div class="postbody"><span class="postbody">First of all, try to detect GAME BOY PLAYER. (Display the Magic Cookie Image and see if you get 0x030F in the joypad register after a few frames.) If you have a GAME BOY PLAYER, then you have a CRT or a display with a CRT-like gamma characteristic.
<br/>
<br/>
Some emulators run without a BIOS; use out-of-range MidiKey2Freq() calls to find this. Some emulators reset certain video registers on video mode switches. (VBA does or did reset the BG2 affine matrix when switching between modes 1 and 4; the GBA doesn't.) Some emulators allow a DMA channel's source address to be changed even while the DMA channel is still turned on.
<br/>
<br/>
No, you won't be able to distinguish GBA from GBA SP, even though GBA SP has a higher blacklevel (and thus an apparently flatter gamma) when its light is turned on.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16675 - ScottLininger - Sun Feb 22, 2004 3:59 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">First of all, try to detect GAME BOY PLAYER. (Display the Magic Cookie Image and see if you get 0x030F in the joypad register after a few frames.) If you have a GAME BOY PLAYER, then you have a CRT or a display with a CRT-like gamma characteristic.</td> </tr></table><span class="postbody">
<br/>
<br/>
When you say "display the magic cookie image", do you mean to write it to the video buffer? If so, is there a particular location on the screen?
<br/>
<br/>
I was under the impression that the "nintendo" image was displayed as a sprite and alpha blended with hardware as it flashes... Which if that's true wouldn't I need to display it as a sprite to get the effect you're talking about?
<br/>
<br/>
Is there any technical spec on the header that I could read to get a better understanding of this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16677 - tepples - Sun Feb 22, 2004 4:27 pm</h4>
    <div class="postbody"><span class="postbody">The GBA Magic Cookie Data (156 bytes in the header, representing the Nintendo logo) and the GBP Magic Cookie Image (Game Boy Player logo) are two different things. It seems you can display the Magic Cookie Image in any video mode, as long as the pixels exactly match what the Player hardware is expecting. You can rip the image from a screenshot of Pokemon Pinball or Super Mario Advance 4.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16699 - dagamer34 - Mon Feb 23, 2004 3:17 am</h4>
    <div class="postbody"><span class="postbody">Go download the VisualHAM kit. There is a demo there that does exactly what you want. Sorry, I can't give you the code right now(and save you the trouble).
<br/>
<br/>
The site: <a href="http://www.console-dev.de" target="_blank">www.console-dev.de</a>
<br/>
<br/>
Download version 2.5 with all the HAM demos. It is not a HAM function and has the source for it also. Chances are there are some other demos useful to everyone else there too which don't use HAM directly.
<br/>
<br/>
You're welcome.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16704 - FluBBa - Mon Feb 23, 2004 11:03 am</h4>
    <div class="postbody"><span class="postbody">I think it was possible to do a check on the CPU pipe, in which you use self modifying code.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   ldr r1,opcode
<br/>
   str r1,newop
<br/>
newop
<br/>
   mov r0,#0
<br/>
   bx lr
<br/>
opcode
<br/>
mov r0,#1
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
the emulator will set r0 to #1 on hardware it will set r0 to #0.
<br/>
I don't think it's fixed in any emulators, might be wrong though.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
