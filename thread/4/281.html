<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>sprite collision detection - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > sprite collision detection</h2>
<div id="posts">
<div class="post">
    <h4>#1754 - strider999 - Wed Jan 22, 2003 4:31 pm</h4>
    <div class="postbody"><span class="postbody">whats the best way to do this? im planning on doing a super mario type game, but im new to the whole console programming scene. any tips?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1759 - SamX - Wed Jan 22, 2003 5:16 pm</h4>
    <div class="postbody"><span class="postbody">I am very much a newbie... But if you're going to have your sprite it'll be at x,y.
<br/>
<br/>
say your player struct has x and y and you give the sprite its x,y from player.x and player.y (same with enemy sprites enemy[0].x or whatever) then just use a bounding-box around the player and enemy (worked out from player.x, player.x + player.width, player.y, player.y + player.height.
<br/>
<br/>
Now with the bounding box you check that the boxes around the player and enemy haven't slipped on top of each other....
<br/>
<br/>
Sorry I'm not much help... You probably knew all this, but I felt like trying to offer something from my useless self ;) Give it a min and someone else will say something better.<br/>_________________<br/>-<span style="font-weight: bold">Sam</span>
<br/>
<br/>
<a class="postlink" href="http://www.gamersvoice.net/" target="_blank"></a><a href="http://trash.gamerseurope.com/markcrap/gvbutton3.jpg">[Images not permitted - Click here to view it]</a> <a class="postlink" href="http://2dnow.zenzer.net" target="_blank"></a><a href="http://lloyd.zenzer.net/junk/2dnowbanner.gif">[Images not permitted - Click here to view it]</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1764 - Splam - Wed Jan 22, 2003 6:30 pm</h4>
    <div class="postbody"><span class="postbody">Bounding boxes are one way to do it but due to the processing time involved (you could be checking 50 bullets against 20 enemies etc) I tend to use a coarse collision 1st  ie in your player/bullet/enemy structures keep a value (whatever size is up to you) that is calculated by the x and y divided by your "coarse" value, so maybe 8x8 , your collision value would be something like  y/8  x/8 and put those into a variable  like u16 = (coarsey&lt;&lt;8) | coarsex    then you only need to check that value against other sprites coarse values, if they match then they're somewhere on the same 8x8 screen block.  You can make this as coarse as you want (8x8 16x16 etc) then either use it alone or add bounding box collision as well if needed for finer detection.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1835 - princew - Fri Jan 24, 2003 3:12 am</h4>
    <div class="postbody"><span class="postbody">That way seems cool.  I never thought of a grid test first, then possibly testing sprites within the grid.
<br/>
<br/>
Here's a method I came up with and it seems to work fast enough.  I used it in my asteroids game where there are potentially 50 asteroids on the screen with up to 5 bullets, an enemy, and a player all collision detecting running at 60fps and no slowdown...
<br/>
<br/>
bool TestCollision( SpriteType* Sprite1, SpriteType* Sprite2 ) {
<br/>
    if        ( (Sprite1-&gt;x + Sprite1-&gt;BoxX2) &lt; (Sprite2-&gt;x + Sprite2-&gt;BoxX1) ) {
<br/>
        return false;
<br/>
    }	else if ( (Sprite1-&gt;x + Sprite1-&gt;BoxX1) &gt; (Sprite2-&gt;x + Sprite2-&gt;BoxX2) ) {
<br/>
        return false;
<br/>
    } else if ( (Sprite1-&gt;y + Sprite1-&gt;BoxY2) &lt; (Sprite2-&gt;y + Sprite2-&gt;BoxY1) ) {
<br/>
        return false;
<br/>
    }	else if ( (Sprite1-&gt;y + Sprite1-&gt;BoxY1) &gt; (Sprite2-&gt;y + Sprite2-&gt;BoxY2) ) {
<br/>
        return false;
<br/>
    }
<br/>
<br/>
    return TRUE;  // sprites collided
<br/>
}
<br/>
<br/>
Basically all it does is test each side of the bounding boxes one at a time and returns as soon any one of them fails.  This means that the majority of the sprites being tested will return false after only 1 or 2 tests.  As I said, I've used this and tested quite a few sprites onscreen at once without slowdown.  Furthermore you will want to make sure you only bother testing against sprites that are visible or active.
<br/>
<br/>
Russ</span><span class="gensmall"><br/><br/>Last edited by princew on Fri Jan 31, 2003 6:58 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#1853 - Splam - Fri Jan 24, 2003 3:53 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, bounding box detections can be fast and certainly something like asteroids where it's a 1 collisions 1 reaction detection.  My method is only really needed when collisions against multiple objects is needed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2261 - maniac - Fri Jan 31, 2003 10:28 pm</h4>
    <div class="postbody"><span class="postbody">Yet another way to do a quite fast collision detection is to precalculate the outer bounds of the sprites, (ie xstart and xend for each row on the sprites where xstart is the first pixel != transparent color and xend should be straight forward). Then it's just a simple comparison to get a true pixel collision detection!
<br/>
<br/>
On the other hand this technique will require quite a bit of overhead (cause of all the precalculated values). So this particular technique is an speed vs. overhead issue. But it works very good!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
