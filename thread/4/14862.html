<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Visual Ham project wont compile - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Visual Ham project wont compile</h2>
<div id="posts">
<div class="post">
    <h4>#149239 - yaazz - Thu Jan 17, 2008 2:37 am</h4>
    <div class="postbody"><span class="postbody">Hello I am attempting to learn GBA programming from the book "how to program the Game Boy Advance", and have run into an issue. 
<br/>
When I try to compile my program the compiler spits this out:
<br/>
{
<br/>
C:/gcc-arm/bin/arm-thumb-elf-gcc.exe  -I C:/gcc-arm/include -I C:/gcc-arm/arm-thumb-elf/include -I C:/include -I C:/system  -c -DHAM_HAM  -DHAM_MULTIBOOT  -DHAM_ENABLE_MBV2LIB -O2 -DHAM_WITH_LIBHAM  -mthumb-interwork -mlong-calls -Wall -save-temps -fverbose-asm -nostartfiles main.c -o main.o
<br/>
In file included from C:/gcc-arm/arm-thumb-elf/include/stdlib.h:14,
<br/>
                 from main.c:5:
<br/>
C:/gcc-arm/lib/gcc-lib/arm-thumb-elf/3.3.2/include/stddef.h:213: error: syntax error before "typedef"
<br/>
make: *** [main.o] Error 1
<br/>
}
<br/>
<br/>
For some reason, STDLIB, and STDDEF (which must be linked from stdlib) will not compile..... 
<br/>
Does anyone know how to fix this?
<br/>
<br/>
<br/>
here is the source for my program 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define multiboot int_gba_multiboot
<br/>
MULTIBOOT
<br/>
<br/>
#include &lt;stdlib.h&gt;
<br/>
<br/>
//drawing functions
<br/>
void drawPixel(int,int,unsigned short);
<br/>
void drawLine3(int,int,int,int,unsigned short);
<br/>
<br/>
//defines for the video mode
<br/>
#define REG_DISPCNT *(unsigned long*)0x4000000
<br/>
#define MODE_3 0x3
<br/>
#define BG2_ENABLE 0x400
<br/>
<br/>
//changes the video mode
<br/>
#define setMode(mode) REG_DISPCNT= (mode)
<br/>
<br/>
//packs 3 values into 15 bit color
<br/>
#define RGB(r,g,b) ((r)+(g&lt;&lt;5)+(b&lt;&lt;10))
<br/>
<br/>
//create a pointer to the video buffer
<br/>
unsigned short* videoBuffer = (unsigned short*)0x6000000;
<br/>
<br/>
<br/>
int main(void)
<br/>
{
<br/>
   int x1,y1,x2,y2;
<br/>
   unsigned short color;
<br/>
<br/>
   setMode(MODE_3 | BG2_ENABLE);
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
       x1 = rand()*240;
<br/>
       y1 = rand()*160;
<br/>
       x2 = rand()*240;
<br/>
       y2 = rand()*160;
<br/>
<br/>
       color=RGB(rand()%31, rand()%31, rand()%31);
<br/>
<br/>
       drawLine3(x1,y1,x2,y2,color);
<br/>
   }
<br/>
<br/>
   return 0;
<br/>
}
<br/>
<br/>
void drawPixel3(int x, int y, unsigned short c)
<br/>
{
<br/>
    videoBuffer[y * 240 + x] = c;
<br/>
}
<br/>
<br/>
void drawLine3(int x1,int y1, int x2, int y2, unsigned short c)
<br/>
{
<br/>
    int i, deltaX, deltaY, numPixels;
<br/>
    int d, dinc1, dinc2;
<br/>
    int x, xinc1, xinc2;
<br/>
    int y, yinc1, yinc2;
<br/>
<br/>
    //calculate deltaX and deltaY
<br/>
    deltaX = abs(x2 - x1);
<br/>
    deltaY = abs(y2 - y1);
<br/>
<br/>
    //initialize
<br/>
    if(deltaX &gt; deltaY)
<br/>
    {
<br/>
        //If x is an independant variable
<br/>
        numPixels = deltaX + 1;
<br/>
        d = (2 * deltaY) - deltaX;
<br/>
        dinc1 = deltaY &lt;&lt; 1;
<br/>
        dinc2 = (deltaY - deltaX) &lt;&lt; 1;
<br/>
        xinc1 = 1;
<br/>
        xinc2 = 1;
<br/>
        yinc1 = 0;
<br/>
        yinc2 = 1;
<br/>
    }
<br/>
    else
<br/>
    {
<br/>
        // if y is independant variable
<br/>
        numPixels = deltaY + 1;
<br/>
        d = (2* deltaX) - deltaY;
<br/>
        dinc1 = deltaX &lt;&lt; 1;
<br/>
        dinc2 = (deltaX - deltaY) &lt;&lt; 1;
<br/>
        xinc1 = 0;
<br/>
        xinc2 = 1;
<br/>
        yinc1 = 1;
<br/>
        yinc2 = 2;
<br/>
<br/>
    }
<br/>
<br/>
    //move the right direction
<br/>
    if (x1&gt;x2)
<br/>
    {
<br/>
        xinc1 = -xinc1;
<br/>
        xinc2 = -xinc2;
<br/>
    }
<br/>
<br/>
    if (y1 &gt; y2)
<br/>
    {
<br/>
        yinc1 = -yinc1;
<br/>
        yinc2 = -yinc2;
<br/>
    }
<br/>
<br/>
    x = x1;
<br/>
    y = y1;
<br/>
<br/>
    //draw the pixels
<br/>
    for (i=1;i&lt;numPixels;i++)
<br/>
    {
<br/>
        drawPixel(x,y,c);
<br/>
<br/>
        if(d&lt;0)
<br/>
        {
<br/>
            d = d + dinc1;
<br/>
            x = x + xinc1;
<br/>
            y = y + yinc1;
<br/>
        }
<br/>
        else
<br/>
        {
<br/>
            d = d + dinc2;
<br/>
            x = x + xinc2;
<br/>
            y = y + yinc2;
<br/>
        }
<br/>
    }
<br/>
}
<br/>
/* END OF FILE */
<br/>
</td> </tr></table><span class="postbody">[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149250 - bpoint - Thu Jan 17, 2008 8:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaazz wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
here is the source for my program 
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define multiboot int_gba_multiboot
<br/>
MULTIBOOT
<br/>
<br/>
#include &lt;stdlib.h&gt;
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I've never used Ham, but I'd be willing to bet this is your problem.
<br/>
<br/>
The #define for multiboot is fine, but the "MULTIBOOT" is an undefined symbol.  There's nothing before that line that tells the compiler what "MULTIBOOT" is, so when it #includes stdlib.h, the first source code line in the header file causes a compiler error (the typedef in your case).
<br/>
<br/>
Moving the #include &lt;stdlib.h&gt; line above the "MULTIBOOT" code will fix the error in the stddef.h header, but you'll still need a valid symbol for "MULTIBOOT" -- which is where Ham does something for you but you're not #including.
<br/>
<br/>
However, just going on a gut feeling (no guarantees!), I would simply change the line:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">MULTIBOOT</td> </tr></table><span class="postbody">
<br/>
to:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">multiboot;</td> </tr></table><span class="postbody">
<br/>
(note the semicolon) and see what happens.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149344 - tepples - Fri Jan 18, 2008 8:11 pm</h4>
    <div class="postbody"><span class="postbody">That method of making a multiboot program was correct in DevKit Advance, but it is not correct in devkitARM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149501 - elyk1212 - Mon Jan 21, 2008 5:49 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">That method of making a multiboot program was correct in DevKit Advance, but it is not correct in devkitARM.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yep, visual ham doesn't use the new DevkitARM gcc/binutils/etc build version.  I also do not think it has been updated in years.  But, ham libraries itself have (I think?) just not the visual HAM IDE (and perhaps the gcc tools underneath this Visual HAM install), and not much updates for Linux :(.
<br/>
<br/>
<span style="font-weight: bold">yaazz:</span>
<br/>
FYI, you can use most of the concepts from the book and still use devkitARM.  Even though the first few examples list VisualHAM most of the time the author defines all the addresses etc, that you need to complete the tutorials.
<br/>
<br/>
You may run into a few define annoyances (as you listed earlier), but you can safely substitute to something workable with a little leg work.
<br/>
<br/>
OR,
<br/>
<br/>
You can use the Deprecated VisualHAM IDE to compile the examples with out a hitch, and switch to devkitARM when you are ready.
<br/>
<br/>
BTW, I rather liked Peter's VisualHAM (if I was ever using windows).  It was a working out of the box solution. Too bad it was abandoned (but I guess keeping an IDE project updated can be daunting for one fellow).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149522 - gmiller - Mon Jan 21, 2008 3:38 pm</h4>
    <div class="postbody"><span class="postbody">You can use Visual Ham with the devkitPro tools with some different makefile's and some minor work on the Ham Libraries.  My students use Visual Ham and devkitPro every month.  The Ham libraries are not part of that but I do have one example that uses that combo.
<br/>
<br/>
If you are interested just PM me and I will work out a way for you to get this setup.  I do not think many here would care for this combination.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
