<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>This guy seems to know his math, I don't get it though! - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > This guy seems to know his math, I don't get it though!</h2>
<div id="posts">
<div class="post">
    <h4>#24977 - lordmetroid - Sat Aug 14, 2004 8:16 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.flipcode.com/cgi-bin/msg.cgi?showThread=00010994&amp;forum=3dtheory&amp;id=-1" target="_blank">My post</a> on flipcode got me an interesting <a class="postlink" href="http://www.flipcode.com/cgi-bin/msg.cgi?showThread=00010994&amp;forum=3dtheory&amp;id=2" target="_blank">answer...</a> However I can't understand how it would work...
<br/>
Could you guys please help me out with it?<br/>_________________<br/>*Spam*
<br/>
Open Solutions for an open mind, <a href="http://www.areta.org" target="_blank">www.areta.org</a>
<br/>
<br/>
Areta is an organization of coders codeing mostly open source project, but there is alot of sections like GBA dev, Language learning communities, RPG communities, etc...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24978 - lordmetroid - Sat Aug 14, 2004 8:47 am</h4>
    <div class="postbody"><span class="postbody">Don't bother... darn me, just thinking in wrong directions...
<br/>
I didn't consider what the dot product would really make out of my world...<br/>_________________<br/>*Spam*
<br/>
Open Solutions for an open mind, <a href="http://www.areta.org" target="_blank">www.areta.org</a>
<br/>
<br/>
Areta is an organization of coders codeing mostly open source project, but there is alot of sections like GBA dev, Language learning communities, RPG communities, etc...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24992 - DekuTree64 - Sat Aug 14, 2004 6:56 pm</h4>
    <div class="postbody"><span class="postbody">Hmm, I'm not quite sure what that other guy meant either, but I am a little curious as to how your CZ-buffer idea would work. I tried a C-buffer once, but it was significantly slower than just throwing triangles at the screen. It was written in C though (compared to a C brute force filler), so I can't say how an ASM version would compare to an ASM brute force routine.
<br/>
I have a feeling though that on GBA, you're not going to GET enough triangles on the screen for any overdraw reduction to help much.
<br/>
What kind of worlds do you have in mind to render with it? I know you said only Y axis rotation, and that helps a lot, but you'll probably have to do some serious optimizing based on what sort of environments you'll be in, like indoor, outdoor, small corridors, lots of open space, hills and trees, or more square things like buildings.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25047 - lordmetroid - Sun Aug 15, 2004 10:41 pm</h4>
    <div class="postbody"><span class="postbody">It doesn't matter what environment I am in...
<br/>
I make use of a old trick to save both memory and in this case also cpu power...
<br/>
Tilemaps!
<br/>
Though the tile does contain polygon information rather then pixel information this time...
<br/>
I then make the frustum cull with a tech my coder associate and teacher invented or whatever, he told me about it anyway...
<br/>
The frustum is culled by a Shockwave tech, the shockwave is a LUT specifying how the tiles should be tested when culling. At the same time as the frustum cull the tiles get a shade value.
<br/>
Then the polygons inside the frustum is backface culled and at the same time their angle checked against the camera and an additional shade value is added upon the first one.
<br/>
Now we got flatshading for free.
<br/>
<br/>
The C-buffer will handle clipping automaticly so I gain some speed their and it's necessary as I make use of mode2 for rendering and so using segments eases my work with my objects!
<br/>
The Z in CZ-buffer is a Z buffer combined with a C-buffer, the Z-buffer is used for my objects and checked pixel for pixel against the segment of the world.
<br/>
If their is no segment occupying a tile the mapdata is assigned tile0.
<br/>
This makes reseting the buffer really much a fast thing and I only need to write to VRAM the tiles currently occupied by some 3D data.
<br/>
The background is scaled to only show half the background at once, and using the other as a dbl-buffer. This will make the rendering area a 128x64pixels/buffer, not much indeed!
<br/>
I also doesn't have any floor out of polygons but rather use the second layer for that!
<br/>
<br/>
With all these abuses of the system and some more like the rotation only around Y-axis I think I will gain some cpu power I wouldn't be having if I didn't make use of all these evil cheats<br/>_________________<br/>*Spam*
<br/>
Open Solutions for an open mind, <a href="http://www.areta.org" target="_blank">www.areta.org</a>
<br/>
<br/>
Areta is an organization of coders codeing mostly open source project, but there is alot of sections like GBA dev, Language learning communities, RPG communities, etc...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25052 - DekuTree64 - Sun Aug 15, 2004 11:19 pm</h4>
    <div class="postbody"><span class="postbody">Hmm, sounds like a right fine plan, actually. 
<br/>
Here's what I'd do to sort of eliminate the frustum culling altogether. Your tiles are just flat on the 'ground' (X/Z) plane, right? So you only have to test against lines, rather than 3D planes, because the Y, or height from the ground, is ignored.
<br/>
Instead of checking each map tile against those frustum lines, just look at the frustum as a 2D polygon layed out on the 2D ground. Either a 4 sided polygon, or to simplify things even more, ignore the near clipping plane, and it becomes a triangle. And what do you do when you have a triangle on a grid? You interpolate along the edges and draw it, of course. Just 'draw' the frustum triangle like a regular polygon, except instead of plotting pixels, do your 'I found a tile inside the frustum' code. Heck, you could even get free Z sorting by starting at the vertex closest/farthest from the camera.
<br/>
<br/>
..at least I think it would work. What do you think? Should I draw a picture to explain it a little better?<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#25054 - lordmetroid - Sun Aug 15, 2004 11:40 pm</h4>
    <div class="postbody"><span class="postbody">That is what the shockwave does... start with the tiles nearest the camera and make a .product test with the view angles' normals defining the frustum...
<br/>
And as each stage of the shockwave spawns next stage I store what tiles is nearest the camera... that way I get a general polygon sorting, and segments near the camera can occupy large amount of the screen meaning I test those first and then don't need to overwrite any segments I previously done...<br/>_________________<br/>*Spam*
<br/>
Open Solutions for an open mind, <a href="http://www.areta.org" target="_blank">www.areta.org</a>
<br/>
<br/>
Areta is an organization of coders codeing mostly open source project, but there is alot of sections like GBA dev, Language learning communities, RPG communities, etc...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
