<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Volatile unsigned char to ints typecasting - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Volatile unsigned char to ints typecasting</h2>
<div id="posts">
<div class="post">
    <h4>#177231 - blessingta@hotmail.co.uk - Tue Jan 31, 2012 7:54 pm</h4>
    <div class="postbody"><span class="postbody">Is it possible to typecast "volatile unsigned char" to "int"?
<br/>
Would I have to change my "vcuSnake_X" and "vcuSnake_Y" to ints?
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void Render_Game()
<br/>
{
<br/>
Print_Fonts("UP",0,10);
<br/>
redcircle_sprites((int)vcuSnake_X,(int)vcuSnake_Y,1);
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177232 - blessingta@hotmail.co.uk - Tue Jan 31, 2012 8:01 pm</h4>
    <div class="postbody"><span class="postbody">somemore info:
<br/>
Below is my Logic which influences the volatile data
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "_gamestate_Logic.h"
<br/>
<br/>
enum E_SNAKE_DIRECTION{UP=1,DOWN=2,LEFT=3,RIGHT=4}; 
<br/>
<br/>
volatile unsigned char vucSNAKE_DIR =RIGHT;//stores requested direction
<br/>
volatile unsigned char vucSNAKE_MOVE =RIGHT;//Stores current snake direction
<br/>
<br/>
volatile unsigned char vcuSnake_X = 125;//230max X
<br/>
volatile unsigned char vcuSnake_Y = 75;//150max Y
<br/>
void SNAKE_DIR_func ();
<br/>
void MOVE_SNAKE();
<br/>
<br/>
void Run_Game ()
<br/>
{
<br/>
//Control snake direction
<br/>
SNAKE_DIR_func();
<br/>
<br/>
//Move snake
<br/>
MOVE_SNAKE();
<br/>
<br/>
}
<br/>
<br/>
<br/>
<br/>
<br/>
//SNAKE direction
<br/>
void SNAKE_DIR_func ()
<br/>
{
<br/>
      switch (vucKEYS_STATES){
<br/>
      case KEY_UPpressed:      Print_Fonts("UP",0,10); vucSNAKE_DIR = UP;    break;
<br/>
      case KEY_LEFTpressed:  Print_Fonts("LEFT",0,10);vucSNAKE_DIR = LEFT;  break;
<br/>
      case KEY_RIGHTpressed: Print_Fonts("RIGHT",0,10);vucSNAKE_DIR = RIGHT; break;
<br/>
      case KEY_DOWNpressed:  Print_Fonts("DOWN",0,10);vucSNAKE_DIR = DOWN;  break;
<br/>
      default: break;
<br/>
      }
<br/>
}
<br/>
<br/>
void MOVE_SNAKE()
<br/>
{
<br/>
switch (vucSNAKE_DIR)//Requested Direction:
<br/>
{ 
<br/>
case UP: 
<br/>
switch(vucSNAKE_MOVE)//Accept change in direct if snake moving left or right
<br/>
{case LEFT:/**/ vcuSnake_Y += 1;vucSNAKE_MOVE = UP; /**/break;
<br/>
case RIGHT:/**/ vcuSnake_Y += 1;vucSNAKE_MOVE = UP; /**/break;
<br/>
} break;
<br/>
<br/>
case LEFT:  
<br/>
switch(vucSNAKE_MOVE)//Accept change in direct if snake moving up or down
<br/>
{case   UP:/**/ vcuSnake_X -= 1; vucSNAKE_MOVE = LEFT; /**/break;
<br/>
 case DOWN:/**/ vcuSnake_X -= 1;vucSNAKE_MOVE = LEFT; /**/break;
<br/>
}break;
<br/>
<br/>
 case RIGHT: 
<br/>
 switch(vucSNAKE_MOVE)//Accept change in direct if snake moving up or down
<br/>
{case   UP:/**/ vcuSnake_X += 1; vucSNAKE_MOVE = RIGHT; /**/break;
<br/>
 case DOWN:/**/ vcuSnake_X += 1;vucSNAKE_MOVE = RIGHT; /**/break;
<br/>
}break;
<br/>
<br/>
 case DOWN:  
<br/>
 switch(vucSNAKE_MOVE)//Accept change in direct if snake moving left or right
<br/>
{case LEFT:/**/ vcuSnake_Y -= 1;vucSNAKE_MOVE = DOWN; /**/break;
<br/>
case RIGHT:/**/ vcuSnake_Y -= 1;vucSNAKE_MOVE = DOWN; /**/break;
<br/>
} break;
<br/>
}
<br/>
<br/>
}</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177233 - elhobbs - Tue Jan 31, 2012 9:08 pm</h4>
    <div class="postbody"><span class="postbody">I am guessing that you are asking because you are experiencing a problem - but, you never say what the problems is. 
<br/>
<br/>
yes, it is possible to cast these values as you have shown. you need to consider sign extension though. chances are you are better off using int all around.
<br/>
<br/>
are you reading/modifying these values in an interrupt? if not then you can drop volatile.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177236 - sverx - Wed Feb 01, 2012 11:40 am</h4>
    <div class="postbody"><span class="postbody">probably you don't need 'volatile' at all... and unsigned char should implicitly cast to int if required...<br/>_________________<br/><a class="postlink" href="http://bit.ly/yiQrz9" target="_blank">libXM7</a>|<a class="postlink" href="http://bit.ly/yJwcOo" target="_blank">NDS programming tutorial (Italiano)</a>|<a class="postlink" href="http://disjointedstudio.blogspot.com/" target="_blank">Waimanu DS / GBA</a>|<a class="postlink" href="http://adshomebrewersdiary.blogspot.com" target="_blank">A DS Homebrewer's Diary</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#177237 - blessingta@hotmail.co.uk - Wed Feb 01, 2012 4:07 pm</h4>
    <div class="postbody"><span class="postbody">Thanks, I just followed your advice and it turns out the problem seems to be my sprite function. If you could check out the "bta_game_sprites" and "btaLoadSprites" that would be appreciated, I reckon that's the source of my problems. 
<br/>
<br/>
Below is my project:
<br/>
<a href="http://dl.dropbox.com/u/42518274/SNAKE3.rar" target="_blank">http://dl.dropbox.com/u/42518274/SNAKE3.rar</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
