<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Graphic distortion caused by OBJ <> OBJ <> BG pr - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Graphic distortion caused by OBJ <> OBJ <> BG pr</h2>
<div id="posts">
<div class="post">
    <h4>#110282 - Peter - Mon Nov 27, 2006 3:00 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
one of the HEL Library users sent me a test project where some OBJ's are distorted. The distortion is only visible on the display, the OBJ's look good in the tile-viewer as well as in the OAM viewer. BTW, only VBA emulated the problem correctly, no$gba does not, will Martin drop an email later.
<br/>
<br/>
I replaced the graphics and uploaded the compiled test project, you can check it out <a class="postlink" href="http://www.console-dev.de/tmp/obj_distortion.zip" target="_blank">here</a>. Move the monster over the text and the letters will distort. I was pretty stuck until I found this text in <a class="postlink" href="http://www.work.de/nocash/gbatek.htm#lcdobjoamattributes" target="_blank">GBATek</a> (url fixed, points not to my HD anymore):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<span style="font-weight: bold"><span style="font-size: 18px; line-height: normal">Priority</span></span>
<br/>
<br/>
In case that the 'Priority relative to BG' is the same than the priority of one of the background layers, then the OBJ becomes higher priority and is displayed on top of that BG layer.
<br/>
<br/>
<span style="color: red">Caution: Take care not to mess up BG Priority and OBJ priority. For example, the following would cause garbage to be displayed:
<br/>
  OBJ No. 0 with Priority relative to BG=1   ;hi OBJ prio, lo BG prio
<br/>
  OBJ No. 1 with Priority relative to BG=0   ;lo OBJ prio, hi BG prio
<br/>
<br/>
That is, OBJ0 is always having priority above OBJ1-127, so assigning a lower BG Priority to OBJ0 than for OBJ1-127 would be a bad idea.</span>
<br/>
</td> </tr></table><span class="postbody">
<br/>
The red marked text is exactly what he is doing in the test project, so this seems to be some sort of hardware limitation or bug?! Does anybody know why this occurs or is it more like "that's a fact, simply don't do it"? :)</span><span class="gensmall"><br/><br/>Last edited by Peter on Mon Nov 27, 2006 9:33 pm; edited 3 times in total</span></div>    
</div>
<div class="post">
    <h4>#110287 - Cearn - Mon Nov 27, 2006 4:37 pm</h4>
    <div class="postbody"><span class="postbody">As it doesn't seem to be a problem for it can probably be considered a GBA hardware bug/oversight. From a <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#dsvideoobjs" target="_blank">GBATek</a> not on your HD:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote"><span style="font-weight: bold">DS OBJ Priority</span>
<br/>
The GBA has been assigning OBJ priority in respect to the 7bit OAM entry number, regardless of the OBJs 2bit BG-priority attribute (which allowed to specify invalid priority orders). That problem has been fixed in DS mode by combining the above two values into a 9bit priority value.</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
