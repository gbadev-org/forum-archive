<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>help: "Fog of War" technique - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > help: "Fog of War" technique</h2>
<div id="posts">
<div class="post">
    <h4>#16125 - snorman - Mon Feb 09, 2004 3:40 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
I'm fairly new to GBA development so I thought I'd ask these question here:
<br/>
<br/>
1. What is the best way to achieve a fog-of-war type effect? I'm currently writing a turn-based strategy game where each unit has a certain field of vision (the game currently runs in tile mode 0). Anything not in that field of vision should be greyed out. I want this to be a transparency effect and not a "blanking out" effect, so that you can still see the terrain...it's just darker.
<br/>
<br/>
2. Simirarly, when I select a unit, I'd like to overlay some type of display effect which indicates the unit's movement range...I'm assuming this could be acheived similarly to (1).
<br/>
<br/>
Any help or ideas would be appreciated!
<br/>
Sean.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16126 - poslundc - Mon Feb 09, 2004 5:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>snorman wrote:</b></span></td> </tr> <tr> <td class="quote">1. What is the best way to achieve a fog-of-war type effect? I'm currently writing a turn-based strategy game where each unit has a certain field of vision (the game currently runs in tile mode 0). Anything not in that field of vision should be greyed out. I want this to be a transparency effect and not a "blanking out" effect, so that you can still see the terrain...it's just darker.</td> </tr></table><span class="postbody">
<br/>
<br/>
If the field of vision is a simple, convex polygon (ie. a circle, ellipse, hexagon or similar simple shape) then it would probably be most practical to use a window and dynamically change the window's settings each scanline during HBlank. There are various tutorials on how to do this, or you can search the forums, but be warned that this is an intermediate-level technique on the GBA and may prove difficult if you're just starting out. This technique has the advantage that you can easily change the radius of the effect to animate it or give different amounts to different units.
<br/>
<br/>
If the field of vision is a more complicated shape but relatively small and unchanging, you might want to represent it with a sprite and use a sprite window.
<br/>
<br/>
If, on the other hand, the visible area is dynamic (such as in games like War Craft) you'd be better off using a text background to represent what areas can be seen and what areas are obscured.
<br/>
<br/>
Once you've determined your method, use the alpha-effects register to darken the relevant backgrounds, sprites, etc. by 50% and then apply the effect to outside the window (if using the first two methods) or if using the third method then set it to alpha blend 50% and then blend the text background on top with everything else.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">2. Simirarly, when I select a unit, I'd like to overlay some type of display effect which indicates the unit's movement range...I'm assuming this could be acheived similarly to (1).</td> </tr></table><span class="postbody">
<br/>
<br/>
Again, this depends on how you want it to appear on the screen. Do you want arrow-shaped sprites, or do you want another "fog of movement"? The thing to keep in mind is that you can only use one set of alpha effects at a time, so if you want it semi-transparent you will either have to do something compatible with your previous effect (which is very tricky if you're doing the window method) or use another technique like toggling a sprite/background on and off every other frame to generate a sort of flickering transparency.
<br/>
<br/>
Good luck,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16130 - snorman - Mon Feb 09, 2004 1:20 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the quick reply! I will definately look into these techniques...
<br/>
<br/>
One quick question first: Is is possible to use alpha-blending on individual tiles in tile-mode (I don't know much about alpha blending yet...)? For example, I was thinking I could use two backgrounds...one for my map, and another which just consists of black tiles. Then, I would set the black-tiled background to a higher priority and enable alpha-blending on all tiles in it except for those within the field of vision?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">If, on the other hand, the visible area is dynamic (such as in games like War Craft) you'd be better off using a text background to represent what areas can be seen and what areas are obscured. </td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, something along these lines is what I had in mind...would this be done similarly to the idea I suggested above?
<br/>
<br/>
Thanks!
<br/>
Sean.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16132 - FluBBa - Mon Feb 09, 2004 2:46 pm</h4>
    <div class="postbody"><span class="postbody">I suspect that you want to change the "color" of individual tiles, right?
<br/>
So that is exactly what you should do, if you make your background of 16 color tiles you can just change the palette each tile have, if you have 8 different palettes for the background you can have 8 copies with different luma or color.
<br/>
Or you can use 2 BGs, one which you fill with black (or grey) where you should mark the map and use transparency.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16133 - poslundc - Mon Feb 09, 2004 3:27 pm</h4>
    <div class="postbody"><span class="postbody">Or you can just swap different tiles in and out of the tilemap. If an 8x8 square becomes visible, swap in an empty tile where there was a totally black tile. You can give tiles different shapes in order to create a transition from the light to dark, eg. you can have a tile that has the upper-right half dark and the bottom-left half empty to create a diagonal line between light and dark.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
