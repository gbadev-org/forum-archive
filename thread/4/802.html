<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GbaDev Compile with crt0.s and linkscrpit doubt  ;( - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > GbaDev Compile with crt0.s and linkscrpit doubt  ;(</h2>
<div id="posts">
<div class="post">
    <h4>#4061 - rome - Mon Mar 17, 2003 2:01 pm</h4>
    <div class="postbody"><span class="postbody">i?m trying compile Gbadev with crt0.S v1.26 by Jeff Frohwein, in my gba C plus plus project.
<br/>
the project has only 4 files. gba.c and crt0.s (linkscript file of course)
<br/>
crtbegin.o and crtend.o to cplus cplus projects
<br/>
<br/>
i wanna compile just to test if interrupts are enabled. but when i compile it gets a warning:
<br/>
<br/>
/cygdrive/c/DEVKIT~1/BIN/../lib/gcc-lib/arm-agb-elf/3.0.2/../../../../arm-agb-el
<br/>
f/bin/ld: warning: cannot find entry symbol _start; defaulting to 08000000
<br/>
<br/>
what?s wrong? the elf files wasnt created :(
<br/>
<br/>
see below whats done in makefile:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
All : gba.bin
<br/>
<br/>
gba.bin : gba.elf
<br/>
   objcopy -O binary gba.elf gba.bin
<br/>
<br/>
gba.elf: crt0.o gba.o crtbegin.o crtend.o
<br/>
   gcc -nostartfiles -Tlnkscript -o crt0.o gba.o crtbegin.o crtend.o
<br/>
<br/>
gba.o : gba.cpp
<br/>
   gcc -c gba.cpp
<br/>
<br/>
crt0.o : crt0.s
<br/>
   as -mthumb-interwork -marm7tdmi -o crt0.o crt0.s
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4064 - pollier - Mon Mar 17, 2003 7:17 pm</h4>
    <div class="postbody"><span class="postbody">I'm not completely sure about symbol _start but probably has to do with whether you named your startup function "main" or "AgbMain"
<br/>
<br/>
Also, this doesn't look right:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">gcc -nostartfiles -Tlnkscript -o crt0.o gba.o crtbegin.o crtend.o 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
-nostartfiles disables the use of the crt files (I think) so it's a bit redundant, and you need to specify the .elf output file after -o, also crtbegin.o ought to be the first in the linking list, as far as I know, but I never use those...
<br/>
<br/>
replacement (although it won't fix the "symbol _start" error)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gcc -nostartfiles -Tlnkscript -o gba.elf crtbegin.o crt0.o gba.o crtend.o</td> </tr></table><span class="postbody">
<br/>
<br/>
or this ought to work I believe:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gcc -Tlnkscript -o gba.elf gba.o</td> </tr></table><span class="postbody">
<br/>
but someone'll have to confirm that...
<br/>
<br/>
woah, I've written a lot of uncertainty into this post (heh)<br/>_________________<br/>(Works for me!)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4085 - ampz - Tue Mar 18, 2003 5:07 am</h4>
    <div class="postbody"><span class="postbody">I believe "_start" is supposed to be the entrypoint in crt0.s or something.
<br/>
<br/>
more uncertainty...  :D</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
