<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>the bss section - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > the bss section</h2>
<div id="posts">
<div class="post">
    <h4>#149451 - bpoint - Sun Jan 20, 2008 9:36 am</h4>
    <div class="postbody"><span class="postbody">Hello all,
<br/>
<br/>
I made a post over at the <a class="postlink" href="http://forums.devkitpro.org/viewtopic.php?f=2&amp;t=19" target="_blank">devkitPro forums</a> asking some questions about the GBA's bss section, but it seems the user base over there isn't quite as big as it is here... :)
<br/>
<br/>
In any case, I'm still looking for the answer to any of these three questions:
<br/>
<br/>
1) Is there any specific reason why .bss is located in iwram instead of ewram?
<br/>
2) Is it possible to relocate the .bss section from iwram to ewram? I presume I need to change the gba_cart.ld file, but I'm not exactly sure what I'd need to change and where.
<br/>
3) Are there any side-effects with moving .bss into ewram? Will its location conflict with malloc() and/or my stack?
<br/>
<br/>
Any takers?  Thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149458 - tepples - Sun Jan 20, 2008 2:15 pm</h4>
    <div class="postbody"><span class="postbody">For one thing, IWRAM is much faster than EWRAM on the GBA because the ARM7 doesn't have a cache. The DS link script gets away with putting .data and .bss in EWRAM because the ARM9 caches EWRAM.
<br/>
<br/>
If you want a big block of statically allocated slow memory, use section .sbss to put it in EWRAM. But then you won't be able to use an appended data file (e.g. GBFS) because it will overlap section .sbss.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#149474 - bpoint - Sun Jan 20, 2008 6:54 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">For one thing, IWRAM is much faster than EWRAM on the GBA because the ARM7 doesn't have a cache. The DS link script gets away with putting .data and .bss in EWRAM because the ARM9 caches EWRAM.</td> </tr></table><span class="postbody">
<br/>
Yeah, I know IWRAM is faster, but having all static data put into IWRAM is blocking me from putting all of the code from my sound engine (and in the future my 3D rendering code as well) I want in there, since space is rather limited.  Since malloc() returns a pointer to EWRAM memory anyway, it seems like that it wouldn't hurt much to have both .data and .bss go into EWRAM.  Or am I wrong about that?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">If you want a big block of statically allocated slow memory, use section .sbss to put it in EWRAM. But then you won't be able to use an appended data file (e.g. GBFS) because it will overlap section .sbss.</td> </tr></table><span class="postbody">
<br/>
The problem is gcc is automatically putting all of my static symbols into .bss.  I'd have to put __attribute__(section (".sbss")) after every static variable in my source code... which is not going to be fun, hence the reason I wanted to know if I could change the linker script to move everything into EWRAM for me.  I already have my own methods for accessing appended file data to the ROM, so GBFS isn't an issue, but on the NDS, I was planning on using libfat.  Is there anything I should be aware of regarding this on NDS?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
