<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>fixed point variables - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > fixed point variables</h2>
<div id="posts">
<div class="post">
    <h4>#22148 - InflamedSpirit - Sun Jun 13, 2004 9:35 pm</h4>
    <div class="postbody"><span class="postbody">I've been programming with gba for a couple months now but I've never really understood the fixed point variables. The definition of them is, as far as i can tell, the same as a long (s32). 
<br/>
<br/>
Could you just use a long for fixed point variables or is the FIXED definition declaration stuff really needed?
<br/>
<br/>
 Also, does anyone knows a good site with a tutorial about fixed points?<br/>_________________<br/>My confection, through natural selection, has reached a complexion of utter perfection. (well, not really... but...)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22150 - alek - Sun Jun 13, 2004 9:49 pm</h4>
    <div class="postbody"><span class="postbody">Yes, you can use long for fixed point math. What you do is you specify what bits represent the integer part and what bits represents the decimals. If you use long you might want the first 16 bits to represent decimals and the following 16 bits to represent the integer part.
<br/>
<br/>
Here's a link to a page that explains it a bit and gives a few defines for you to work with <a href="http://members.aol.com/form1/fixed.htm" target="_blank">http://members.aol.com/form1/fixed.htm</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22151 - poslundc - Sun Jun 13, 2004 10:17 pm</h4>
    <div class="postbody"><span class="postbody">There is no intrinsic difference to the compiler between fixed-point variables and the normal integer types (int, short, char, etc.). When and if you use typedef to create a "FIXED" data type, it is purely for the programmer's reference, so they can see and remember when looking at the variable declaration that they are supposed to interpret it as a fixed-point variable.
<br/>
<br/>
Fixed-point mathematics rely entirely on the programmer for the implementation, versus floats, which rely on the compiler.
<br/>
<br/>
From a practical perspective, most fixed-point variables are declared either as u32 or s32, since the other primitive integer types don't usually provide enough precision as the task demands for both the integer and fractional portions. I've occasionally used u16/s16 for 8.8 fixed-point numbers, though.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22163 - InflamedSpirit - Mon Jun 14, 2004 1:30 am</h4>
    <div class="postbody"><span class="postbody">Thx for the help but now I'm getting a new error. All over, whenever I use the &lt;&lt; or &gt;&gt; i seem to get the following error:
<br/>
<br/>
<span style="font-style: italic">invalid operands to binary &gt;&gt;</span>
<br/>
<br/>
When ever I comment the line with the shift out it compiles fine (but, of corse, I'm missing those lines).<br/>_________________<br/>My confection, through natural selection, has reached a complexion of utter perfection. (well, not really... but...)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22164 - poslundc - Mon Jun 14, 2004 1:33 am</h4>
    <div class="postbody"><span class="postbody">The error implies that you aren't using integer variables as your operands. If you still can't figure it out, try posting the code.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22173 - johnny_north - Mon Jun 14, 2004 3:24 am</h4>
    <div class="postbody"><span class="postbody">You'll get the error you refer to if you are trying to use the shift operators with a float. 
<br/>
<br/>
Instead of this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">float x = 1.0;
<br/>
Fixed24_8 y = x&lt;&lt;8;</td> </tr></table><span class="postbody">
<br/>
Do this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">float x = 1.0
<br/>
Fixed24_8 = x*256;</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23178 - LeMich - Tue Jul 06, 2004 6:24 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
I am a bit confused with fixed point. 
<br/>
I don't see why addition is the same as for integer on an example.
<br/>
<br/>
ex : 
<br/>
<br/>
      11:100     3:4
<br/>
 + 100:111     4:7
<br/>
  =111:1011   7:11
<br/>
<br/>
But in fact 3:4+4:7 = 8:1 and not 7:11
<br/>
<br/>
Can someone help me ? how can i code addition and substraction with define in c ?
<br/>
<br/>
thanks in advance</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23179 - poslundc - Tue Jul 06, 2004 6:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>LeMich wrote:</b></span></td> </tr> <tr> <td class="quote">ex : 
<br/>
<br/>
      11:100     3:4
<br/>
 + 100:111     4:7
<br/>
  =111:1011   7:11
<br/>
<br/>
But in fact 3:4+4:7 = 8:1 and not 7:11</td> </tr></table><span class="postbody">
<br/>
<br/>
The key to fixed point is that the decimal point stays at a fixed position. Your last line of arithmetic is incorrect. It will help if you put all of the zeros in rather than spaces:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">  0011:100     3:(1/2)
<br/>
+ 0100:111     4:(7/8)
<br/>
= 1000:011     8:(3/8)</td> </tr></table><span class="postbody">
<br/>
<br/>
Note that if you take the colon out and just perform simple binary addition on the two numbers, you get the same answer.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">how can i code addition and substraction with define in c ?</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#define FIXED_ADD(a, b)     ((a) + (b))
<br/>
#define FIXED_SUB(a, b)     ((a) - (b))</td> </tr></table><span class="postbody">
<br/>
<br/>
Note that I am making a satirical point that addition and subtraction are the same thing in fixed-point as they are in regular integer math.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23182 - LeMich - Tue Jul 06, 2004 6:56 pm</h4>
    <div class="postbody"><span class="postbody">thanks ;O)
<br/>
I see now how it works</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
