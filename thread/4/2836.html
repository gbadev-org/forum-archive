<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Clearing Flash RAM? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Clearing Flash RAM?</h2>
<div id="posts">
<div class="post">
    <h4>#16179 - DarkPhantom - Tue Feb 10, 2004 5:21 am</h4>
    <div class="postbody"><span class="postbody">I'm trying to write a program that will clear the saved data for RPG's with 512kbit flash ram save packs. Just writting values to 0x0E000000 doesn't seem to work. Anybody know how to write to the flash ram? (The program is in RAM and then I insert the cart that I want to clear).<br/>_________________<br/>"head straight for your goal by any means
<br/>
there is a door that you've never opened
<br/>
there is a window with a view you've never seen
<br/>
get there no matter how long it takes"
<br/>
<br/>
-Theme of Shadow, Sonic Adventure 2</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16181 - tepples - Tue Feb 10, 2004 6:50 am</h4>
    <div class="postbody"><span class="postbody">GBA games with flash save use Sanyo flash or Atmel flash. Reading flash appears to be identical to reading SRAM. <a class="postlink" href="http://www.atmel.com/dyn/resources/prod_documents/DOC0510.PDF" target="_blank">This PDF describes Atmel's writing protocol</a>. Can anybody dig up information about Sanyo's write handshake?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16189 - torne - Tue Feb 10, 2004 2:36 pm</h4>
    <div class="postbody"><span class="postbody">I wrote this for flash/eeprom/sram a while ago but unfortunately I then destroyed my root filesystem while doing stupid things (repartitioning a live HD while i'm both running an OS off it, and accessing it using raw emulation in VMware). Writing to flash is done in blocks, which must first be erased (there's also an eraseall call) and ideally verified afterward. I don't have the documentation on how to do it because that was on the same filesystem; I was clean-room reverse engineering (legal in pretty much any jurisdiction) the official N backup library and will hopefully find time to restart this work soon.
<br/>
<br/>
In the meantime, you could try disassembling a commercial ROM (legal in most places for educational purposes) and having a look at how they do it. The save code is in the general vicinity of the save type identifier string.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16492 - loading - Tue Feb 17, 2004 10:34 pm</h4>
    <div class="postbody"><span class="postbody">in case you're still interested:
<br/>
<br/>
Write Byte to Flash:
<br/>
Write 0xAA to 0x0A005555
<br/>
Write 0x55 to 0x0A002AAA
<br/>
Write 0xA0 to 0x0A005555
<br/>
Write your byte to the address you want. Wait a short time and write an other byte.
<br/>
<br/>
Delete Block (0x1000 bytes, note you'll need to delete before writing):
<br/>
Write 0xAA to 0x0A005555
<br/>
Write 0x55 to 0x0A002AAA
<br/>
Write 0x80 to 0x0A005555
<br/>
Write 0xAA to 0x0A005555
<br/>
Write 0x55 to 0x0A002AAA
<br/>
Write 0x30 to 0x0A00X000 (where X = your Block)
<br/>
Write your byte to the address you want. Wait a little longer.
<br/>
<br/>
Select Upper/Lower 64k
<br/>
Write 0xAA to 0x0A005555
<br/>
Write 0x55 to 0x0A002AAA
<br/>
Write 0xB0 to 0x0A005555
<br/>
Write 0x0X to 0x0A000000 (where X = 0 or 1)
<br/>
wait some time.
<br/>
<br/>
Note waiting is not neccesarry on most emulators but you'll need to do it if you're writing to a real flash chip. I was unable to figure out the exact times (not enough reversing skills :( )  but it does the job.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16501 - ampz - Wed Feb 18, 2004 1:01 am</h4>
    <div class="postbody"><span class="postbody">loading: Nintendo use at least six different types of flash memories. The command sequences are different for each type. Games are required to support all types of the correct size. (The N library takes care of this)
<br/>
You do not just wait for the flash memory to complete it's task. You poll it until ready.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
