<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>MODE 4 line drawing - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > MODE 4 line drawing</h2>
<div id="posts">
<div class="post">
    <h4>#7244 - hnager - Fri Jun 13, 2003 2:42 am</h4>
    <div class="postbody"><span class="postbody">this seems to work, but after rotating the polygon I can't get it to draw a completely straight vertical line as part of the shape, even if it's a square. THe lines are stright except for a pixel or 2.
<br/>
<br/>
void BLine(int x0, int y0, int x1, int y1, unsigned char color){
<br/>
<br/>
	int dx, dy, x_inc, y_inc, error=0, index, x, y;
<br/>
<br/>
	u16* vidMem;
<br/>
	x = x0;
<br/>
	y = y0;
<br/>
<br/>
	dx = x1-x0;
<br/>
	dy = y1-y0;
<br/>
<br/>
	if (dx&gt;0){
<br/>
		x_inc = 1;
<br/>
	}else{
<br/>
		x_inc = -1;
<br/>
		dx = -dx;
<br/>
	}
<br/>
<br/>
	if (dy&gt;0){
<br/>
		y_inc = 1;
<br/>
	}else{
<br/>
<br/>
		y_inc = -1;
<br/>
		dy = -dy;
<br/>
	}
<br/>
<br/>
	if(dx&gt;dy){
<br/>
<br/>
		for(index=0; index&lt;=dx; index++){
<br/>
<br/>
			vidMem = &amp;VideoBuffer[  ((y*240) + x)&gt;&gt;1 ]; 
<br/>
<br/>
			 if(x % 2) 
<br/>
				*vidMem = (*vidMem &amp; 0x00FF) | (color&lt;&lt;8); 
<br/>
			 else 
<br/>
				*vidMem = (*vidMem &amp; 0xFF00) | color;
<br/>
<br/>
			error+=dy;
<br/>
<br/>
			if(error&gt;dx){
<br/>
				error-=dx;
<br/>
				y+=y_inc;
<br/>
			}
<br/>
			x+=x_inc;
<br/>
<br/>
		}
<br/>
	} else {
<br/>
		for(index=0; index &lt;=dy; index++){
<br/>
<br/>
			vidMem = &amp;VideoBuffer[  ((y*240) + x)&gt;&gt;1 ]; 
<br/>
<br/>
			 if(x % 2) 
<br/>
				*vidMem = (*vidMem &amp; 0x00FF) | (color&lt;&lt;8); 
<br/>
			 else 
<br/>
				*vidMem = (*vidMem &amp; 0xFF00) | color;
<br/>
<br/>
			error+=dx;
<br/>
<br/>
			if(error&gt;0){
<br/>
				error -= dy;
<br/>
				x+=x_inc;
<br/>
			}
<br/>
			y+=y_inc;
<br/>
		}
<br/>
	}
<br/>
<br/>
}</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
