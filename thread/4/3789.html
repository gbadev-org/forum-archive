<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Mysterious IWRAM padding. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Mysterious IWRAM padding.</h2>
<div id="posts">
<div class="post">
    <h4>#24074 - cosmic4z - Tue Jul 27, 2004 2:03 pm</h4>
    <div class="postbody"><span class="postbody">I've recently changed the makefile of my project and now all my IWRAM data variables are being padded.
<br/>
<br/>
Just about all the following variables are u32 / s32 (BG0 &amp; BG1 are structures).
<br/>
<br/>
The following is a portion of my mapfile.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
COMMON         0x03000fa0      0x184 help.o
<br/>
                                  0x0 (size before relaxing)
<br/>
                0x03000fa0                HELP_SI_used
<br/>
                0x03000fc0                HELP_SI
<br/>
                0x030010e0                HELP_pAnim
<br/>
                0x03001100                HELP_pText
<br/>
                0x03001120                HELP_XRAM_pRewind
<br/>
 *fill*         0x03001124       0x1c 00
<br/>
 COMMON         0x03001140      0x124 BG.o
<br/>
                                  0x0 (size before relaxing)
<br/>
                0x03001140                BGI_Index
<br/>
                0x03001160                BG_pChars
<br/>
                0x03001180                BG0
<br/>
                0x030011c0                BG1
<br/>
                0x03001200                BGI_Height
<br/>
                0x03001220                BGI_Width
<br/>
                0x03001240                BG_pBanks
<br/>
                0x03001260                BG_pWMap
<br/>
 *fill*         0x03001264       0x1c 00
<br/>
 COMMON         0x03001280      0x5a4 SE.o
<br/>
                                  0x0 (size before relaxing)
<br/>
                0x03001280                SE_TotalSI
<br/>
                0x030012a0                SE_ScriptSI
<br/>
                0x030012c0                SE_iRemove
<br/>
                0x030012e0                SE_Trigger
<br/>
                0x030016e0                SE_pAutoTriggers
<br/>
                0x03001700                SE_Frame
<br/>
                0x03001720                SE_pSI
<br/>
                0x03001740                SE_pStep
<br/>
                0x03001760                SE_UserSI
<br/>
                0x03001780                SE_Remove_pSI
<br/>
                0x03001800                SE_pScript
<br/>
                0x03001820                SE_pInitSI
<br/>
 *fill*         0x03001824       0x1c 00
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I am now using a makefile - link script combo (compliing / linking with devkitadv).
<br/>
<br/>
How come IWRAM is being padded like this ? ... Is it something in the link script ?<br/>_________________<br/>Qwak - <a href="http://www.qwak.co.uk" target="_blank">www.qwak.co.uk</a> | Forum - <a href="http://www.qwak.co.uk/forum/" target="_blank">www.qwak.co.uk/forum/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24082 - Miked0801 - Tue Jul 27, 2004 6:09 pm</h4>
    <div class="postbody"><span class="postbody">Yes it is the link scripts - and if you figure out how to fix it, please let me know :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24096 - col - Tue Jul 27, 2004 10:06 pm</h4>
    <div class="postbody"><span class="postbody">Can you post some more details.
<br/>
<br/>
Which version of Devkitadv?
<br/>
Are you using the default crt0.o and lnkscript files?
<br/>
What are the linker and compiler options in your makefile?
<br/>
fwiw, I am using Devkitadv-r5-beta-3 with the default lnkscript and crt0.o. The only change is that crt0.o has been recompiled with different stack offsets. With this setup, I'm getting no padding in globals or static class members. 
<br/>
<br/>
cheers
<br/>
<br/>
Col</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#24131 - cosmic4z - Wed Jul 28, 2004 10:41 am</h4>
    <div class="postbody"><span class="postbody">Sure thing Miked0801.
<br/>
<br/>
col - I am using:
<br/>
<br/>
DEVKIT:
<br/>
Devkit Advance 5 beta 3.
<br/>
<br/>
LINK SCRIPT:
<br/>
Linker Script v1.2 by Jeff Frohwein
<br/>
<br/>
CRT0:
<br/>
crt0.S v1.26 by Jeff Frohwein (modified by James Daniels/Apex Design for AAS).
<br/>
<br/>
COMPILE FLAGS:
<br/>
CFLAGS = -ggdb -mthumb-interwork -fomit-frame-pointer -mapcs-32 -mcpu=arm7tdmi -ffast-math -fno-exceptions -fno-rtti
<br/>
THUMB = -mthumb -O -ffixed-r14 -funroll-loops
<br/>
<br/>
LINK FLAGS:
<br/>
LDFLAGS = -mthumb-interwork -Xlinker -Map $(MAP) -nostartfiles -Tlnkscript
<br/>
<br/>
<br/>
<br/>
I can post the full versions of any of the above if anyone thinks that will help.
<br/>
<br/>
I will also post the fix should I find one.
<br/>
<br/>
- Jamie.<br/>_________________<br/>Qwak - <a href="http://www.qwak.co.uk" target="_blank">www.qwak.co.uk</a> | Forum - <a href="http://www.qwak.co.uk/forum/" target="_blank">www.qwak.co.uk/forum/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
