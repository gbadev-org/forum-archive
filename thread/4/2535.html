<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Voxel landscapes - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Voxel landscapes</h2>
<div id="posts">
<div class="post">
    <h4>#13860 - shadez - Wed Dec 24, 2003 1:12 am</h4>
    <div class="postbody"><span class="postbody">Hello.
<br/>
<br/>
Since I'm know sure that realtime voxel landscapes are possible on gba, does anyone know any good papers about programming them (well, also algorithmical papers)? Or even explain the technique here shortly? I have 3d experience with polygons, but voxels seem to be from other world :(
<br/>
<br/>
Thanks and merry christmas :)
<br/>
<br/>
- shadez</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13877 - f00l - Wed Dec 24, 2003 10:11 am</h4>
    <div class="postbody"><span class="postbody">yeah .. I would like to know some tips too.. 
<br/>
<br/>
what I have this far :
<br/>
<br/>
Mode5 (rot)
<br/>
a Line draw function
<br/>
a render function
<br/>
<br/>
I can show a little mountain.
<br/>
people told me that voxel's don't need any perspective,
<br/>
is that right ?  the only thing you have to do is drawing smaller
<br/>
lines if it has to look "far" away.
<br/>
<br/>
anywayz.. I would like to have some tips on making it faster :)<br/>_________________<br/>woei!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13878 - shadez - Wed Dec 24, 2003 11:28 am</h4>
    <div class="postbody"><span class="postbody">f00l, please tell everything you know about this algorithm, I _may_ be able to point out some optimizations. Because I have absolutely nothing (no idea howto do so-called 3d pixels).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13888 - tepples - Wed Dec 24, 2003 5:32 pm</h4>
    <div class="postbody"><span class="postbody">First, make a simple Wolf3d-style raycaster engine with flat shading instead of texture mapping. Then make one where each map space can have a height. Now you have a Comanche-style height map engine.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13907 - shadow_gg - Wed Dec 24, 2003 8:26 pm</h4>
    <div class="postbody"><span class="postbody">that just like drawing an image into a trapeze
<br/>
had done one and it works fast
<br/>
good luck</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13940 - shadez - Thu Dec 25, 2003 11:11 am</h4>
    <div class="postbody"><span class="postbody">Ok, thanks for replies. I'm trying to figure out something</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13941 - f00l - Thu Dec 25, 2003 12:04 pm</h4>
    <div class="postbody"><span class="postbody">shadez... here's the cool part of voxels : there are no 3D pixel !!!!
<br/>
<br/>
Everybody is talking about 3D pixels (also in tutorials) but the fact is
<br/>
that you draw lines! something like this :
<br/>
<br/>
map=
<br/>
010
<br/>
121
<br/>
010 
<br/>
<br/>
that would look like this ingame :
<br/>
<br/>
0*00
<br/>
* * *
<br/>
<br/>
here's a line draw function I'm using :
<br/>
<br/>
draw_vline(int x,int y,int l, int c)
<br/>
{
<br/>
  int i;
<br/>
  int o=160*x+y;
<br/>
  for(i=0; i&lt;l; i++)
<br/>
  ((unsigned short*)0x6000000)[o+i]=c;
<br/>
}
<br/>
<br/>
now you need a raycast-like function so you can render the map :)<br/>_________________<br/>woei!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13945 - sajiimori - Thu Dec 25, 2003 5:21 pm</h4>
    <div class="postbody"><span class="postbody">The function you posted would actually draw horizontal lines.  Here's one that draws a vertical line in mode 3, with a faster approach.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define VRAM ((u16*)0x6000000)
<br/>
#define TIMES_240(x) (((x) &lt;&lt; 8) - ((x) &lt;&lt; 4))
<br/>
<br/>
faster_and_hopefully_correct_vline(int x, int y, int l, int c)
<br/>
{
<br/>
    register u16* p = VRAM + TIMES_240(y) + x;
<br/>
    register u16* end = p + TIMES_240(l);
<br/>
    register u16 rc = c;
<br/>
<br/>
    while(p &lt; end)
<br/>
    {
<br/>
        *p = rc;
<br/>
        p += 240;
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#13947 - f00l - Thu Dec 25, 2003 6:11 pm</h4>
    <div class="postbody"><span class="postbody">yeah ..  drawing horizontal  is faster then vertical.. and the voxel stuff runs in Mode5 (I rotated it and stretch it) so it's pretty fast this way :D<br/>_________________<br/>woei!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14009 - sajiimori - Sat Dec 27, 2003 9:27 am</h4>
    <div class="postbody"><span class="postbody">Oh, well your function is named "vline" so I assumed it was supposed to draw vertical lines.
<br/>
<br/>
Anyway, the approach is slow regardless of what mode it runs in.  Avoid the repetitive array access and addition by using pointers.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14014 - f00l - Sat Dec 27, 2003 12:31 pm</h4>
    <div class="postbody"><span class="postbody">YES!.. you are right.. at first it looks pretty fast, but now, when I load bigger landscapes it become's slow .. I will try to use your version :)<br/>_________________<br/>woei!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14047 - Maddox - Sun Dec 28, 2003 10:41 am</h4>
    <div class="postbody"><span class="postbody">You guys crack me up!<br/>_________________<br/>You probably suck.  I hope you're is not a game programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14678 - MrMr[iCE] - Sat Jan 10, 2004 11:04 pm</h4>
    <div class="postbody"><span class="postbody">Here's an idea:
<br/>
<br/>
You can use the vertical line idea with the speed of horizontal lines by rotating the background 90 degrees. Just tweak the bg rotation registers to flip the screen on its side. So while you raycast the landscape from left to right and figure out what lines to draw vertically, you're really drawing the lines horizontally in vram. In mode 4 you can plot 4 pixels at a time with a single word write, so theres lots of room for improvement there.
<br/>
<br/>
I posted a demo a few months ago that does a split screen and tweaks the bitmap bg so it's flipped on its side: <a class="postlink" href="http://gbadev.org/demos.php?year=03&amp;month=04" target="_blank">Tweakmode 3d.</a>
<br/>
<br/>
I also posted an asm version that does the same trick: <a class="postlink" href="http://gbadev.org/demos.php?year=03&amp;month=06" target="_blank">ASM Tweakmode Demo</a><br/>_________________<br/>Does the corpse have a familiar face?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
