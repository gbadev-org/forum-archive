<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problems compiling with multible .c/.cpp files - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Problems compiling with multible .c/.cpp files</h2>
<div id="posts">
<div class="post">
    <h4>#78983 - Kaiser - Tue Apr 11, 2006 12:30 am</h4>
    <div class="postbody"><span class="postbody">I have 5 files, two cpp files, and three .h files. One h file contains all the register information like video memory definitions etc. I have a source file which contains the main function and the other source file contains a printing function.
<br/>
<br/>
Bascially both source files relies on the .h file with all the register/video defintions. My main function calls the printing funtion. When I try to compile, it complains about multible defintions of the definitions defined in my register/video header file.
<br/>
<br/>
Basically it won't let me call the definitions from my video/register header file from two different source files.
<br/>
<br/>
I appriciate the help. Also I can post the source code if needed.
<br/>
<br/>
Here is my batch file used to compile.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
@echo off
<br/>
REM just add  .c file and  .o file to the next two lines 
<br/>
set SRC=E:\devkitPro\LWizard\Source\
<br/>
set CFILES=%SRC%g_main.cpp %SRC%g_printf.cpp
<br/>
set OFILES=g_main.o g_printf.o
<br/>
<br/>
<br/>
set GAME= LWIZARD
<br/>
set SPECS=gba.specs
<br/>
set OUTPUT=E:\devkitPro\LWizard\LWIZARD.gba
<br/>
<br/>
set DEVDIR=E:\devkitPro
<br/>
set DATADIR=E:\devkitPro\LWizard\Include
<br/>
<br/>
PATH=%DEVDIR%\bin;%path%
<br/>
<br/>
REM set our paths so the linker knows were to look for the libs
<br/>
set LIBDIR= %DEVDIR%\arm-elf\lib\interwork
<br/>
set LIBDIR2= %DEVDIR%\libgba\lib
<br/>
<br/>
REM set our include directories so the compiler can find our include files
<br/>
set INCDIR= %DEVDIR%\arm-elf\include
<br/>
set INCDIR2= %DATADIR%
<br/>
<br/>
REM the compiler and linker flags
<br/>
set CFLAGS= -I.  -I%INCDIR% -I%INCDIR2% -c -g -O2 -Wall -mcpu=arm7tdmi -mtune=arm7tdmi 
<br/>
<br/>
-fomit-frame-pointer -ffast-math -mthumb -mthumb-interwork 
<br/>
<br/>
set LDFLAGS=  -mthumb -mthumb-interwork -specs=%SPECS% -L%LIBDIR% -L%LIBDIR2%  
<br/>
<br/>
REM Compile the cfiles
<br/>
E:\devkitPro\devkitARM\bin\arm-elf-gcc.exe  %CFILES% %CFLAGS%
<br/>
<br/>
REM link the o files
<br/>
E:\devkitPro\devkitARM\bin\arm-elf-gcc.exe -o %GAME%.elf  %OFILES% %LDFLAGS% 
<br/>
<br/>
REM gcc produces .elf exicutables...objcopy to .gba
<br/>
E:\devkitPro\devkitARM\bin\arm-elf-objcopy.exe -v -O binary %game%.elf %OUTPUT%
<br/>
<br/>
E:\devkitPro\devkitARM\bin\gbafix.exe %OUTPUT%
<br/>
<br/>
REM remove all the ofiles
<br/>
del %game%.elf
<br/>
<br/>
pause
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78989 - poslundc - Tue Apr 11, 2006 12:45 am</h4>
    <div class="postbody"><span class="postbody">Post the error you are getting.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#78990 - Kaiser - Tue Apr 11, 2006 12:51 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://vault.d3files.com/temp/Untitled-1.png">[Images not permitted - Click here to view it]</a>
<br/>
<br/>
just to let you know oamPtr, bakPtr etc are all defined on that same .h file.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#79000 - poslundc - Tue Apr 11, 2006 2:03 am</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=8820" target="_blank">Don't put data in your header files.</a>
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#79002 - Kaiser - Tue Apr 11, 2006 2:04 am</h4>
    <div class="postbody"><span class="postbody">haha and I was just looking at that thread though a search too.
<br/>
<br/>
Thanks.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
