<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprite coordinates and scaling issues - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Sprite coordinates and scaling issues</h2>
<div id="posts">
<div class="post">
    <h4>#10465 - poslundc - Fri Sep 05, 2003 9:08 pm</h4>
    <div class="postbody"><span class="postbody">OK, so I have a situation where I want to create a sense of perspective by showing a sprite smaller if it's further away from the player and larger if it's closer.
<br/>
<br/>
The problem I'm having is that the sprite's coordinates in OAM represent the upper-left corner of the sprite, and as I scale the sprite downwards it shrinks towards the centre of the 32x32 area the sprite holds. This means that if I want to keep the character's "feet" planted on the same y-coordinate, I need to manually adjust the y-coordinate of the sprite.
<br/>
<br/>
Even worse is if I scale the sprite upwards, in which case I need to invoke SIZE_DOUBLE and adjust both the y-coordinate and x-coordinate by (dimension / 2) just to keep the new sprite centred over the old sprite.
<br/>
<br/>
I can do all of this if need be... I'm just wondering if there's a better way. For that matter, is there any penalty if I decide to just leave SIZE_DOUBLE on for the sprites that need scaling (it'll be about 20 sprites altogether)?
<br/>
<br/>
Thanks,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10467 - sajiimori - Fri Sep 05, 2003 10:54 pm</h4>
    <div class="postbody"><span class="postbody">It sounds like you have the right idea.  However, it would be difficult to adjust the screen coordinates of a sprite every time it moved in the world.  So, instead of storing the screen coordinates of a sprite, store its position in the world, then generate its scale and screen coordinates on a frame-by-frame basis.
<br/>
<br/>
I don't know of any penalty of having SIZE_DOUBLE on all the time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10472 - tepples - Sat Sep 06, 2003 1:29 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">I don't know of any penalty of having SIZE_DOUBLE on all the time.</td> </tr></table><span class="postbody">
<br/>
There are only about 950 sprite pixels available on each scanline. A scaled sprite uses three times as many sprite pixels as an unscaled sprite; a doubled scaled sprite uses double that, for a total of six times. If the display controller runs out of sprite pixels, it will drop some sprites on that line. (This is the cause of the flicker on NES games; the NES supported only 64 sprite pixels per scanline.)
<br/>
<br/>
<a class="postlink" href="http://www.work.de/nocash/gbatek.htm#lcdobjoverview" target="_blank">Details in gbatek</a>.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10476 - sgeos - Sat Sep 06, 2003 2:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">I don't know of any penalty of having SIZE_DOUBLE on all the time.</td> </tr></table><span class="postbody">
<br/>
There are only about 950 sprite pixels available on each scanline. A scaled sprite uses three times as many sprite pixels as an unscaled sprite; a doubled scaled sprite uses double that, for a total of six times.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Would having your scaled sprites SIZE_DOUBLEed all the time result in more battery usage?  If so, is the increase significant?
<br/>
<br/>
-Brendan Sechter</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10500 - sajiimori - Sat Sep 06, 2003 5:23 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the info, tepples.
<br/>
<br/>
With that limitation in mind, you'll probably want to make sure sprites are never dropped.  The easiest way to do that is to figure out a worst-case scenario, with the most sprites you'll ever want on screen, and all of them as close as they can get.
<br/>
<br/>
If sprites are dropped at that point, you can either:
<br/>
<br/>
- reduce your maximum number of sprites,
<br/>
- automatically drop sprites that are closer than a certain distance,
<br/>
- or (more difficult and not as logical) make sure that only some of them can get close to the camera.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
