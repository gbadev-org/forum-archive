<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Blending a background against sprites. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Blending a background against sprites.</h2>
<div id="posts">
<div class="post">
    <h4>#21726 - Lord Graga - Thu Jun 03, 2004 11:23 pm</h4>
    <div class="postbody"><span class="postbody">Hey all!
<br/>
<br/>
I have a problem: I can't get REG_BLDMOD set correct so that it blends background 0 against the sprites behind it (they have higher priority) (I want it to fade in and out).
<br/>
<br/>
Could anyone please supply me with a code example of how to do that?
<br/>
<br/>
I am totally lost!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21730 - dagamer34 - Fri Jun 04, 2004 12:51 am</h4>
    <div class="postbody"><span class="postbody">Sorry, I can't provide you with a code sample but I will try to help.
<br/>
<br/>
Are you setting the REG_COLEV(*(vu16*)0x4000052) register? It controls the actual blending levels. Take a look at the CowBite Spec to see how to set the register.
<br/>
<br/>
Can you tell us what is happening or give us a picture to help explain your problem?<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21738 - johnny_north - Fri Jun 04, 2004 4:52 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   
<br/>
REG_BLDMOD = (BIT2|BIT6|BIT8);
<br/>
while(i&lt;16){
<br/>
      if(Timer - timer &gt; 40){
<br/>
         REG_COLEV= i&lt;&lt;8|15-i;
<br/>
         timer = Timer;
<br/>
         i++;
<br/>
      }
<br/>
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
This code will make bg2 transparently fade against bg0.
<br/>
<br/>
This snipet sets the blend mode to 1 (bit 6 - transparency), the first target of the register to bg2 (bit 2) and the second target to bg0 (bit 8). I've chosen to use REG_COLEV to control the blening. The first 4 bits of this register control the transparency level of the first target of REG_BLDMOD.  Bits 8-12 control the level of the second target of REG_BLDMOD. 
<br/>
<br/>
I haven't thouroughly experimented yet, but REG_COLEY might be use for mode 2 and 3.
<br/>
<br/>
It appears that mode 0 will blend sprites to the 2nd target if they are above the 2nd target.
<br/>
<br/>
Mode 2 and 3 appear to be fade in and out modes respectively. The PERN project contains a table of these values with a small explanation.
<br/>
<br/>
BTW - using windows seemed to disable the ability to blend at all. Maybe someone here can confirm or deny.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21739 - tepples - Fri Jun 04, 2004 5:56 am</h4>
    <div class="postbody"><span class="postbody">You need to set separate blending bits for what's inside the windows.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#21748 - Cearn - Fri Jun 04, 2004 9:19 am</h4>
    <div class="postbody"><span class="postbody">You can also read up on blending <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/gfx.htm#blend" target="_blank">here</a>. This also mentions the specific window/blend flags Tepples mentioned, and has a sample for download (see bottom of page)
<br/>
Note that priorities can also mess up blending, try switching source and target layers. And remember that blending with sprites is messy overall (see fig 2).</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
