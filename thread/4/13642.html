<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>display character size...(quite urgent..) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > display character size...(quite urgent..)</h2>
<div id="posts">
<div class="post">
    <h4>#134256 - mk2007 - Thu Jul 12, 2007 2:24 am</h4>
    <div class="postbody"><span class="postbody">Hi friends,
<br/>
<br/>
i have a function in my program to dispaly the character with color  whatever  i put..
<br/>
<br/>
the code is following..
<br/>
<br/>
<br/>
void printfC(u32 address, u8 x, u8 y, char *str, enum COLOUR colour)
<br/>
<br/>
//address - destination address (i.e.: map address)
<br/>
//x, y    - co-ordinate determines location in array
<br/>
<br/>
// (0,0) = 0;  (1,0) = 1;  ... (29,0) = 29;  (30,0) = 30;  (31,0) = 31; 
<br/>
// (0,1) = 32; (1,1) = 33; ... (29,1) = 61;  (30,1) = 62;  (31,1) = 63; 
<br/>
// (0,2) = 64; (1,2) = 65; ... (29,2) = 93;  (30,2) = 94;  (31,2) = 95; 
<br/>
// (0,3) = 96; (1,3) = 97; ... (29,3) = 125; (30,3) = 126; (31,3) = 127; 
<br/>
// so (x,y) = (x + (y * 32));
<br/>
{
<br/>
	if (strlen(str) == 0)
<br/>
		return;
<br/>
<br/>
<br/>
	u16 *pDst;
<br/>
	pDst = (u16*)address;
<br/>
<br/>
	u16 location;
<br/>
<br/>
	location = (x + (y * 32));
<br/>
<br/>
	u16 len = strlen(str) + location;
<br/>
	u8 value;
<br/>
<br/>
	for (u16 i = location; i &lt; len; i++)
<br/>
	{
<br/>
		if (*str == 32)
<br/>
			value = (*str - 32);
<br/>
		else if (((*str) &gt;= 48) &amp;&amp; ((*str) &lt;= 57))
<br/>
		{
<br/>
			value = *str;
<br/>
<br/>
			switch (colour)
<br/>
			{
<br/>
			case GREEN:
<br/>
				value += 73; //121 - 48
<br/>
				break;
<br/>
			case RED:
<br/>
				value += 109;
<br/>
				break;
<br/>
			case BLUE:
<br/>
				value += 145;
<br/>
				break;
<br/>
			}			
<br/>
		}
<br/>
		else
<br/>
		{
<br/>
			value = *str;
<br/>
<br/>
			switch (colour)
<br/>
			{
<br/>
			case GREEN:
<br/>
				value += 30; //95 - 65
<br/>
				break;
<br/>
			case RED:
<br/>
				value += 66;
<br/>
				break;
<br/>
			case BLUE:
<br/>
				value += 102;
<br/>
				break;
<br/>
			}			
<br/>
		}
<br/>
		pDst[i] = value;
<br/>
		str++;
<br/>
	}
<br/>
<br/>
}
<br/>
<br/>
i am using this in my game boy program..
<br/>
<br/>
by this function i can display the  character with color..
<br/>
<br/>
but i want to display my character as big size..how to i display my character in the screen as  big size then now..
<br/>
<br/>
is there any function to make character big to display..
<br/>
<br/>
is there any formula to display the character as big then now.??
<br/>
<br/>
<br/>
please if u have any example coding or any information regarding this..
<br/>
<br/>
please forward me..
<br/>
<br/>
this is quite urgent..
<br/>
<br/>
waiting for  your valuable reply..
<br/>
<br/>
<br/>
with regarding,
<br/>
kar..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134310 - gmiller - Thu Jul 12, 2007 1:00 pm</h4>
    <div class="postbody"><span class="postbody">Typically in the bitmap modes the character would be "described" by a font that gives pixel layout that you can use to turn your pixes to the color you built.  Depending how the font information is built you just need to iterate over the rows and columns to "paint" the character.  There are many ways to store the font so I will not say one is right or wrong.  For my 8x8 fonts I use a bit for each pixel so the font information is one byte per column (8 bits) and since there are 8 rows the total size is 8 bytes per character in the font.
<br/>
<br/>
The code is pretty simple to implement with a set of loops, one for the number of rows, and the inner loop looping for the number of columns.  If the bit is on in the font then turn the pixel on or turn the pixel off.
<br/>
<br/>
Tile modes are a little trickier and need a set of "tiles" with the characters in it and then change the map to reference the tile.
<br/>
<br/>
Of course there may be easier ways to do this so I suggest looking at some of the libraries that are out there to see how they did it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134448 - mk2007 - Fri Jul 13, 2007 6:33 am</h4>
    <div class="postbody"><span class="postbody">Hi gmiller,
<br/>
<br/>
Thanks for your reply..
<br/>
<br/>
i am really greatful to you if send me example coding..
<br/>
<br/>
because i am new gameboy and c programming..
<br/>
<br/>
so can u please??
<br/>
<br/>
because i am reallly in deadline..
<br/>
<br/>
waiting for your reply..
<br/>
<br/>
with regards,
<br/>
mk</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134473 - Cearn - Fri Jul 13, 2007 10:00 am</h4>
    <div class="postbody"><span class="postbody">This forum has [code] tags with which you can preserve the formatting of code, making it easier to read. For example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void printfC(u32 address, u8 x, u8 y, char *str, enum COLOUR colour)
<br/>
{
<br/>
    if (strlen(str) == 0)
<br/>
        return;
<br/>
<br/>
    u16 *pDst;
<br/>
    pDst = (u16*)address;
<br/>
    
<br/>
    u16 location;
<br/>
    
<br/>
    location = (x + (y * 32));
<br/>
    
<br/>
    u16 len = strlen(str) + location;
<br/>
    u8 value;
<br/>
    
<br/>
    for (u16 i = location; i &lt; len; i++)
<br/>
    {
<br/>
        if (*str == 32)
<br/>
            value = (*str - 32);
<br/>
        else if (((*str) &gt;= 48) &amp;&amp; ((*str) &lt;= 57))
<br/>
        {
<br/>
            value = *str;
<br/>
            
<br/>
            switch (colour)
<br/>
            {
<br/>
            case GREEN:
<br/>
                value += 73; //121 - 48
<br/>
                break;
<br/>
            case RED:
<br/>
                value += 109;
<br/>
                break;
<br/>
            case BLUE:
<br/>
                value += 145;
<br/>
                break;
<br/>
            }
<br/>
        }
<br/>
        else
<br/>
        {
<br/>
            value = *str;
<br/>
            
<br/>
            switch (colour)
<br/>
            {
<br/>
            case GREEN:
<br/>
                value += 30; //95 - 65
<br/>
                break;
<br/>
            case RED:
<br/>
                value += 66;
<br/>
                break;
<br/>
            case BLUE:
<br/>
                value += 102;
<br/>
                break;
<br/>
            }
<br/>
        }
<br/>
        pDst[i] = value;
<br/>
        str++;
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
There are a few ways in which this code can be cleaned up. I'd like you to consider this (comments on what I did are indicated with "//#'):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// Font data: ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
<br/>
<br/>
// Font base tiles
<br/>
#define ALPHA_TID    95
<br/>
#define DIGIT_TID   (ALPHA_TID+26)
<br/>
<br/>
void printfC(u16 *dst,  //# Use pointers, not raw addresses.
<br/>
    int x,              //# Native datatype is better. int/u32
<br/>
    int y,              //#    when you can, others only when you have to.
<br/>
    const char *str,    //# 'const' if you're not gonna change the data
<br/>
    enum COLOUR colour)
<br/>
{
<br/>
    int ch;             //# Again, ints (or u32 for unsigneds)
<br/>
    u32 value;
<br/>
<br/>
    dst += y*32 + x;    // Adjust destination for location
<br/>
<br/>
    //# There is no need for strlen
<br/>
    while( (ch=*str++) != '\0')
<br/>
    {
<br/>
        // Switch between space/digits/letters, and apply colour.
<br/>
<br/>
        //# See text
<br/>
        if(ch == ' ')                   // Space
<br/>
            value= 0;
<br/>
        else if(ch&gt;='0' &amp;&amp; ch &lt;= '9')   // Digits
<br/>
            value= ch-'0' + DIGIT_TID + colour*36;
<br/>
        else                            // Letters
<br/>
            value= ch-'A' + ALPHA_TID + colour*36;
<br/>
<br/>
        *dst++ = value;
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
I have assumed here that you are have three sets of letters and digits, starting at tile 95 and arranged like [A-Z][0-9]. That would be where GREEN, followed by letters/digits in RED and then BLUE, both at offsets of 26+10 = 36. If I'm incorrect in this, the code will have to be modified a little. Points to note:
<br/>
<ul><li>Addresses are often meaningless; C works with pointers, so pass a pointer, not an address. 
<br/>
</li><li>CPUs have a 'native' datatype, usually represented by 'int'. They are better equipped to deal with that datatype and others can cost a little more work to deal with. ARM chips are 32-bit; 8-bit and 16-bit datatypes can cost between 0% and 100% extra work for the processor, depending on use. Unless you have a compelling reason not to, use int.
<br/>
</li><li>The <a class="postlink" href="http://en.wikipedia.org/wiki/Const" target="_blank">const</a> keyword is a way of saying that the data of that parameter will not be modified. It is recommended (but by no means required) that you use const for pointers parameters - it gives the programmer and the compiler extra information about how the function used that parameter. It also means that you don't have to cast things when passing const items to them. It pretty much <span style="font-style: italic">is</span> required to have graphics/string and other data as const, because otherwise they go into internal work RAM (32kb) instead of ROM where they belong.
<br/>
</li><li>The strlen routine goes through the whole string, looking for the null-character ('\0') when you have to go through the whole string yourself anyway, it's better to search for '\0' yourself.
<br/>
</li><li><a class="postlink" href="http://en.wikipedia.org/wiki/Magic_number_%28programming%29#Magic_numbers_in_code" target="_blank">Magic numbers</a> are bad, mkay? If you hadn't added the "// 95-65" comments, the code would have been a mystery. It's recommended to use "named literals" using "#define" or "static const int ...". In this case, I've used ALPHA_TID (Tile InDex) to indicate the place where the letters start and DIGIT_TID where the digits start. I've also used character constants ' ', '0', '9' and 'A', as this is clearer than the raw ascii numbers.
<br/>
</li><li>When you have if-else-statements or switch-blocks that don't are virtually the same except for a single number or character, they can usually be replaced by arithmetic expressions. The latter are shorter in code, easier to read and faster as well. If it can't be done by arithmetic, it can be done by <a class="postlink" href="http://en.wikipedia.org/wiki/Lookup_table" target="_blank">look-up tables</a>.</li></ul>
<br/>
<br/>
I should also note that instead of using three sets of characters, you could use one set and switch colors by using palette-swapping, as done <a class="postlink" href="http://www.coranac.com/tonc/text/text.htm#img-txt-se1" target="_blank">here</a>). This saves you an extra 72 tiles.
<br/>
<br/>
This is also useful if you want larger characters, say 16x16 instead of 8x8 (if this wasn't what you were after, you have to be clearer in what you mean by 'big size'. If the answer to that does not include multiples of 8, the code will be tricky). With a 16x16 font, you're using 4 tiles/character, so 4*36=144 for a full set, and 432 for all three colors. Unless you use palette swapping.
<br/>
<br/>
For a 16x16 version of what you have now, make the scaled font and convert the bitmap as if they were 16x16 sprites. For any character, the base tile-index will be 'base= ALPHA_BIG_TID + (ch-<span style="font-style: italic">typeoffset</span>)*4'. Then you have to place base, base+1, base+2, base+3 in the map at dst, dst+1, dst+32 and dst+32+1. Example code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define COLOUR_PITCH    (36*4)      //# For pal-swaps, use 0x1000 here
<br/>
#define ALPHA_BIG_TID    ???        //# This will have to change
<br/>
#define DIGIT_BIG_TID   (ALPHA_TID+26*4)
<br/>
<br/>
void printfC16(u16 *dst, int x,  int y,  const char *str, enum COLOUR colour)
<br/>
{
<br/>
    int ch;
<br/>
    u32 base;
<br/>
<br/>
    dst += y*32 + x;    // Adjust destination for location
<br/>
<br/>
    while( (ch=*str++) != '\0')
<br/>
    {
<br/>
        // Switch between space/nums/chars, and apply colour.
<br/>
<br/>
        if(ch == ' ')                           // Space
<br/>
        {
<br/>
            dst[ 0]= 0;     dst[ 1]= 0;
<br/>
            dst[32]= 0;     dst[33]= 0;
<br/>
        }
<br/>
        else
<br/>
        {
<br/>
            base= ch + colour*COLOUR_PITCH;
<br/>
            if(ch &gt;= '0' &amp;&amp; ch &lt;= '9')            // Numbers
<br/>
                base= ch-'0' + DIGIT_BIG_TID;
<br/>
            else                                // Letters
<br/>
                base= ch-'A' + ALPHA_BIG_TID;
<br/>
<br/>
            dst[ 0]= base;      dst[ 1]= base+1;
<br/>
            dst[32]= base+2;    dst[33]= base+3;
<br/>
        }
<br/>
<br/>
        // Move ahead 2 screen entries
<br/>
        dst += 2;
<br/>
    }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#134714 - mk2007 - Mon Jul 16, 2007 3:14 am</h4>
    <div class="postbody"><span class="postbody">Hi Cearn,
<br/>
<br/>
i am really greatful to you for your quick reply..
<br/>
and youf time spent for me..
<br/>
<br/>
now i need to display 16*16 size..
<br/>
bcoz i need to display bigger size character in the screen..
<br/>
<br/>
i think your function is quite useful..
<br/>
<br/>
then one more think is that how to cretae the 
<br/>
caled font and convert the bitmap?? this one i dn't know..if u have already this bitmap..please post to me(we need to convert the bitmap to header file am i right?)).
<br/>
<br/>
<br/>
waiting for your value reply..
<br/>
<br/>
advance thanks fro your kindness and help..
<br/>
<br/>
wit regards,
<br/>
kar..</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
