<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>frames per second - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > frames per second</h2>
<div id="posts">
<div class="post">
    <h4>#16841 - jenswa - Wed Feb 25, 2004 8:13 pm</h4>
    <div class="postbody"><span class="postbody">Most pc games have an option to display the fps in the game.
<br/>
Some gba demo's i've seen have a fps display too.
<br/>
<br/>
My question, how to create a fps display in my own gba demo?
<br/>
Display the counter isn't the problem, but calculating the fps is.
<br/>
Apart from the fact, my demo is synced with WaitForVsync(), i could create a static counter with 60.
<br/>
But that is not what i was looking for.
<br/>
If i comment the WaitForVsync() the function, my demo runs much faster, i want have the frame rate displayed then.
<br/>
<br/>
Any awnsers?
<br/>
<br/>
Jenswa<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16843 - poslundc - Wed Feb 25, 2004 8:46 pm</h4>
    <div class="postbody"><span class="postbody">Since you know that the vertical refresh occurs approximately 60 times per second, you can just use a global variable to count the number of times your code runs in a single frame.
<br/>
<br/>
Then when VBlank arrives, update your FPS display with your counter multiplied by 60. Then reset the counter to zero. (Be careful, if your code is fast enough to run a second time before VBlank is finished then you will have to maintain a flag to know when you are in and out of VBlank.)
<br/>
<br/>
Or if you want, count it over 60 VBlanks to obtain a more precise result, and then don't multiply by 60. Just maintain an additional counter so you know how many VBlanks have gone past before displaying. This is probably a better way, as it will also work if your FPS is less than 60.
<br/>
<br/>
For more accurate results, you could increment your counter every time through the game loop, and then set a timer interrupt to fire after exactly a second has passed. That interrupt then updates a variable that you display every VBlank as the FPS, and then resets the counter to zero.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16856 - jenswa - Wed Feb 25, 2004 11:18 pm</h4>
    <div class="postbody"><span class="postbody">What your saying sounds logicial to me, but i am not sure i am following you.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Since you know that the vertical refresh occurs approximately 60 times per second, you can just use a global variable to count the number of times your code runs in a single frame. </td> </tr></table><span class="postbody">
<br/>
<br/>
Should i put a global variable in my main loop (the stuff between the while(1) ) and increase it every loop, enable vblank interrupt, so when vblank occurs i can display the global variable and after that reset the global variable to zero.
<br/>
<br/>
For more accuracy, i can count the number of vblanks and divide (shouldn't use it too much and the gba) the global variable by the number the vblanks.
<br/>
<br/>
I am not following this part: "use a global variable to count the number of times your code runs in a single frame".<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16866 - tepples - Thu Feb 26, 2004 5:07 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jenswa wrote:</b></span></td> </tr> <tr> <td class="quote">Should i put a global variable in my main loop (the stuff between the while(1) ) and increase it every loop, enable vblank interrupt, so when vblank occurs i can display the global variable and after that reset the global variable to zero.</td> </tr></table><span class="postbody">
<br/>
That's exactly it. However, I'd use a bit of a low-pass filter to smooth out the displayed frame rate over a few frames so that you can display "in-between" rates; otherwise, you will have it jumping back and forth between 60 and 120.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16869 - dagamer34 - Thu Feb 26, 2004 5:13 am</h4>
    <div class="postbody"><span class="postbody">J. Harbor's programming book has example of what tepples is talking about.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16885 - jenswa - Thu Feb 26, 2004 9:42 am</h4>
    <div class="postbody"><span class="postbody">Cool, i am now at school, i'll try it out when i come home later this day.
<br/>
<br/>
Thanks for the explaination.<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16888 - FluBBa - Thu Feb 26, 2004 12:45 pm</h4>
    <div class="postbody"><span class="postbody">In your mainloop you have a global variable that you count up for every loop it does.
<br/>
In your VBlank interrupt you have a variable that you count up by one every VBlank.
<br/>
When the VBlank variable reaches 60, read out the mainloop variable and display it.
<br/>
Now reset both variables.
<br/>
Loop.
<br/>
<br/>
I hope that made any sense  =)<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16889 - jenswa - Thu Feb 26, 2004 12:47 pm</h4>
    <div class="postbody"><span class="postbody">Yup, i thought of that last night when i couldn't sleep, haven't tried it, but should work.
<br/>
<br/>
Thanks<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17191 - Burre - Wed Mar 03, 2004 9:33 am</h4>
    <div class="postbody"><span class="postbody">This might be a little bit OT, but it is a question that have been nagging me for quite some time. How common is it to use 30 Hz instead of 60 Hz? How many of you have that setup? The reason for asking is that I have been calculating on performance hit with my end product and is opting for an 30 Hz (I could really use the runtime). How noticable is the difference? I know it is significantly slower but if the display is synced, will it really matter? Is it really noticable?<br/>_________________<br/>"The best optimizer is between your ears..."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17197 - poslundc - Wed Mar 03, 2004 3:21 pm</h4>
    <div class="postbody"><span class="postbody">This is an interesting question, and something you'd have to experiment with to see.
<br/>
<br/>
According to film theory, persistence of vision can be achieved as low as 12-15 FPS. Video in North America is shot at 30 FPS (NTSC) and in Europe at 25 FPS (PAL).
<br/>
<br/>
So 30 FPS is certainly enough in theory. In practice I personally find (although I haven't tested this on the GBA) that I can still sometimes tell the difference between 30 FPS and a higher framerate, although there are diminishing returns the higher it gets, ie. there's no way I could tell the difference between 48 and 60 FPS.
<br/>
<br/>
I think 60 FPS might be a good choice as a kind of Nyquist rate: if the general audience perceives 30 FPS as fluid motion, double it to ensure they never miss a beat. This might be more important on the GBA than other media, since the player is much closer to the screen than they are to a television set or a movie screen.
<br/>
<br/>
If you want to do stuff at 30 FPS, just make sure you keep in mind that since you need to sustain the image for two frames, you've still only got 68 lines of VBlank (every other frame) in which to update the screen. Let us know if you find a visible difference.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17199 - ampz - Wed Mar 03, 2004 3:56 pm</h4>
    <div class="postbody"><span class="postbody">Movies are 24FPS.
<br/>
<br/>
Another thing to think about is the speed of moving stuff on your screen. If the sprites in your game move at a speed of 30pixels per second, then 60FPS will make no difference at all compared to 30FPS.
<br/>
<br/>
In one game I have been working on the sprites move at 15pixels per second, so I simply use 15FPS.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17201 - poslundc - Wed Mar 03, 2004 5:44 pm</h4>
    <div class="postbody"><span class="postbody">Another thing to keep in mind is that a higher frame rate can naturally provide you with a tighter game loop for more accurate game physics, AI, etc.
<br/>
<br/>
I think that even more than persistence of vision, this is the compelling reason for having a 60 Hz refresh rate.
<br/>
<br/>
Other than that, I'm not even certain <span style="font-style: italic">why</span> the refresh rate of the GBA is 60 Hz. On monitors, etc. it makes sense because your display refresh isn't guaranteed to be synched to the application, so you want to at least double the refresh rate in order to make sure you can achieve 30+ FPS from the software to the screen.
<br/>
<br/>
On the GBA, however, the application is synched to the hardware. If 30 FPS is sufficient, you'd think they'd use it as their refresh rate.
<br/>
<br/>
Dan (now considering the possibility of reducing his game's frame rate and gaining tons more processing time).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17208 - ampz - Wed Mar 03, 2004 7:53 pm</h4>
    <div class="postbody"><span class="postbody">They probably use 60fps just to make the screen flicker free.
<br/>
<br/>
30fps software framerate would save some battery by allowing the GBA to stay in halt mode for longer periods of time...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17210 - XeroxBoy - Wed Mar 03, 2004 10:05 pm</h4>
    <div class="postbody"><span class="postbody">NTSC TVs use 60Hz, right?
<br/>
<br/>
Nintendo probably synched the GBA to that to simplify porting old games. I'm sure PAL gamers can attest to what happens when a lazy developer modifies a game for a different monitor and doesn't properly synch things up.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17211 - Miked0801 - Wed Mar 03, 2004 10:33 pm</h4>
    <div class="postbody"><span class="postbody">NTSC is 30Hz Interlaced - 60 hz even lines, 60 Hz odd so overall of 30Hz.  PAL is 25Hz - 50Hz every othe line but with no overscan so you have more area to display stuff :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17213 - ampz - Thu Mar 04, 2004 12:40 am</h4>
    <div class="postbody"><span class="postbody">Overscan?
<br/>
PAL have more area (higher resolution) because of the lower refreshrate.
<br/>
<br/>
Old games (like SNES games) must operate with 25FPS / 30FPS due to the interlacing.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17214 - poslundc - Thu Mar 04, 2004 12:44 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">NTSC is 30Hz Interlaced - 60 hz even lines, 60 Hz odd so overall of 30Hz.</td> </tr></table><span class="postbody">
<br/>
<br/>
Actually, this also answers my question of why the GBA is 60 Hz... it also interlaces (more-or-less) to an effective 30 Hz.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17222 - FluBBa - Thu Mar 04, 2004 11:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">Old games (like SNES games) must operate with 25FPS / 30FPS due to the interlacing.</td> </tr></table><span class="postbody">
<br/>
No way. Yes the SNES can supply an interlaced signal to the TV, but it doesn't have to and not many games use it.
<br/>
<span style="text-decoration: underline">And</span> even when sending an interlaced signal you can still update your graphics at 50/60FPS and see it.<br/>_________________<br/>I probably suck, my not is a programmer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17253 - Burre - Fri Mar 05, 2004 2:23 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">This is an interesting question, and something you'd have to experiment with to see.
<br/>
<br/>
According to film theory, persistence of vision can be achieved as low as 12-15 FPS. Video in North America is shot at 30 FPS (NTSC) and in Europe at 25 FPS (PAL).
<br/>
<br/>
So 30 FPS is certainly enough in theory. In practice I personally find (although I haven't tested this on the GBA) that I can still sometimes tell the difference between 30 FPS and a higher framerate, although there are diminishing returns the higher it gets, ie. there's no way I could tell the difference between 48 and 60 FPS.
<br/>
<br/>
I think 60 FPS might be a good choice as a kind of Nyquist rate: if the general audience perceives 30 FPS as fluid motion, double it to ensure they never miss a beat. This might be more important on the GBA than other media, since the player is much closer to the screen than they are to a television set or a movie screen.
<br/>
<br/>
If you want to do stuff at 30 FPS, just make sure you keep in mind that since you need to sustain the image for two frames, you've still only got 68 lines of VBlank (every other frame) in which to update the screen. Let us know if you find a visible difference.
<br/>
<br/>
Dan.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah I know about the Vblank issue, but thanks for reminding me. I'm only using it for data transfer to VRAM so it works fine. I've heard earlier that about 20 (which is close to your estimated 12-15) is the limit to feel animation so I'm not worried about that. But I'm not sure how smooth it will look and feel. One should probably not think 30 fps movie and 30 fps game as equal either since the frames in movies are "blurred" during intense movement and games are static images. In that way, a movie and a game at the same Hz will look different.
<br/>
<br/>
I will definately look in to it and give feedback on the issue. I just have to reorganize my draw and update fuctions properly, and then I'll test it for visual differences on actual hardware. I'll get back to you on that after my mid term exams. 388 lines of calculations *drool*.<br/>_________________<br/>"The best optimizer is between your ears..."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17433 - ampz - Mon Mar 08, 2004 2:16 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>FluBBa wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">Old games (like SNES games) must operate with 25FPS / 30FPS due to the interlacing.</td> </tr></table><span class="postbody">
<br/>
No way. Yes the SNES can supply an interlaced signal to the TV, but it doesn't have to and not many games use it.
<br/>
<span style="text-decoration: underline">And</span> even when sending an interlaced signal you can still update your graphics at 50/60FPS and see it.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I did a quick search. You are right.
<br/>
The SNES had a resolution of 256x224. This means the SNES simply treat the TV as a 50/60Hz non-interlaced monitor at the expense of cutting the resolution in half.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17826 - Burre - Mon Mar 15, 2004 3:17 pm</h4>
    <div class="postbody"><span class="postbody">I'm back from mid-term exams and have tried to alter the fps. Imho 30 fps is to slow when moving a lot of gfx simultaneously, it wasn't a viable solution for us, so we're probably aiming at 60 fps. Obj movement looked ok, but mapscrolling looked awful in our demo. So I guess 60 is the way to go...<br/>_________________<br/>"The best optimizer is between your ears..."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17838 - Miked0801 - Mon Mar 15, 2004 6:30 pm</h4>
    <div class="postbody"><span class="postbody">Um.  We run an RPG at 30Hz without issue here.  You're really gonna hamstring yourself trying to stay at 60Hz.  Look a bit closer.  Perhaps your game was fluctuating 60,30,60,20,60,etc.  at looke gittery because of it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17856 - Burre - Tue Mar 16, 2004 1:37 am</h4>
    <div class="postbody"><span class="postbody">Well it all depends. How fast are you moving sprites and BG around? Our game is a space/adventure so movements are quite intense. Sure it might be "regular" glitches, but I doubt it.
<br/>
<br/>
What about triggering vblank at even 60Hz (with IRQ) and letting gameplay calculations reside inside the vdraw and letting it "overflow" it's timeframe when needed. Would that be a worse solution? It would mean updating every/every-other frame, but only slowing down when needed.<br/>_________________<br/>"The best optimizer is between your ears..."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#17879 - OptiRoc - Tue Mar 16, 2004 2:27 pm</h4>
    <div class="postbody"><span class="postbody">The difference between 30 and 60 fps is very pronounced, even on a GBA display. For an example, compare Wai Wai Racing with Super Mario Kart SC. Konami uses the extra processing time for a more advanced camera routine, but I can't say it's worth the trade-off.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
