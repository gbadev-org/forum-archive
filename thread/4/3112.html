<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>displaying coins in a game - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > displaying coins in a game</h2>
<div id="posts">
<div class="post">
    <h4>#18339 - jenswa - Wed Mar 24, 2004 2:58 pm</h4>
    <div class="postbody"><span class="postbody">I want to use coins in my game,
<br/>
<br/>
so i thought of the following structure,
<br/>
the coins will have an x and y position (integer) and a boolean to check wether it was taken by the player or not.
<br/>
I display a maximum number of coins on the screen, 10 coins is the max currently.
<br/>
So there could be a hundred coins in a level, but only 10 can be on screen.
<br/>
<br/>
So i wrote this code (see: zip-file)
<br/>
to display a max of tens coins on the screen, i started out with less coins, like 4 as the max first, then 8, then 10.
<br/>
And i had 20 coins in the level, this was working for me. So the code worked fine, i increased the number of coins in te level
<br/>
to 100 and that didn't work. So i decreased it to 40, that works. So i then increased to 60 and that didn't work.
<br/>
Now the maximum number of coins for a level is stuck at 40 (actually 45).
<br/>
<br/>
The problem which arises when i go above 45, first of all the file compiles fine, but when i run it on visualboyadvance,
<br/>
nothing happens, the file gets loaded, but doesn't display the first coin, like it does when i set the maxcoins to 40.
<br/>
<br/>
So i tried to get around this problem by increasing by compiling the file with 40 and manually adding 1 in the game loop itself,
<br/>
that gave me a strange artifact (see: zip-file). Som extra coins are added and move with a multiple speed of the original coins.
<br/>
<br/>
My earlier attempt was to use the OAMentries 20 ~ 80 for coins (since i am not using them anyway),
<br/>
but that gave more or less the same problem, it also got stuck at a number of fourty.
<br/>
<br/>
Can anyone help me with this problem?
<br/>
(a fix or a new solution would probably be best)
<br/>
<br/>
Oh i forgot to tell, all is compiled as multiboot, i also tried a normal binairy, but both have the same problem.
<br/>
<br/>
Thanks Jenswa
<br/>
<br/>
<br/>
attachments:
<br/>
<br/>
<a href="http://www.geocities.com/gouwevrouwe/coins.zip" target="_blank">http://www.geocities.com/gouwevrouwe/coins.zip</a> [62 k]
<br/>
(code included, working file and a not working file, all other sources need and the artifact)
<br/>
<br/>
<br/>
PS:
<br/>
I've an old version of devkitadvance<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18342 - DekuTree64 - Wed Mar 24, 2004 5:25 pm</h4>
    <div class="postbody"><span class="postbody">Well, for one thing, here
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for(z=10; z &gt;= n; z--){
<br/>
      clones[n].x = 240;
<br/>
      clones[n].y = 160;
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
you're setting one past the end of the array the first time through the loop, which is bound to cause teouble eventually. Start at 9 and loop down. Or start at n and loop up while &lt;10, that would be simpler. 
<br/>
...now that I look at it, you're NOT setting one past the end of the array, because you're setting clones[n] instead of z, so you'll probably want to change that. You might want to set them to be dead too, although it shouldn't really matter. 
<br/>
Also, in loop before that, make sure to check if n &gt;= 10 and break if so, just incase.
<br/>
Not sure what else could be wrong with it.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18369 - LOst? - Thu Mar 25, 2004 1:19 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">Well, for one thing, here
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for(z=10; z &gt;= n; z--){
<br/>
      clones[n].x = 240;
<br/>
      clones[n].y = 160;
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
you're setting one past the end of the array the first time through the loop, which is bound to cause teouble eventually. Start at 9 and loop down. Or start at n and loop up while &lt;10, that would be simpler. 
<br/>
...now that I look at it, you're NOT setting one past the end of the array, because you're setting clones[n] instead of z, so you'll probably want to change that. You might want to set them to be dead too, although it shouldn't really matter. 
<br/>
Also, in loop before that, make sure to check if n &gt;= 10 and break if so, just incase.
<br/>
Not sure what else could be wrong with it.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Yea don't confuse the actual loop steps with the array index. Then you will get into trouble.
<br/>
<br/>
A little C hint:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   int array_index = 10;
<br/>
   int step = 0;
<br/>
   
<br/>
   while (--array_index &gt;= 0, ++step &lt;= 10)
<br/>
   {
<br/>
      printf("array_index == %d. Step == %d.\n", array_index, step);
<br/>
   }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
output:
<br/>
array_index == 9. Step == 1.
<br/>
array_index == 8. Step == 2.
<br/>
array_index == 7. Step == 3.
<br/>
array_index == 6. Step == 4.
<br/>
array_index == 5. Step == 5.
<br/>
array_index == 4. Step == 6.
<br/>
array_index == 3. Step == 7.
<br/>
array_index == 2. Step == 8.
<br/>
array_index == 1. Step == 9.
<br/>
array_index == 0. Step == 10.
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18385 - jenswa - Thu Mar 25, 2004 11:38 am</h4>
    <div class="postbody"><span class="postbody">Thanks for pointing out, i just copied and pasted that code from the apart above and forgot to change the n in z and 10 in 9 to start with.
<br/>
<br/>
However i still can't get past the limit.<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18454 - LOst? - Fri Mar 26, 2004 8:26 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jenswa wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
However i still can't get past the limit.</td> </tr></table><span class="postbody">
<br/>
<br/>
Sometimes it helps to revrite the whole code for the thing that's not working. 
<br/>
I'm afraid of using while and for loops in GBA games too much because I'm afraid it will take longer than the 60Hz of a frame.
<br/>
<br/>
Having 10 coins visible is decreasing that time so you can do other stuff, but still I don't like the idea of only showing 10 when there may be more on the screen. But then again I don't know what you're game design is so.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18481 - jenswa - Sat Mar 27, 2004 12:49 pm</h4>
    <div class="postbody"><span class="postbody">Thanks,
<br/>
<br/>
i think i'll do that again, when i've some time over.
<br/>
So i may be using too many for loops?
<br/>
Well i just find it weird that the bin file doesn't work at all.
<br/>
<br/>
back to the drawing board.<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18563 - LOst? - Sun Mar 28, 2004 11:17 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jenswa wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
So i may be using too many for loops?</td> </tr></table><span class="postbody">
<br/>
<br/>
No not at all.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
