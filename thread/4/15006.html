<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Undefines reference to memcpy32 :( - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Undefines reference to memcpy32 :(</h2>
<div id="posts">
<div class="post">
    <h4>#150776 - mog123 - Tue Feb 12, 2008 7:00 pm</h4>
    <div class="postbody"><span class="postbody">Hi, I'm using tonclibs and I'm trying to display a sprite (got the bg to display) can you possibly tell me what I'm doing wrong?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#include "tonc.h"
<br/>
#include "bg.h"
<br/>
#include "ball.h"
<br/>
<br/>
OBJ_ATTR obj_buffer[128];
<br/>
<br/>
int main()
<br/>
{
<br/>
u32 loop;
<br/>
u32 tid= 0, pb= 0; //tile id , palbank
<br/>
OBJ_ATTR *ball= &amp;obj_buffer[0];
<br/>
<br/>
REG_DISPCNT = DCNT_MODE4 | DCNT_BG2 | DCNT_OBJ | DCNT_OBJ_1D;
<br/>
<br/>
for(loop =0; loop &lt;256; loop++)
<br/>
   {
<br/>
   pal_bg_mem[loop] = bgPalette[loop];
<br/>
   }
<br/>
<br/>
for (loop = 0; loop &lt; (120*160); loop++) 
<br/>
   {
<br/>
   vid_mem_front[loop] = bgData[loop] ;
<br/>
   }
<br/>
<br/>
for(loop = 0; loop &lt; 256; loop++)
<br/>
   {
<br/>
   pal_obj_mem[loop] = ballPalette[loop];
<br/>
   }
<br/>
<br/>
obj_set_attr(ball, 
<br/>
        ATTR0_SQUARE,              // Square, regular sprite
<br/>
        ATTR1_SIZE_8,
<br/>
   ATTR2_PALBANK(pb) | tid);              // 8x8p, 
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
      vid_vsync();
<br/>
      oam_copy(oam_mem, obj_buffer, 1);
<br/>
   }
<br/>
<br/>
<br/>
return 0;
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I get an error like this:
<br/>
<br/>
In function oam_copy : undefined reference to memcpy32
<br/>
also:
<br/>
collect2: ld returned 1 exit status.
<br/>
<br/>
That's bout it
<br/>
Please help</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150780 - DiscoStew - Tue Feb 12, 2008 8:27 pm</h4>
    <div class="postbody"><span class="postbody">Your error is pointing into the oam_copy function, which we see you using, but not showing. The reason why memcpy32 is unreferenced is because you did not include the header to which you can include it, which is &lt;stdio.h&gt;. In the file where you have your oam-copy function, be sure to add that header.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150782 - Dwedit - Tue Feb 12, 2008 8:52 pm</h4>
    <div class="postbody"><span class="postbody">That's a linker error.  Make sure you're including the necessary libraries.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150783 - mog123 - Tue Feb 12, 2008 8:52 pm</h4>
    <div class="postbody"><span class="postbody">o yeah, I forgot i needed the normal libs too:)
<br/>
edit: included stdio.h and still nothing</span><span class="gensmall"><br/><br/>Last edited by mog123 on Tue Feb 12, 2008 9:03 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#150784 - Cearn - Tue Feb 12, 2008 8:53 pm</h4>
    <div class="postbody"><span class="postbody">memcpy32 is part of tonclib, not the standard C library. You're probably not linking libtonc.a to the project. Check your makefile to see if -ltonc is present anywhere and if the linker directory is set up properly.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150787 - DiscoStew - Tue Feb 12, 2008 9:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">memcpy32 is part of tonclib, not the standard C library. You're probably not linking libtonc.a to the project. Check your makefile to see if -ltonc is present anywhere and if the linker directory is set up properly.</td> </tr></table><span class="postbody">
<br/>
<br/>
Ah, ok. It's been a while since I last involved myself with your stuff Cearn. so I honestly didn't know about your library.<br/>_________________<br/><span style="font-weight: bold">DS</span> - It's all about <span style="font-weight: bold">D</span>isco<span style="font-weight: bold">S</span>tew</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150788 - mog123 - Tue Feb 12, 2008 9:06 pm</h4>
    <div class="postbody"><span class="postbody">I'm using a batchfile.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#150790 - gauauu - Tue Feb 12, 2008 9:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">Check your makefile to see if -ltonc is present anywhere and if the linker directory is set up properly.</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mog123 wrote:</b></span></td> </tr> <tr> <td class="quote">I'm using a batchfile.</td> </tr></table><span class="postbody">
<br/>
<br/>
%s/make/batch/g
<br/>
<br/>
Check your batchfile to see if -ltonc is present anywhere and if the linker directory is set up properly.
<br/>
<br/>
.....
<br/>
<br/>
In the compile step where you link all the .o files together, you generally also specify what libraries it should link to.  Look for other -l parameters, and add -ltonc with them.  
<br/>
<br/>
Also make sure you have libtonc.a and it is in a directory that is included in your linker's path.  This is generally specified by -L on that same step.   So your linker step will probably look something vaguely like:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">arm-eabi-gcc.exe (etc etc) -Lc:/gba/libs/locationOfTonc file1.o file2.o (etc) -lgba -ltonc myGame.gba</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151008 - mog123 - Sun Feb 17, 2008 12:54 am</h4>
    <div class="postbody"><span class="postbody">Still nothing, I linked it and nothing still get that undefined memcpy32
<br/>
also i get (got this earlier too)
<br/>
implicit incompatible memcpy
<br/>
Is there a way to relate to sprite numbers as an array in tonclib?
<br/>
something like sprite[0] sprite[1] etc?
<br/>
<br/>
BTW: I can't use memcpy in any demo, nothing that i try - some help would be needed too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#151013 - Cearn - Sun Feb 17, 2008 2:24 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mog123 wrote:</b></span></td> </tr> <tr> <td class="quote">Still nothing, I linked it and nothing still get that undefined memcpy32</td> </tr></table><span class="postbody">There should be a file called libtonc.a somewhere (probably tonclib/lib/libtonc.a) This is the directory you need to use with -L. 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mog123 wrote:</b></span></td> </tr> <tr> <td class="quote">also i get (got this earlier too)
<br/>
implicit incompatible memcpy</td> </tr></table><span class="postbody">
<br/>
The declaration of memcpy is in stdlib.h. Try to #include it and see what happens. If not, give the exact error message and the source line causing it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mog123 wrote:</b></span></td> </tr> <tr> <td class="quote">Is there a way to relate to sprite numbers as an array in tonclib? something like sprite[0] sprite[1] etc?</td> </tr></table><span class="postbody"> If you mean "can I access OAM as an array", use oam_mem[0], oam_mem[1], etc.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>mog123 wrote:</b></span></td> </tr> <tr> <td class="quote">BTW: I can't use memcpy in any demo, nothing that i try - some help would be needed too.</td> </tr></table><span class="postbody"> Define "can't use". Does building the project fail, or does it give the wrong results?
<br/>
<br/>
It would also help if you gave us your batchfile. Batchfiles have the habit of growing unmaintainable very fast (which is part of the reason their use is not recommended for this stuff), and it's possible you didn't add the required parts in quite the right way. I'd strongly suggest learning the basics of makefiles; they're not as hard as they look and you will benefit from it in the long run.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
