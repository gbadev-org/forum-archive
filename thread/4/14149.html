<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>huge .elf output - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > huge .elf output</h2>
<div id="posts">
<div class="post">
    <h4>#140380 - f33ldead - Sat Sep 15, 2007 10:46 pm</h4>
    <div class="postbody"><span class="postbody">I've built a simple project of mine, and get a 80MB .elf output, which is made of a large chunk of zeroes. The .gba output is a few KBs, as usual.
<br/>
<br/>
Any guesses why such a thing can happen?<br/>_________________<br/>It's real, spooky action at distance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140391 - keldon - Sun Sep 16, 2007 1:29 am</h4>
    <div class="postbody"><span class="postbody">are you including graphics?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140432 - PeterM - Sun Sep 16, 2007 11:23 am</h4>
    <div class="postbody"><span class="postbody">Or a large global/static array?
<br/>
<br/>
static char myArray[80MB] = {1}; // will probably make an 80MB elf.<br/>_________________<br/><a href="http://aaiiee.wordpress.com/" target="_blank">http://aaiiee.wordpress.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140437 - f33ldead - Sun Sep 16, 2007 12:43 pm</h4>
    <div class="postbody"><span class="postbody">Well, I have graphics but they're small. Of course I don't have any such array :)
<br/>
My object files sums up to a few kilobytes. I think it's about linker (I'm using the one gba.spec uses, from devkitarm).
<br/>
The output is something like this: File starts with usual .elf header, then crt0. (for mysterious reason) rest is filled up with zeroes until 0502:8000. My stuff begins there, goes on a few kilobytes, and EOF.<br/>_________________<br/>It's real, spooky action at distance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140446 - keldon - Sun Sep 16, 2007 2:52 pm</h4>
    <div class="postbody"><span class="postbody">Give more info!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140447 - PeterM - Sun Sep 16, 2007 2:56 pm</h4>
    <div class="postbody"><span class="postbody">Have you tried using readelf to see which .elf sections are so bloated?<br/>_________________<br/><a href="http://aaiiee.wordpress.com/" target="_blank">http://aaiiee.wordpress.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#140999 - wintermute - Fri Sep 21, 2007 6:17 am</h4>
    <div class="postbody"><span class="postbody">It might be a bug in the linkscript. I had this happen quite a few times when first writing the linkscripts.
<br/>
<br/>
Could you clean the project &amp; mail it to me? There may be some odd combination of sections that I didn't account for somewhere.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141415 - f33ldead - Tue Sep 25, 2007 3:29 am</h4>
    <div class="postbody"><span class="postbody">I've upload it the project <a class="postlink" href="http://rapidshare.com/files/58059945/test.tbz2.html" target="_blank">here</a> (sorry, it's rapidshare :/)<br/>_________________<br/>It's real, spooky action at distance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#141540 - strager - Wed Sep 26, 2007 7:21 pm</h4>
    <div class="postbody"><span class="postbody">I, too, get a large .elf file.
<br/>
<br/>
readelf output:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">$ arm-eabi-readelf -a test.elf
<br/>
ELF Header:
<br/>
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00
<br/>
  Class:                             ELF32
<br/>
  Data:                              2's complement, little endian
<br/>
  Version:                           1 (current)
<br/>
  OS/ABI:                            UNIX - System V
<br/>
  ABI Version:                       0
<br/>
  Type:                              EXEC (Executable file)
<br/>
  Machine:                           ARM
<br/>
  Version:                           0x1
<br/>
  Entry point address:               0x8000000
<br/>
  Start of program headers:          52 (bytes into file)
<br/>
  Start of section headers:          83985068 (bytes into file)
<br/>
  Flags:                             0x4000002, has entry point, Version4 EABI
<br/>
  Size of this header:               52 (bytes)
<br/>
  Size of program headers:           32 (bytes)
<br/>
  Number of program headers:         5
<br/>
  Size of section headers:           40 (bytes)
<br/>
  Number of section headers:         16
<br/>
  Section header string table index: 15
<br/>
<br/>
Section Headers:
<br/>
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
<br/>
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
<br/>
  [ 1] .init             PROGBITS        08000000 5008000 000218 00  AX  0   0  4
<br/>
  [ 2] .text             PROGBITS        08000218 5008218 000704 00  AX  0   0  4
<br/>
  [ 3] .fini             PROGBITS        0800091c 500891c 00000c 00  AX  0   0  4
<br/>
  [ 4] .rodata           PROGBITS        08000928 5008928 005cc4 00   A  0   0  4
<br/>
  [ 5] .eh_frame         PROGBITS        080065ec 500e5ec 000004 00   A  0   0  4
<br/>
  [ 6] .iwram            PROGBITS        03000000 5010000 0000d4 00  AX  0   0  4
<br/>
  [ 7] .bss              NOBITS          030000d4 0000d4 000548 00  WA  0   0  4
<br/>
  [ 8] .data             PROGBITS        0300061c 501061c 000018 00  WA  0   0  4
<br/>
  [ 9] .init_array       INIT_ARRAY      03000634 5010634 000004 00  WA  0   0  4
<br/>
  [10] .fini_array       FINI_ARRAY      03000638 5010638 000004 00  WA  0   0  4
<br/>
  [11] .jcr              PROGBITS        0300063c 501063c 000004 00  WA  0   0  4
<br/>
  [12] .pad              PROGBITS        02000000 5018000 000008 00  WA  0   0  1
<br/>
  [13] .comment          PROGBITS        00000000 5018008 000215 00      0   0  1
<br/>
  [14] .ARM.attributes   ARM_ATTRIBUTES  00000000 501821d 000010 00      0   0  1
<br/>
  [15] .shstrtab         STRTAB          00000000 501822d 00007c 00      0   0  1
<br/>
Key to Flags:
<br/>
  W (write), A (alloc), X (execute), M (merge), S (strings)
<br/>
  I (info), L (link order), G (group), x (unknown)
<br/>
  O (extra OS processing required) o (OS specific), p (processor specific)
<br/>
<br/>
There are no section groups in this file.
<br/>
<br/>
Program Headers:
<br/>
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
<br/>
  LOAD           0x000000 0x03000000 0x03000000 0x50066c4 0x5006c0c RW  0x8000
<br/>
  LOAD           0x5008000 0x08000000 0x08000000 0x065f0 0x065f0 R E 0x8000
<br/>
  LOAD           0x5010000 0x03000000 0x080065f0 0x000d4 0x000d4 R E 0x8000
<br/>
  LOAD           0x501061c 0x0300061c 0x080066c4 0x00024 0x00024 RW  0x8000
<br/>
  LOAD           0x5018000 0x02000000 0x080066e8 0x00008 0x00008 RW  0x8000
<br/>
<br/>
 Section to Segment mapping:
<br/>
  Segment Sections...
<br/>
   00     .init .text .fini .rodata .eh_frame .iwram .bss .data .init_array .fini_array .jcr
<br/>
   01     .init .text .fini .rodata .eh_frame
<br/>
   02     .iwram
<br/>
   03     .data .init_array .fini_array .jcr
<br/>
   04     .pad
<br/>
<br/>
There is no dynamic section in this file.
<br/>
<br/>
There are no relocations in this file.
<br/>
<br/>
There are no unwind sections in this file.
<br/>
<br/>
No version information found in this file.
<br/>
Attribute Section: aeabi
<br/>
File Attributes</td> </tr></table><span class="postbody">
<br/>
<br/>
The first line in the Program Headers section seems strange.  0x5008000 = 83918848 (~80MB), and 0x50066C4 = 83912388.  I don't know much about ELF's or linkscripts, though, so someone else would have to help you with that.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
