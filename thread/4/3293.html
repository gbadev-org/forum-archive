<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Am I overloading the OAM? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Am I overloading the OAM?</h2>
<div id="posts">
<div class="post">
    <h4>#19786 - CyberSlag5k - Sun Apr 25, 2004 5:40 pm</h4>
    <div class="postbody"><span class="postbody">I've got a sprite with 19 frames of animation. I use gifs2sprites to convert all the frames into one .h file complete with palette. However, any frame above the 7th or so acts kind of funny.
<br/>
<br/>
A download can be found here:
<br/>
<br/>
[url]homepages.udayton.edu/~pateramj/main.bin[/url]
<br/>
<br/>
Here are the setions of pertinant code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   sprites[0].attribute0 = COLOR_256 | SQUARE | soldier.posY;
<br/>
   sprites[0].attribute1 = SIZE_64 | soldier.posX;
<br/>
   sprites[0].attribute2 = 0;
<br/>
<br/>
   u16 const *myArray[19] = {obj0, obj1, obj2, obj3, obj4, obj5, obj6, obj7, obj8, obj9, obj10, obj11, obj12, obj13, obj14, obj15, obj16, obj17}; //obj0, obj1, obj2,....are arrays containing the frame data stored in soldier.h
<br/>
<br/>
   for(int j = 0; j &lt; 18; j++)
<br/>
   {
<br/>
      soldier.spriteFrame[j] = j*128;
<br/>
      for(int i = 0; i &lt; 2048; i++)
<br/>
      {
<br/>
         OAMData[i + (j * 2048)] = myArray[j][i];
<br/>
      }
<br/>
   }
<br/>
<br/>
   soldier.OAMSpriteNum = 0;
<br/>
   soldier.activeFrame = 0;
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
When you press A or B, the visor of the little soldier guy should open or close (it just increments activeFrame based on time). All is well for the first 7 frames or so, and then, as you can see, everything goes to hell. I'm thinking maybe I'm overloading (not as in OOP, but as in putting too much into it) the OAM. Is that a reasonable assessment? These sprites are rather huge (64*64). I know there's a fix using the DMA but I'm not at that level just yet (I hope to tackle the DMA within a week or two), but is there something I'm doing wrong here? Or am I just pushing the OAM too far?
<br/>
<br/>
Thanks in advance![/url]<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"><br/><br/>Last edited by CyberSlag5k on Sun Apr 25, 2004 6:28 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#19788 - sajiimori - Sun Apr 25, 2004 6:09 pm</h4>
    <div class="postbody"><span class="postbody">If you want to make it a little easier on your would-be helpers, use the Preview button to check your posts for correct formatting, and try to use the right terms (OAM is not the same thing as sprite cell RAM).
<br/>
<br/>
Sprite cell RAM only has space for 16 16-color 64x64 images, or 8 256-color 64x64 images.
<br/>
<br/>
Don't let DMA scare you -- sprites are way harder and you already have those working.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19790 - CyberSlag5k - Sun Apr 25, 2004 6:31 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If you want to make it a little easier on your would-be helpers, use the Preview button to check your posts for correct formatting,
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Right, sorry about that. Fixed it.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
and try to use the right terms (OAM is not the same thing as sprite cell RAM). 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Duelly noted.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Sprite cell RAM only has space for 16 16-color 64x64 images, or 8 256-color 64x64 images. 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So I am indeed putting too many frames into memory. I'll get right on learning the DMA then.
<br/>
<br/>
Thank you.<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19792 - CyberSlag5k - Sun Apr 25, 2004 6:39 pm</h4>
    <div class="postbody"><span class="postbody">Er...just so I am clear, the OAM is where I put my sprite attributes in, then? attribute0, attribute1, and attribute2? And when I'm loading my sprites into memory, that's into sprite RAM? I guess I got confused becaues in my gba.h what I've been putting my sprite data into is called OAMData.<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19793 - sajiimori - Sun Apr 25, 2004 6:43 pm</h4>
    <div class="postbody"><span class="postbody">That's right -- some GBA headers use that stupid term OAMData, which has caused havoc around here.  :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19795 - CyberSlag5k - Sun Apr 25, 2004 6:48 pm</h4>
    <div class="postbody"><span class="postbody">changed from OAMData to spriteMem.
<br/>
<br/>
I have seen the light!<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
