<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Need help, deferencing operator - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Need help, deferencing operator</h2>
<div id="posts">
<div class="post">
    <h4>#88739 - king501 - Wed Jun 21, 2006 2:36 pm</h4>
    <div class="postbody"><span class="postbody">I'm trying to learn programming GBA. I don't understand why the first statement is using an deferencing operator while the other ones aren't using any...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int main()
<br/>
{
<br/>
    *(unsigned int*)0x04000000 = 0x0403;
<br/>
<br/>
    ((unsigned short*)0x06000000)[120+80*240] = 0x001F;
<br/>
    ((unsigned short*)0x06000000)[136+80*240] = 0x03E0;
<br/>
    ((unsigned short*)0x06000000)[120+96*240] = 0x7C00;
<br/>
<br/>
    while(1);
<br/>
<br/>
    return 0;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Can someone explain it to me please?
<br/>
<br/>
Thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88740 - Mighty Max - Wed Jun 21, 2006 2:41 pm</h4>
    <div class="postbody"><span class="postbody">The array access is equally to the * with the index 0. For every other value it accesses the memory at base+index*typesize<br/>_________________<br/><a class="postlink" href="http://mightymax.org/gbamp_multiboot.html" target="_blank">GBAMP Multiboot</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88774 - king501 - Wed Jun 21, 2006 4:12 pm</h4>
    <div class="postbody"><span class="postbody">thanks, I don't quite understand yet, but I will try to make other researches...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88782 - Mr Snowflake - Wed Jun 21, 2006 4:31 pm</h4>
    <div class="postbody"><span class="postbody">When you do: 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">((unsigned short*)0x06000000)[120+80*240] = 0x001F;</td> </tr></table><span class="postbody">
<br/>
You actually do:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">*(((unsigned short*)0x06000000) + (120+80*240)) = 0x001F;</td> </tr></table><span class="postbody">
<br/>
The name of a array (in this case (unsigned short*)0x06000000, from now on I'll just call it myArray) is the a pointer to the address of the first element in that array. 
<br/>
So these two statements give the same memory address:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">myArray</td> </tr></table><span class="postbody">
<br/>
==
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">*myArray[0]</td> </tr></table><span class="postbody">
<br/>
<br/>
When you do: myArray[10] you go to the 10th element in the array and thus you go sizeof( unsigned short ) * 10 further from the beginning of the array, so you go to *(myArray + 10).
<br/>
<br/>
I hope this is somewhat understandable for humans, as I have a hard time getting my message explained, especially in other languages (like English for me).
<br/>
<br/>
BTW: If you have GBA specific questions you should ask them on the gba boards.<br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88785 - king501 - Wed Jun 21, 2006 4:57 pm</h4>
    <div class="postbody"><span class="postbody">thanks a lot snowflake, yes your information was very helpful and very well explained. 
<br/>
<br/>
BTW: there aren't any visible GBA boards.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88787 - Cearn - Wed Jun 21, 2006 5:13 pm</h4>
    <div class="postbody"><span class="postbody">All non-NDS boards are the GBA boards.
<br/>
<br/>
Also, uhm, you did notice that what you asked was explained <a class="postlink" href="http://user.chem.tue.nl/jakvijn/tonc/first.htm#ssec-2nd-toolbox" target="_blank">later on the same page</a>, right?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88790 - Mr Snowflake - Wed Jun 21, 2006 5:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>king501 wrote:</b></span></td> </tr> <tr> <td class="quote">thanks a lot snowflake, yes your information was very helpful and very well explained. 
<br/>
<br/>
BTW: there aren't any visible GBA boards.</td> </tr></table><span class="postbody">I think you should use: <a href="http://forum.gbadev.org/index.php" target="_blank">http://forum.gbadev.org/index.php</a><br/>_________________<br/><a class="postlink" href="http://www.mrsnowflake.be" target="_blank">http://www.mrsnowflake.be</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88951 - king501 - Thu Jun 22, 2006 12:49 pm</h4>
    <div class="postbody"><span class="postbody">thanks a lot guys because your explanations truly helped me!
<br/>
<br/>
PS: yeah, sorry I will post in the [coding] section in the future.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98433 - king501 - Tue Aug 15, 2006 6:12 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">#define REG_DISPCNT *(<span style="font-weight: bold">vu32</span>*)(MEM_IO+0x0000)</td> </tr></table><span class="postbody">
<br/>
<br/>
I just noticed it;
<br/>
REG_DISPCNT isn't supposed to be 16 bit long instead of 32?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98446 - Cearn - Tue Aug 15, 2006 9:45 am</h4>
    <div class="postbody"><span class="postbody">As the third and fourth bytes of IO-mem don't do anything, it doesn't really matter so you can use interpret it both ways. At least on the GBA; the NDS REG_DISPCNT really does have 32 bits.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98549 - king501 - Tue Aug 15, 2006 10:14 pm</h4>
    <div class="postbody"><span class="postbody">On gbatek I've seen that 0x04000002 was used for Green Swap. That's why I was asking. But of course, I don't think nobody will ever use it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#98555 - Cearn - Tue Aug 15, 2006 11:25 pm</h4>
    <div class="postbody"><span class="postbody">You could still use bit 0 of 0400:0002 as a greenswap if you had a 32bit REG_DISPCNT, it'd just be 0x10000 instead of 1. What matters is which numbers make up the contents of memory, not what you use to get there. you may have noticed that some 32bit registers have been split into _L and _H variants; technically it doesn't matter which ones you use as long as the final entries are the same. The same holds for VRAM, OAM, etc. 
<br/>
<br/>
In principle, it doesn't matter what datatypes you use when imposing the memory maps, although some types are more convenient or faster than others.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
