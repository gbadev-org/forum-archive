<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Getting data into a ROM - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Getting data into a ROM</h2>
<div id="posts">
<div class="post">
    <h4>#1879 - Sweex - Fri Jan 24, 2003 11:08 pm</h4>
    <div class="postbody"><span class="postbody">I'm looking for a fast way to get data into my binary. Currently I'm converting my data to source file containing a const array of u32. Problem is that these files get really big and take up time to compile.
<br/>
<br/>
So I'm looking for some fast way to get a datafile included without having to convert it to "source code". Is there a way to output in the format of an obj (.o) file?
<br/>
<br/>
(Background info: I'm writing some data system to get files into my ROM. Probably similar to GBFS, but I'm storing contents of a directory (tree) so you don't need to add it to some kind of archive.)
<br/>
<br/>
Tnx in advance!:)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1883 - Touchstone - Fri Jan 24, 2003 11:48 pm</h4>
    <div class="postbody"><span class="postbody">I'm converting my data to assembly source, which is way faster to assemble than compiling a huge C file.</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
      .DATA      @ Put in data segment
<br/>
<br/>
      .ALIGN      4
<br/>
      .GLOBAL      gfx_tiles   @ Export label
<br/>
gfx_tiles:
<br/>
      .word      0x00000040   @ array size
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 @ Array content
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
      .byte      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
<br/>
<br/>
      .END      @ End of data segment
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1886 - Sweex - Sat Jan 25, 2003 12:27 am</h4>
    <div class="postbody"><span class="postbody">I thought about that already but dunno alot about asm, so tnx for the sample! However, it still has to be parsed.
<br/>
<br/>
I'm currently figuring out the ELF file format, and with a little luck I can write my own .elf containing binary data. That would rock!:-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1887 - Paul Shirley - Sat Jan 25, 2003 1:17 am</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:36 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#1888 - Sweex - Sat Jan 25, 2003 2:27 am</h4>
    <div class="postbody"><span class="postbody">DOH! I was looking for just that, but I didn't think that would work in gcc. I did that trick back in my turbo Pascal days...! (Why is the most obvious way always the last one to think of?;)
<br/>
<br/>
Going to try that!!:)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1890 - tepples - Sat Jan 25, 2003 2:38 am</h4>
    <div class="postbody"><span class="postbody">You can store a GBFS file inside a GBFS file and do "directories" that way.  Or you can store GBFS files one after the other because GBFS has a function to return a pointer to the end of a GBFS file.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1906 - ampz - Sat Jan 25, 2003 11:05 am</h4>
    <div class="postbody"><span class="postbody">Another way is to convert to source, but set up the dependencies so that the compiler doesn't have to recompile all the data every time.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1909 - Sweex - Sat Jan 25, 2003 2:31 pm</h4>
    <div class="postbody"><span class="postbody">YES!! Got objcopy working just the way I want it! It takes about 5 seconds to convert my 6.5mb test file into an ELF! Thanks for the tips all (especially Paul S.!)
<br/>
<br/>
@Tepples: I just don't want to use GBFS. Not that I think it isn't any good (In fact, I'm going to do something similar), but I want to code it myself and want to have a directory on my harddisk where I can directly copy files to. That directory (tree) will then be packed into one file and converted to an ELF using objcopy. I think this is just a bit more flexible, and I have can check which files are changed and need to get "repacked".</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
