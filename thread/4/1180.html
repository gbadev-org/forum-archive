<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Help needed with background tiles - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Help needed with background tiles</h2>
<div id="posts">
<div class="post">
    <h4>#5817 - machinerider - Fri May 09, 2003 12:58 am</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I'm having some problems with my game, Jewel Crash. My background tiles are getting overrun with rubbish data. 
<br/>
<br/>
It seems to happen when you finish a line of jewels in the top half of the playing grid. At that point, it looks like something is writing to the background buffer at 0x6000000.
<br/>
<br/>
I've gone through my code about 500 times and still can't find what I'm doing wrong.
<br/>
<br/>
The game + source is available for download on the front page of gbadev.org, or, failing that, you can get it from <a class="postlink" href="http://www.machinerider.com/downloads/" target="_blank">www.machinerider.com/downloads/</a>
<br/>
<br/>
Thanks!
<br/>
<br/>
Daniel Crowley -Wilson
<br/>
<a href="http://www.machinerider.com" target="_blank">www.machinerider.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5818 - niltsair - Fri May 09, 2003 1:01 am</h4>
    <div class="postbody"><span class="postbody">A common thing to look out for, the maps. Since they use the same memory area than the tiles, you might make one overwrite the other one.
<br/>
<br/>
Load your tiles starting form bottom, and your maps from the top of the memory.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5825 - Quirky - Fri May 09, 2003 8:16 am</h4>
    <div class="postbody"><span class="postbody">I've managed to get the bug to appear and it happens just after the jewels fall down. I guess the problem is in CheckCombos(). I'd look at the final ClearSprites in that routine, as that seems a bit suspicious to me - make sure sprite_count and sprite_grid_count are doing what you expect. Course I may be barking up the wrong tree entirely, but I can't see what else it might be.
<br/>
<br/>
Also, to sort out your keypad "stickyness" it's a good idea to not read directly from the key register. It's a tricky thing to get right though, the feel of the keys, try experimenting with storing the register every frame and testing for repeats, etc. Emulators behave quite differently to the real thing in this respect, so storing the register's value and using this is the only way to make sure the game plays the same way on hardware.
<br/>
<br/>
Finally you should avoid putting implementation code in .h files. Better to seperate the actual routines into .c files with the function prototypes, defines etc only in the header, then you can compile the individual parts into seperate .o files and save compiling the whole thing everytime, amongst other benefits (readability, easier to include modules in other projects, etc).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5882 - machinerider - Mon May 12, 2003 7:49 am</h4>
    <div class="postbody"><span class="postbody">Niltsair and Quirky, thank you kindly for your replies. I think I've isolated the background problem. I'm going to experiment with the key registers a bit more, and take your ideas of storing the vals per frame under advice.
<br/>
<br/>
Finally, isolating my function implementation into .c files is one those classic "d'oh!" moments.. as soon as you've read it you wonder why you never thought of it, because it seems so obvious!
<br/>
<br/>
Thanks again for taking the time to look through my code - it really does help getting a third party to point out the little things that are so easy for the author to miss.
<br/>
<br/>
For those interested in downloading the final version, it will be available on my site at <a class="postlink" href="http://www.machinerider.com/downloads" target="_blank">www.machinerider.com/downloads</a>, hopefully in a few days max.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
