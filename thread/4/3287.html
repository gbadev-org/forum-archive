<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>doing some bitwise operations using a structure - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > doing some bitwise operations using a structure</h2>
<div id="posts">
<div class="post">
    <h4>#19701 - slboytoy - Fri Apr 23, 2004 6:15 pm</h4>
    <div class="postbody"><span class="postbody">hi all.  i'm working on a logc analyzer display function which checks the bits withen a pair of integers which are stored in a structure (channels.hi and channels.lo).  there seems to be a problem when we're trying to switch from 1 int to the other.  this results in an output which seems to be missing one bit of data.  instead, a blank space is drawn instead of an actual piece of data.
<br/>
<br/>
anybody see what we are missing in this chunk of code? 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   
<br/>
do
<br/>
{
<br/>
                //Drawing the horizontal line
<br/>
   if(count &gt; 31)
<br/>
   {
<br/>
      if(channels.hi &amp; (1 &lt;&lt; count - 31))
<br/>
      {
<br/>
         y = yHigh;
<br/>
      }
<br/>
      else
<br/>
      {
<br/>
         y = yLow;
<br/>
      }
<br/>
      x = HorizontalLines(x, y, X_Length);      //Returns new value of 'x' cordinites
<br/>
   }
<br/>
   else
<br/>
       {
<br/>
                       if(channels.lo &amp; (1 &lt;&lt; count))
<br/>
      {
<br/>
         y = yHigh;
<br/>
      }
<br/>
      else
<br/>
      {
<br/>
         y = yLow;
<br/>
      }
<br/>
      x = HorizontalLines(x, y, X_Length);      //Returns new value of 'x' cordinites
<br/>
   }
<br/>
<br/>
   //Checks when to put a vertical line
<br/>
   if (count !=0)
<br/>
   {
<br/>
      if(count == 31)
<br/>
      {
<br/>
         if (channels.hi &amp; (1 &lt;&lt; count -1) &amp;&amp; (y == yLow))   //Low to High
<br/>
         {
<br/>
            VerticalLines(x, yLow, yHigh);
<br/>
         }
<br/>
         else if (channels.hi &amp; (1 &lt;&lt; count -1) &amp;&amp; (y == yHigh))      //Still High
<br/>
         {}
<br/>
         else if (y == yHigh )                  //High to Low
<br/>
                             {
<br/>
            VerticalLines(x, yLow, yHigh);
<br/>
         }
<br/>
      }
<br/>
      if(count &gt; 31)
<br/>
      {
<br/>
         if (channels.hi &amp; (1 &lt;&lt; count -32) &amp;&amp; (y == yLow))   //Low to High
<br/>
         {
<br/>
            VerticalLines(x, yLow, yHigh);
<br/>
         }
<br/>
         else if (channels.hi &amp; (1 &lt;&lt; count -32) &amp;&amp; (y == yHigh))      //Still High
<br/>
         {}
<br/>
         else if (y == yHigh )                  //High to Low
<br/>
         {
<br/>
            VerticalLines(x, yLow, yHigh);
<br/>
         }
<br/>
      }
<br/>
<br/>
      else
<br/>
      {
<br/>
         if (channels.lo &amp; (1 &lt;&lt; count -1) &amp;&amp; (y == yLow))   //Low to High
<br/>
         {
<br/>
            VerticalLines(x, yLow, yHigh);
<br/>
         }
<br/>
         else if (channels.lo &amp; (1 &lt;&lt; count -1) &amp;&amp; (y == yHigh))   //Still High
<br/>
         {}
<br/>
         else if (y == yHigh )                     //High to Low
<br/>
         {
<br/>
            VerticalLines(x, yLow, yHigh);
<br/>
         }
<br/>
      }
<br/>
<br/>
   }
<br/>
<br/>
   count--;
<br/>
<br/>
}while(count &gt; 0);</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19702 - sajiimori - Fri Apr 23, 2004 6:21 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, parentheses.  The bit shift operators are higher priority than addition and subtraction.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19703 - slboytoy - Fri Apr 23, 2004 6:29 pm</h4>
    <div class="postbody"><span class="postbody">tried that out.  it still does the same thing.  if you think it would be easier to understand if i provided the source code for testing i'll post it later.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19711 - sajiimori - Fri Apr 23, 2004 7:50 pm</h4>
    <div class="postbody"><span class="postbody">You're going to have to post the new version because I don't know what you changed.
<br/>
<br/>
Anyway, I don't know what your logic is supposed to be.  I'm just seeing a big block of code with a lot of redundant braces in it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19718 - sajiimori - Fri Apr 23, 2004 8:28 pm</h4>
    <div class="postbody"><span class="postbody">Does this capture what you were looking for?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// renamed 'count' to 'bit'
<br/>
<br/>
for(; bit &gt; 0; --bit)
<br/>
{
<br/>
  int word = bit &gt; 31 ? channels.hi : channels.lo;
<br/>
  int old_y = y;
<br/>
  y = word &amp; (1 &lt;&lt; (bit &amp; 31)) ? yHigh : yLow;
<br/>
  x = HorizontalLines(x, y, X_Length);
<br/>
<br/>
  if(bit != 0 &amp;&amp; y != old_y)
<br/>
    VerticalLines(x, yLow, yHigh);
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
