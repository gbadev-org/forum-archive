<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprites in MODE 3 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Sprites in MODE 3</h2>
<div id="posts">
<div class="post">
    <h4>#43916 - qbert - Sat May 28, 2005 1:18 am</h4>
    <div class="postbody"><span class="postbody">I have 2 very small sprites to use in my program, converted to a data and palette array each. I can use one or the other, but I'm having trouble using both sprites at the same time. 
<br/>
<br/>
I'm new to gba and c - let me know if this question is too vague.
<br/>
thanks.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43917 - tepples - Sat May 28, 2005 2:24 am</h4>
    <div class="postbody"><span class="postbody">Do they both show up in VisualBoyAdvance's tile viewer under the 0x06010000 section?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#43949 - qbert - Sat May 28, 2005 4:21 pm</h4>
    <div class="postbody"><span class="postbody">I see some colors but no clear image in VisualBoyAdvance's tile viewer.
<br/>
<br/>
The book I'm using some code from only displays 1 sprite in the examples. 
<br/>
Each sprite works fine alone, but I can't display both at the same time.  Below is some of the code.
<br/>
<br/>
int main()
<br/>
{
<br/>
    int n;
<br/>
    int i;
<br/>
    int x;
<br/>
<br/>
    // Set video mode
<br/>
    SetMode(3 | OBJ_ENABLE | OBJ_MAP_1D | BG2_ENABLE);
<br/>
<br/>
    // Draw the board
<br/>
    for(n = 0; n &lt; 38400; n++)
<br/>
        videoBuffer[n] = bg_Bitmap[n];
<br/>
<br/>
    // set sprite palette
<br/>
    for(n=0; n &lt; 256; n++)
<br/>
        SpritePal[n] = blackstonePalette[n];
<br/>
<br/>
    for(n=0; n &lt; 512; n++)
<br/>
        SpriteData3[n] = blackstoneData[n];
<br/>
<br/>
    // move sprite off screen
<br/>
    HideSprites();
<br/>
<br/>
    x = 0;
<br/>
    n = 0;
<br/>
<br/>
    i = 1;
<br/>
    InitSprite(i, horizontalPlacement[x], verticalPlacement[n], blackstone_WIDTH, COLOR_256, 512);
<br/>
    WaitVBlank();
<br/>
    MoveSprite(n);
<br/>
    UpdateSpriteMemory();
<br/>
<br/>
<br/>
<span style="color: red">Everything works fine to here.
<br/>
The board background is drawn and 1 black game piece
<br/>
<br/>
After this point, I want to keep the board and black game piece, but also add a white game piece at another spot. The code below does add the game piece but changes both to white.
<br/>
</span>
<br/>
<br/>
<br/>
  // set sprite palette
<br/>
//    for(n=0; n &lt; 256; n++)
<br/>
//        SpritePal[n] = whitestonePalette[n];
<br/>
<br/>
//    for(n=0; n &lt; 512; n++)
<br/>
//        SpriteData3[n] = whitestoneData[n];
<br/>
<br/>
    i = 2;
<br/>
    x = 18;
<br/>
    n = 18;
<br/>
    InitSprite(i, horizontalPlacement[x], verticalPlacement[n], blackstone_WIDTH, COLOR_256, 512);
<br/>
    WaitVBlank();
<br/>
    MoveSprite(n);
<br/>
    UpdateSpriteMemory();
<br/>
<br/>
<br/>
}
<br/>
<br/>
/* END OF FILE */</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44019 - Issac - Sun May 29, 2005 1:11 pm</h4>
    <div class="postbody"><span class="postbody">I dont know, but isn't it because you overwrite the black piece pallette with the white ones.... :S (or the data?) 
<br/>
I am not sure, but thats my guess...<br/>_________________<br/>yeah, well, maybe... or? anyways.... eh...  what was i talking about??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44022 - qbert - Sun May 29, 2005 1:59 pm</h4>
    <div class="postbody"><span class="postbody">Yes - that's what's happening. I'm not sure how to use both palettes at the same time. This pgm is pretty much a 'monkey job' - i pasted and modified code samples. So I'm not real solid on what's happening.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#44023 - Issac - Sun May 29, 2005 2:12 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> // set sprite palette
<br/>
for(n=0; n &lt; 256; n++)
<br/>
SpritePal[n] = blackstonePalette[n];
<br/>
<br/>
for(n=0; n &lt; 512; n++)
<br/>
SpriteData3[n] = blackstoneData[n]; </td> </tr></table><span class="postbody">
<br/>
<br/>
here you load the black one into the Palette.
<br/>
I guess you've defined "SpritePal" and "SpriteData3" somewhere in the code..
<br/>
Because you load the White one OVER the black (changing the black to white too) here:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code"> // set sprite palette
<br/>
// for(n=0; n &lt; 256; n++)
<br/>
// SpritePal[n] = whitestonePalette[n];
<br/>
<br/>
// for(n=0; n &lt; 512; n++)
<br/>
// SpriteData3[n] = whitestoneData[n]; </td> </tr></table><span class="postbody">
<br/>
<br/>
So my guess would be that you have to define a few more things. like:
<br/>
SpriteData4 and SpritePal2 for example, and use the correct memory usage and all (can be quite hard to do).
<br/>
<br/>
I guess someone better than me should help you with that part :)<br/>_________________<br/>yeah, well, maybe... or? anyways.... eh...  what was i talking about??</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47429 - blacksun - Fri Jul 08, 2005 7:33 pm</h4>
    <div class="postbody"><span class="postbody">Well first thing if your images are 256 color you can only use one palette.  So you just have to store one palette and copy that. 
<br/>
<br/>
Second, you need to index into your SpriteData3 array for your second sprite.  What you are doing is overriding the data for your sprite with the white one.  So for instance you would start the second sprite at SpriteData3[512] since that is the end of your first sprite.  But you also have to make sure when you are indexing your white data that you start from 0 and not 512.
<br/>
<br/>
Also, what is the size of your sprites and how many frames of animation?  Because if its a small sprite (8x8) and only one frame you should only have a size of (8x8 / 2) which is 32.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
