<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Messages and Magic Cookies - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Messages and Magic Cookies</h2>
<div id="posts">
<div class="post">
    <h4>#153791 - sgeos - Sun Apr 06, 2008 9:47 am</h4>
    <div class="postbody"><span class="postbody">This is more of an encoding problem than a coding problem, but the two are related.
<br/>
<br/>
In any case, assume I have a message such as:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">Who is your leader?&lt;nl&gt;&lt;choice:&lt;party:0&gt; &lt;party:1&gt; &lt;party:2&gt;&gt;&lt;ff&gt;
<br/>
Do you come in peach?&lt;nl&gt;&lt;choice::yes :no :silence&gt;&lt;ff&gt;
<br/>
Please wait a minute.</td> </tr></table><span class="postbody">
<br/>
Clearly dealing with newlines and formfeeds is simple.
<br/>
ASCII has special characters for this.
<br/>
The problem is that other magic cookies need to inserted in the code.
<br/>
<br/>
&lt;party&gt; is a fairly simple inline function that takes one parameter.
<br/>
It finds the party member at the Nth position and returns their name.
<br/>
In order to get this to work, some sort of magic cookie needs to inlined in the message.
<br/>
If I could assume ASCII, I would probably use 0xFF or something to that effect, but I'm going to assume unicode at this point.
<br/>
Does anyone know of any magic cookie values that are unicode compatible?
<br/>
Multibyte values are fine.
<br/>
<br/>
The data will be inlined as such:
<br/>
Cookie Bytes, Function Indicator Bytes, Function Parameter Bytes
<br/>
<br/>
Note that &lt;choice&gt; requires a bunch of cookies- one to start it, one for each choice, and one to end it.  This does not change the problem.
<br/>
<br/>
-Brendan
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span> Using end-user defined characters, although the obvious solutions, seems like the easy way out.  I'm hoping that someone else has run into this or a similar problem and knows of an existing character code or value that makes sense as a cookie indicator.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#153903 - tepples - Tue Apr 08, 2008 1:55 am</h4>
    <div class="postbody"><span class="postbody">There's always '&lt;' (U+003C) to start a cookie and '&gt;' (U+003E) to end it. If it works for HTML, and it works for various applications of XML, and it works for your ad-hoc metalanguage above, it can be made to work in a game.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#153905 - Dwedit - Tue Apr 08, 2008 2:32 am</h4>
    <div class="postbody"><span class="postbody">In old games, people used various non-printable characters to accomplish control codes.  Saves space compared with long ascii words.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#153947 - sgeos - Tue Apr 08, 2008 5:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">There's always '&lt;' (U+003C) to start a cookie and '&gt;' (U+003E) to end it. If it works for HTML, and it works for various applications of XML, and it works for your ad-hoc metalanguage above, it can be made to work in a game.</td> </tr></table><span class="postbody">
<br/>
That is actually ingenious.  To the extent that '&lt;' and '&gt;' are reserved for tags, they will never be displayed in messages, so there will be no character mapping conflicts.  Using the same characters in both representations may or maynot complicate the conversion regexp.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">In old games, people used various non-printable characters to accomplish control codes.</td> </tr></table><span class="postbody">
<br/>
That was the original plan.  I was looking using "invalid" unicode values, as they do not run the risk of ...
<br/>
In UTF-8, 0xFE and 0xFF are invalid value.
<br/>
In UTF-16, high-high or low-low surrogate pairs are invalid.
<br/>
I suppose things like the bell and vertical tab could always be used.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">Saves space compared with long ascii words.</td> </tr></table><span class="postbody">
<br/>
Writers need to be able to write in a language that A) they can type, and B) makes sense to humans.  During the build, a regexp will replace the "long ascii words" with something a little more compact.  My question is, what, specifically, should the magic cookie marker be?
<br/>
<br/>
For what it is worth, the cookie structure is:
<br/>
[Cookie Marker Byte(s)] [Function Code] [Parameter Count] [Parameter Bytes]
<br/>
Some parameters are constants, while others are passed into the message and stored in a list.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
