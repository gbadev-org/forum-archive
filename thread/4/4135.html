<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>SIO Normal Mode - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > SIO Normal Mode</h2>
<div id="posts">
<div class="post">
    <h4>#26859 - ProblemBaby - Mon Sep 27, 2004 9:09 pm</h4>
    <div class="postbody"><span class="postbody">Hi
<br/>
<br/>
Ive some problems to get SIO Normal Mode to work.
<br/>
My code works if I put 4 calls to VBlankIntrWait after the transmission code=) but not with one or any!
<br/>
<br/>
When I look at the flow slowly I see that data is transmitted faster then recieved from the the slave.
<br/>
I check if SI is high before I send in the master code is it anything else I should do???
<br/>
<br/>
Here is the code:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void Transfer(u32 Data)
<br/>
{
<br/>
   REG_SIODATA32 = Data;
<br/>
   if (g_MultiPlayer.Identifier) // Slave!
<br/>
   {
<br/>
      REG_SIOCNT |= SIOCNT_ACTIVE; // Activate
<br/>
      REG_SIOCNT &amp;= 0xFFF7; // Clear SO
<br/>
      while (REG_SIOCNT &amp; SIOCNT_ACTIVE);
<br/>
      REG_SIOCNT |= BIT(3); // Set SO
<br/>
   }
<br/>
   else // Master
<br/>
   {
<br/>
      while (REG_SIOCNT &amp; BIT(2)); // check for SI low
<br/>
                                // I think something should be done here!
<br/>
      REG_SIOCNT |= SIOCNT_ACTIVE;
<br/>
      while (REG_SIOCNT &amp; SIOCNT_ACTIVE);
<br/>
   }
<br/>
<br/>
      // If I wait four times for VBlankIntr here it works!
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Plz Help!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26908 - ProblemBaby - Tue Sep 28, 2004 9:19 pm</h4>
    <div class="postbody"><span class="postbody">Im one step closer to the problem.
<br/>
The data is sent to the slave but never recieved.
<br/>
But I dont know how to fix it Do someone see somthing wrong in the code?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26939 - tepples - Wed Sep 29, 2004 9:23 pm</h4>
    <div class="postbody"><span class="postbody">Normal mode with a GBA cable is one-way. You'll need to use a GBC cable for two-way normal mode comms.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26940 - ProblemBaby - Wed Sep 29, 2004 9:38 pm</h4>
    <div class="postbody"><span class="postbody">It works when I select another cable type in no$gba 
<br/>
actually I havent tried it yet on real hardware.
<br/>
But do you mean that it wont work if Ive my normal 4 link cable?
<br/>
even on hardware?
<br/>
<br/>
I also have to ask for now Iam putting a little delay after the master has sent the data in other case the slave sometimes take two packages.
<br/>
is the SO automatically set after the transmission is finished on real hardware? The man who wrote the gbatek was unsure.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26949 - tepples - Thu Sep 30, 2004 12:10 am</h4>
    <div class="postbody"><span class="postbody">On your normal 4 link cable, Normal Mode is used for broadcasts such as loading assets at the beginning of a level, and Multiplayer Mode is used for actual gameplay.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26962 - ProblemBaby - Thu Sep 30, 2004 11:55 am</h4>
    <div class="postbody"><span class="postbody">I was so glad for a moment...
<br/>
It was so easy to perfrom error checking in normal mode!
<br/>
Well it is still easy when I just send stuff to my slaves
<br/>
but when they should communicate I have to use MultiPlayer Mode, I read in the gbatek that slaves should temporarily switch into another mode which doesnt output SD High.
<br/>
<br/>
I dont understand what he means, do someone understand?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26963 - Krakken - Thu Sep 30, 2004 12:54 pm</h4>
    <div class="postbody"><span class="postbody">You don't _have_ to use Multiplayer mode unless you want more than 2 players in your game.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26965 - tepples - Thu Sep 30, 2004 1:00 pm</h4>
    <div class="postbody"><span class="postbody">To stop outputting SD High, try switching into general purpose mode with SO, SI, SC as input, and SD as output set to 0. This will pull SD low so that the master will pick it up.
<br/>
<br/>
Krakken: Players expect GBA multiplayer to work with a GBA cable. You have to use multiplayer mode for 2-way communication over a GBA cable, even in a 2-player game.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#26973 - ProblemBaby - Thu Sep 30, 2004 3:32 pm</h4>
    <div class="postbody"><span class="postbody">some pseudo code:
<br/>
<br/>
StartSession 
<br/>
<br/>
while (1)
<br/>
{
<br/>
<br/>
RCNT = BIT(5) | BIT(15);
<br/>
<br/>
SetMultiPlayerMode
<br/>
Transfer
<br/>
if (SD &amp; HIGH)
<br/>
{
<br/>
No problems do stuff
<br/>
}
<br/>
else
<br/>
{
<br/>
problems.
<br/>
Transfer until SD is high
<br/>
}
<br/>
<br/>
is it something like this?
<br/>
<br/>
}</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
