<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Double buffering - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Double buffering</h2>
<div id="posts">
<div class="post">
    <h4>#47629 - masterlodi - Mon Jul 11, 2005 4:04 pm</h4>
    <div class="postbody"><span class="postbody">I'm trying to write a tron like game with a background.
<br/>
<br/>
I'm using Mode 4 with double buffering.
<br/>
<br/>
I've got this
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
DrawBackground();
<br/>
PlotPixel( user_x, user_y, 0);
<br/>
WaitForVblank();
<br/>
Flip();
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It draws the current drawing position fine but overwrites where the player has been.
<br/>
How do I overcome this please?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47637 - sajiimori - Mon Jul 11, 2005 5:29 pm</h4>
    <div class="postbody"><span class="postbody">Does DrawBackground() overwrite the whole screen with the background?  If that's not what you want, then don't do it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47683 - masterlodi - Tue Jul 12, 2005 9:03 am</h4>
    <div class="postbody"><span class="postbody">I solved this by doing the following
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int main()
<br/>
{
<br/>
  SetPalette();
<br/>
  DrawBackground(); 
<br/>
  SaveScreen();
<br/>
<br/>
  while(1)  // main loop
<br/>
  {
<br/>
    DrawSavedScreen();        
<br/>
    PlotPixel( user_x, user_y, 0); 
<br/>
    WaitForVblank(); 
<br/>
    Flip(); 
<br/>
    SaveScreen();
<br/>
  }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47688 - Cearn - Tue Jul 12, 2005 12:17 pm</h4>
    <div class="postbody"><span class="postbody">Remember the difference between double buffering and page flipping. <span style="font-weight: bold"><span style="font-style: italic">Double buffering</span></span> uses a separate buffer which is draw to and then copied to the display buffer. <span style="font-weight: bold"><span style="font-style: italic">Page flipping</span></span> uses two buffers (pages) and the simply switches between the two. Right now, you're using both at the same time, which is work, but is kind of redundant. Besides that, depending on the implementation of DrawSavedScreen() and SaveScreen(), double buffering may be very, very slow.
<br/>
<br/>
Assuming that PlotPixel alrady accounts for the bytes-vs-VRAM problem, what happens is that you write one pixel to one page, move, flip, then write the next frame to the <span style="font-style: italic">other</span> page. It's not overwriting, the pixel was never drawn in that frame in the first place. To fix that, write to both frames.
<br/>
<span style="font-style: italic">Or</span>, since this is a laserbike game where you just add pixels but never really remove them except for starting a new game, just scrap the double buffering/page flipping altogether.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#47695 - masterlodi - Tue Jul 12, 2005 12:50 pm</h4>
    <div class="postbody"><span class="postbody">Hi Cearn,
<br/>
<br/>
Thanks for clarifying the matter. I will drop the double buffering/page flipping!!
<br/>
<br/>
Thanks again!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
