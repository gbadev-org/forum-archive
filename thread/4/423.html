<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>swi 0x05 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > swi 0x05</h2>
<div id="posts">
<div class="post">
    <h4>#2650 - pollier - Mon Feb 10, 2003 12:57 am</h4>
    <div class="postbody"><span class="postbody">I can't get swi 0x05 to work properly, except in the CowBite emulator (???). On VisualBoyAdvance and on hardware it locks up; I've turned on the VBlank interrupt and everything, but somehow it never detects the interrupt and simply hangs at the statement.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   rIME = 0x1;
<br/>
   rIE = iVBlank;
<br/>
   rDispStat |= bit3;
<br/>
...
<br/>
mainloop {
<br/>
...
<br/>
   asm("swi 0x05");
<br/>
...
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
I'm using an interrupt table, and all the vblank function does is sets the correct bit in IF. I don't think there's a problem with the <span style="font-weight: bold">asm</span> statement 'cause it works fine in CowBite...
<br/>
<br/>
Thanks.<br/>_________________<br/>(Works for me!)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2719 - peebrain - Tue Feb 11, 2003 11:42 am</h4>
    <div class="postbody"><span class="postbody">Might want to try:
<br/>
<br/>
asm("swi 0x050000");
<br/>
<br/>
~Sean</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2766 - doragasu - Wed Feb 12, 2003 12:34 pm</h4>
    <div class="postbody"><span class="postbody">The same happens to me, I got to work other SWI's, and I also tried 0x50000, but the program hangs up and never wakes up. I know that the SWI call is executed because I can see it in the trace of BatGBA emulator, but the program never "wakes up".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2768 - doragasu - Wed Feb 12, 2003 12:36 pm</h4>
    <div class="postbody"><span class="postbody">The same happens to me, I got to work other SWI's, and I also tried 0x50000, but the program hangs up and never wakes up. I know that the SWI call is executed because I can see it in the trace of BatGBA emulator, but the program never wakes up.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2770 - tepples - Wed Feb 12, 2003 3:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>pollier wrote:</b></span></td> </tr> <tr> <td class="quote">I can't get swi 0x05 to work properly, except in the CowBite emulator (???). On VisualBoyAdvance and on hardware it locks up; I've turned on the VBlank interrupt and everything, but somehow it never detects the interrupt and simply hangs at the statement.
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   rIME = 0x1;
<br/>
   rIE = iVBlank;
<br/>
   rDispStat |= bit3;
<br/>
...
<br/>
mainloop {
<br/>
...
<br/>
   asm("swi 0x05");
<br/>
...
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
I'm using an interrupt table, and all the vblank function does is sets the correct bit in IF.</span></td> </tr></table><span class="postbody">
<br/>
Even if you acknowledge an interrupt to the hardware, you also need to acknowledge it to the BIOS.  To do this, set the correct bit in 0x03fffff8.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2813 - pollier - Thu Feb 13, 2003 2:34 am</h4>
    <div class="postbody"><span class="postbody">Er...what is the correct bit? 0x03fffff8 isn't a usual register in GBA.H, is it? And if I do this, will I need to still enable the interrupt register and dispstat?
<br/>
<br/>
Thanks for your help so far<br/>_________________<br/>(Works for me!)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2814 - pollier - Thu Feb 13, 2003 2:36 am</h4>
    <div class="postbody"><span class="postbody">[double post]</span><span class="gensmall"><br/><br/>Last edited by pollier on Fri Feb 14, 2003 2:23 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#2818 - DekuTree64 - Thu Feb 13, 2003 3:10 am</h4>
    <div class="postbody"><span class="postbody">I just tried setting the bit at that address (checked the nocash doc and it's really 0x3007ff8, which is right near the end of IWRAM), and it does in fact work. In your IRQ handler, where you write your flag var back to REG_IF, write it to 0x3007ff8 too and everything works fine. I assume it's some sort of special BIOS pseudo-register, but I hadn't ever heard of it either. Oh well, if it works, it works.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2826 - tepples - Thu Feb 13, 2003 4:55 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>DekuTree64 wrote:</b></span></td> </tr> <tr> <td class="quote">I just tried setting the bit at that address (checked the nocash doc and it's really 0x3007ff8, which is right near the end of IWRAM)</td> </tr></table><span class="postbody">
<br/>
IWRAM mirroring makes 0x03007ff8 and 0x03fffff8 point to the same memory cell.  It's just a bit faster to write to 0x03fffff8 because of ARM architecture's weird (compared to MIPS) handling of constant values.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#2864 - pollier - Fri Feb 14, 2003 2:20 am</h4>
    <div class="postbody"><span class="postbody">Thanks, I've got it working now. This post is mainly a test to see if the posting is working 'cause I was getting SQL errors when submitting.
<br/>
<br/>
EDIT: Yay, it works. I get this message however:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Could not insert new word matches
<br/>
<br/>
DEBUG MODE
<br/>
<br/>
SQL Error : 1034 Incorrect key file for table: 'phpbb_search_wordmatch'. Try to repair it
<br/>
<br/>
INSERT INTO phpbb_search_wordmatch (post_id, word_id, title_match) SELECT 2864, word_id, 0 FROM phpbb_search_wordlist WHERE word_text IN ('thanks', 'ive', 'working', 'post', 'mainly', 'test', 'posting', 'cause', 'getting', 'sql', 'errors', 'submitting')
<br/>
<br/>
Line : 242
<br/>
File : /data/www/gbadev.org/html/forum/includes/functions_search.php
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>(Works for me!)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
