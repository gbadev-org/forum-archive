<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Newbie question: drawline - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Newbie question: drawline</h2>
<div id="posts">
<div class="post">
    <h4>#11179 - fingalscave - Sun Sep 28, 2003 11:19 am</h4>
    <div class="postbody"><span class="postbody">Hello all :)
<br/>
<br/>
I'm a relative newbie both to C++ and gba programming, but I'm managing, kinda...
<br/>
<br/>
anyways I've hit a bit of an obstacle. I've written a drawline function which is giving me problems, here is the code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int Line(int x1, int y1, int x2, int y2, int col)
<br/>
{
<br/>
   int dx, dy, dif, i, tx, ty;
<br/>
   dx = x2 - x1;
<br/>
   dy = y2 - y1;
<br/>
   if(dx&gt;dy)
<br/>
   {
<br/>
      dif = dx;
<br/>
   }
<br/>
   else
<br/>
   {
<br/>
      dif = dy;
<br/>
   }
<br/>
   for(i = 0; i &lt; dif; i++)
<br/>
   {
<br/>
      tx = dx / dif * i + x1;
<br/>
      ty = dy / dif * i + y1;
<br/>
      Plotpixel(tx , ty, col);
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
it works fine for lines which are horizontal, vertical, or 45-diagonal, but any other gives a horizontal or vertical (whichever is longest). I think it's something to do with tx and ty being ints, but I'm not sure what to do. can anyone help?
<br/>
<br/>
Cheers :)<br/>_________________<br/>How do you let someone know of your hotcakes are selling well?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11183 - tepples - Sun Sep 28, 2003 3:44 pm</h4>
    <div class="postbody"><span class="postbody">Google results should solve your problems: <a class="postlink" href="http://www.google.com/search?q=bresenham%20line%20algorithm" target="_blank">bresenham line algorithm</a><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11191 - Lupin - Sun Sep 28, 2003 7:59 pm</h4>
    <div class="postbody"><span class="postbody">The bresenham algo isn't the fastest though, I think on an gba you would probably go better using an DDA function with reciprocal table.
<br/>
<br/>
You just have to find out how many Y pixels you have to go when going left 1 x pixel, this is simply done by deltay / deltax (the divide is done by using an reciprocal table which you could keep at a size of like 300 entries) and then you just go from the left point x of the line to the right point x, add the value to the left points y value and if you did everything right (and I don't talk crap here) you'll end at the y value of the right point.
<br/>
<br/>
I would write such an function in asm (iwram) and you could use this reciprocal function (ARM ADS version, 512 entries):
<br/>
<br/>
reciproc	space 2048  ;1kb reciproc table
<br/>
<br/>
EXPORT reciproc
<br/>
EXPORT reciprocal
<br/>
EXPORT initreciprocal
<br/>
<br/>
;;;;;;;;;;;;;;
<br/>
;reciprocal r0
<br/>
<br/>
reciprocal
<br/>
movs    r0,r0 
<br/>
rsbmi   r0,r0,#0
<br/>
ldr     r1,=0x1FF
<br/>
and	    r0,r0,r1		    ;AND 255
<br/>
ldr	    r1,=reciproc
<br/>
ldr  	r0,[r1,r0,lsl#2]
<br/>
rsbmi   r0,r0,#0
<br/>
bx	lr
<br/>
<br/>
;;;;;;;;;;;;;;;
<br/>
;initreciprocal
<br/>
<br/>
initreciprocal
<br/>
mov     r2, #0
<br/>
ldr     r3, =reciproc
<br/>
str     r2,[r3,#0]
<br/>
<br/>
nextvalue
<br/>
add	    r2,r2,#1
<br/>
mov	    r0,#65536
<br/>
mov	    r1,r2
<br/>
swi	    0x60000
<br/>
<br/>
ldr     r3, =reciproc
<br/>
str     r0, [r3,r2,lsl#2]
<br/>
<br/>
ldr     r1,=511
<br/>
cmp	    r2,r1
<br/>
blt	    nextvalue
<br/>
bx	    lr</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11246 - fingalscave - Tue Sep 30, 2003 12:54 am</h4>
    <div class="postbody"><span class="postbody">thank you :)
<br/>
<br/>
think I'll stick to c++ for now...<br/>_________________<br/>How do you let someone know of your hotcakes are selling well?</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
