<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Scan-Line Circle Fill Algorithm - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Scan-Line Circle Fill Algorithm</h2>
<div id="posts">
<div class="post">
    <h4>#167048 - headspin - Fri Feb 27, 2009 7:47 pm</h4>
    <div class="postbody"><span class="postbody">I need a scanline circle fill alg for creating a window effect. The only one I've found is the following.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void circleFill(int r)
<br/>
{
<br/>
   int x1, x2;
<br/>
   for (int y=0; y&lt;r*2; y++)
<br/>
   {
<br/>
      x1 = ROUND(r + sqrt(SQR(r) - SQR(y - r)));
<br/>
      x2 = ROUND(r - sqrt(SQR(r) - SQR(y - r)));
<br/>
      line(x1, y, x2, y);
<br/>
   }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
The accuracy is not as important as speed as it needs to be calculated during a HBLANK interrupt. I also need to eventually translate it to asm so is there a similar method that doesn't use the sqrt and would be easier to translate to ARM asm? It can be use a sin lut if necessary but needs to be calculated for each VCOUNT.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167049 - Cearn - Fri Feb 27, 2009 8:09 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://www.coranac.com/tonc/text/dma.htm#sec-demo" target="_blank">Tonc:dma demo</a>.
<br/>
<br/>
For a circular window you don't need a fill algorithm, just the one for the circumference, like <a class="postlink" href="http://en.wikipedia.org/wiki/Midpoint_circle_algorithm" target="_blank">Midpoint circle algorithm</a>. First create a buffer to contain the windowing coordinates for each scanline -- do NOT calculate everything inside the HBlank itself, prepare it beforehand. Run the circle algorithm to get the left and right boundaries for each scanline, clip them and fill the buffer. Use HDMA or an HBlank interrupt to update the windows. Because of the amount of branching involved, ARM code would be more efficient, but that's just an optimization detail.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167068 - Miked0801 - Sat Feb 28, 2009 5:23 am</h4>
    <div class="postbody"><span class="postbody">Breshenhiems &lt;sp&gt; circle algorithm.  Integer math and very fast.  Look it up.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167084 - Kyoufu Kawa - Sat Feb 28, 2009 1:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Miked0801 wrote:</b></span></td> </tr> <tr> <td class="quote">Breshenhiems &lt;sp&gt; circle algorithm.  Integer math and very fast.  Look it up.</td> </tr></table><span class="postbody">Bresenham.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#167091 - headspin - Sat Feb 28, 2009 4:37 pm</h4>
    <div class="postbody"><span class="postbody">Thanks guys I'm using Cearn's demo as a guide which uses Bresenham and dma.<br/>_________________<br/><a class="postlink" href="http://headsoft.com.au/index.php?category=warhawk" target="_blank">Warhawk DS</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=mmll" target="_blank">Manic Miner: The Lost Levels</a> | <a class="postlink" href="http://headsoft.com.au/index.php?category=tdg" target="_blank">The Detective Game</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
