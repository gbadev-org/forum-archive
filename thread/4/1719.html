<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Effective Sprite Animation - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Effective Sprite Animation</h2>
<div id="posts">
<div class="post">
    <h4>#8739 - Snoobab - Fri Jul 18, 2003 9:11 pm</h4>
    <div class="postbody"><span class="postbody">Hi Guys,
<br/>
<br/>
I've got a bit of a problem with sprite animation.
<br/>
<br/>
In a game I'm busy with I want to playback a explosion animation when a missile hits a enemy. I know of two ways which this can be done, firstly I could load all the animation frames into OAM memory via DMA(which uses a lot of precious OAM memory) and then just change the attritute2 of the sprite to point to the next frame in OAM memory. Or I could just overwrite the animation frame-by-frame(via DMA) which would mean I only have to set aside enough OAM memory for one frame of the animation. Here's my problem: Both methods work but the first method uses a lot of memory (animation frames are 32x32x256 sprites!) and when I use the second method there is a pretty big slowdown while the frame's are being copied/played back via DMA.
<br/>
<br/>
Have any of u run into a problem like this before?
<br/>
<br/>
Lastly, what is the best way to make a background continually scroll? Here my function is which does it for me:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void bg_auto_scroll(void)
<br/>
{
<br/>
   static u16 BGScroll = 0;
<br/>
   
<br/>
   WaitForVSync();
<br/>
<br/>
   REG_BG0HOFS = 100;
<br/>
   REG_BG0VOFS = BGScroll;
<br/>
<br/>
   BGScroll --;
<br/>
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
can it be improved upon?
<br/>
<br/>
Hope u can help,
<br/>
<br/>
Thanks.
<br/>
<br/>
- Ed.[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8747 - XeroxBoy - Sat Jul 19, 2003 1:37 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
u8 BGScroll=0; // Declare this as global or at the beginning of your main game loop or whatever.
<br/>
<br/>
// At the end of your game loop:
<br/>
<br/>
BGScroll--;
<br/>
REG_BG0VOFS = BGScroll; 
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Nice and simple (though, likely too fast. You might want to have another variable count your frames and then only update the scroll every few frames).
<br/>
<br/>
As for the animation issue, I think DMAing it in would be the best way. So long as you don't have too many frames, it shouldn't be too slow.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8821 - ampz - Sun Jul 20, 2003 11:52 pm</h4>
    <div class="postbody"><span class="postbody">I don't see how DMA:ing in new sprites every V-blank would cause any slowdown at all. (you actually don't want to copy new data into OAM every frame as that will make the animations too fast. Every second, third or even fouth frame is more reasonable.)
<br/>
<br/>
I've written a game thing where I completely filled the OAM with animated sprites, all updated with DMA. No problem whatsoever. You must be doing something wrong.
<br/>
<br/>
OAM is not very large, so it's not that much data to update.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8826 - tepples - Mon Jul 21, 2003 3:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">I don't see how DMA:ing in new sprites every V-blank would cause any slowdown at all.</td> </tr></table><span class="postbody">
<br/>
My document "Managing Sprite Cel VRAM" (available <a class="postlink" href="http://www.pineight.com/gba/managing-sprite-vram.txt" target="_blank">on pineight.com</a> and in gbadev.org's tools section) says you're right, <span style="font-style: italic">unless</span> the sprite cels are compressed. Then you may want to cache decompressed cels in EWRAM or VRAM.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8851 - Ninja - Mon Jul 21, 2003 6:47 pm</h4>
    <div class="postbody"><span class="postbody">I have a sprite demo laying around somewhere that illustrates 32 32x32x256 sprites on the screen.  Each one is animated, and is updated every vblank via DMA.  The sprites displayed just fine, and changed frames way too fast.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8854 - Snoobab - Mon Jul 21, 2003 8:22 pm</h4>
    <div class="postbody"><span class="postbody">I must definatlly be doing something wrong! I think its my DMA macros. The animation is consists of 16 frames and is 32x32x256.
<br/>
<br/>
Thanks for your help.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
