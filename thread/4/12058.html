<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>CpuFastSet, volatile and inline - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > CpuFastSet, volatile and inline</h2>
<div id="posts">
<div class="post">
    <h4>#113825 - kusma - Sun Dec 31, 2006 1:53 am</h4>
    <div class="postbody"><span class="postbody">Hi there, I've been debugging this one issue almost all day long, and I'm finally getting somewhere. The problem I have is CpuFastSet not working properly (or rather not working at all) in some cases when inlined into a function. I've made a small test-application, and put it up here:
<br/>
<br/>
<a class="postlink" href="http://pimpmobile.kjip.no/temp/volatile_buffer.zip" target="_blank">http://pimpmobile.kjip.no/temp/volatile_buffer.zip</a>
<br/>
<br/>
This illustrates the problem. With a word count that is not a multiple of eight, everything seems to go fine, but as soon as I try to clear a multiple of eight words, everything goes poo.
<br/>
<br/>
Now, try playing around with the flags INLINE_FJALL, INLINE_CLEAR_BUFFER and VOLATILE_BUFFER and see what happens. The conclusions I managed to make was that with full inlining everything goes fine with or without volatile. With full inlining and no volatile, only one element gets corrupted when doing 16 words. With 15 all is fine. with volatile, everything is fine.
<br/>
<br/>
What amazes me, is the fact that volatile changes anything at all. This is global memory, no restricts or consts or anything to mess with guarantees. Any function should at any time be able to change that memory.
<br/>
<br/>
Does anybody have any ideas about this one?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113829 - keldon - Sun Dec 31, 2006 2:59 am</h4>
    <div class="postbody"><span class="postbody"><a href="http://nocash.emubase.de/gbatek.htm#biosmemorycopy" target="_blank">http://nocash.emubase.de/gbatek.htm#biosmemorycopy</a>
<br/>
<br/>
Source address and destination address must be word aligned.
<br/>
<br/>
Ahh:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for (i = words &amp; 7; i; --i)</td> </tr></table><span class="postbody">
<br/>
Will only ever iterate from 7-1. Is that intended? This would explain why one value gets corrupted.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (i = 0; i &lt; 16; ++i)
<br/>
   {
<br/>
      buffer[i] = 1;
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
Should be:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (i = 0; i &lt; 16; i++)
<br/>
   {
<br/>
      buffer[i] = 1;
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
<br/>
You are increasing i before it enters the loop.
<br/>
<br/>
Also <span style="font-style: italic"><span style="font-weight: bold">if ( i &amp; ~7)</span></span> is equivalent to <span style="font-style: italic"><span style="font-weight: bold">if (i &gt;= 8)</span></span>.
<br/>
<br/>
I understand that your method, clear_buffer aims to clear the words that CpuFastSet does not. Beware of 'clever code' and anything that looks 'difficult'!
<br/>
<br/>
Maybe change for:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for (i = 0; i &lt; ( words&amp;7); i++ )
<br/>
   {
<br/>
      *dst++ = 0;
<br/>
   }
<br/>
<br/>
   if ( words &gt;= 8 ) fjall(src, target, DMA_SRC_FIXED | (words &amp; ~7));</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113833 - kusma - Sun Dec 31, 2006 3:32 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Source address and destination address must be word aligned.
<br/>
</td> </tr></table><span class="postbody">
<br/>
They are, since this is arrays of words ;)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Ahh:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for (i = words &amp; 7; i; --i)</td> </tr></table><span class="postbody">
<br/>
Will only ever iterate from 7-1. Is that intended? This would explain why one value gets corrupted.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
This is what is intended. And no, it does not explain it ;)
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (i = 0; i &lt; 16; ++i)
<br/>
   {
<br/>
      buffer[i] = 1;
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
Should be:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (i = 0; i &lt; 16; i++)
<br/>
   {
<br/>
      buffer[i] = 1;
<br/>
   }</td> </tr></table><span class="postbody">
<br/>
<br/>
You are increasing i before it enters the loop.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
...nope, they are equalient in this case. In general ++i is better programming practice in for-loops, because ++i does not return the old object, and hence does not need to take a copy of it. for integers, this doesn't really matter, but for data-structure iterators etc it does matter a lot.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Also <span style="font-style: italic"><span style="font-weight: bold">if ( i &amp; ~7)</span></span> is equivalent to <span style="font-style: italic"><span style="font-weight: bold">if (i &gt;= 8)</span></span>.
<br/>
<br/>
I understand that your method, clear_buffer aims to clear the words that CpuFastSet does not. Beware of 'clever code' and anything that looks 'difficult'!
<br/>
</td> </tr></table><span class="postbody">
<br/>
True, and I would like to point out that this isn't "production"-code, it's me trying to bang some sense into the problem ;)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Maybe change for:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   for (i = 0; i &lt; ( words&amp;7); i++ )
<br/>
   {
<br/>
      *dst++ = 0;
<br/>
   }
<br/>
<br/>
   if ( words &gt;= 8 ) fjall(src, target, DMA_SRC_FIXED | (words &amp; ~7));</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
No cigar, still the same issues :(
<br/>
<br/>
Edit: I forgot to say thanks for atleast having a go at it, and for giving some good pointers... so thanks ;)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113840 - Peter - Sun Dec 31, 2006 5:25 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
fjall(src, target, DMA_SRC_FIXED | (words &amp; ~7));</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
DMA_SRC_FIXED should probably be 1&lt;&lt;24.
<br/>
<br/>
I tried a few variations and it seems to me that it is <span style="font-style: italic">fjall</span> that causes the problem. I added the noinline attribute to fjall's implementation:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void __attribute__((noinline)) fjall(const BUFFER_STORAGE void *src, void BUFFER_STORAGE *dst, int mode)
<br/>
{
<br/>
  ...
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
and then it worked no matter if clear_buffer gets inlined or not, the volatile keyword also didn't broke anything.
<br/>
<br/>
Removed noinline again and took a quick look with no$gba at it. The value in r3 is what gets displayed for the elements of <span style="font-style: italic">buffer</span> in the seconds printf loop when <span style="font-style: italic">fjall</span> failed. (i suck at thumb assember)
<br/>
<br/>
Maybe it has to do with r3, which, for example, gets clobbered but not restored again.
<br/>
<br/>
Just an idea.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113849 - kusma - Sun Dec 31, 2006 11:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote">DMA_SRC_FIXED should probably be 1&lt;&lt;24.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Yeah, it is. It's the normal define from libgba.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote">Maybe it has to do with r3, which, for example, gets clobbered but not restored again.
<br/>
<br/>
Just an idea.</td> </tr></table><span class="postbody">
<br/>
<br/>
Yeah, it seems like r3 getting destroyed might be the problem here, but how come? It's in the clobber-list in the inline asm-statement. And beyond that, I have basically no control over the register allocation and clobbering...
<br/>
<br/>
[edit:] Hmm, no... r3 gets destroyed because it's not being guaranteed to be kept alive by the calling convention (r0-r3 is for the first 4 parameters).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113851 - kusma - Sun Dec 31, 2006 12:13 pm</h4>
    <div class="postbody"><span class="postbody">Okay, I think I've found out exactly what goes wrong. It seems to me that the variable zero (allocated on the stack, sp+4) doesn't get initialized when not doing the little loop first. Here's the assembly generated for clear_buffer in my current case (the same as I posted, inlining of fjall but not clear_buffers, no volatile), only beautified a bit.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   .align   2
<br/>
   .global   clear_buffer
<br/>
   .code 16
<br/>
   .thumb_func
<br/>
   .type   clear_buffer, %function
<br/>
clear_buffer:
<br/>
   push   {r4, r5, r6, lr}
<br/>
   mov   r3, #7   @ tmp114,
<br/>
   mov   r5, r1   @ i, words
<br/>
   sub   sp, sp, #8   @,,
<br/>
   mov   r6, r0   @ dst, target
<br/>
   and   r5, r3   @ i, tmp114
<br/>
   beq   .skip_loop   @,
<br/>
<br/>
   /* setup registers for copy loop */
<br/>
   mov   r3, #0   @ tmp116,                 /* NOTE THIS*/
<br/>
   str   r3, [sp, #4]   @ tmp116, zero  /* sp+4 doesn't get initialized any other place! */
<br/>
   mov   r2, r0   @ dst.66, dst
<br/>
   mov   r3, r5   @ i.65, i
<br/>
   mov   r4, #0   @ tmp117,
<br/>
<br/>
   /* copy loop */
<br/>
.loop:
<br/>
   sub   r3, r3, #1   @ i.65,
<br/>
   stmia   r2!, {r4}   @, tmp117
<br/>
   cmp   r3, #0   @ i.65,
<br/>
   bne   .loop   @,
<br/>
   
<br/>
   lsl   r3, r5, #2   @ tmp118, i,
<br/>
   add   r6, r0, r3   @ dst, target, tmp118
<br/>
<br/>
.skip_loop:
<br/>
   mov   r3, #7   @ tmp119,
<br/>
   bic   r1, r3   @ words, tmp119
<br/>
   mov   r5, r1   @ D.1457, words
<br/>
   beq   .done   @,
<br/>
   mov   r3, #128   @ tmp121,
<br/>
   lsl   r3, r3, #17   @ tmp121, tmp121,
<br/>
   add   r4, sp, #4   @ tmp120,,
<br/>
   orr   r5, r5, r3   @ tmp122, tmp121
<br/>
   
<br/>
   /* this is the beginning of my inline code */
<br/>
<br/>
   mov r0, r4     @ tmp120
<br/>
   mov r1, r6     @ dst
<br/>
   mov r2, r5    @ tmp122
<br/>
   swi 0xC
<br/>
<br/>
   /* this is the end of my inline code */
<br/>
<br/>
   .code   16
<br/>
.done:
<br/>
   add   sp, sp, #8   @,,
<br/>
   @ sp needed for prologue   @
<br/>
   pop   {r4, r5, r6}
<br/>
   pop   {r0}
<br/>
   bx   r0
<br/>
   .size   clear_buffer, .-clear_buffer
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
If i move the initin of sp+4 up a couple of lines (before the branch), it all works. Now, what on earth made the compiler forget to initialize that variable?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113853 - Cearn - Sun Dec 31, 2006 1:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If i move the initin of sp+4 up a couple of lines (before the branch), it all works. Now, what on earth made the compiler forget to initialize that variable?</td> </tr></table><span class="postbody">
<br/>
It's part of the optimizer somehow, something along the lines of "we don't ever actually <span style="font-style: italic">use</span> the contents of the location of zero anywhere, so it's okay to put its value in a register". Something like that, anyway. To fix, make the zero variable a volatile, so it's never optimized into a register:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   volatile u32 zero = 0;
<br/>
   fjall(&amp;zero, dst, DMA_SRC_FIXED | (words &amp; ~7));
<br/>
</td> </tr></table><span class="postbody">
<br/>
Or use something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void CpuFastFill(u32 src, void *dst, u32 mode)
<br/>
{
<br/>
   /* call BIOS-function CpuFastSet() to clear buffer */
<br/>
   asm (
<br/>
      "push {%[src]}   \n"
<br/>
      "mov r0, sp      \n"
<br/>
      "mov r1, %[dst]  \n"
<br/>
      "mov r2, %[mode] \n"
<br/>
      "swi 0xC         \n"
<br/>
      "add sp, #4      \n"
<br/>
      : /* no output */
<br/>
      : /* inputs */
<br/>
         [src]  "r"(src),
<br/>
         [dst]  "r"(dst),
<br/>
         [mode] "r"(mode)
<br/>
      : "r0", "r1", "r2", "r3" /* clobbers */
<br/>
   );
<br/>
}
<br/>
<br/>
// usage
<br/>
CpuFastFill(0, dst, DMA_SRC_FIXED | (words &amp; ~7));
<br/>
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113854 - kusma - Sun Dec 31, 2006 1:23 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If i move the initin of sp+4 up a couple of lines (before the branch), it all works. Now, what on earth made the compiler forget to initialize that variable?</td> </tr></table><span class="postbody">
<br/>
It's part of the optimizer somehow, something along the lines of "we don't ever actually <span style="font-style: italic">use</span> the contents of the location of zero anywhere, so it's okay to put its value in a register". Something like that, anyway.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
Well, an assembly-block that takes in a pointer to a variable may very well mess with the contents of that pointer, so I don't see how the compiler is allowed to do this optimization. Every variable that is taken a pointer to, is kept in memory. Atleast it seems so. And the variable zero seems to get the right address, it's just it's content that isn't initialized.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">To fix, make the zero variable a volatile, so it's never optimized into a register:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   volatile u32 zero = 0;
<br/>
   fjall(&amp;zero, dst, DMA_SRC_FIXED | (words &amp; ~7));
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
OK, the work-around I came up with was simply making zero static const. That way it's not dynamically allocated on the stack, but rather put in the data-section. IMO that's cleaner in the first place.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cearn wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Or use something like this:
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void CpuFastFill(u32 src, void *dst, u32 mode)
<br/>
{
<br/>
   /* call BIOS-function CpuFastSet() to clear buffer */
<br/>
   asm (
<br/>
      "push {%[src]}   \n"
<br/>
      "mov r0, sp      \n"
<br/>
      "mov r1, %[dst]  \n"
<br/>
      "mov r2, %[mode] \n"
<br/>
      "swi 0xC         \n"
<br/>
      "add sp, #4      \n"
<br/>
      : /* no output */
<br/>
      : /* inputs */
<br/>
         [src]  "r"(src),
<br/>
         [dst]  "r"(dst),
<br/>
         [mode] "r"(mode)
<br/>
      : "r0", "r1", "r2", "r3" /* clobbers */
<br/>
   );
<br/>
}
<br/>
<br/>
// usage
<br/>
CpuFastFill(0, dst, DMA_SRC_FIXED | (words &amp; ~7));
<br/>
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, well, that's one of the things I wanted to avoid in the first place. ;)
<br/>
<br/>
Anyway, thanks for the help so far. I have a somewhat robust work-around, but I'd still like to hear an explanation to why the compiler does this in the first place, if anyone knows.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#113855 - Peter - Sun Dec 31, 2006 1:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote">DMA_SRC_FIXED should probably be 1&lt;&lt;24.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Yeah, it is. It's the normal define from libgba.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
From my devkitpro installation /libgba/include/gba_dma.h, line 66:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define DMA_SRC_FIXED   (2&lt;&lt;23)
<br/>
</td> </tr></table><span class="postbody">
<br/>
Strange, I have probably an old version or something :)</span><span class="gensmall"><br/><br/>Last edited by Peter on Sun Dec 31, 2006 2:02 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#113856 - kusma - Sun Dec 31, 2006 2:00 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Peter wrote:</b></span></td> </tr> <tr> <td class="quote">DMA_SRC_FIXED should probably be 1&lt;&lt;24.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Yeah, it is. It's the normal define from libgba.
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
From my devkitpro installation /libgba/include/gba_dma.h, line 66:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define DMA_SRC_FIXED   (2&lt;&lt;23)
<br/>
</td> </tr></table><span class="postbody">
<br/>
Strange :)</span></td> </tr></table><span class="postbody">
<br/>
<br/>
no, not strange at all ;)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">&gt;&gt;&gt; (2 &lt;&lt; 23) == (1 &lt;&lt; 24)
<br/>
True
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
2 = 1 &lt;&lt; 1
<br/>
so 
<br/>
2 &lt;&lt; 23 = (1 &lt;&lt; 1) &lt;&lt; 23 = 1 &lt;&lt; 24</span><span class="gensmall"><br/><br/>Last edited by kusma on Sun Dec 31, 2006 2:04 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#113857 - Peter - Sun Dec 31, 2006 2:03 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>kusma wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">&gt;&gt;&gt; (2 &lt;&lt; 23) == (1 &lt;&lt; 24)
<br/>
True
<br/>
</td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Correct. I didn't think it through :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
