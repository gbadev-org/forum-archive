<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Plattformer mechanics (slopes) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Plattformer mechanics (slopes)</h2>
<div id="posts">
<div class="post">
    <h4>#49342 - KonVex - Thu Jul 28, 2005 11:50 pm</h4>
    <div class="postbody"><span class="postbody">I was thinking about doing a plattformer prototype, but there is one concept I still need to grasp before I tackle this project.
<br/>
<br/>
I'm familiar with basic collision-detection, yet I'm not sure how the interaction of the player-sprite with the environment could be done in an elegant manner. Basically these cases have to be considered:
<br/>
<ul>-Player is walking on a plane
<br/>
-Player is walking against a wall
<br/>
-Player is falling down if there is no ground beneath
<br/>
<span style="font-weight: bold">-Player is walking up a slope
<br/>
-Player is walking down a slope</span>
<br/>
(jumping is omitted for now)</ul>
<br/>
The first three cases are easy, but the slopes could get really tricky.
<br/>
How are slopes usually implemented in plattformers?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#49346 - sajiimori - Fri Jul 29, 2005 12:18 am</h4>
    <div class="postbody"><span class="postbody">Going up slopes is easy.  When the player presses to the right, an initial rightward velocity is applied.  Then the collision detection says that moving directly right will hit an upward slope, and it corrects the motion vector to move along the slope instead.
<br/>
<br/>
Going down slopes is harder because the collision system won't hit anything and you'll repeatedly fall off as if it's a cliff.  My solution is to keep track of the slope of the surface you're standing on (if any) and adjust your initial velocity to be parallel to that.
<br/>
<br/>
After moving along the slope, check below the character to see if the ground is still there.  If not, change the ground slope type to "none" to specify that you're in the air.
<br/>
<br/>
The essential components of my collision system are:
<br/>
<br/>
- A trace function that takes an object and a motion vector and returns the first thing they would hit by moving along the vector, if anything.
<br/>
<br/>
- A slide function that takes an object and a motion vector and returns the way they should move if they were to slide along the surface(s) they hit.  This is implemented in terms of the trace function.
<br/>
<br/>
- A walk function that takes an object, a motion vector, and an initial ground slope.  It alters the motion vector to be parallel to the ground and then calls slide.  After sliding, it uses the trace function to see if there is any ground below the new position.  It returns the resulting motion and a flag for whether the object is still on the ground.
<br/>
<br/>
- A walker object that maintains the current ground slope and a flag for whether the object is on the ground.  If it's on the ground, it calls the walk function and updates its state based on the results.  If it's in the air, it calls the slide function and adopts collided surfaces as the new ground when possible.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
