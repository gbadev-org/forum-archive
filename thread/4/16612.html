<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>serious memory issues - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > serious memory issues</h2>
<div id="posts">
<div class="post">
    <h4>#168243 - moonlightcheese - Thu Apr 16, 2009 8:12 pm</h4>
    <div class="postbody"><span class="postbody">ok so i'm building my first gba game and running into some serious memory woes.  i've moved all data into source files and used externs in headers and i can't get enough room for background music.  is there some way to access gamepak memory and actually use it in an emulator or some way to get a little more out of this system?
<br/>
<br/>
i'm able to make a single level of this game by copying everything directly into tile memory (backgrounds, sprites, etc) but how can i possibly get enough memory to contain other levels, sprite data and audio for more levels and content?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168245 - kusma - Thu Apr 16, 2009 9:35 pm</h4>
    <div class="postbody"><span class="postbody">put data in ROM, by declaring it as "const".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168246 - moonlightcheese - Thu Apr 16, 2009 11:04 pm</h4>
    <div class="postbody"><span class="postbody">that... solved it.  god i feel like an idiot.  thanks!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#168249 - kusma - Fri Apr 17, 2009 12:01 am</h4>
    <div class="postbody"><span class="postbody">No stress. Everyone makes that mistake at some point :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172255 - Kensai - Wed Jan 27, 2010 7:59 pm</h4>
    <div class="postbody"><span class="postbody">I've read that the GBA has 32K "in-chip" + 256K "on-board" memory. What's the difference actually? And which memory is accessed if I don't use "const"?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172258 - Dwedit - Wed Jan 27, 2010 8:21 pm</h4>
    <div class="postbody"><span class="postbody">The In-chip memory is much faster.
<br/>
<br/>
And apparently, data is all declared in IWRAM, unless you allocate it with malloc, or explicitly declare it elsewhere.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172260 - Kensai - Wed Jan 27, 2010 8:33 pm</h4>
    <div class="postbody"><span class="postbody">Thank you for the fast answer! So if I got you right, I have to use "malloc" if I want to access the slower on-board memory?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172261 - Exophase - Wed Jan 27, 2010 8:34 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kensai wrote:</b></span></td> </tr> <tr> <td class="quote">I've read that the GBA has 32K "in-chip" + 256K "on-board" memory. What's the difference actually? And which memory is accessed if I don't use "const"?</td> </tr></table><span class="postbody">
<br/>
<br/>
The 32KB IWRAM is faster than the 256KB EWRAM.
<br/>
<br/>
The devkitAdvance link script reveals the following defaults:
<br/>
<br/>
.data (initialized global variables) defaults to IWRAM.
<br/>
.bss (uninitialized variables) defaults to IWRAM.
<br/>
.text (code) defaults to ROM.
<br/>
.rodata (const global variables) defaults to ROM.
<br/>
<br/>
You can override this per-variable using attributes:
<br/>
<br/>
int global_in_ewram __attribute__((section (".ewram")));
<br/>
<br/>
You can also cause .data and .bss to be in EWRAM by declaring the following somewhere in your code:
<br/>
<br/>
int __gba_ewram_data __attribute__((section(".devkitadv.config")));</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172262 - Dwedit - Wed Jan 27, 2010 9:20 pm</h4>
    <div class="postbody"><span class="postbody">DevKitAdvance?  People still use that?<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172268 - brave_orakio - Thu Jan 28, 2010 2:54 am</h4>
    <div class="postbody"><span class="postbody">I thought that local variables go to EWRAM and global variables go to IWRAM? And malloc goes to IWRAM if not explicitly declared to go to EWRAM?<br/>_________________<br/>help me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172273 - Cearn - Thu Jan 28, 2010 10:37 am</h4>
    <div class="postbody"><span class="postbody">No, local variable go into registers, which use up no memory at all, or the stack, which is in IWRAM. Globals go into IWRAM if not explicitly declared otherwise. Malloc goes to EWRAM.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172279 - Kensai - Thu Jan 28, 2010 8:10 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The In-chip memory is much faster.</td> </tr></table><span class="postbody">
<br/>
<br/>
Maybe this is a silly question. But do emulators like Mappy or VBA simulate these different speeds of IWRAM, EWRAM and ROM?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172280 - Dwedit - Thu Jan 28, 2010 8:46 pm</h4>
    <div class="postbody"><span class="postbody">NO$GBA does the best job of simulating RAM speed, but it depends on whether you are using an old version of VisualBoyAdvance or not.  Old versions don't simulate RAM speed accurately, newer versions do a better job.
<br/>
<br/>
Also don't forget that Video RAM can also be used as fast RAM if you need it.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172306 - Kensai - Fri Jan 29, 2010 11:43 pm</h4>
    <div class="postbody"><span class="postbody">How do I malloc in IWRAM? (I want to copy dynamic arrays from EWRAM to IWRAM.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172308 - Exophase - Sat Jan 30, 2010 3:45 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">DevKitAdvance? People still use that?</td> </tr></table><span class="postbody">
<br/>
<br/>
I have no idea what people use, but the link script I looked up was from whatever is current.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Dwedit wrote:</b></span></td> </tr> <tr> <td class="quote">Also don't forget that Video RAM can also be used as fast RAM if you need it.</td> </tr></table><span class="postbody">
<br/>
<br/>
It still isn't clear if VRAM is 32bit or 16bit, but 16bit would be more realistic. In which case you could say that it's not quite as fast as IWRAM, at least when writing quantities of 32bits or more.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#172309 - Dwedit - Sat Jan 30, 2010 3:51 am</h4>
    <div class="postbody"><span class="postbody">I use it as fast 8-bit read ram.  It is indeed 16-bit memory.<br/>_________________<br/>"We are merely sprites that dance at the beck and call of our button pressing overlord."</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
