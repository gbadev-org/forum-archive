<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Strange sprite refresh problem... - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Strange sprite refresh problem...</h2>
<div id="posts">
<div class="post">
    <h4>#16247 - fixxorion - Wed Feb 11, 2004 4:33 am</h4>
    <div class="postbody"><span class="postbody">Hi all!
<br/>
<br/>
I have a rather strange issue with sprites using HAM.  I have 2 sprites on the screen, but when I update their positions...nothing happens even though I do a call CopyOAM.  I then tried it on the following example file:
<br/>
<br/>
<a class="postlink" href="http://www.gbadev.org/download.php?section=demos&amp;filename=mode4sprites.zip" target="_blank">http://www.gbadev.org/download.php?section=demos&amp;filename=mode4sprites.zip</a>
<br/>
<br/>
If I create a new project in Visual HAM, load the files, and compile it...it works.  However, when trying to move the ghost sprite around, it doesn't work!!  If I use the batch file included with the file, everything works great...why?!?!
<br/>
<br/>
Any help would be greatly appreciated!!
<br/>
<br/>
Thanx,
<br/>
<br/>
fixxorion</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16248 - dagamer34 - Wed Feb 11, 2004 4:40 am</h4>
    <div class="postbody"><span class="postbody">Do you wait for a VBlank or HBlank before copying data to OAM? It's locked at any other time.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16250 - fixxorion - Wed Feb 11, 2004 5:02 am</h4>
    <div class="postbody"><span class="postbody">Thanx for the reply!
<br/>
<br/>
This is the code from the example file (the main loop):
<br/>
<br/>
while(1){
<br/>
	GetInput();		
<br/>
	MoveSprite(&amp;sprites[0], ghostx, ghosty);	
<br/>
	CopyOAM();	
<br/>
	WaitForVsync();	
<br/>
}
<br/>
<br/>
This doesn't work with visual HAM...only by using the batch file can I get it to work.
<br/>
<br/>
Immensly strange...especially since the code is copying to OAM and then waiting for the Vsync.
<br/>
<br/>
Any other ideas?
<br/>
<br/>
fixxorion</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16266 - batblaster - Wed Feb 11, 2004 12:59 pm</h4>
    <div class="postbody"><span class="postbody">There is a godd Forum for HAM developer on <a href="http://www.ngine.de" target="_blank">www.ngine.de</a> you can try all you need to fix code with HAM...<br/>_________________<br/>Batblaster / 7 Raven Studios Co. Ltd
<br/>
------------------------------------------</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16278 - poslundc - Wed Feb 11, 2004 3:29 pm</h4>
    <div class="postbody"><span class="postbody">I know nothing about HAM, but the CopyOAM() function should appear either immediately after the WaitForVSync() function or at the very beginning of the loop. This probably won't make a difference on your particular program, though, as I doubt that the other two functions being called consume enough cycles to push CopyOAM() into the VDraw period. It's just a question of program organization.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16290 - jenswa - Wed Feb 11, 2004 8:57 pm</h4>
    <div class="postbody"><span class="postbody">Yeah i figurd that out when the display began to show some weird stuff.
<br/>
Although this is an old code sample from when i started with coding for the gba.
<br/>
The code wasn't written for HAM, it was written for use with DevKitAdvance. So it should compile with devkitadv and i don't know about HAM.<br/>_________________<br/>It seems this wasn't lost after all.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#16304 - fixxorion - Thu Feb 12, 2004 1:31 am</h4>
    <div class="postbody"><span class="postbody">Thanx for all the replies!
<br/>
<br/>
I ended up just using DevKitAdvance, and that worked fine.  Still don't understand what could have caused it, but at least it works now.
<br/>
<br/>
Thanx again!
<br/>
<br/>
fixxorion</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
