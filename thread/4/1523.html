<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Zooming / Rotation from tutorial explained - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Zooming / Rotation from tutorial explained</h2>
<div id="posts">
<div class="post">
    <h4>#7679 - einhaender - Sun Jun 22, 2003 10:11 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
on pernproject.com I have found a tutorial about zooming/rotating background maps. There they are using this function to archive that:
<br/>
<br/>
FIXED zoom = 1&lt;&lt;8;
<br/>
void RotateBackground(Bg* bg, int angle,int x, int y, fixed zoom)
<br/>
{
<br/>
    y = (y * zoom)&gt;&gt;8;
<br/>
    x = (x * zoom)&gt;&gt;8;
<br/>
<br/>
    bg-&gt;DX = (bg-&gt;x_scroll-y*SIN[angle]-x*COS[angle]);
<br/>
    bg-&gt;DY = (bg-&gt;y_scroll-y*COS[angle]+x*SIN[angle]);
<br/>
<br/>
    bg-&gt;PA = (COS[angle]*zoom)&gt;&gt;8; 
<br/>
    bg-&gt;PB = (SIN[angle]*zoom)&gt;&gt;8; 
<br/>
    bg-&gt;PC = (-SIN[angle]*zoom)&gt;&gt;8;
<br/>
    bg-&gt;PD = (COS[angle]*zoom)&gt;&gt;8;
<br/>
}
<br/>
<br/>
followed by updating the appropriate registers. 
<br/>
<br/>
To calculate PA...PD values however they use a different approach than 
<br/>
the developer manual tells, for example PA (BGxPA) should be
<br/>
1 / a * COS[0] where a is the magnification along x-axis, why is
<br/>
theirs different?
<br/>
I could write my own logic using the math from the manual for
<br/>
calculating BGxPA ... BGxPD but unfortunately I dont know the
<br/>
values to put into BG2X_L, BG2X_H and BG2Y_L, BG2Y_H.
<br/>
<br/>
Also I wonder, for the effect of zooming a screen-centered element exactly in the middle without going along x or y axis, I would need to modify the rotation center coordinate every time before calling the above function, right? 1 pixel per frame? 
<br/>
<br/>
And how can I zoom faster or slower? Lots of questions, hope somebody can help me a bit. Thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7725 - Lupin - Mon Jun 23, 2003 4:39 pm</h4>
    <div class="postbody"><span class="postbody">this function is for sprite rotation, why do you want to mess with background rotation registers then? I think sprite and background rotation are a bit different (never tried to rotate backgrounds though)
<br/>
<br/>
When you rotate the sprite, the center will be spritepos+spritesize/2 (simple - the center of the sprite :)), but the sprite will of course get clipped, because an 45? rotated 32x32 sprite couldn't fit into an 32x32 area, so you will have to use the double size option specified in... i think it was attribute 0 (you should perhaps look that up in pern project tutorial), the double size option will not double size your sprite, but it will double size the area the sprite is drawn in, so you'd have to move the sprite -32 pixels at the x and y axis, because the new center is at an different position, because of the doubled size
<br/>
<br/>
I hope that helped</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7743 - einhaender - Mon Jun 23, 2003 9:12 pm</h4>
    <div class="postbody"><span class="postbody">no, the function is for background rotation, both sprite and bg rotation go after the same arithmetic. the only major difference is that you can define a center coordinate for backgrounds.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
