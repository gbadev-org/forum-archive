<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Neo Geo Pocket emulation on gba? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Neo Geo Pocket emulation on gba?</h2>
<div id="posts">
<div class="post">
    <h4>#34180 - Cthulhu32 - Fri Jan 14, 2005 11:39 pm</h4>
    <div class="postbody"><span class="postbody">Just curious to see if anyone else has thought about this.  There are a few open source Neo Geo emulators that run NGP games full speed.  I'd love to play some of my old school NGP games on my ds, so I was wondering if anyone else has worked on this before.  If no one else has, I might have to start up the task of learning how to use a pre-made emulator to write one for the GBA hardware.
<br/>
<br/>
If I do wind up taking on this project, any suggestions?
<br/>
<br/>
  I do have quite a bit of C/C++ background, I'm learning ASM this semester in college so this will help me a lot with that class.
<br/>
<br/>
  Also if I do wind up taking on this project, I'll probably post some help wanted, but if anyone else wants to contribute please feel free.
<br/>
<br/>
   -thanks</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34185 - Lord Graga - Sat Jan 15, 2005 2:41 am</h4>
    <div class="postbody"><span class="postbody">I have had a faint idea about coding a NGPC emu, but I certainly ain't gonna do it within a suitable amount of years.
<br/>
<br/>
Yet, there is no such thing for GBA yet, but I would be happy to see a emu without sound running around fullspeed :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34270 - Cthulhu32 - Sun Jan 16, 2005 9:41 pm</h4>
    <div class="postbody"><span class="postbody">well I wouldn't do this from scratch, I definitely don't know enough to make an emulator for the NGP from scratch, however NeoPop is an open source Neo Geo pocket emulator, and I'm sure the author wouldn't mind if I ported it over giving him plenty of credit.  <a href="http://neopop.emuxhaven.net/" target="_blank">http://neopop.emuxhaven.net/</a>  It runs Neo Geo pocket games full speed, so I can see what needs to be converted, and I can see what can be optimized/turned into ASM to make it run faster.  If it turns out it runs mo-slow, it'll be a learning experience.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34395 - Cthulhu32 - Tue Jan 18, 2005 11:54 pm</h4>
    <div class="postbody"><span class="postbody">R&amp;D so far:
<br/>
well I've emailed the author of the Emulator to see his opinions (he has already given the OK to all programmers wanting to modify his code under the GNU license) and now I'm doing some R&amp;D to make sure the GBA will be able to handle this thing.  Here's my comparisons so far
<br/>
<br/>
Gameboy Advance vs Neo Geo Pocket Color
<br/>
<br/>
GBA
<br/>
* CPU: Memory embedded 32-bit RISC CPU (CPU core design by ARM)
<br/>
* SOUND: 
<br/>
  Analogue     4 channel CGB compatible
<br/>
  Digital      2 DMA sound channels
<br/>
* RESOLUTION: 240 x 160 pixels
<br/>
<br/>
NGPC
<br/>
* CPU:  16-bit Toshiba TLCS900H (6.144MHZ)
<br/>
* SOUND:  Z80 sound processor (3.072MHZ)
<br/>
* RESOLUTION: 160 x 152 pixels
<br/>
<br/>
the NeoPop emulator has a z80 emulator which I could look into optimizing for the gba so it runs it smoothly.
<br/>
<br/>
and now for a very important comparison, the RAM:
<br/>
<br/>
NGPC
<br/>
RAM: 12KB for core processor, 4KB for Z80 processor
<br/>
  (slightly more powerful than a GBC, which is a plus if I'm going to get this thing running on the GBA smoothly)
<br/>
<br/>
GBA
<br/>
Internal Memory
<br/>
<br/>
  BIOS ROM     16 KBytes
<br/>
  Work RAM     288 KBytes (32K in-chip + 256K on-board)
<br/>
  VRAM         96 KBytes
<br/>
  OAM          1 KByte (128 OBJs 3x16bit, 32 OBJ-Rotation/Scalings 4x16bit)
<br/>
  Palette RAM  1 KByte (256 BG colors, 256 OBJ colors)
<br/>
<br/>
how are my numbers looking so far?  I'm thinking this will be a very feasible project, the GBA's ram outnumbers the NGP significantly, so the Z80 emulator should run fine.  The pixel ratios are great, the GBA can run it in its native resolution or I can write some code for full screen.  The CPUs are different brands, but considering how slow the NGP cpu is compared to the GBA, the GBA should handle it no problem.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34410 - sgeos - Wed Jan 19, 2005 3:14 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cthulhu32 wrote:</b></span></td> </tr> <tr> <td class="quote">how are my numbers looking so far?</td> </tr></table><span class="postbody">
<br/>
I think they look good.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cthulhu32 wrote:</b></span></td> </tr> <tr> <td class="quote">The pixel ratios are great, the GBA can run it in its native resolution or I can write some code for full screen.</td> </tr></table><span class="postbody">
<br/>
You could use a rotation/scaling BG and stretch it out.  I think that would be the easiest.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34421 - tepples - Wed Jan 19, 2005 6:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cthulhu32 wrote:</b></span></td> </tr> <tr> <td class="quote">The pixel ratios are great, the GBA can run it in its native resolution or I can write some code for full screen.</td> </tr></table><span class="postbody">
<br/>
You could use a rotation/scaling BG and stretch it out.</span></td> </tr></table><span class="postbody">
<br/>
Whether that would be possible depends on the tiles. Let me go check.
<br/>
<br/>
<a class="postlink" href="http://www.dmgice.com/hardware/ngpcspec.htm" target="_blank">Here are some basic specs</a>. There are 48 palettes of 3 colors each, 16 for BG0, 16 for BG1, and 16 for sprites. Rot/scale backgrounds can't reuse the same tile with different palettes. I'd suggest running it in native res in mode 0.
<br/>
<br/>
In addition, because of 32 total BG palettes, the emulator would have to duplicate the BG tiles to use colors 1-3 and 5-7 of each 15-color GBA palette. Another doc tells me that the NGPC has 8 KB of VRAM for 2-bit-per-pixel tiles, just like the NES (but in a different 2bpp format similar to that of the Virtual Boy); it'd fit, even with the 2:1 expansion for GBA 4-bit tile format and the 2:1 expansion for 32 palettes.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34516 - Cthulhu32 - Thu Jan 20, 2005 8:48 pm</h4>
    <div class="postbody"><span class="postbody">well I pm'd FluBBa (the author of PocketNES, and all that goodness) and he said it'd be really hard to run a 16-bit cpu @ 6.33mhz and a 8-bit cpu @ 3mhz on a 16mhz cpu, unless I did video only.  So here's the plan of attack:  Get NGP emulator running w/ video only for now, leave the sound out of it until I have the emulator fully working, then possibly leave it up to other coders to help me out getting the z80 emulated quickly and efficiently.  I can try the sound code myself, but it'll probably need some fixing up.
<br/>
I also decided I'm going to work on the 2d shooter competition at pdroms, so hopefully by the time I finish both these projects my gba coding skills will be a hundred times better than they are now.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34528 - Lord Graga - Thu Jan 20, 2005 11:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Cthulhu32 wrote:</b></span></td> </tr> <tr> <td class="quote">well I pm'd FluBBa (the author of PocketNES, and all that goodness) and he said it'd be really hard to run a 16-bit cpu @ 6.33mhz and a 8-bit cpu @ 3mhz on a 16mhz cpu, unless I did video only.  So here's the plan of attack:  Get NGP emulator running w/ video only for now, leave the sound out of it until I have the emulator fully working, then possibly leave it up to other coders to help me out getting the z80 emulated quickly and efficiently.  I can try the sound code myself, but it'll probably need some fixing up.
<br/>
I also decided I'm going to work on the 2d shooter competition at pdroms, so hopefully by the time I finish both these projects my gba coding skills will be a hundred times better than they are now.</td> </tr></table><span class="postbody">
<br/>
<br/>
Excelent! Go for it!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34529 - pyros - Fri Jan 21, 2005 12:23 am</h4>
    <div class="postbody"><span class="postbody">Not sure about this, but it may be easyer to write a program to convert reo-geo roms into gba roms. That way much of the work is done by a PC before-hand.
<br/>
<br/>
Also check the rom/ram read/write speeds for each system.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34530 - sajiimori - Fri Jan 21, 2005 12:35 am</h4>
    <div class="postbody"><span class="postbody">Pyros, no offense, but it's pretty clear that you've never written an emulator.
<br/>
<br/>
(I haven't either, but then again I don't try to give advice about writing them.)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34552 - XeroxBoy - Fri Jan 21, 2005 8:04 am</h4>
    <div class="postbody"><span class="postbody">Pyros is describing an emulation technique called static recompilation.   Easier? No, probably not. It is quite a bit faster, though. However, there are several problems with it, such as its inability to handle self-modifying code.
<br/>
<br/>
The only emulator I know of (off of the top of my head) that used static recompilation was the now discontinued N64 emulator Corn.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#34557 - bertsnks - Fri Jan 21, 2005 12:05 pm</h4>
    <div class="postbody"><span class="postbody">If I would write a CPU emulator, I would use a combination of both opcode recompilation and opcode emulation.
<br/>
<br/>
Some things are impossible to recompile to native GBA instructions, however, most of the Neo Geo arithmetic operations could easily be recompiled to GBA code.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
