<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Source Level debugging - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Source Level debugging</h2>
<div id="posts">
<div class="post">
    <h4>#84 - bomberman - Thu Jan 02, 2003 3:08 pm</h4>
    <div class="postbody"><span class="postbody">That's it...
<br/>
I compiled my first program (only displaying colors on the screen, well that's a start....) using DevKitAdvance. I can run it in VisualBoyAdvance 1.3.1, no problem!
<br/>
Things got tougher when I wanted to debug this. I downloaded GDB/Insight 5.1.1. I managed to load the image in VBA and wait for a GDB connection. I then ask GDB to connect to target (using TCP). It succeeds but the only thing I can do is clicking on continue and see my program running.
<br/>
In other words, I can not put breakpoints at source level and/or step into my program.
<br/>
Has someone here already done this? Or has someone used other tools to achieve this?
<br/>
<br/>
Thanks for your help!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#87 - I.C.E - Thu Jan 02, 2003 3:39 pm</h4>
    <div class="postbody"><span class="postbody">First of all I dont use GDB/Insight i am using GDB/DDD, but nevertheless I think i can give you some advices. :)
<br/>
I really deapreciate using TCP for debugging, because it is really slow (at least here at my Linux box). Pipe is much faster.
<br/>
To find the problem i would suggest that you first try to debug you game with gdb. You need for debugging the elf binary of you program and the gba binary. 
<br/>
<br/>
Just start gdb in the directory where both files are. Enter <span style="font-weight: bold">file &lt;elffile&gt;</span> and then enter the remote target with the command <span style="font-weight: bold">target remote |VisualBoyAdvance -s0 -Gpipe &lt;gbafile&gt;</span> . Now you should easy can use gdb commands, for e.g <span style="font-weight: bold">break &lt;functionname&gt;</span> to enter a break point. If that should work the problem has something to do with Insight. Is the correct debugger configured? (a common error is that gdb is used instead of the correct arm compiled gdb)
<br/>
Btw, i often use .gdbinit files to initialate gdb correct for my needs (breakpoint i often need and so on)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#88 - bomberman - Thu Jan 02, 2003 4:45 pm</h4>
    <div class="postbody"><span class="postbody">The GDB I use is named arm-gdb.exe (I found it on <a href="http://vboy.emuhq.com/downloads.shtml," target="_blank">http://vboy.emuhq.com/downloads.shtml,</a> the site of VBA) so I assume it's the right one.
<br/>
If I open the elf (either by menu or your command in the console), the source appears in GDB.
<br/>
Unfortunately, you are using a pipe to connect to VBA, but I read on the VBA site it only works for Unix and not for Windows (yes I work on it...).
<br/>
I tried to run <span style="font-weight: bold"> VisualBoyAdvance -Gtcp &lt;gbafile&gt; </span> and it waits for a connection. In Insight I select Connect Target with TCP and it succeeds. Both say they are connected to each other. But then I have only assembly code in GDB window. I lose my C++ source files and can only run it.
<br/>
I'll have a look to see if DDD is available on Windows and if yes will try with that.
<br/>
<br/>
Thanks, I keep on working on it...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#90 - bomberman - Thu Jan 02, 2003 5:48 pm</h4>
    <div class="postbody"><span class="postbody">OK... I was using VBA and it seems it does not work.
<br/>
I run VBA-SDL.exe -Gtcp &lt;gbafile&gt; and then gdb can connect to it.
<br/>
<br/>
But I have then to setup all my breakpoints before running or while I am in a break point. I can not setup a breakpoint when the program is running (which Visual C++ lets you do for example). Is this a normal behaviour?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#92 - I.C.E - Thu Jan 02, 2003 5:53 pm</h4>
    <div class="postbody"><span class="postbody">Hmm, i would suggest you try it first with gdb (without insight) to see if everything is correct with your files and gdb. But maybe you just have not compiled with debugging informations? Do you have the option -g when compiling whith gcc on?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93 - bomberman - Thu Jan 02, 2003 6:04 pm</h4>
    <div class="postbody"><span class="postbody">as you saw I managed using VBA-SDL.
<br/>
I presume on Linux VBA is de facto VBA-SDL so it's why it works. On Windows it is Direct-X.
<br/>
Do you have a clue concerning the breakpoints?
<br/>
<br/>
Thanks for all!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#94 - I.C.E - Thu Jan 02, 2003 6:16 pm</h4>
    <div class="postbody"><span class="postbody">Usually it is possible to interrupt a running program and then set breakpoint or do another stuff with gdb, but with VisualBoyAdvance as remote target it also does not work on my machine, but don't know why.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#102 - tubooboo - Thu Jan 02, 2003 8:46 pm</h4>
    <div class="postbody"><span class="postbody">...is actually easy. Just press F11 while the VBA window is active, that will break back into GDB. 
<br/>
<br/>
Also have a look at HAMs GDB source level debugging system if you need info on how to set it up.
<br/>
<br/>
Best
<br/>
Emanuel<br/>_________________<br/>HAM author
<br/>
<a href="http://www.ngine.de" target="_blank">http://www.ngine.de</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#104 - I.C.E - Thu Jan 02, 2003 9:37 pm</h4>
    <div class="postbody"><span class="postbody">Oh, that is really cool, thanks. :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#657 - mithris - Thu Jan 09, 2003 2:12 pm</h4>
    <div class="postbody"><span class="postbody">Has anyone bought the XPort?
<br/>
It says on the page that it should support source level debugging, and it sure 
<br/>
does, but only when running from RAM. 
<br/>
<br/>
The problem is how gdb sets it's breakpoints, but since the XPort has a FPGA 
<br/>
circuit there is possible to add hardware breakpoints to ROM-based code.
<br/>
<br/>
I wrote a small program that talks to GDB through a UART cable, but i don't 
<br/>
have the software to program the XILINX FPGA mounted on the xport, so i 
<br/>
wonder if anyone here has the required software and would like to be 
<br/>
involved in this project?
<br/>
<br/>
/Bjorn<br/>_________________<br/>codito ergo sum</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#662 - Lanza - Thu Jan 09, 2003 3:06 pm</h4>
    <div class="postbody"><span class="postbody">This might be of some interest :
<br/>
<br/>
I am currently beta testing the last version of batgba (www.bgba.tk). It has source level debugging, and is very eficient.
<br/>
<br/>
I hope it will be released soon, but this depends of the developpers. (I am just a tester).</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
