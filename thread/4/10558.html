<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GBA Pong crash course parse error >.< - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > GBA Pong crash course parse error >.<</h2>
<div id="posts">
<div class="post">
    <h4>#95047 - Rogmatic - Thu Jul 27, 2006 4:06 pm</h4>
    <div class="postbody"><span class="postbody">I just started doing the GBA Pong Crash Course tutorial, which I found from gbadev.org (<a class="postlink" href="http://www.webbesen.dk/gba/default.asp" target="_blank">http://www.webbesen.dk/gba/default.asp</a>), and while compiling, got a strange parse error.
<br/>
<br/>
I used Dovotos' pcx2gba (<a class="postlink" href="http://www.webbesen.dk/gba/files/pcx2gba.zip" target="_blank">http://www.webbesen.dk/gba/files/pcx2gba.zip</a>) to convert my background image from bg.PCX to bg.h.
<br/>
<br/>
I continued with the tutorial, to the point where the first compile is done: it compiled fine, no errors.
<br/>
<br/>
Now here's the part that's puzzling me:  I haven't edited the bg.h file in any way, and now, after adding some more code and reaching the second compile in the tutorial, I'm getting a parse error in the bg.h file.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
In file included from pong.c:2:
<br/>
bg.h:9: parse error before 'const'
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
/**********************************************\
<br/>
*       bg.h                                   *
<br/>
*          by dovotos pcx-&gt;gba program         *
<br/>
/**********************************************/
<br/>
#define  bg_WIDTH   240
<br/>
#define  bg_HEIGHT  160
<br/>
<br/>
<br/>
const u16 bgData[] = {    // &lt;-- Parse error before 'const'
<br/>
                    0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828,
<br/>
                    0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828,
<br/>
                    0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828,
<br/>
                    0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828,
<br/>
                    0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828, 0x2828,
<br/>
...};
<br/>
<br/>
const u16 bgPalette[] = {
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
<br/>
                    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x7FFF,
<br/>
                    0x0000, 0x1800, 0x3000, 0x4C00, 0x6400, 0x7C00, 0x00C0, 0x18C0, 0x30C0, 0x4CC0,
<br/>
                    0x64C0, 0x7CC0, 0x0180, 0x1980, 0x3180, 0x4D80, 0x6580, 0x7D80, 0x0260, 0x1A60,
<br/>
                    0x3260, 0x4E60, 0x6660, 0x7E60, 0x0320, 0x1B20, 0x3320, 0x4F20, 0x6720, 0x7F20,
<br/>
...};
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thanks in advance, any help is greatly appreciated.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95056 - tepples - Thu Jul 27, 2006 5:12 pm</h4>
    <div class="postbody"><span class="postbody">First off, rename bg.h to bg.c before compiling it. Second, because you're using u16 without including any GBA headers, you need to put the following above the first 'const u16':
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">typedef unsigned short u16;</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95072 - Rogmatic - Thu Jul 27, 2006 6:35 pm</h4>
    <div class="postbody"><span class="postbody">Actually, I've defined u16 in a gba header file, and bg.h is not the main program source, it's just the file containing the image data.  I suppose I should have posted the main program source...anyways, here it is:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "gba.h"
<br/>
#include "bg.h"
<br/>
#include "ball.h"
<br/>
<br/>
void InitializeSprites(void);
<br/>
void CopyOAM(void);
<br/>
<br/>
OAMEntry sprites[128];
<br/>
<br/>
int main() {
<br/>
<br/>
   u16 loop;
<br/>
<br/>
   SetMode(MODE_4 | BG2_ENABLE | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
   for (loop = 0; loop &lt; 256; loop++) {
<br/>
      OBJ_PaletteMem[loop] = ballPalette[loop];
<br/>
   }
<br/>
<br/>
   for (loop = 0; loop &lt; 256; loop++) {
<br/>
      BG_PaletteMem[loop] = bgPalette[loop];   // Fill the palette memory with all 256 colors
<br/>
   }
<br/>
<br/>
<br/>
   for (loop = 0; loop &lt; (120*160); loop++) {
<br/>
      FrontBuffer[loop] = bgData[loop];   // Fill the VRAM with the background image data
<br/>
   }
<br/>
<br/>
   memcpy( (u16 *)0x06014000, &amp;ballData, sizeof(ballData) );
<br/>
<br/>
   sprites[0].attribute0 = COLOR_256 | SQUARE | 50;
<br/>
   sprites[0].attribute1 = SIZE_8 | 30;
<br/>
   sprites[0].attribute2 = 512;
<br/>
<br/>
   while(1)
<br/>
   {
<br/>
      WaitForVsync();
<br/>
      CopyOAM();
<br/>
   }
<br/>
<br/>
<br/>
   return 0;
<br/>
<br/>
}
<br/>
<br/>
void InitializeSprites(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   for (loop = 0; loop &lt; 128; loop++) {
<br/>
      sprites[loop].attribute0 = 160;
<br/>
      sprites[loop].attribute1 = 240;
<br/>
   }
<br/>
}
<br/>
<br/>
void CopyOAM(void)
<br/>
{
<br/>
   u16 loop;
<br/>
   u16* temp;
<br/>
   temp = (u16*)sprites;
<br/>
   for (loop = 0; loop &lt; 128*4; loop++) {
<br/>
      OAM_Mem[loop] = temp[loop];
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95101 - kusma - Thu Jul 27, 2006 9:19 pm</h4>
    <div class="postbody"><span class="postbody">the parse error is _before_ the first const keyword, and since there is no other c/c++-code (only preprocessor-stuff) prior to that point in that header, my guess is that the source of the error is located in the end of gba.h as it is the file included before bg.h. something like a missing semicolon after a struct/class-declaration is a good candidate to look for.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95103 - Rogmatic - Thu Jul 27, 2006 9:27 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for your advice guys.
<br/>
<br/>
I took a look at the gba.h file just now, didn't see anything that might cause a problem, but here's the code, maybe you'll see something I'm not.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//
<br/>
// Including all macros into gba.h
<br/>
//
<br/>
<br/>
#ifndef GBA_H
<br/>
#define GBA_H
<br/>
<br/>
#include "gba_types.h"
<br/>
#include "gba_regs.h"
<br/>
#include "gba_video.h"
<br/>
#include "gba_sprites.h"
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95127 - kusma - Thu Jul 27, 2006 11:47 pm</h4>
    <div class="postbody"><span class="postbody">what's the contents of gba_sprites.h?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95131 - Rogmatic - Thu Jul 27, 2006 11:57 pm</h4>
    <div class="postbody"><span class="postbody">gba_sprites.h:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//
<br/>
// Sprites
<br/>
//
<br/>
<br/>
#ifndef GBA_SPRITES_H
<br/>
#define GBA_SPRITES_H
<br/>
<br/>
#include "gba_types.h"
<br/>
<br/>
// Attribute 0
<br/>
<br/>
#define ROTATION_FLAG      0x0100
<br/>
#define SIZE_DOUBLE      0x0200
<br/>
#define MODE_NORMAL      0x0000
<br/>
#define MODE_TRANSPARENT   0x0400
<br/>
#define MODE_WINDOWED      0x0800
<br/>
#define MOSAIC         0x1000
<br/>
#define COLOR_16      0x0000
<br/>
#define COLOR_256      0x2000
<br/>
#define SQUARE         0x0000
<br/>
#define   WIDE         0x4000
<br/>
#define TALL         0x8000
<br/>
<br/>
// Attribute 1
<br/>
<br/>
#define ROTDATA(n)      (n &lt;&lt; 9)
<br/>
#define HORIZONTAL_FLIP      0x1000
<br/>
#define VERTICAL_FLIP      0x2000
<br/>
#define SIZE_8         0x0000
<br/>
#define SIZE_16         0x4000
<br/>
#define SIZE_32         0x8000
<br/>
#define SIZE_64         0xC000
<br/>
<br/>
// Attribute 2
<br/>
<br/>
#define PRIORITY(n)      ((n) &lt;&lt; 10)
<br/>
#define PALETTE(n)      ((n) &lt;&lt; 12)
<br/>
<br/>
// Sprite structure definitions
<br/>
<br/>
typedef struct tagOAMEntry
<br/>
{
<br/>
   u16 attribute0;
<br/>
   u16 attribute1;
<br/>
   u16 attribute2;
<br/>
   u16 attribute3;
<br/>
} OAMEntry, *pOAMEntry;
<br/>
<br/>
// Sprite rotation information
<br/>
<br/>
typedef struct tagRotData
<br/>
{
<br/>
   u16 filler1[3];
<br/>
   u16 pa;
<br/>
   u16 filler2[3];
<br/>
   u16 pb;
<br/>
   u16 filler3[3];
<br/>
   u16 pc;
<br/>
   u16 filler4[3];
<br/>
   u16 pd;
<br/>
} RotData, *pRotData
<br/>
<br/>
#endif
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95137 - Sausage Boy - Fri Jul 28, 2006 12:10 am</h4>
    <div class="postbody"><span class="postbody">I see it! Missing ; !
<br/>
<br/>
edit:
<br/>
hmm yeah, right after *pRotData<br/>_________________<br/>"no offense, but this is the gayest game ever"</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#95176 - Rogmatic - Fri Jul 28, 2006 3:43 am</h4>
    <div class="postbody"><span class="postbody">Well damn, I can't believe I missed that.
<br/>
Thanks alot, everyone. XD</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
