<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Problem using math functions - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Problem using math functions</h2>
<div id="posts">
<div class="post">
    <h4>#1581 - DennisBor - Mon Jan 20, 2003 2:26 pm</h4>
    <div class="postbody"><span class="postbody">I'm trying to rotate my sprites and the tutorial from the PERN project sais I have to use the math functions.
<br/>
<br/>
I'm using the code below for the functions:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#include "math.h"
<br/>
<br/>
// maak een macro voor FIXED getallen (zonder komma)
<br/>
#define FIXED unsigned long
<br/>
<br/>
//maak een macro voor de waarde van PI
<br/>
#define PI 3.14159
<br/>
<br/>
// maak een macro om de 
<br/>
#define RADIAAL(myWaarde) (((float)myWaarde)/(float)180*PI)
<br/>
<br/>
// [CUT] A LOT MORE CODE... [/CUT]
<br/>
<br/>
// loop to save all 360 cos and sin values
<br/>
   for (myLoop = 0; myLoop &lt; 360; myLoop ++)
<br/>
   {
<br/>
      mySinus[myLoop] = (FIXED)(sin(RADIAAL(myLoop)) * 256);
<br/>
      myCosinus[myLoop] = (FIXED)(cos(RADIAAL(myLoop)) * 256);
<br/>
   }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The problem is that the compiler complains:
<br/>
<span style="font-weight: bold">undefined reference to 'sin'
<br/>
undefined reference to 'cos'</span>
<br/>
<br/>
does anyone know how to fix this compiler error?
<br/>
<br/>
Dennis<br/>_________________<br/>I rather have a compiler than a girl... A compiler isn't complaining all the time!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1591 - joet - Mon Jan 20, 2003 4:32 pm</h4>
    <div class="postbody"><span class="postbody">Make sure that you're linking the math library in the GCC path (-lm) ...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1593 - DennisBor - Mon Jan 20, 2003 4:44 pm</h4>
    <div class="postbody"><span class="postbody">Thanks :) that works!<br/>_________________<br/>I rather have a compiler than a girl... A compiler isn't complaining all the time!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1603 - tepples - Mon Jan 20, 2003 6:15 pm</h4>
    <div class="postbody"><span class="postbody">Using sin() and cos() to build lookup tables is SLOW and can cause <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=245" target="_blank">several seconds of delay in starting the program</a>.  I'd suggest putting a 256-entry lookup table in 2.14 fixed-point format in your program and then using linear interpolation for in-between values.  In all, it shouldn't take more than 1 KB; the sin() and cos() code from libm is probably bigger than that already.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1604 - DennisBor - Mon Jan 20, 2003 6:19 pm</h4>
    <div class="postbody"><span class="postbody">Ive just started programming C++ and GBA, can you explain such a table a little more for me?<br/>_________________<br/>I rather have a compiler than a girl... A compiler isn't complaining all the time!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1806 - Mr. Sanity - Thu Jan 23, 2003 11:55 am</h4>
    <div class="postbody"><span class="postbody">As an aside, why are you calculating both <span style="font-weight: bold">cos</span> and <span style="font-weight: bold">sin</span>? After all, 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
sin(degrees) = cos((degrees-90)%360)
<br/>
</td> </tr></table><span class="postbody">
<br/>
So, if you only calculate the table for one set, you can use assignment for the other set, saving you almost 50% of the calculation time.
<br/>
<br/>
Even better yet, make a one-shot C/C++ program for your PC/Mac that outputs the following to stdout or a file:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
const long mySinus[360] = {...values...};
<br/>
const long myCosinus[360] = {...values...};
<br/>
</td> </tr></table><span class="postbody">
<br/>
Then, copy and paste this output into your header file, and ditch that loop you have altogether. This way, you don't waste any processor time calculating this at runtime, which is a waste considering that sin/cos tables are never going to change.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1807 - DennisBor - Thu Jan 23, 2003 12:03 pm</h4>
    <div class="postbody"><span class="postbody">Yes I've done that and it works great! Thanks for all your help!<br/>_________________<br/>I rather have a compiler than a girl... A compiler isn't complaining all the time!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
