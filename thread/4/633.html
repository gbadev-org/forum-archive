<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>assembly to c++. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > assembly to c++.</h2>
<div id="posts">
<div class="post">
    <h4>#3247 - Saj - Fri Feb 21, 2003 12:08 am</h4>
    <div class="postbody"><span class="postbody">I've started coding in assembly (gba guy's tutorials) but I want to access my code with C++. ( i.e sprite movement, collision etc)
<br/>
<br/>
<br/>
Do I create header files or create custom classes or what?
<br/>
<br/>
thanks :) 
<br/>
<br/>
<br/>
<br/>
--------------------------------------------------
<br/>
I can't touch the HAM, cos I'm a muslim. :)
<br/>
--------------------------------------------------</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3250 - tepples - Fri Feb 21, 2003 1:34 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Saj wrote:</b></span></td> </tr> <tr> <td class="quote">I've started coding in assembly (gba guy's tutorials) but I want to access my code with C++. ( i.e sprite movement, collision etc)
<br/>
<br/>
Do I create header files</td> </tr></table><span class="postbody">
<br/>
Yes.
<br/>
<br/>
But if you're mixing assembly and C++, watch out for calling conventions.  When calling assembly code from C, you typically write the assembly code to use the platform's C calling convention.  However, C++ has its own calling convention.  To declare that the functions prototyped in a header file use the C calling convention, wrap the header file with extern "C" {...} :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern "C" {
<br/>
Â  #include "asm-functions.h"
<br/>
}</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3265 - Saj - Fri Feb 21, 2003 11:39 am</h4>
    <div class="postbody"><span class="postbody">I'm not sure if that was what I meant...
<br/>
<br/>
I want to create my own header files that access the hardware directly.
<br/>
(To optimise my my C++ using assembly)
<br/>
<br/>
Here are some quotes to show you what I mean 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">touchstone : I think using C++ for gamecode and C/ASM for speed critical code such as rendering, music etc is a good mix.</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">burre : I prefer OOP since it simplifies structuring my code. If it turns out to take to much of a hit on execution times, I'll just have to optimize in ASM (but I hope not). </td> </tr></table><span class="postbody">
<br/>
<br/>
I want to be able to do what these guy's are doing...:)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#3274 - tepples - Fri Feb 21, 2003 3:54 pm</h4>
    <div class="postbody"><span class="postbody"><ol type="1">
<br/>
<li>Write your assembly language source code in a file whose name ends in <span style="font-weight: bold">.s</span>.
<br/>
</li><li>Create a C prototype for each exported entry point in your asm source code.  Place the prototypes in a header file called <span style="font-weight: bold">asm.h</span> or similar.
<br/>
</li><li>Include asm.h from your C++ source code.  But because your asm functions use C calling conventions rather than C++ calling conventions, you'll have to wrap the include with a specification of calling conventions:
<br/>
</li></ol></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">extern "C" {
<br/>
#include "asm.h"
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<li>You'll have to compile the asm source code with an assembler that outputs files that GNU ld can understand. (GNU ld is the linker from GNU Binutils, which is normally distributed alongside GCC.)  If you don't have a separate assembler, just use <span style="font-weight: bold">gcc</span> to compile the asm files; it knows what to do.
<br/>
<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</li></span><span class="gensmall"><br/><br/>Last edited by tepples on Fri Feb 21, 2003 7:25 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#3282 - Saj - Fri Feb 21, 2003 7:07 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for that tepples...I'll get to work with it straight away. :)</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
