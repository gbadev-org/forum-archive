<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Need Help Setting Attribute 2. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Need Help Setting Attribute 2.</h2>
<div id="posts">
<div class="post">
    <h4>#4794 - Saj - Wed Apr 09, 2003 9:44 pm</h4>
    <div class="postbody"><span class="postbody">Greetings,
<br/>
<br/>
I'm trying to display several (16-colour) sprites. How do I set up different palettes for them?
<br/>
<br/>
I know I have to set attribute 2 but I can't find any source code on this matter( everyone seems to be using 256 colour sprites :( )
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
sprites[1].attribute0 = COLOR_16 | SQUARE | ghost.y;   
<br/>
sprites[1].attribute1 = SIZE_8 | ghost.x;              
<br/>
sprites[1].attribute2 = ?;                             
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Also, I know the first value for attribute 2 is the character name but what do I have to 'OR' with it? btw, Im using Pern's headers.
<br/>
<br/>
Some example code would help me a lot.
<br/>
Thanks.
<br/>
<br/>
bonus question for 50 points - what does this do?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">   
<br/>
pSlot-&gt;attribute0 = attribute0;
<br/>
pSlot-&gt;attribute1 = attribute1;
<br/>
pSlot-&gt;attribute2 = attribute2;
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>---------------------------------------------------
<br/>
<a class="postlink" href="http://www.theanimalrescuesite.com/cgi-bin/WebObjects/CTDSites.woa" target="_blank">Click here to give free food to starving animals.</a>
<br/>
--------------------------------------------------</span><span class="gensmall"><br/><br/>Last edited by Saj on Wed Apr 09, 2003 9:54 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#4795 - Daikath - Wed Apr 09, 2003 9:49 pm</h4>
    <div class="postbody"><span class="postbody">Attribute 2 is the place in object memory where the image of the sprite is stored.
<br/>
<br/>
I haven't tried using a 16-colour sprite but I don't think it is much different in bases from 256.
<br/>
<br/>
For the first place in memory you simply put 0, then if you have a 64*64 pixel sprite you puy 128 on their for the second place in history and put 64 there for 32 by 32 sprites. However I dont knwo the numbers for rectangle sprites and the sort.<br/>_________________<br/>?There are no stupid questions but there are a LOT of inquisitive idiots.?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4796 - Saj - Wed Apr 09, 2003 10:00 pm</h4>
    <div class="postbody"><span class="postbody"><span style="font-style: italic">Daikath</span></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Attribute 2 is the place in object memory where the image of the sprite is stored. </td> </tr></table><span class="postbody">
<br/>
<br/>
I know, but It also stores the palette that is being used (when you use 16-colour sprites).
<br/>
<br/>
OK, I found this;
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">      
<br/>
      mysprites[0].attribute0 = (COLOR_16 | SQUARE | blowhole.y);
<br/>
      mysprites[0].attribute1 = (SIZE_16 | blowhole.x);
<br/>
      mysprites[0].attribute2 = (PRIORITY(2) | PALETTE(0));
<br/>
</td> </tr></table><span class="postbody">
<br/>
and
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//atribute2 stuff
<br/>
<br/>
#define PRIORITY(n)         ((n) &lt;&lt; 10)
<br/>
#define PALETTE(n)         ((n) &lt;&lt; 12)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
But I still don't understand.
<br/>
Do I just make a (pseudo)256 colour palette and use values (0-15 or 1-16) to 
<br/>
to distinguish between palettes or do I use values (0 - 255)?!?
<br/>
Please Help!!!!<br/>_________________<br/>---------------------------------------------------
<br/>
<a class="postlink" href="http://www.theanimalrescuesite.com/cgi-bin/WebObjects/CTDSites.woa" target="_blank">Click here to give free food to starving animals.</a>
<br/>
--------------------------------------------------</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4797 - DekuTree64 - Wed Apr 09, 2003 11:11 pm</h4>
    <div class="postbody"><span class="postbody">The actual sprite image data is stored as 4 bit values (so you have values 0-15). Each byte represents 2 pixels of the sprite. Check the options for your gfx converter program to see how to set it to generate 16-color data)Then the upper 4 bits of attr2 control the palette it uses. The only difference in how you set up a 16-color sprite is that you don't set the 256 color bit in attr0, and you set the pallete index in attr2. 
<br/>
Does that help?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4807 - Saj - Thu Apr 10, 2003 10:49 am</h4>
    <div class="postbody"><span class="postbody">Thanks DekuTree, (Gotta love those deku nuts and deku sticks too!)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The actual sprite image data is stored as 4 bit values (so you have values 0-15). </td> </tr></table><span class="postbody">
<br/>
So could I fill the palette (as a 256 colour array)with:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
for(loop = 0; loop &lt; 256; loop++)
<br/>
    {
<br/>
      OBJPaletteMem[loop] = palette[loop];
<br/>
    }
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and then access the third palette (colours 32-47) using:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[0].attribute2 = 0 | PRIORITY(3) | PALETTE(2)</td> </tr></table><span class="postbody">
<br/>
<br/>
What I'm asking is, do I still use OBJPaletteMem[] as a single 256 slot array? (I know each sprite can only use a single 16-colour palette of this).
<br/>
<br/>
And in PALETTE(n), n can never be higher than 15? 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Each byte represents 2 pixels of the sprite. Check the options for your gfx converter program to see how to set it to generate 16-color data)</td> </tr></table><span class="postbody">
<br/>
I've got that part down with gifs2sprites, but I read on a different thread that there may be palette re-ordering issues. 
<br/>
They were talking about 'gif2spr'. Is that the same as gifs2sprites? 
<br/>
<br/>
Anyways, here's what it made:-
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">const u16 palette[16]=
<br/>
{
<br/>
RGB( 0, 0, 0),RGB(31,31,31),RGB(15,15,12),RGB(13,13,11),
<br/>
RGB(11,11,10),RGB( 7, 7, 7),RGB( 0, 0, 2),RGB( 2, 2, 5),
<br/>
RGB( 0, 0,12),RGB(25,25,10),RGB(16,16,23),RGB( 5, 4,11),
<br/>
RGB(16,15, 3),RGB(26,26,20),RGB(25,17,12),RGB( 6, 6,15)
<br/>
};</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Then the upper 4 bits of attr2 control the palette it uses. The only difference in how you set up a 16-color sprite is that you don't set the 256 color bit in attr0, and you set the pallete index in attr2. </td> </tr></table><span class="postbody">
<br/>
Do you have a code example of this...PLEAAASSSEE!!! Unless it's just:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[0].attribute0 = COLOR_16 | SQUARE | y;
<br/>
sprites[0].attribute1 = SIZE_8 | x;
<br/>
sprites[0].attribute2 = 0 | PRIORITY(3) | PALETTE(15);</td> </tr></table><span class="postbody">
<br/>
Thanks for your help.<br/>_________________<br/>---------------------------------------------------
<br/>
<a class="postlink" href="http://www.theanimalrescuesite.com/cgi-bin/WebObjects/CTDSites.woa" target="_blank">Click here to give free food to starving animals.</a>
<br/>
--------------------------------------------------</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#4809 - Quirky - Thu Apr 10, 2003 11:50 am</h4>
    <div class="postbody"><span class="postbody">If you look at 16 colour sprite data in VBA palette viewer, you will see how the palette is stored. I use 16 coloured tiles, which are the same idea as sprites and yes, you have a 256 entry PaletteMem[] array. 
<br/>
<br/>
I keep pointers to my palettes in an array (my generated palette data, that is) and then load each one using a routine like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void load_bg_palette(u8 topal, u8 frompal) {
<br/>
  u16 palindex = topal*16;
<br/>
  REG_DMA3SAD = (u32)PALETTES[frompal];
<br/>
  REG_DMA3DAD = (u32)&amp;BGPaletteMem[palindex];
<br/>
  REG_DMA3CNT = 16 |DMA_16NOW;
<br/>
  
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
where PALETTES is an array of pointers to the 16 bit palette data arrays. No checks there, but "topal" should be 0-15 inclusive. frompal depends on how many palettes you use, in my case just 10 of them.
<br/>
<br/>
As you can see.. palette 0 will use colours 0-15, palette 1 uses colours 16-31, etc. Colour 0, 16, 32, etc are the transparent colours for the individual 16-colour palettes.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
