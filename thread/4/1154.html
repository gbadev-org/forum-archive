<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>RNG with exact period - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > RNG with exact period</h2>
<div id="posts">
<div class="post">
    <h4>#5657 - sgeos - Mon May 05, 2003 4:58 am</h4>
    <div class="postbody"><span class="postbody">Has anyone come across a method of generating an RNG with an exact period?  I'm looking for a way to setup RNGs on the fly with function call something like the following:
<br/>
<br/>
next_state = rng(current_state, period);
<br/>
<br/>
states range from 0 to period - 1.  I'm not sure if Knuth covers this.  At any rate, I don't have my books with me.
<br/>
<br/>
There is a way to generate LCGs that meet all the above criteria except that the output isn't random.  Take:
<br/>
<br/>
r = m + 1;  /* Or any multiple of m, plus one */
<br/>
c = 1;
<br/>
next_state = (current_state * r + c) % m;
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5704 - slip - Tue May 06, 2003 3:00 pm</h4>
    <div class="postbody"><span class="postbody">I don't know your answer to the above.... But if you are just after a random number between a certain range, you can use a TIMER and %.
<br/>
<br/>
For example.
<br/>
to generate a number between 0 and 6 inclusive, that appears random. Take a value from a timer (or any other source for that matter) and %7 it...
<br/>
% is modulus.
<br/>
<br/>
I use timer 2 for this. (no specific reason why)
<br/>
<br/>
u16 number = REG_TM2D%X;
<br/>
<br/>
where X is your range from 0 to X-1
<br/>
<br/>
Though I have not tried this but you could extend this method by dividing a number by say... 10. for example.
<br/>
<br/>
float number = (float)((REG_TM2D%10)/10.0f);
<br/>
<br/>
It may be a little messy but It would probably work. You could use 10 like I have above to give you a range between 0 and 1.
<br/>
<br/>
hope this helped
<br/>
slip</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5729 - sgeos - Wed May 07, 2003 3:41 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>slip wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
to generate a number between 0 and 6 inclusive, that appears random. Take a value from a timer (or any other source for that matter) and %7 it...
<br/>
% is modulus.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
mod is not the best way of generating random numbers.  It is fast, and I'll admit that it's probably good enough in most cases relating to games.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>slip wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Though I have not tried this but you could extend this method by dividing a number by say... 10. for example.
<br/>
<br/>
float number = (float)((REG_TM2D%10)/10.0f);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The GBA has no hardware support for floats.  The current general purpose RNG I'm using looks like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">unsigned long state;
<br/>
<br/>
int dice(int min, int max)
<br/>
{
<br/>
  state *= 69069;
<br/>
  return min + ((max - min + 1) * (state &gt;&gt; (4 * sizeof(unsigned long)))) /
<br/>
    (0x1 &lt;&lt; (4 * sizeof(unsigned long)));
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It returns a number between min and max, inclusive.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>slip wrote:</b></span></td> </tr> <tr> <td class="quote">I don't know your answer to the above.... But if you are just after a random number between a certain range, you can use a TIMER and %.</td> </tr></table><span class="postbody">
<br/>
<br/>
Acually, I'm after all the numbers from zero to (n - 1) in a random order.  What I'm currently doing is something like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">int array[N];
<br/>
int ctr;
<br/>
<br/>
for (ctr = 0; ctr &lt; N; ctr++)
<br/>
  array[ctr] = ctr;
<br/>
for (ctr = 0; ctr &lt; N; ctr++)
<br/>
  SWAP(array[ctr], array[dice(0, N - 1)]);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The advantage to this is that I can generate the list and use it as many times as I want to.  The disadvantage is that I have a potentially large array hanging around.  I'd rather just generate the list algorimically.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
