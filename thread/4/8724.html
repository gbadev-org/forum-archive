<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Writing a compiler: books. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Writing a compiler: books.</h2>
<div id="posts">
<div class="post">
    <h4>#73513 - sgeos - Sun Feb 26, 2006 5:01 am</h4>
    <div class="postbody"><span class="postbody">Can anyone recommend any books on writing a compiler?  I'm specifically looking for books that cover OO concepts related to compilers.
<br/>
<br/>
I want to write a compiler for a simple OO language that includes coroutine support.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73520 - sajiimori - Sun Feb 26, 2006 7:56 am</h4>
    <div class="postbody"><span class="postbody">OO features are actually pretty easy to implement after you build a complete non-OO language.  It's generally a matter of translating the OO constructs into more fundamental ones.  For instance, in C++, vtables are just arrays of function pointers and methods are just functions that take an invisible first argument.
<br/>
<br/>
Coroutines are even easier.  Allocate a stack for each one, and swap out sets of registers when changing contexts.
<br/>
<br/>
The <a class="postlink" href="http://www.amazon.com/gp/product/0201100886" target="_blank">dragon book</a> is a good starting point.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73539 - keldon - Sun Feb 26, 2006 2:11 pm</h4>
    <div class="postbody"><span class="postbody">If you are at uni, your library would have an entire section on compiler writing. I know that mine does.
<br/>
<br/>
There is also a programming problem which translates into a compiler which automatically creates a compiler from code; which I found interesting. But just check your library if you're at uni. Your local library may even have one - or a local university may also allow open access to the public.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73592 - sajiimori - Sun Feb 26, 2006 9:18 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">There is also a programming problem which translates into a compiler which automatically creates a compiler from code</td> </tr></table><span class="postbody">Uh.  What?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73600 - keldon - Sun Feb 26, 2006 9:33 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">There is also a programming problem which translates into a compiler which automatically creates a compiler from code</td> </tr></table><span class="postbody">Uh.  What?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
I'm trying to link to their slides. They mentioned it at the NWERC programming competition, but their server is sloppy at the moment.
<br/>
<br/>
<a href="http://www.nada.kth.se/contest/nwerc/2005/" target="_blank">http://www.nada.kth.se/contest/nwerc/2005/</a> &lt;-- when it does decide to work; there was a presentation they did on a saturday where they spoke about their amazing database optimisations that makes theirs something like 2000 times as fast as postgresql. And they also mentioned the 'compiler for free', which I think is in their slides.
<br/>
<br/>
However it will not teach you how to write your own compiler anyway; I just thought that it was interesting to know.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73644 - sgeos - Mon Feb 27, 2006 4:42 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">The <a class="postlink" href="http://www.amazon.com/gp/product/0201100886" target="_blank">dragon book</a> is a good starting point.</td> </tr></table><span class="postbody">
<br/>
From what I've gathered, the dragon book is standard, but it's dated.  The only advantage is has over other books is that it covers parsing in depth.  Other books don't cover parsing much anymore.  How much do I want to learn parsing?  If I want to make an interperted scripting language, would a strong knowledge of parsing be especially handy?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73652 - sajiimori - Mon Feb 27, 2006 5:52 am</h4>
    <div class="postbody"><span class="postbody">Well Brendan, if you're writing your first compiler, chances are you don't need a book on cutting-edge optimization techniques for hyperthreaded processors or whatever else.  :)
<br/>
<br/>
About parsing, it's important to understand how it works.  You should write at least one by hand.
<br/>
<br/>
For embedded interpreted languages, you'll want to compile the source to bytecodes, so the parsing will happen as a preprocessing step.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73655 - sgeos - Mon Feb 27, 2006 6:05 am</h4>
    <div class="postbody"><span class="postbody">First compiler.  The dragon book may be good to start with, although this is the current book I'm thinking about buying:
<br/>
<ul>Programming Language Pragmatics, Second Edition (Paperback)
<br/>
by Michael L. Scott
<br/>
Paperback: 912 pages
<br/>
Publisher: Morgan Kaufmann; 2 edition (November 7, 2005)
<br/>
Language: English
<br/>
ISBN: 0126339511</ul>These are a couple of the other top hits on Amazon:
<br/>
<ul>Engineering a Compiler (Hardcover)
<br/>
by Keith Cooper, Linda Torczon
<br/>
Hardcover: 801 pages
<br/>
Publisher: Morgan Kaufmann (September 2003)
<br/>
Language: English
<br/>
ISBN: 155860698X
<br/>
<br/>
Advanced Compiler Design and Implementation (Hardcover)
<br/>
by Steven Muchnick
<br/>
Hardcover: 856 pages
<br/>
Publisher: Morgan Kaufmann; 1st edition (August 1, 1997)
<br/>
Language: English
<br/>
ISBN: 1558603204</ul>Is the dragon book my best bet, or do I want to get one of the above books (or something else) instead?  (I'd rather not drop $300 on compiler books =)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73665 - sajiimori - Mon Feb 27, 2006 7:52 am</h4>
    <div class="postbody"><span class="postbody">Honestly, since you're not doing anything especially advanced, it doesn't matter much which book you buy.  Just get one that covers lexical analyzing, parsing, symbol tables, and emitting.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73671 - sgeos - Mon Feb 27, 2006 9:48 am</h4>
    <div class="postbody"><span class="postbody">Sweet.  In that case I'll probably buy by price. =)
<br/>
<br/>
BTW, how is polymorphism handled?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73677 - keldon - Mon Feb 27, 2006 10:36 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">Sweet.  In that case I'll probably buy by price. =)
<br/>
<br/>
BTW, how is polymorphism handled?
<br/>
<br/>
-Brendan</td> </tr></table><span class="postbody">
<br/>
<br/>
I thought (guessed)it involved name mangling.
<br/>
<a class="postlink" href="http://72.14.207.104/search?q=cache:6dRi3KNwfC0J:www.objectmentor.com/resources/articles/WhyAreYouStillUsingC.pdf+compiler+writing+polymorphism&amp;hl=en&amp;gl=uk&amp;ct=clnk&amp;cd=29" target="_blank">Check this link</a>
<br/>
<br/>
Also you might want to check out this link: <a href="http://www.cs.jhu.edu/~scott/cw/lectures/" target="_blank">http://www.cs.jhu.edu/~scott/cw/lectures/</a> . And maybe check google scholar too. The best thing about using the universities is that they recommend books and have a defined course for you to learn and their courseworks provide a means to test your ability.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73685 - sgeos - Mon Feb 27, 2006 12:38 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the links!
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote">The best thing about using the universities is that they recommend books and have a defined course for you to learn and their courseworks provide a means to test your ability.</td> </tr></table><span class="postbody">
<br/>
A university course would be fantastic, but I'm in Japan right now.  Completing a language and a compiler strikes me as a good way to test one's ability.  (Rewritting the compiler in that language seems even better. =)  How long did it take the compiler writers out there to finish your first compiler from the time you picked up a book?
<br/>
<br/>
Note to self and others:<ul><a class="postlink" href="http://compilers.iecc.com/faq.txt" target="_blank">comp.compiler FAQ</a>
<br/>
<a class="postlink" href="http://www.cs.vu.nl/~dick/PTAPG.html" target="_blank">Parsing Techniques - A Practical Guide</a></ul>-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73714 - sajiimori - Mon Feb 27, 2006 7:47 pm</h4>
    <div class="postbody"><span class="postbody">Name mangling is for reusing function names.  For runtime polymorphism, it depends on what you need.  C++ uses vtables.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73767 - sgeos - Tue Feb 28, 2006 1:48 am</h4>
    <div class="postbody"><span class="postbody">Thanks.  A quick search on vtables turned up:
<br/>
<a class="postlink" href="http://cpptips.hyperformix.com/cpptips/vtables" target="_blank">http://cpptips.hyperformix.com/cpptips/vtables</a>
<br/>
Which gives me more or less an idea of how to handle multiple inheritance.
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73823 - gladius - Tue Feb 28, 2006 6:49 am</h4>
    <div class="postbody"><span class="postbody">If you want to build a self-hosting compiler that goes down to assembler, it will take a good while on your first try :).  I wrote a simple pascal compiler a ways back and it took me about 4 months of part-time hacking to get it self-hosting.
<br/>
<br/>
If you compile to C or an existing bytecode (or a nice one you make), then it would be quite a bit simpler.  Plus that way you don't have to worry about doing assembly optimization.
<br/>
<br/>
I can also recommend the Dragon book, it covers the fundamentals quite well.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73845 - sgeos - Tue Feb 28, 2006 9:17 am</h4>
    <div class="postbody"><span class="postbody">I'll probably compile to C.  How long do you suspect that would take?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73892 - sajiimori - Tue Feb 28, 2006 8:00 pm</h4>
    <div class="postbody"><span class="postbody">I found it easy to emit native code on my first try -- but it was really slow native code!  :)
<br/>
<br/>
How hard it is to emit C largely depends on how direct the translation is, which depends on the design of your language.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73940 - sgeos - Wed Mar 01, 2006 2:08 am</h4>
    <div class="postbody"><span class="postbody">Slow is fine to start.  I'm looking to create a language that is easier for me to program in- even if it runs a little slower.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73943 - sajiimori - Wed Mar 01, 2006 2:21 am</h4>
    <div class="postbody"><span class="postbody">Have you thought much about what your language will be like?  I've always been interested in programming language design.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#73994 - sgeos - Wed Mar 01, 2006 1:28 pm</h4>
    <div class="postbody"><span class="postbody">No function prototypes.  Having to modify a declaration in two places sucks.
<br/>
<br/>
Cookie based coroutines.  Do you prefer the prefix or postfix version?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// prefix
<br/>
cookie mycookie@routine;
<br/>
mycookie@routine(x,y,z);  // pass parameters on the first call
<br/>
mycookie@routine();  // no parameters on subsequent calls
<br/>
@routine(x,y,z);  // compiler creates a default cookie for you
<br/>
@routine();  // compiler passes default cookie
<br/>
<br/>
// postfix
<br/>
cookie routine@mycookie;
<br/>
routine(x,y,z)@mycookie;  // pass parameters on the first call
<br/>
routine()@mycookie;  // no parameters on subsequent calls
<br/>
routine(x,y,z)@;  // compiler creates a default cookie for you
<br/>
routine()@;  // compiler passes default cookie
<br/>
<br/>
routine(x,y,z);  // implicit default
<br/>
routine();  // implicit default</td> </tr></table><span class="postbody">
<br/>
<br/>
The ability to use only the interface of another class.  (Simple implementaion being all methods are virtual)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">class data_heavy
<br/>
{
<br/>
private:
<br/>
  type bigarray[];
<br/>
public:
<br/>
  type getCell(type pX, type pY);
<br/>
};
<br/>
<br/>
class algorithmic_data mimics data_heavy
<br/>
{
<br/>
public:
<br/>
  type getCell(type pX, type pY);  // I don't store anything
<br/>
};</td> </tr></table><span class="postbody">
<br/>
<br/>
Special keywords for decorator classes.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">class horrible_stench decorates critter
<br/>
{
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Undeclared methods are implicitly created as:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">type method(params)
<br/>
{
<br/>
  return host.method(params);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
I hate having to declare 300 "return host.method(params);" functions.    host is a keyword.  =)  Naturally, not calling the host function is perfectly legal.  (My zombie_critter decorator might always return 0 for max HP).
<br/>
<br/>
I've got more on coroutine memory sharing, and grouping but I'll type that up later.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74033 - sajiimori - Wed Mar 01, 2006 9:42 pm</h4>
    <div class="postbody"><span class="postbody">Are you sure you want a special syntax for coroutines?  Why not simply:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Coroutine myCoroutine(startingFunction);
<br/>
myCoroutine(x, y, z);  // Pass parameters on the first call.
<br/>
myCoroutine();  // No parameters on subsequent calls.
<br/>
</td> </tr></table><span class="postbody">
<br/>
If you make your coroutine objects look like regular function objects from the outside, you can change the implementation without affecting client code, e.g. if the cost of allocating a stack becomes too great and you have to switch to finite state machines or something else.  Also, generic code can then operate on both coroutines and function objects.
<br/>
<br/>
I'm not sure I follow the "default cookie" idea, but if it's a piece of global state, that's scary and seemingly unnecessary.  It sounds like having a "default int" that you operate on if you don't give your int a name.
<br/>
<br/>
The idea about only using the interface of another class seems like a way to avoid defining abstract classes.  I'd recommend sticking with abstract classes.
<br/>
<br/>
The decorator idea sounds good -- I also hate defining tons of forwarding methods.  Additionally, a "lift" keyword would be nice to expose particular methods of private data members, while still hiding the majority of its interface:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
class Inner
<br/>
{
<br/>
public:
<br/>
  void methodA();
<br/>
  void methodB();
<br/>
  void methodC();
<br/>
};
<br/>
<br/>
class Outer
<br/>
{
<br/>
public:
<br/>
  lift i.methodB;
<br/>
<br/>
private:
<br/>
  Inner i;
<br/>
};
<br/>
<br/>
void test()
<br/>
{
<br/>
  Outer o;
<br/>
  o.methodB();  // calls o.i.methodB()
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Edit: Check out the "Nice" language for lots of ideas.  Maybe it's even what you're looking for!
<br/>
<br/>
Edit again: "Lift" should also let you specify a new name for the method, so something like Anim::numFrames() can be converted to the more specific numAnimFrames() in the outer class.</span><span class="gensmall"><br/><br/>Last edited by sajiimori on Thu Mar 02, 2006 2:38 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#74063 - sgeos - Thu Mar 02, 2006 1:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">I'm not sure I follow the "default cookie" idea, but if it's a piece of global state, that's scary and seemingly unnecessary.</td> </tr></table><span class="postbody">It's local.  Basically the compiler inserts a local cookie for you and uses that.
<br/>
<br/>
I like the cookie idea because it allows multiple instance of a coroutine within the same stack level.  Treating coroutines as objects could work:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">coroutine CoroutineType
<br/>
{
<br/>
  // Shared data
<br/>
  type x;
<br/>
  type y;
<br/>
<br/>
  externalReturn myCoroutine(params)
<br/>
  {
<br/>
    // constructor
<br/>
  }
<br/>
  internalReturn routineA()
<br/>
  {
<br/>
  }
<br/>
  internalReturn routineB()
<br/>
  {
<br/>
  }
<br/>
}
<br/>
<br/>
CoroutineType myCoroutine(params);  // create
<br/>
<br/>
myCoroutine();  // first call, default function
<br/>
myCoroutine.routineA();  // first call, explicit function
<br/>
myCoroutine();  // subsequent calls</td> </tr></table><span class="postbody">Your syntax is probably better.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74066 - sajiimori - Thu Mar 02, 2006 2:59 am</h4>
    <div class="postbody"><span class="postbody">Ah, then it's like having a default <span style="font-style: italic">local</span> int for when you don't want to give your int a name.  :)  It still sounds odd to me, but I think that's a side-effect of the differences in the ways we think of coroutines.
<br/>
<br/>
It sounds like you consider a "coroutine" the combination of some code (a function) and also the state of execution of that code (a cookie object), whereas I consider a "coroutine" just the state of execution, with no strict association with any particular code.
<br/>
<br/>
If the code and state are inextricably tied together, you could refer to a coroutine by the function name rather than the object name, so anonymous coroutine objects make sense.
<br/>
<br/>
However, it's important that a coroutine object is not tied to any particular function or set of functions.  They have to start execution somewhere, but after that, they should be free to go anywhere and yield from anywhere.  Otherwise you couldn't write utilities that are reusable across coroutines.
<br/>
<br/>
For instance, if I want a function called walkTo() that doesn't return until the character gets to the destination, that function should be usable from any coroutine.  I don't want to write a whole class just for walkTo(), either -- I should be able to write it as a normal function that happens to contain a call to yield().
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
bool walkTo(Creature* me, Vector3 dest)
<br/>
{
<br/>
  while(!me-&gt;collide(dest))
<br/>
  {
<br/>
    me-&gt;walkToward(dest);
<br/>
    yield();
<br/>
<br/>
    if(me-&gt;walkFailed())
<br/>
      return false;
<br/>
  }
<br/>
<br/>
  return true;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
