<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Sprite Animation - General Questions - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Sprite Animation - General Questions</h2>
<div id="posts">
<div class="post">
    <h4>#14343 - CcSoccer881 - Mon Jan 05, 2004 6:39 pm</h4>
    <div class="postbody"><span class="postbody">Alo all, I've recently picked up my GBA stuff again, after stopping for several months, but I deleted everything I used to have (which wasn't much). 
<br/>
<br/>
Now for my question. I'm trying to animate sprites, and I've tried a few ways, but it doesn't work. 
<br/>
<br/>
First, I tried making a 64x64 sprite with 4 frames, each frame being 32x32. I copied this into an array, and tried loading the data at offsets for each of the frames, however this isn't working. 
<br/>
<br/>
Hopefully someone can give me some general guidelines. 
<br/>
<br/>
-B.DePesa<br/>_________________<br/><a href="http://www.rsstudios.net" target="_blank">www.rsstudios.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14348 - poslundc - Mon Jan 05, 2004 6:54 pm</h4>
    <div class="postbody"><span class="postbody">You need to give more thought to the way the data is stored in memory. In 1D mode, anyway, the first quarter of a 64x64 sprite will be the top 16 scanlines (top two rows of 8x8 tiles) of the sprite. Try using that as the data for a 32x32 sprite and you'll get a shuffled combination of the top-halves of your first two sprites.
<br/>
<br/>
Try encoding all four sprites separately, then putting them in memory in that order.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14350 - CcSoccer881 - Mon Jan 05, 2004 7:02 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">Try using that as the data for a 32x32 sprite and you'll get a shuffled combination of the top-halves of your first two sprites.</td> </tr></table><span class="postbody">
<br/>
<br/>
That's exactly what I was getting ;)
<br/>
<br/>
Quick Question (I'm at school, my code is at home, got about 3 hours before I get home..) :
<br/>
<br/>
Would I be able to convert separate files into header files, combine them into one header file (per animation),in their own arrays (given that the palette stays the same), and then just swap the array that's loaded, given the current frame of animation?<br/>_________________<br/><a href="http://www.rsstudios.net" target="_blank">www.rsstudios.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14359 - poslundc - Mon Jan 05, 2004 8:18 pm</h4>
    <div class="postbody"><span class="postbody">First of all - don't use header files. This is a bad, bad habit encouraged by many tutorials and converter programs. Save them as .c files, then construct your header files as follows:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">#ifndef SOME_TAG_TO_DEFINE_YOUR_SPRITE
<br/>
#define SOME_TAG_TO_DEFINE_YOUR_SPRITE
<br/>
<br/>
extern const whatever mySpriteData[];
<br/>
<br/>
#endif</td> </tr></table><span class="postbody">
<br/>
<br/>
Where "whatever" should be the data type used in the .c file, whether it's u16 or u32 or int or what have you.
<br/>
<br/>
If you don't understand why it should be done this way you can search the forum or ask and I'll post an explanation, but suffice it to say you will live to regret it if you don't start doing it this way early on. :)
<br/>
<br/>
Second of all - realize that declaring the array of data doesn't put it into VRAM. It's up to you to do that, and up to you to decide how you want to manage VRAM. If you want to, when you first load in the sprite you can copy all four arrays sequentially into VRAM. Then to display the first sprite, set the tile number of attribute 2 to zero. To display the second one, set it to 16 if you are 16-colour mode, or 32 if you are in 256-colour mode. etc.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14376 - yaustar - Mon Jan 05, 2004 10:33 pm</h4>
    <div class="postbody"><span class="postbody">ok, now I am interested why header files are bad for storing the graphics data. Id it something to do with how header files and source files are defined in the compilar?<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14379 - sajiimori - Mon Jan 05, 2004 10:37 pm</h4>
    <div class="postbody"><span class="postbody">This is answered in many threads.  Short answer: if you create symbols in a header and include the header in more than one C file, you get duplicate definitions.
<br/>
<br/>
Don't:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// file.h
<br/>
int a;
<br/>
void f() {}
<br/>
</td> </tr></table><span class="postbody">
<br/>
Do:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// file.h
<br/>
extern int a;
<br/>
void f();
<br/>
<br/>
// file.c
<br/>
int a;
<br/>
void f() {}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14381 - poslundc - Mon Jan 05, 2004 10:47 pm</h4>
    <div class="postbody"><span class="postbody">To slightly expand on that: C files are meant to contain data, whereas header files contain meta-data (structs, prototypes, definitions, no actual <span style="font-style: italic">content</span>).
<br/>
<br/>
Basically, anything in a header file should be information on how to gain access to the stuff in its corresponding C file.
<br/>
<br/>
Even if you shield your .h files from multiple inclusion, as your project gets larger and larger you will inevitably include the same data file in two separate modules, and everything will compile fine but the linker will choke on it because when it sees a reference to a variable that same variable will be defined twice, and it won't know which one you're talking about. (If you happen to be using a shoddy Mac compile of gcc you will get a mysterious and untraceable bus error that will haunt you for days. Or at least, uh... that's what some guy told me happened to him. Yeah.)
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14389 - yaustar - Mon Jan 05, 2004 11:19 pm</h4>
    <div class="postbody"><span class="postbody">Thanks that explains a few things...what would happen if you had the same #define in two seperate header files
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
//1.h
<br/>
#define HELLO 1
<br/>
<br/>
//2.h
<br/>
#define HELLO 1
<br/>
<br/>
//main.c
<br/>
#include 1.h
<br/>
#include 2.h
<br/>
</td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14392 - sajiimori - Mon Jan 05, 2004 11:38 pm</h4>
    <div class="postbody"><span class="postbody">#define is a preprocessor directive.  "#define x y" tells the preprocessor to replace all instances of x with y for the rest of the file.  It's a lot like "search-and-replace" in a text editor, and it's totally different than creating variables.
<br/>
<br/>
Generally, preprocessors don't like it when you #define something twice during the course of compiling a C file, so if you #include two headers that #define the same thing, the preprocessor will probably complain.
<br/>
<br/>
But this is a very different problem than multiple data and function definitions.
<br/>
<br/>
Anyway, you could have just tried what you described to see what happens.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14395 - CcSoccer881 - Mon Jan 05, 2004 11:50 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Second of all - realize that declaring the array of data doesn't put it into VRAM. It's up to you to do that, and up to you to decide how you want to manage VRAM. If you want to, when you first load in the sprite you can copy all four arrays sequentially into VRAM. Then to display the first sprite, set the tile number of attribute 2 to zero. To display the second one, set it to 16 if you are 16-colour mode, or 32 if you are in 256-colour mode. etc.</td> </tr></table><span class="postbody">
<br/>
<br/>
I understand about the .c/.h file issue, I've been programming for about 2-3 years now, I'm just new to GBA programming, and in this case, it's a small demo where I'm only using 1 .c file, so I figured it was safe to use it in a header.
<br/>
<br/>
As for the array, I also realize that just declaring it doesn't put it into VRAM, I'd have to load it in first.<br/>_________________<br/><a href="http://www.rsstudios.net" target="_blank">www.rsstudios.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14406 - yaustar - Tue Jan 06, 2004 1:32 am</h4>
    <div class="postbody"><span class="postbody">It is just wierd since DKA has no problems with it (that I can see) but Visual HAM goes along the multiple definition error route.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14413 - CcSoccer881 - Tue Jan 06, 2004 3:37 am</h4>
    <div class="postbody"><span class="postbody">I got teh animation working, so my next task is to do a sprite-handler class, so I can keep track of everything :) Thanks for your help, and sorry if I sounded like a prick in my last post, it's been a bad day.. brother locked himself out of the house so I had to come home from having a good time after a bad day at school heh.<br/>_________________<br/><a href="http://www.rsstudios.net" target="_blank">www.rsstudios.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15240 - dagamer34 - Mon Jan 19, 2004 6:09 pm</h4>
    <div class="postbody"><span class="postbody">Does Visual HAM use a later version of GCC anyway, version 3.3.2 i think compared to 3.0.2 in v4 of DKA.
<br/>
<br/>
Maybe you are just getting away with things you're not supposed to!<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
