<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How do I move a sprite in 360?s - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > How do I move a sprite in 360?s</h2>
<div id="posts">
<div class="post">
    <h4>#9960 - Joe_Sextus - Sat Aug 23, 2003 3:46 pm</h4>
    <div class="postbody"><span class="postbody">How do I move a sprite in 360?s. What I am doing is rotating a sprite and then wanting it to move in the direction it is pointing. I know that
<br/>
<br/>
<span style="color: blue">m<span style="font-size: 9px; line-height: normal">a</span>= tan(Θ)</span>
<br/>
<br/>
but all values returned by tan are less than or equal to 1. What I want is for Object <span style="color: blue">o</span> to move along the line <span style="color: blue">a</span> towards Point <span style="color: blue">p</span>.
<br/>
<br/>
The image here might help explain what i mean.
<br/>
<br/>
<a class="postlink" href="http://joe_sextus.tripod.com/image2.htm" target="_blank">http://joe_sextus.tripod.com/image2.htm</a>
<br/>
<br/>
Any help would be appreciated. 
<br/>
Thanks in advance.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#9978 - johnny_north - Sat Aug 23, 2003 9:23 pm</h4>
    <div class="postbody"><span class="postbody">I believe that I understand what you're getting at, but I might take the sin/cos approach. I think that this will work if you want the rotated sprite to move in the direction it is pointing. This might be somewhat basic and more experienced folks could elaborate and make corrections if I'm wrong.
<br/>
<br/>
If you know the angle of rotation of your sprite, you can apply sin/cos to get the new x and y cords of a move. The first thing you might do is set up a look up table for sin/cos values in terms of degrees using fixed point math. Dovoto's Pern Project has the code to do this, but I recommend putting it all in a .h file so you don't use iwram, but that's up to you.
<br/>
<br/>
Once you're this far, you can take the angle of your rotated sprite and use it to get the new x,y coords of your sprite given it speed...
<br/>
<br/>
spriteAngle = 0; //angle interms of degrees
<br/>
RotateSprite(spriteAngle);
<br/>
spriteX += COS[spriteAngle] * spriteSpeed; 
<br/>
spriteY += SIN[spriteAngle] * spriteSpeed;
<br/>
<br/>
The thing to keep in mind is that the COS/SIN arrays are going to return values that are less than or equal to 1 for all 0-359 degrees so you'll have to be aware of this. I think to compenstate for this, you might make all of these variables based on fixed numbers. Also, take into condiseration where on the sprite's bitmap is the center and the starting angle of your sprite. I.E. if your starting unrotated sprite is pointing up and you associate this with 0 degrees of rotation, you'll get movement in the wrong direction.
<br/>
<br/>
angle = 0;
<br/>
(COS[angle], SIN[angle]) = (1, 0) and that's movement directly to the right, not up or (0,-1). If you're new to this, planning ahead like this will save a little time.
<br/>
<br/>
If you need to set up a tracking algoithm where you know the position of your sprite and you know the position of P and you need to calculate the angle to rotate the sprite towards P, you can use the same math I think.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14134 - plasma - Wed Dec 31, 2003 3:01 am</h4>
    <div class="postbody"><span class="postbody">i tried moving a bullet based on the angle of the player using your algorithm, but work it does not. the bullet's sprite blinks rapidly and somehow it changes size &amp; shape<br/>_________________<br/>ΩΠΣ</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14153 - sajiimori - Wed Dec 31, 2003 5:44 am</h4>
    <div class="postbody"><span class="postbody">Sounds like you're moving your sprites much farther than you intended.  The sizes and shapes change because the x and y values are overflowing into the other sprite attributes.
<br/>
<br/>
Check your math.  The algorithm is correct as posted.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14158 - jma - Wed Dec 31, 2003 6:26 am</h4>
    <div class="postbody"><span class="postbody">Without seeing code it would be almost impossible to know what's wrong. However, a quick guess is that you aren't holding the position values as floating (or fixed) point.
<br/>
<br/>
For accurate movement you won't be able to <span style="font-style: italic">move</span> the sprite. You will need to save the X,Y coordinates as floating point and <span style="font-style: italic">re-position</span> the sprite each frame:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">float fSpriteX,fSpriteY,fAngle;
<br/>
<br/>
void MoveSprite(float fDistance)
<br/>
{
<br/>
   fSpriteX += cos(fAngle) * fDistance;
<br/>
   fSpriteY += sin(fAngle) *fDistance;
<br/>
<br/>
   PositionSPrite(sprite,(int)fSpriteX,(int)fSpriteY);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Otherwise your are constantly resetting the position to an integer and then updating from whole values instead of fractions. If fDistance is small enough the sprite will never move. And if too big, of course, it will just fly around the screen in large jumps.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14160 - plasma - Wed Dec 31, 2003 6:40 am</h4>
    <div class="postbody"><span class="postbody">It still doesn't work</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14161 - plasma - Wed Dec 31, 2003 6:52 am</h4>
    <div class="postbody"><span class="postbody">Thanx - the code helped</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14162 - plasma - Wed Dec 31, 2003 7:11 am</h4>
    <div class="postbody"><span class="postbody">Actually, that causes numerous compile errors<br/>_________________<br/>ΩΠΣ</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14189 - jma - Thu Jan 01, 2004 12:50 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Actually, that causes numerous compile errors</td> </tr></table><span class="postbody">
<br/>
Considering that 1) I don't use C/C++ for GBA dev and 2) you are most likely using different libraries than I would of, of course the code would cause compile errors... it is sample code to show concept.
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#14190 - yaustar - Thu Jan 01, 2004 12:58 am</h4>
    <div class="postbody"><span class="postbody">hmm, I think <a href="http://www.gbajunkie.co.uk" target="_blank">www.gbajunkie.co.uk</a> has a tutorial on it in chapter 7.
<br/>
edit: reread the original post, chpater 7 only does rotation not movenment of the direction. Sorry.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"><br/><br/>Last edited by yaustar on Sun Jan 04, 2004 9:29 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#14318 - plasma - Sun Jan 04, 2004 6:45 am</h4>
    <div class="postbody"><span class="postbody">Sajiimori's right - the algorithm is correct. Sure, I had to divide it by 20 to make it visible, but it works</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
