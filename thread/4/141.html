<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>decimals. - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > decimals.</h2>
<div id="posts">
<div class="post">
    <h4>#859 - Lord Graga - Sat Jan 11, 2003 11:13 am</h4>
    <div class="postbody"><span class="postbody">Hey all. I am currently working on a RPG who uses 16x16 tiles.
<br/>
I would like to use following method to test collision(2 is the walkable tile):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   cx = self.x/16;
<br/>
   cy = self.y/16;
<br/>
   if(map[cy][cx] == 2 &amp;&amp; map[cy][cx+1] == 2 &amp;&amp; map[cy+1][cx] == 2 &amp;&amp; map[cy+1][cx+1] == 2) dir[di]=0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
what i would like to do is this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   cx = self.x/16;
<br/>
   cy = self.y/16;
<br/>
   if(map[cy][cx] == 2 &amp;&amp; map[cy][cx+0.9375] == 2 &amp;&amp; map[cy+0.9375][cx] == 2 &amp;&amp; map[cy+0.9375][cx+0.9375] == 2) dir[di]=0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
As you can see, i would like to use a decimal for it. But i can't :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#904 - subbie - Sun Jan 12, 2003 12:53 am</h4>
    <div class="postbody"><span class="postbody">Just use fix point. Shift by 8 should be enough.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#906 - Touchstone - Sun Jan 12, 2003 1:16 am</h4>
    <div class="postbody"><span class="postbody">Problem is you cannot index an array with floats, the index have to be an integer. Think of your array as a set och drawers. You can't access half a drawer, you'd have to open it up completely. Same goes for arrays.<br/>_________________<br/>You can't beat our meat</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1029 - Papa Smurf Advanced - Mon Jan 13, 2003 7:23 pm</h4>
    <div class="postbody"><span class="postbody">'ello,
<br/>
<br/>
Try :
<br/>
<br/>
cx = (self.x / 16) * 256; 
<br/>
cy = (self.y / 16) * 256; 
<br/>
<br/>
u32 Fixed = (u32) (0.9375 * 256);
<br/>
<br/>
<br/>
// now u can add cx/cy with Fixed
<br/>
<br/>
u32 x = (cx + Fixed) &gt;&gt; 8;
<br/>
u32 y = (cy + Fixed) &gt;&gt; 8;
<br/>
<br/>
<br/>
 if(map[y][x] == 2 &amp;&amp; map[y][x] == 2 &amp;&amp;
<br/>
    map[y][x] == 2 &amp;&amp; map[y][x] == 2)
<br/>
<br/>
     dir[di]=0; 
<br/>
<br/>
<br/>
-Papa Smurf Advanced-</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1032 - Splam - Mon Jan 13, 2003 8:52 pm</h4>
    <div class="postbody"><span class="postbody">I don't think fixed point maths is the answer here.  It looks like Lord Graga is trying to check "inside" a tile ?  ie instead of checking collisions against the edge of every 8x8 he's trying to check slightly inside that  (can't really see any reason for that code otherwise).
<br/>
<br/>
Simply can't be done that way, you need to scale your check position instead and have a finer control, almost in the way Papa Smurf (hehe crazy name) says but that still won't do what you want, you're still only checking the same tile because after all the fixed point stuff you're ending up with the same result  a 0 or 1 addition to the tile postion.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1045 - col - Tue Jan 14, 2003 1:31 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Splam wrote:</b></span></td> </tr> <tr> <td class="quote">I don't think fixed point maths is the answer here.  It looks like Lord Graga is trying to check "inside" a tile ?  ie instead of checking collisions against the edge of every 8x8 he's trying to check slightly inside that  (can't really see any reason for that code otherwise).</td> </tr></table><span class="postbody">
<br/>
<br/>
i agree.
<br/>
<br/>
I would suggest to keep a 'sub-tile' 8x8 collision map for every different type of collidable tile.
<br/>
When a possible collision is detected via the normal 8x8 tilemap test, the index value of that tile can be used to find the 'sub-tile' map for that tile. Then the sub-tile map is used to test with pixel detail.
<br/>
<br/>
With a little thought and good design, not very many of these sub-tile maps will be needed - just a few levels, a few angles for slopes, maybe a few curves.
<br/>
It should also be straightforward to mirror and flip them to save even more precious rom - or use bitmaps so each mini-map will need only 8bytes!!
<br/>
<br/>
cheers
<br/>
<br/>
col.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1048 - ampz - Tue Jan 14, 2003 2:02 am</h4>
    <div class="postbody"><span class="postbody">Depending on the size of the map, a full collision bitmap may be a convenient solution.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1049 - col - Tue Jan 14, 2003 3:39 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>ampz wrote:</b></span></td> </tr> <tr> <td class="quote">Depending on the size of the map, a full collision bitmap may be a convenient solution.</td> </tr></table><span class="postbody">
<br/>
<br/>
however, if you do take the time to assosciate each collidable graphic tile with a relevant collision map tile, you can build as many levels as you like with your graphical tiles, and change them(levels) at will, and the collision will work automatically!! it's also highly scalable - huge levels will work just as well as small ones, with little overhead.
<br/>
<br/>
No fiddly re-building of a seperate collision map - this approach would facillitate eg. a built in level editor
<br/>
<br/>
(shit man - i've almost convinced myself to start writing a platform game lol duper harioland here we come)
<br/>
<br/>
cheers
<br/>
<br/>
col</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
