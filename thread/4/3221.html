<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Change Control of Outside of Windows in HBLANK - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Change Control of Outside of Windows in HBLANK</h2>
<div id="posts">
<div class="post">
    <h4>#19185 - RaBBi - Tue Apr 13, 2004 4:38 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
In order to add a scanline effect managed by a window to my project, I needed to change the enable bits of the 04Ah - WINOUT register.
<br/>
<br/>
But it seems that I can't during the HBLANK period.
<br/>
<br/>
Here's my code :
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void gbl_Screen_Scanlines(u8 used_win, u8 starting_line, u8 ending_line, u8 clearline_height, u8 scanline_height)
<br/>
{
<br/>
   
<br/>
   static u8 s_win_posY1 = 0;
<br/>
   static u8 s_win_posY2 = 0;
<br/>
/* Black line or Normal Line */
<br/>
/* Black : outside window and Normal : inside window */
<br/>
   static u8 s_next_mode_line = 0; 
<br/>
      
<br/>
   
<br/>
   /*if (LCD_Y == ending_line) return;*/
<br/>
   
<br/>
   /* start when Line Counter reaches the starting line or change mode line */
<br/>
   if(LCD_Y == starting_line || (LCD_Y == s_next_mode_line &amp;&amp; LCD_Y &lt; ending_line))
<br/>
   {
<br/>
      /* Nothing Visible Outside the Window 1 
<br/>
      GBL_WINOUT_WIN0AND1_DISPLAY_SET(0,0,0,0,0,0);*/
<br/>
      
<br/>
      s_win_posY1 = LCD_Y + scanline_height;
<br/>
      s_win_posY2 = s_win_posY1 + clearline_height;
<br/>
      
<br/>
      s_next_mode_line = s_win_posY2;
<br/>
   }
<br/>
   
<br/>
   if (LCD_Y &gt;= ending_line)
<br/>
   {
<br/>
      /* All Visible Outside the Window 1 
<br/>
      GBL_WINOUT_WIN0AND1_DISPLAY_SET(1,1,1,1,1,1); */
<br/>
   }
<br/>
   
<br/>
   GBL_WINX_CREATE(used_win,0,240,s_win_posY1,s_win_posY2);   
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
I commented the lines where I try to set the display out of the window (cause it doesn't seem to work during HBLANK). 
<br/>
<br/>
----
<br/>
Other linked question :
<br/>
Now, I'll try to do it using the Blend Mode and the blend coefficient, without window.
<br/>
<br/>
But before this, do you know if it's possible to change this coeff during HBLANK too?
<br/>
Or if I'll get the same problem above.<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19197 - ScottLininger - Tue Apr 13, 2004 11:41 pm</h4>
    <div class="postbody"><span class="postbody">Well, this one is new to me. I've never tried to change windowing during HBLANK. (At least, I've never tried to enable/disable it)
<br/>
<br/>
But I have changed the blending register without trouble, so you could always go that way.
<br/>
<br/>
-Scott</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19202 - tepples - Wed Apr 14, 2004 1:27 am</h4>
    <div class="postbody"><span class="postbody">If it turns out that the hardware doesn't let you change the on/off state of the windows during hblank without artifacting, you could always change the horizontal extents of the window to include no visible pixels.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
