<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>What are some good ways to achieve this effect? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > What are some good ways to achieve this effect?</h2>
<div id="posts">
<div class="post">
    <h4>#23477 - benjamin - Tue Jul 13, 2004 8:08 pm</h4>
    <div class="postbody"><span class="postbody">I am envisioning a certain way of showing perspective and am wondering about 2 possible techniques.
<br/>
<br/>
What I want to achieve is basically a view of a field of game entities that changes in both angle and distance from the ground.
<br/>
<br/>
Ideally I would be doing this in 3D and simple rotating a camera and dollying in or out. 
<br/>
<br/>
Is a mode 7 emulation a good candidate for this? And if so is the GBA powerful enough to render mod 7-esque effects *and* still run the actual game code (i.e., I'm not looking to make just a demo here, there's AI and Sound cycles to consider too).
<br/>
<br/>
The other way I thought about was to possibly dynamically change tile sets to fake zooming in and out on the field, and use several sets of sprites to fake zooming in and out from the player entities..
<br/>
<br/>
Any suggestions?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23478 - poslundc - Tue Jul 13, 2004 8:24 pm</h4>
    <div class="postbody"><span class="postbody">Basic Mode7 is very computationally inexpensive to create, since most of the work is handled by the GPU. I haven't put much thought into it, but adding the ability to zoom in or out shouldn't be too taxing either, so long as you keep the pitch of the camera fixed and have a fast divide routine (a large reciprocal LUT would probably do nicely).
<br/>
<br/>
<a class="postlink" href="http://www.danposluns.com/gbadev/pseudo3D.html" target="_blank">My project</a> adds the ability to swivel the camera up and down, which required the use of a raycasting algorithm that is more computationally expensive. I've optimized it in assembly so there's still plenty of room left for most of the stuff I want to do, but it is not as cheap to create as plain Mode 7, or even Mode 7 that zooms. (I can't squeeze everything into VBlank, for example, and I have to do many of the calculations for the next cycle during VDraw.)
<br/>
<br/>
And if the ground is flat, Mode 7 is the way to go, especially if you are concerned about CPU cycles. Any other technique would probably require a bitmap mode and be incredibly wasteful.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23480 - benjamin - Tue Jul 13, 2004 9:31 pm</h4>
    <div class="postbody"><span class="postbody">So with mode 7 I wouldn't be able to change the pitch, that kinda stinks as I was hoping to do that, but maybe I can get away without it. My ground is definitely flat btw.
<br/>
<br/>
Your project seems pretty cool, I don't suppose you'd be willing to share the source?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23488 - poslundc - Wed Jul 14, 2004 1:34 am</h4>
    <div class="postbody"><span class="postbody">The source is closed, but I'd be happy to answer any algorithmic questions you may have if you're trying to achieve the same effect.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23489 - benjamin - Wed Jul 14, 2004 3:00 am</h4>
    <div class="postbody"><span class="postbody">Thanks for your offer of help. I should probably cut my teeth on Mode 7 style first. Is it a somewhat straightforward path from that to swiveling the camera?
<br/>
<br/>
In any case, I think this cearn tutorial on Mode 7 is one of the better ones right?
<br/>
<br/>
<a href="http://user.chem.tue.nl/jakvijn/tonc/mode7.htm" target="_blank">http://user.chem.tue.nl/jakvijn/tonc/mode7.htm</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23490 - sgeos - Wed Jul 14, 2004 3:14 am</h4>
    <div class="postbody"><span class="postbody">[quote="poslundc"<a class="postlink" href="http://www.danposluns.com/gbadev/pseudo3D.html" target="_blank">My project</a> adds the ability to swivel the camera up and down, which required the use of a raycasting algorithm that is more computationally expensive.[/quote]
<br/>
Do you need to cast any more than 160 rays (one for each scan line) every time the pitch is changed?  Would you mind putting an image up on your site that expains how you calculate the pitch?
<br/>
<br/>
With a night backdrop, wouldn't it make more sense for the horizon to be black?
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23508 - poslundc - Wed Jul 14, 2004 1:49 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">Do you need to cast any more than 160 rays (one for each scan line) every time the pitch is changed?  Would you mind putting an image up on your site that expains how you calculate the pitch?</td> </tr></table><span class="postbody">
<br/>
<br/>
I don't have access to tools at work that can let me do that, but pitch is just a stored variable that can be adjusted by user or game controls; it is not calculated.
<br/>
<br/>
And yes, it's just 160 rays for each scanline.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">With a night backdrop, wouldn't it make more sense for the horizon to be black?</td> </tr></table><span class="postbody">
<br/>
<br/>
My engine can use any colour for the horizon/fog effect, as well as for the gradient sky effect.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23509 - poslundc - Wed Jul 14, 2004 1:55 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>benjamin wrote:</b></span></td> </tr> <tr> <td class="quote">Thanks for your offer of help. I should probably cut my teeth on Mode 7 style first. Is it a somewhat straightforward path from that to swiveling the camera?</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes and no... the basic Mode 7 effect doesn't require much thought about the geometry or 3D mathematics behind what you are doing. If you are using raycasting, you have to put a lot more thought into how you do things like calculate the background's x and y coordinates for each scanline. You will need a solid grasp of trigonometry and you will have to draw a bunch of diagrams.
<br/>
<br/>
If as you originally said zooming is all you require, that should be fairly easy to implement because you can just scale your distance values before you divide.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23513 - keldon - Wed Jul 14, 2004 3:17 pm</h4>
    <div class="postbody"><span class="postbody">just scaling the screens x and y co-ordinates does not produce zooming, but enlargement.
<br/>
<br/>
To a zoom effect, you'd have to use trigonometry (which is pretty easy, they teach it to you at school in 2nd/3rd year).
<br/>
<br/>
But if an enlargement effect is all you want (which is completely different) then that is fine.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23521 - tepples - Wed Jul 14, 2004 5:11 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>benjamin wrote:</b></span></td> </tr> <tr> <td class="quote">So with mode 7 I wouldn't be able to change the pitch, that kinda stinks as I was hoping to do that, but maybe I can get away without it.</td> </tr></table><span class="postbody">
<br/>
It's algorithmically easy to fake changing the pitch: just scroll the entire screen up and down. You can still use a reciprocal table.
<br/>
<br/>
If you want to see a free software demo that actually changes the pitch in real time, go look up <a class="postlink" href="http://www.pineight.com/gba/#tod" target="_blank">Tetanus On Drugs</a>. Its fx.c contains a simple Mode 7 engine. Remember that if you need more speed, you can raycast only every other scanline and use linear interpolation to get the odd lines.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23527 - poslundc - Wed Jul 14, 2004 5:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">It's algorithmically easy to fake changing the pitch: just scroll the entire screen up and down. You can still use a reciprocal table.</td> </tr></table><span class="postbody">
<br/>
<br/>
I vaguely recall this as being an old Wolfenstein trick... it should suffice for reasonably small angle changes, but I don't think it will look very realistic if, for example, you want to swing into an entirely top-down view.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Remember that if you need more speed, you can raycast only every other scanline and use linear interpolation to get the odd lines.</td> </tr></table><span class="postbody">
<br/>
<br/>
That's a neat suggestion. I'll keep it in mind if I ever need to tweak some extra cycles out of my program.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
