<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How to get a 12-bit RGB mode on an 8-bit paletted display - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > How to get a 12-bit RGB mode on an 8-bit paletted display</h2>
<div id="posts">
<div class="post">
    <h4>#28971 - ayqazi - Tue Nov 09, 2004 1:37 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I was browsing the Allegro (cross-platform graphics library) and I saw this example (comment taken from it:)
<br/>
<br/>
/*
<br/>
 *    Example program for the Allegro library, by Richard Mitton.
<br/>
 *
<br/>
 *    or "How to get a 12-bit mode on an 8-bit card"
<br/>
 *
<br/>
 *    This program sets up a 12-bit mode on any 8-bit card, by setting up
<br/>
 *    a 256-colour palette that will fool the eye into grouping two 8-bit
<br/>
 *    pixels into one 12-bit pixel.
<br/>
 *
<br/>
 *    It's quite simple (sort of). You make your 256-colour palette with
<br/>
 *    all the combinations of blue and green, assuming green ranges from
<br/>
 *    0-15 and blue from 0-14. This takes up 16x15=240 colours. This leaves
<br/>
 *    16 colours to use as red (red ranges from 0-15).
<br/>
 *
<br/>
 *    Then you put your green/blue in one pixel, and your red in the pixel
<br/>
 *    next to it. The eye gets fooled into thinking it's all one pixel.
<br/>
 *
<br/>
 *    It's all very simple really. Honest.
<br/>
 *
<br/>
 *    To start with, you set a normal 256 color VESA mode, and construct a 
<br/>
 *    special palette for it. But then comes the trick: you need to write
<br/>
 *    to a set of two adjacent pixels to form a single 12 bit dot. Two eight
<br/>
 *    bit pixels is the same as one 16 bit pixel, so after setting the video
<br/>
 *    mode you need to hack the screen bitmap about, halving the width and
<br/>
 *    changing it to use the 16 bit drawing code. Then, once you have packed
<br/>
 *    a color into the correct format (using the makecol12() function below),
<br/>
 *    any of the normal Allegro drawing functions can be used with this 12
<br/>
 *    bit display!
<br/>
 *
<br/>
 *    Things to note:
<br/>
 *
<br/>
 *    The horizontal width is halved, so you get resolutions like 320x480,
<br/>
 *    400x600, and 512x768.
<br/>
 *
<br/>
 *    Because each dot is spread over two actual pixels, the display will
<br/>
 *    be darker than in a normal video mode.
<br/>
 *
<br/>
 *    Any bitmap data will obviously need converting to the correct 12
<br/>
 *    bit format: regular 15 or 16 bit images won't display correctly...
<br/>
 *
<br/>
 *    Although this works like a truecolor mode, it is actually using a
<br/>
 *    256 color palette, so palette fades are still possible!
<br/>
 *
<br/>
 *    Note: This code only works in linear screen modes (don't try Mode-X).
<br/>
 */
<br/>
<br/>
I was just wondering if we could put it to some kind of funky use?  Yes, the GBA's already got 16-bit mode, but its only single buffered.  I was thinking of doing this trick with the 8-bit double-buffered mode and thus providing a 12-bit real colour double-buffered mode.
<br/>
<br/>
I don't however think its a useful hack.  However, what does everybody else think?  Could it be useful in any situations?
<br/>
<br/>
Thanks,
<br/>
         Asfand Yar<br/>_________________<br/>--
<br/>
<a href="http://www.it-is-truth.org/" target="_blank">http://www.it-is-truth.org/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28972 - keldon - Tue Nov 09, 2004 2:06 pm</h4>
    <div class="postbody"><span class="postbody">It's fine for a PC, but to do that to the gameboy would not be a good idea because you are halving the resolution.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28975 - poslundc - Tue Nov 09, 2004 3:14 pm</h4>
    <div class="postbody"><span class="postbody">You may run into problems on the GBA because the LCD screen already sort of uses this optical "trick" to achieve the effect of colour in the first place. Because of the BGR configuration you'd want to reverse the order, and you'd be leaving a sizeable gap between meta-pixels that might look awfully shabby.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#28998 - Abscissa - Tue Nov 09, 2004 9:41 pm</h4>
    <div class="postbody"><span class="postbody">That's pretty cool.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29001 - sgeos - Tue Nov 09, 2004 11:29 pm</h4>
    <div class="postbody"><span class="postbody">The GBA screen is already dark.  I think this trick would darken the screen too much.  (Assuming the trick works at all.)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29008 - tepples - Wed Nov 10, 2004 2:49 am</h4>
    <div class="postbody"><span class="postbody">If you were seriously considering using this trick, just use mode 3, or if you want tiles and sprites, use dithered 8-bit images in a 332 palette (if you have Allegro source code you should know what a 332 palette is).<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29017 - sgeos - Wed Nov 10, 2004 7:04 am</h4>
    <div class="postbody"><span class="postbody">I'm assuming 3 red bits 3 green bits and 2 blue bits for a total of 256 palette entries?  My main problem with these palettes is that many of the dark or desaturated colors more or less look the same.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29020 - sajiimori - Wed Nov 10, 2004 7:44 am</h4>
    <div class="postbody"><span class="postbody">So weight it towards bright and saturated colors.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29023 - ayqazi - Wed Nov 10, 2004 8:59 am</h4>
    <div class="postbody"><span class="postbody">As I said, I don't think it'd be useful.  Just wondering if anybody could think of any uses for it that I couldn't.<br/>_________________<br/>--
<br/>
<a href="http://www.it-is-truth.org/" target="_blank">http://www.it-is-truth.org/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29035 - ampz - Wed Nov 10, 2004 12:35 pm</h4>
    <div class="postbody"><span class="postbody">dithering will most likely provide better results than this "trick" under all circumstances.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29041 - an - Wed Nov 10, 2004 6:14 pm</h4>
    <div class="postbody"><span class="postbody">if you need lots of colors in 8 bit mode, try this trick ;)
<br/>
<br/>
create 16 bit offscreen buffer and fill your screen with gradient from left to right, so that the first pixels have index 0 and the last pixels on right have 239.
<br/>
<br/>
then, on your hsync-interrupt, for every single scanline, copy the correct pixels from your buffer to the palettememory.
<br/>
<br/>
this way you can have 15 bit colors on 8 bit screen and you can even have it doublebuffered. wohoo! ok, it's slow but it works otherwise fine.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29048 - sajiimori - Wed Nov 10, 2004 7:15 pm</h4>
    <div class="postbody"><span class="postbody">I'm not seeing the point of that trick.  You're copying in the same amount of data as you would in mode 3, and a VRAM backbuffer is useless since your pixel data is always the same.
<br/>
<br/>
Now, it might be useful in a tile mode if you fill all the BGs with the gradient pattern and punch holes in some of the top ones, because then you could sort sprites into a 15-bit scene.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29076 - tepples - Thu Nov 11, 2004 12:57 am</h4>
    <div class="postbody"><span class="postbody">But if you're going to go to all that work, then why not just dither your BG data down to 8-bit? Does it have something to do with inability to perform 8-bit VRAM writes on dynamically generated BG data?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29081 - sajiimori - Thu Nov 11, 2004 2:40 am</h4>
    <div class="postbody"><span class="postbody">Are you asking why somebody would want 15 bit color instead of dithering?  I would think the answer is obvious.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29734 - Kayamon - Wed Nov 24, 2004 3:36 pm</h4>
    <div class="postbody"><span class="postbody">Wahey! My code is finally famous ;-)
<br/>
<br/>
But, on GBA, as someone said, the resolution loss would be a killer. Possibly a better way might be to show all the RED/BLUE pixels one frame, then GREEN the next? The LCD funkyness might blend it all together a bit.
<br/>
<br/>
But anyway, probably not worth the bother I suspect.... just stick with 16-bit colour, I reckon.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#29746 - Abscissa - Wed Nov 24, 2004 6:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Kayamon wrote:</b></span></td> </tr> <tr> <td class="quote">The LCD funkyness might blend it all together a bit.</td> </tr></table><span class="postbody">
<br/>
<br/>
Either that or nausiate the player ;) But still a cool idea.  If it's fast enough it could be like DLP and work well.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
