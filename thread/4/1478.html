<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>I need help with my function - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > I need help with my function</h2>
<div id="posts">
<div class="post">
    <h4>#7429 - mandarin - Tue Jun 17, 2003 7:54 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
I have for the last 2 weeks been busy with my RPG and i came up with this spritedisplay function for my items, but i can't seem to display both sprites on the screen at the same time. Can anyone help?
<br/>
<br/>
Heres the code :
<br/>
<br/>
u16* OAM = (u16*)0x7000000;
<br/>
<br/>
OAMEntry sprites[128];
<br/>
pRotData rotData = (pRotData)sprites;
<br/>
<br/>
void WaitForVsync()
<br/>
{
<br/>
	while((volatile u16)REG_VCOUNT != 160){}
<br/>
}
<br/>
<br/>
void CopyOAM()
<br/>
{
<br/>
	u16 loop;
<br/>
	u16* temp;
<br/>
	temp = (u16*)sprites;
<br/>
	for(loop = 0; loop &lt; 128*4; loop++)
<br/>
	{
<br/>
		OAM[loop] = temp[loop];
<br/>
	}
<br/>
}
<br/>
<br/>
 void initsprites()
<br/>
{
<br/>
	u16 loop;
<br/>
<br/>
		for(loop=0;loop&lt;128;loop++)
<br/>
   {
<br/>
   	sprites[loop].attribute0 = 160;
<br/>
   	sprites[loop].attribute1 = 240;
<br/>
   }
<br/>
  }
<br/>
<br/>
int displayitems(u16 x, u16 y, int no)
<br/>
<br/>
{
<br/>
	u16 loop;
<br/>
	u16 num;
<br/>
	u16 attrnum;
<br/>
<br/>
	attrnum=0;
<br/>
	attrnum=no*8;
<br/>
	num=0;
<br/>
	num=no;
<br/>
<br/>
<br/>
<br/>
<br/>
	for(loop=0; loop &lt; 128 ; loop++)     {
<br/>
		OBJPaletteMem[loop] = itemsPalette[loop];
<br/>
                                   }
<br/>
		  initsprites();
<br/>
<br/>
	sprites[no].attribute0 = COLOR_256 | SQUARE | y;
<br/>
	sprites[no].attribute1 = SIZE_16 | x;
<br/>
	sprites[no].attribute2 = attrnum;
<br/>
<br/>
if (no = 0)    {
<br/>
<br/>
num=num+128;
<br/>
<br/>
	 for(loop = 0; loop &lt; 128;loop++)
<br/>
   {
<br/>
   	OAMData[loop] = itemsData[loop];
<br/>
   }
<br/>
            }
<br/>
 	else {
<br/>
                 num=(num+1)*128;
<br/>
 		for(loop = 128; loop &lt;num;loop++)
<br/>
 	{
<br/>
 		OAMData[loop] = itemsData[loop-128];
<br/>
 	}
<br/>
         }
<br/>
<br/>
}
<br/>
<br/>
<br/>
int main()
<br/>
{
<br/>
        setmode(mode1 | objmap1d | objenable);
<br/>
<br/>
<br/>
       	 displayitems(40,50,1);
<br/>
<br/>
         displayitems(60,100,2);
<br/>
<br/>
       while (1) {
<br/>
<br/>
        WaitForVsync();
<br/>
         CopyOAM();
<br/>
                  }
<br/>
             }</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7432 - Cyberman - Tue Jun 17, 2003 9:17 pm</h4>
    <div class="postbody"><span class="postbody">You are using mode 1
<br/>
This is 2 BG and 1 Rotatable
<br/>
I would check to see if both sprites have there priority set higher than either of the back grounds first. Also see if they are in the right order. IE if Obj B should be visable about Obj A then B should have a lower Sprite offset into the OAM (lower means higher priority).
<br/>
<br/>
Cyb</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7435 - mandarin - Tue Jun 17, 2003 9:52 pm</h4>
    <div class="postbody"><span class="postbody">thanx man , but just one thing how do i change the sprites priority give me a sample code if u can plz.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7565 - Arek the Absolute - Thu Jun 19, 2003 9:23 pm</h4>
    <div class="postbody"><span class="postbody">You should also check to make sure you're not overwriting your sprite image data. It looks to me like every time you copy image data into the EXACT same place in OAM, which means you can't show more than one at a time. In order to show multiple sprites you're going to need to make sure that you put the image data for each sprite in a position that corresponds with that sprite's character number.<br/>_________________<br/>-Arek the Absolute</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7810 - jcpredator - Wed Jun 25, 2003 1:59 pm</h4>
    <div class="postbody"><span class="postbody">I agree with Arek, to me it looks like your overwriting ur sprite data.<br/>_________________<br/>There is no spoon...</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
