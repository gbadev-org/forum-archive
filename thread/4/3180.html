<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Illegal byte read - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Illegal byte read</h2>
<div id="posts">
<div class="post">
    <h4>#18827 - JL - Tue Apr 06, 2004 4:03 pm</h4>
    <div class="postbody"><span class="postbody">Hi guys,
<br/>
<br/>
I'm using vba for debugging and I ran into the following (from trace.log):
<br/>
<br/>
.
<br/>
.
<br/>
.
<br/>
DMA3: s=02000030 d=07000000 c=8400 bytes=00000400
<br/>
Illegal byte read: 0000000c at 08006a64
<br/>
Illegal byte read: 0000000c at 08006a64
<br/>
Illegal byte read: 0000000c at 08006a64
<br/>
<br/>
<br/>
Now, by checking out what's at 0x08006a64 I found out that all I'm doing is calling a (virtual) method from a C++ class, like this:
<br/>
<br/>
    myObjects[j]-&gt;setvisibility(myObjects[0]);
<br/>
<br/>
(j is valid, ofcourse... so are the object arrays).
<br/>
<br/>
When I remove the call to that function, the illegal reads disappear. So, my question is, what's wrong here? What does illegal read mean in this context, is something not aligned correctly?  Can anyone shed some light on this? Thanks in advance!
<br/>
<br/>
Grtz,
<br/>
Niels</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18828 - jma - Tue Apr 06, 2004 4:15 pm</h4>
    <div class="postbody"><span class="postbody">Is <span style="font-style: italic">myObjects</span> a NULL pointer? That would be my guess. <span style="font-style: italic">j</span> is just an index into an array (that isn't set AFAICT).
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18833 - JL - Tue Apr 06, 2004 8:26 pm</h4>
    <div class="postbody"><span class="postbody">No, myObjects is definitely not a NULL pointer. It is an array that's declared elsewhere, to be exact I define it in the header of the class:
<br/>
<br/>
class LevMan
<br/>
{
<br/>
public:
<br/>
/* snip, irrelevant */
<br/>
<br/>
private:
<br/>
    // Objects administration 
<br/>
    int myNrObjects;
<br/>
    Object* myObjects[MAX_OBJECTS];
<br/>
};
<br/>
<br/>
The array gets filled with pointers to Objects and I run through the array with a for loop (that's where the j comes in from my previous code snippet, j has a valid value).
<br/>
<br/>
Anyway, when I try the code on just the first object (that I KNOW is there), the illegal read happens. Funny thing is, VBA notices it and reports it but there is otherwise no directly noticable effect. The method gets called and my program runs through.
<br/>
<br/>
So, can anyone shed any light on my illegal read activities? ;-) 
<br/>
<br/>
What is meant by illegal byte read and why would it happen when calling a method (or could it be my array subscriptor.....?)? Any help appreciated.
<br/>
<br/>
Grtz,
<br/>
Niels</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18853 - bats - Wed Apr 07, 2004 3:02 am</h4>
    <div class="postbody"><span class="postbody">the format for Illegal Reads or Writes is
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Illegal [Byte/Halfword/Word] Read: (Read Address) from (PC address)
<br/>
Illegal [Byte/Halfword/Word] Write: (Value) to (Write Address) from (PC address)
<br/>
</td> </tr></table><span class="postbody">
<br/>
although the pc address is off by 2 bytes (at least in my test case).
<br/>
So, with your read address being 0xc ... it seems like you're dereferencing a NULL pointer. Check your assembly listing.
<br/>
<br/>
Ben</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18861 - JL - Wed Apr 07, 2004 9:27 am</h4>
    <div class="postbody"><span class="postbody">Hi guys,
<br/>
<br/>
Thanks for all your input, I solved it now! What happened was that I used an if-statement, like this:
<br/>
<br/>
if (blabla)
<br/>
{
<br/>
    myObjects[j]-&gt;setvisibility(myObjects[0]);
<br/>
}
<br/>
<br/>
And by removing the call to setvisibility the read error disappeared, however that call was not the problem! Indeed, somewhere in my blabla expression a NULL pointer could be dereff-ed.  But the entire if-statement was removed (rightly so) by the optimizer (I use the -O3 compiler setting) when I deleted the call to setvisibility so that's why I initially suspected that call to be the cause. 
<br/>
<br/>
Thanks again guys!
<br/>
Niels</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
