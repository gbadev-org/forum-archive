<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Game Concepts for Newbie - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > Game Concepts for Newbie</h2>
<div id="posts">
<div class="post">
    <h4>#11327 - RaBBi - Thu Oct 02, 2003 6:33 pm</h4>
    <div class="postbody"><span class="postbody">Hi all,
<br/>
<br/>
Here I start to make games on GBA, and games&lt;in general, and there some concepts about main() fonction and vblank interrupt that I don't assimile  very well.
<br/>
<br/>
I know, if I understood, that VBlank comes 60 times per second, doesn't it?
<br/>
<br/>
And I know, also if I understood, that main() loop is called continuously until stop command, like game over.
<br/>
<br/>
But if I have a function F in main that is executed more than 1/60 secs (First is it possible????), do the VBlank functions execute too?
<br/>
And F resume from an interrupted point after VBLANK execution?
<br/>
<br/>
And if the execution time of a function VBF in VBLANK take more than 1/60, what's happen?
<br/>
<br/>
Does VBLANK mean new frame?
<br/>
HBLANK take more time and more ressources ?
<br/>
<br/>
Sorry, I know that it will make many of you laughing, but I need some "experts" advice to do a really good start with functions that use frame change detection.
<br/>
Ex: NPC sprites moves when I move my hero, or NPC moves when I display some text as type-writer effect.
<br/>
<br/>
Sorry for poor english, I'm french and very ill tonight ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11329 - poslundc - Thu Oct 02, 2003 7:05 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RaBBi wrote:</b></span></td> </tr> <tr> <td class="quote">Hi all,
<br/>
<br/>
Here I start to make games on GBA, and games&lt;in general, and there some concepts about main() fonction and vblank interrupt that I don't assimile  very well.
<br/>
<br/>
I know, if I understood, that VBlank comes 60 times per second, doesn't it?</td> </tr></table><span class="postbody">
<br/>
<br/>
Yes, very close to that.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RaBBi wrote:</b></span></td> </tr> <tr> <td class="quote">And I know, also if I understood, that main() loop is called continuously until stop command, like game over.</td> </tr></table><span class="postbody">
<br/>
<br/>
Not exactly. Your AGBMain() function is called once, when the ROM is executed (or the power to the GBA turns on).
<br/>
<br/>
You will want to put an infinite loop into this function, and this loop is where you will determine what appears on the screen every 1/60th of a second.
<br/>
<br/>
Even when your game reaches "Game Over", you will still want to display a "Game Over" image on the screen, then return them to the title screen, maybe when they press Start or something. All of this should be handled in your infinite loop: as long as you are displaying something on the screen, you are still looping, and on a console like this, the loop doesn't terminate until the player turns the GBA off.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RaBBi wrote:</b></span></td> </tr> <tr> <td class="quote">But if I have a function F in main that is executed more than 1/60 secs (First is it possible????), do the VBlank functions execute too?
<br/>
And F resume from an interrupted point after VBLANK execution?
<br/>
<br/>
And if the execution time of a function VBF in VBLANK take more than 1/60, what's happen?
<br/>
<br/>
Does VBLANK mean new frame?
<br/>
HBLANK take more time and more ressources ?</td> </tr></table><span class="postbody">
<br/>
<br/>
I suggest you take a good, long look at <a class="postlink" href="http://thepernproject.com/index2.htm" target="_blank">The Pern Project</a> tutorials, or even better, there is an excellent <a class="postlink" href="http://www.ifrance.com/edorul/french/sommaire.htm" target="_blank">tutorial in french</a> here.
<br/>
<br/>
The best advice I can give you is to work through these tutorials bit by bit, and make sure you understand what is going on. You are asking questions about interrupts and cycles, but first you need to learn how the hardware works.
<br/>
<br/>
Basically, it takes the GBA 1/60th of a second to draw the screen.
<br/>
<br/>
Your code can be running at any point during this redrawing.
<br/>
<br/>
However, if your code is running at a point where the GBA is actually outputting a picture onto the LCD screen, and you change the data in that picture, then it will look very bad. You do not want to change that picture while the GBA is drawing it on the screen.
<br/>
<br/>
For this reason, the GBA hardware stops when it's done drawing the screen, and waits a while before starting again, so that you can change what it draws without it screwing up the picture. This is what is called VBlank.
<br/>
<br/>
A well-designed program will spend the time that the GBA is drawing on the screen figuring out what happens next, handling user input, etc. Then when the GBA is done drawing and enters VBlank mode, the program will update the screen with any changes.
<br/>
<br/>
Go, read the tutorials. Try them out for yourself. Learn by doing. Bonne chance.
<br/>
<br/>
Dan.</span><span class="gensmall"><br/><br/>Last edited by poslundc on Thu Oct 02, 2003 7:06 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#11330 - niltsair - Thu Oct 02, 2003 7:05 pm</h4>
    <div class="postbody"><span class="postbody">First, you program should never exit from function 'Main', else the game reset. </span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">bool gReset = false;
<br/>
void main()
<br/>
{
<br/>
    //init stuff
<br/>
    bReset = false;
<br/>
    ....
<br/>
    while( Reset == false )
<br/>
    {
<br/>
        //Your game logic, loop, etc..
<br/>
        F();
<br/>
        ....
<br/>
    }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Now VBlank occurs about 60 times per seconds. It's an interupt, and like all interupt, it means that :
<br/>
-Program Stop
<br/>
-Infos concerning current execution are saved
<br/>
-Code for interupt loaded
<br/>
-Code for interupt executed
<br/>
-Code for previous function restored(from save)
<br/>
-Continue current execution exactly where it left off
<br/>
<br/>
So, yes, executing Main takes more than 1/60th seconds, it actually take from when you started the game to the moment you reset/power off it. But it's constantly being interupted by.. well.. interupts :)
<br/>
<br/>
Interupts should be very quick to execute. If it takes more time to execute than it takes to generate a new one, then you have a problem. In this case, if it takes more than 1/60th of a second, then you'll program will either crash or stay in the interupt code(depends if you disable int code while in one)
<br/>
<br/>
GBA has 160lines that need to be refreshed, but it actually refresh a little more than 228. The period that it's refreshing non-existing screen lines is the VBlank period where it's safe to refresh screen data without having display problem. VBlank occurs when it reach line 160.
<br/>
<br/>
HBlank occurs at the end of every line refresh(when reach col 240), VBlank occurs at the end of screen refresh(when reach line 160). 
<br/>
HBlank = 228 Time per screen refresh
<br/>
VBLank =1 Time per screen refresh.
<br/>
<br/>
So, HBlank is called 228x more often and thus would take away more time of your main program.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11331 - sajiimori - Thu Oct 02, 2003 7:07 pm</h4>
    <div class="postbody"><span class="postbody">It sounds like you need some practice with general programming before you try doing GBA development.  Get a handle on writing C programs for your computer, and you'll be able to answer many of your own questions, such as what main() is for.  There are some tutorials online, or you can get a good book on the subject.
<br/>
<br/>
<a href="http://www.amazon.com/exec/obidos/tg/detail/-/0672322226/qid=1065117270/sr=8-2/ref=sr_8_2/103-1152808-1223059?v=glance&amp;s=books&amp;n=507846" target="_blank">http://www.amazon.com/exec/obidos/tg/detail/-/0672322226/qid=1065117270/sr=8-2/ref=sr_8_2/103-1152808-1223059?v=glance&amp;s=books&amp;n=507846</a>
<br/>
<br/>
Sometimes when I "answer" somebody's questions this way, they reply by saying "I already know C and I've been writing programs for years!"  Well, I got the impression that you need to know C better because you misunderstand what main() is, and that's something that you would know if you knew C.  The main() function is not the same as a "main loop".
<br/>
<br/>
*edited for error</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11333 - RaBBi - Thu Oct 02, 2003 8:19 pm</h4>
    <div class="postbody"><span class="postbody">First of all, thank you all
<br/>
And second, sorry for my mistake about main loop...like I said, I'm ill (I may not be here tonight but my learn envy is too big lol) and I didn't want to say "main loop" but loop in main function ^^
<br/>
<br/>
In fact, I use while(1) { game code } in my main function.
<br/>
But when I wrote my first post, I made this language mistake ^^
<br/>
[game code is composed by functions like
<br/>
- load maps, sprites
<br/>
- activate/deactivate/move BGs
<br/>
- test input
<br/>
- move sprites
<br/>
- z_ordering sprites
<br/>
- etc...]
<br/>
<br/>
I read all and it's sounds more clearly.
<br/>
you're right, I must learn more C and more about GBA hardware.
<br/>
<br/>
In fact, I already have read many tutorial and the ENTIRE Pern Project.
<br/>
I didn't have all info in my brain, but I know where to search to find some answers to basic questions.
<br/>
<br/>
But never found a tutorial about how games are made.
<br/>
That's was the purpose of this topic in fact.
<br/>
<br/>
I had ideas about interrupt and you confirmed that I was ok about that, I'm happy ^^
<br/>
<br/>
In fact, in my game, I use VBLANK ONLYto copy objs to OAM (cause BGs don't ask for refresh too times), and I put a variable "g_newFrame" to 1.
<br/>
So in loop (in main function), I test g_newFrame before doing anything.
<br/>
<br/>
I wanted to know if I was right and if I may have to do this all the time in game programming.
<br/>
Do you put another function in your VBLANK?
<br/>
<br/>
For now, my game didn't crash so it seems that my function VBLANK is fast enough to be executed during this time I suppose.
<br/>
<br/>
I really thank you all and I'll take a look at the book you recommended me, even I think I understand now how it works, it will be a very useful complementary information ^^
<br/>
<br/>
EDIT: when re-reading post of niltsait, I ask me how to use several interrupt.
<br/>
Can I activate one VBLANK and one TIMER so I can keep on copy objects to OAM while waiting for a timer to be over?
<br/>
Thank you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11336 - sajiimori - Thu Oct 02, 2003 8:58 pm</h4>
    <div class="postbody"><span class="postbody">My main() is something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
main()
<br/>
{
<br/>
   init();
<br/>
   
<br/>
   while(1)
<br/>
   {
<br/>
      get_input();
<br/>
      update_world();
<br/>
      wait_for_vblank();
<br/>
      copy_oam();
<br/>
   }
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
This is simpler than using interrupts, and somewhat more fault tolerant.  If a frame takes too long to process, the game will slow down, but everything will still run ok.
<br/>
<br/>
I only use the vblank interrupt to update the audio buffer, so slowdowns won't cause the audio to skip.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11338 - RaBBi - Thu Oct 02, 2003 9:24 pm</h4>
    <div class="postbody"><span class="postbody">ok ^^
<br/>
<br/>
I don't know "waiting for VBlank" for the moment
<br/>
<br/>
In fact, the main problem I think about is for automatic events.
<br/>
<br/>
Example::Intro of my game:
<br/>
<br/>
BG is scrolling while two NPCs are running and sometimes text appears.
<br/>
<br/>
Example::End
<br/>
<br/>
<br/>
Can I do an unique function intro(), in which I use a loop with "new frame detecting" functions inside ? Plus input detecting inside.
<br/>
<br/>
And if Ok, where I can call it?
<br/>
<br/>
<br/>
In fact, for me, with my game coding level, move NPCs randomly in loop while BG scrolling in loop while move my hero with keys isn't too hard.
<br/>
<br/>
But I have a big mind problem facing automation with stop at precise times, etc.
<br/>
<br/>
Perhaps it is nothing for an experimented game developper, I hope.
<br/>
But while I'm not ok with this, I think my code, even if it works, will be badly structured.
<br/>
<br/>
Thank you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11341 - poslundc - Thu Oct 02, 2003 10:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RaBBi wrote:</b></span></td> </tr> <tr> <td class="quote">ok ^^
<br/>
<br/>
I don't know "waiting for VBlank" for the moment
<br/>
<br/>
In fact, the main problem I think about is for automatic events.
<br/>
<br/>
Example::Intro of my game:
<br/>
<br/>
BG is scrolling while two NPCs are running and sometimes text appears.
<br/>
<br/>
Example::End
<br/>
<br/>
<br/>
Can I do an unique function intro(), in which I use a loop with "new frame detecting" functions inside ? Plus input detecting inside.
<br/>
<br/>
And if Ok, where I can call it?</td> </tr></table><span class="postbody">
<br/>
<br/>
Part of the difficulty in coding a game on a console like the GBA is that you need to stop thinking at such a high-level and think more about the basic structure of a program.
<br/>
<br/>
The basic structure for a GBA program (to more-or-less quote sajiimori) is this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
BEGIN
<br/>
<br/>
   Make any necessary initializations
<br/>
<br/>
   DO
<br/>
      Handle Player Input
<br/>
      Update Game Status
<br/>
      Wait Until VBlank
<br/>
      Update Screen
<br/>
   LOOP FOREVER
<br/>
<br/>
END
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
It is your "Handle Player Input" and "Update Game Status" functions that determine whether you are in the intro screen, gameplay mode, etc.
<br/>
<br/>
A game that is in this format is called a <span style="font-style: italic">finite state machine</span>. I can't go into an indepth explanation just now as to what that means, but if you search on the Internet you will find many good explanations. This would be a good concept to learn and understand if you want to do game programming.
<br/>
<br/>
Most games can be represented as finite state machines: You start off in the TITLE SCREEN mode, then if the player hits "Start" you go into the LEVEL SELECT mode, then if the players hits A you go into the GAMEPLAY MODE, but if they hit B you go back to TITLE SCREEN mode, etc.
<br/>
<br/>
Je crois que nous avons eu la difficult? comprenant vos questions. Si ceci ne t'aide pas, tu peux vouloir essayer de demander en fran?ais... peut-?tre il y'aura quelqu'un qui peut repondre mieux en englais s'il te comprendre en fran?ais d'abord.
<br/>
<br/>
Bonne chance,
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11342 - niltsair - Thu Oct 02, 2003 11:02 pm</h4>
    <div class="postbody"><span class="postbody">Another detail, waiting for VBlank doesn't mean you're using interupts.
<br/>
<br/>
When you're just waiting for it, it means that you keep checking where the screen refresh is at, untill it reach line 160 and then update the screen.
<br/>
<br/>
While using VBlank interupts means that you enabled interupts for VBlank  which automaticly call a function that handle your screen refresh or any other things you want your game to do after a VBlank interupt (often people use it to create timers) This is done outside of your main loop and use no 'WaitForVBlank()'.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11343 - sajiimori - Thu Oct 02, 2003 11:08 pm</h4>
    <div class="postbody"><span class="postbody">This is how to wait for vblank.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define REG_VCOUNT     *(volatile u16*)0x4000006
<br/>
<br/>
wait_for_vblank()
<br/>
{
<br/>
   while(REG_VCOUNT != 160);
<br/>
}
<br/>
<br/>
// If you have interrupts set up properly,
<br/>
// use this instead to save GBA battery life.
<br/>
<br/>
wait_for_vblank()
<br/>
{
<br/>
   asm("swi 5":::"r0","r1","r2","r3","r12","lr");
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
For your intro example, you would want get_input() to detect if the player pressed "start" to skip the intro maybe, and you would want update_world() to move your NPCs and scroll the background.  Of course, get_input() and update_world() might do other things when the intro is not running.  So, use function pointers like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void (*get_input)();
<br/>
void (*update_world)();
<br/>
<br/>
main()
<br/>
{
<br/>
   init();
<br/>
   start_intro();
<br/>
   
<br/>
   while(1)
<br/>
   {
<br/>
      get_input();
<br/>
      update_world();
<br/>
      wait_for_vblank();
<br/>
      copy_oam();
<br/>
   }
<br/>
}
<br/>
<br/>
start_intro()
<br/>
{
<br/>
   get_input = intro_get_input;
<br/>
   update_world = intro_update_world;
<br/>
}
<br/>
<br/>
intro_get_input()
<br/>
{
<br/>
   if(PRESSED(KEY_START))
<br/>
      start_game();
<br/>
}
<br/>
<br/>
intro_update_world()
<br/>
{
<br/>
   scroll_background();
<br/>
   move_npcs();
<br/>
   draw_text();
<br/>
}
<br/>
<br/>
start_game()
<br/>
{
<br/>
   get_input = game_get_input;
<br/>
   update_world = game_update_world;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11344 - RaBBi - Thu Oct 02, 2003 11:27 pm</h4>
    <div class="postbody"><span class="postbody">Thanks again ^^
<br/>
<br/>
Dan&gt;I appreciate your effort to speak french, but you did some mistakes yet and I hope I don't do them in english cause it would be hell for you to understand me ! lol
<br/>
I joke, it was almost clear :)
<br/>
<br/>
so come back to the subject, I must say that I progress in understanding game concepts.
<br/>
But I think I'm troubled with loops in fact...
<br/>
<br/>
For example, sajimori wrote:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
intro_update_world() 
<br/>
{ 
<br/>
   scroll_background(); 
<br/>
   move_npcs(); 
<br/>
   draw_text(); 
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
But there is no sign of a loop at first sight.
<br/>
So may I understand that the loop is conditionned by "while(1)" in main function?
<br/>
And that I CAN'T/MAY NOT/DON'T use loops in other functions? Just detecting new frame?
<br/>
<br/>
I ask that cause scroll_backgrounds is while move_npcs and while draws_text, not one after another.
<br/>
<br/>
Dan&gt; by "finite state machine" do you mean I can use a variable that determines in which state my game is, and may test this variable to execute particulary functions?
<br/>
<br/>
I'll never thank enough guys ^^
<br/>
<br/>
I have a last question (I imagine you thinking about killing me at this time lol) : Are there Frenchies on this board ;)<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11345 - sajiimori - Thu Oct 02, 2003 11:44 pm</h4>
    <div class="postbody"><span class="postbody">You can use loops whenever you like, but my example has only one: while(1) in main().
<br/>
<br/>
The function scroll_background() would move the background by a small amount, so you would only call it once per frame.  Same with move_npcs().  That's why they are not in a loop.
<br/>
<br/>
It doesn't matter what order you call them in, because the effects won't be seen until the next frame.
<br/>
<br/>
With this setup, you don't need to "detect" a new frame at all.
<br/>
<br/>
*edit* Re: finite state machines -- The variables in my example are function pointers, so they don't need to be tested.  You just call them.  But, you could do this instead (though it's not so pretty and it's slower):
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define STATE_INTRO      1
<br/>
#define STATE_INGAME   2
<br/>
...
<br/>
<br/>
int game_state;
<br/>
<br/>
main()
<br/>
{
<br/>
   ...
<br/>
   game_state = STATE_INTRO;
<br/>
   ...
<br/>
}
<br/>
<br/>
get_input()
<br/>
{
<br/>
   switch(game_state)
<br/>
   {
<br/>
   case STATE_INTRO:
<br/>
      intro_get_input();
<br/>
      break;
<br/>
   case STATE_INGAME:
<br/>
      ingame_get_input();
<br/>
      break;
<br/>
   ...
<br/>
   }
<br/>
}
<br/>
<br/>
update_world()
<br/>
{
<br/>
   switch(...
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11347 - RaBBi - Thu Oct 02, 2003 11:56 pm</h4>
    <div class="postbody"><span class="postbody">it grows it grows ! ^^
<br/>
<br/>
But it works without frame detection only if I use wait_for_vblank I guess?
<br/>
If I use interrupt VBLANK, I must use frame detection in all my "one execution by frame" functions, do I?
<br/>
<br/>
For the loops, let me tell you what it blocks my mind :
<br/>
<br/>
In fact, I think that if I put a loop in a function, drawtext() for example, all the others functions would be stopped until this (loop) is finished...
<br/>
<br/>
For scrolling BG or moving Npc, it's not so hard (update X,Y once per frame) but to draw text, I cannot use a loop that read a character then display it only each 5 frames (type writer effect) then read next character, and so on...until string is complete.
<br/>
IF I do a loop here, BGs and NPCs will be draw yes ('cause interrupt) but not moving, no?
<br/>
<br/>
EDIT: I just read your edit after posting, and effectively, I'm using this slower way in my game. I think I can be excused cause it's my first lol<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11366 - niltsair - Fri Oct 03, 2003 3:16 pm</h4>
    <div class="postbody"><span class="postbody">I'm french, from Qu?bec(Canada) and there's some more on this forum.
<br/>
<br/>
As for your type writer thingie, here's what you could do.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u32 gFrameCount(0);
<br/>
void main()
<br/>
{
<br/>
    init();
<br/>
    while(1)
<br/>
    {
<br/>
        //Do your loop here with functions calls
<br/>
        gFrameCount++;
<br/>
    }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
So, in your draw text function, you only write a character per 5 frames by checking the modulo of gFrameCount; You could use it anywhere else you want to also do something at interval instead of everyframe.
<br/>
<br/>
As for the screen, yes it's still would be draw you were right on this but it'S nto because of interupt. The screen just refresh itself constantly, by hardware with no programmer intervention. The interupt that you can enabled if you want to, is just telling you the screen just refreshed itself, it's not doing the refresh.
<br/>
<br/>
And for game, finite state machine is the way to go. Another way you could implement it while keeping it clear would be to use 1 loop per state and 1 loop that include all states, like this :
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u32 gFrameCount;
<br/>
u8   gState;
<br/>
void main()
<br/>
{
<br/>
    Init();
<br/>
    gState = STATE_INTRO;
<br/>
    While(gState != STATE_RESET)
<br/>
    {
<br/>
        switch( gState )
<br/>
        {
<br/>
        case STATE_INTRO: StateIntro(); break;
<br/>
        case STATE_GAME: StateGame(); break;
<br/>
        case STATE_PAUSE: StatePause(); break;
<br/>
        case STATE_MENU: StateMenu(); break;
<br/>
        }
<br/>
    }
<br/>
}
<br/>
<br/>
void StateIntro()
<br/>
{
<br/>
    stIntro_Init();
<br/>
    while( gState == STATE_INTRO)
<br/>
    {
<br/>
        stIntro_ReadKeys();
<br/>
        stIntro_UpdateWorld();
<br/>
        WaitVBlank();
<br/>
        gFrameCount++;
<br/>
    }
<br/>
    stIntro_CleanUp();
<br/>
}
<br/>
<br/>
void stIntro_ReadKeys()
<br/>
{
<br/>
    if( KeyPressed == Start)
<br/>
        gState = STATE_GAME;
<br/>
}
<br/>
<br/>
void stIntro_UpdateWorld()
<br/>
{
<br/>
    //Scroll the backgrounf or something
<br/>
}
<br/>
....
<br/>
And so on for every others states</td> </tr></table><span class="postbody">
<br/>
<br/>
As you can see, we loop inside the Intro state as long as gState fit. If we want to change state, we merely need to change the value of gState and it'll switch accordingly.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11372 - sajiimori - Fri Oct 03, 2003 5:41 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
But it works without frame detection only if I use wait_for_vblank I guess?
<br/>
</td> </tr></table><span class="postbody">
<br/>
The OAM copy will probably fail, because you are only allowed to write to the OAM during vblank.  But if you put the OAM copy in the vblank interrupt handler, and remove the wait_for_vblank(), things will run fine -- just way too fast.  That is, everything will move as fast as the CPU can move them, which is probably faster than 60 times per second.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If I use interrupt VBLANK, I must use frame detection in all my "one execution by frame" functions, do I?
<br/>
</td> </tr></table><span class="postbody">
<br/>
No, you see, those functions are called once per frame anyway.  Upon entry to the function, you *know* you are in a new frame, so you don't have to *detect* anything.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
In fact, I think that if I put a loop in a function, drawtext() for example, all the others functions would be stopped until this (loop) is finished... 
<br/>
</td> </tr></table><span class="postbody">
<br/>
That's right, so make sure there is enought time for the rest of the frame to be processed.  If the whole frame takes a little longer than 1/60th of a second, your game will slow down by half (because it missed one vblank, and will wait for the next).  But, I don't think this is a problem for you yet.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
For scrolling BG or moving Npc, it's not so hard (update X,Y once per frame) but to draw text, I cannot use a loop that read a character then display it only each 5 frames (type writer effect) then read next character, and so on...until string is complete.
<br/>
</td> </tr></table><span class="postbody">
<br/>
Right, if you put that loop in draw_text(), it would draw the entire string before anything else happens.  This is not what you want.  The function will be called once per frame, and each time it's called, it does a little more work.  Here is an example where draw_text() does *one* frame worth of work, not the whole thing at once:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
draw_text()
<br/>
{
<br/>
   if(frames_since_last_character_printed &gt;= 5)
<br/>
   {
<br/>
      print_a_character();
<br/>
      frames_since_last_character_printed = 0;
<br/>
   }
<br/>
   else
<br/>
      ++frames_since_last_character_printed;
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
IF I do a loop here, BGs and NPCs will be draw yes ('cause interrupt) but not moving, no?
<br/>
</td> </tr></table><span class="postbody">
<br/>
The vblank interrupt is not the cause of the screen refresh.  The GBA automatically redraws the screen 60 times a second.
<br/>
<br/>
If you still don't understand, you need to practice.  Learn by doing.  :-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11373 - RaBBi - Fri Oct 03, 2003 5:47 pm</h4>
    <div class="postbody"><span class="postbody">Thank you niltsair ^^, if you prefer I post in the two languages or just in french, tell me.
<br/>
<br/>
Ok, so I already use the trick of g_framesCount.
<br/>
I'm on a good way, don't you think ? lol
<br/>
<br/>
And I already use game states to know where in game I am.
<br/>
The second code you gently propose to me is similar to the one I use yet.
<br/>
<br/>
This sort of loop containing functions like :
<br/>
- queryKeys()
<br/>
- updateWorld()
<br/>
- waitForVblank() &gt;&gt; I didn't use it yet but I will ! Good trick ^^
<br/>
- copyObjToOam()
<br/>
I understand them and already use them.
<br/>
<br/>
But, what's embarassed me, is to put a loop in a function like updateWorld().
<br/>
In your example, you tell me to put the BG scroll in the stIntro_UpdateWorld()  function. I'm OK with it, it's how I do ^^
<br/>
But in this function scroll function, may I use g_newFrame detecting and use a static variable to remember where I was in the scrolling sequence (for the next call)?
<br/>
Because if I execute all the scrolling in one time with a loop, my NPCs didn't move by theirself while, and also I cannot query Keys while this time too.
<br/>
<br/>
I hope my problem is clearer for you after that.
<br/>
(If you prefer I'll post it in French)
<br/>
Anyway thank you for the explanation about automatic screen refresh, I didn't figure how it works before.
<br/>
<br/>
<br/>
EDIT (I was posting while sajimori was too ^^)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajimori wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If you still don't understand, you need to practice. Learn by doing. :-)
<br/>
</td> </tr></table><span class="postbody">
<br/>
Of course, I know, in computer domain (and in plenty of others), I always learned by doing ^^
<br/>
But like I said in first post, I'm ill for now, so I can't code and I prefer to discuss with you guys about these concepts I have difficulty with, before restart to program :P
<br/>
<br/>
So, you took away my doubts about loops that are blocking others functions after. I thank you for that.
<br/>
<br/>
But you tell that functions are called each frame.
<br/>
All functions? 
<br/>
IE that if a function takes more time than a screen refresh, it will not end?
<br/>
<br/>
<br/>
In fact I don't really imagine how fast a console run...I think...<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"><br/><br/>Last edited by RaBBi on Fri Oct 03, 2003 6:01 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#11375 - niltsair - Fri Oct 03, 2003 6:01 pm</h4>
    <div class="postbody"><span class="postbody">First, you don't want to use the word 'gently' to thank me, it got a different meaning than in french, one i don't think you'd care to learn ;-) 'Kindly' is the word you meant,
<br/>
<br/>
And secondly, yes, you just use a static variable inside your UpdateWorld that tell you what to do next frame, such as scrolling again or such. You can't keep looping inside it seing how it block everything else.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11376 - RaBBi - Fri Oct 03, 2003 6:06 pm</h4>
    <div class="postbody"><span class="postbody">sorry niltsair, I had doubts about using this term, the sense is more friendly than other ^^
<br/>
I will learn two language from now : C and English lol
<br/>
<br/>
Ok it seems that I had the good concepts in my mind, but I wanted to discuss them with "experts" to confirm I was not as lost and fool that I thought.
<br/>
A pb of self-reliance I think ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11378 - sajiimori - Fri Oct 03, 2003 7:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
But in this function scroll function, may I use g_newFrame detecting and use a static variable to remember where I was in the scrolling sequence (for the next call)?
<br/>
</td> </tr></table><span class="postbody">
<br/>
g_newFrame is useless.  Forget about it entirely.  Forget about detecting new frames, and forget about the vblank interrupt (until you are doing something more advanced).
<br/>
<br/>
Now think about this for a minute:  If you call a function once per frame, why would you need to detect if you are in a new frame?  The function is only called on new frames!
<br/>
<br/>
That's pretty much the idea.  :-)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11380 - RaBBi - Fri Oct 03, 2003 7:36 pm</h4>
    <div class="postbody"><span class="postbody">uh....in one sentence, you've change my whole mind lol
<br/>
<br/>
I'm Ok with but now there is 2 points I don't manage to collapse :
<br/>
<br/>
-Each function is called once per frame? or each frame?
<br/>
-But VBlank interrupt causes the functions stop, then they restart from stopped point (like all interrupts do)?
<br/>
<br/>
So I'm asking if all functions are EXECUTED ENTIRELY in one frame?
<br/>
Because if not, and if they're called each frame they never finish uh?
<br/>
<br/>
Do you think I'm too ill to understand ? ^^
<br/>
Me, I begin to think so :)
<br/>
<br/>
Anyway, I'll think more about this way, thank U.<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11381 - niltsair - Fri Oct 03, 2003 7:52 pm</h4>
    <div class="postbody"><span class="postbody">What happen is, you execute your code inside the loop untill you arrive at WaitForVBlank(). Then it just wait until it detect the end of a new frame.
<br/>
<br/>
This mean that your code could take more than 1 frame without problem, it doesn't matter how many frames occurs before WaitForVBlank. The function just make sure that before continuing it's the end of a frame, not that '1' frame was done. 
<br/>
<br/>
Of course, if too many frames occured before you call WaitforVBlank, then animations would look clunky (saccad?s)<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11382 - RaBBi - Fri Oct 03, 2003 8:16 pm</h4>
    <div class="postbody"><span class="postbody">And the light occurs ! ^^
<br/>
<br/>
It make sense for me now, at each point that was dark before.
<br/>
I think the most important words are "too many frames", so I don't do complex functions for the moment, as newbie, thus I think they don't take too much time.
<br/>
<br/>
Then, can I use the fact that human eye see good and fluid at 30 images/sec to have an amount of frames available to execute some big thing before display?<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11383 - niltsair - Fri Oct 03, 2003 8:28 pm</h4>
    <div class="postbody"><span class="postbody">Yep.<br/>_________________<br/>-Inside every large program is a small program struggling to get out. (Hoare's Law of Large Programs)
<br/>
-The man who can smile when things go wrong has thought of someone he can blame it on. (Nixon's Theorem)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11386 - tepples - Fri Oct 03, 2003 11:42 pm</h4>
    <div class="postbody"><span class="postbody">Most PlayStation 1 and Nintendo 64 games did run at 30 fps because the producers found polygon count more important than absolute fluidity, and some monochrome Game Boy games ran at 30 fps to cut down on blurring on the original system's green-tinged passive-matrix display.
<br/>
<br/>
The reason film can get away with 24 fps is that film has a natural motion blur, whereas most computer-rendered images don't.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11387 - grumpycat - Sat Oct 04, 2003 12:49 am</h4>
    <div class="postbody"><span class="postbody">You might want to take a look at the source code to my "Thrust" and "Galaxy Invader" programs, that is available on my website <a class="postlink" href="http://www.geocities.com/grumpycatsoftware" target="_blank">http://www.geocities.com/grumpycatsoftware</a>.  The "Thrust" game includes title screens, a demo mode, pause, the running game (of course!) and a high-score table.
<br/>
<br/>
"Thrust" was my first GBA project, so I'm not claiming it's any great example of anything, but it does illustrate the general program structure comments that have been discussed here.
<br/>
<br/>
Regards,
<br/>
Grumpy.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11396 - RaBBi - Sat Oct 04, 2003 10:45 am</h4>
    <div class="postbody"><span class="postbody">Thanks for more explanation tepples ^^
<br/>
And thanks to grumpy for his sources, I'll take a very carfully look at them ^^
<br/>
<br/>
<br/>
Thanks to all who spend time to answer very detailled ideas to a newbie like me.
<br/>
It's what I call a "communauty" !
<br/>
<br/>
I won't hesitate to show what I'll manage to do with your help and advices, be sure ^^
<br/>
<br/>
I did some basic things yet, but as I repeated in all my post until you show me the light, I had difficulty to coordonnate all the events.<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11444 - RaBBi - Tue Oct 07, 2003 12:30 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I posted a big post yesterday but it was lost during a forum send operation error.
<br/>
So I will be lighter this time.
<br/>
<br/>
My ask is simple for one time lol :
<br/>
<br/>
how can I manage to code functions (and their call way) which are exectuted only after another function has done, and which use frames counting.
<br/>
<br/>
For example:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void main(){
<br/>
<br/>
while(1) {
<br/>
doStuff();
<br/>
}
<br/>
<br/>
void doStuff(){
<br/>
<br/>
drawText(1,4,"blabla"); // draw text using a function that depends on frame couting
<br/>
waitSomeTime(5); // wait for a number of seconds for example
<br/>
clearText();
<br/>
drawText(1,4,"blabla"); // same as above
<br/>
waitSomeTime(5); // wait for a number of seconds for example
<br/>
clearText();
<br/>
<br/>
}
<br/>
<br/>
(void?) drawText(...) {
<br/>
// this functions draws a character from a string each number_of_frames frames, for example
<br/>
if (g_frames%number_of_frames) print_a_caracter();
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
May I use many test detection in my doStuff function?
<br/>
Like : if (draw_text_precedent_has_finished) { do_the_next} ?
<br/>
<br/>
For the moment, I use some "handworker" tricks, but I know they didn't belong to a proper way of game programming.
<br/>
<br/>
I hope I'd be more clearly than in my precedent posts ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11445 - Datch - Tue Oct 07, 2003 2:23 pm</h4>
    <div class="postbody"><span class="postbody">If I understand you well, you want to have a text display like in RPGs, with letters appearing one after one.
<br/>
<br/>
Since there's 60 vblanks per second, you can synchronize animation by counting vblanks.  
<br/>
<br/>
Eg: You wait for a vblank before drawing each letter of your text.  The display will be very slow like this I guess, 60 letters per second.  Maybe it would be better to draw two or more letters every vblank.<br/>_________________<br/>Visit SR-388 now and get a 40% discount!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11446 - tepples - Tue Oct 07, 2003 3:27 pm</h4>
    <div class="postbody"><span class="postbody">The way to do this is to maintain the state of your text-drawing operation, and then if(in_the_middle_of_drawing_text) draw_one_more_glyph();
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Datch wrote:</b></span></td> </tr> <tr> <td class="quote">The display will be very slow like this I guess, 60 letters per second.</td> </tr></table><span class="postbody">
<br/>
The U.S. TV caption system encodes at that rate (2 letters every 1/30 second), yet it manages to keep up with what is being said.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Maybe it would be better to draw two or more letters every vblank.</td> </tr></table><span class="postbody">
<br/>
Many games make text writing speed adjustable.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11456 - RaBBi - Tue Oct 07, 2003 8:11 pm</h4>
    <div class="postbody"><span class="postbody">arf sorry guys...I think I was not as clear as I thought ^^
<br/>
<br/>
In fact, drawText function was just an example of function that use frames couting (or Vblank counting as you want ^^).
<br/>
I could have chose moveSprite(source, destination,...) for example ^^
<br/>
<br/>
I would put in sequence functions of that sort, but the next function must be triggered only if the previous has done.
<br/>
But I cannot execute the whole function in one time, because, for example, I couldn't detect inputs or move sprites while, if I must wait that this function has done...
<br/>
<br/>
You say that functions are called many times during game execution, so this sort must execute some little stuff (not the whole in a unique call) and must know what was their last action to do next stuff.
<br/>
<br/>
In details, I will try:
<br/>
<br/>
- my function doStuff() is call once,
<br/>
- It trigger drawText() function,
<br/>
- That function doesn't draw entire characters in one time,
<br/>
- it draws some, then exit
<br/>
- but as it is not entirely accomplished, I can execute other actions like starting to draw other text, cause not the previous text is displayed yet!
<br/>
- I exit doStuff();
<br/>
- I look at input,
<br/>
- I copy to Oam,
<br/>
- and I recall doStuff(), to continue displaying the next part of the text,
<br/>
- and If all the text is displayed, the function must know that the next time it will be triggered, it musn't display the same text, but another.
<br/>
<br/>
<br/>
Perhaps for you it's easy to understand and practice this concept, but not for me yet...
<br/>
<br/>
For info I coded a frames counting display text function yet, but I don't figure out how to "chain" (?) them.
<br/>
For now, I use a trick based on a integer in static variable, that increment only if the text is entirely displayed, and a switch function that test this value, and execute other drawtext calls. 
<br/>
<br/>
REMEMBER: don't believe I only want to draw text ^^, it's not the matter ! lol<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11458 - sajiimori - Tue Oct 07, 2003 9:39 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// A simple printing subsystem.
<br/>
// Only supports one text printing operation at a time.
<br/>
// Use your imagination to improve it. ^_^
<br/>
// Warning: Not for real use.
<br/>
<br/>
static char* current_string;
<br/>
static int string_length;
<br/>
static int current_char;
<br/>
static int print_x, print_y;
<br/>
<br/>
// Call this to start a printing operation.
<br/>
start_printing(char* string, int x, int y)
<br/>
{
<br/>
   current_string = string;
<br/>
   string_length = strlen(string);
<br/>
   current_char = 0;
<br/>
   print_x = x;
<br/>
   print_y = y;
<br/>
}
<br/>
<br/>
// Call this every frame.
<br/>
update_text()
<br/>
{
<br/>
   if(!current_string)
<br/>
      return;
<br/>
<br/>
   if(current_char &gt;= string_length)
<br/>
   {
<br/>
      current_string = 0;
<br/>
      return;
<br/>
   }
<br/>
<br/>
   print_char(current_string[current_char++],
<br/>
      print_x, print_y);
<br/>
<br/>
   print_x += CHAR_WIDTH;
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11462 - RaBBi - Tue Oct 07, 2003 11:09 pm</h4>
    <div class="postbody"><span class="postbody">really good sajimori ^^
<br/>
<br/>
It's near the way I think about for some days :
<br/>
<br/>
- one function to initiate an action, like drawText or spriteMovement
<br/>
- one for update these every frame (or definite number of frames)
<br/>
<br/>
I'm going to keep on this way, adapting my drawtext functions in a first time.
<br/>
Try some other stuff next.
<br/>
<br/>
If someone has another tips that are more general about this sort of function, I'll be interested ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11467 - sajiimori - Wed Oct 08, 2003 1:57 am</h4>
    <div class="postbody"><span class="postbody">More general advice for state machines, such as the text module I posted:
<br/>
<br/>
1)  Make a set of variables that stores the state of the machine (e.g. current_string and current_char).
<br/>
<br/>
2)  Make a set of functions for altering the state of the machine (e.g. start_printing()).
<br/>
<br/>
3)  Make a function that interprets the state of the machine to produce the desired effect (e.g. update_text()).
<br/>
<br/>
To have multiple machines of the same type, use a struct to hold the state of each one.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11483 - RaBBi - Wed Oct 08, 2003 12:44 pm</h4>
    <div class="postbody"><span class="postbody">Yeh, I saw some sources using this way of states.
<br/>
<br/>
But what do you mean by "machines"?<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#11493 - tepples - Wed Oct 08, 2003 4:23 pm</h4>
    <div class="postbody"><span class="postbody">Start here:
<br/>
<br/>
<a class="postlink" href="http://www.wikipedia.org/wiki/finite%20state%20machine" target="_blank">Finite state machine@Wikipedia</a><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
