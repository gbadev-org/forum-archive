<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>getting isometric tiles onto the GBA square tile bkg - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > getting isometric tiles onto the GBA square tile bkg</h2>
<div id="posts">
<div class="post">
    <h4>#22182 - Marill - Mon Jun 14, 2004 11:22 am</h4>
    <div class="postbody"><span class="postbody">A iso tile is about 2:1 ratio, that is 16x8 (width x height).
<br/>
<br/>
But in the GBA bkgs, they work all on 1:1 (8x8) square ratios.
<br/>
<br/>
imagine the tile 16x8 will look something like this 
<br/>
<br/>
&lt;&gt;
<br/>
<br/>
so I use a 8x8 tile to store &lt; and another 8x8 tile to store &gt;, assign them side by side in teh bkg tile map and it will turn out nicely &lt;&gt;
<br/>
<br/>
The problem is that if I use such a scheme and tile the entire background, there will be gaps inbetween 2 isotiles. 
<br/>
<br/>
Below, is an example of 4 16x8 isotiles stacked, 2x2: (topleft, topright, bottomleft, bottomright)
<br/>
<br/>
&lt;&gt;&lt;&gt;
<br/>
&lt;&gt;&lt;&gt;
<br/>
<br/>
the gaps will be at the corners and right in the middle of the 2x2 pattern.
<br/>
<br/>
Therefore I am unable to tile the isotiles using 2 8x8 tiles to represent 1 isofile of 16x8.
<br/>
<br/>
One solution I can think of is using 2 background layers. The second background layer fills in the gaps in the 1st layer and then this second background layer is offset by +4+4 right into the middle where the gap should be in teh 2x2 isotile pattern.
<br/>
<br/>
This seems like an awful waste of space, but that's what I am thinking for the solution.
<br/>
<br/>
Is there anyone who has a much better solution to handle isotiles tiling on the GBA background layers which are square?
<br/>
<br/>
Main gist of the problem: isotiles aspect ratio is 2:1, GBA background tile is 1:1. This created gaps in between when tiling a 2x2 isotile pattern, how does one solve this problem?
<br/>
<br/>
Thanks in advancem, anyone! :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22183 - keldon - Mon Jun 14, 2004 11:39 am</h4>
    <div class="postbody"><span class="postbody">Use mode 7 scrolling, rotation and scaling; or just draw a map that is isometric :-/</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22190 - sgeos - Mon Jun 14, 2004 2:19 pm</h4>
    <div class="postbody"><span class="postbody">Getting a copy of Tactics Ogre (Advanced) and look at the tiles/layers/map setup really is the easiest way to figure this out.
<br/>
<br/>
You need two layers, a bottom BG layer and an overlay.  Trees, rocks, or anything else that the player can walk behind go in the overlay layer (includes grid cells that stick up in front of the units).
<br/>
<br/>
The tiles have to be created so that they can be tiled in the BG layer.  You could create "pieces" of tiles and put those together either at runtime or using a PC side tool.  (1/4 a water tile that you add to 1/4 of a grass tile and 1/4 of a dirt tile and 1/4 of another water tile, etc.)
<br/>
<br/>
A few base tiles will turn into many after they have been combined.  Tactics Ogre has tons of space to in VRAM, so I wouldn't worry about running out of space- only load the tiles you need for any given stage int VRAM!
<br/>
<br/>
I recommend using isometric tiles that fit in a 32w by 16h bounding box.  If you insist on using half of that ratio (16w by 8h) then you will need to design tiles with the middle filled in.  I figure that that is ... a lot of extra tiles and makes things really complicated.  There are parts of three grid cells on *each tile* in VRAM.  Good luck!
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22203 - sajiimori - Mon Jun 14, 2004 5:51 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
If you insist on using half of that ratio (16w by 8h) then you will need to design tiles with the middle filled in. I figure that that is ... a lot of extra tiles and makes things really complicated.
<br/>
</td> </tr></table><span class="postbody">
<br/>
I don't know what you mean by 'with the middle filled in', but I would expect the total number of tiles to be fewer when using units of 16x8.  The reason is that there would only be two isometric tiles visible in each rectangular tile, instead of four.
<br/>
<br/>
So if <span style="font-weight: bold">N</span> different surfaces are to have transitions to each other, there would be <span style="font-weight: bold">N^4</span> 32x16 tiles, or <span style="font-weight: bold">N^2</span> 16x8 tiles.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22222 - sgeos - Tue Jun 15, 2004 12:54 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">I don't know what you mean by 'with the middle filled in',</td> </tr></table><span class="postbody">
<br/>
Looks like I can't slack on my explanation afterall. =P
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">but I would expect the total number of tiles to be fewer when using units of 16x8.</td> </tr></table><span class="postbody">
<br/>
If I understand whay you are saying, I agree.  Given a 32 by 16 iso-grid unit, it can be split into four 16 by 8 units.  Each one of "quarter" can be used for a different tile transition.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">The reason is that there would only be two isometric tiles visible in each rectangular tile, instead of four.
<br/>
<br/>
So if <span style="font-weight: bold">N</span> different surfaces are to have transitions to each other, there would be <span style="font-weight: bold">N^4</span> 32x16 tiles, or <span style="font-weight: bold">N^2</span> 16x8 tiles.</td> </tr></table><span class="postbody">
<br/>
How did you arrive at these figures?  If I read the original post correctly, he is using 16x8 isometric metatiles that look something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">+ - - - - - - + + - - - - - - +
<br/>
|  B    _ / - | | - \ _    D  |
<br/>
|   _ /       | |       \ _   |
<br/>
|_/           | |           \_|
<br/>
| \ _       A | |   A     _ / |
<br/>
|     \ _     | |     _ /     |
<br/>
|  C      \ _ | | _ /      E  |
<br/>
+ - - - - - - + + - - - - - - +</td> </tr></table><span class="postbody">
<br/>
Dealing with this scheme is much simpler:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">+ - - - - - - + + - - - - - - + + - - - - - - + + - - - - - - +
<br/>
|             | |  B      _ / | | \ _      D  | |             |
<br/>
|    B        | |     _ /     | |     \ _     | |      D      |
<br/>
|             | | _ /         | |         \ _ | |             |
<br/>
|         _ / | |             | |             | | \ _         |
<br/>
|     _ /     | |      A      | |      A      | |     \ _     |
<br/>
| _ /      A  | |             | |             | |  A      \ _ |
<br/>
+ - - - - - - + + - - - - - - + + - - - - - - + + - - - - - - +
<br/>
+ - - - - - - + + - - - - - - + + - - - - - - + + - - - - - - +
<br/>
| - \ _    A  | |             | |             | |  A    _ / - |
<br/>
|       \ _   | |      A      | |      A      | |   _ /       |
<br/>
|           \ | | _           | |           _ | | /           |
<br/>
|             | |   \ _       | |       _ /   | |             |
<br/>
|    C        | |       \ _   | |   _ /       | |      E      |
<br/>
|             | |  C        \ | | /        E  | |             |
<br/>
+ - - - - - - + + - - - - - - + + - - - - - - + + - - - - - - +</td> </tr></table><span class="postbody">
<br/>
T is the number of tiles.  If one wants to be able to have transparent "nothing" spaces, then N (the number of transitions) is equal to T + 1.  (Otherwise N == T).  If you plan on using transparent tiles, you might want to replace N below, with (T + 1) to make things simpler.
<br/>
<br/>
The map will be put together with 8 by 8 tiles, so the exponent is determined by the number of separate isotile regions on a GBA tile.  The first 16x8 GBA tile contains regions A, B and C.  The first 32x16 GBA tile only contains regions A and B.
<br/>
<br/>
One will need <span style="font-weight: bold">N^3</span> 16x8 isotiles or <span style="font-weight: bold">N^2</span> 32x16 isotiles.  One breaks even at a single transition, after which one needs more 16x8 isotiles.  (Break even at zero tiles with transparency.)
<br/>
<br/>
The 16x8 scheme requires <span style="font-weight: bold">2 * N^3</span> GBA tiles, while the 32x16 scheme requires <span style="font-weight: bold">8 * N^2</span> GBA tiles.  VRAM usage breaks even at 4 transitions, after which one needs less GBA tiles using the 32x16 scheme.(Break even at three tiles with transparency.)
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22224 - sajiimori - Tue Jun 15, 2004 1:50 am</h4>
    <div class="postbody"><span class="postbody">My figures were based on treating the second diagram of your last post as a single 32x16 tile versus four 16x8 tiles.  When you suggested using larger tiles, I misinterpreted that as a suggestion to use tiles that include more transitions, rather than fewer.  Now it seems we're on the same page.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22225 - Marill - Tue Jun 15, 2004 3:01 am</h4>
    <div class="postbody"><span class="postbody">Hey, thanks for hte explanation!
<br/>
<br/>
Mind if I borrow sgeos great diagrams?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
+ - - - - - - + + - - - - - - + 
<br/>
|  B    _ / - | | - \ _    D  | 
<br/>
|   _ /       | |       \ _   | 
<br/>
|_/           | |           \_| 
<br/>
| \ _       A | |   A     _ / | 
<br/>
|     \ _     | |     _ /     | 
<br/>
|  C      \ _ | | _ /      E  | 
<br/>
+ - - - - - - + + - - - - - - +
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Basically in the regions of B, C, D, E the idea is that I do not make them transparent? Instead, fill them up with the other backgrounds?
<br/>
<br/>
I have been thinking of this method too, sgeos, but I didn't really expand on it coz I'm having some issues with it, mainly this method will not scale well for a complex scene. This will mean an explosion of combinations and it gets difficult to manage, both art-wise and program wise. 
<br/>
<br/>
For example I have a road, grass and sand.
<br/>
<br/>
if A is road, and take one 8x8 tile for example,
<br/>
I'll need to create the tiles
<br/>
A - road, B - grass, C - grass
<br/>
A - road, B - sand, C - sand
<br/>
A - grass, B - road, C - road
<br/>
A - grass, B - sand, C - sand
<br/>
A - sand, B - grass, C - grass
<br/>
A - sand, B - road, C - road
<br/>
<br/>
flip it over and create 6 more, for a total of 12 combinations.
<br/>
<br/>
In a typical game, you've got road, buildings 1-x, grass, forest, sand, river, sea, etc etc, this will be too many and too complicated to handle.
<br/>
<br/>
"Tactics Ogre has tons of space in the VRAM" - hmmm I don't understand this, do you mean that GBA hardware VRAM? coz if the scene gets complicated, such an explosion of tiles may eat up the tile space in the GBA pretty fast.
<br/>
<br/>
The issues with this method are
<br/>
<br/>
(1) Because there is an explosion in combinations of tiles in a complex scene (it doesn't scale well with scene complexity), it takes up lots of space. 
<br/>
<br/>
(2) It gets difficult to manage the combinations and alignment, program wise.
<br/>
<br/>
(3) It also gets difficult to manage such a huge number of tiles during the art creation.
<br/>
<br/>
Is there a method that will scale well with scene complexity? I am still thinking of keeping just the A area and B, C, D, E transparent, hopefully, and creating some transistion boundary areas (still with transparency).
<br/>
<br/>
PC games can get away with this simply because there is no 8x8 tile hardware specification to conform to. They could just always offset +4+8 and blit the next tile there to fill in the gap in the middle.
<br/>
<br/>
For the GBA, because there's the 8x8 tile hardware spec to conform to, it creates this problem and it's giving me headaches :)
<br/>
<br/>
thanks in advance!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22226 - sajiimori - Tue Jun 15, 2004 3:46 am</h4>
    <div class="postbody"><span class="postbody">Use sgeos's second diagram where each rectangular tile only contains a single transition.  Then, like we said, if N=number of surface types then there will be at most N^2 different kinds of transitions (which is what you would have even if you weren't using rectangular tiles), and a maximum of N^2*4 tiles total.
<br/>
<br/>
If each tile is 2 bg chars wide (16x8 pixels), then that's N^2*8 total bg chars, so 1024 bg chars is enough space for 11 surface types (11*11*8=968).  That seems like a pretty good number, and there could be more if you don't need every possible transition (which is often the case).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22227 - Marill - Tue Jun 15, 2004 3:57 am</h4>
    <div class="postbody"><span class="postbody">thanks, this means that well the RAM space is enough,
<br/>
<br/>
but the problem of complexity management because of the combinations for tracking in the game and the art creation is still there... i'll probably have to find other ways to get around that.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22229 - Miked0801 - Tue Jun 15, 2004 4:16 am</h4>
    <div class="postbody"><span class="postbody">Divide it across 2 layers.  Have one half on 1 layer and the other on the other leaving the other half transparent.  With flipping, you could reduce your char requirements down to almost nothing :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22232 - sajiimori - Tue Jun 15, 2004 6:27 am</h4>
    <div class="postbody"><span class="postbody">I would think the main benefit of using 2 layers is ease of implementation.  Unless your tiles tend to have very sharp seams, you won't save many tiles because transitions have to be drawn anyway.  Of course, the main cost is a layer.
<br/>
<br/>
Managing complexity is always tough.  Try to move as much code as possible out of the game itself, and into seperate tools.  Then you can mostly forget about efficiency and being proper, and focus on formatting your data in the most convenient way possible.
<br/>
<br/>
Creating art shouldn't be different regardless of how you divide up the tiles.  Draw in the way that's easiest and best looking, and write tools to rearrange your art to meet techincal requirements.  Then you won't lose your art if you change your requirements.
<br/>
<br/>
Use a precise naming scheme that describes each tile.  It should specify which surface is on the top, which is on the bottom, and whether the transition slopes to the left or the right (e.g. water_sand_r).  Make a 3D array, with 1 dimension for the top surface type, 1 for the bottom surface type, and 1 for the slope direction.  It holds pointers to the pixel data, so that you can put a null pointer for transitions that don't exist instead of wasting space.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">enum
<br/>
{
<br/>
    SURF_SAND,
<br/>
    SURF_WATER,
<br/>
    ...
<br/>
    NUM_SURFACES
<br/>
};
<br/>
<br/>
typedef u16 Tile[BYTES_PER_TILE];
<br/>
<br/>
const Tile* tile_matrix[NUM_SURFACES][NUM_SURFACES][2] =
<br/>
{
<br/>
    ...
<br/>
};
<br/>
<br/>
const Tile tile_graphics[] = { ... };</td> </tr></table><span class="postbody">
<br/>
So the goal of your tools is to convert from whichever way you felt like drawing your graphics, to the data that fills these arrays.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22233 - sgeos - Tue Jun 15, 2004 8:05 am</h4>
    <div class="postbody"><span class="postbody">I put <a class="postlink" href="http://granicus.if.org/~sgeos/misc_post/to/iso.html" target="_blank">a picture page</a> together.  It has some images of the tiles and maps. There is also a template for tiles that use the same geometry, and a couple of images made with the template.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sajiimori wrote:</b></span></td> </tr> <tr> <td class="quote">If each tile is 2 bg chars wide (16x8 pixels), then that's N^2*8 total bg chars, so 1024 bg chars is enough space for 11 surface types (11*11*8=968). That seems like a pretty good number, and there could be more if you don't need every possible transition (which is often the case).</td> </tr></table><span class="postbody">
<br/>
Transparent nothing transitions, plus 2 or 3 wall transitions, plus 7 or 8 floor transitions really does sound like enough for a single map to me.  That leaves 56 tiles for pure overlay decoration.  56 / 8 = 7 overlay decorations if they do not exceed the standard 32x16 bounding box.  (I could see "tall" trees being 32x32.)
<br/>
<br/>
My main objection to using two BG layers is that that is really two BG layers plus any needed for overlay, plus any needed to display other information (HUD, in game status, etc).  One can get by with two BG layers for the whole map (an under-layer and over-layer) if transitional tiles are used.
<br/>
<br/>
Tranitional tiles really want to be 32x16 pixels.  If for whatever reason is heavily invested in 16 by 8 tiles, using two BG layers for the underlayer or a bitmapped graphics mode is probably the best bet.
<br/>
<br/>
As far as shading goes, I don't think that most transitional tiles want to flipped.  That is in my personal lego world, though.  Your vision may vary.  Using two BG layers makes flipping really easy.  If one intends to do flat maps (no stacked lego block stuff), then two BG layers makes just about everything really easy.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22234 - Marill - Tue Jun 15, 2004 10:41 am</h4>
    <div class="postbody"><span class="postbody">sgeos, thanks so much it really explains it very clearly!
<br/>
<br/>
from the VRAM, it looks like the sprites have 2 frames of animations each? (i haven't played the game for sometime so I can' remember)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22238 - sgeos - Tue Jun 15, 2004 12:29 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Marill wrote:</b></span></td> </tr> <tr> <td class="quote">from the VRAM, it looks like the sprites have 2 frames of animations each? (i haven't played the game for sometime so I can' remember)</td> </tr></table><span class="postbody">
<br/>
It looks like each sprite has a walking animation up at the top.  Enough VRAM is set aside for a large creature.  There are 3 griffons that take up "double" space.  These must be overwritten every frame.  (I put 8 units on the map, and it looks like there are 8 NPCs as well- 7 enemies and one guest.)  Even if units have the same class, they get a unique spot in VRAM.  This way each unit can be facing a different direction or be on a different frame <span style="font-weight: bold">and</span> there is enough space to fit 16 unique units.
<br/>
<br/>
Next we have generic icons.  You are facing <span style="font-weight: bold">this</span> way icon, help icon, animated treasure bag, numbers for damage, etc.  It looks like special attack animations are loaded at the end of VRAM.
<br/>
<br/>
I started the stage.  Deployed units.  NPC retreated.  Moved and attacked with ninja.  Moved and attacked with archer and paused the emulator when the arrow was in the air.
<br/>
<br/>
Most of the archer's animation have overwritten the ninja's, but you can see the ninja "jumping" at the end.  At the very end of VRAM, I think we have the shriken barrage.  Not sure.  I can't find the archer's arrow.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22239 - Lord Graga - Tue Jun 15, 2004 1:04 pm</h4>
    <div class="postbody"><span class="postbody">I remember seeing a indepth look at how Final Fantasy Tactics did it over at Pixelation. Sadly it's not there any more :/</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#22309 - Marill - Thu Jun 17, 2004 11:59 am</h4>
    <div class="postbody"><span class="postbody">reading through the threads, I found another great explanation although not the pixelation.
<br/>
<br/>
<a href="http://forum.gbadev.org/viewtopic.php?t=2304" target="_blank">http://forum.gbadev.org/viewtopic.php?t=2304</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#23137 - wintermute - Mon Jul 05, 2004 11:17 am</h4>
    <div class="postbody"><span class="postbody">you might find this one useful too
<br/>
<br/>
<a href="http://sinistar.sparked.net/agb/HexTut/hexgrid.html" target="_blank">http://sinistar.sparked.net/agb/HexTut/hexgrid.html</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
