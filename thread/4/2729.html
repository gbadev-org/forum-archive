<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>grabbing 1 bit out of an 8 bit word - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > grabbing 1 bit out of an 8 bit word</h2>
<div id="posts">
<div class="post">
    <h4>#15443 - slboytoy - Thu Jan 22, 2004 8:56 pm</h4>
    <div class="postbody"><span class="postbody">How would I grab one bit at a time, out of say '0XAA'
<br/>
<br/>
For each 1, out of that, i want to display a line.
<br/>
And for each 0, I want to display a different color line.
<br/>
<br/>
I tried using the &gt;&gt; 1 to shift, but I can't seem to get the code right.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15444 - frag - Thu Jan 22, 2004 8:59 pm</h4>
    <div class="postbody"><span class="postbody">Unless I'm mistaken 0xAA is a 16 bit halfword not a byte...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15447 - DekuTree64 - Thu Jan 22, 2004 9:20 pm</h4>
    <div class="postbody"><span class="postbody">Nope, that's a byte. Each hex digit is only 4 bits (0-15).
<br/>
Anyway, calling the first bit 0, then to check if, say, bit5 is set, you would do something like 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if(val &amp; (1 &lt;&lt; 5))
<br/>
{
<br/>
   //do stuff
<br/>
}</td> </tr></table><span class="postbody">
<br/>
Or you could do (val &gt;&gt; 5) &amp; 1. For a 'set or unset' check, either way will work, because it will be either zero or not zero, and those are the only states an if recognizes. The first is a tiny bit faster though, becuase 1&lt;&lt;5 = 32, so the compiler can change that to if(val &amp; 32), which is only one instruction, instead of two.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15448 - slboytoy - Thu Jan 22, 2004 9:21 pm</h4>
    <div class="postbody"><span class="postbody">Well 0xAA   
<br/>
<br/>
isn't it 
<br/>
1010 1010?
<br/>
<br/>
So how can I grab just 1 value at a time?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15450 - johnny_north - Thu Jan 22, 2004 9:32 pm</h4>
    <div class="postbody"><span class="postbody">Assuming unsigned data
<br/>
<br/>
u8 theNumber = 0xAA;
<br/>
bool bitOn;
<br/>
<br/>
for(int i=1; i&lt;8;i++){
<br/>
bitOn = (theNumber &lt;&lt; 7) &gt;&gt; 7); //strip off the top seven bits
<br/>
if(bitON) //do what ever
<br/>
else //do whatever
<br/>
theNumber = theNumber&gt;&gt;i;//roll the bits by one bit
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15451 - sajiimori - Thu Jan 22, 2004 9:38 pm</h4>
    <div class="postbody"><span class="postbody">slboytoy, if you want to get individual bits, DekuTree64 has already shown you how to do that (johnny_north's way is overcomplicated).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15462 - YopYop - Thu Jan 22, 2004 10:35 pm</h4>
    <div class="postbody"><span class="postbody">If you want to do this for all bits:
<br/>
<br/>
here is a way to do
<br/>
<br/>
For(x=1 ;x&lt;0xFF ;x&lt;&lt;1)
<br/>
	if( va l&amp; x )
<br/>
	{
<br/>
		//here do stuff
<br/>
	}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15468 - sajiimori - Thu Jan 22, 2004 11:02 pm</h4>
    <div class="postbody"><span class="postbody">YopYop, your code has several bugs.  That isn't a problem when we're discussing conceptual issues with people who are already fluent in C, but you're likely to cause confusion when the people involved may not be experts.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15473 - Miked0801 - Thu Jan 22, 2004 11:13 pm</h4>
    <div class="postbody"><span class="postbody">#define NUM_BITS 8
<br/>
<br/>
s32 i;
<br/>
u8 data = 0xAA;
<br/>
<br/>
for(i=0; i&lt;NUM_BITS; i++)
<br/>
{
<br/>
    if(data &amp; (1 &lt;&lt; i))
<br/>
    {
<br/>
        printf("Bit Set\n");
<br/>
    }
<br/>
    else
<br/>
    {
<br/>
        printf("Bit Clear\n");
<br/>
    }
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15479 - YopYop - Thu Jan 22, 2004 11:46 pm</h4>
    <div class="postbody"><span class="postbody">excuse me I forgot the x=x&lt;&lt;1 in for loop
<br/>
<br/>
we all here to learn from each others so he will surch or ask what does all this stuff mean and he will learn.
<br/>
for my part I begin like that</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15482 - slboytoy - Fri Jan 23, 2004 1:04 am</h4>
    <div class="postbody"><span class="postbody">DekuTree64's way was what I was looking for.   
<br/>
<br/>
Thank you guys for your quick help.  This is for a college project, so all my team-mates will have the name "slboytoy".  Our levels of C will be all different.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15687 - slboytoy - Wed Jan 28, 2004 12:08 am</h4>
    <div class="postbody"><span class="postbody">OK here's another question about bit shifting....
<br/>
<br/>
Is there a way to read in a 8bit value
<br/>
<br/>
Data = LoadByte(0);
<br/>
<br/>
And then take the LSB and make into a new value?
<br/>
<br/>
DataCh1 = Data &lt;&lt; 0;
<br/>
<br/>
So then if I scroll ahead in memory (move the offset forwars), it will keep on adding new values to DataCh1, and then if I move back in memory (move the offset backwards), it will add new values on the end of DataCh1?
<br/>
<br/>
I basically want to move through memory back and forth, and the current spot in memory will be the center of my waveform.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15693 - poslundc - Wed Jan 28, 2004 12:53 am</h4>
    <div class="postbody"><span class="postbody">Are you asking if it's possible to make a series of bits that spans some arbitrary memory location that isn't byte-aligned?
<br/>
<br/>
The answer is yes, you can. You can do just about anything by masking, shifting and or-ing. Whether or not you need to, though, is another matter. You must access a minimum of a byte at a time from memory, and while you can get around this restriction using bit-arithmetic, it's likely to be an ill-conceived design if your application needs data spanning parts of two separate bytes.
<br/>
<br/>
Anyway, here's some code:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">u8      *p = (u8 *)(some-location-in-memory);
<br/>
u8      n;
<br/>
<br/>
n = *p &lt;&lt; 3;
<br/>
n |= (*(p + 1) &gt;&gt; 5);</td> </tr></table><span class="postbody">
<br/>
<br/>
Here, the value of n is the bottom 5 bits of the first byte in memory followed by the top 3 bits of the next byte in memory.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15699 - sajiimori - Wed Jan 28, 2004 2:44 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Is there a way to read in a 8bit value...And then take the LSB and make into a new value?
<br/>
</td> </tr></table><span class="postbody">
<br/>
LSB stands for Least Significant Byte, which doesn't make any sense when you're talking about a single byte value.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
DataCh1 = Data &lt;&lt; 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
"&lt;&lt; 0" doesn't do anything.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
...scroll ahead...move the offset...adding new values...waveform...
<br/>
</td> </tr></table><span class="postbody">
<br/>
These things don't mean anything to me unless you describe what you're doing in more detail, and using plain C terms if possible.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15701 - tepples - Wed Jan 28, 2004 3:25 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">it's likely to be an ill-conceived design if your application needs data spanning parts of two separate bytes.</td> </tr></table><span class="postbody">
<br/>
The obvious exception: data compression and decompression. Right?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15706 - slboytoy - Wed Jan 28, 2004 5:22 am</h4>
    <div class="postbody"><span class="postbody">Ok here is what I mean.......
<br/>
<br/>
<br/>
Memory spot 1  = 0101 0101
<br/>
Memory spot 2  = 1001 0101
<br/>
Memory spot 3  = 0101 1101
<br/>
Memory spot 4  = 1011 0101
<br/>
Memory spot 5  = 0111 0110
<br/>
Memory spot 6  = 1101 0101
<br/>
Memory spot 7  = 0101 0111
<br/>
Memory spot 8  = 1011 0101
<br/>
<br/>
So I grabbed that from memory, now I want to take each colum and put into 8 different variables.
<br/>
<br/>
So the first one would be 11110111
<br/>
So the second would be 00001010
<br/>
etc......
<br/>
<br/>
<br/>
I am making a portable logic analyzer.   So I will have 8 channels (PODS), storing a 1 or 0, in memory.     One memory location will hold all 8 spots.  Now when I want to display this waveform on the GBA..  Channel 1 will only be the LSB of each memory spot. Channel 2 will be every 2nd spot in memory, etc...
<br/>
<br/>
So I want to be able to read one memory spot and show all 8 channels on the GBA.  (one waveform each).  Now if I move ahead one memory spot, I will have the next series of 8 waveforms.  (Which I'll have 2 waveforms now on the screen for each channel)
<br/>
<br/>
I will try to explain things more clear, if you guys don't understand what I'm trying to get at here.  Thanks for understanding.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15710 - sajiimori - Wed Jan 28, 2004 10:11 am</h4>
    <div class="postbody"><span class="postbody">Ah, I see.  You're converting x number of n-bit values to n number of x-bit values.  As long as x is less than or equal to 32 (it sounds like it's 8 for you), it's easy because the resulting values can fit in single words.
<br/>
<br/>
If your source and destination addresses are arranged linearly (i.e. in arrays), it would keep things simple.  If x and n are both 8:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
// untested
<br/>
void remap_bits(u8* src, u8* dst)
<br/>
{
<br/>
  int i, b;
<br/>
<br/>
  for(i = 0; i &lt; 8; ++i)
<br/>
  {
<br/>
    dst[i] = 0;
<br/>
<br/>
    for(b = 0; b &lt; 8; ++b)
<br/>
      if(src[b] &amp; (1 &lt;&lt; i))
<br/>
        dst[i] |= 1 &lt;&lt; b;
<br/>
  }
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15712 - YopYop - Wed Jan 28, 2004 10:42 am</h4>
    <div class="postbody"><span class="postbody">sajiimori there's a bug in your code ;)
<br/>
<br/>
your code will return 11101111 but he want 11110111 for the 1st value
<br/>
<br/>
<br/>
void remap_bits(u8* src, u8* dst) 
<br/>
{ 
<br/>
  int i, b; 
<br/>
<br/>
  for(i = 0; i &lt; 8; ++i) 
<br/>
  { 
<br/>
    dst[i] = 0; 
<br/>
<br/>
    for(b = 0; b &lt; 8; ++b) 
<br/>
      if(src[b] &amp; (1 &lt;&lt; i)) //this test is not usefull you can replace this 2 lines by 
<br/>
        dst[i] |= 1 &lt;&lt; (7-b); //dest[i]|=(src[i]&amp;(b+1))&lt;&lt;(7-b)
<br/>
  } 
<br/>
}</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15713 - YopYop - Wed Jan 28, 2004 10:45 am</h4>
    <div class="postbody"><span class="postbody">I made a mistake to 
<br/>
it' s  'b' not 'i' in dest[i]|=(src[i]&amp;(b+1))&lt;&lt;(7-b) so you may write
<br/>
dest[i]|=(src[b]&amp;(b+1))&lt;&lt;(7-b) 
<br/>
<br/>
as I say in french "autant pour moi" :)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15715 - YopYop - Wed Jan 28, 2004 11:40 am</h4>
    <div class="postbody"><span class="postbody">this one may be good
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void remap_bits(u8* src, u8* dst) 
<br/>
{ 
<br/>
  int i, b; 
<br/>
<br/>
  for(i = 0; i &lt; 8; ++i) 
<br/>
  { 
<br/>
    dst[i] = 0; 
<br/>
<br/>
    for(b = 0; b &lt; 8; ++b) 
<br/>
          dest[i]|=(src[b]&amp;(1&lt;&lt;i))&lt;&lt;(7-b) 
<br/>
  } 
<br/>
} 
<br/>
</td> </tr></table><span class="postbody">
<br/>
in the last post I made mistake with 'b' and 'i' sorry</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15728 - slboytoy - Wed Jan 28, 2004 5:26 pm</h4>
    <div class="postbody"><span class="postbody">Ok I I do it this way.......  I get....
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void SortChannels()
<br/>
{
<br/>
   u8* src;
<br/>
   u8* dst;
<br/>
   int i, b;
<br/>
<br/>
   for(i=0; i &lt; 8; i++)
<br/>
   {
<br/>
      dst[i] = 11;
<br/>
<br/>
      for(b=0; b&lt;8; b++)
<br/>
         dst[i]|=(src[b]&amp;(1&lt;&lt;i))&lt;&lt;(7-b);
<br/>
   }
<br/>
<br/>
      Display(dst[0], 10, 20);
<br/>
<br/>
      Display(dst[1], 40, 50);
<br/>
<br/>
      Display(dst[2], 70, 80);
<br/>
         
<br/>
      Display(dst[3], 100, 110);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
_____________________
<br/>
<br/>
-------------|___________
<br/>
<br/>
----|___|----|________|---
<br/>
<br/>
--------------|________|---
<br/>
<br/>
<br/>
No matter what I change dst[?] to anything, even if I put in src[?] It still comes up with the same waveform.  
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
Data = 0xFF;
<br/>
Display(Data], 100, 110);
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
That works fine, and I get what I want..[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15729 - YopYop - Wed Jan 28, 2004 5:36 pm</h4>
    <div class="postbody"><span class="postbody">why did you put Dst[i]=11;
<br/>
we initialise it to zero because we do a or on it.you must not change it to have a good output in funtion of your input(src)
<br/>
<br/>
may be you want to do Src[i]=11;</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15730 - YopYop - Wed Jan 28, 2004 5:39 pm</h4>
    <div class="postbody"><span class="postbody">and you declare u8 * src, * dst
<br/>
and you don't allow memory to this var</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15732 - slboytoy - Wed Jan 28, 2004 6:02 pm</h4>
    <div class="postbody"><span class="postbody">Sorry you beat me to it before I relized I made a mistake in posting that code....
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   u8 src[8] = {0};
<br/>
   u8 dst[8] = {0};
<br/>
   int i, b;
<br/>
                
<br/>
                //Dummy Data
<br/>
   src[0] = 0xAA;
<br/>
   src[1] = 0x00;
<br/>
   src[2] = 0xFF;
<br/>
   src[3] = 0x55;
<br/>
   src[4] = 0x11;
<br/>
   src[5] = 0x88;
<br/>
   src[6] = 0x00;
<br/>
   src[7] = 0xFF;
<br/>
<br/>
   for(i=0; i &lt; 8; i++)
<br/>
   {
<br/>
      for(b=0; b&lt;8; b++)
<br/>
         dst[i]|=(src[b] &amp; (1&lt;&lt;i)) &lt;&lt; (7-b);
<br/>
   }
<br/>
<br/>
      Display(dst[0], 0, 10);
<br/>
      Display(dst[1], 15, 25);
<br/>
      Display(dst[2], 30, 40);
<br/>
      Display(dst[3], 45, 55);
<br/>
      Display(dst[4], 60, 70);
<br/>
      Display(dst[5], 75, 85);
<br/>
      Display(dst[6], 90, 100);
<br/>
      Display(dst[7], 105, 115);
<br/>
}
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Ok I'll try to explain what is going on.
<br/>
<br/>
<span style="font-weight: bold">1010101</span>0  AA
<br/>
<span style="font-weight: bold">000000</span>00  00
<br/>
<span style="font-weight: bold">11111</span>111  FF
<br/>
<span style="font-weight: bold">0101</span>0101  55
<br/>
<span style="font-weight: bold">000</span>10001  11
<br/>
<span style="font-weight: bold">10</span>001000  88
<br/>
<span style="font-weight: bold">0</span>0000000  00
<br/>
11111111  FF
<br/>
<br/>
Now the first line is displays fine.  001111001
<br/>
But the second wave form, the first value gets cut off (1). so it's 0100001 (and it adds an extra 0 at the end).
<br/>
Now the third wave form, cuts off the first two values (00), so it's 110001 (and adds an extra two 0s at the end).
<br/>
And the 4th, cuts off the first 3.. etc.....
<br/>
<br/>
So the code works fine for the first waveform.  Everything in BOLD does not show up.  It just needs some fine tuning..  Thanks for the great start though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15737 - YopYop - Wed Jan 28, 2004 8:21 pm</h4>
    <div class="postbody"><span class="postbody">tested and it work
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   for(i=0; i &lt; 8; i++) 
<br/>
   { 
<br/>
      dst[i]=0;
<br/>
      for(b=0; b&lt;8; b++) 
<br/>
     {
<br/>
         dst[i]|= ((src[b] &amp; (1&lt;&lt;i)) &gt;&gt;i)  &lt;&lt;  (7-b); 
<br/>
     }
<br/>
     printf("%d\n",dst[i]);
<br/>
   } 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
but whith all this shifting sajiimori test must be more efficient
<br/>
so you may write 
<br/>
<br/>
not tested
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
void remap_bits(u8* src, u8* dst) 
<br/>
{ 
<br/>
int i, b; 
<br/>
<br/>
for(i = 0; i &lt; 8; ++i) 
<br/>
{ 
<br/>
dst[i] = 0; 
<br/>
<br/>
for(b = 0; b &lt; 8; ++b) 
<br/>
if(src[b] &amp; (1 &lt;&lt; i))  
<br/>
dst[i] |= 1 &lt;&lt; (7-b);  
<br/>
} 
<br/>
}
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15738 - slboytoy - Wed Jan 28, 2004 8:30 pm</h4>
    <div class="postbody"><span class="postbody">Yes the non-tested worked for my Project...  Thanks again guys.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15740 - sajiimori - Wed Jan 28, 2004 8:51 pm</h4>
    <div class="postbody"><span class="postbody">YopYop, you were so anxious to find my error that you made several of your own, corrected over the course of 6(!) posts, and ending up with almost exactly what I posted, except changing b to 7-b to reverse the results.
<br/>
<br/>
If you're going to contradict somebody, make sure you're right!</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
