<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Troubleshooting GBA malloc in devkitARM R19 - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Troubleshooting GBA malloc in devkitARM R19</h2>
<div id="posts">
<div class="post">
    <h4>#93589 - wintermute - Thu Jul 20, 2006 12:22 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>entilzha wrote:</b></span></td> </tr> <tr> <td class="quote">Hmm, I read somewhere else on the forum that malloc is broken in the latest release (r19) of devkitARM.</td> </tr></table><span class="postbody">
<br/>
Did you read this in the GBA section? The GBA startup code and the Nintendo DS startup code, which set up the heap, have separate bugs.</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Would you mind telling me what these bugs are exactly?<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93637 - delfare - Thu Jul 20, 2006 9:06 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Why are you allocating memory to use as a screen?
<br/>
</td> </tr></table><span class="postbody">
<br/>
I use the 16bit mode of PAlib and I use a buffer to make a double buffering
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
What does PA_RGB do?
<br/>
</td> </tr></table><span class="postbody">
<br/>
PA_RGB create a 16bit color(like RGB15)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
What does "it bug" mean?
<br/>
</td> </tr></table><span class="postbody">
<br/>
the game stop
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
What are you doing with map1 and map2 later?
<br/>
</td> </tr></table><span class="postbody">
<br/>
I use it to make a bouble buffering and I desalloc with free when I have finished<br/>_________________<br/>If I speak badly, it's because I speak french and I am 15
<br/>
<br/>
PA 3d tutorial : <a href="http://delfare.pizz.biz" target="_blank">http://delfare.pizz.biz</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93709 - tepples - Thu Jul 20, 2006 9:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>entilzha wrote:</b></span></td> </tr> <tr> <td class="quote">Hmm, I read somewhere else on the forum that malloc is broken in the latest release (r19) of devkitARM.</td> </tr></table><span class="postbody">
<br/>
Did you read this in the GBA section? The GBA startup code and the Nintendo DS startup code, which set up the heap, have separate bugs.</span></td> </tr></table><span class="postbody">
<br/>
Would you mind telling me what these bugs are exactly?</span></td> </tr></table><span class="postbody">
<br/>
The malloc() bug. I was backing you up.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93722 - wintermute - Thu Jul 20, 2006 9:58 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">The malloc() bug. I was backing you up.</td> </tr></table><span class="postbody">
<br/>
<br/>
Hmm, you appear to be implying that the GBA startup code and the DS startup code both have their own bugs. FWIW the GBA malloc bug actually has nothing to do with the startup code, I think it may actually be a binutils bug causing the problem.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93731 - tepples - Thu Jul 20, 2006 10:43 pm</h4>
    <div class="postbody"><span class="postbody">If it is a binutils bug, then why does it affect 256 KiB EWRAM and not 4096 KiB EWRAM?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#93738 - wintermute - Thu Jul 20, 2006 11:00 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">If it is a binutils bug, then why does it affect 256 KiB EWRAM and not 4096 KiB EWRAM?</td> </tr></table><span class="postbody">
<br/>
<br/>
The DS linker scripts have been adjusted to work around the issue. There are a couple of problematic areas I missed on the GBA, mainly because I rarely, if ever use malloc on GBA.<br/>_________________<br/><a class="postlink" href="http://www.devkitpro.org/" target="_blank">devkitPro - professional toolchains at amateur prices</a>
<br/>
<a class="postlink" href="http://wiki.devkitpro.org/index.php/IRC" target="_blank">devkitPro IRC support</a>
<br/>
<a class="postlink" href="http://davejmurphy.com/" target="_blank">Personal Blog</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
