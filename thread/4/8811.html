<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Boundary problems with rotation - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Boundary problems with rotation</h2>
<div id="posts">
<div class="post">
    <h4>#74561 - CyberSlag5k - Sun Mar 05, 2006 11:41 pm</h4>
    <div class="postbody"><span class="postbody">I'm experiencing this problem with my sprites. I have one that I move around the screen, but when it hits the left boundary of the screen, it turns into a solid block of yellow (the sprite itself is predominantly yellow) and stays that way. If the sprite moves beyond the upper boundary it disappears completely, never to return.
<br/>
<br/>
Kinda weird. If I disable rotation and move it beyond the left portion of the screen, it flips upside down, which I think is normal, only it stays that way when it gets moved back out it stays flipped upside down.
<br/>
<br/>
I can post whatever code is appropriate, though I'm not really doing anything outlandish. I update my OAM entries every tick, my rotation data is pointing to my array of OAM entries, and the position is updated each tick as such:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
sprites[0].attribute0 = sprites[0].attribute0 &amp; 0xFF00;
<br/>
sprites[0].attribute0 = sprites[0].attribute0 | y;
<br/>
   
<br/>
sprites[0].attribute1 = sprites[0].attribute1 &amp; 0xFE00;
<br/>
sprites[0].attribute1 = sprites[0].attribute1 | x;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
The way I'm setting things up is also probly relavent, so here ya go:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   SetMode(MODE_1 | OBJ_ENABLE | OBJ_MAP_1D);
<br/>
<br/>
   
<br/>
   initializeSprites();
<br/>
<br/>
   for(u16 i = 0; i &lt; 256; i++)
<br/>
      OBJPaletteMem[i] = palette[i];
<br/>
   
<br/>
   sprites[0].attribute0 = COLOR_256 | SQUARE | ROTATION_FLAG | y;
<br/>
   sprites[0].attribute1 = SIZE_64 | ROTDATA(0) | x;
<br/>
   sprites[0].attribute2 = 0;
<br/>
   
<br/>
   sprites[1].attribute0 = COLOR_256 | SQUARE | 60;
<br/>
   sprites[1].attribute1 = SIZE_64 | 80 ;
<br/>
   sprites[1].attribute2 = 0;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Pretty tutorialish, eh? Anyway, if anyone has any ideas as to what's going on, it would be appreciated.
<br/>
<br/>
Thanks!<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74565 - tepples - Mon Mar 06, 2006 12:04 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>CyberSlag5k wrote:</b></span></td> </tr> <tr> <td class="quote">I'm experiencing this problem with my sprites. I have one that I move around the screen, but when it hits the left boundary of the screen, it turns into a solid block of yellow (the sprite itself is predominantly yellow) and stays that way.</td> </tr></table><span class="postbody">
<br/>
This question is answered in the <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=418" target="_blank">FAQ</a>:
<br/>
<span style="font-weight: bold">Q: Why do my sprites become corrupt when I move them off the top or the left side of the screen?</span>
<br/>
<br/>
Solution:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">sprites[0].attribute0 = sprites[0].attribute0 &amp; 0xFF00;
<br/>
sprites[0].attribute0 = sprites[0].attribute0 | (y &amp; 0x00FF);
<br/>
   
<br/>
sprites[0].attribute1 = sprites[0].attribute1 &amp; 0xFE00;
<br/>
sprites[0].attribute1 = sprites[0].attribute1 | (x &amp; 0x01FF);</td> </tr></table><span class="postbody"><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#74566 - nmain - Mon Mar 06, 2006 12:04 am</h4>
    <div class="postbody"><span class="postbody">if your x and y variables are signed, the switch to negative will be setting bits (by 2's complement representation) that you don't want set.  use a bitmask to shave off extra bits of the x and y when you set the attribute to them.
<br/>
<br/>
edit: foilt again!</span><span class="gensmall"><br/><br/>Last edited by nmain on Mon Mar 06, 2006 4:16 am; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#74567 - CyberSlag5k - Mon Mar 06, 2006 12:27 am</h4>
    <div class="postbody"><span class="postbody">Silly me. Thank you.<br/>_________________<br/><span style="font-style: italic">When you find yourself in the company of a halfling and an ill-tempered Dragon, remember, you do not have to outrun the Dragon... </span></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
