<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Removing comments and expanding macros - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Removing comments and expanding macros</h2>
<div id="posts">
<div class="post">
    <h4>#69380 - sgeos - Mon Jan 30, 2006 12:54 pm</h4>
    <div class="postbody"><span class="postbody">Does anyone know and easy way to:
<br/>
A) remove all comments from a source file
<br/>
B) expand all macros (mainly interesed in #include)
<br/>
C) toss the results into another file (easy enough)
<br/>
<br/>
NOTE:  The files will not necessarily be C source files, although the commenting system and the preprocessor will necessarily be the same.
<br/>
<br/>
I'm looking to turn this:
<br/>
<span style="font-weight: bold">[happy.c]</span></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">/*** happy.c
<br/>
 *
<br/>
 * This is a happy module.
<br/>
 * It makes your sad modules happy!
<br/>
 */
<br/>
#include "happy.h"
<br/>
<br/>
// This function is happy
<br/>
void happy(void)
<br/>
{
<br/>
   do_print
<br/>
   (
<br/>
      "happy"
<br/>
#if HAPPY_DEBUG
<br/>
      " debug /* Happy Happy */"
<br/>
#endif // HAPPY_DEBUG
<br/>
      "// Really Happy!\n"
<br/>
   );
<br/>
<br/>
   /* FIXME: Cleanup this mess.
<br/>
    */
<br/>
   // do_happy_dance(BIG_HAPPY);
<br/>
   // do_happy_dance(BIG_HAPPY | NOT_SAD);
<br/>
   do_happy_dance(HAPPY_DEBUG);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Into this:
<br/>
<span style="font-weight: bold">[happy.c.out]</span></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">(whatever happy.h brings in)
<br/>
<br/>
void happy(void)
<br/>
{
<br/>
   do_print
<br/>
   (
<br/>
      "happy"
<br/>
      "// Really Happy!\n"
<br/>
   );
<br/>
   do_happy_dance(0);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Or this:
<br/>
<span style="font-weight: bold">[happy.c.out]</span></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">(whatever happy.h brings in)
<br/>
<br/>
void happy(void)
<br/>
{
<br/>
   do_print
<br/>
   (
<br/>
      "happy"
<br/>
      " debug /* Happy Happy */"
<br/>
      "// Really Happy!\n"
<br/>
   );
<br/>
   do_happy_dance(1);
<br/>
}</td> </tr></table><span class="postbody">
<br/>
Depending on how HAPPY_DEBUG is defined.
<br/>
<br/>
Well, I'm off to the docs.  I vaguely remember reading about a gcc command line option that does all this happy magic.  =P
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69396 - tepples - Mon Jan 30, 2006 3:08 pm</h4>
    <div class="postbody"><span class="postbody"><a class="postlink" href="http://gcc.gnu.org/onlinedocs/cpp/Invocation.html#Invocation" target="_blank">Invoking the GCC C Preprocessor</a><br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69432 - Cearn - Mon Jan 30, 2006 7:30 pm</h4>
    <div class="postbody"><span class="postbody">Also, <a class="postlink" href="http://gcc.gnu.org/onlinedocs/gcc-4.0.2/gcc/Overall-Options.html#Overall-Options" target="_blank">-E</a> (scroll down a bit). You need to add the output path explicitly, though.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69544 - sgeos - Tue Jan 31, 2006 12:54 pm</h4>
    <div class="postbody"><span class="postbody">I did saw a magic command line option, I did! (sic) =)
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">gcc -E -P file.in -o file.out</td> </tr></table><span class="postbody">
<br/>
Thanks a lot!  It does everything I need it to do.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69662 - Palamon - Wed Feb 01, 2006 12:29 am</h4>
    <div class="postbody"><span class="postbody">Besides bringing all of your code together into one file,
<br/>
what advantages does this have over having your code spread out over other header files?
<br/>
<br/>
Do comments and having portions of your code in other header files increase the compiled file's size? or it's execution speed?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69672 - sgeos - Wed Feb 01, 2006 2:47 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Palamon wrote:</b></span></td> </tr> <tr> <td class="quote">Besides bringing all of your code together into one file,
<br/>
what advantages does this have over having your code spread out over other header files?</td> </tr></table><span class="postbody">
<br/>
I can scan the file to see what tokens are used in it.  If the file were C, is there an easier way to do this?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Palamon wrote:</b></span></td> </tr> <tr> <td class="quote">Do comments and having portions of your code in other header files increase the compiled file's size? or it's execution speed?</td> </tr></table><span class="postbody">
<br/>
No.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69682 - poslundc - Wed Feb 01, 2006 4:58 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Palamon wrote:</b></span></td> </tr> <tr> <td class="quote">Besides bringing all of your code together into one file,
<br/>
what advantages does this have over having your code spread out over other header files?</td> </tr></table><span class="postbody">
<br/>
<br/>
I did some assembly programming a while back that involved some ridiculous amount of macros (the assembly source file was literally 76K - or some 3000 lines of assembly code - before macro expansion), and debugging the syntax errors alone would've been near impossible if I had not been able to invoke the preprocessor independently of the assembler.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69689 - sajiimori - Wed Feb 01, 2006 6:51 am</h4>
    <div class="postbody"><span class="postbody">I've used it to find unreferenced files and remove them from the ROM.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
