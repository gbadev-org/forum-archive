<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Signed Integer - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Signed Integer</h2>
<div id="posts">
<div class="post">
    <h4>#170637 - brave_orakio - Fri Oct 09, 2009 2:25 am</h4>
    <div class="postbody"><span class="postbody">Hi guys. A question.
<br/>
<br/>
Which bit contains the information for the sign of an int? I want to use some bitwise operations to brinmg down a signed integer to 3 values. -1, 0 and 1.
<br/>
<br/>
if it was just 0 and 1 all I do is
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
intVal &amp;= 1
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So this becomes either 0 or 1 no problem. but this
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
intVal &amp;= -1
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
doesn't seem to work so I decided to try to preserve the bit containing the sign first before working on the rest of the integer.<br/>_________________<br/>help me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170638 - elhobbs - Fri Oct 09, 2009 2:58 am</h4>
    <div class="postbody"><span class="postbody">-1 is 0xFFFFFFFF. So, anything &amp; -1 will equal the original value. &amp; 0x80000000 will test for negative on a 32bit signed int.
<br/>
<br/>
edit: changed "&amp;=" to "&amp;"</span><span class="gensmall"><br/><br/>Last edited by elhobbs on Fri Oct 09, 2009 5:50 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#170640 - brave_orakio - Fri Oct 09, 2009 5:23 am</h4>
    <div class="postbody"><span class="postbody">Thanks, I'll try that out!<br/>_________________<br/>help me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170666 - keldon - Sat Oct 10, 2009 8:42 am</h4>
    <div class="postbody"><span class="postbody">If you absolutely must:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define IS_ZERO( v )      ( !(v) )
<br/>
#define IS_NEGATIVE( v )   ( u32( (v) ) &gt;&gt; 31 )
<br/>
#define IS_POSITIVE( v )   ( IS_NEGATIVE( -(v) ) &amp;&amp; !IS_ZERO( (v) ) )
<br/>
<br/>
intVal = IS_POSITIVE( intVal ) - IS_NEGATIVE( intVal );</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170668 - brave_orakio - Sat Oct 10, 2009 9:42 am</h4>
    <div class="postbody"><span class="postbody">Nice! thanks! Another question though, because I ran into something nasty with my divides:
<br/>
<br/>
why is this -1?
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
intVal = -54&gt;&gt;6;</td> </tr></table><span class="postbody">
<br/>
<br/>
shouldn`t it be equal to 0?<br/>_________________<br/>help me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170669 - Cearn - Sat Oct 10, 2009 12:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>brave_orakio wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">intVal = -54&gt;&gt;6;</td> </tr></table><span class="postbody">
<br/>
<br/>
shouldn`t it be equal to 0?
<br/>
</span></td> </tr></table><span class="postbody">
<br/>
<br/>
No. Bit-shifts are still primarily bit-shifts. That you can use them in a division-like capacity is just an accident of how numbers are represented. In negative numbers, the higher bits are all 1. When you shift-right, these shift into the lower bits. If you shift out all the 'real' bits of a number, the result is all 1s, that is, 0xFFFFFFFF == -1. Effectively, div-by-rightshift always rounds to -infinity (whereas normal integer division rounds to 0).
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">// In 16 bits
<br/>
-54 = 0xFFCA = 1111 1111 1100 1010
<br/>
<br/>
1111 1111 1100 1010 &gt;&gt; 6 = 1111 1111 1111 1111 = -1.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>keldon wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define IS_POSITIVE( v )   ( IS_NEGATIVE( -(v) ) &amp;&amp; !IS_ZERO( (v) ) ) </td> </tr></table><span class="postbody"></span></td> </tr></table><span class="postbody">
<br/>
Note that the IS_ZERO part doesn't actually do anything here and can safely be removed. For a threeway sign, this is enough:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">//! Returns -1 for x&lt;0, 0 for x==0, and +1 for x&gt;0.
<br/>
static inline int sign3(int x) 
<br/>
{    return (x&gt;&gt;31) - (-x&gt;&gt;31 );    }
<br/>
</td> </tr></table><span class="postbody"></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170670 - keldon - Sat Oct 10, 2009 12:59 pm</h4>
    <div class="postbody"><span class="postbody">--- never mind ---
<br/>
<br/>
But yes, 0 &gt;&gt; 31 == 0; duh!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170683 - brave_orakio - Mon Oct 12, 2009 3:03 am</h4>
    <div class="postbody"><span class="postbody">Ah, I see, thanks!<br/>_________________<br/>help me</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#170861 - elyk1212 - Sat Oct 24, 2009 2:10 am</h4>
    <div class="postbody"><span class="postbody">Yeah. If you're variable is a regular int, shifting is signed.  So you can right shift till the cows come home, and you'll still get a 1 in the MSB (the sign bit).
<br/>
<br/>
But....  If it is an unsigned variable, the &gt;&gt; and &lt;&lt; will translate to an unsigned shift operation, you were perhaps expecting.
<br/>
<br/>
So maybe as an exercise in fun:
<br/>
<br/>
try:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
int si = -something;
<br/>
unsigned int i = -something;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
and try printing these out after/during some shift operations and see the difference.<br/>_________________<br/>"Turn from evil and do good; seek peace and pursue it." Psalm 34:14
<br/>
<br/>
Like art? Just some wallpapers I do in my free time:
<br/>
<a href="http://www.razzlegames.com/wallpaper/" target="_blank">http://www.razzlegames.com/wallpaper/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
