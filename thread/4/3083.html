<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Ball bouncing - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Ball bouncing</h2>
<div id="posts">
<div class="post">
    <h4>#18076 - ProblemBaby - Sat Mar 20, 2004 2:46 am</h4>
    <div class="postbody"><span class="postbody">why doesn't this code work??????????????
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if (ball[0].x &lt; 10 || ball[0].x &gt; 230)
<br/>
{
<br/>
      if (ball[0].Direction &gt; 180)
<br/>
         ball[0].Direction = 540 - ball[0].Direction;         
<br/>
      else
<br/>
         ball[0].Direction = 180 - ball[0].Direction;
<br/>
}
<br/>
<br/>
if (ball[0].y &lt; 10 || ball[0].y &gt; 150)
<br/>
{
<br/>
      ball[0].Direction = 360 - ball[0].Direction;
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
its fucks up after a while its like ball[0].Direction changes its value it is a u16
<br/>
<br/>
if I set what direction should be it works
<br/>
<br/>
i tried this and its work
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
if (ball[0].x &lt; 10 || ball[0].x &gt; 230)
<br/>
{
<br/>
      if (330 &gt; 180)
<br/>
         ball[0].Direction = 540 - 330;         
<br/>
      else
<br/>
         ball[0].Direction = 180 - ball[0].Direction;
<br/>
}
<br/>
<br/>
if (ball[0].y &lt; 10 || ball[0].y &gt; 150)
<br/>
{
<br/>
      // ball[0].Direction = 360 - ball[0].Direction; doesn't work in    this case either
<br/>
                ball[0].Direction = 360 - 330; // works fine!
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
and oh the sin and cos table has 361 values sin[360] = sin[0] and same for cos</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18079 - yaustar - Sat Mar 20, 2004 3:42 am</h4>
    <div class="postbody"><span class="postbody">Do you have an error check if ball[0].Direction goes into negative figures?
<br/>
<br/>
eg what would happen if:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">ball[0].Direction = 200;
<br/>
ball[0].Direction = 180 - ball[0].Direction;</td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"><br/><br/>Last edited by yaustar on Sat Mar 20, 2004 3:49 am; edited 2 times in total</span></div>    
</div>
<div class="post">
    <h4>#18080 - Miked0801 - Sat Mar 20, 2004 3:43 am</h4>
    <div class="postbody"><span class="postbody">1. 330 &gt; 180 is always true (but you knew this as it is test case).
<br/>
2. Why use 360 degree tables?  256 is better and faster (minor)
<br/>
3. Why use directions for reflection - just negate the X/Y velocities when it hits the wall.  If you want it slightly random, add a small random number +/- to the new velocity.
<br/>
<br/>
Throw an assert on ball[0].Direction at the beginning of the function to make sure that something else in your code isn't wiping it out.  BTW, if you did the 256 thing, to reflect, you'd make direction a u8 and do your math as is.  There's no way for it to go out-of-bounds.
<br/>
<br/>
ASSERT(ball[0].direction &lt;= 360);
<br/>
<br/>
or
<br/>
<br/>
if(ball[0].direction &gt; 360)
<br/>
{
<br/>
    printf("Direction out of bounds\n");
<br/>
}
<br/>
<br/>
That you say it dies eventually makes me think it might be a memory corruption error and the printf/assert will catch that.  BTW, when it dies, is it on an X or Y reflection? That might give you insight.
<br/>
<br/>
Yaustar - the initial if in the X makes sure direction isn't negative I believe.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18083 - yaustar - Sat Mar 20, 2004 4:00 am</h4>
    <div class="postbody"><span class="postbody">hmmm... maybe I should change it :P
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">ball[0].Direction = 541;
<br/>
ball[0].Direction = 540- ball[0].Direction;</td> </tr></table><span class="postbody">
<br/>
<br/>
Mike, I have some questions as well
<br/>
1) What does ASSERT do, I havent seen it yet :/
<br/>
2) how would a LUT of sin[256] work? I currently am looking at 360 table in bemusement.. :(
<br/>
<br/>
edit: or are you refering to the values stored inside the table ?
<br/>
<br/>
edit2: I am only second guessing here so I could be very wrong. The ball is bouncing inside a box. This if statement
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (ball[0].x &lt; 10 || ball[0].x &gt; 230) </td> </tr></table><span class="postbody">
<br/>
is only equals to true if the ball hits the area of 0-10 and 230-240, is this waht you want or you want it to equal to true for 10-230? If so:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">if (ball[0].x &gt; 10 &amp;&amp; ball[0].x &lt; 230) </td> </tr></table><span class="postbody"><br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18085 - poslundc - Sat Mar 20, 2004 4:08 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>yaustar wrote:</b></span></td> </tr> <tr> <td class="quote">1) What does ASSERT do, I havent seen it yet :/</td> </tr></table><span class="postbody">
<br/>
<br/>
Have a look at <a class="postlink" href="http://forum.gbadev.org/viewtopic.php?t=2999" target="_blank">this thread</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">2) how would a LUT of sin[256] work? I currently am looking at 360 table in bemusement.. :(</td> </tr></table><span class="postbody">
<br/>
<br/>
Just use your own unit of measurement to measure the angle of a circle. Instead of 360 degrees or 2pi radians around a circle, make it 256. So half a circle is 128, a quater is 64, etc.
<br/>
<br/>
Advantages include having a table that's nice and aligned, being able to represent fractional degrees using fixed-point math very easily, and quickly finding the correct entry for any value - just mod by 256 (bitwise-AND 255).
<br/>
<br/>
For more detail, you can make your table have 512 entries instead of 256. This gives you almost 50% more resolution than a 360-degree table would.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#18098 - ProblemBaby - Sat Mar 20, 2004 12:30 pm</h4>
    <div class="postbody"><span class="postbody">yeah it was a good idea to have 256 entries instead of 360 in the sin and cos tables</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
