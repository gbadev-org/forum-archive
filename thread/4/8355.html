<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>'erasing' a sprite - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > 'erasing' a sprite</h2>
<div id="posts">
<div class="post">
    <h4>#69590 - RavenWorks - Tue Jan 31, 2006 5:54 pm</h4>
    <div class="postbody"><span class="postbody">What's the best way to remove a sprite I no longer want displayed? I'm writing a system that's going to rewrite all the sprite VRAM each frame (is this a bad idea?), and I'm just not sure what to do with all the sprite entries past the last one I need... should I fill them with zeroes, set their x to 241, set them to invisible, or something else entirely? (Does it even matter much?) I just don't want the extra unused sprites to be a problem, because I'm planning on using the hblank interrupt.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69593 - Mucca - Tue Jan 31, 2006 6:29 pm</h4>
    <div class="postbody"><span class="postbody">Disable rotation/scaling, and set double-size flag on. This is the hardware signal to disable the sprite. Processing of sprites with these attributes, while still consuming a few cycles, is cheaper than processing a sprite with an offscreen position, or one with all transparent tiles, and in the case of the later, allows you to fill your sprite VRAM and not have to retain a transparent tile.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69614 - tepples - Tue Jan 31, 2006 8:32 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>RavenWorks wrote:</b></span></td> </tr> <tr> <td class="quote">I'm writing a system that's going to rewrite all the sprite VRAM each frame (is this a bad idea?)</td> </tr></table><span class="postbody">
<br/>
As long as you use DMA or CpuFastSet() to fill sprite cel VRAM each frame, then it's not a bad idea at all. See <a class="postlink" href="http://www.pineight.com/gba/managing-sprite-vram.txt" target="_blank">my white paper on the topic</a>.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">and I'm just not sure what to do with all the sprite entries past the last one I need... should I fill them with zeroes, set their x to 241, set them to invisible, or something else entirely?</td> </tr></table><span class="postbody">
<br/>
I second what Mucca said: set them to invisible. The absolute easiest way to do this is attribute 0 = 512. Almost as good is to put them off the <span style="font-style: italic">bottom</span> of the screen (set attribute 0 to 160), which is what NES programs used.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69623 - nmain - Tue Jan 31, 2006 9:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Mucca wrote:</b></span></td> </tr> <tr> <td class="quote">Disable rotation/scaling, and set double-size flag on. This is the hardware signal to disable the sprite. Processing of sprites with these attributes, while still consuming a few cycles, is cheaper than processing a sprite with an offscreen position, or one with all transparent tiles, and in the case of the later, allows you to fill your sprite VRAM and not have to retain a transparent tile.</td> </tr></table><span class="postbody">
<br/>
<br/>
The only cost at rendering time for OAMs I know of is the per-scanline sprite limit; ~1200 sprite pixels per scanline, with affinely scaled sprites costing ~3x as much.  What costs does placing a sprite at y=160 have above disabling rotate/scale and setting double size for that sprite?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69624 - wintermute - Tue Jan 31, 2006 9:21 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"> Almost as good is to put them off the <span style="font-style: italic">bottom</span> of the screen (set attribute 0 to 160), which is what NES programs used.</td> </tr></table><span class="postbody">
<br/>
<br/>
not quite, sprites on the GBA can wrap around and reappear on the top if they're higher than 46 pixels.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69625 - tepples - Tue Jan 31, 2006 9:28 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"> Almost as good is to put them off the <span style="font-style: italic">bottom</span> of the screen (set attribute 0 to 160), which is what NES programs used.</td> </tr></table><span class="postbody">
<br/>
not quite, sprites on the GBA can wrap around and reappear on the top if they're higher than 46 pixels.</span></td> </tr></table><span class="postbody">
<br/>
How, if you're not turning double size on?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69656 - wintermute - Tue Jan 31, 2006 11:53 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>wintermute wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"> Almost as good is to put them off the <span style="font-style: italic">bottom</span> of the screen (set attribute 0 to 160), which is what NES programs used.</td> </tr></table><span class="postbody">
<br/>
not quite, sprites on the GBA can wrap around and reappear on the top if they're higher than 46 pixels.</span></td> </tr></table><span class="postbody">
<br/>
How, if you're not turning double size on?</span></td> </tr></table><span class="postbody">
<br/>
<br/>
32x64 and 64x64 sprites?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69659 - tepples - Wed Feb 01, 2006 12:09 am</h4>
    <div class="postbody"><span class="postbody">Wouldn't a 32x64 pixel sprite whose y coordinate is 160 be not-displayed on lines 160 through 223?<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69692 - HyperHacker - Wed Feb 01, 2006 8:04 am</h4>
    <div class="postbody"><span class="postbody">Just FYI, I'm pretty sure Mario Kart actually does this. When another racer comes on the screen, it adds a sprite for their image. If you now start sliding and smoke starts coming off your tires, more sprites are added for the smoke. Now if the other racer leaves the screen, their sprite is removed and the smoke sprites get bumped up to where they used to be. It seems like it would be quite difficult to do, but apparently it works!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69697 - nmain - Wed Feb 01, 2006 9:38 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>HyperHacker wrote:</b></span></td> </tr> <tr> <td class="quote">Just FYI, I'm pretty sure Mario Kart actually does this. When another racer comes on the screen, it adds a sprite for their image. If you now start sliding and smoke starts coming off your tires, more sprites are added for the smoke. Now if the other racer leaves the screen, their sprite is removed and the smoke sprites get bumped up to where they used to be. It seems like it would be quite difficult to do, but apparently it works!</td> </tr></table><span class="postbody">
<br/>
<br/>
The fzero games do a similar thing: the OAMs are changed each frame so that the ones in use are the lowest numbered ones, starting from 0 on up skipping none.  I know that if you overflow your sprite rendering cycles on a scanline, the lowest numbered sprites will be visible, and the higher numbered ones won't; so if you anticipate overflow, best to put the important sprites at the lower end; but I don't understand how using the low number OAMs helps if you're hiding sprites by putting them at y = 160..</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69698 - keldon - Wed Feb 01, 2006 9:43 am</h4>
    <div class="postbody"><span class="postbody">If you really cannot do this when they are 64px high, change its size - it's not getting displayed anyway</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#69724 - wintermute - Wed Feb 01, 2006 3:07 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">Wouldn't a 32x64 pixel sprite whose y coordinate is 160 be not-displayed on lines 160 through 223?</td> </tr></table><span class="postbody">
<br/>
<br/>
True, I have no idea what I was thinking of when I came up with the 46 pixel figure. Just ignore me :P</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
