<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>side scroller and inclines - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > side scroller and inclines</h2>
<div id="posts">
<div class="post">
    <h4>#5857 - sgeos - Sat May 10, 2003 11:25 pm</h4>
    <div class="postbody"><span class="postbody">What is generally the best way to approach climbing inclines in a platform physics simulation?  The down part is easy, as it comes as a side effect of gravity.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5861 - tepples - Sun May 11, 2003 1:04 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote">What is generally the best way to approach climbing inclines in a platform physics simulation?  The down part is easy, as it comes as a side effect of gravity.</td> </tr></table><span class="postbody">
<br/>
Are you talking about a rolling object or a legged object?  For rolling objects, you'll have to split gravity into components perpendicular to and parallel to the surface.  The equation for this involves the slope.  Walking objects tend to act much more nonlinearly, and you may have to hardcode movement characteristics for each slope you're planning on using.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5864 - sgeos - Sun May 11, 2003 4:43 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Are you talking about a rolling object or a legged object?
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Thats a good question.  I had not thought about that.  I'll just "roll" everything, even legged objects for now.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
For rolling objects, you'll have to split gravity into components perpendicular to and parallel to the surface.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Assuming that the slope is defined (our equation is not x = n), and gravity is apllied along the y-axis (probably down), does not gravity only have a component perpendicular to the surface?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
The equation for this involves the slope.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
How would you store the slope?  Should each tile have a slope, or should an algorithm that 'reads the terrain' (by looking at the direction of movement and non-zero pixels) be written?  I'd want to read the terrain to cope with curves.  (Imagine terrain that looks like a sine wave, a few tiles high with a period four to eight tiles.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Walking objects tend to act much more nonlinearly,
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
I imagine that this becomes more difficult to detect the further away they are viewed from.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
and you may have to hardcode movement characteristics for each slope you're planning on using.</td> </tr></table><span class="postbody">
<br/>
<br/>
I'll think about this.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5868 - tepples - Sun May 11, 2003 8:15 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>sgeos wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
For rolling objects, you'll have to split gravity into components perpendicular to and parallel to the surface.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Assuming that the slope is defined (our equation is not x = n), and gravity is apllied along the y-axis (probably down), does not gravity only have a component perpendicular to the surface?</span></td> </tr></table><span class="postbody">
<br/>
Look at this ascii diagram:</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">          |
<br/>
          |
<br/>
          |
<br/>
          | g
<br/>
          |
<br/>
          |         _,-'
<br/>
          |     _,-'
<br/>
          v _,-'
<br/>
        _,-'
<br/>
    _,-'
<br/>
_,-'</td> </tr></table><span class="postbody">
<br/>
This represents gravity (vector 'g') and a surface with slope of +1/2. (ASCII art cells are typically twice as high as wide.)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">     a
<br/>
      _,-':
<br/>
    &lt;'    :
<br/>
     \    :
<br/>
      \   :
<br/>
     b \  :
<br/>
        \ :         _,-'
<br/>
         \:     _,-'
<br/>
          v _,-'
<br/>
        _,-'
<br/>
    _,-'
<br/>
_,-'</td> </tr></table><span class="postbody">
<br/>
This represents the same gravity and the same surface, but the gravity vector has been decomposed into vectors 'a' parallel to the surface and 'b' normal to the surface.  The acceleration of the ball is 'a' times a constant slightly less than 1 that accounts for rotational inertia.  (A full Newtonian analysis, including angular momentum, is beyond the scope of my physics abilities at 2 AM.)  Friction is proportional to 'b' and depends on the characteristics of the surfaces.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">How would you store the slope?  Should each tile have a slope</td> </tr></table><span class="postbody">
<br/>
Each tile number should have an associated slope.  For example, if tile 34 is a piece with slope +1/2, then store 0x80 (fixed point for 128/256) in slope_table[34].
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">I'd want to read the terrain to cope with curves.  (Imagine terrain that looks like a sine wave, a few tiles high with a period four to eight tiles.)</td> </tr></table><span class="postbody">
<br/>
For a Sonic clone, an approximation of slope every 8 pixels isn't going to hurt anybody, especially because grassy terrain is slightly irregular anyway.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5926 - sgeos - Tue May 13, 2003 5:44 am</h4>
    <div class="postbody"><span class="postbody">That is some awesome ascii art.  I've worked something out, I'll use my inferior skills to attempt to explain it:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
         x
<br/>
          _,-':
<br/>
        &lt;&gt;R  B:
<br/>
         \    : G
<br/>
          \   : |
<br/>
         y \  : |
<br/>
            \A: |
<br/>
             \: V
<br/>
            R&lt;:
<br/>
         _,-'B:
<br/>
     _,-'    _:
<br/>
 _,-'A      R| :
<br/>
^^^^^^^^^^^^^^
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
G is the gravity vector.
<br/>
x is the component of gravity parallel to the surface.
<br/>
y is the component of gravity normal to the surface.
<br/>
A is the angle of incline.
<br/>
B is the other angle in the triangle.
<br/>
R is a right angle.
<br/>
<br/>
x = G * sin(A)
<br/>
y = G * cos(A)
<br/>
<br/>
Now... the bios only seems to have an atan routine.  Does that mean that the only options are linking with the math library or a look up table?  (What is atan good for?)
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
[SNIP diagram, see post above]
<br/>
<br/>
This represents the same gravity and the same surface, but the gravity vector has been decomposed into vectors 'a' parallel to the surface and 'b' normal to the surface.  The acceleration of the ball is 'a' times a constant slightly less than 1 that accounts for rotational inertia.  (A full Newtonian analysis, including angular momentum, is beyond the scope of my physics abilities at 2 AM.)
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Is "less than 1 that accounts for rotational inertia" close enough to 1 to just use 1?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Friction is proportional to 'b' and depends on the characteristics of the surfaces.
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Either stored with the tile, or in a 'surface map'?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
Each tile number should have an associated slope.  For example, if tile 34 is a piece with slope +1/2, then store 0x80 (fixed point for 128/256) in slope_table[34].
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Why not use the angle instead of the slope?
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
For a Sonic clone, an approximation of slope every 8 pixels isn't going to hurt anybody, especially because grassy terrain is slightly irregular anyway.</td> </tr></table><span class="postbody">
<br/>
<br/>
Excellent.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5927 - sgeos - Tue May 13, 2003 7:22 am</h4>
    <div class="postbody"><span class="postbody">Actually, I meant to ask: should not the net velocity for our critter be split into components relative to the surface?  If so, than the above G vector should work for any vector parallel to the y-axis.  Here is what I worked out for a vector parallel the x-axis:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
   V-----&gt;
<br/>
          _,\ y
<br/>
    x _,-'R\/\
<br/>
  _,-'A      B\
<br/>
 ^^^^^^^^^^^^^^:
<br/>
        A_,-'B:
<br/>
     _,-'    _:
<br/>
 _,-'A      R| :
<br/>
^^^^^^^^^^^^^^
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
V is a vector parallel to the x-axis.
<br/>
x is the component of the vector parallel to the surface.
<br/>
y is the component of the vector normal to the surface.
<br/>
A is the angle of incline.
<br/>
B is the other angle in the triangle.
<br/>
R is a right angle.
<br/>
<br/>
x = V * cos(A)
<br/>
y = V * sin(A)
<br/>
<br/>
A + B = 90 degrees, so that funny A in the middle plus B (by y) indicates that y is normal to the surface.
<br/>
<br/>
The net velocity should be split into x and y compontent (relative to the axis) to begin with, so I don't think anything other than a lookup table is needed to split the vector relative to the surface.
<br/>
<br/>
Just in case anyone with weak trig is reading this, here are a few notes about the diagrams:
<br/>
<br/>
V cos(A) = V sin(B)
<br/>
V sin(A) = V cos(B)
<br/>
A = 90 - B
<br/>
B = 90 - A
<br/>
<br/>
If V is replaced with G, these notes hold for the diagram in my previous post.
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#5928 - Quirky - Tue May 13, 2003 7:41 am</h4>
    <div class="postbody"><span class="postbody">You can use look up tables for sin and cos. Use fixed point maths - there's source for doing it on thepernproject, though you can improve it to use tables smaller tables (since you only need 90 degrees rather than a full 360, then it +-repeats).
<br/>
<br/>
atan is used to find an angle when you know the sides:
<br/>
<br/>
tan(A) = opposite/adjacent
<br/>
A = atan(opposite/adjacent)
<br/>
<br/>
where the sides are as in this copy-pasted ascii art diagram:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
        _,--:
<br/>
    _,-'   _: opposite
<br/>
_,-'A     | : 
<br/>
^^^^^^^^^^^^^
<br/>
adjacent
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
So it might be useful if, for example, you had a baddy "aim" at something and it knows the x and y distance on screen away of its target, you can get it to rotate to the correct angle to fire.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
