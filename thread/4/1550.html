<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Fast Polygon drawing - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Fast Polygon drawing</h2>
<div id="posts">
<div class="post">
    <h4>#7910 - Lupin - Sat Jun 28, 2003 10:26 am</h4>
    <div class="postbody"><span class="postbody">How is it done? What's the fastest methode? Maybe there's an bresenham implementation for this?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7911 - Torlus - Sat Jun 28, 2003 10:39 am</h4>
    <div class="postbody"><span class="postbody">Do you mean filled polygons, or only edges drawing ?
<br/>
<br/>
If you're looking for an efficient flat-filled traingle drawer have a look at Dobby's one on his site : <a class="postlink" href="http://www.bits.bris.ac.uk/dooby/gba/" target="_blank">http://www.bits.bris.ac.uk/dooby/gba/</a>.
<br/>
His "gbalib" features such a drawer written in ARM assembly with nice optimisations.<br/>_________________<br/>GBA,GC,NGPC,GP32,FPGA,DS stuff at <a class="postlink" href="http://torlus.com/" target="_blank">http://torlus.com/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7926 - Lupin - Sat Jun 28, 2003 7:21 pm</h4>
    <div class="postbody"><span class="postbody">thx, I'm going to take a look</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7955 - Lupin - Sun Jun 29, 2003 12:50 pm</h4>
    <div class="postbody"><span class="postbody">Do you perhaps know some C++ code to draw triangles? I don't understand the asm code in this lib and it seems very complex.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7966 - DekuTree64 - Sun Jun 29, 2003 4:31 pm</h4>
    <div class="postbody"><span class="postbody">Well, the C tri-filler I made recently is on my other computer, but the basic algorithm is to sort the vertices according to y value (closest to top of screen, middle, closest to bottom) calculate the slope of each edge (x/y, since we're going one full y pixel at a time, unlike normal math, where the slope is the change in y per x unit (y/x)), then you add 1 to y, increment your starting/ending x values (basically draw 2 bresenham-lines, one on each side), and either fill from xStart to xEnd with your color, or save your xStart/xEnd pairs in a buffer (2 8-bit vals per y-line would work, since the screen is less than 255 px wide) to fill between later. Keep doing that until y is equal to the y of the middle vertex, recalculate the slope of the line from v2 to v3 (the slope of the long edge will be the same as before, so don't bother with it), and repeat until y == v3.y.
<br/>
Here, I'll try to draw a picture...
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
               /\ &lt;-top vertex
<br/>
              /   \
<br/>
middle-&gt; \     \
<br/>
                 \    \  &lt;-this line's slope is the same for the top/bottom halves
<br/>
you have to   \   \
<br/>
 recalc this one \  \
<br/>
 when you hit      \ \
<br/>
 middle                  \&lt;-bottom 
<br/>
</td> </tr></table><span class="postbody">
<br/>
And be sure to sheck if the long edge is on the left or right, when setting your xStart/xEnd/slopeStart/slopeEnd.
<br/>
<a href="http://freespace.virgin.net/hugo.elias/graphics/x_main.htm" target="_blank">http://freespace.virgin.net/hugo.elias/graphics/x_main.htm</a> has some grat tutorials on all sorts of graphics stuff, including polygons. He uses the edge buffer style, where you save the xs/xe pairs to draw later.
<br/>
I use the draw-while-you-trace style, cause I think it's a little faster, and it works well with a C-buffer (where you keep track of xs/xe pairs that have already been drawn between, so you kind of draw 'underneath' everything on the screen). Edge buffer style's equivalent to that is an S-buffer, than does basically the same thing, but keeping track of spans to draw later. Don't worry about those until later though, just getting a simple tri-filler working is hard enough.
<br/>
But as soon as you do, and start getting little cracks between your polys, read the thing about a 'perfect' scan converter at that site, and you'll be enlightened^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#7968 - funkeejeffou - Sun Jun 29, 2003 5:05 pm</h4>
    <div class="postbody"><span class="postbody">You must also considerate some other cases :
<br/>
- if two vertex have the min y value
<br/>
- if two vertex have the max y value
<br/>
check in those cases if the x coordinate of the two concerned vertex are equal, if so then don't draw it cause it is degenerate.
<br/>
In the case where the 3 y are different, check if the middle point lies on the long segment defined by the max and min point. If so do not draw it cause it's degenrate.
<br/>
Otherwise, as Dekuthree said, check the location of the long segment (left or right of the screen) and interpolate.
<br/>
<br/>
There are many optimisations concerning the poly fillers (depending mostly how you wanna fill your poly : flat, gouraud or texture), check the articles on <a href="http://www.gamedev.net," target="_blank">www.gamedev.net,</a> some are really good.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
