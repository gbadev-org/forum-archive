<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Specify a BG to use a 16 color palette - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Specify a BG to use a 16 color palette</h2>
<div id="posts">
<div class="post">
    <h4>#10388 - RaBBi - Wed Sep 03, 2003 10:03 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
Just a little question:
<br/>
<br/>
Is it possible (and how to) to specify a BG to use a 16 colors palette ?
<br/>
<br/>
I explain what I'm trying to do.
<br/>
<br/>
I load a 256 colors maps, really use ~67 colors, on BG3.
<br/>
The colors are loaded from index0 of the palette.
<br/>
<br/>
Then I load a 16 colors tileset on BG0.
<br/>
So before I loaded a 16 colors palette in the bank 15.
<br/>
<br/>
And I wanted to specify BG0 to use this last palette.
<br/>
<br/>
As I'm using HaM, I ask the same question on ngine.de forum.
<br/>
<br/>
Thank you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10393 - sajiimori - Thu Sep 04, 2003 1:59 am</h4>
    <div class="postbody"><span class="postbody">Sure, you can do that.  First, clear bit 7 of REG_BG0CNT for 16 color.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
REG_BG0CNT &amp;= ~(1&lt;&lt;7);
<br/>
</td> </tr></table><span class="postbody">
<br/>
You don't choose a palette for a whole background, though.  You can choose a different palette for each tile using bits 12-15.
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
u16* tile = ...;
<br/>
*tile |= palette_number &lt;&lt; 12;
<br/>
</td> </tr></table><span class="postbody">
<br/>
Check the CowBite spec for details.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10405 - RaBBi - Thu Sep 04, 2003 7:58 am</h4>
    <div class="postbody"><span class="postbody">Thank you Sajimori for answer ^^
<br/>
<br/>
But I knew it, how to attribute a palette to a tile.
<br/>
<br/>
In fact I identified what's the matter dealing with 256 and 16 in may case.
<br/>
<br/>
The 67 colors are loaded from start of palette.
<br/>
They are used by tileset/map on BG3.
<br/>
Then I load the 16 colors palette in bank 15 and attribute the BG0 in 16 colors mode.
<br/>
<br/>
And when I fill it with tile 0, this tile uses the 4th color of the entire palette.
<br/>
I attached the 16 colors tileset to the BG0 so it may use not a color from the entire palette....
<br/>
<br/>
Umm I got an idea !
<br/>
In the 16 color tileset, it may be indicated that the tile 0 use the 4th color of its own palette !
<br/>
And so when I load it in GBA, it's unable to make the difference between it's own palette and the entire palette that is loaded in GBA memory !
<br/>
<br/>
Do you think I'm right thinking like that ?
<br/>
<br/>
In that case, how can I deal with BG transparencies in 256/16 colors mix ?? :/<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10427 - antysix - Thu Sep 04, 2003 4:00 pm</h4>
    <div class="postbody"><span class="postbody">No, I don't think you understand fully. You can't have a mix of a 256 color palette and 16 color at the same time, like you call it.
<br/>
If you specify in REG_BGxCNT that you use 16 16 color palettes then it's only that, and not 256 color.
<br/>
And how to do that sajimori said already: set which palette you use in the map entry. Just mind that your tiles use with 16 16 color palettes only 4bit per pixel, instaed of 8 bit.<br/>_________________<br/>Currently playing: NGC: Metroid Prime
<br/>
GBA: Golden Sun: The Lost Age
<br/>
<br/>
Currently developping: Project ~ [ Phail ]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10428 - niltsair - Thu Sep 04, 2003 4:47 pm</h4>
    <div class="postbody"><span class="postbody">He can mix 256 and 16colors. Not within the same background but amongs different background. Thus he could ...
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">0----------------------------208---------224---------240--------256
<br/>
|  Palette0                   | Palette1  | Palette2  | Palette3 |
<br/>
|  256colors(only access 208) | 16colors  | 16colors  | 16colors |
<br/>
 -----------------------------------------------------------------</td> </tr></table><span class="postbody">
<br/>
-BG0 set to 256 colors, using Palette 0.
<br/>
-Bg1,2,3 set to use 16colors palettes. Each tile being able to use Palette 1,2,3. They could also access group of 16colors in Palette 0, but without being able to change colors in it without screwing palette 0.
<br/>
<br/>
He basicly need to...
<br/>
-Set some background to use a 256colors palette, while only acessing the <span style="font-weight: bold">x first</span> colors. 
<br/>
-He then has <span style="font-weight: bold">256-x</span> colors available to use for 16colors palettes has he wishes.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10432 - Nessie - Thu Sep 04, 2003 5:42 pm</h4>
    <div class="postbody"><span class="postbody">With some careful arrangement of your BG palette and BG artwork it would be quite possible to use  16  16-colour palettes on one layer and use that *exact* same palette for a 256 colour BG layer.
<br/>
<br/>
As niltsair suggests, the BG system just interprets the BG palette data differently in 16 colour mode vs. 256 colour mode...colour 0 is transparent in 256 colour mode.  Whereas, colours 0,16,32,etc are transparent in 16 colour mode.   
<br/>
<br/>
So, depending on what you are doing, niltsair's suggestion is probably the easiest, but if you needed lots of 16 colour palettes and maybe could get an acceptable 256 colour set of tiles (if needed) out of the combined colours in those 16 palettes, that is also a possibility.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10436 - RaBBi - Thu Sep 04, 2003 8:09 pm</h4>
    <div class="postbody"><span class="postbody">A big very thank to you, all guys, to try to find a way to realise that (while I've spend my time with a girl lol).
<br/>
<br/>
I will try those different ways, I think I had to learn a few more about REGs.
<br/>
<br/>
But when I'll be ok with that, I'll post here the way I finally use.
<br/>
<br/>
Very thank, I notice that once more cause the Ham community is not as cool and free and helpfull as you are ^^
<br/>
<br/>
In fact I think I'll use Ham functions/commands for very such easy things, but for tricks like this, I may have to use pure coding:)<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10458 - RaBBi - Fri Sep 05, 2003 4:38 pm</h4>
    <div class="postbody"><span class="postbody">Hi!
<br/>
<br/>
As I promised in my precedent post, I tell you how I resolved my problem of mixing 256/16 colors tilesets/maps ^^
<br/>
<br/>
In fact, I didn't use coding tricks but simply a switch in gfx2gba.
<br/>
This switch is -b that can specify what bank of the palette the tileset may use.
<br/>
<br/>
In my case, I would use BG0 as a "text display background" for my RPG.
<br/>
All the dialogs will be drawn on it.
<br/>
So I can specifiy that my fonts and dialog box tileset uses the bank 15 for example, if I'm sure that I don't use this bank for another.
<br/>
In fact, I decided to reserve this last bank for it ^^
<br/>
<br/>
And HaM, the dev kit I use, don't make problem with it.
<br/>
<br/>
Hope that my switch trick, for the first time, can help some of you ^^<br/>_________________<br/>Sorry for my poor english, but it would be worst for you to understand me if I speak in my native language, French ^^</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
