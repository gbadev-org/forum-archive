<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Getting a Seed? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > Getting a Seed?</h2>
<div id="posts">
<div class="post">
    <h4>#6334 - MojoJojo - Fri May 23, 2003 12:44 pm</h4>
    <div class="postbody"><span class="postbody">Just strated playing with GBADev and emulators, (I'll get the hardware when I next get paid ;), and I was wondering how to seed a random number generator. Normally, you'd use the time, but there doesn't seem to be one lying around on the GBA. If you're doing an interactive program, you could use the time to the first keypress, but I'm just doing graphics testing stuff at the moment, and was wondering if there was any thing you can use as a starting seed?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6339 - phr0zn - Fri May 23, 2003 2:23 pm</h4>
    <div class="postbody"><span class="postbody">Alright.  this has been discussed a thousand times before so poke around.  but here is an example of how I do it:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define VCOUNT *(volatile u16*)0x4000006
<br/>
<br/>
//random max
<br/>
#define RAND_MAX 32767
<br/>
volatile s32 RAND_RandomData;
<br/>
<br/>
void SeedRandom(void);
<br/>
s32 RAND(s32 Value);
<br/>
<br/>
int main()
<br/>
{
<br/>
         u16 random_num; 
<br/>
         SeedRandom();
<br/>
         random_num = RAND(4);
<br/>
}
<br/>
<br/>
<br/>
void SeedRandom(void)
<br/>
{
<br/>
   RAND_RandomData = VCOUNT;
<br/>
}
<br/>
<br/>
s32 RAND(s32 Value)
<br/>
{
<br/>
   RAND_RandomData *= 20077;
<br/>
   RAND_RandomData += 12345;
<br/>
<br/>
   return ((((RAND_RandomData &gt;&gt; 16) &amp; RAND_MAX) * Value) &gt;&gt; 15);
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Thats pretty much that.  I believe it was used in a TRON demo coded a while ago by somebody.  I think thats where I got it.  It works fairly well...<br/>_________________<br/><a href="http://cerberus.promodtecnologies.com" target="_blank">http://cerberus.promodtecnologies.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6342 - niltsair - Fri May 23, 2003 3:09 pm</h4>
    <div class="postbody"><span class="postbody">And a way to greatly improve the above, is to wait a keypress before seeding your number. Like after a start screen.
<br/>
<br/>
Another smart way i've seen on this forum, if you can't do the above for some reason, you seed the number after certain events in the game, and store it in the gamepak ram. Thus, when you restart your game, you just go fetch that number to reseed.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6348 - MojoJojo - Fri May 23, 2003 5:21 pm</h4>
    <div class="postbody"><span class="postbody">Ah, sorry, this has been discussed before, thanks for your reply.
<br/>
0x4000006  is the vertical sync isn't it? Using the gamepaq is a good idea too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6377 - Jason Wilkins - Fri May 23, 2003 9:43 pm</h4>
    <div class="postbody"><span class="postbody">It seems to me that seeding at the same point at the beginning of the program would always give you the same number.  User input really seems like the best way to seed a random number generator.  Anything else seems too deterministic.
<br/>
<br/>
Too bad there isn't a bit of radioactive element and a geiger counter in the GBA, that would be truely random ^_^<br/>_________________<br/><a href="http://devkitadv.sourceforge.net" target="_blank">http://devkitadv.sourceforge.net</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6378 - niltsair - Fri May 23, 2003 9:48 pm</h4>
    <div class="postbody"><span class="postbody">True, there need to be some User input. Hence the start screen. The second method also worked because it's base on the fact that in order to be at a certain point, the user had to have pressed keys, just remove the obligation of having a start screen. But will also mean the 1st game will always be the same, unless you insert yourself the random seed on the rom before flashing it.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6384 - sgeos - Fri May 23, 2003 10:20 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>niltsair wrote:</b></span></td> </tr> <tr> <td class="quote">But will also mean the 1st game will always be the same, unless you insert yourself the random seed on the rom before flashing it.</td> </tr></table><span class="postbody">
<br/>
<br/>
Thats not a very random seed, now is it?  After it's flashed, the first screen will always be the same.  I'll admit that I usually just seed the RNG with something because I'm too lazy to set up the timers.  Often I use:
<br/>
<br/>
seed = 0xFDB97531;
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#6386 - niltsair - Fri May 23, 2003 10:33 pm</h4>
    <div class="postbody"><span class="postbody">True, but i was thinking about it in a consumer way, where the gamer will always play with the same cart.
<br/>
<br/>
I usually go for the : Let's wait untill the player pressed start with an Intro Screen method, using a timer value too.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19034 - rlaxogns - Sat Apr 10, 2004 2:15 pm</h4>
    <div class="postbody"><span class="postbody">Hello all...I'm a newbie in GBA programming....
<br/>
I need a true random number generator...The code provided only 
<br/>
generates the same numbers all the time....
<br/>
<br/>
Can someone post example code for real random number generator, please?
<br/>
I would really appreciate it ... Thank you....
<br/>
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>phr0zn wrote:</b></span></td> </tr> <tr> <td class="quote">Alright.  this has been discussed a thousand times before so poke around.  but here is an example of how I do it:
<br/>
<br/>
<table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
#define VCOUNT *(volatile u16*)0x4000006
<br/>
<br/>
//random max
<br/>
#define RAND_MAX 32767
<br/>
volatile s32 RAND_RandomData;
<br/>
<br/>
void SeedRandom(void);
<br/>
s32 RAND(s32 Value);
<br/>
<br/>
int main()
<br/>
{
<br/>
         u16 random_num; 
<br/>
         SeedRandom();
<br/>
         random_num = RAND(4);
<br/>
}
<br/>
<br/>
<br/>
void SeedRandom(void)
<br/>
{
<br/>
   RAND_RandomData = VCOUNT;
<br/>
}
<br/>
<br/>
s32 RAND(s32 Value)
<br/>
{
<br/>
   RAND_RandomData *= 20077;
<br/>
   RAND_RandomData += 12345;
<br/>
<br/>
   return ((((RAND_RandomData &gt;&gt; 16) &amp; RAND_MAX) * Value) &gt;&gt; 15);
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
Thats pretty much that.  I believe it was used in a TRON demo coded a while ago by somebody.  I think thats where I got it.  It works fairly well...</span></td> </tr></table><span class="postbody"><br/>_________________<br/>-THK-</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19037 - Lupin - Sat Apr 10, 2004 3:19 pm</h4>
    <div class="postbody"><span class="postbody">When you show the start screen, use a timer to find out a random time value when the user hits a button. That will definately give you a "true" random value.<br/>_________________<br/><a class="postlink" href="http://pokeme.shizzle.it/" target="_blank">Team Pokeme</a>
<br/>
<a class="postlink" href="http://lupin.shizzle.it/" target="_blank">My blog and PM ASM tutorials</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19038 - yaustar - Sat Apr 10, 2004 3:20 pm</h4>
    <div class="postbody"><span class="postbody">technically, there is no 'true' random generator in any program.. you can make it seem more random and varied at best.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19056 - sgeos - Sat Apr 10, 2004 8:36 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Jason Wilkins wrote:</b></span></td> </tr> <tr> <td class="quote">It seems to me that seeding at the same point at the beginning of the program would always give you the same number.  User input really seems like the best way to seed a random number generator.  Anything else seems too deterministic.</td> </tr></table><span class="postbody">
<br/>
<br/>
The board game 1830 has no random component.  Every game turns out very different, and things are very hard if not impossible to predict.
<br/>
<br/>
If you seed your rng with 0x13579BDF at the start of every new game, and use the SRAM method mentioned above, I suspect that the game would turn out to be very hard if not impossible to predict. =)
<br/>
<br/>
You could also use code like this:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">seed = fetch_seed_from_sram();
<br/>
if (seed == 0)
<br/>
  seed = 0x13579BDF;
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
