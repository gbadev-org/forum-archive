<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Self Moving Sprites - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > Self Moving Sprites</h2>
<div id="posts">
<div class="post">
    <h4>#8560 - Snoobab - Mon Jul 14, 2003 6:55 pm</h4>
    <div class="postbody"><span class="postbody">Hi Guys.
<br/>
<br/>
I have a question I hope one of u will be able to answer.
<br/>
<br/>
I want to make a space blaster (space invaders?) type game but I'm having a little trouble. I want my spaceship to fire - sprites - when I press the A button, I want those sprites to move at a constant (seeable) speed across the screen towards my enemys. The problem is that I can't get the bullet sprite to move on its own once the A button has been pressed. Here's my move sprite function:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
<br/>
__inline void LaunchBullet(void)
<br/>
{
<br/>
   if(BulletPos.y &gt; 0)
<br/>
   {
<br/>
         BulletPos.y --;
<br/>
   }
<br/>
}
<br/>
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
Bullet is an instance of a 2D Vector struct(Just contains x and y co-ords).
<br/>
<br/>
This function moves the bullet only when the A button is held down(i.e. the bullet doesn't keep on moving by itself.) I've tried various loops to try and make the bullet move on its own but none have seemed to work correctly('cause I've been doing something wrong!) Any ideas on how I could get this to work correctly?
<br/>
<br/>
Also, how would I implement collision detection is such a game? (Sry, this is my first GBA game attempt =) Would bounding rectangles or per-pixel be best?
<br/>
<br/>
Thanks a lot,
<br/>
<br/>
- Ed.[/code]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8563 - niltsair - Mon Jul 14, 2003 7:07 pm</h4>
    <div class="postbody"><span class="postbody">You have to use a timer. When a bullet is shot, reset the timer and start it. every few milliseconds (you have to check the time elapsed in your main game loop) check if you should move the bullet (based on the amount of time to wait in between each move).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8570 - col - Tue Jul 15, 2003 12:27 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>niltsair wrote:</b></span></td> </tr> <tr> <td class="quote">You have to use a timer. When a bullet is shot, reset the timer and start it. every few milliseconds (you have to check the time elapsed in your main game loop) check if you should move the bullet (based on the amount of time to wait in between each move).</td> </tr></table><span class="postbody">
<br/>
<br/>
You certainly do not 'have' to use a timer, there are numerous ways of solving this basic problem.
<br/>
<br/>
A common way to deal with movement in games is to lock everything to the vblank interrupt.
<br/>
every frame, all the entities in the game are updated including the bullets.  If you use fixed point arithmetic for the coordinates, you can have your objects move a pretty much whatever speed you like... no need for a timer.
<br/>
<br/>
The only problem is how to manage the active entities (bullets, baddies etc)
<br/>
<br/>
one simple way is to have a fixed number of each type of game entity pre-assigned and check them all every frame - if they're 'on' you update position, test for collisions etc. this works well for simple games 
<br/>
<br/>
a more powerfull though more complex way is to use some sort of container - eg. a linked list.  Every time an entity is created, add it to the list, when it is destroyed, remove it from the list.  Each frame, iterate through the list of entities calling the update function for each one.
<br/>
<br/>
<br/>
cheers
<br/>
<br/>
Col</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8583 - ampz - Tue Jul 15, 2003 4:12 pm</h4>
    <div class="postbody"><span class="postbody">Actually, the vblank <span style="font-style: italic">is</span> a timer.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8671 - NitroSR - Thu Jul 17, 2003 6:50 pm</h4>
    <div class="postbody"><span class="postbody">Two words... PHYSICS SIMULATION
<br/>
<br/>
One of the things I love about Super Mario Brothers is that it's a essentially a cutesy physics simulations.  All of the entities have positions, velocities, and respond to forces and impulses.  Crack open a physics book and learn yourself some  Newton.  You'll find that you can make highly robust games by designing an engine that is based on physics simulation.  
<br/>
<br/>
Of course, for a space shooter, you may need to depart a bit from pure unadulterated physics, seeing that many enemy ships follow patterns and the like, but that shouldn't be a problem now should it? ;)
<br/>
<br/>
Good luck!!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8699 - kiwibonga - Fri Jul 18, 2003 8:25 am</h4>
    <div class="postbody"><span class="postbody">I think it's a very simple mistake, although I could in turn be mistaken, as a long-time GBA programming newbie, I've experienced the same problems... You probably created the bullet OBJ at (Bulletpos.x,Bulletpos.y) and updated the OAM. The thing is, Bulletpos.x and Bulletpos.y are just numbers, meaning that whenever they change, you should update the OAM entry for the OBJ with their new value by actively changing its coordinates. In HAM you'd just write ham_SetObjXY(Bulletsprite,x,y) followed by ham_CopyObjToOAM()...
<br/>
<br/>
THEN AGAIN
<br/>
<br/>
If your ship is moving, therefore you probably know about this already, and I've made a fool out of myself ;)<br/>_________________<br/><a href="http://www.kiwibonga.com" target="_blank">http://www.kiwibonga.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8745 - XeroxBoy - Sat Jul 19, 2003 1:29 am</h4>
    <div class="postbody"><span class="postbody">My thoughts are that he's only calling LaunchBullet() when you press A, not in the actual game loop. That's what seems the most likely to me, but it's impossible to tell without seeing the rest of the code.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8755 - kiwibonga - Sat Jul 19, 2003 4:16 am</h4>
    <div class="postbody"><span class="postbody">Heh... You're right... It *has* to be it...<br/>_________________<br/><a href="http://www.kiwibonga.com" target="_blank">http://www.kiwibonga.com</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8771 - Snoobab - Sat Jul 19, 2003 1:48 pm</h4>
    <div class="postbody"><span class="postbody">Yeah, I was only calling LaunchBullet() when A was pressed. I've changed it a bit now and put it in the main game-loop; all works well.
<br/>
<br/>
Thanks a lot for your help.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#8801 - Paul Shirley - Sun Jul 20, 2003 2:33 pm</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
