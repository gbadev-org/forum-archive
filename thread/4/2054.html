<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>How do you compile ARM code with THUMB code using DevKitAdv? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > How do you compile ARM code with THUMB code using DevKitAdv?</h2>
<div id="posts">
<div class="post">
    <h4>#10641 - Mr. GBA - Thu Sep 11, 2003 1:33 pm</h4>
    <div class="postbody"><span class="postbody">Hi,
<br/>
<br/>
I have two separate files; one which must be compiled in ARM (file1.c); and one which must be compiled in THUMB (file2.c).
<br/>
<br/>
I have tried to compile the two files using the compiler options shown below:
<br/>
<br/>
gcc -c -O3 -marm file1.c
<br/>
gcc -c -O3 -mthumb file2.c
<br/>
gcc -marm -mthumb-interwork -o output.elf file2.o file1.o
<br/>
<br/>
objcopy -O binary output.elf output.gba
<br/>
<br/>
<br/>
Once compiled, output.gba only implements code in file2.c and totally disregards code in file1.c. 
<br/>
<br/>
<br/>
I would be grateful if anyone could tell me how to efficiently compile ARM and THUMB code.
<br/>
<br/>
<br/>
Thanks.<br/>_________________<br/>my dev/business site:
<br/>
<br/>
<a href="http://codebytesdev.afraid.org" target="_blank">http://codebytesdev.afraid.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10642 - Lupin - Thu Sep 11, 2003 2:24 pm</h4>
    <div class="postbody"><span class="postbody">gcc -c -O3 -marm-interwork file1.c 
<br/>
gcc -c -O3 -mthumb-interwork file2.c 
<br/>
gcc -marm -mthumb-interwork -o output.elf file2.o file1.o 
<br/>
<br/>
I think this should do (not 100%ly sure, but just try and see if it works ;))</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10646 - Mr. GBA - Thu Sep 11, 2003 3:22 pm</h4>
    <div class="postbody"><span class="postbody">Thanks for the reply Lupin, But -marm-interwork isn't a valid compiler option. 
<br/>
<br/>
Anymore suggestions are more than welcome...<br/>_________________<br/>my dev/business site:
<br/>
<br/>
<a href="http://codebytesdev.afraid.org" target="_blank">http://codebytesdev.afraid.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#10648 - tepples - Thu Sep 11, 2003 3:33 pm</h4>
    <div class="postbody"><span class="postbody">The corrected options are
<br/>
<br/>
-marm -mthumb-interwork (compile as interworking-safe ARM)
<br/>
-mthumb -mthumb-interwork (compile as interworking-safe Thumb)<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
