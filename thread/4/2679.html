<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>u32's re-ordered when compling using devkitadv .. help ! :) - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. </i><br />

        <h2>Coding > u32's re-ordered when compling using devkitadv .. help ! :)</h2>
<div id="posts">
<div class="post">
    <h4>#15046 - cosmic4z - Fri Jan 16, 2004 4:21 pm</h4>
    <div class="postbody"><span class="postbody">I have 8, u32 (long) values in my c, source file, thus:
<br/>
<br/>
long	CAM_p1_x;		// top left (x)
<br/>
long	CAM_p1_y;		// top left (y)
<br/>
long	CAM_p2_x;		// top right (x)
<br/>
long	CAM_p2_y;		// top right (y)
<br/>
long	CAM_p3_x;		// bottom left (x)
<br/>
long	CAM_p3_y;		// bottom left (y)
<br/>
long	CAM_p4_x;		// bottom right (x)
<br/>
long	CAM_p4_y;		// bottom right (y)
<br/>
<br/>
When I complie my project (using devkitadv), I look in the generated mapfile and they do not appear in the same order in memory as specified in my source file.
<br/>
<br/>
The relevant part of the map file, looks like this:
<br/>
<br/>
COMMON         0x03000888       0x40 camera.o
<br/>
                                  0x0 (size before relaxing)
<br/>
                0x03000888                CAM_p3_y
<br/>
                0x0300088c                CAM_p1_y
<br/>
                0x03000890                CAM_right_y
<br/>
                0x03000894                CAM_left_x
<br/>
                0x03000898                CAM_p4_y
<br/>
                0x0300089c                CAM_p2_x
<br/>
                0x030008a0                CAM_p4_x
<br/>
                0x030008a4                CAM_right_x
<br/>
                0x030008a8                CAM_p3_x
<br/>
                0x030008ac                CAM_p1_x
<br/>
                0x030008b0                CAM_top_x
<br/>
                0x030008b4                CAM_bottom_y
<br/>
                0x030008b8                CAM_p2_y
<br/>
                0x030008bc                CAM_left_y
<br/>
                0x030008c0                CAM_bottom_x
<br/>
                0x030008c4                CAM_top_y
<br/>
<br/>
As you can see, the order has been mixed up.
<br/>
<br/>
Why is this, and is there anything I can do to force the same order as per my source file?
<br/>
<br/>
Many thanks,
<br/>
Jamie<br/>_________________<br/>Qwak - <a href="http://www.qwak.co.uk" target="_blank">www.qwak.co.uk</a> | Forum - <a href="http://www.qwak.co.uk/forum/" target="_blank">www.qwak.co.uk/forum/</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15048 - DekuTree64 - Fri Jan 16, 2004 4:52 pm</h4>
    <div class="postbody"><span class="postbody">Put them in an array. If you really want them to each have their own label, you can force the correct order in an ASM file by doing like 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">.data
<br/>
.align 2
<br/>
.global var1
<br/>
var1:
<br/>
.space 4
<br/>
.global var2
<br/>
var2:
<br/>
.space 4</td> </tr></table><span class="postbody">
<br/>
and so on, and they will stay that way. If you look at the ASM output from a C file with a global var declaration, they use something like comm var1, 4 instead, which means to declare a common symbol, that points to 4 bytes of space, and let the linker decide where to put it. .global is normally used for functions, but a symbol is a symbol so it works fine for both.<br/>_________________<br/>___________
<br/>
The best optimization is to do nothing at all.
<br/>
Therefore a fully optimized program doesn't exist.
<br/>
-Deku</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15049 - Paul Shirley - Fri Jan 16, 2004 5:19 pm</h4>
    <div class="postbody"><span class="postbody">removed</span><span class="gensmall"><br/><br/>Last edited by Paul Shirley on Sun Mar 28, 2004 9:22 pm; edited 1 time in total</span></div>    
</div>
<div class="post">
    <h4>#15070 - poslundc - Fri Jan 16, 2004 8:53 pm</h4>
    <div class="postbody"><span class="postbody">You can also use a struct to contain your related variables (which is a better idea than letting them roam free anyway).
<br/>
<br/>
Although I'm not sure if the compiler reserves the right to reorganize your struct if it thinks another method is more efficient, I've never had it do that to me (and I've used some wicked inefficient structs before).
<br/>
<br/>
<span style="font-weight: bold">EDIT:</span> Crikey, I should've read Paul's post more carefully... my bad.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#15072 - cosmic4z - Fri Jan 16, 2004 9:25 pm</h4>
    <div class="postbody"><span class="postbody">OK, I put them in an array in the end ...
<br/>
<br/>
Thanks very much everyone for the information, very useful, thanks :)<br/>_________________<br/>Qwak - <a href="http://www.qwak.co.uk" target="_blank">www.qwak.co.uk</a> | Forum - <a href="http://www.qwak.co.uk/forum/" target="_blank">www.qwak.co.uk/forum/</a></span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
