<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>IRQ stack - gbadev.org forum archive</title>
        <link rel="stylesheet" href="static/pure-min.css" />
        <link rel="stylesheet" href="static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > IRQ stack</h2>
<div id="posts">
<div class="post">
    <h4>#103827 - dushan42 - Sun Sep 24, 2006 9:12 pm</h4>
    <div class="postbody"><span class="postbody">Hi!
<br/>
<br/>
I've been trying to account for every single byte of my IWRAM usage and I've noticed that the IRQ stack (as defined in the standard Jeff Frohwein link script) starts 0x60 bytes below the top of IWRAM:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">__sp_irq          = __iwram_top - 0x60;</td> </tr></table><span class="postbody">
<br/>
<br/>
What is this mysterious region between $03007fa0 and $03007ffc for?
<br/>
<br/>
I've noticed in VisualBoyAdvance that invoking some software interrupts (e.g. swi 0x06 - integer division) scribbles over some of the area ($03007fd0 - $03007fe0). Any ideas why?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103841 - poslundc - Sun Sep 24, 2006 10:44 pm</h4>
    <div class="postbody"><span class="postbody">According to <a class="postlink" href="http://nocash.emubase.de/gbatek.htm#interruptcontrol" target="_blank">GBATEK on interrupt control</a>:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Default memory usage at 03007FXX (and mirrored to 03FFFFXX)
<br/>
<br/>
  Addr. Size Expl.
<br/>
  7FFCh 4    Pointer to user IRQ handler (32bit ARM code)
<br/>
  7FF8h 4    Interrupt Check Flag (for IntrWait/VBlankIntrWait functions)
<br/>
  7FF4h 4    Allocated Area
<br/>
  7FF0h 4    Pointer to Sound Buffer
<br/>
  7FE0h 16   Allocated Area
<br/>
  7FA0h 64   Default area for SP_svc Supervisor Stack (4 words/time)
<br/>
  7F00h 160  Default area for SP_irq Interrupt Stack (6 words/time)
<br/>
<br/>
Memory below 7F00h is free for User Stack and user data. The three stack pointers are initially initialized at the TOP of the respective areas:
<br/>
<br/>
  SP_svc=03007FE0h
<br/>
  SP_irq=03007FA0h
<br/>
  SP_usr=03007F00h</td> </tr></table><span class="postbody">
<br/>
<br/>
<br/>
So the non-specific answer to your question is that the area is reserved for BIOS activity from SWI calls.
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#103852 - dushan42 - Sun Sep 24, 2006 11:44 pm</h4>
    <div class="postbody"><span class="postbody">Good old RTFM :) - thanks for pointing me to GBATEK.</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
