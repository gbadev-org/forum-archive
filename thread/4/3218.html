<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>What's the deal with the "goto" command? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/static/pure-min.css" />
        <link rel="stylesheet" href="/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        This is a mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. <br />

        <h2>Coding > What's the deal with the "goto" command?</h2>
<div id="posts">
<div class="post">
    <h4>#19168 - Krakken - Tue Apr 13, 2004 4:11 am</h4>
    <div class="postbody"><span class="postbody">When I was first learning C programming all books that I read strongly recommended the sparse use of goto commands. However, I don't see why this would be as I can see many uses that just would be a lot more difficult to implement otherwise.
<br/>
<br/>
Can anyone please tell me why everyone hates this command so much?</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19169 - Pinski - Tue Apr 13, 2004 4:20 am</h4>
    <div class="postbody"><span class="postbody">It's not very good code to use the Goto command.  You can use it, but mostly it's frowned upon.  Most times you could use the goto command you can find another way to do the same thing with either a loop or a function call.  The main problem with Goto statements is that it makes it hard to read other people's code, it's called spaghetti code.  Imagine a code like this:
<br/>
<br/>
<br/>
A - bunch of code
<br/>
B - goto E
<br/>
C - some code that goes after A and D, but before G
<br/>
D - goto G
<br/>
E - some code that is processed after A, but before C and G
<br/>
F - goto C
<br/>
G - more code here
<br/>
<br/>
That kind of sloppy use of code makes it hard to debug and follow for others that work on your code.  I've heard of Professors talking about doing maintenance on systems that have over 30-50 pages of code that was written like that back in the day.  Could you image the time that it would take to straighten the code out?  That's why people don't like goto statements unless they are positively necessary.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19170 - yaustar - Tue Apr 13, 2004 4:30 am</h4>
    <div class="postbody"><span class="postbody">I think it is also something to do with the flow of code. C is an imperative language and is a top to bottom flow and goto breaks this flow. It was used mostly in BASIC because you couldn't code any individual procedures (correct me here, my knowledge of BASIC is very low here), in C you can.<br/>_________________<br/>[<a class="postlink" href="http://parabellumgames.no-ip.org" target="_blank">Blog</a>] [<a class="postlink" href="http://yaustar.no-ip.org" target="_blank">Portfolio</a>]</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19171 - poslundc - Tue Apr 13, 2004 5:29 am</h4>
    <div class="postbody"><span class="postbody">Goto precedes BASIC, but is perhaps most widely known in that language.
<br/>
<br/>
Goto is a very primitive command/concept: pick another spot in the code and branch to it. Ultimately, all of the loops, function calls, if-blocks, etc. you put into programs are translated into "gotos".
<br/>
<br/>
Modern programming theory is strongly based around ideas of encapsulation and modularization, and through various constructs such as loops, flow-control, procedures and functions, goto has essentially been made obsolete: for any situation where you might use a goto statement, there is almost always a more sophisticated and elegant construct that can help guard against the spaghetti coding that can easily result from arbitrary branching.
<br/>
<br/>
What situation are you thinking of that would be difficult to implement without using goto statements?
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19172 - LOst? - Tue Apr 13, 2004 10:05 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>poslundc wrote:</b></span></td> </tr> <tr> <td class="quote">
<br/>
What situation are you thinking of that would be difficult to implement without using goto statements?
<br/>
<br/>
Dan.</td> </tr></table><span class="postbody">
<br/>
<br/>
When being inside of an interrupt routine, you sometimes have to use goto for faster branches to the end of the routine to set the interrupt flag and do end coding. Having a subroutine call eats the cycles.
<br/>
You save time by using goto when leaving a "for" loop in a hurry. "for" loops have the "continue" and "next" but they don't have "break".</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19176 - Sweex - Tue Apr 13, 2004 12:03 pm</h4>
    <div class="postbody"><span class="postbody">In all my years of pascal and C/C++ programming I never had to use goto once in all my code and to be honest; it disgusts me (for all the reasons mentioned already).
<br/>
<br/>
I will admit though that it took a while to get used to when I switched from basic to pascal!<br/>_________________<br/>If everything fails, read the manual: If even that fails, post on forum!</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19179 - f(DarkAngel) - Tue Apr 13, 2004 1:05 pm</h4>
    <div class="postbody"><span class="postbody">The origin of goto statement is assembly. The structure of BASIC is similar to assembly. You'll see jumps if you disassemble for,while,do,switch,if/else if statements. It is simply what you code is going to be translated.
<br/>
<br/>
In other words, if you want to use label &amp; goto (jmp/bra), try assembly.<br/>_________________<br/>death scream...</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19180 - torne - Tue Apr 13, 2004 1:09 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>f(DarkAngel) wrote:</b></span></td> </tr> <tr> <td class="quote">You'll see jumps if you disassemble for,while,do,switch,if/else if statements. It is simply what you code is going to be translated.</td> </tr></table><span class="postbody">
<br/>
<br/>
We don't want to see them; it's why we're using the high level languages in the first place. Well, I say 'we', I like assembly. =)</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19183 - poslundc - Tue Apr 13, 2004 3:40 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>LOst? wrote:</b></span></td> </tr> <tr> <td class="quote">When being inside of an interrupt routine, you sometimes have to use goto for faster branches to the end of the routine to set the interrupt flag and do end coding. Having a subroutine call eats the cycles.</td> </tr></table><span class="postbody">
<br/>
<br/>
You don't need a subroutine call. You can use an "if" statement, and put control braces around the section you want to skip.
<br/>
<br/>
Or if you prefer, use inline functions.
<br/>
<br/>
In fact, using a goto statement can slow you down because the compiler can't optimize the control flow of your program. If you want to be that specific about where your program branches and when for the sake of counting cycles, then you should be programming in assembly.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">You save time by using goto when leaving a "for" loop in a hurry. "for" loops have the "continue" and "next" but they don't have "break".</td> </tr></table><span class="postbody">
<br/>
<br/>
Uh... no?
<br/>
<br/>
Dan.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19184 - jma - Tue Apr 13, 2004 4:22 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>LOst? wrote:</b></span></td> </tr> <tr> <td class="quote">"for" loops have the "continue" and "next" but they don't have "break".</td> </tr></table><span class="postbody">
<br/>
<br/>
Just plain wrong. Break can be used in for loops, switch/case statements and do/while loops. Goto can be extremely useful, but these instances are few and far between. Reasons why goto is frowned upon:
<br/>
<br/>
o Difficult to understand program flow
<br/>
o You can kill the hardware stack in-advertantly
<br/>
o Very difficult for a compiler to optimize
<br/>
<br/>
<span style="font-style: italic">o On smaller architectures (even THUMB mode) JMP/B instructions are very limited in their range -- a longer jump would require a lot of code to work around (killing your speed advantage).</span>
<br/>
<br/>
o Many more reasons...
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19186 - MayFly - Tue Apr 13, 2004 4:57 pm</h4>
    <div class="postbody"><span class="postbody">Hi Guys,
<br/>
<br/>
Here's an excerpt from Steve McConnell's book "Code Complete" that talks about  reasons why and when gotos are valid tools:
<br/>
<br/>
A well-placed goto can eliminate the need for duplicate code. Duplicate code leads to problems if the two sets of code are modified differently. Duplcate code increases the size of source and executable files. The bad effects of the goto are outweighed in such a case by the risks of duplicate code.
<br/>
<br/>
The goto is useful in a routine that allocates resources, performs operations on those resources, and then deallocates the resources. With a goto, you can clean up in one section of code. The goto reduces the likelihood of your forgetting to deallocate the resources in each place you detect an error.
<br/>
<br/>
...
<br/>
<br/>
Good programming doesn?t mean eliminating gotos, Methodical decomposition, refinement, and selection of control structures automatically lead to goto-free programs in most cases. Achieving gotoless code in not the aim, but the outcome, and putting the focus of avoiding gotos isn?t helpful.
<br/>
<br/>
Code Complete pg. 349
<br/>
<br/>
MayFly</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19189 - torne - Tue Apr 13, 2004 5:13 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>MayFly wrote:</b></span></td> </tr> <tr> <td class="quote">The goto is useful in a routine that allocates resources, performs operations on those resources, and then deallocates the resources. With a goto, you can clean up in one section of code. The goto reduces the likelihood of your forgetting to deallocate the resources in each place you detect an error.</td> </tr></table><span class="postbody">
<br/>
<br/>
My general opinion of Code Complete is pretty low, but what is being described here is an unstructured exception handler, implemented manually using goto. If you're not in a piece of code which is performance critical, and you happen to like that sort of thing, you can use structured exception handling to do it. It's a shame that C doesn't have unstructured exceptions, as this would neatly avoid this case, but this is a plausible use of goto which is difficult to dodge otherwise. One way to simulate unstructured exceptions in C without using goto that works reasonably well is to take your code that looks (logically) something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">try {
<br/>
  if (!doStuff()) throw;
<br/>
  if (!doMoreStuff()) throw;
<br/>
} finally {
<br/>
  cleanup();
<br/>
}</td> </tr></table><span class="postbody">
<br/>
and replace it with something like:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">inline void tryBody() {
<br/>
  if (!doStuff()) return;
<br/>
  if (!doMoreStuff()) return;
<br/>
}
<br/>
<br/>
tryBody();
<br/>
cleanup();</td> </tr></table><span class="postbody">
<br/>
<br/>
This is a pretty simple example; where it breaks down is when the try body needs to use more than one or two values from the context it originally appeared in (as it starts to get ugly). If you needed to know whether there was an 'exception', then you would make the function a bool and return false when throwing (and true at the end). I've coded like this quite often; it looks quite clean (as if the try body is doing a large number of things anyway, it should possibly be a seperate function in the first place) and generates good code (compilers are better at handling inlined returns than gotos).</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19193 - tepples - Tue Apr 13, 2004 10:57 pm</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jma wrote:</b></span></td> </tr> <tr> <td class="quote">Break can be used in for loops, switch/case statements and do/while loops.</td> </tr></table><span class="postbody">
<br/>
True, but unlike the <a class="postlink" href="http://java.sun.com/docs/books/tutorial/java/nutsandbolts/branch.html" target="_blank">break in the Java language</a> which can jump from deep nesting within a block to the end of that block, provided you've given the block a label, the break in C and C++ can't jump out of more than one such block at a time.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Goto can be extremely useful, but these instances are few and far between.</td> </tr></table><span class="postbody">
<br/>
I would stress the difference between "few and far between" and "nonexistent".
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Reasons why goto is frowned upon:
<br/>
<br/>
o Difficult to understand program flow</td> </tr></table><span class="postbody">
<br/>
In some cases. But in others, it's possible to implement, say, exceptions and coroutines in the C language rather cleanly in terms of macros on top of goto. However, as torne mentioned, if your try block is too big, you probably need to refactor something.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">o You can kill the hardware stack in-advertantly</td> </tr></table><span class="postbody">
<br/>
We're talking goto, not setjmp and longjmp.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">o Very difficult for a compiler to optimize</td> </tr></table><span class="postbody">
<br/>
Granted.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">On smaller architectures (even THUMB mode) JMP/B instructions are very limited in their range -- a longer jump would require a lot of code to work around (killing your speed advantage).</td> </tr></table><span class="postbody">
<br/>
C goto works within the scope of a function, and a single function usually fits within most C friendly architectures' branch ranges; otherwise, big loops would run even more slowly.<br/>_________________<br/>-- Where is he?
<br/>
-- Who?
<br/>
-- You know, the human.
<br/>
-- I think he moved to Tilwick.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19198 - dagamer34 - Tue Apr 13, 2004 11:47 pm</h4>
    <div class="postbody"><span class="postbody">Well, if you wanted to do some code in C and then translate it into assembly later on, goto has it's uses. But in common practice, it leads to havoc.
<br/>
<br/>
It's not that goto is bad, we are just lazy programmers by nature (well, some of us).<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19200 - sgeos - Wed Apr 14, 2004 12:55 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Quote:</b></span></td> </tr> <tr> <td class="quote">Goto can be extremely useful, but these instances are few and far between.</td> </tr></table><span class="postbody">
<br/>
I would stress the difference between "few and far between" and "nonexistent".</span></td> </tr></table><span class="postbody">
<br/>
<br/>
Goto in C is useful for jumping out of nested loops.  This case is "few and far between", not "nonexistent".  Sure, any code can be restructured to avoid the use of goto.  I believe that Java doesn't even have gotos, and the java programmers don't seem to be complaining.
<br/>
<br/>
One could always do something like this:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">...
<br/>
int exit_code;
<br/>
<br/>
...
<br/>
exit_code = 0;
<br/>
for (...) {
<br/>
   if (exit_code)
<br/>
      break;
<br/>
   ...
<br/>
   for (...) {
<br/>
      if (exit_code)
<br/>
         break;
<br/>
      ...
<br/>
      if (exit_code)
<br/>
         break;
<br/>
      ...
<br/>
   }
<br/>
   if (exit_code)
<br/>
      break;
<br/>
   ...
<br/>
}
<br/>
...
<br/>
if (exit_code) {
<br/>
   ...
<br/>
}
<br/>
else {
<br/>
   ...
<br/>
}
<br/>
...
<br/>
return (...);</td> </tr></table><span class="postbody">
<br/>
This is easy to extend this for deeper nesting levels, but if you happen to have deeper nesting, I suspect you need to break your routine into smaller pieces.
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote">...it's possible to implement, say, exceptions and coroutines in the C language rather cleanly in terms of macros on top of goto.</td> </tr></table><span class="postbody">
<br/>
<br/>
C has poor support for coroutines.  I think that a switch statement is the way to go, goto strikes me as a broken solution.  See <a class="postlink" href="http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html" target="_blank">this page</a>.
<br/>
<br/>
I'm of the opinion that gotos should always jump forward.  I'd be willing to use a goto if it ever seemed like it would help.  I have yet to program anything that would truly benefit from the use of a goto.
<br/>
<br/>
Using a goto will defeat the compiler's ability to optimize.  Attempting to use a goto to save speed is misguided-
<br/>
A) Premature optimization is the root of all evil
<br/>
B) You want to recode the routine in assembler
<br/>
<br/>
-Brendan</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19220 - jma - Wed Apr 14, 2004 5:53 am</h4>
    <div class="postbody"><span class="postbody"></span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>tepples wrote:</b></span></td> </tr> <tr> <td class="quote"><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>jma wrote:</b></span></td> </tr> <tr> <td class="quote">Break can be used in for loops, switch/case statements and do/while loops.</td> </tr></table><span class="postbody">
<br/>
True, but unlike the break in the Java language which can jump from deep nesting within a block to the end of that block, ..., the break in C and C++ can't jump out of more than one such block at a time.</span></td> </tr></table><span class="postbody">
<br/>
So? I don't know (or care to really know much) about Java. However, if you <span style="font-style: italic">need</span> to break out of more than one loop, you need to factor your code some more and rethink your implementation.
<br/>
<br/>
[more stuff snipped from other posts that were all good comments]
<br/>
<br/>
The fact is, you never want to use a goto to leave any kind of loop <span style="font-style: italic">for speed reasons</span>. I say this, because this was the original argument made for using it (not because it is the only or most important reason). All the reasons stated by everyone are true, plus other reasons. 
<br/>
<br/>
If <span style="font-style: italic">you </span>need to do it, fine. Does it make something easier at the moment? fine -- it isn't my code, why should I care? :)
<br/>
<br/>
However, it will give your compiler a lot of grief! And on an embedded system, you want to help the compiler as much as you can. Compilers (especially GCC) are hardly great at code generation. Even the best only produce code that rivals that of intermediate assembly programmers. THe real advantage of compilers is in cycle counting and knowledge of branch prediction and other processor specifics. 
<br/>
<br/>
The ARM happens to be a very nice processor (lots of available registers), but most processors aren't so generous. And programming practices developed now stick with you in the future.
<br/>
<br/>
For loops (as this is the primary example being given) do not have a standard implementation -- only a standard <span style="font-style: italic">effect</span>. The loop variables <span style="font-style: italic">may</span> be in registers -- they may not. Those registers <span style="font-style: italic">may needed to be saved upon entering, and restored upon leaving, the loop</span>:
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for(i = 0;i &lt; 10;i++)
<br/>
    if (i == 7) goto oops;
<br/>
/* do something here */
<br/>
oops:
<br/>
/* do something else */</td> </tr></table><span class="postbody">
<br/>
<br/>
The C compiler may have a lot of cleanup code after the loop, but before 'oops'. Your goto may not just compile to a simple branch statement, but rather a lot of clean-up code on top of it.
<br/>
<br/>
Now, devil's advocate: the C standard has goto. It's there because it is legacy, and <span style="font-style: italic">because it is useful still</span>. If it wasn't useful, what would be the point. 99% of the time, if you are going to use goto, rethink your code, you are probably just trying to avoid typing a code segment twice. If that's the case, bust out a subroutine -- ie factor!
<br/>
<br/>
If you are using a goto to bust out of multiple loops, again, <span style="font-style: italic">rethink the code</span>. Instead of:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">for (...) {
<br/>
    for (...) {
<br/>
        if (...) goto bust_loop;
<br/>
    }
<br/>
}
<br/>
bust_loop:</td> </tr></table><span class="postbody">
<br/>
do:
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">void my_factored_code() {
<br/>
    for(...) {
<br/>
        for(...) {
<br/>
            if (...) return;
<br/>
        }
<br/>
    }
<br/>
}</td> </tr></table><span class="postbody">
<br/>
<br/>
Oh well, this debate has been argued ad nauseum on c.l.c and probably here numerous times as well. This is basic, freshman level stuff, people (well, the compiler theory is a bit higher). But in the immortal words of Forrest Gump, "that's all I have to say about that." :)
<br/>
<br/>
Have fun coding... and above all, <span style="font-style: italic">use the right tool for the right problem</span>. If all you have is a hammer, everything looks like a nail. Remember, C has a lot of tools, use them all, but use them wisely. :)
<br/>
<br/>
Jeff<br/>_________________<br/><a href="mailto:massung@gmail.com">massung@gmail.com</a>
<br/>
<a href="http://www.retrobyte.org" target="_blank">http://www.retrobyte.org</a></span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#19235 - dagamer34 - Wed Apr 14, 2004 11:37 pm</h4>
    <div class="postbody"><span class="postbody">One thing I want to add. Goto shouldn't need to be used in a function; that means that it's trying to do too much.<br/>_________________<br/>Little kids and Playstation 2's don't mix. :(</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
