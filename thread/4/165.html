<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>calling BIOS functions in C++ ... how? - gbadev.org forum archive</title>
        <link rel="stylesheet" href="/forum-archive/static/pure-min.css" />
        <link rel="stylesheet" href="/forum-archive/static/main.css" />
    </head>
    <body>
        <h1>gbadev.org forum archive</h1>

        <i>This is a read-only mirror of the content originally found on forum.gbadev.org
        (now offline), salvaged from Wayback machine copies. A new forum can be found <a href="https://forum.gbadev.net/" target="_blank">here</a>.</i><br />

        <h2>Coding > calling BIOS functions in C++ ... how?</h2>
<div id="posts">
<div class="post">
    <h4>#1001 - animension - Mon Jan 13, 2003 7:03 am</h4>
    <div class="postbody"><span class="postbody">How does one go about calling built-in BIOS functions like SWI 6 (DIV)? Is ASM the only way to do this? And if so, how does one incorporate this into an inline form in C++ code?
<br/>
<br/>
Say you had a function:
<br/>
<br/>
unsigned short BIOS_DIVIDE(unsigned short a, unsigned short b);
<br/>
<br/>
How would you inline the ASM and how would you know which registers hold what value? If this needs to go into the ASM forum my apologies.</span><span class="gensmall"></span></div>    
</div>
<div class="post">
    <h4>#1014 - anli - Mon Jan 13, 2003 12:27 pm</h4>
    <div class="postbody"><span class="postbody">Here is an answer I was giving in the graphics forum on the question
<br/>
how to call the lz decompression routines from C/C++-code.
<br/>
<br/>
Put this in an assembler file: 
<br/>
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
.GLOBAL LZ77UnCompVram 
<br/>
.GLOBAL LZ77UnCompWram 
<br/>
LZ77UnCompVram: 
<br/>
swi 18 
<br/>
bx lr 
<br/>
<br/>
LZ77UnCompWram: 
<br/>
swi 17 
<br/>
bx lr 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This file is assembled like this: 
<br/>
For arm mode: 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
as -marm7tdmi file.s 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
For thumb mode: 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
as -mthumb file.s 
<br/>
</td> </tr></table><span class="postbody">
<br/>
<br/>
This produces a file.o. 
<br/>
<br/>
Now add this to your C code: 
<br/>
</span><table align="center" border="0" cellpadding="3" cellspacing="1" width="90%"><tr> <td><span class="genmed"><b>Code:</b></span></td> </tr> <tr> <td class="code">
<br/>
extern void LZ77UnCompWram(void *src, void *dest); 
<br/>
extern void LZ77UnCompVram(void *src, void *dest); 
<br/>
</td> </tr></table><span class="postbody">
<br/>
Now, you have two extra functions to play with. The "V" version is 
<br/>
used when you are decompressing to video memory. 
<br/>
<br/>
Dont forget to add file.o on the command line to your linker.
<br/>
<br/>
/anli</span><span class="gensmall"></span></div>    
</div>
</div>

    </body>
</html>
